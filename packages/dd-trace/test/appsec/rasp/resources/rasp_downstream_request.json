{
  "version": "2.2",
  "metadata": {
    "rules_version": "1.99.0"
  },
  "rules": [
    {
      "id": "apiA-100-001",
      "name": "API 10 tag rule on request headers",
      "tags": {
        "type": "api10 request headers",
        "category": "attack_attempt"
      },
      "conditions": [
        {
          "parameters": {
            "inputs": [
              {
                "address": "server.io.net.request.headers",
                "key_path": [
                  "Witness"
                ]
              }
            ],
            "list": [
              "pwq3ojtropiw3hjtowir"
            ]
          },
          "operator": "exact_match"
        }
      ],
      "output": {
        "event": true,
        "keep": true,
        "attributes": {
          "_dd.appsec.trace.req_headers": {
            "value": "TAG_API10_REQ_HEADERS"
          }
        }
      },
      "on_match": []
    },
    {
      "id": "apiA-100-003",
      "name": "API 10 tag rule on request method",
      "tags": {
        "type": "api10 request method",
        "category": "attack_attempt"
      },
      "conditions": [
        {
          "parameters": {
            "inputs": [
              {
                "address": "server.io.net.request.method"
              }
            ],
            "list": [
              "GET"
            ]
          },
          "operator": "exact_match"
        }
      ],
      "output": {
        "event": true,
        "keep": true,
        "attributes": {
          "_dd.appsec.trace.req_method": {
            "value": "TAG_API10_REQ_METHOD"
          }
        }
      },
      "on_match": []
    },
    {
      "id": "apiA-100-004",
      "name": "API 10 tag rule on response status",
      "tags": {
        "type": "api10 response status",
        "category": "attack_attempt"
      },
      "conditions": [
        {
          "parameters": {
            "inputs": [
              {
                "address": "server.io.net.response.status"
              }
            ],
            "list": [
              "200",
              "201"
            ]
          },
          "operator": "exact_match"
        }
      ],
      "output": {
        "event": true,
        "keep": true,
        "attributes": {
          "_dd.appsec.trace.res_status": {
            "value": "TAG_API10_RES_STATUS"
          }
        }
      },
      "on_match": []
    },
    {
      "id": "apiA-100-005",
      "name": "API 10 tag rule on response headers",
      "tags": {
        "type": "api10 response headers",
        "category": "attack_attempt"
      },
      "conditions": [
        {
          "parameters": {
            "inputs": [
              {
                "address": "server.io.net.response.headers",
                "key_path": [
                  "echo-headers"
                ]
              }
            ],
            "list": [
              "qwoierj12l3"
            ]
          },
          "operator": "exact_match"
        }
      ],
      "output": {
        "event": true,
        "keep": true,
        "attributes": {
          "_dd.appsec.trace.res_headers": {
            "value": "TAG_API10_RES_HEADERS"
          }
        }
      },
      "on_match": []
    },
    {
      "id": "apiA-100-006",
      "name": "API 10 tag rule on response body",
      "tags": {
        "type": "api10 reponse body",
        "category": "attack_attempt"
      },
      "conditions": [
        {
          "parameters": {
            "inputs": [
              {
                "address": "server.io.net.response.body"
              }
            ],
            "list": [
              "kqehf09123r4lnksef"
            ]
          },
          "operator": "exact_match"
        }
      ],
      "output": {
        "event": true,
        "keep": true,
        "attributes": {
          "_dd.appsec.trace.res_body": {
            "value": "TAG_API10_RES_BODY"
          }
        }
      },
      "on_match": []
    }
  ]
}
