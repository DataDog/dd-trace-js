version: "2"
services:
  localstack:
    # TODO: Figure out why SNS doesn't work in >=1.2
    # https://github.com/localstack/localstack/issues/7479
    image: localstack/localstack:1.1.0
    ports:
      - "127.0.0.1:4566:4566" # Edge
    environment:
      - LOCALSTACK_SERVICES=dynamodb,kinesis,s3,sqs,sns,redshift,route53,logs,serverless
      - EXTRA_CORS_ALLOWED_HEADERS=x-amz-request-id,x-amzn-requestid,x-amz-id-2
      - EXTRA_CORS_EXPOSE_HEADERS=x-amz-request-id,x-amzn-requestid,x-amz-id-2
      - AWS_DEFAULT_REGION=us-east-1
      - FORCE_NONINTERACTIVE=true
      - START_WEB=0
      - LAMBDA_EXECUTOR=local