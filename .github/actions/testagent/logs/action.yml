name: "Get APM Test Agent Logs"
description: "Get the APM Test Agent logs from the test run."
inputs:
  container-id:
    description: "ID of the Docker Container to get logs from (optional)"
    required: false
runs:
  using: composite
  steps:
    - uses: actions/checkout@v2
    - run: |
        [ -d "./artifacts" ] || mkdir -p "./artifacts"
      shell: bash
    - run: |
        if [ -n "${{inputs.container-id}}" ]; then
          docker logs ${{inputs.container-id}}
        else
          docker-compose logs testagent
        fi
      shell: bash
    - run: |
        directory="./artifacts"

        # Check if the directory exists
        if [ -d "$directory" ]; then
            # Loop through each file in the directory
            for file in "$directory"/*; do
                # Check if the file is a regular file
                if [ -f "$file" ]; then
                    echo "$file is a file"
                fi
            done
        else
            echo "Directory does not exist"
        fi
      shell: bash
    - name: Archive Test Agent Artifacts
      uses: actions/upload-artifact@v3
      with:
        name: supported-integrations
        path: ./artifacts
