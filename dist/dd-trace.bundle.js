!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["dd-trace"]=t():e["dd-trace"]=t()}(global,(()=>(()=>{var e={775:e=>{"use strict";e.exports={LOG:"log",AGENT:"agent",DATADOG:"datadog",AGENT_PROXY:"agent_proxy",JEST_WORKER:"jest_worker",CUCUMBER_WORKER:"cucumber_worker",MOCHA_WORKER:"mocha_worker"}},9429:e=>{"use strict";e.exports={TEXT_MAP:"text_map",HTTP_HEADERS:"http_headers",BINARY:"binary",LOG:"log",TEXT_MAP_DSM:"text_map_dsm"}},3973:(e,t,r)=>{"use strict";const s=r(9429),n=r(9386),i=r(1013),a=r(4100),o=r(780),c=r(775);e.exports={formats:s,kinds:n,priority:i,tags:a,types:o,exporters:c}},9386:e=>{"use strict";e.exports={SERVER:"server",CLIENT:"client",PRODUCER:"producer",CONSUMER:"consumer",INTERNAL:"internal"}},1013:e=>{"use strict";e.exports={USER_REJECT:-1,AUTO_REJECT:0,AUTO_KEEP:1,USER_KEEP:2}},4100:e=>{"use strict";const t={SERVICE_NAME:"service.name",RESOURCE_NAME:"resource.name",SPAN_TYPE:"span.type",SPAN_KIND:"span.kind",SAMPLING_PRIORITY:"sampling.priority",ANALYTICS:"_dd1.sr.eausr",ERROR:"error",MANUAL_KEEP:"manual.keep",MANUAL_DROP:"manual.drop",MEASURED:"_dd.measured",BASE_SERVICE:"_dd.base_service",DD_PARENT_ID:"_dd.parent_id",HTTP_URL:"http.url",HTTP_METHOD:"http.method",HTTP_STATUS_CODE:"http.status_code",HTTP_ROUTE:"http.route",HTTP_REQUEST_HEADERS:"http.request.headers",HTTP_RESPONSE_HEADERS:"http.response.headers",HTTP_USERAGENT:"http.useragent",HTTP_CLIENT_IP:"http.client_ip",PATHWAY_HASH:"pathway.hash"};t.ANALYTICS_SAMPLE_RATE=t.ANALYTICS,e.exports=t},780:e=>{"use strict";e.exports={HTTP:"http",SERVERLESS:"serverless",WEB:"web"}},5237:(e,t,r)=>{"use strict";e.exports=r(4508)},9100:(e,t,r)=>{"use strict";r.d(t,{_:()=>_});var s=r(8729),n=function(){function e(){}return e.prototype.active=function(){return s.l},e.prototype.with=function(e,t,r){for(var s=[],n=3;n<arguments.length;n++)s[n-3]=arguments[n];return t.call.apply(t,function(e,t,r){if(r||2===arguments.length)for(var s,n=0,i=t.length;n<i;n++)!s&&n in t||(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))}([r],function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var s,n,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(s=i.next()).done;)a.push(s.value)}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a}(s),!1))},e.prototype.bind=function(e,t){return t},e.prototype.enable=function(){return this},e.prototype.disable=function(){return this},e}(),i=r(9627),a=r(4892),o="context",c=new n,_=function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalContextManager=function(e){return(0,i.$G)(o,e,a.K.instance())},e.prototype.active=function(){return this._getContextManager().active()},e.prototype.with=function(e,t,r){for(var s,n=[],i=3;i<arguments.length;i++)n[i-3]=arguments[i];return(s=this._getContextManager()).with.apply(s,function(e,t,r){if(r||2===arguments.length)for(var s,n=0,i=t.length;n<i;n++)!s&&n in t||(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))}([e,t,r],function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var s,n,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(s=i.next()).done;)a.push(s.value)}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a}(n),!1))},e.prototype.bind=function(e,t){return this._getContextManager().bind(e,t)},e.prototype._getContextManager=function(){return(0,i.mS)(o)||c},e.prototype.disable=function(){this._getContextManager().disable(),(0,i.kv)(o,a.K.instance())},e}()},4892:(e,t,r)=>{"use strict";r.d(t,{K:()=>o});var s=r(9627),n=function(){function e(e){this._namespace=e.namespace||"DiagComponentLogger"}return e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return i("debug",this._namespace,e)},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return i("error",this._namespace,e)},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return i("info",this._namespace,e)},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return i("warn",this._namespace,e)},e.prototype.verbose=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return i("verbose",this._namespace,e)},e}();function i(e,t,r){var n=(0,s.mS)("diag");if(n)return r.unshift(t),n[e].apply(n,function(e,t,r){if(r||2===arguments.length)for(var s,n=0,i=t.length;n<i;n++)!s&&n in t||(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))}([],function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var s,n,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(s=i.next()).done;)a.push(s.value)}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a}(r),!1))}var a=r(6733),o=function(){function e(){function e(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=(0,s.mS)("diag");if(n)return n[e].apply(n,function(e,t,r){if(r||2===arguments.length)for(var s,n=0,i=t.length;n<i;n++)!s&&n in t||(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))}([],function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var s,n,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(s=i.next()).done;)a.push(s.value)}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a}(t),!1))}}var t=this;t.setLogger=function(e,r){var n,i,o;if(void 0===r&&(r={logLevel:a.u.INFO}),e===t){var c=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return t.error(null!==(n=c.stack)&&void 0!==n?n:c.message),!1}"number"==typeof r&&(r={logLevel:r});var _=(0,s.mS)("diag"),u=function(e,t){function r(r,s){var n=t[r];return"function"==typeof n&&e>=s?n.bind(t):function(){}}return e<a.u.NONE?e=a.u.NONE:e>a.u.ALL&&(e=a.u.ALL),t=t||{},{error:r("error",a.u.ERROR),warn:r("warn",a.u.WARN),info:r("info",a.u.INFO),debug:r("debug",a.u.DEBUG),verbose:r("verbose",a.u.VERBOSE)}}(null!==(i=r.logLevel)&&void 0!==i?i:a.u.INFO,e);if(_&&!r.suppressOverrideMessage){var l=null!==(o=(new Error).stack)&&void 0!==o?o:"<failed to generate stacktrace>";_.warn("Current logger will be overwritten from "+l),u.warn("Current logger will overwrite one already registered from "+l)}return(0,s.$G)("diag",u,t,!0)},t.disable=function(){(0,s.kv)("diag",t)},t.createComponentLogger=function(e){return new n(e)},t.verbose=e("verbose"),t.debug=e("debug"),t.info=e("info"),t.warn=e("warn"),t.error=e("error")}return e.instance=function(){return this._instance||(this._instance=new e),this._instance},e}()},1616:(e,t,r)=>{"use strict";r.d(t,{B:()=>c,L:()=>o});var s=r(4892),n=function(){function e(e){this._entries=e?new Map(e):new Map}return e.prototype.getEntry=function(e){var t=this._entries.get(e);if(t)return Object.assign({},t)},e.prototype.getAllEntries=function(){return Array.from(this._entries.entries()).map((function(e){var t=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var s,n,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(s=i.next()).done;)a.push(s.value)}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a}(e,2);return[t[0],t[1]]}))},e.prototype.setEntry=function(t,r){var s=new e(this._entries);return s._entries.set(t,r),s},e.prototype.removeEntry=function(t){var r=new e(this._entries);return r._entries.delete(t),r},e.prototype.removeEntries=function(){for(var t,r,s=[],n=0;n<arguments.length;n++)s[n]=arguments[n];var i=new e(this._entries);try{for(var a=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],s=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&s>=e.length&&(e=void 0),{value:e&&e[s++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(s),o=a.next();!o.done;o=a.next()){var c=o.value;i._entries.delete(c)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}return i},e.prototype.clear=function(){return new e},e}(),i=Symbol("BaggageEntryMetadata"),a=s.K.instance();function o(e){return void 0===e&&(e={}),new n(new Map(Object.entries(e)))}function c(e){return"string"!=typeof e&&(a.error("Cannot create baggage metadata from unknown type: "+typeof e),e=""),{__TYPE__:i,toString:function(){return e}}}},1844:(e,t,r)=>{"use strict";r.d(t,{_:()=>s});var s=r(9100)._.getInstance()},8729:(e,t,r)=>{"use strict";function s(e){return Symbol.for(e)}r.d(t,{l:()=>n,n:()=>s});var n=new function e(t){var r=this;r._currentContext=t?new Map(t):new Map,r.getValue=function(e){return r._currentContext.get(e)},r.setValue=function(t,s){var n=new e(r._currentContext);return n._currentContext.set(t,s),n},r.deleteValue=function(t){var s=new e(r._currentContext);return s._currentContext.delete(t),s}}},8758:(e,t,r)=>{"use strict";r.d(t,{s:()=>s});var s=r(4892).K.instance()},6733:(e,t,r)=>{"use strict";var s;r.d(t,{u:()=>s}),function(e){e[e.NONE=0]="NONE",e[e.ERROR=30]="ERROR",e[e.WARN=50]="WARN",e[e.INFO=60]="INFO",e[e.DEBUG=70]="DEBUG",e[e.VERBOSE=80]="VERBOSE",e[e.ALL=9999]="ALL"}(s||(s={}))},350:(e,t,r)=>{"use strict";r.r(t),r.d(t,{DiagConsoleLogger:()=>c,DiagLogLevel:()=>_.u,INVALID_SPANID:()=>$.w9,INVALID_SPAN_CONTEXT:()=>$.dM,INVALID_TRACEID:()=>$.RH,ProxyTracer:()=>L.y,ProxyTracerProvider:()=>N.n,ROOT_CONTEXT:()=>a.l,SamplingDecision:()=>M.i,SpanKind:()=>C,SpanStatusCode:()=>P,TraceFlags:()=>x.X,ValueType:()=>n,baggageEntryMetadataFromString:()=>i.B,context:()=>Y._,createContextKey:()=>a.n,createNoopMeter:()=>v,createTraceState:()=>V,default:()=>Q,defaultTextMapGetter:()=>D.q,defaultTextMapSetter:()=>D.U,diag:()=>H.s,isSpanContextValid:()=>j.YA,isValidSpanId:()=>j.wN,isValidTraceId:()=>j.hX,metrics:()=>J,propagation:()=>W.$,trace:()=>z.u});var s,n,i=r(1616),a=r(8729),o=[{n:"error",c:"error"},{n:"warn",c:"warn"},{n:"info",c:"info"},{n:"debug",c:"debug"},{n:"verbose",c:"trace"}],c=function(){function e(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(console){var s=console[e];if("function"!=typeof s&&(s=console.log),"function"==typeof s)return s.apply(console,t)}}}for(var t=0;t<o.length;t++)this[o[t].n]=e(o[t].c)},_=r(6733),u=(s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},s(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),l=function(){function e(){}return e.prototype.createHistogram=function(e,t){return R},e.prototype.createCounter=function(e,t){return I},e.prototype.createUpDownCounter=function(e,t){return A},e.prototype.createObservableGauge=function(e,t){return b},e.prototype.createObservableCounter=function(e,t){return y},e.prototype.createObservableUpDownCounter=function(e,t){return O},e.prototype.addBatchObservableCallback=function(e,t){},e.prototype.removeBatchObservableCallback=function(e){},e}(),p=function(){},d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),t.prototype.add=function(e,t){},t}(p),h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),t.prototype.add=function(e,t){},t}(p),g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),t.prototype.record=function(e,t){},t}(p),E=function(){function e(){}return e.prototype.addCallback=function(e){},e.prototype.removeCallback=function(e){},e}(),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),t}(E),T=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),t}(E),m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),t}(E),S=new l,I=new d,R=new g,A=new h,y=new f,b=new T,O=new m;function v(){return S}!function(e){e[e.INT=0]="INT",e[e.DOUBLE=1]="DOUBLE"}(n||(n={}));var C,P,D=r(2009),L=r(9505),N=r(4975),M=r(2674);!function(e){e[e.INTERNAL=0]="INTERNAL",e[e.SERVER=1]="SERVER",e[e.CLIENT=2]="CLIENT",e[e.PRODUCER=3]="PRODUCER",e[e.CONSUMER=4]="CONSUMER"}(C||(C={})),function(e){e[e.UNSET=0]="UNSET",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR"}(P||(P={}));var x=r(7397),U="[_0-9a-z-*/]",w=new RegExp("^(?:[a-z]"+U+"{0,255}|[a-z0-9]"+U+"{0,240}@[a-z]"+U+"{0,13})$"),B=/^[ -~]{0,255}[!-~]$/,k=/,|=/,G=function(){function e(e){this._internalState=new Map,e&&this._parse(e)}return e.prototype.set=function(e,t){var r=this._clone();return r._internalState.has(e)&&r._internalState.delete(e),r._internalState.set(e,t),r},e.prototype.unset=function(e){var t=this._clone();return t._internalState.delete(e),t},e.prototype.get=function(e){return this._internalState.get(e)},e.prototype.serialize=function(){var e=this;return this._keys().reduce((function(t,r){return t.push(r+"="+e.get(r)),t}),[]).join(",")},e.prototype._parse=function(e){e.length>512||(this._internalState=e.split(",").reverse().reduce((function(e,t){var r=t.trim(),s=r.indexOf("=");if(-1!==s){var n=r.slice(0,s),i=r.slice(s+1,t.length);(function(e){return w.test(e)})(n)&&function(e){return B.test(e)&&!k.test(e)}(i)&&e.set(n,i)}return e}),new Map),this._internalState.size>32&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,32))))},e.prototype._keys=function(){return Array.from(this._internalState.keys()).reverse()},e.prototype._clone=function(){var t=new e;return t._internalState=new Map(this._internalState),t},e}();function V(e){return new G(e)}var j=r(7823),$=r(7872),Y=r(1844),H=r(8758),F=new(function(){function e(){}return e.prototype.getMeter=function(e,t,r){return S},e}()),K=r(9627),q=r(4892),X="metrics",J=function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalMeterProvider=function(e){return(0,K.$G)(X,e,q.K.instance())},e.prototype.getMeterProvider=function(){return(0,K.mS)(X)||F},e.prototype.getMeter=function(e,t,r){return this.getMeterProvider().getMeter(e,t,r)},e.prototype.disable=function(){(0,K.kv)(X,q.K.instance())},e}().getInstance(),W=r(9348),z=r(6664);const Q={context:Y._,diag:H.s,metrics:J,propagation:W.$,trace:z.u}},9627:(e,t,r)=>{"use strict";r.d(t,{mS:()=>l,$G:()=>u,kv:()=>p});var s="object"==typeof globalThis?globalThis:global,n="1.8.0",i=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/,a=function(e){var t=new Set([e]),r=new Set,s=e.match(i);if(!s)return function(){return!1};var n=+s[1],a=+s[2],o=+s[3];if(null!=s[4])return function(t){return t===e};function c(e){return r.add(e),!1}function _(e){return t.add(e),!0}return function(e){if(t.has(e))return!0;if(r.has(e))return!1;var s=e.match(i);if(!s)return c(e);var u=+s[1],l=+s[2],p=+s[3];return null!=s[4]||n!==u?c(e):0===n?a===l&&o<=p?_(e):c(e):a<=l?_(e):c(e)}}(n),o=n.split(".")[0],c=Symbol.for("opentelemetry.js.api."+o),_=s;function u(e,t,r,s){var i;void 0===s&&(s=!1);var a=_[c]=null!==(i=_[c])&&void 0!==i?i:{version:n};if(!s&&a[e]){var o=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+e);return r.error(o.stack||o.message),!1}return a.version!==n?(o=new Error("@opentelemetry/api: Registration of version v"+a.version+" for "+e+" does not match previously registered API v"+n),r.error(o.stack||o.message),!1):(a[e]=t,r.debug("@opentelemetry/api: Registered a global for "+e+" v"+n+"."),!0)}function l(e){var t,r,s=null===(t=_[c])||void 0===t?void 0:t.version;if(s&&a(s))return null===(r=_[c])||void 0===r?void 0:r[e]}function p(e,t){t.debug("@opentelemetry/api: Unregistering a global for "+e+" v"+n+".");var r=_[c];r&&delete r[e]}},9348:(e,t,r)=>{"use strict";r.d(t,{$:()=>f});var s=r(9627),n=function(){function e(){}return e.prototype.inject=function(e,t){},e.prototype.extract=function(e,t){return e},e.prototype.fields=function(){return[]},e}(),i=r(2009),a=r(9100),o=(0,r(8729).n)("OpenTelemetry Baggage Key");function c(e){return e.getValue(o)||void 0}function _(){return c(a._.getInstance().active())}function u(e,t){return e.setValue(o,t)}function l(e){return e.deleteValue(o)}var p=r(1616),d=r(4892),h="propagation",g=new n,E=function(){function e(){this.createBaggage=p.L,this.getBaggage=c,this.getActiveBaggage=_,this.setBaggage=u,this.deleteBaggage=l}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalPropagator=function(e){return(0,s.$G)(h,e,d.K.instance())},e.prototype.inject=function(e,t,r){return void 0===r&&(r=i.U),this._getGlobalPropagator().inject(e,t,r)},e.prototype.extract=function(e,t,r){return void 0===r&&(r=i.q),this._getGlobalPropagator().extract(e,t,r)},e.prototype.fields=function(){return this._getGlobalPropagator().fields()},e.prototype.disable=function(){(0,s.kv)(h,d.K.instance())},e.prototype._getGlobalPropagator=function(){return(0,s.mS)(h)||g},e}(),f=E.getInstance()},2009:(e,t,r)=>{"use strict";r.d(t,{U:()=>n,q:()=>s});var s={get:function(e,t){if(null!=e)return e[t]},keys:function(e){return null==e?[]:Object.keys(e)}},n={set:function(e,t,r){null!=e&&(e[t]=r)}}},6664:(e,t,r)=>{"use strict";r.d(t,{u:()=>_});var s=r(9627),n=r(4975),i=r(7823),a=r(3299),o=r(4892),c="trace",_=function(){function e(){this._proxyTracerProvider=new n.n,this.wrapSpanContext=i.IP,this.isSpanContextValid=i.YA,this.deleteSpan=a.EW,this.getSpan=a.fU,this.getActiveSpan=a.Bk,this.getSpanContext=a.w8,this.setSpan=a.Bx,this.setSpanContext=a.g_}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalTracerProvider=function(e){var t=(0,s.$G)(c,this._proxyTracerProvider,o.K.instance());return t&&this._proxyTracerProvider.setDelegate(e),t},e.prototype.getTracerProvider=function(){return(0,s.mS)(c)||this._proxyTracerProvider},e.prototype.getTracer=function(e,t){return this.getTracerProvider().getTracer(e,t)},e.prototype.disable=function(){(0,s.kv)(c,o.K.instance()),this._proxyTracerProvider=new n.n},e}().getInstance()},1440:(e,t,r)=>{"use strict";r.d(t,{d:()=>n});var s=r(7872),n=function(){function e(e){void 0===e&&(e=s.dM),this._spanContext=e}return e.prototype.spanContext=function(){return this._spanContext},e.prototype.setAttribute=function(e,t){return this},e.prototype.setAttributes=function(e){return this},e.prototype.addEvent=function(e,t){return this},e.prototype.setStatus=function(e){return this},e.prototype.updateName=function(e){return this},e.prototype.end=function(e){},e.prototype.isRecording=function(){return!1},e.prototype.recordException=function(e,t){},e}()},9755:(e,t,r)=>{"use strict";r.d(t,{o:()=>c});var s=r(9100),n=r(3299),i=r(1440),a=r(7823),o=s._.getInstance(),c=function(){function e(){}return e.prototype.startSpan=function(e,t,r){if(void 0===r&&(r=o.active()),Boolean(null==t?void 0:t.root))return new i.d;var s,c=r&&(0,n.w8)(r);return"object"==typeof(s=c)&&"string"==typeof s.spanId&&"string"==typeof s.traceId&&"number"==typeof s.traceFlags&&(0,a.YA)(c)?new i.d(c):new i.d},e.prototype.startActiveSpan=function(e,t,r,s){var i,a,c;if(!(arguments.length<2)){2===arguments.length?c=t:3===arguments.length?(i=t,c=r):(i=t,a=r,c=s);var _=null!=a?a:o.active(),u=this.startSpan(e,i,_),l=(0,n.Bx)(_,u);return o.with(l,c,void 0,u)}},e}()},9505:(e,t,r)=>{"use strict";r.d(t,{y:()=>n});var s=new(r(9755).o),n=function(){function e(e,t,r,s){this._provider=e,this.name=t,this.version=r,this.options=s}return e.prototype.startSpan=function(e,t,r){return this._getTracer().startSpan(e,t,r)},e.prototype.startActiveSpan=function(e,t,r,s){var n=this._getTracer();return Reflect.apply(n.startActiveSpan,n,arguments)},e.prototype._getTracer=function(){if(this._delegate)return this._delegate;var e=this._provider.getDelegateTracer(this.name,this.version,this.options);return e?(this._delegate=e,this._delegate):s},e}()},4975:(e,t,r)=>{"use strict";r.d(t,{n:()=>a});var s=r(9505),n=r(9755),i=new(function(){function e(){}return e.prototype.getTracer=function(e,t,r){return new n.o},e}()),a=function(){function e(){}return e.prototype.getTracer=function(e,t,r){var n;return null!==(n=this.getDelegateTracer(e,t,r))&&void 0!==n?n:new s.y(this,e,t,r)},e.prototype.getDelegate=function(){var e;return null!==(e=this._delegate)&&void 0!==e?e:i},e.prototype.setDelegate=function(e){this._delegate=e},e.prototype.getDelegateTracer=function(e,t,r){var s;return null===(s=this._delegate)||void 0===s?void 0:s.getTracer(e,t,r)},e}()},2674:(e,t,r)=>{"use strict";var s;r.d(t,{i:()=>s}),function(e){e[e.NOT_RECORD=0]="NOT_RECORD",e[e.RECORD=1]="RECORD",e[e.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"}(s||(s={}))},3299:(e,t,r)=>{"use strict";r.d(t,{Bk:()=>c,Bx:()=>_,EW:()=>u,fU:()=>o,g_:()=>l,w8:()=>p});var s=r(8729),n=r(1440),i=r(9100),a=(0,s.n)("OpenTelemetry Context Key SPAN");function o(e){return e.getValue(a)||void 0}function c(){return o(i._.getInstance().active())}function _(e,t){return e.setValue(a,t)}function u(e){return e.deleteValue(a)}function l(e,t){return _(e,new n.d(t))}function p(e){var t;return null===(t=o(e))||void 0===t?void 0:t.spanContext()}},7872:(e,t,r)=>{"use strict";r.d(t,{RH:()=>i,dM:()=>a,w9:()=>n});var s=r(7397),n="0000000000000000",i="00000000000000000000000000000000",a={traceId:i,spanId:n,traceFlags:s.X.NONE}},7823:(e,t,r)=>{"use strict";r.d(t,{IP:()=>u,YA:()=>_,hX:()=>o,wN:()=>c});var s=r(7872),n=r(1440),i=/^([0-9a-f]{32})$/i,a=/^[0-9a-f]{16}$/i;function o(e){return i.test(e)&&e!==s.RH}function c(e){return a.test(e)&&e!==s.w9}function _(e){return o(e.traceId)&&c(e.spanId)}function u(e){return new n.d(e)}},7397:(e,t,r)=>{"use strict";var s;r.d(t,{X:()=>s}),function(e){e[e.NONE=0]="NONE",e[e.SAMPLED=1]="SAMPLED"}(s||(s={}))},6372:(e,t,r)=>{"use strict";r.r(t),r.d(t,{AlwaysOffSampler:()=>tt,AlwaysOnSampler:()=>rt,AnchoredClock:()=>R,BindOnceFuture:()=>xt,CompositePropagator:()=>Me,DEFAULT_ATTRIBUTE_COUNT_LIMIT:()=>ue,DEFAULT_ATTRIBUTE_VALUE_LENGTH_LIMIT:()=>_e,DEFAULT_ENVIRONMENT:()=>de,DEFAULT_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT:()=>le,DEFAULT_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT:()=>pe,ExportResultCode:()=>x,ParentBasedSampler:()=>st,RPCType:()=>Ke,RandomIdGenerator:()=>ve,SDK_INFO:()=>Le,TRACE_PARENT_HEADER:()=>$e,TRACE_STATE_HEADER:()=>Ye,TimeoutError:()=>vt,TraceIdRatioBasedSampler:()=>nt,TraceState:()=>je,TracesSamplerValues:()=>z,VERSION:()=>Q,W3CBaggagePropagator:()=>I,W3CTraceContextPropagator:()=>qe,_globalThis:()=>Re,addHrTimes:()=>W,baggageUtils:()=>s,callWithTimeout:()=>Ct,deleteRPCMetadata:()=>We,getEnv:()=>Ie,getEnvWithoutDefaults:()=>Se,getRPCMetadata:()=>ze,getTimeOrigin:()=>V,globalErrorHandler:()=>M,hexToBase64:()=>Oe,hrTime:()=>j,hrTimeDuration:()=>Y,hrTimeToMicroseconds:()=>q,hrTimeToMilliseconds:()=>K,hrTimeToNanoseconds:()=>F,hrTimeToTimeStamp:()=>H,internal:()=>wt,isAttributeKey:()=>v,isAttributeValue:()=>C,isTimeInput:()=>J,isTimeInputHrTime:()=>X,isTracingSuppressed:()=>_,isUrlIgnored:()=>Lt,isWrapped:()=>Nt,loggingErrorHandler:()=>D,merge:()=>ft,millisToHrTime:()=>G,otperformance:()=>U,parseEnvironment:()=>me,parseTraceParent:()=>Fe,sanitizeAttributes:()=>O,setGlobalErrorHandler:()=>N,setRPCMetadata:()=>Je,suppressTracing:()=>o,timeInputToHrTime:()=>$,unrefTimer:()=>Ne,unsuppressTracing:()=>c,urlMatches:()=>Dt});var s={};r.r(s),r.d(s,{getKeyPairs:()=>T,parseKeyPairsIntoRecord:()=>S,parsePairKeyValue:()=>m,serializeKeyPairs:()=>f});var n=r(9348),i=r(8729),a=(0,i.n)("OpenTelemetry SDK Context Key SUPPRESS_TRACING");function o(e){return e.setValue(a,!0)}function c(e){return e.deleteValue(a)}function _(e){return!0===e.getValue(a)}var u="=",l=";",p=",",d="baggage",h=8192,g=r(1616),E=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var s,n,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(s=i.next()).done;)a.push(s.value)}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};function f(e){return e.reduce((function(e,t){var r=""+e+(""!==e?p:"")+t;return r.length>h?e:r}),"")}function T(e){return e.getAllEntries().map((function(e){var t=E(e,2),r=t[0],s=t[1],n=encodeURIComponent(r)+"="+encodeURIComponent(s.value);return void 0!==s.metadata&&(n+=l+s.metadata.toString()),n}))}function m(e){var t=e.split(l);if(!(t.length<=0)){var r=t.shift();if(r){var s=r.split(u);if(2===s.length){var n,i=decodeURIComponent(s[0].trim()),a=decodeURIComponent(s[1].trim());return t.length>0&&(n=(0,g.B)(t.join(l))),{key:i,value:a,metadata:n}}}}}function S(e){return"string"!=typeof e||0===e.length?{}:e.split(p).map((function(e){return m(e)})).filter((function(e){return void 0!==e&&e.value.length>0})).reduce((function(e,t){return e[t.key]=t.value,e}),{})}var I=function(){function e(){}return e.prototype.inject=function(e,t,r){var s=n.$.getBaggage(e);if(s&&!_(e)){var i=f(T(s).filter((function(e){return e.length<=4096})).slice(0,180));i.length>0&&r.set(t,d,i)}},e.prototype.extract=function(e,t,r){var s=r.get(t,d),i=Array.isArray(s)?s.join(p):s;if(!i)return e;var a={};return 0===i.length?e:(i.split(p).forEach((function(e){var t=m(e);if(t){var r={value:t.value};t.metadata&&(r.metadata=t.metadata),a[t.key]=r}})),0===Object.entries(a).length?e:n.$.setBaggage(e,n.$.createBaggage(a)))},e.prototype.fields=function(){return[d]},e}(),R=function(){function e(e,t){this._monotonicClock=t,this._epochMillis=e.now(),this._performanceMillis=t.now()}return e.prototype.now=function(){var e=this._monotonicClock.now()-this._performanceMillis;return this._epochMillis+e},e}(),A=r(8758),y=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],s=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&s>=e.length&&(e=void 0),{value:e&&e[s++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},b=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var s,n,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(s=i.next()).done;)a.push(s.value)}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};function O(e){var t,r,s={};if("object"!=typeof e||null==e)return s;try{for(var n=y(Object.entries(e)),i=n.next();!i.done;i=n.next()){var a=b(i.value,2),o=a[0],c=a[1];v(o)?C(c)?Array.isArray(c)?s[o]=c.slice():s[o]=c:A.s.warn("Invalid attribute value set for key: "+o):A.s.warn("Invalid attribute key: "+o)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}return s}function v(e){return"string"==typeof e&&e.length>0}function C(e){return null==e||(Array.isArray(e)?function(e){var t,r,s;try{for(var n=y(e),i=n.next();!i.done;i=n.next()){var a=i.value;if(null!=a){if(!s){if(P(a)){s=typeof a;continue}return!1}if(typeof a!==s)return!1}}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}return!0}(e):P(e))}function P(e){switch(typeof e){case"number":case"boolean":case"string":return!0}return!1}function D(){return function(e){A.s.error(function(e){return"string"==typeof e?e:JSON.stringify(function(e){for(var t={},r=e;null!==r;)Object.getOwnPropertyNames(r).forEach((function(e){if(!t[e]){var s=r[e];s&&(t[e]=String(s))}})),r=Object.getPrototypeOf(r);return t}(e))}(e))}}var L=D();function N(e){L=e}function M(e){try{L(e)}catch(e){}}var x,U=r(2987).performance,w=9,B=Math.pow(10,6),k=Math.pow(10,w);function G(e){var t=e/1e3;return[Math.trunc(t),Math.round(e%1e3*B)]}function V(){var e=U.timeOrigin;if("number"!=typeof e){var t=U;e=t.timing&&t.timing.fetchStart}return e}function j(e){return W(G(V()),G("number"==typeof e?e:U.now()))}function $(e){if(X(e))return e;if("number"==typeof e)return e<V()?j(e):G(e);if(e instanceof Date)return G(e.getTime());throw TypeError("Invalid input type")}function Y(e,t){var r=t[0]-e[0],s=t[1]-e[1];return s<0&&(r-=1,s+=k),[r,s]}function H(e){var t=w,r=""+"0".repeat(t)+e[1]+"Z",s=r.substr(r.length-t-1);return new Date(1e3*e[0]).toISOString().replace("000Z",s)}function F(e){return e[0]*k+e[1]}function K(e){return Math.round(1e3*e[0]+e[1]/1e6)}function q(e){return Math.round(1e6*e[0]+e[1]/1e3)}function X(e){return Array.isArray(e)&&2===e.length&&"number"==typeof e[0]&&"number"==typeof e[1]}function J(e){return X(e)||"number"==typeof e||e instanceof Date}function W(e,t){var r=[e[0]+t[0],e[1]+t[1]];return r[1]>=k&&(r[1]-=k,r[0]+=1),r}!function(e){e[e.SUCCESS=0]="SUCCESS",e[e.FAILED=1]="FAILED"}(x||(x={}));var z,Q="1.14.0",Z=r(857),ee=r(6733);!function(e){e.AlwaysOff="always_off",e.AlwaysOn="always_on",e.ParentBasedAlwaysOff="parentbased_always_off",e.ParentBasedAlwaysOn="parentbased_always_on",e.ParentBasedTraceIdRatio="parentbased_traceidratio",e.TraceIdRatio="traceidratio"}(z||(z={}));var te="object"==typeof globalThis?globalThis:"object"==typeof self?self:"object"==typeof window?window:"object"==typeof global?global:{},re=",",se=["OTEL_SDK_DISABLED"];function ne(e){return se.indexOf(e)>-1}var ie=["OTEL_BSP_EXPORT_TIMEOUT","OTEL_BSP_MAX_EXPORT_BATCH_SIZE","OTEL_BSP_MAX_QUEUE_SIZE","OTEL_BSP_SCHEDULE_DELAY","OTEL_BLRP_EXPORT_TIMEOUT","OTEL_BLRP_MAX_EXPORT_BATCH_SIZE","OTEL_BLRP_MAX_QUEUE_SIZE","OTEL_BLRP_SCHEDULE_DELAY","OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT","OTEL_ATTRIBUTE_COUNT_LIMIT","OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT","OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT","OTEL_LOGRECORD_ATTRIBUTE_VALUE_LENGTH_LIMIT","OTEL_LOGRECORD_ATTRIBUTE_COUNT_LIMIT","OTEL_SPAN_EVENT_COUNT_LIMIT","OTEL_SPAN_LINK_COUNT_LIMIT","OTEL_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT","OTEL_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT","OTEL_EXPORTER_OTLP_TIMEOUT","OTEL_EXPORTER_OTLP_TRACES_TIMEOUT","OTEL_EXPORTER_OTLP_METRICS_TIMEOUT","OTEL_EXPORTER_OTLP_LOGS_TIMEOUT","OTEL_EXPORTER_JAEGER_AGENT_PORT"];function ae(e){return ie.indexOf(e)>-1}var oe=["OTEL_NO_PATCH_MODULES","OTEL_PROPAGATORS"];function ce(e){return oe.indexOf(e)>-1}var _e=1/0,ue=128,le=128,pe=128,de={OTEL_SDK_DISABLED:!1,CONTAINER_NAME:"",ECS_CONTAINER_METADATA_URI_V4:"",ECS_CONTAINER_METADATA_URI:"",HOSTNAME:"",KUBERNETES_SERVICE_HOST:"",NAMESPACE:"",OTEL_BSP_EXPORT_TIMEOUT:3e4,OTEL_BSP_MAX_EXPORT_BATCH_SIZE:512,OTEL_BSP_MAX_QUEUE_SIZE:2048,OTEL_BSP_SCHEDULE_DELAY:5e3,OTEL_BLRP_EXPORT_TIMEOUT:3e4,OTEL_BLRP_MAX_EXPORT_BATCH_SIZE:512,OTEL_BLRP_MAX_QUEUE_SIZE:2048,OTEL_BLRP_SCHEDULE_DELAY:5e3,OTEL_EXPORTER_JAEGER_AGENT_HOST:"",OTEL_EXPORTER_JAEGER_AGENT_PORT:6832,OTEL_EXPORTER_JAEGER_ENDPOINT:"",OTEL_EXPORTER_JAEGER_PASSWORD:"",OTEL_EXPORTER_JAEGER_USER:"",OTEL_EXPORTER_OTLP_ENDPOINT:"",OTEL_EXPORTER_OTLP_TRACES_ENDPOINT:"",OTEL_EXPORTER_OTLP_METRICS_ENDPOINT:"",OTEL_EXPORTER_OTLP_LOGS_ENDPOINT:"",OTEL_EXPORTER_OTLP_HEADERS:"",OTEL_EXPORTER_OTLP_TRACES_HEADERS:"",OTEL_EXPORTER_OTLP_METRICS_HEADERS:"",OTEL_EXPORTER_OTLP_LOGS_HEADERS:"",OTEL_EXPORTER_OTLP_TIMEOUT:1e4,OTEL_EXPORTER_OTLP_TRACES_TIMEOUT:1e4,OTEL_EXPORTER_OTLP_METRICS_TIMEOUT:1e4,OTEL_EXPORTER_OTLP_LOGS_TIMEOUT:1e4,OTEL_EXPORTER_ZIPKIN_ENDPOINT:"http://localhost:9411/api/v2/spans",OTEL_LOG_LEVEL:ee.u.INFO,OTEL_NO_PATCH_MODULES:[],OTEL_PROPAGATORS:["tracecontext","baggage"],OTEL_RESOURCE_ATTRIBUTES:"",OTEL_SERVICE_NAME:"",OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT:_e,OTEL_ATTRIBUTE_COUNT_LIMIT:ue,OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT:_e,OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT:ue,OTEL_LOGRECORD_ATTRIBUTE_VALUE_LENGTH_LIMIT:_e,OTEL_LOGRECORD_ATTRIBUTE_COUNT_LIMIT:ue,OTEL_SPAN_EVENT_COUNT_LIMIT:128,OTEL_SPAN_LINK_COUNT_LIMIT:128,OTEL_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT:le,OTEL_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT:pe,OTEL_TRACES_EXPORTER:"",OTEL_TRACES_SAMPLER:z.ParentBasedAlwaysOn,OTEL_TRACES_SAMPLER_ARG:"",OTEL_LOGS_EXPORTER:"",OTEL_EXPORTER_OTLP_INSECURE:"",OTEL_EXPORTER_OTLP_TRACES_INSECURE:"",OTEL_EXPORTER_OTLP_METRICS_INSECURE:"",OTEL_EXPORTER_OTLP_LOGS_INSECURE:"",OTEL_EXPORTER_OTLP_CERTIFICATE:"",OTEL_EXPORTER_OTLP_TRACES_CERTIFICATE:"",OTEL_EXPORTER_OTLP_METRICS_CERTIFICATE:"",OTEL_EXPORTER_OTLP_LOGS_CERTIFICATE:"",OTEL_EXPORTER_OTLP_COMPRESSION:"",OTEL_EXPORTER_OTLP_TRACES_COMPRESSION:"",OTEL_EXPORTER_OTLP_METRICS_COMPRESSION:"",OTEL_EXPORTER_OTLP_LOGS_COMPRESSION:"",OTEL_EXPORTER_OTLP_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_TRACES_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_METRICS_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_LOGS_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_TRACES_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_METRICS_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_LOGS_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_TRACES_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_METRICS_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_LOGS_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_METRICS_TEMPORALITY_PREFERENCE:"cumulative"};function he(e,t,r){if(void 0!==r[e]){var s=String(r[e]);t[e]="true"===s.toLowerCase()}}function ge(e,t,r,s,n){if(void 0===s&&(s=-1/0),void 0===n&&(n=1/0),void 0!==r[e]){var i=Number(r[e]);isNaN(i)||(t[e]=i<s?s:i>n?n:i)}}function Ee(e,t,r,s){void 0===s&&(s=re);var n=r[e];"string"==typeof n&&(t[e]=n.split(s).map((function(e){return e.trim()})))}var fe={ALL:ee.u.ALL,VERBOSE:ee.u.VERBOSE,DEBUG:ee.u.DEBUG,INFO:ee.u.INFO,WARN:ee.u.WARN,ERROR:ee.u.ERROR,NONE:ee.u.NONE};function Te(e,t,r){var s=r[e];if("string"==typeof s){var n=fe[s.toUpperCase()];null!=n&&(t[e]=n)}}function me(e){var t={};for(var r in de){var s=r;if("OTEL_LOG_LEVEL"===s)Te(s,t,e);else if(ne(s))he(s,t,e);else if(ae(s))ge(s,t,e);else if(ce(s))Ee(s,t,e);else{var n=e[s];null!=n&&(t[s]=String(n))}}return t}function Se(){return"undefined"!=typeof process&&process&&process.env?me(process.env):me(te)}function Ie(){var e=me(process.env);return Object.assign({HOSTNAME:Z.hostname()},de,e)}var Re="object"==typeof globalThis?globalThis:global;function Ae(e){return e>=48&&e<=57?e-48:e>=97&&e<=102?e-87:e-55}var ye=Buffer.alloc(8),be=Buffer.alloc(16);function Oe(e){var t;t=16===e.length?ye:32===e.length?be:Buffer.alloc(e.length/2);for(var r=0,s=0;s<e.length;s+=2){var n=Ae(e.charCodeAt(s)),i=Ae(e.charCodeAt(s+1));t.writeUInt8(n<<4|i,r++)}return t.toString("base64")}var ve=function(){this.generateTraceId=Pe(16),this.generateSpanId=Pe(8)},Ce=Buffer.allocUnsafe(16);function Pe(e){return function(){for(var t=0;t<e/4;t++)Ce.writeUInt32BE(Math.random()*Math.pow(2,32)>>>0,4*t);for(t=0;t<e&&!(Ce[t]>0);t++)t===e-1&&(Ce[e-1]=1);return Ce.toString("hex",0,e)}}var De,Le=((De={})["telemetry.sdk.name"]="opentelemetry",De["process.runtime.name"]="node",De["telemetry.sdk.language"]="nodejs",De["telemetry.sdk.version"]=Q,De);function Ne(e){e.unref()}var Me=function(){function e(e){var t;void 0===e&&(e={}),this._propagators=null!==(t=e.propagators)&&void 0!==t?t:[],this._fields=Array.from(new Set(this._propagators.map((function(e){return"function"==typeof e.fields?e.fields():[]})).reduce((function(e,t){return e.concat(t)}),[])))}return e.prototype.inject=function(e,t,r){var s,n;try{for(var i=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],s=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&s>=e.length&&(e=void 0),{value:e&&e[s++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(this._propagators),a=i.next();!a.done;a=i.next()){var o=a.value;try{o.inject(e,t,r)}catch(e){A.s.warn("Failed to inject with "+o.constructor.name+". Err: "+e.message)}}}catch(e){s={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(s)throw s.error}}},e.prototype.extract=function(e,t,r){return this._propagators.reduce((function(e,s){try{return s.extract(e,t,r)}catch(e){A.s.warn("Failed to inject with "+s.constructor.name+". Err: "+e.message)}return e}),e)},e.prototype.fields=function(){return this._fields.slice()},e}(),xe=r(6664),Ue=r(7823),we=r(7397),Be="[_0-9a-z-*/]",ke=new RegExp("^(?:[a-z]"+Be+"{0,255}|[a-z0-9]"+Be+"{0,240}@[a-z]"+Be+"{0,13})$"),Ge=/^[ -~]{0,255}[!-~]$/,Ve=/,|=/,je=function(){function e(e){this._internalState=new Map,e&&this._parse(e)}return e.prototype.set=function(e,t){var r=this._clone();return r._internalState.has(e)&&r._internalState.delete(e),r._internalState.set(e,t),r},e.prototype.unset=function(e){var t=this._clone();return t._internalState.delete(e),t},e.prototype.get=function(e){return this._internalState.get(e)},e.prototype.serialize=function(){var e=this;return this._keys().reduce((function(t,r){return t.push(r+"="+e.get(r)),t}),[]).join(",")},e.prototype._parse=function(e){e.length>512||(this._internalState=e.split(",").reverse().reduce((function(e,t){var r=t.trim(),s=r.indexOf("=");if(-1!==s){var n=r.slice(0,s),i=r.slice(s+1,t.length);(function(e){return ke.test(e)})(n)&&function(e){return Ge.test(e)&&!Ve.test(e)}(i)&&e.set(n,i)}return e}),new Map),this._internalState.size>32&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,32))))},e.prototype._keys=function(){return Array.from(this._internalState.keys()).reverse()},e.prototype._clone=function(){var t=new e;return t._internalState=new Map(this._internalState),t},e}(),$e="traceparent",Ye="tracestate",He=new RegExp("^\\s?((?!ff)[\\da-f]{2})-((?![0]{32})[\\da-f]{32})-((?![0]{16})[\\da-f]{16})-([\\da-f]{2})(-.*)?\\s?$");function Fe(e){var t=He.exec(e);return t?"00"===t[1]&&t[5]?null:{traceId:t[2],spanId:t[3],traceFlags:parseInt(t[4],16)}:null}var Ke,qe=function(){function e(){}return e.prototype.inject=function(e,t,r){var s=xe.u.getSpanContext(e);if(s&&!_(e)&&(0,Ue.YA)(s)){var n="00-"+s.traceId+"-"+s.spanId+"-0"+Number(s.traceFlags||we.X.NONE).toString(16);r.set(t,$e,n),s.traceState&&r.set(t,Ye,s.traceState.serialize())}},e.prototype.extract=function(e,t,r){var s=r.get(t,$e);if(!s)return e;var n=Array.isArray(s)?s[0]:s;if("string"!=typeof n)return e;var i=Fe(n);if(!i)return e;i.isRemote=!0;var a=r.get(t,Ye);if(a){var o=Array.isArray(a)?a.join(","):a;i.traceState=new je("string"==typeof o?o:void 0)}return xe.u.setSpanContext(e,i)},e.prototype.fields=function(){return[$e,Ye]},e}(),Xe=(0,i.n)("OpenTelemetry SDK Context Key RPC_METADATA");function Je(e,t){return e.setValue(Xe,t)}function We(e){return e.deleteValue(Xe)}function ze(e){return e.getValue(Xe)}!function(e){e.HTTP="http"}(Ke||(Ke={}));var Qe,Ze,et=r(2674),tt=function(){function e(){}return e.prototype.shouldSample=function(){return{decision:et.i.NOT_RECORD}},e.prototype.toString=function(){return"AlwaysOffSampler"},e}(),rt=function(){function e(){}return e.prototype.shouldSample=function(){return{decision:et.i.RECORD_AND_SAMPLED}},e.prototype.toString=function(){return"AlwaysOnSampler"},e}(),st=function(){function e(e){var t,r,s,n;this._root=e.root,this._root||(M(new Error("ParentBasedSampler must have a root sampler configured")),this._root=new rt),this._remoteParentSampled=null!==(t=e.remoteParentSampled)&&void 0!==t?t:new rt,this._remoteParentNotSampled=null!==(r=e.remoteParentNotSampled)&&void 0!==r?r:new tt,this._localParentSampled=null!==(s=e.localParentSampled)&&void 0!==s?s:new rt,this._localParentNotSampled=null!==(n=e.localParentNotSampled)&&void 0!==n?n:new tt}return e.prototype.shouldSample=function(e,t,r,s,n,i){var a=xe.u.getSpanContext(e);return a&&(0,Ue.YA)(a)?a.isRemote?a.traceFlags&we.X.SAMPLED?this._remoteParentSampled.shouldSample(e,t,r,s,n,i):this._remoteParentNotSampled.shouldSample(e,t,r,s,n,i):a.traceFlags&we.X.SAMPLED?this._localParentSampled.shouldSample(e,t,r,s,n,i):this._localParentNotSampled.shouldSample(e,t,r,s,n,i):this._root.shouldSample(e,t,r,s,n,i)},e.prototype.toString=function(){return"ParentBased{root="+this._root.toString()+", remoteParentSampled="+this._remoteParentSampled.toString()+", remoteParentNotSampled="+this._remoteParentNotSampled.toString()+", localParentSampled="+this._localParentSampled.toString()+", localParentNotSampled="+this._localParentNotSampled.toString()+"}"},e}(),nt=function(){function e(e){void 0===e&&(e=0),this._ratio=e,this._ratio=this._normalize(e),this._upperBound=Math.floor(4294967295*this._ratio)}return e.prototype.shouldSample=function(e,t){return{decision:(0,Ue.hX)(t)&&this._accumulate(t)<this._upperBound?et.i.RECORD_AND_SAMPLED:et.i.NOT_RECORD}},e.prototype.toString=function(){return"TraceIdRatioBased{"+this._ratio+"}"},e.prototype._normalize=function(e){return"number"!=typeof e||isNaN(e)?0:e>=1?1:e<=0?0:e},e.prototype._accumulate=function(e){for(var t=0,r=0;r<e.length/8;r++){var s=8*r;t=(t^parseInt(e.slice(s,s+8),16))>>>0}return t},e}(),it="[object Object]",at="[object Null]",ot="[object Undefined]",ct=Function.prototype.toString,_t=ct.call(Object),ut=(Qe=Object.getPrototypeOf,Ze=Object,function(e){return Qe(Ze(e))}),lt=Object.prototype,pt=lt.hasOwnProperty,dt=Symbol?Symbol.toStringTag:void 0,ht=lt.toString;function gt(e){if(!function(e){return null!=e&&"object"==typeof e}(e)||function(e){return null==e?void 0===e?ot:at:dt&&dt in Object(e)?function(e){var t=pt.call(e,dt),r=e[dt],s=!1;try{e[dt]=void 0,s=!0}catch(e){}var n=ht.call(e);return s&&(t?e[dt]=r:delete e[dt]),n}(e):function(e){return ht.call(e)}(e)}(e)!==it)return!1;var t=ut(e);if(null===t)return!0;var r=pt.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&ct.call(r)===_t}var Et=20;function ft(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=e.shift(),s=new WeakMap;e.length>0;)r=mt(r,e.shift(),0,s);return r}function Tt(e){return It(e)?e.slice():e}function mt(e,t,r,s){var n;if(void 0===r&&(r=0),!(r>Et)){if(r++,yt(e)||yt(t)||Rt(t))n=Tt(t);else if(It(e)){if(n=e.slice(),It(t))for(var i=0,a=t.length;i<a;i++)n.push(Tt(t[i]));else if(At(t))for(i=0,a=(o=Object.keys(t)).length;i<a;i++)n[c=o[i]]=Tt(t[c])}else if(At(e))if(At(t)){if(!function(e,t){return!(!gt(e)||!gt(t))}(e,t))return t;var o;for(n=Object.assign({},e),i=0,a=(o=Object.keys(t)).length;i<a;i++){var c,_=t[c=o[i]];if(yt(_))void 0===_?delete n[c]:n[c]=_;else{var u=n[c],l=_;if(St(e,c,s)||St(t,c,s))delete n[c];else{if(At(u)&&At(l)){var p=s.get(u)||[],d=s.get(l)||[];p.push({obj:e,key:c}),d.push({obj:t,key:c}),s.set(u,p),s.set(l,d)}n[c]=mt(n[c],_,r,s)}}}}else n=t;return n}}function St(e,t,r){for(var s=r.get(e[t])||[],n=0,i=s.length;n<i;n++){var a=s[n];if(a.key===t&&a.obj===e)return!0}return!1}function It(e){return Array.isArray(e)}function Rt(e){return"function"==typeof e}function At(e){return!yt(e)&&!It(e)&&!Rt(e)&&"object"==typeof e}function yt(e){return"string"==typeof e||"number"==typeof e||"boolean"==typeof e||void 0===e||e instanceof Date||e instanceof RegExp||null===e}var bt,Ot=(bt=function(e,t){return bt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},bt(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}bt(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),vt=function(e){function t(r){var s=e.call(this,r)||this;return Object.setPrototypeOf(s,t.prototype),s}return Ot(t,e),t}(Error);function Ct(e,t){var r,s=new Promise((function(e,s){r=setTimeout((function(){s(new vt("Operation timed out."))}),t)}));return Promise.race([e,s]).then((function(e){return clearTimeout(r),e}),(function(e){throw clearTimeout(r),e}))}var Pt=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],s=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&s>=e.length&&(e=void 0),{value:e&&e[s++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};function Dt(e,t){return"string"==typeof t?e===t:!!e.match(t)}function Lt(e,t){var r,s;if(!t)return!1;try{for(var n=Pt(t),i=n.next();!i.done;i=n.next())if(Dt(e,i.value))return!0}catch(e){r={error:e}}finally{try{i&&!i.done&&(s=n.return)&&s.call(n)}finally{if(r)throw r.error}}return!1}function Nt(e){return"function"==typeof e&&"function"==typeof e.__original&&"function"==typeof e.__unwrap&&!0===e.__wrapped}var Mt=function(){function e(){var e=this;this._promise=new Promise((function(t,r){e._resolve=t,e._reject=r}))}return Object.defineProperty(e.prototype,"promise",{get:function(){return this._promise},enumerable:!1,configurable:!0}),e.prototype.resolve=function(e){this._resolve(e)},e.prototype.reject=function(e){this._reject(e)},e}(),xt=function(){function e(e,t){this._callback=e,this._that=t,this._isCalled=!1,this._deferred=new Mt}return Object.defineProperty(e.prototype,"isCalled",{get:function(){return this._isCalled},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"promise",{get:function(){return this._deferred.promise},enumerable:!1,configurable:!0}),e.prototype.call=function(){for(var e,t=this,r=[],s=0;s<arguments.length;s++)r[s]=arguments[s];if(!this._isCalled){this._isCalled=!0;try{Promise.resolve((e=this._callback).call.apply(e,function(e,t,r){if(r||2===arguments.length)for(var s,n=0,i=t.length;n<i;n++)!s&&n in t||(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))}([this._that],function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var s,n,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(s=i.next()).done;)a.push(s.value)}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a}(r),!1))).then((function(e){return t._deferred.resolve(e)}),(function(e){return t._deferred.reject(e)}))}catch(e){this._deferred.reject(e)}}return this._deferred.promise},e}(),Ut=r(1844),wt={_export:function(e,t){return new Promise((function(r){Ut._.with(o(Ut._.active()),(function(){e.export(t,(function(e){r(e)}))}))}))}}},4487:(e,t,r)=>{"use strict";const s=r(6982);e.exports="function"==typeof s.randomUUID?s.randomUUID:r(4908)},4908:(e,t,r)=>{"use strict";const s=r(6982),{validateBoolean:n,validateObject:i,codes:{ERR_OPERATION_FAILED:a}}=r(7352),{randomFillSync:o}=s;function c(e){const t=Buffer.alloc(e);return o(t)}let _,u,l,p=0;function d(e,t=0){const r=function(){if(void 0===l){l=new Array(256);for(let e=0;e<l.length;e++){const t=e.toString(16);l[e]=t.padStart(2,"0")}}return l}();return r[e[t]]+r[e[t+1]]+r[e[t+2]]+r[e[t+3]]+"-"+r[e[t+4]]+r[e[t+5]]+"-"+r[15&e[t+6]|64]+r[e[t+7]]+"-"+r[63&e[t+8]|128]+r[e[t+9]]+"-"+r[e[t+10]]+r[e[t+11]]+r[e[t+12]]+r[e[t+13]]+r[e[t+14]]+r[e[t+15]]}e.exports=function(e){void 0!==e&&i(e,"options");const{disableEntropyCache:t=!1}=e||{};return n(t,"options.disableEntropyCache"),t?function(){if(u||(u=c(2048)),void 0===u)throw new a("Out of memory");return o(u),d(u)}():function(){if(_||(_=c(2048)),void 0===_)throw new a("Out of memory");return 0===p&&o(_),p=(p+1)%128,d(_,16*p)}()}},7352:(e,t,r)=>{"use strict";const s=r(2613),n=r(9023),i=["string","function","number","object","Function","Object","boolean","bigint","symbol"];class a extends TypeError{constructor(e){super(`Operation failed: ${e}`),this.code=this.constructor.name,Object.defineProperties(this,{toString:{value(){return`${this.name} [${this.code}]: ${this.message}`},enumerable:!1,writable:!0,configurable:!0}})}}class o extends TypeError{constructor(e,t,r){super(),s("string"==typeof e,"'name' must be a string"),Array.isArray(t)||(t=[t]);let a="The ";if(e.endsWith(" argument"))a+=`${e} `;else{const t=e.includes(".")?"property":"argument";a+=`"${e}" ${t} `}a+="must be ";const o=[],c=[],_=[];for(const e of t)s("string"==typeof e,"All expected entries have to be of type string"),i.includes(e)?o.push(e.toLowerCase()):classRegExp.test(e)?c.push(e):(s("object"!==e,'The value "object" should be written as "Object"'),_.push(e));if(c.length>0){const e=o.indexOf("object");-1!==e&&(o.splice(e,1),c.push("Object"))}if(o.length>0){if(o.length>2){const e=o.pop();a+=`one of type ${o.join(", ")}, or ${e}`}else 2===o.length?a+=`one of type ${o[0]} or ${o[1]}`:a+=`of type ${o[0]}`;(c.length>0||_.length>0)&&(a+=" or ")}if(c.length>0){if(c.length>2){const e=c.pop();a+=`an instance of ${c.join(", ")}, or ${e}`}else a+=`an instance of ${c[0]}`,2===c.length&&(a+=` or ${c[1]}`);_.length>0&&(a+=" or ")}if(_.length>0)if(_.length>2){const e=_.pop();a+=`one of ${_.join(", ")}, or ${e}`}else 2===_.length?a+=`one of ${_[0]} or ${_[1]}`:(_[0].toLowerCase()!==_[0]&&(a+="an "),a+=`${_[0]}`);if(null==r)a+=`. Received ${r}`;else if("function"==typeof r&&r.name)a+=`. Received function ${r.name}`;else if("object"==typeof r)r.constructor&&r.constructor.name?a+=`. Received an instance of ${r.constructor.name}`:a+=`. Received ${n.inspect(r,{depth:-1})}`;else{let e=n.inspect(r,{colors:!1});e.length>25&&(e=`${e.slice(0,25)}...`),a+=`. Received type ${typeof r} (${e})`}this.code=this.constructor.name,Object.defineProperties(this,{message:{value:a,enumerable:!1,writable:!0,configurable:!0},toString:{value(){return`${this.name} [${this.code}]: ${this.message}`},enumerable:!1,writable:!0,configurable:!0}})}}e.exports={validateBoolean:function(e,t){if("boolean"!=typeof e)throw new o(t,"boolean",e)},validateObject:function(e,t,{nullable:r=!1,allowArray:s=!1,allowFunction:n=!1}={}){if(!r&&null===e||!s&&Array.isArray(e)||"object"!=typeof e&&(!n||"function"!=typeof e))throw new o(t,"Object",e)},codes:{ERR_OPERATION_FAILED:a}}},4028:(e,t,r)=>{const{ObjectDefineProperty:s,SymbolFor:n}=r(6884),i=n("dc-polyfill-v1");process[i]||s(process,i,{configurable:!1,enumerable:!1,writable:!1,value:{}}),e.exports=process[i]},6427:e=>{const[t,r,s]=process.versions.node.split(".").map(Number);function n(){return t>20||t>=20&&r>=6}function i(){return t>=16||15===t&&r>=1||14===t&&r>=17}e.exports.MAJOR=t,e.exports.MINOR=r,e.exports.PATCH=s,e.exports.hasFullSupport=n,e.exports.hasTracingChannel=function(){return t>=20},e.exports.hasDiagnosticsChannel=i,e.exports.hasTopSubscribeUnsubscribe=function(){return t>=20||16===t&&r>=17||18===t&&r>=7},e.exports.hasGarbageCollectionBug=function(){return i()&&!n()},e.exports.hasZeroSubscribersBug=function(){return 19===t&&9===r},e.exports.hasChannelStoreMethods=function(){return t>=20||19===t&&r>=9},e.exports.hasChUnsubscribeReturn=function(){return t>=18||14===t&&r>=19||16===t&&r>=14||17===t&&r>=1},e.exports.hasSyncUnsubscribeBug=function(){return 20===t&&r<=5}},1247:(e,t,r)=>{const s=r(6427);r(6884);let n=s.hasDiagnosticsChannel()?r(1637):r(4285);s.hasGarbageCollectionBug()&&(n=r(730)(n)),s.hasTopSubscribeUnsubscribe()||(n=r(1353)(n)),s.hasChUnsubscribeReturn()||(n=r(8075)(n)),s.hasChannelStoreMethods()||(n=r(3671)(n)),s.hasTracingChannel()||(n=r(8879)(n)),s.hasSyncUnsubscribeBug()&&(n=r(5591)(n)),e.exports=n},1857:(e,t,r)=>{const s=r(9023),{ObjectDefineProperties:n}=r(6884);class i extends TypeError{constructor(e,t){if(super(),null==t)e+=`. Received ${t}`;else if("function"==typeof t&&t.name)e+=`. Received function ${t.name}`;else if("object"==typeof t)t.constructor&&t.constructor.name?e+=`. Received an instance of ${t.constructor.name}`:e+=`. Received ${s.inspect(t,{depth:-1})}`;else{let r=s.inspect(t,{colors:!1});r.length>25&&(r=`${r.slice(0,25)}...`),e+=`. Received type ${typeof t} (${r})`}this.code=this.constructor.name,n(this,{message:{value:e,enumerable:!1,writable:!0,configurable:!0},toString:{value(){return`${this.name} [${this.code}]: ${this.message}`},enumerable:!1,writable:!0,configurable:!0}})}}e.exports={ERR_INVALID_ARG_TYPE:i}},3671:(e,t,r)=>{const{ReflectApply:s}=r(6884);function n(e,t,r,s=i){return()=>{let n;try{n=s(t)}catch(e){return process.nextTick((()=>{throw e})),r()}return e.run(n,r)}}function i(e){return e}e.exports=function(e){const t=new WeakSet,r=e.channel,i={...e};return i.channel=function(){const e=r.apply(this,arguments);return t.has(e)||(e._stores=new Map,e.bindStore=function(e,t){this._stores.set(e,t)},e.unbindStore=function(e){return!!this._stores.has(e)&&(this._stores.delete(e),!0)},e.runStores=function(e,t,r,...i){let a=()=>(this.publish(e),s(t,r,i));for(const t of this._stores.entries()){const r=t[0],s=t[1];a=n(r,e,a,s)}return a()}),e},i}},8075:(e,t,r)=>{const{ObjectGetPrototypeOf:s}=r(6884);e.exports=function(e){const t=new WeakSet,r=e.channel,n=(e.Channel,{...e});return n.channel=function(){const e=r.apply(this,arguments);return t.has(e)||(e.unsubscribe=function(){delete e.unsubscribe;const t=this._subscribers.length;return s(e).unsubscribe.apply(this,arguments),this._subscribers.length<t},t.add(e)),e},n}},730:(e,t,r)=>{const s=function(){},{ObjectDefineProperty:n,ObjectGetOwnPropertyDescriptor:i}=r(6884);e.exports=function(e){const t=e.channel,r=new WeakSet,a={...e};return a.channel=function(){const e=t.apply(this,arguments);return r.has(e)||(t(arguments[0]).subscribe(s),r.add(e),i(e,"hasSubscribers")||n(e,"hasSubscribers",{get:function(){const t=e._subscribers;return t.length>1||!(t.length<1)&&t[0]!==s}})),e},a}},5591:e=>{e.exports=function(e){const t=new WeakSet,r=e.channel,s={...e};return s.channel=function(){const e=r.apply(this,arguments);if(t.has(e))return e;const s=e.publish;return e.publish=function(){return e._subscribers||(e._subscribers=[]),s.apply(e,arguments)},e},s}},1353:e=>{e.exports=function(e){const t={...e};return t.subscribe=(e,r)=>t.channel(e).subscribe(r),t.unsubscribe=(e,r)=>t.channel(e).unsubscribe(r),t}},8879:(e,t,r)=>{const{ReflectApply:s,PromiseReject:n,PromiseResolve:i,PromisePrototypeThen:a,ArrayPrototypeSplice:o,ArrayPrototypeAt:c}=r(6884),{ERR_INVALID_ARG_TYPE:_}=r(1857),u=["start","end","asyncStart","asyncEnd","error"];e.exports=function(e){const{channel:t}=e,r={...e};class l{constructor(e){if("string"==typeof e)this.start=t(`tracing:${e}:start`),this.end=t(`tracing:${e}:end`),this.asyncStart=t(`tracing:${e}:asyncStart`),this.asyncEnd=t(`tracing:${e}:asyncEnd`),this.error=t(`tracing:${e}:error`);else{if("object"!=typeof e)throw new _("nameOrChannels",["string","object","Channel"],e);{const{start:t,end:r,asyncStart:s,asyncEnd:n,error:i}=e;this.start=t,this.end=r,this.asyncStart=s,this.asyncEnd=n,this.error=i}}}subscribe(e){for(const t of u)e[t]&&this[t]&&this[t].subscribe(e[t])}unsubscribe(e){let t=!0;for(const r of u)e[r]&&(this[r]&&this[r].unsubscribe(e[r])||(t=!1));return t}traceSync(e,t={},r,...n){const{start:i,end:a,error:o}=this;return i.runStores(t,(()=>{try{const i=s(e,r,n);return t.result=i,i}catch(e){throw t.error=e,o.publish(t),e}finally{a.publish(t)}}))}tracePromise(e,t={},r,...o){const{start:c,end:_,asyncStart:u,asyncEnd:l,error:p}=this;function d(e){return t.error=e,p.publish(t),u.publish(t),l.publish(t),n(e)}function h(e){return t.result=e,u.publish(t),l.publish(t),e}return c.runStores(t,(()=>{try{let t=s(e,r,o);return t instanceof Promise||(t=i(t)),a(t,h,d)}catch(e){throw t.error=e,p.publish(t),e}finally{_.publish(t)}}))}traceCallback(e,t=-1,r={},n,...i){const{start:a,end:u,asyncStart:l,asyncEnd:p,error:d}=this,h=c(i,t);if("function"!=typeof h)throw new _("callback",["function"],h);return o(i,t,1,(function(e,t){e?(r.error=e,d.publish(r)):r.result=t,l.runStores(r,(()=>{try{if(h)return s(h,this,arguments)}finally{p.publish(r)}}))})),a.runStores(r,(()=>{try{return s(e,n,i)}catch(e){throw r.error=e,d.publish(r),e}finally{u.publish(r)}}))}}return r.tracingChannel=function(e){return new l(e)},r}},6884:e=>{const t=e=>(...t)=>e.call(...t),r=Reflect.apply,s=Promise.reject.bind(Promise),n=Promise.resolve,i=t(Promise.prototype.then),a=t(Array.prototype.splice),o=t(Array.prototype.at||function(e){if((e=Math.trunc(e)||0)<0&&(e+=this.length),!(e<0||e>=this.length))return this[e]}),c=Object.defineProperty,_=Object.defineProperties,u=Object.getOwnPropertyDescriptor,l=Object.getPrototypeOf,p=Object.setPrototypeOf,d=Symbol.for;e.exports={ReflectApply:r,PromiseReject:s,PromiseResolve:n,PromisePrototypeThen:i,ArrayPrototypeSplice:a,ArrayPrototypeAt:o,ObjectDefineProperty:c,ObjectDefineProperties:_,ObjectGetOwnPropertyDescriptor:u,ObjectGetPrototypeOf:l,ObjectSetPrototypeOf:p,SymbolFor:d}},4285:(e,t,r)=>{"use strict";const{ObjectSetPrototypeOf:s,ObjectGetPrototypeOf:n}=r(6884),{ERR_INVALID_ARG_TYPE:i}=(r(9023),r(1857)),a=r(4028);class o{subscribe(e){if("function"!=typeof e)throw new i('The "subscription" argument must be of type function',e);this._subscribers.push(e)}unsubscribe(e){const t=this._subscribers.indexOf(e);return-1!==t&&(this._subscribers.splice(t,1),this._subscribers.length||s(this,c.prototype),!0)}get hasSubscribers(){return!0}publish(e){for(let t=0;t<this._subscribers.length;t++)try{(0,this._subscribers[t])(e,this.name)}catch(e){process.nextTick((()=>{throw e}))}}}class c{constructor(e){this._subscribers=void 0,this.name=e}static[Symbol.hasInstance](e){const t=n(e);return t===c.prototype||t===o.prototype}subscribe(e){s(this,o.prototype),this._subscribers=[],this.subscribe(e)}unsubscribe(){return!1}get hasSubscribers(){return!1}publish(){}}e.exports={channel:function(e){const t=a[e];if(t)return t;if("string"!=typeof e&&"symbol"!=typeof e)throw new i('The "channel" argument must be one of type string or symbol',e);return a[e]=new c(e)},hasSubscribers:function(e){const t=a[e];return!!t&&t.hasSubscribers},Channel:c,deleteChannel:function(e){return!!a[e]&&(a[e]=null,!0)}}},2535:e=>{function t(e){return Array.isArray(e)?e:[e]}const r=/^\s+$/,s=/(?:[^\\]|^)\\$/,n=/^\\!/,i=/^\\#/,a=/\r?\n/g,o=/^\.*\/|^\.+$/;let c="node-ignore";"undefined"!=typeof Symbol&&(c=Symbol.for("node-ignore"));const _=c,u=/([0-z])-([0-z])/g,l=()=>!1,p=[[/^\uFEFF/,()=>""],[/\\?\s+$/,e=>0===e.indexOf("\\")?" ":""],[/\\\s/g,()=>" "],[/[\\$.|*+(){^]/g,e=>`\\${e}`],[/(?!\\)\?/g,()=>"[^/]"],[/^\//,()=>"^"],[/\//g,()=>"\\/"],[/^\^*\\\*\\\*\\\//,()=>"^(?:.*\\/)?"],[/^(?=[^^])/,function(){return/\/(?!$)/.test(this)?"^":"(?:^|\\/)"}],[/\\\/\\\*\\\*(?=\\\/|$)/g,(e,t,r)=>t+6<r.length?"(?:\\/[^\\/]+)*":"\\/.+"],[/(^|[^\\]+)(\\\*)+(?=.+)/g,(e,t,r)=>t+r.replace(/\\\*/g,"[^\\/]*")],[/\\\\\\(?=[$.|*+(){^])/g,()=>"\\"],[/\\\\/g,()=>"\\"],[/(\\)?\[([^\]/]*?)(\\*)($|\])/g,(e,t,r,s,n)=>"\\"===t?`\\[${r}${(e=>{const{length:t}=e;return e.slice(0,t-t%2)})(s)}${n}`:"]"===n&&s.length%2==0?`[${(e=>e.replace(u,((e,t,r)=>t.charCodeAt(0)<=r.charCodeAt(0)?e:"")))(r)}${s}]`:"[]"],[/(?:[^*])$/,e=>/\/$/.test(e)?`${e}$`:`${e}(?=$|\\/$)`],[/(\^|\\\/)?\\\*$/,(e,t)=>(t?`${t}[^/]+`:"[^/]*")+"(?=$|\\/$)"]],d=Object.create(null),h=e=>"string"==typeof e;class g{constructor(e,t,r,s){this.origin=e,this.pattern=t,this.negative=r,this.regex=s}}const E=(e,t)=>{throw new t(e)},f=(e,t,r)=>h(e)?e?!f.isNotRelative(e)||r(`path should be a \`path.relative()\`d string, but got "${t}"`,RangeError):r("path must not be empty",TypeError):r(`path must be a string, but got \`${t}\``,TypeError),T=e=>o.test(e);f.isNotRelative=T,f.convert=e=>e;class m{constructor({ignorecase:e=!0,ignoreCase:t=e,allowRelativePaths:r=!1}={}){var s;s=_,Object.defineProperty(this,s,{value:true}),this._rules=[],this._ignoreCase=t,this._allowRelativePaths=r,this._initCache()}_initCache(){this._ignoreCache=Object.create(null),this._testCache=Object.create(null)}_addPattern(e){if(e&&e[_])return this._rules=this._rules.concat(e._rules),void(this._added=!0);if((e=>e&&h(e)&&!r.test(e)&&!s.test(e)&&0!==e.indexOf("#"))(e)){const t=((e,t)=>{const r=e;let s=!1;0===e.indexOf("!")&&(s=!0,e=e.substr(1));const a=((e,t)=>{let r=d[e];return r||(r=p.reduce(((t,r)=>t.replace(r[0],r[1].bind(e))),e),d[e]=r),t?new RegExp(r,"i"):new RegExp(r)})(e=e.replace(n,"!").replace(i,"#"),t);return new g(r,e,s,a)})(e,this._ignoreCase);this._added=!0,this._rules.push(t)}}add(e){return this._added=!1,t(h(e)?(e=>e.split(a))(e):e).forEach(this._addPattern,this),this._added&&this._initCache(),this}addPattern(e){return this.add(e)}_testOne(e,t){let r=!1,s=!1;return this._rules.forEach((n=>{const{negative:i}=n;s===i&&r!==s||i&&!r&&!s&&!t||n.regex.test(e)&&(r=!i,s=i)})),{ignored:r,unignored:s}}_test(e,t,r,s){const n=e&&f.convert(e);return f(n,e,this._allowRelativePaths?l:E),this._t(n,t,r,s)}_t(e,t,r,s){if(e in t)return t[e];if(s||(s=e.split("/")),s.pop(),!s.length)return t[e]=this._testOne(e,r);const n=this._t(s.join("/")+"/",t,r,s);return t[e]=n.ignored?n:this._testOne(e,r)}ignores(e){return this._test(e,this._ignoreCache,!1).ignored}createFilter(){return e=>!this.ignores(e)}filter(e){return t(e).filter(this.createFilter())}test(e){return this._test(e,this._testCache,!0)}}const S=e=>new m(e);if(S.isPathValid=e=>f(e&&f.convert(e),e,l),S.default=S,e.exports=S,"undefined"!=typeof process&&(process.env&&process.env.IGNORE_TEST_WIN32||"win32"===process.platform)){const e=e=>/^\\\\\?\\/.test(e)||/["<>|\u0000-\u001F]+/u.test(e)?e:e.replace(/\\/g,"/");f.convert=e;const t=/^[a-z]:\//i;f.isNotRelative=e=>t.test(e)||T(e)}},1958:(e,t,r)=>{"use strict";const{FileCoverage:s}=r(4709),{CoverageMap:n}=r(3561),{CoverageSummary:i}=r(9455);e.exports={createCoverageSummary:e=>e&&e instanceof i?e:new i(e),createCoverageMap:e=>e&&e instanceof n?e:new n(e),createFileCoverage:e=>e&&e instanceof s?e:new s(e)},e.exports.classes={FileCoverage:s}},3561:(e,t,r)=>{"use strict";const{FileCoverage:s}=r(4709),{CoverageSummary:n}=r(9455);function i(e,t){return e instanceof t?e:new t(e)}class a{constructor(e){this.data=e instanceof a?e.data:function(e){const t=Object.create(null);return e?(Object.entries(e).forEach((([e,r])=>{t[e]=i(r,s)})),t):t}(e)}merge(e){const t=i(e,a);Object.values(t.data).forEach((e=>{this.addFileCoverage(e)}))}filter(e){Object.keys(this.data).forEach((t=>{e(t)||delete this.data[t]}))}toJSON(){return this.data}files(){return Object.keys(this.data)}fileCoverageFor(e){const t=this.data[e];if(!t)throw new Error(`No file coverage available for: ${e}`);return t}addFileCoverage(e){const t=new s(e),{path:r}=t;this.data[r]?this.data[r].merge(t):this.data[r]=t}getCoverageSummary(){const e=new n;return Object.values(this.data).forEach((t=>{e.merge(t.toSummary())})),e}}e.exports={CoverageMap:a}},9455:(e,t,r)=>{"use strict";const s=r(2735),n=r(20);class i{constructor(e){this.data=e?e instanceof i?e.data:e:{lines:{total:0,covered:0,skipped:0,pct:"Unknown"},statements:{total:0,covered:0,skipped:0,pct:"Unknown"},functions:{total:0,covered:0,skipped:0,pct:"Unknown"},branches:{total:0,covered:0,skipped:0,pct:"Unknown"},branchesTrue:{total:0,covered:0,skipped:0,pct:"Unknown"}},function(e){if(!(e&&e.lines&&e.statements&&e.functions&&e.branches))throw new Error("Invalid summary coverage object, missing keys, found:"+Object.keys(e).join(","))}(this.data)}merge(e){return["lines","statements","branches","functions","branchesTrue"].forEach((t=>{e[t]&&(this[t].total+=e[t].total,this[t].covered+=e[t].covered,this[t].skipped+=e[t].skipped,this[t].pct=s(this[t].covered,this[t].total))})),this}toJSON(){return this.data}isEmpty(){return 0===this.lines.total}}n(i,["lines","statements","functions","branches","branchesTrue"]),e.exports={CoverageSummary:i}},20:e=>{"use strict";e.exports=function(e,t){t.forEach((t=>{Object.defineProperty(e.prototype,t,{enumerable:!0,get(){return this.data[t]}})}))}},4709:(e,t,r)=>{"use strict";const s=r(2735),n=r(20),{CoverageSummary:i}=r(9455),a=({start:e,end:t})=>`${e.line}|${e.column}|${t.line}|${t.column}`,o=(e,t,r,s,n=a)=>{const i={};for(const[r,s]of Object.entries(e)){const e=t[r];i[n(e)]=[s,e]}for(const[e,t]of Object.entries(r)){const r=s[e],a=n(r);if(i[a]){const e=i[a];t.forEach?t.forEach(((t,r)=>{void 0!==e[0][r]?e[0][r]+=t:e[0][r]=t})):e[0]+=t}else i[a]=[t,r]}const o={},c={};return Object.values(i).forEach((([e,t],r)=>{o[r]=e,c[r]=t})),[o,c]};class c{constructor(e,t=!1){if(!e)throw new Error("Coverage must be initialized with a path or an object");if("string"==typeof e)this.data=function(e,t){const r={path:e,statementMap:{},fnMap:{},branchMap:{},s:{},f:{},b:{}};return t&&(r.bT={}),r}(e,t);else if(e instanceof c)this.data=e.data;else{if("object"!=typeof e)throw new Error("Invalid argument to coverage constructor");this.data=e}!function(e){if(!(e&&e.path&&e.statementMap&&e.fnMap&&e.branchMap&&e.s&&e.f&&e.b))throw new Error("Invalid file coverage object, missing keys, found:"+Object.keys(e).join(","))}(this.data)}getLineCoverage(){const e=this.data.statementMap,t=this.data.s,r=Object.create(null);return Object.entries(t).forEach((([t,s])=>{if(!e[t])return;const{line:n}=e[t].start,i=r[n];(void 0===i||i<s)&&(r[n]=s)})),r}getUncoveredLines(){const e=this.getLineCoverage(),t=[];return Object.entries(e).forEach((([e,r])=>{0===r&&t.push(e)})),t}getBranchCoverageByLine(){const e=this.branchMap,t=this.b,r={};return Object.entries(e).forEach((([e,s])=>{const n=s.line||s.loc.start.line,i=t[e];r[n]=r[n]||[],r[n].push(...i)})),Object.entries(r).forEach((([e,t])=>{const s=t.filter((e=>e>0)),n=s.length/t.length*100;r[e]={covered:s.length,total:t.length,coverage:n}})),r}toJSON(){return this.data}merge(e){if(!0===e.all)return;if(!0===this.all)return void(this.data=e.data);let[t,r]=o(this.s,this.statementMap,e.s,e.statementMap);this.data.s=t,this.data.statementMap=r;const s=e=>a(e.locations[0]);[t,r]=o(this.f,this.fnMap,e.f,e.fnMap,(e=>a(e.loc))),this.data.f=t,this.data.fnMap=r,[t,r]=o(this.b,this.branchMap,e.b,e.branchMap,s),this.data.b=t,this.data.branchMap=r,this.bT&&e.bT&&([t,r]=o(this.bT,this.branchMap,e.bT,e.branchMap,s),this.data.bT=t)}computeSimpleTotals(e){let t=this[e];"function"==typeof t&&(t=t.call(this));const r={total:Object.keys(t).length,covered:Object.values(t).filter((e=>!!e)).length,skipped:0};return r.pct=s(r.covered,r.total),r}computeBranchTotals(e){const t=this[e],r={total:0,covered:0,skipped:0};return Object.values(t).forEach((e=>{r.covered+=e.filter((e=>e>0)).length,r.total+=e.length})),r.pct=s(r.covered,r.total),r}resetHits(){const e=this.s,t=this.f,r=this.b,s=this.bT;Object.keys(e).forEach((t=>{e[t]=0})),Object.keys(t).forEach((e=>{t[e]=0})),Object.keys(r).forEach((e=>{r[e].fill(0)})),s&&Object.keys(s).forEach((e=>{s[e].fill(0)}))}toSummary(){const e={};return e.lines=this.computeSimpleTotals("getLineCoverage"),e.functions=this.computeSimpleTotals("f","fnMap"),e.statements=this.computeSimpleTotals("s","statementMap"),e.branches=this.computeBranchTotals("b"),this.bt&&(e.branchesTrue=this.computeBranchTotals("bT")),new i(e)}}n(c,["path","statementMap","fnMap","branchMap","s","f","b","bT","all"]),e.exports={FileCoverage:c}},2735:e=>{"use strict";e.exports=function(e,t){let r;return t>0?(r=1e5*e/t,Math.floor(r/10)/100):100}},6538:e=>{"use strict";e.exports=function(){for(var e,t,r=arguments.length,s=0;s<r;s++)if(null!=(t=e=arguments[s])&&t==t)return e;return e}},9439:(e,t,r)=>{t.RateLimiter=r(3065),t.TokenBucket=r(5472)},3085:e=>{e.exports=function(){if("undefined"!=typeof process&&process.hrtime){var e=process.hrtime(),t=e[0],r=e[1];return 1e3*t+Math.floor(r/1e6)}return(new Date).getTime()}},3065:(e,t,r)=>{var s=r(5472),n=r(3085),i=function(e,t,r){this.tokenBucket=new s(e,e,t,null),this.tokenBucket.content=e,this.curIntervalStart=n(),this.tokensThisInterval=0,this.fireImmediately=r};i.prototype={tokenBucket:null,curIntervalStart:0,tokensThisInterval:0,fireImmediately:!1,removeTokens:function(e,t){if(e>this.tokenBucket.bucketSize)return process.nextTick(t.bind(null,"Requested tokens "+e+" exceeds maximum tokens per interval "+this.tokenBucket.bucketSize,null)),!1;var r=this,s=n();if((s<this.curIntervalStart||s-this.curIntervalStart>=this.tokenBucket.interval)&&(this.curIntervalStart=s,this.tokensThisInterval=0),e>this.tokenBucket.tokensPerInterval-this.tokensThisInterval){if(this.fireImmediately)process.nextTick(t.bind(null,null,-1));else{var i=Math.ceil(this.curIntervalStart+this.tokenBucket.interval-s);setTimeout((function(){r.tokenBucket.removeTokens(e,a)}),i)}return!1}return this.tokenBucket.removeTokens(e,a);function a(s,n){if(s)return t(s,null);r.tokensThisInterval+=e,t(null,n)}},tryRemoveTokens:function(e){if(e>this.tokenBucket.bucketSize)return!1;var t=n();if((t<this.curIntervalStart||t-this.curIntervalStart>=this.tokenBucket.interval)&&(this.curIntervalStart=t,this.tokensThisInterval=0),e>this.tokenBucket.tokensPerInterval-this.tokensThisInterval)return!1;var r=this.tokenBucket.tryRemoveTokens(e);return r&&(this.tokensThisInterval+=e),r},getTokensRemaining:function(){return this.tokenBucket.drip(),this.tokenBucket.content}},e.exports=i},5472:e=>{var t=function(e,t,r,s){if(this.bucketSize=e,this.tokensPerInterval=t,"string"==typeof r)switch(r){case"sec":case"second":this.interval=1e3;break;case"min":case"minute":this.interval=6e4;break;case"hr":case"hour":this.interval=36e5;break;case"day":this.interval=864e5;break;default:throw new Error("Invaid interval "+r)}else this.interval=r;this.parentBucket=s,this.content=0,this.lastDrip=+new Date};t.prototype={bucketSize:1,tokensPerInterval:1,interval:1e3,parentBucket:null,content:0,lastDrip:0,removeTokens:function(e,t){var r=this;return this.bucketSize?e>this.bucketSize?(process.nextTick(t.bind(null,"Requested tokens "+e+" exceeds bucket size "+this.bucketSize,null)),!1):(this.drip(),e>this.content?s():this.parentBucket?this.parentBucket.removeTokens(e,(function(n,i){return n?t(n,null):e>r.content?s():(r.content-=e,void t(null,Math.min(i,r.content)))})):(this.content-=e,process.nextTick(t.bind(null,null,this.content)),!0)):(process.nextTick(t.bind(null,null,e,Number.POSITIVE_INFINITY)),!0);function s(){var s=Math.ceil((e-r.content)*(r.interval/r.tokensPerInterval));return setTimeout((function(){r.removeTokens(e,t)}),s),!1}},tryRemoveTokens:function(e){return!(this.bucketSize&&(e>this.bucketSize||(this.drip(),e>this.content||this.parentBucket&&!this.parentBucket.tryRemoveTokens(e)||(this.content-=e,0))))},drip:function(){if(this.tokensPerInterval){var e=+new Date,t=Math.max(e-this.lastDrip,0);this.lastDrip=e;var r=t*(this.tokensPerInterval/this.interval);this.content=Math.min(this.content+r,this.bucketSize)}else this.content=this.bucketSize}},e.exports=t},5335:(e,t,r)=>{"use strict";var s=r(6928);e.exports=function(e){var t=e.split(s.sep),r=t.lastIndexOf("node_modules");if(-1!==r&&t[r+1]){var n="@"===t[r+1][0],i=n?3:2;return{name:n?t[r+1]+"/"+t[r+2]:t[r+1],basedir:t.slice(0,r+i).join(s.sep),path:t.slice(r+i).join(s.sep)}}}},6882:(e,t,r)=>{"use strict";const s=r(3962);e.exports={storage:s}},3962:(e,t,r)=>{"use strict";const{AsyncLocalStorage:s}=r(290);class n{constructor(){this._storage=new s}disable(){this._storage.disable()}enterWith(e){const t={};c.set(t,e),this._storage.enterWith(t)}exit(e,...t){this._storage.exit(e,...t)}getHandle(){return this._storage.getStore()}getStore(e){return e||(e=this._storage.getStore()),c.get(e)}run(e,t,...r){const s=this._storage.getStore();this.enterWith(e);try{return Reflect.apply(t,null,r)}finally{this._storage.enterWith(s)}}}const i=Object.create(null),a=new n,o=function(e){return i[e]||(i[e]=new n),i[e]};o.disable=a.disable.bind(a),o.enterWith=a.enterWith.bind(a),o.exit=a.exit.bind(a),o.getHandle=a.getHandle.bind(a),o.getStore=a.getStore.bind(a),o.run=a.run.bind(a);const c=new WeakMap;e.exports=o},8496:e=>{"use strict";e.exports=(e,t)=>{const r=t.split(".");let s=e;for(const e of r){if(void 0===s)return s;s=s[e]}return s}},4612:e=>{"use strict";e.exports=(e,t)=>{const r=t.split(".");let s=e;for(const e of r){if(!s.hasOwnProperty(e))return!1;s=s[e]}return!0}},2963:e=>{"use strict";e.exports=(e,t)=>{const r={};return t.forEach((t=>{t in e&&(r[t]=e[t])})),r}},5204:e=>{"use strict";e.exports=(e,t,r)=>{const s=t.split(".");let n,i=e;for(n=0;n<s.length-1;n++){const e=s[n];i.hasOwnProperty(e)?i=i[e]:i[e]=i={}}i[s[n]]=r}},4508:(e,t,r)=>{"use strict";if(!global._ddtrace){const e=r(7853);Object.defineProperty(global,"_ddtrace",{value:new e,enumerable:!1,configurable:!0,writable:!0}),global._ddtrace.default=global._ddtrace,global._ddtrace.tracer=global._ddtrace}e.exports=global._ddtrace},1953:e=>{"use strict";e.exports=class{trackUserLoginSuccessEvent(){}trackUserLoginFailureEvent(){}trackCustomEvent(){}isUserBlocked(){}blockRequest(){}setUser(){}}},5613:(e,t,r)=>{const s=r(7209),n=r(4248),i=r(5004),{incrementCountMetric:a,distributionMetric:o,TELEMETRY_KNOWN_TESTS:c,TELEMETRY_KNOWN_TESTS_MS:_,TELEMETRY_KNOWN_TESTS_ERRORS:u,TELEMETRY_KNOWN_TESTS_RESPONSE_TESTS:l,TELEMETRY_KNOWN_TESTS_RESPONSE_BYTES:p}=r(806),{getNumFromKnownTests:d}=r(7507);e.exports={getKnownTests:function({url:e,isEvpProxy:t,evpProxyPrefix:r,isGzipCompatible:h,env:g,service:E,repositoryUrl:f,sha:T,osVersion:m,osPlatform:S,osArchitecture:I,runtimeName:R,runtimeVersion:A,custom:y},b){const O={path:"/api/v2/ci/libraries/tests",method:"POST",headers:{"Content-Type":"application/json"},timeout:2e4,url:e};if(h&&(O.headers["accept-encoding"]="gzip"),t)O.path=`${r}/api/v2/ci/libraries/tests`,O.headers["X-Datadog-EVP-Subdomain"]="api";else{const e=process.env.DATADOG_API_KEY||process.env.DD_API_KEY;if(!e)return b(new Error("Known tests were not fetched because Datadog API key is not defined."));O.headers["dd-api-key"]=e}const v=JSON.stringify({data:{id:n().toString(10),type:"ci_app_libraries_tests_request",attributes:{configurations:{"os.platform":S,"os.version":m,"os.architecture":I,"runtime.name":R,"runtime.version":A,custom:y},service:E,env:g,repository_url:f,sha:T}}});a(c);const C=Date.now();s(v,O,((e,t,r)=>{if(o(_,{},Date.now()-C),e)a(u,{statusCode:r}),b(e);else try{const{data:{attributes:{tests:e}}}=JSON.parse(t),r=d(e);a(l,{},r),o(p,{},t.length),i.debug((()=>`Number of received known tests: ${r}`)),b(null,e)}catch(e){b(e)}}))}}},3765:e=>{"use strict";e.exports={JSONEncoder:class{constructor(){this.payloads=[]}encode(e){this.payloads.push(e)}count(){return this.payloads.length}reset(){this.payloads=[]}makePayload(){const e=JSON.stringify(this.payloads);return this.reset(),e}}}},9107:(e,t,r)=>{"use strict";const s=r(9091),n=r(3092),i=r(3285),a=r(4753),o="/evp_proxy/v",c=/\/evp_proxy\/v(\d+)\/?/;e.exports=class extends a{constructor(e){super(e);const{tags:t,prioritySampler:a,lookup:_,protocolVersion:u,headers:l,isTestDynamicInstrumentationEnabled:p}=e;this.getAgentInfo(((e,d)=>{this._isInitialized=!0;let h=function(e,t){return e?0:t.endpoints.reduce(((e,t)=>{if(t.includes(o)){const r=Number(t.replace(c,"$1"));return isNaN(r)?e:r>e?r:e}return e}),0)}(e,d);const g=h>=2,E=h>=4;3===h&&(h=2);const f=`${o}${h}`;if(g){if(this._isUsingEvpProxy=!0,this.evpProxyPrefix=f,this._writer=new n({url:this._url,tags:t,evpProxyPrefix:f}),this._coverageWriter=new i({url:this._url,evpProxyPrefix:f}),p){const s=function(e,t){return!e&&t.endpoints.some((e=>"/debugger/v1/input"===e))}(e,d);if(s){const e=r(8820);this._logsWriter=new e({url:this._url,tags:t,isAgentProxy:!0}),this._canForwardLogs=!0}}}else this._writer=new s({url:this._url,prioritySampler:a,lookup:_,protocolVersion:u,headers:l}),this._coverageBuffer=[];this._resolveCanUseCiVisProtocol(g),this.exportUncodedTraces(),this.exportUncodedCoverages(),this._isGzipCompatible=E}))}setUrl(e,t){this._setUrl(e,t)}}},3285:(e,t,r)=>{"use strict";const s=r(7209),n=r(5004),{safeJSONStringify:i}=r(2086),{CoverageCIVisibilityEncoder:a}=r(6406),o=r(97),{incrementCountMetric:c,distributionMetric:_,TELEMETRY_ENDPOINT_PAYLOAD_REQUESTS:u,TELEMETRY_ENDPOINT_PAYLOAD_BYTES:l,TELEMETRY_ENDPOINT_PAYLOAD_REQUESTS_MS:p,TELEMETRY_ENDPOINT_PAYLOAD_REQUESTS_ERRORS:d,TELEMETRY_ENDPOINT_PAYLOAD_DROPPED:h}=r(806);e.exports=class extends o{constructor({url:e,evpProxyPrefix:t=""}){super(...arguments),this._url=e,this._encoder=new a(this),this._evpProxyPrefix=t}_sendPayload(e,t,r){const a={path:"/api/v2/citestcov",method:"POST",headers:{"dd-api-key":process.env.DATADOG_API_KEY||process.env.DD_API_KEY,...e.getHeaders()},timeout:15e3,url:this._url};this._evpProxyPrefix&&(a.path=`${this._evpProxyPrefix}/api/v2/citestcov`,delete a.headers["dd-api-key"],a.headers["X-Datadog-EVP-Subdomain"]="citestcov-intake"),n.debug((()=>`Request to the intake: ${i(a)}`));const o=Date.now();c(u,{endpoint:"code_coverage"}),_(l,{endpoint:"code_coverage"},e.size()),s(e,a,((e,t,s)=>{if(_(p,{endpoint:"code_coverage"},Date.now()-o),e)return c(d,{endpoint:"code_coverage",statusCode:s}),c(h,{endpoint:"code_coverage"}),n.error("Error sending CI coverage payload",e),void r();n.debug(`Response from the intake: ${t}`),r()}))}}},8820:(e,t,r)=>{"use strict";const s=r(7209),n=r(5004),{safeJSONStringify:i}=r(2086),{JSONEncoder:a}=r(3765),o=r(97);e.exports=class extends o{constructor({url:e,timeout:t,isAgentProxy:r=!1}){super(...arguments),this._url=e,this._encoder=new a,this._isAgentProxy=r,this.timeout=t}_sendPayload(e,t,r){const a={path:"/api/v2/logs",method:"POST",headers:{"dd-api-key":process.env.DATADOG_API_KEY||process.env.DD_API_KEY,"Content-Type":"application/json"},timeout:this.timeout||15e3,url:this._url};this._isAgentProxy&&(delete a.headers["dd-api-key"],a.path="/debugger/v1/input"),n.debug((()=>`Request to the logs intake: ${i(a)}`)),s(e,a,((e,t)=>{if(e)return n.error("Error sending DI logs payload",e),void r();n.debug(`Response from the logs intake: ${t}`),r()}))}}},1355:(e,t,r)=>{"use strict";const s=r(7016).URL,n=r(3092),i=r(3285),a=r(4753),o=r(5004);e.exports=class extends a{constructor(e){super(e);const{tags:t,site:a,url:o,isTestDynamicInstrumentationEnabled:c}=e;if(this._isInitialized=!0,this._resolveCanUseCiVisProtocol(!0),this._canForwardLogs=!0,this._url=o||new s(`https://citestcycle-intake.${a}`),this._writer=new n({url:this._url,tags:t}),this._coverageUrl=o||new s(`https://citestcov-intake.${a}`),this._coverageWriter=new i({url:this._coverageUrl}),c){const e=r(8820);this._logsUrl=o||new s(`https://http-intake.logs.${a}`),this._logsWriter=new e({url:this._logsUrl,tags:t})}this._apiUrl=o||new s(`https://api.${a}`),this._isGzipCompatible=!0}setUrl(e,t=e,r=e){this._setUrl(e,t);try{r=new s(r),this._apiUrl=r}catch(e){o.error("Error setting CI exporter api url",e)}}_getApiUrl(){return this._apiUrl}}},3092:(e,t,r)=>{"use strict";const s=r(7209),{safeJSONStringify:n}=r(2086),i=r(5004),{AgentlessCiVisibilityEncoder:a}=r(6906),o=r(97),{incrementCountMetric:c,distributionMetric:_,TELEMETRY_ENDPOINT_PAYLOAD_REQUESTS:u,TELEMETRY_ENDPOINT_PAYLOAD_BYTES:l,TELEMETRY_ENDPOINT_PAYLOAD_REQUESTS_MS:p,TELEMETRY_ENDPOINT_PAYLOAD_REQUESTS_ERRORS:d,TELEMETRY_ENDPOINT_PAYLOAD_DROPPED:h}=r(806);e.exports=class extends o{constructor({url:e,tags:t,evpProxyPrefix:r=""}){super(...arguments);const{"runtime-id":s,env:n,service:i}=t;this._url=e,this._encoder=new a(this,{runtimeId:s,env:n,service:i}),this._evpProxyPrefix=r}_sendPayload(e,t,r){const a={path:"/api/v2/citestcycle",method:"POST",headers:{"dd-api-key":process.env.DATADOG_API_KEY||process.env.DD_API_KEY,"Content-Type":"application/msgpack"},timeout:15e3,url:this._url};this._evpProxyPrefix&&(a.path=`${this._evpProxyPrefix}/api/v2/citestcycle`,delete a.headers["dd-api-key"],a.headers["X-Datadog-EVP-Subdomain"]="citestcycle-intake"),i.debug((()=>`Request to the intake: ${n(a)}`));const o=Date.now();c(u,{endpoint:"test_cycle"}),_(l,{endpoint:"test_cycle"},e.length),s(e,a,((e,t,s)=>{if(_(p,{endpoint:"test_cycle"},Date.now()-o),e)return c(d,{endpoint:"test_cycle",statusCode:s}),c(h,{endpoint:"test_cycle"}),i.error("Error sending CI agentless payload",e),void r();i.debug(`Response from the intake: ${t}`),r()}))}setMetadataTags(e){this._encoder.setMetadataTags(e)}}},4753:(e,t,r)=>{"use strict";const s=r(7016).URL,{sendGitMetadata:n}=r(7187),{getLibraryConfiguration:i}=r(2761),{getSkippableSuites:a}=r(4005),{getKnownTests:o}=r(5613),c=r(5004),_=r(2114),{GIT_REPOSITORY_URL:u,GIT_COMMIT_SHA:l}=r(1154);e.exports=class extends _{constructor(e){super(e),this._timer=void 0,this._coverageTimer=void 0,this._logsTimer=void 0,this._coverageBuffer=[],this._canUseCiVisProtocol=!1;const t=setTimeout((()=>{this._resolveGit(new Error("Timeout while uploading git metadata"))}),6e4).unref(),r=setTimeout((()=>{this._resolveCanUseCiVisProtocol(!1)}),6e4).unref();this._gitUploadPromise=new Promise((e=>{this._resolveGit=r=>{clearTimeout(t),e(r)}})),this._canUseCiVisProtocolPromise=new Promise((e=>{this._resolveCanUseCiVisProtocol=t=>{clearTimeout(r),this._canUseCiVisProtocol=t,e(t)}})),process.once("beforeExit",(()=>{this._writer&&this._writer.flush(),this._coverageWriter&&this._coverageWriter.flush(),this._logsWriter&&this._logsWriter.flush()}))}shouldRequestSkippableSuites(){return!!(this._config.isIntelligentTestRunnerEnabled&&this._canUseCiVisProtocol&&this._libraryConfig?.isSuitesSkippingEnabled)}shouldRequestKnownTests(){return!(!this._canUseCiVisProtocol||!this._libraryConfig?.isKnownTestsEnabled)}shouldRequestLibraryConfiguration(){return this._config.isIntelligentTestRunnerEnabled}canReportSessionTraces(){return this._canUseCiVisProtocol}canReportCodeCoverage(){return this._canUseCiVisProtocol}getRequestConfiguration(e){return{url:this._getApiUrl(),env:this._config.env,service:this._config.service,isEvpProxy:!!this._isUsingEvpProxy,isGzipCompatible:this._isGzipCompatible,evpProxyPrefix:this.evpProxyPrefix,custom:(t=this._config.tags,t?Object.keys(t).reduce(((e,r)=>{if(r.startsWith("test.configuration.")){const[,s]=r.split("test.configuration.");e[s]=t[r]}return e}),{}):{}),...e};var t}getSkippableSuites(e,t){if(!this.shouldRequestSkippableSuites())return t(null,[]);this._gitUploadPromise.then((r=>{if(r)return t(r,[]);a(this.getRequestConfiguration(e),t)}))}getKnownTests(e,t){if(!this.shouldRequestKnownTests())return t(null);o(this.getRequestConfiguration(e),t)}getLibraryConfiguration(e,t){const{repositoryUrl:r}=e;if(this.sendGitMetadata(r),!this.shouldRequestLibraryConfiguration())return t(null,{});this._canUseCiVisProtocolPromise.then((r=>{if(!r)return t(null,{});const s=this.getRequestConfiguration(e);i(s,((e,r)=>{this._libraryConfig=this.filterConfiguration(r),e?t(e,{}):r?.requireGit?this._gitUploadPromise.then((e=>{if(e)return t(e,{});i(s,((e,r)=>{this._libraryConfig=this.filterConfiguration(r),t(e,this._libraryConfig)}))})):t(null,this._libraryConfig)}))}))}filterConfiguration(e){if(!e)return{};const{isCodeCoverageEnabled:t,isSuitesSkippingEnabled:r,isItrEnabled:s,requireGit:n,isEarlyFlakeDetectionEnabled:i,earlyFlakeDetectionNumRetries:a,earlyFlakeDetectionFaultyThreshold:o,isFlakyTestRetriesEnabled:c,isDiEnabled:_,isKnownTestsEnabled:u}=e;return{isCodeCoverageEnabled:t,isSuitesSkippingEnabled:r,isItrEnabled:s,requireGit:n,isEarlyFlakeDetectionEnabled:i&&this._config.isEarlyFlakeDetectionEnabled,earlyFlakeDetectionNumRetries:a,earlyFlakeDetectionFaultyThreshold:o,isFlakyTestRetriesEnabled:c&&this._config.isFlakyTestRetriesEnabled,flakyTestRetriesCount:this._config.flakyTestRetriesCount,isDiEnabled:_&&this._config.isTestDynamicInstrumentationEnabled,isKnownTestsEnabled:u}}sendGitMetadata(e){this._config.isGitUploadEnabled&&this._canUseCiVisProtocolPromise.then((t=>{t&&n(this._getApiUrl(),{isEvpProxy:!!this._isUsingEvpProxy,evpProxyPrefix:this.evpProxyPrefix},e,(e=>{e?c.error("Error uploading git metadata: %s",e.message):c.debug("Successfully uploaded git metadata"),this._resolveGit(e)}))}))}export(e){this._isInitialized?!this.canReportSessionTraces()&&function(e){return e.some((e=>"test_session_end"===e.type||"test_suite_end"===e.type||"test_module_end"===e.type))}(e)||this._export(e):this._traceBuffer.push(e)}exportCoverage(e){this._isInitialized?this.canReportCodeCoverage()&&this._export(e,this._coverageWriter,"_coverageTimer"):this._coverageBuffer.push(e)}formatLogMessage(e,t){const{[u]:r,[l]:s}=e,{service:n,env:i,version:a}=this._config;return{ddtags:[...t.ddtags||[],`${u}:${r}`,`${l}:${s}`].join(","),level:"error",service:n,dd:{...t.dd||[],service:n,env:i,version:a},ddsource:"dd_debugger",...t}}exportDiLogs(e,t){this._config.isTestDynamicInstrumentationEnabled&&this._isInitialized&&this._canForwardLogs&&this._export(this.formatLogMessage(e,t),this._logsWriter,"_logsTimer")}flush(e=()=>{}){if(!this._isInitialized)return e();const t=[this._writer,this._coverageWriter,this._logsWriter].filter((e=>e));let r=t.length;if(0===r)return e();const s=()=>{r-=1,0===r&&e()};t.forEach((e=>e.flush(s)))}exportUncodedCoverages(){this._coverageBuffer.forEach((e=>{this.exportCoverage(e)})),this._coverageBuffer=[]}_setUrl(e,t=e){try{e=new s(e),t=new s(t),this._url=e,this._coverageUrl=t,this._writer.setUrl(e),this._coverageWriter.setUrl(t)}catch(e){c.error("Error setting CI exporter url",e)}}_getApiUrl(){return this._url}setMetadataTags(e){this._writer?.setMetadataTags?this._writer.setMetadataTags(e):this._canUseCiVisProtocolPromise.then((()=>{this._writer?.setMetadataTags&&this._writer.setMetadataTags(e)}))}}},7187:(e,t,r)=>{const s=r(9896),n=r(6928),i=r(3357),a=r(7209),o=r(5004),{getLatestCommits:c,getRepositoryUrl:_,generatePackFilesForCommits:u,getCommitsRevList:l,isShallowRepository:p,unshallowRepository:d,isGitAvailable:h}=r(2919),{incrementCountMetric:g,distributionMetric:E,TELEMETRY_GIT_REQUESTS_SEARCH_COMMITS:f,TELEMETRY_GIT_REQUESTS_SEARCH_COMMITS_MS:T,TELEMETRY_GIT_REQUESTS_SEARCH_COMMITS_ERRORS:m,TELEMETRY_GIT_REQUESTS_OBJECT_PACKFILES_NUM:S,TELEMETRY_GIT_REQUESTS_OBJECT_PACKFILES:I,TELEMETRY_GIT_REQUESTS_OBJECT_PACKFILES_MS:R,TELEMETRY_GIT_REQUESTS_OBJECT_PACKFILES_ERRORS:A,TELEMETRY_GIT_REQUESTS_OBJECT_PACKFILES_BYTES:y}=r(806);function b(e){return{method:"POST",headers:{"dd-api-key":process.env.DATADOG_API_KEY||process.env.DD_API_KEY},timeout:15e3,url:e}}function O({url:e,repositoryUrl:t,latestCommits:r,isEvpProxy:s,evpProxyPrefix:n},i){const c=b(e),_={...c,headers:{...c.headers,"Content-Type":"application/json"},path:"/api/v2/git/repository/search_commits"};s&&(_.path=`${n}/api/v2/git/repository/search_commits`,_.headers["X-Datadog-EVP-Subdomain"]="api",delete _.headers["dd-api-key"]);const u=JSON.stringify({meta:{repository_url:t},data:r.map((e=>({id:e,type:"commit"})))});g(f);const p=Date.now();a(u,_,((e,t,s)=>{if(E(T,{},Date.now()-p),e){g(m,{statusCode:s});const t=new Error(`Error fetching commits to exclude: ${e.message}`);return i(t)}let n;try{a=JSON.parse(t).data,n=a.map((({id:e,type:t})=>{if("commit"!==t)throw new Error("Invalid commit type response");if(/^[0-9a-f]{40}$/.test(e)||/^[0-9a-f]{64}$/.test(e))return e.replace(/[^0-9a-f]+/g,"");throw new Error("Invalid commit format")}))}catch(e){return g(m,{errorType:"network"}),i(new Error(`Can't parse commits to exclude response: ${e.message}`))}var a;o.debug(`There are ${n.length} commits to exclude.`);const c=r.filter((e=>!n.includes(e)));if(o.debug(`There are ${c.length} commits to include.`),!c.length)return i(null,[]);const _=l(n,c);if(null===_)return i(new Error("git rev-list failed"));i(null,_)}))}function v({url:e,isEvpProxy:t,evpProxyPrefix:r,packFileToUpload:o,repositoryUrl:c,headCommit:_},u){const l=new i,p=JSON.stringify({data:{id:_,type:"commit"},meta:{repository_url:c}});l.append("pushedSha",p,{contentType:"application/json"});try{const e=s.readFileSync(o),[,t]=n.basename(o).split("-");l.append("packfile",e,{filename:t,contentType:"application/octet-stream"})}catch(e){return void u(new Error(`Could not read "${o}"`))}const d=b(e),h={...d,path:"/api/v2/git/repository/packfile",headers:{...d.headers,...l.getHeaders()}};t&&(h.path=`${r}/api/v2/git/repository/packfile`,h.headers["X-Datadog-EVP-Subdomain"]="api",delete h.headers["dd-api-key"]),g(I);const f=l.size(),T=Date.now();a(l,h,((e,t,r)=>{if(E(R,{},Date.now()-T),e){g(A,{statusCode:r});const t=new Error(`Could not upload packfiles: status code ${r}: ${e.message}`);return u(t,f)}u(null,f)}))}e.exports={sendGitMetadata:function(e,{isEvpProxy:t,evpProxyPrefix:r},s,n){if(!h())return n(new Error("Git is not available"));let i=s;if(i||(i=_()),o.debug(`Uploading git history for repository ${i}`),!i)return n(new Error("Repository URL is empty"));let a=c();o.debug(`There were ${a.length} commits since last month.`);const l=s=>(_,h)=>{if(_)return n(_);if(!h.length)return o.debug("No commits to upload"),n(null);if(s||!p()){const[s]=a;return function({url:e,isEvpProxy:t,evpProxyPrefix:r,commitsToUpload:s,repositoryUrl:n,headCommit:i},a){o.debug(`There are ${s.length} commits to upload`);const c=u(s);if(o.debug(`Uploading ${c.length} packfiles.`),!c.length)return a(new Error("Failed to generate packfiles"));E(S,{},c.length);let _=0,l=0;const p=(s,o)=>(l+=o,s||_===c.length?(E(y,{},l),a(s)):v({packFileToUpload:c[_++],url:e,isEvpProxy:t,evpProxyPrefix:r,repositoryUrl:n,headCommit:i},p));v({packFileToUpload:c[_++],url:e,isEvpProxy:t,evpProxyPrefix:r,repositoryUrl:n,headCommit:i},p)}({url:e,isEvpProxy:t,evpProxyPrefix:r,commitsToUpload:h,repositoryUrl:i,headCommit:s},n)}o.debug("It is shallow clone, unshallowing..."),d(),a=c(),O({url:e,repositoryUrl:i,latestCommits:a,isEvpProxy:t,evpProxyPrefix:r},l(!0))};O({url:e,repositoryUrl:i,latestCommits:a,isEvpProxy:t,evpProxyPrefix:r},l(!1))}}},2794:(e,t,r)=>{"use strict";const s=r(1747),{JEST_WORKER_COVERAGE_PAYLOAD_CODE:n,JEST_WORKER_TRACE_PAYLOAD_CODE:i,CUCUMBER_WORKER_TRACE_PAYLOAD_CODE:a,MOCHA_WORKER_TRACE_PAYLOAD_CODE:o,JEST_WORKER_LOGS_PAYLOAD_CODE:c}=r(7507);e.exports=class{constructor(){const e=process.env.JEST_WORKER_ID?i:process.env.CUCUMBER_WORKER_ID?a:process.env.MOCHA_WORKER_ID?o:null,t=process.env.JEST_WORKER_ID?n:null,r=process.env.JEST_WORKER_ID?c:null;this._writer=new s(e),this._coverageWriter=new s(t),this._logsWriter=new s(r)}export(e){this._writer.append(e)}exportCoverage(e){this._coverageWriter.append(e)}exportDiLogs(e,t){this._logsWriter.append({testConfiguration:e,logMessage:t})}flush(){this._writer.flush(),this._coverageWriter.flush(),this._logsWriter.flush()}}},1747:(e,t,r)=>{"use strict";const{JSONEncoder:s}=r(3765);e.exports=class{constructor(e){this._encoder=new s,this._interprocessCode=e}flush(){if(this._encoder.count()>0){const e=this._encoder.makePayload();this._sendPayload(e)}}append(e){this._encoder.encode(e)}_sendPayload(e){process.send&&process.send([this._interprocessCode,e])}}},4005:(e,t,r)=>{const s=r(7209),n=r(5004),{incrementCountMetric:i,distributionMetric:a,TELEMETRY_ITR_SKIPPABLE_TESTS:o,TELEMETRY_ITR_SKIPPABLE_TESTS_MS:c,TELEMETRY_ITR_SKIPPABLE_TESTS_ERRORS:_,TELEMETRY_ITR_SKIPPABLE_TESTS_RESPONSE_SUITES:u,TELEMETRY_ITR_SKIPPABLE_TESTS_RESPONSE_TESTS:l,TELEMETRY_ITR_SKIPPABLE_TESTS_RESPONSE_BYTES:p}=r(806);e.exports={getSkippableSuites:function({url:e,isEvpProxy:t,evpProxyPrefix:r,isGzipCompatible:d,env:h,service:g,repositoryUrl:E,sha:f,osVersion:T,osPlatform:m,osArchitecture:S,runtimeName:I,runtimeVersion:R,custom:A,testLevel:y="suite"},b){const O={path:"/api/v2/ci/tests/skippable",method:"POST",headers:{"Content-Type":"application/json"},timeout:2e4,url:e};if(d&&(O.headers["accept-encoding"]="gzip"),t)O.path=`${r}/api/v2/ci/tests/skippable`,O.headers["X-Datadog-EVP-Subdomain"]="api";else{const e=process.env.DATADOG_API_KEY||process.env.DD_API_KEY;if(!e)return b(new Error("Skippable suites were not fetched because Datadog API key is not defined."));O.headers["dd-api-key"]=e}const v=JSON.stringify({data:{type:"test_params",attributes:{test_level:y,configurations:{"os.platform":m,"os.version":T,"os.architecture":S,"runtime.name":I,"runtime.version":R,custom:A},service:g,env:h,repository_url:E,sha:f}}});i(o);const C=Date.now();s(v,O,((e,t,r)=>{if(a(c,{},Date.now()-C),e)i(_,{statusCode:r}),b(e);else{let r=[];try{const e=JSON.parse(t);r=e.data.filter((({type:e})=>e===y)).map((({attributes:{suite:e,name:t}})=>"suite"===y?e:{suite:e,name:t}));const{meta:{correlation_id:s}}=e;i("test"===y?l:u,{},r.length),a(p,{},t.length),n.debug((()=>`Number of received skippable ${y}s: ${r.length}`)),b(null,r,s)}catch(e){b(e)}}}))}}},2761:(e,t,r)=>{const s=r(7209),n=r(4248),i=r(5004),{incrementCountMetric:a,distributionMetric:o,TELEMETRY_GIT_REQUESTS_SETTINGS:c,TELEMETRY_GIT_REQUESTS_SETTINGS_MS:_,TELEMETRY_GIT_REQUESTS_SETTINGS_ERRORS:u,TELEMETRY_GIT_REQUESTS_SETTINGS_RESPONSE:l}=r(806);e.exports={getLibraryConfiguration:function({url:e,isEvpProxy:t,evpProxyPrefix:r,env:p,service:d,repositoryUrl:h,sha:g,osVersion:E,osPlatform:f,osArchitecture:T,runtimeName:m,runtimeVersion:S,branch:I,testLevel:R="suite",custom:A},y){const b={path:"/api/v2/libraries/tests/services/setting",method:"POST",headers:{"Content-Type":"application/json"},url:e,timeout:2e4};if(t)b.path=`${r}/api/v2/libraries/tests/services/setting`,b.headers["X-Datadog-EVP-Subdomain"]="api";else{const e=process.env.DATADOG_API_KEY||process.env.DD_API_KEY;if(!e)return y(new Error("Request to settings endpoint was not done because Datadog API key is not defined."));b.headers["dd-api-key"]=e}const O=JSON.stringify({data:{id:n().toString(10),type:"ci_app_test_service_libraries_settings",attributes:{test_level:R,configurations:{"os.platform":f,"os.version":E,"os.architecture":T,"runtime.name":m,"runtime.version":S,custom:A},service:d,env:p,repository_url:h,sha:g,branch:I}}});a(c);const v=Date.now();s(O,b,((e,t,r)=>{if(o(_,{},Date.now()-v),e)a(u,{statusCode:r}),y(e);else try{const{data:{attributes:{code_coverage:e,tests_skipping:r,itr_enabled:s,require_git:n,early_flake_detection:o,flaky_test_retries_enabled:c,di_enabled:_,known_tests_enabled:u}}}=JSON.parse(t),p={isCodeCoverageEnabled:e,isSuitesSkippingEnabled:r,isItrEnabled:s,requireGit:n,isEarlyFlakeDetectionEnabled:u&&(o?.enabled??!1),earlyFlakeDetectionNumRetries:o?.slow_test_retries?.["5s"]||2,earlyFlakeDetectionFaultyThreshold:o?.faulty_session_threshold??30,isFlakyTestRetriesEnabled:c,isDiEnabled:_&&c,isKnownTestsEnabled:u};i.debug((()=>`Remote settings: ${JSON.stringify(p)}`)),process.env.DD_CIVISIBILITY_DANGEROUSLY_FORCE_COVERAGE&&(p.isCodeCoverageEnabled=!0,i.debug((()=>"Dangerously set code coverage to true"))),process.env.DD_CIVISIBILITY_DANGEROUSLY_FORCE_TEST_SKIPPING&&(p.isSuitesSkippingEnabled=!0,i.debug((()=>"Dangerously set test skipping to true"))),a(l,p),y(null,p)}catch(e){y(e)}}))}}},806:(e,t,r)=>{const s=r(5608).manager.namespace("civisibility"),n={testLevel:"event_type",testFramework:"test_framework",errorType:"error_type",exitCode:"exit_code",isCodeCoverageEnabled:"coverage_enabled",isSuitesSkippingEnabled:"itrskip_enabled",hasCodeOwners:"has_code_owners",isUnsupportedCIProvider:"is_unsupported_ci",isNew:"is_new",isRum:"is_rum",browserDriver:"browser_driver"};function i(e){return Object.keys(e).reduce(((t,r)=>{if("statusCode"===r){const s=e[r];return function(e){return e>=400&&e<500}(s)&&t.push(`status_code:${s}`),t.push(`error_type:${function(e){return e>=400&&e<500?"status_code_4xx_response":e>=500?"status_code_5xx_response":"network"}(s)}`),t}const s=n[r]||r;return!0===e[r]?t.push(s):void 0!==e[r]&&null!==e[r]&&t.push(`${s}:${e[r]}`),t}),[])}e.exports={incrementCountMetric:function(e,t={},r=1){s.count(e,i(t)).inc(r)},distributionMetric:function(e,t,r){s.distribution(e,i(t)).track(r)},TELEMETRY_TEST_SESSION:"test_session",TELEMETRY_EVENT_CREATED:"event_created",TELEMETRY_EVENT_FINISHED:"event_finished",TELEMETRY_CODE_COVERAGE_STARTED:"code_coverage_started",TELEMETRY_CODE_COVERAGE_FINISHED:"code_coverage_finished",TELEMETRY_ITR_SKIPPED:"itr_skipped",TELEMETRY_ITR_UNSKIPPABLE:"itr_unskippable",TELEMETRY_ITR_FORCED_TO_RUN:"itr_forced_run",TELEMETRY_CODE_COVERAGE_EMPTY:"code_coverage.is_empty",TELEMETRY_CODE_COVERAGE_NUM_FILES:"code_coverage.files",TELEMETRY_EVENTS_ENQUEUED_FOR_SERIALIZATION:"events_enqueued_for_serialization",TELEMETRY_ENDPOINT_PAYLOAD_SERIALIZATION_MS:"endpoint_payload.events_serialization_ms",TELEMETRY_ENDPOINT_PAYLOAD_REQUESTS:"endpoint_payload.requests",TELEMETRY_ENDPOINT_PAYLOAD_BYTES:"endpoint_payload.bytes",TELEMETRY_ENDPOINT_PAYLOAD_EVENTS_COUNT:"endpoint_payload.events_count",TELEMETRY_ENDPOINT_PAYLOAD_REQUESTS_MS:"endpoint_payload.requests_ms",TELEMETRY_ENDPOINT_PAYLOAD_REQUESTS_ERRORS:"endpoint_payload.requests_errors",TELEMETRY_ENDPOINT_PAYLOAD_DROPPED:"endpoint_payload.dropped",TELEMETRY_GIT_COMMAND:"git.command",TELEMETRY_GIT_COMMAND_MS:"git.command_ms",TELEMETRY_GIT_COMMAND_ERRORS:"git.command_errors",TELEMETRY_GIT_REQUESTS_SEARCH_COMMITS:"git_requests.search_commits",TELEMETRY_GIT_REQUESTS_SEARCH_COMMITS_MS:"git_requests.search_commits_ms",TELEMETRY_GIT_REQUESTS_SEARCH_COMMITS_ERRORS:"git_requests.search_commits_errors",TELEMETRY_GIT_REQUESTS_OBJECT_PACKFILES_NUM:"git_requests.objects_pack_files",TELEMETRY_GIT_REQUESTS_OBJECT_PACKFILES_BYTES:"git_requests.objects_pack_bytes",TELEMETRY_GIT_REQUESTS_OBJECT_PACKFILES:"git_requests.objects_pack",TELEMETRY_GIT_REQUESTS_OBJECT_PACKFILES_MS:"git_requests.objects_pack_ms",TELEMETRY_GIT_REQUESTS_OBJECT_PACKFILES_ERRORS:"git_requests.objects_pack_errors",TELEMETRY_GIT_REQUESTS_SETTINGS:"git_requests.settings",TELEMETRY_GIT_REQUESTS_SETTINGS_MS:"git_requests.settings_ms",TELEMETRY_GIT_REQUESTS_SETTINGS_ERRORS:"git_requests.settings_errors",TELEMETRY_GIT_REQUESTS_SETTINGS_RESPONSE:"git_requests.settings_response",TELEMETRY_ITR_SKIPPABLE_TESTS:"itr_skippable_tests.request",TELEMETRY_ITR_SKIPPABLE_TESTS_MS:"itr_skippable_tests.request_ms",TELEMETRY_ITR_SKIPPABLE_TESTS_ERRORS:"itr_skippable_tests.request_errors",TELEMETRY_ITR_SKIPPABLE_TESTS_RESPONSE_SUITES:"itr_skippable_tests.response_suites",TELEMETRY_ITR_SKIPPABLE_TESTS_RESPONSE_TESTS:"itr_skippable_tests.response_tests",TELEMETRY_ITR_SKIPPABLE_TESTS_RESPONSE_BYTES:"itr_skippable_tests.response_bytes",TELEMETRY_KNOWN_TESTS:"early_flake_detection.request",TELEMETRY_KNOWN_TESTS_MS:"early_flake_detection.request_ms",TELEMETRY_KNOWN_TESTS_ERRORS:"early_flake_detection.request_errors",TELEMETRY_KNOWN_TESTS_RESPONSE_TESTS:"early_flake_detection.response_tests",TELEMETRY_KNOWN_TESTS_RESPONSE_BYTES:"early_flake_detection.response_bytes"}},447:(e,t,r)=>{"use strict";const s=r(9896),n=r(857),i=r(4487),{URL:a}=r(7016),o=r(5004),c=r(8523),_=r(6538),u=r(5487),l=r(8496),p=r(4612),d=r(5204),{isTrue:h,isFalse:g}=r(9421),{GIT_REPOSITORY_URL:E,GIT_COMMIT_SHA:f}=r(1154),{getGitMetadataFromGitProperties:T,removeUserSensitiveInfo:m}=r(6213),{updateConfig:S}=r(6218),I=r(5608),{getIsGCPFunction:R,getIsAzureFunction:A}=r(3283),{ORIGIN_KEY:y,GRPC_CLIENT_ERROR_STATUSES:b,GRPC_SERVER_ERROR_STATUSES:O}=r(3636),{appendRules:v}=r(6569),C=I.manager.namespace("tracers"),P={"otel.env.hiding":{},"otel.env.invalid":{}};function D(e,t,r){const s=P[e],n=[];t&&(t="config_datadog:"+t.toLowerCase(),n.push(t)),r&&(r="config_opentelemetry:"+r.toLowerCase(),n.push(r)),r in s||(s[r]={});const i=C.count(e,n);return s[r][t]=i,i}const L={OTEL_LOG_LEVEL:"DD_TRACE_LOG_LEVEL",OTEL_PROPAGATORS:"DD_TRACE_PROPAGATION_STYLE",OTEL_SERVICE_NAME:"DD_SERVICE",OTEL_TRACES_SAMPLER:"DD_TRACE_SAMPLE_RATE",OTEL_TRACES_SAMPLER_ARG:"DD_TRACE_SAMPLE_RATE",OTEL_TRACES_EXPORTER:"DD_TRACE_ENABLED",OTEL_METRICS_EXPORTER:"DD_RUNTIME_METRICS_ENABLED",OTEL_RESOURCE_ATTRIBUTES:"DD_TAGS",OTEL_SDK_DISABLED:"DD_TRACE_OTEL_ENABLED",OTEL_LOGS_EXPORTER:void 0},N=new Set(["datadog","tracecontext","b3","b3 single header","none"]),M=new Set(["debug","info","warn","error"]);function x(e,t){return{always_on:"1.0",always_off:"0.0",traceidratio:t,parentbased_always_on:"1.0",parentbased_always_off:"0.0",parentbased_traceidratio:t}[e]}function U(e){const t=process.env[e];switch(e){case"OTEL_LOG_LEVEL":return M.has(t);case"OTEL_PROPAGATORS":case"OTEL_RESOURCE_ATTRIBUTES":case"OTEL_SERVICE_NAME":return"string"==typeof t;case"OTEL_TRACES_SAMPLER":return void 0!==x(t,process.env.OTEL_TRACES_SAMPLER_ARG);case"OTEL_TRACES_SAMPLER_ARG":return!isNaN(parseFloat(t));case"OTEL_SDK_DISABLED":return"true"===t.toLowerCase()||"false"===t.toLowerCase();case"OTEL_TRACES_EXPORTER":case"OTEL_METRICS_EXPORTER":case"OTEL_LOGS_EXPORTER":return"none"===t.toLowerCase();default:return!1}}const w=Object.fromEntries||(e=>e.reduce(((e,[t,r])=>Object.assign(e,{[t]:r})),{})),B=i();function k(e){if(e)try{return s.readFileSync(e,"utf8")}catch(t){return void o.error("Error reading file %s",e,t)}}function G(e){try{return JSON.parse(e)}catch(e){return}}const V=["v0","v1"],j="v0";function $(e){return e?V.includes(e)?e:(o.warn(`Unexpected input for config.spanAttributeSchema, picked default ${j}`),j):j}function Y(e){return e?Array.isArray(e)?e:"all"===e?[]:e.split(","):null}function H(e,t){if(!e)return;const r={};for(const[s,n]of Object.entries(e))r[s in t?t[s]:s]=n;return r}function F(e,t){if(null===t||"object"!=typeof t||Array.isArray(t)||(t=t[e]),Array.isArray(t))return t.map((e=>e.toLowerCase()));void 0!==t&&o.warn("Unexpected input for config.tracePropagationStyle");const r=`DD_TRACE_PROPAGATION_STYLE_${e.toUpperCase()}`,s=_(process.env[r],process.env.DD_TRACE_PROPAGATION_STYLE,process.env.OTEL_PROPAGATORS);return void 0!==s?s.split(",").filter((e=>""!==e)).map((e=>e.trim().toLowerCase())):void 0}function K(e){return e?e.map((e=>H(e,{sample_rate:"sampleRate",max_per_second:"maxPerSecond"}))):e}function q(e){const t=parseInt(e);return isNaN(t)?void 0:t}function X(e){const t=parseFloat(e);return isNaN(t)?void 0:t}function J(e,t){return e?new a(e):"Windows_NT"!==n.type()?t.hostname||t.port||process.env.DD_AGENT_HOST||process.env.DD_TRACE_AGENT_HOSTNAME||process.env.DD_TRACE_AGENT_PORT||!s.existsSync("/var/run/datadog/apm.socket")?void 0:new a("unix:///var/run/datadog/apm.socket"):void 0}function W(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!1,writable:!0}),e[t]}e.exports=class{constructor(e={}){e={...e,appsec:null!=e.appsec?e.appsec:e.experimental?.appsec,iast:null!=e.iast?e.iast:e.experimental?.iast};const t=o.getConfig();this.debug=t.enabled,this.logger=_(e.logger,t.logger),this.logLevel=_(e.logLevel,t.logLevel),o.use(this.logger),o.toggle(this.debug,this.logLevel),function(){for(const[e,t]of Object.entries(L))t&&process.env[t]&&process.env[e]&&(o.warn(`both ${t} and ${e} environment variables are set`),D("otel.env.hiding",t,e).inc()),process.env[e]&&!U(e)&&(o.warn(`unexpected value for ${e} environment variable`),D("otel.env.invalid",t,e).inc())}();const r=_(process.env.DATADOG_API_KEY,process.env.DD_API_KEY);process.env.DD_TRACE_PROPAGATION_STYLE&&(process.env.DD_TRACE_PROPAGATION_STYLE_INJECT||process.env.DD_TRACE_PROPAGATION_STYLE_EXTRACT)&&o.warn("Use either the DD_TRACE_PROPAGATION_STYLE environment variable or separate DD_TRACE_PROPAGATION_STYLE_INJECT and DD_TRACE_PROPAGATION_STYLE_EXTRACT environment variables"),function(e){if(!process.env.PROPAGATION_STYLE_EXTRACT&&!process.env.PROPAGATION_STYLE_INJECT&&!process.env.DD_TRACE_PROPAGATION_STYLE&&process.env.OTEL_PROPAGATORS)for(const t in e)N.has(t)||(o.warn("unexpected value for OTEL_PROPAGATORS environment variable"),D("otel.env.invalid","DD_TRACE_PROPAGATION_STYLE","OTEL_PROPAGATORS").inc())}(F("inject",e.tracePropagationStyle,this._getDefaultPropagationStyle(e))),"boolean"==typeof e.appsec?e.appsec={enabled:e.appsec}:null==e.appsec&&(e.appsec={});const n=_(process.env.DD_INSTRUMENTATION_INSTALL_ID,null),i=_(process.env.DD_INSTRUMENTATION_INSTALL_TIME,null),a=_(process.env.DD_INSTRUMENTATION_INSTALL_TYPE,null),c=Y(_(process.env.DD_TRACE_CLOUD_REQUEST_PAYLOAD_TAGGING,e.cloudPayloadTagging?.request,"")),l=Y(_(process.env.DD_TRACE_CLOUD_RESPONSE_PAYLOAD_TAGGING,e.cloudPayloadTagging?.response,"")),p=_(process.env.DD_TRACE_CLOUD_PAYLOAD_TAGGING_MAX_DEPTH,e.cloudPayloadTagging?.maxDepth,10);if(this.apiKey=r,this.installSignature={id:n,time:i,type:a},this.cloudPayloadTagging={requestsEnabled:!!c,responsesEnabled:!!l,maxDepth:p,rules:v(c,l)},this._applyDefaults(),this._applyEnvironment(),this._applyOptions(e),this._applyCalculated(),this._applyRemote({}),this._merge(),u.add(this.tags,{service:this.service,env:this.env,version:this.version,"runtime-id":B}),this.isCiVisibility&&u.add(this.tags,{[y]:"ciapp-test"}),this.gitMetadataEnabled&&(this.repositoryUrl=m(_(process.env.DD_GIT_REPOSITORY_URL,this.tags[E])),this.commitSHA=_(process.env.DD_GIT_COMMIT_SHA,this.tags[f]),!this.repositoryUrl||!this.commitSHA)){const e=_(process.env.DD_GIT_PROPERTIES_FILE,`${process.cwd()}/git.properties`);let t;try{t=s.readFileSync(e,"utf8")}catch(t){process.env.DD_GIT_PROPERTIES_FILE&&o.error("Error reading DD_GIT_PROPERTIES_FILE: %s",e,t)}if(t){const{commitSHA:e,repositoryUrl:r}=T(t);this.commitSHA=this.commitSHA||e,this.repositoryUrl=this.repositoryUrl||r}}}configure(e,t){t?this._applyRemote(e):this._applyOptions(e),this._applyCalculated(),this._merge()}_getDefaultPropagationStyle(e){const t=_(e.experimental&&e.experimental.b3,process.env.DD_TRACE_EXPERIMENTAL_B3_ENABLED,!1),r=["datadog","tracecontext"];return h(t)&&(r.push("b3"),r.push("b3 single header")),r}_isInServerlessEnvironment(){const e=void 0!==process.env.AWS_LAMBDA_FUNCTION_NAME,t=R(),r=A();return e||t||r}_applyDefaults(){const{AWS_LAMBDA_FUNCTION_NAME:e,FUNCTION_NAME:t,K_SERVICE:r,WEBSITE_SITE_NAME:s}=process.env,n=e||t||r||s||c.name||"node",i=W(this,"_defaults",{});this._setValue(i,"appsec.apiSecurity.enabled",!0),this._setValue(i,"appsec.apiSecurity.sampleDelay",30),this._setValue(i,"appsec.blockedTemplateGraphql",void 0),this._setValue(i,"appsec.blockedTemplateHtml",void 0),this._setValue(i,"appsec.blockedTemplateJson",void 0),this._setValue(i,"appsec.enabled",void 0),this._setValue(i,"appsec.eventTracking.mode","identification"),this._setValue(i,"appsec.obfuscatorKeyRegex","(?i)pass|pw(?:or)?d|secret|(?:api|private|public|access)[_-]?key|token|consumer[_-]?(?:id|key|secret)|sign(?:ed|ature)|bearer|authorization|jsessionid|phpsessid|asp\\.net[_-]sessionid|sid|jwt"),this._setValue(i,"appsec.obfuscatorValueRegex",'(?i)(?:p(?:ass)?w(?:or)?d|pass(?:[_-]?phrase)?|secret(?:[_-]?key)?|(?:(?:api|private|public|access)[_-]?)key(?:[_-]?id)?|(?:(?:auth|access|id|refresh)[_-]?)?token|consumer[_-]?(?:id|key|secret)|sign(?:ed|ature)?|auth(?:entication|orization)?|jsessionid|phpsessid|asp\\.net(?:[_-]|-)sessionid|sid|jwt)(?:\\s*=[^;]|"\\s*:\\s*"[^"]+")|bearer\\s+[a-z0-9\\._\\-]+|token:[a-z0-9]{13}|gh[opsu]_[0-9a-zA-Z]{36}|ey[I-L][\\w=-]+\\.ey[I-L][\\w=-]+(?:\\.[\\w.+\\/=-]+)?|[\\-]{5}BEGIN[a-z\\s]+PRIVATE\\sKEY[\\-]{5}[^\\-]+[\\-]{5}END[a-z\\s]+PRIVATE\\sKEY|ssh-rsa\\s*[a-z0-9\\/\\.+]{100,}'),this._setValue(i,"appsec.rasp.enabled",!0),this._setValue(i,"appsec.rateLimit",100),this._setValue(i,"appsec.rules",void 0),this._setValue(i,"appsec.sca.enabled",null),this._setValue(i,"appsec.standalone.enabled",void 0),this._setValue(i,"appsec.stackTrace.enabled",!0),this._setValue(i,"appsec.stackTrace.maxDepth",32),this._setValue(i,"appsec.stackTrace.maxStackTraces",2),this._setValue(i,"appsec.wafTimeout",5e3),this._setValue(i,"baggageMaxBytes",8192),this._setValue(i,"baggageMaxItems",64),this._setValue(i,"ciVisibilityTestSessionName",""),this._setValue(i,"clientIpEnabled",!1),this._setValue(i,"clientIpHeader",null),this._setValue(i,"crashtracking.enabled",!0),this._setValue(i,"codeOriginForSpans.enabled",!1),this._setValue(i,"dbmPropagationMode","disabled"),this._setValue(i,"dogstatsd.hostname","127.0.0.1"),this._setValue(i,"dogstatsd.port","8125"),this._setValue(i,"dsmEnabled",!1),this._setValue(i,"dynamicInstrumentation.enabled",!1),this._setValue(i,"dynamicInstrumentation.redactedIdentifiers",[]),this._setValue(i,"dynamicInstrumentation.redactionExcludedIdentifiers",[]),this._setValue(i,"env",void 0),this._setValue(i,"experimental.enableGetRumData",!1),this._setValue(i,"experimental.exporter",void 0),this._setValue(i,"experimental.runtimeId",!1),this._setValue(i,"flushInterval",2e3),this._setValue(i,"flushMinSpans",1e3),this._setValue(i,"gitMetadataEnabled",!0),this._setValue(i,"graphqlErrorExtensions",[]),this._setValue(i,"grpc.client.error.statuses",b),this._setValue(i,"grpc.server.error.statuses",O),this._setValue(i,"headerTags",[]),this._setValue(i,"hostname","127.0.0.1"),this._setValue(i,"iast.cookieFilterPattern",".{32,}"),this._setValue(i,"iast.dbRowsToTaint",1),this._setValue(i,"iast.deduplicationEnabled",!0),this._setValue(i,"iast.enabled",!1),this._setValue(i,"iast.maxConcurrentRequests",2),this._setValue(i,"iast.maxContextOperations",2),this._setValue(i,"iast.redactionEnabled",!0),this._setValue(i,"iast.redactionNamePattern",null),this._setValue(i,"iast.redactionValuePattern",null),this._setValue(i,"iast.requestSampling",30),this._setValue(i,"iast.telemetryVerbosity","INFORMATION"),this._setValue(i,"iast.stackTrace.enabled",!0),this._setValue(i,"injectionEnabled",[]),this._setValue(i,"isAzureFunction",!1),this._setValue(i,"isCiVisibility",!1),this._setValue(i,"isEarlyFlakeDetectionEnabled",!1),this._setValue(i,"isFlakyTestRetriesEnabled",!1),this._setValue(i,"flakyTestRetriesCount",5),this._setValue(i,"isGCPFunction",!1),this._setValue(i,"isGitUploadEnabled",!1),this._setValue(i,"isIntelligentTestRunnerEnabled",!1),this._setValue(i,"isManualApiEnabled",!1),this._setValue(i,"langchain.spanCharLimit",128),this._setValue(i,"langchain.spanPromptCompletionSampleRate",1),this._setValue(i,"llmobs.agentlessEnabled",!1),this._setValue(i,"llmobs.enabled",!1),this._setValue(i,"llmobs.mlApp",void 0),this._setValue(i,"ciVisibilityTestSessionName",""),this._setValue(i,"ciVisAgentlessLogSubmissionEnabled",!1),this._setValue(i,"legacyBaggageEnabled",!0),this._setValue(i,"isTestDynamicInstrumentationEnabled",!1),this._setValue(i,"logInjection",!1),this._setValue(i,"lookup",void 0),this._setValue(i,"inferredProxyServicesEnabled",!1),this._setValue(i,"memcachedCommandEnabled",!1),this._setValue(i,"middlewareTracingEnabled",!0),this._setValue(i,"openAiLogsEnabled",!1),this._setValue(i,"openai.spanCharLimit",128),this._setValue(i,"peerServiceMapping",{}),this._setValue(i,"plugins",!0),this._setValue(i,"port","8126"),this._setValue(i,"profiling.enabled",void 0),this._setValue(i,"profiling.exporters","agent"),this._setValue(i,"profiling.sourceMap",!0),this._setValue(i,"profiling.longLivedThreshold",void 0),this._setValue(i,"protocolVersion","0.4"),this._setValue(i,"queryStringObfuscation",'(?:p(?:ass)?w(?:or)?d|pass(?:_?phrase)?|secret|(?:api_?|private_?|public_?|access_?|secret_?)key(?:_?id)?|token|consumer_?(?:id|key|secret)|sign(?:ed|ature)?|auth(?:entication|orization)?)(?:(?:\\s|%20)*(?:=|%3D)[^&]+|(?:"|%22)(?:\\s|%20)*(?::|%3A)(?:\\s|%20)*(?:"|%22)(?:%2[^2]|%[^2]|[^"%])+(?:"|%22))|bearer(?:\\s|%20)+[a-z0-9\\._\\-]+|token(?::|%3A)[a-z0-9]{13}|gh[opsu]_[0-9a-zA-Z]{36}|ey[I-L](?:[\\w=-]|%3D)+\\.ey[I-L](?:[\\w=-]|%3D)+(?:\\.(?:[\\w.+\\/=-]|%3D|%2F|%2B)+)?|[\\-]{5}BEGIN(?:[a-z\\s]|%20)+PRIVATE(?:\\s|%20)KEY[\\-]{5}[^\\-]+[\\-]{5}END(?:[a-z\\s]|%20)+PRIVATE(?:\\s|%20)KEY|ssh-rsa(?:\\s|%20)*(?:[a-z0-9\\/\\.+]|%2F|%5C|%2B){100,}'),this._setValue(i,"remoteConfig.enabled",!0),this._setValue(i,"remoteConfig.pollInterval",5),this._setValue(i,"reportHostname",!1),this._setValue(i,"runtimeMetrics",!1),this._setValue(i,"sampleRate",void 0),this._setValue(i,"sampler.rateLimit",100),this._setValue(i,"sampler.rules",[]),this._setValue(i,"sampler.spanSamplingRules",[]),this._setValue(i,"scope",void 0),this._setValue(i,"service",n),this._setValue(i,"serviceMapping",{}),this._setValue(i,"site","datadoghq.com"),this._setValue(i,"spanAttributeSchema","v0"),this._setValue(i,"spanComputePeerService",!1),this._setValue(i,"spanLeakDebug",0),this._setValue(i,"spanRemoveIntegrationFromService",!1),this._setValue(i,"startupLogs",!1),this._setValue(i,"stats.enabled",!1),this._setValue(i,"tags",{}),this._setValue(i,"tagsHeaderMaxLength",512),this._setValue(i,"telemetry.debug",!1),this._setValue(i,"telemetry.dependencyCollection",!0),this._setValue(i,"telemetry.enabled",!0),this._setValue(i,"telemetry.heartbeatInterval",6e4),this._setValue(i,"telemetry.logCollection",!0),this._setValue(i,"telemetry.metrics",!0),this._setValue(i,"traceEnabled",!0),this._setValue(i,"traceId128BitGenerationEnabled",!0),this._setValue(i,"traceId128BitLoggingEnabled",!1),this._setValue(i,"tracePropagationExtractFirst",!1),this._setValue(i,"tracePropagationStyle.inject",["datadog","tracecontext","baggage"]),this._setValue(i,"tracePropagationStyle.extract",["datadog","tracecontext","baggage"]),this._setValue(i,"tracePropagationStyle.otelPropagators",!1),this._setValue(i,"tracing",!0),this._setValue(i,"url",void 0),this._setValue(i,"version",c.version),this._setValue(i,"instrumentation_config_id",void 0),this._setValue(i,"aws.dynamoDb.tablePrimaryKeys",void 0)}_applyEnvironment(){const{AWS_LAMBDA_FUNCTION_NAME:e,DD_AGENT_HOST:t,DD_API_SECURITY_ENABLED:r,DD_API_SECURITY_SAMPLE_DELAY:s,DD_APPSEC_AUTO_USER_INSTRUMENTATION_MODE:n,DD_APPSEC_AUTOMATED_USER_EVENTS_TRACKING:i,DD_APPSEC_ENABLED:a,DD_APPSEC_GRAPHQL_BLOCKED_TEMPLATE_JSON:o,DD_APPSEC_HTTP_BLOCKED_TEMPLATE_HTML:c,DD_APPSEC_HTTP_BLOCKED_TEMPLATE_JSON:l,DD_APPSEC_MAX_STACK_TRACES:p,DD_APPSEC_MAX_STACK_TRACE_DEPTH:d,DD_APPSEC_OBFUSCATION_PARAMETER_KEY_REGEXP:E,DD_APPSEC_OBFUSCATION_PARAMETER_VALUE_REGEXP:f,DD_APPSEC_RULES:T,DD_APPSEC_SCA_ENABLED:m,DD_APPSEC_STACK_TRACE_ENABLED:S,DD_APPSEC_RASP_ENABLED:I,DD_APPSEC_TRACE_RATE_LIMIT:y,DD_APPSEC_WAF_TIMEOUT:b,DD_AWS_SDK_DYNAMODB_TABLE_PRIMARY_KEYS:O,DD_CRASHTRACKING_ENABLED:v,DD_CODE_ORIGIN_FOR_SPANS_ENABLED:C,DD_DATA_STREAMS_ENABLED:P,DD_DBM_PROPAGATION_MODE:D,DD_DOGSTATSD_HOSTNAME:L,DD_DOGSTATSD_HOST:N,DD_DOGSTATSD_PORT:M,DD_DYNAMIC_INSTRUMENTATION_ENABLED:U,DD_DYNAMIC_INSTRUMENTATION_REDACTED_IDENTIFIERS:B,DD_DYNAMIC_INSTRUMENTATION_REDACTION_EXCLUDED_IDENTIFIERS:V,DD_ENV:j,DD_EXPERIMENTAL_API_SECURITY_ENABLED:Y,DD_EXPERIMENTAL_APPSEC_STANDALONE_ENABLED:H,DD_EXPERIMENTAL_PROFILING_ENABLED:F,DD_GRPC_CLIENT_ERROR_STATUSES:J,DD_GRPC_SERVER_ERROR_STATUSES:z,JEST_WORKER_ID:Q,DD_IAST_COOKIE_FILTER_PATTERN:Z,DD_IAST_DB_ROWS_TO_TAINT:ee,DD_IAST_DEDUPLICATION_ENABLED:te,DD_IAST_ENABLED:re,DD_IAST_MAX_CONCURRENT_REQUESTS:se,DD_IAST_MAX_CONTEXT_OPERATIONS:ne,DD_IAST_REDACTION_ENABLED:ie,DD_IAST_REDACTION_NAME_PATTERN:ae,DD_IAST_REDACTION_VALUE_PATTERN:oe,DD_IAST_REQUEST_SAMPLING:ce,DD_IAST_TELEMETRY_VERBOSITY:_e,DD_IAST_STACK_TRACE_ENABLED:ue,DD_INJECTION_ENABLED:le,DD_INSTRUMENTATION_TELEMETRY_ENABLED:pe,DD_INSTRUMENTATION_CONFIG_ID:de,DD_LOGS_INJECTION:he,DD_LANGCHAIN_SPAN_CHAR_LIMIT:ge,DD_LANGCHAIN_SPAN_PROMPT_COMPLETION_SAMPLE_RATE:Ee,DD_LLMOBS_AGENTLESS_ENABLED:fe,DD_LLMOBS_ENABLED:Te,DD_LLMOBS_ML_APP:me,DD_OPENAI_LOGS_ENABLED:Se,DD_OPENAI_SPAN_CHAR_LIMIT:Ie,DD_PROFILING_ENABLED:Re,DD_PROFILING_EXPORTERS:Ae,DD_PROFILING_SOURCE_MAP:ye,DD_INTERNAL_PROFILING_LONG_LIVED_THRESHOLD:be,DD_REMOTE_CONFIGURATION_ENABLED:Oe,DD_REMOTE_CONFIG_POLL_INTERVAL_SECONDS:ve,DD_RUNTIME_METRICS_ENABLED:Ce,DD_SERVICE:Pe,DD_SERVICE_MAPPING:De,DD_SERVICE_NAME:Le,DD_SITE:Ne,DD_SPAN_SAMPLING_RULES:Me,DD_SPAN_SAMPLING_RULES_FILE:xe,DD_TAGS:Ue,DD_TELEMETRY_DEBUG:we,DD_TELEMETRY_DEPENDENCY_COLLECTION_ENABLED:Be,DD_TELEMETRY_HEARTBEAT_INTERVAL:ke,DD_TELEMETRY_LOG_COLLECTION_ENABLED:Ge,DD_TELEMETRY_METRICS_ENABLED:Ve,DD_TRACE_128_BIT_TRACEID_GENERATION_ENABLED:je,DD_TRACE_128_BIT_TRACEID_LOGGING_ENABLED:$e,DD_TRACE_AGENT_HOSTNAME:Ye,DD_TRACE_AGENT_PORT:He,DD_TRACE_AGENT_PROTOCOL_VERSION:Fe,DD_TRACE_BAGGAGE_MAX_BYTES:Ke,DD_TRACE_BAGGAGE_MAX_ITEMS:qe,DD_TRACE_CLIENT_IP_ENABLED:Xe,DD_TRACE_CLIENT_IP_HEADER:Je,DD_TRACE_ENABLED:We,DD_TRACE_EXPERIMENTAL_EXPORTER:ze,DD_TRACE_EXPERIMENTAL_GET_RUM_DATA_ENABLED:Qe,DD_TRACE_EXPERIMENTAL_RUNTIME_ID_ENABLED:Ze,DD_TRACE_GIT_METADATA_ENABLED:et,DD_TRACE_GLOBAL_TAGS:tt,DD_TRACE_GRAPHQL_ERROR_EXTENSIONS:rt,DD_TRACE_HEADER_TAGS:st,DD_TRACE_LEGACY_BAGGAGE_ENABLED:nt,DD_TRACE_MEMCACHED_COMMAND_ENABLED:it,DD_TRACE_MIDDLEWARE_TRACING_ENABLED:at,DD_TRACE_OBFUSCATION_QUERY_STRING_REGEXP:ot,DD_TRACE_PARTIAL_FLUSH_MIN_SPANS:ct,DD_TRACE_PEER_SERVICE_MAPPING:_t,DD_TRACE_PROPAGATION_EXTRACT_FIRST:ut,DD_TRACE_PROPAGATION_STYLE:lt,DD_TRACE_PROPAGATION_STYLE_INJECT:pt,DD_TRACE_PROPAGATION_STYLE_EXTRACT:dt,DD_TRACE_RATE_LIMIT:ht,DD_TRACE_REMOVE_INTEGRATION_SERVICE_NAMES_ENABLED:gt,DD_TRACE_REPORT_HOSTNAME:Et,DD_TRACE_SAMPLE_RATE:ft,DD_TRACE_SAMPLING_RULES:Tt,DD_TRACE_SCOPE:mt,DD_TRACE_SPAN_ATTRIBUTE_SCHEMA:St,DD_TRACE_SPAN_LEAK_DEBUG:It,DD_TRACE_STARTUP_LOGS:Rt,DD_TRACE_TAGS:At,DD_TRACE_TELEMETRY_ENABLED:yt,DD_TRACE_X_DATADOG_TAGS_MAX_LENGTH:bt,DD_TRACING_ENABLED:Ot,DD_VERSION:vt,DD_TRACE_INFERRED_PROXY_SERVICES_ENABLED:Ct,OTEL_METRICS_EXPORTER:Pt,OTEL_PROPAGATORS:Dt,OTEL_RESOURCE_ATTRIBUTES:Lt,OTEL_SERVICE_NAME:Nt,OTEL_TRACES_SAMPLER:Mt,OTEL_TRACES_SAMPLER_ARG:xt}=process.env,Ut={},wt=W(this,"_env",{});W(this,"_envUnprocessed",{}),u.add(Ut,Lt,!0),u.add(Ut,Ue),u.add(Ut,At),u.add(Ut,tt),this._setBoolean(wt,"appsec.apiSecurity.enabled",_(r&&h(r),Y&&h(Y))),this._setValue(wt,"appsec.apiSecurity.sampleDelay",X(s)),this._setValue(wt,"appsec.blockedTemplateGraphql",k(o)),this._setValue(wt,"appsec.blockedTemplateHtml",k(c)),this._envUnprocessed["appsec.blockedTemplateHtml"]=c,this._setValue(wt,"appsec.blockedTemplateJson",k(l)),this._envUnprocessed["appsec.blockedTemplateJson"]=l,this._setBoolean(wt,"appsec.enabled",a),this._setString(wt,"appsec.eventTracking.mode",_(n,i)),this._setString(wt,"appsec.obfuscatorKeyRegex",E),this._setString(wt,"appsec.obfuscatorValueRegex",f),this._setBoolean(wt,"appsec.rasp.enabled",I),this._setValue(wt,"appsec.rateLimit",q(y)),this._envUnprocessed["appsec.rateLimit"]=y,this._setString(wt,"appsec.rules",T),this._setBoolean(wt,"appsec.sca.enabled",m),this._setBoolean(wt,"appsec.standalone.enabled",H),this._setBoolean(wt,"appsec.stackTrace.enabled",S),this._setValue(wt,"appsec.stackTrace.maxDepth",q(d)),this._envUnprocessed["appsec.stackTrace.maxDepth"]=d,this._setValue(wt,"appsec.stackTrace.maxStackTraces",q(p)),this._envUnprocessed["appsec.stackTrace.maxStackTraces"]=p,this._setValue(wt,"appsec.wafTimeout",q(b)),this._envUnprocessed["appsec.wafTimeout"]=b,this._setValue(wt,"baggageMaxBytes",Ke),this._setValue(wt,"baggageMaxItems",qe),this._setBoolean(wt,"clientIpEnabled",Xe),this._setString(wt,"clientIpHeader",Je),this._setBoolean(wt,"crashtracking.enabled",v),this._setBoolean(wt,"codeOriginForSpans.enabled",C),this._setString(wt,"dbmPropagationMode",D),this._setString(wt,"dogstatsd.hostname",N||L),this._setString(wt,"dogstatsd.port",M),this._setBoolean(wt,"dsmEnabled",P),this._setBoolean(wt,"dynamicInstrumentation.enabled",U),this._setArray(wt,"dynamicInstrumentation.redactedIdentifiers",B),this._setArray(wt,"dynamicInstrumentation.redactionExcludedIdentifiers",V),this._setString(wt,"env",j||Ut.env),this._setBoolean(wt,"traceEnabled",We),this._setBoolean(wt,"experimental.enableGetRumData",Qe),this._setString(wt,"experimental.exporter",ze),this._setBoolean(wt,"experimental.runtimeId",Ze),e&&this._setValue(wt,"flushInterval",0),this._setValue(wt,"flushMinSpans",q(ct)),this._envUnprocessed.flushMinSpans=ct,this._setBoolean(wt,"gitMetadataEnabled",et),this._setIntegerRangeSet(wt,"grpc.client.error.statuses",J),this._setIntegerRangeSet(wt,"grpc.server.error.statuses",z),this._setArray(wt,"headerTags",st),this._setString(wt,"hostname",_(t,Ye)),this._setString(wt,"iast.cookieFilterPattern",Z),this._setValue(wt,"iast.dbRowsToTaint",q(ee)),this._setBoolean(wt,"iast.deduplicationEnabled",te),this._setBoolean(wt,"iast.enabled",re),this._setValue(wt,"iast.maxConcurrentRequests",q(se)),this._envUnprocessed["iast.maxConcurrentRequests"]=se,this._setValue(wt,"iast.maxContextOperations",q(ne)),this._envUnprocessed["iast.maxContextOperations"]=ne,this._setBoolean(wt,"iast.redactionEnabled",ie&&!g(ie)),this._setString(wt,"iast.redactionNamePattern",ae),this._setString(wt,"iast.redactionValuePattern",oe);const Bt=q(ce);Bt>-1&&Bt<101&&this._setValue(wt,"iast.requestSampling",Bt),this._envUnprocessed["iast.requestSampling"]=ce,this._setString(wt,"iast.telemetryVerbosity",_e),this._setBoolean(wt,"iast.stackTrace.enabled",ue),this._setArray(wt,"injectionEnabled",le),this._setBoolean(wt,"isAzureFunction",A()),this._setBoolean(wt,"isGCPFunction",R()),this._setValue(wt,"langchain.spanCharLimit",q(ge)),this._setValue(wt,"langchain.spanPromptCompletionSampleRate",X(Ee)),this._setBoolean(wt,"legacyBaggageEnabled",nt),this._setBoolean(wt,"llmobs.agentlessEnabled",fe),this._setBoolean(wt,"llmobs.enabled",Te),this._setString(wt,"llmobs.mlApp",me),this._setBoolean(wt,"logInjection",he),this._setBoolean(wt,"memcachedCommandEnabled",it),this._setBoolean(wt,"middlewareTracingEnabled",at),this._setBoolean(wt,"openAiLogsEnabled",Se),this._setValue(wt,"openai.spanCharLimit",q(Ie)),this._envUnprocessed.openaiSpanCharLimit=Ie,_t&&(this._setValue(wt,"peerServiceMapping",w(_t.split(",").map((e=>e.trim().split(":"))))),this._envUnprocessed.peerServiceMapping=_t),this._setString(wt,"port",He);const kt=_(F,Re),Gt=h(kt)?"true":g(kt)?"false":"auto"===kt?"auto":void 0;this._setString(wt,"profiling.enabled",Gt),this._setString(wt,"profiling.exporters",Ae),this._setBoolean(wt,"profiling.sourceMap",ye&&!g(ye)),be&&this._setValue(wt,"profiling.longLivedThreshold",Number(be)),this._setString(wt,"protocolVersion",Fe),this._setString(wt,"queryStringObfuscation",ot),this._setBoolean(wt,"remoteConfig.enabled",_(Oe,!this._isInServerlessEnvironment())),this._setValue(wt,"remoteConfig.pollInterval",X(ve)),this._envUnprocessed["remoteConfig.pollInterval"]=ve,this._setBoolean(wt,"reportHostname",Et);const Vt="none"!==String(Pt).toLowerCase()&&void 0;this._setBoolean(wt,"runtimeMetrics",Ce||Vt),this._setArray(wt,"sampler.spanSamplingRules",K(_(G(k(xe)),G(Me)))),this._setUnit(wt,"sampleRate",ft||x(Mt,xt)),this._setValue(wt,"sampler.rateLimit",ht),this._setSamplingRule(wt,"sampler.rules",G(Tt)),this._envUnprocessed["sampler.rules"]=Tt,this._setString(wt,"scope",mt),this._setString(wt,"service",Pe||Le||Ut.service||Nt),De&&this._setValue(wt,"serviceMapping",w(process.env.DD_SERVICE_MAPPING.split(",").map((e=>e.trim().split(":"))))),this._setString(wt,"site",Ne),St&&(this._setString(wt,"spanAttributeSchema",$(St)),this._envUnprocessed.spanAttributeSchema=St),this._setValue(wt,"spanLeakDebug",q(It)),this._setBoolean(wt,"spanRemoveIntegrationFromService",gt),this._setBoolean(wt,"startupLogs",Rt),this._setTags(wt,"tags",Ut),this._setValue(wt,"tagsHeaderMaxLength",bt),this._setBoolean(wt,"telemetry.enabled",_(yt,pe,!(this._isInServerlessEnvironment()||Q))),this._setString(wt,"instrumentation_config_id",de),this._setBoolean(wt,"telemetry.debug",we),this._setBoolean(wt,"telemetry.dependencyCollection",Be),this._setValue(wt,"telemetry.heartbeatInterval",q(Math.floor(1e3*ke))),this._envUnprocessed["telemetry.heartbeatInterval"]=1e3*ke,this._setBoolean(wt,"telemetry.logCollection",Ge),this._setBoolean(wt,"telemetry.metrics",Ve),this._setBoolean(wt,"traceId128BitGenerationEnabled",je),this._setBoolean(wt,"traceId128BitLoggingEnabled",$e),this._setBoolean(wt,"tracePropagationExtractFirst",ut),this._setBoolean(wt,"tracePropagationStyle.otelPropagators",!(lt||pt||dt||!Dt)),this._setBoolean(wt,"tracing",Ot),this._setString(wt,"version",vt||Ut.version),this._setBoolean(wt,"inferredProxyServicesEnabled",Ct),this._setString(wt,"aws.dynamoDb.tablePrimaryKeys",O),this._setArray(wt,"graphqlErrorExtensions",rt)}_applyOptions(e){const t=W(this,"_options",this._options||{}),r={};W(this,"_optsUnprocessed",{}),e=W(this,"_optionsArg",Object.assign({ingestion:{}},e,t)),u.add(r,e.tags),this._setBoolean(t,"appsec.apiSecurity.enabled",e.appsec.apiSecurity?.enabled),this._setValue(t,"appsec.blockedTemplateGraphql",k(e.appsec.blockedTemplateGraphql)),this._setValue(t,"appsec.blockedTemplateHtml",k(e.appsec.blockedTemplateHtml)),this._optsUnprocessed["appsec.blockedTemplateHtml"]=e.appsec.blockedTemplateHtml,this._setValue(t,"appsec.blockedTemplateJson",k(e.appsec.blockedTemplateJson)),this._optsUnprocessed["appsec.blockedTemplateJson"]=e.appsec.blockedTemplateJson,this._setBoolean(t,"appsec.enabled",e.appsec.enabled),this._setString(t,"appsec.eventTracking.mode",e.appsec.eventTracking?.mode),this._setString(t,"appsec.obfuscatorKeyRegex",e.appsec.obfuscatorKeyRegex),this._setString(t,"appsec.obfuscatorValueRegex",e.appsec.obfuscatorValueRegex),this._setBoolean(t,"appsec.rasp.enabled",e.appsec.rasp?.enabled),this._setValue(t,"appsec.rateLimit",q(e.appsec.rateLimit)),this._optsUnprocessed["appsec.rateLimit"]=e.appsec.rateLimit,this._setString(t,"appsec.rules",e.appsec.rules),this._setBoolean(t,"appsec.standalone.enabled",e.experimental?.appsec?.standalone?.enabled),this._setBoolean(t,"appsec.stackTrace.enabled",e.appsec.stackTrace?.enabled),this._setValue(t,"appsec.stackTrace.maxDepth",q(e.appsec.stackTrace?.maxDepth)),this._optsUnprocessed["appsec.stackTrace.maxDepth"]=e.appsec.stackTrace?.maxDepth,this._setValue(t,"appsec.stackTrace.maxStackTraces",q(e.appsec.stackTrace?.maxStackTraces)),this._optsUnprocessed["appsec.stackTrace.maxStackTraces"]=e.appsec.stackTrace?.maxStackTraces,this._setValue(t,"appsec.wafTimeout",q(e.appsec.wafTimeout)),this._optsUnprocessed["appsec.wafTimeout"]=e.appsec.wafTimeout,this._setBoolean(t,"clientIpEnabled",e.clientIpEnabled),this._setString(t,"clientIpHeader",e.clientIpHeader),this._setValue(t,"baggageMaxBytes",e.baggageMaxBytes),this._setValue(t,"baggageMaxItems",e.baggageMaxItems),this._setBoolean(t,"codeOriginForSpans.enabled",e.codeOriginForSpans?.enabled),this._setString(t,"dbmPropagationMode",e.dbmPropagationMode),e.dogstatsd&&(this._setString(t,"dogstatsd.hostname",e.dogstatsd.hostname),this._setString(t,"dogstatsd.port",e.dogstatsd.port)),this._setBoolean(t,"dsmEnabled",e.dsmEnabled),this._setBoolean(t,"dynamicInstrumentation.enabled",e.dynamicInstrumentation?.enabled),this._setArray(t,"dynamicInstrumentation.redactedIdentifiers",e.dynamicInstrumentation?.redactedIdentifiers),this._setArray(t,"dynamicInstrumentation.redactionExcludedIdentifiers",e.dynamicInstrumentation?.redactionExcludedIdentifiers),this._setString(t,"env",e.env||r.env),this._setBoolean(t,"experimental.enableGetRumData",e.experimental?.enableGetRumData),this._setString(t,"experimental.exporter",e.experimental?.exporter),this._setBoolean(t,"experimental.runtimeId",e.experimental?.runtimeId),this._setValue(t,"flushInterval",q(e.flushInterval)),this._optsUnprocessed.flushInterval=e.flushInterval,this._setValue(t,"flushMinSpans",q(e.flushMinSpans)),this._optsUnprocessed.flushMinSpans=e.flushMinSpans,this._setArray(t,"headerTags",e.headerTags),this._setString(t,"hostname",e.hostname),this._setString(t,"iast.cookieFilterPattern",e.iast?.cookieFilterPattern),this._setValue(t,"iast.dbRowsToTaint",q(e.iast?.dbRowsToTaint)),this._setBoolean(t,"iast.deduplicationEnabled",e.iast&&e.iast.deduplicationEnabled),this._setBoolean(t,"iast.enabled",e.iast&&(!0===e.iast||!0===e.iast.enabled)),this._setValue(t,"iast.maxConcurrentRequests",q(e.iast?.maxConcurrentRequests)),this._optsUnprocessed["iast.maxConcurrentRequests"]=e.iast?.maxConcurrentRequests,this._setValue(t,"iast.maxContextOperations",q(e.iast?.maxContextOperations)),this._optsUnprocessed["iast.maxContextOperations"]=e.iast?.maxContextOperations,this._setBoolean(t,"iast.redactionEnabled",e.iast?.redactionEnabled),this._setString(t,"iast.redactionNamePattern",e.iast?.redactionNamePattern),this._setString(t,"iast.redactionValuePattern",e.iast?.redactionValuePattern);const s=q(e.iast?.requestSampling);s>-1&&s<101&&(this._setValue(t,"iast.requestSampling",s),this._optsUnprocessed["iast.requestSampling"]=e.iast?.requestSampling),this._setString(t,"iast.telemetryVerbosity",e.iast&&e.iast.telemetryVerbosity),this._setBoolean(t,"iast.stackTrace.enabled",e.iast?.stackTrace?.enabled),this._setBoolean(t,"isCiVisibility",e.isCiVisibility),this._setBoolean(t,"legacyBaggageEnabled",e.legacyBaggageEnabled),this._setBoolean(t,"llmobs.agentlessEnabled",e.llmobs?.agentlessEnabled),this._setString(t,"llmobs.mlApp",e.llmobs?.mlApp),this._setBoolean(t,"logInjection",e.logInjection),this._setString(t,"lookup",e.lookup),this._setBoolean(t,"middlewareTracingEnabled",e.middlewareTracingEnabled),this._setBoolean(t,"openAiLogsEnabled",e.openAiLogsEnabled),this._setValue(t,"peerServiceMapping",e.peerServiceMapping),this._setBoolean(t,"plugins",e.plugins),this._setString(t,"port",e.port);const n=String(e.profiling);["true","false","auto"].includes(n)&&this._setString(t,"profiling.enabled",n),this._setString(t,"protocolVersion",e.protocolVersion),e.remoteConfig&&(this._setValue(t,"remoteConfig.pollInterval",X(e.remoteConfig.pollInterval)),this._optsUnprocessed["remoteConfig.pollInterval"]=e.remoteConfig.pollInterval),this._setBoolean(t,"reportHostname",e.reportHostname),this._setBoolean(t,"runtimeMetrics",e.runtimeMetrics),this._setArray(t,"sampler.spanSamplingRules",K(e.spanSamplingRules)),this._setUnit(t,"sampleRate",_(e.sampleRate,e.ingestion.sampleRate));const i=e.ingestion||{};this._setValue(t,"sampler.rateLimit",_(e.rateLimit,i.rateLimit)),this._setSamplingRule(t,"sampler.rules",e.samplingRules),this._setString(t,"service",e.service||r.service),this._setValue(t,"serviceMapping",e.serviceMapping),this._setString(t,"site",e.site),e.spanAttributeSchema&&(this._setString(t,"spanAttributeSchema",$(e.spanAttributeSchema)),this._optsUnprocessed.spanAttributeSchema=e.spanAttributeSchema),this._setBoolean(t,"spanRemoveIntegrationFromService",e.spanRemoveIntegrationFromService),this._setBoolean(t,"startupLogs",e.startupLogs),this._setTags(t,"tags",r),this._setBoolean(t,"traceId128BitGenerationEnabled",e.traceId128BitGenerationEnabled),this._setBoolean(t,"traceId128BitLoggingEnabled",e.traceId128BitLoggingEnabled),this._setString(t,"version",e.version||r.version),this._setBoolean(t,"inferredProxyServicesEnabled",e.inferredProxyServicesEnabled),this._setBoolean(t,"graphqlErrorExtensions",e.graphqlErrorExtensions),null==this._env["llmobs.enabled"]&&e.llmobs&&this._setBoolean(t,"llmobs.enabled",!!e.llmobs)}_isCiVisibility(){return _(this._optionsArg.isCiVisibility,this._defaults.isCiVisibility)}_isCiVisibilityItrEnabled(){return _(process.env.DD_CIVISIBILITY_ITR_ENABLED,!0)}_getHostname(){const e=process.env.DD_CIVISIBILITY_AGENTLESS_URL,t=e?new a(e):J(this._getTraceAgentUrl(),this._optionsArg);return _(this._optionsArg.hostname,process.env.DD_AGENT_HOST,process.env.DD_TRACE_AGENT_HOSTNAME,"127.0.0.1")||t&&t.hostname}_getSpanComputePeerService(){const e=$(_(this._optionsArg.spanAttributeSchema,process.env.DD_TRACE_SPAN_ATTRIBUTE_SCHEMA)),t=this._optionsArg.hasOwnProperty("spanComputePeerService")||process.env.hasOwnProperty("DD_TRACE_PEER_SERVICE_DEFAULTS_ENABLED"),r=_(this._optionsArg.spanComputePeerService,process.env.DD_TRACE_PEER_SERVICE_DEFAULTS_ENABLED);return"v0"===e?t&&h(r):!t||!g(r)}_isCiVisibilityGitUploadEnabled(){return _(process.env.DD_CIVISIBILITY_GIT_UPLOAD_ENABLED,!0)}_isCiVisibilityManualApiEnabled(){return _(process.env.DD_CIVISIBILITY_MANUAL_API_ENABLED,!0)}_isTraceStatsComputationEnabled(){return _(this._optionsArg.stats,process.env.DD_TRACE_STATS_COMPUTATION_ENABLED,R()||A())}_getTraceAgentUrl(){return _(this._optionsArg.url,process.env.DD_TRACE_AGENT_URL,process.env.DD_TRACE_URL,null)}_applyCalculated(){const e=W(this,"_calculated",{}),{DD_CIVISIBILITY_AGENTLESS_URL:t,DD_CIVISIBILITY_EARLY_FLAKE_DETECTION_ENABLED:r,DD_CIVISIBILITY_FLAKY_RETRY_ENABLED:s,DD_CIVISIBILITY_FLAKY_RETRY_COUNT:n,DD_TEST_SESSION_NAME:i,DD_AGENTLESS_LOG_SUBMISSION_ENABLED:o,DD_TEST_DYNAMIC_INSTRUMENTATION_ENABLED:c}=process.env;t?this._setValue(e,"url",new a(t)):this._setValue(e,"url",J(this._getTraceAgentUrl(),this._optionsArg)),this._isCiVisibility()&&(this._setBoolean(e,"isEarlyFlakeDetectionEnabled",_(r,!0)),this._setBoolean(e,"isFlakyTestRetriesEnabled",_(s,!0)),this._setValue(e,"flakyTestRetriesCount",_(q(n),5)),this._setBoolean(e,"isIntelligentTestRunnerEnabled",h(this._isCiVisibilityItrEnabled())),this._setBoolean(e,"isManualApiEnabled",!g(this._isCiVisibilityManualApiEnabled())),this._setString(e,"ciVisibilityTestSessionName",i),this._setBoolean(e,"ciVisAgentlessLogSubmissionEnabled",h(o)),this._setBoolean(e,"isTestDynamicInstrumentationEnabled",h(c))),this._setString(e,"dogstatsd.hostname",this._getHostname()),this._setBoolean(e,"isGitUploadEnabled",e.isIntelligentTestRunnerEnabled&&!g(this._isCiVisibilityGitUploadEnabled())),this._setBoolean(e,"spanComputePeerService",this._getSpanComputePeerService()),this._setBoolean(e,"stats.enabled",this._isTraceStatsComputationEnabled());const u=this._getDefaultPropagationStyle(this._optionsArg);this._setValue(e,"tracePropagationStyle.inject",F("inject",this._optionsArg.tracePropagationStyle)),this._setValue(e,"tracePropagationStyle.extract",F("extract",this._optionsArg.tracePropagationStyle)),u.length>2&&(e["tracePropagationStyle.inject"]=e["tracePropagationStyle.inject"]||u,e["tracePropagationStyle.extract"]=e["tracePropagationStyle.extract"]||u)}_applyRemote(e){const t=W(this,"_remote",this._remote||{});W(this,"_remoteUnprocessed",{});const r={},s=e.tracing_header_tags?e.tracing_header_tags.map((e=>e.tag_name?`${e.header}:${e.tag_name}`:e.header)):void 0;u.add(r,e.tracing_tags),Object.keys(r).length&&(r["runtime-id"]=B),this._setUnit(t,"sampleRate",e.tracing_sampling_rate),this._setBoolean(t,"logInjection",e.log_injection_enabled),this._setArray(t,"headerTags",s),this._setTags(t,"tags",r),this._setBoolean(t,"tracing",e.tracing_enabled),this._remoteUnprocessed["sampler.rules"]=e.tracing_sampling_rules,this._setSamplingRule(t,"sampler.rules",this._reformatTags(e.tracing_sampling_rules))}_reformatTags(e){for(const t of e||[]){const e={};if(t.tags){for(const r of t.tags||{})e[r.key]=r.value_glob;t.tags=e}}return e}_setBoolean(e,t,r){null==r?this._setValue(e,t,r):h(r)?this._setValue(e,t,!0):g(r)&&this._setValue(e,t,!1)}_setUnit(e,t,r){if(null==r)return this._setValue(e,t,r);r=parseFloat(r),isNaN(r)||this._setValue(e,t,Math.min(Math.max(r,0),1))}_setArray(e,t,r){if(null==r)return this._setValue(e,t,null);"string"==typeof r&&(r=r.split(",").map((e=>{const[t,r]=e.split(":").map((e=>e.trim()));return void 0!==r?`${t}:${r}`:t}))),Array.isArray(r)&&this._setValue(e,t,r)}_setIntegerRangeSet(e,t,r){if(null==r)return this._setValue(e,t,null);r=r.split(",");const s=[];r.forEach((e=>{if(e.includes("-")){const[t,r]=e.split("-").map(Number);for(let e=t;e<=r;e++)s.push(e)}else s.push(Number(e))})),this._setValue(e,t,s)}_setSamplingRule(e,t,r){if(null==r)return this._setValue(e,t,null);"string"==typeof r&&(r=r.split(",")),Array.isArray(r)&&(r=r.map((e=>H(e,{sample_rate:"sampleRate"}))),this._setValue(e,t,r))}_setString(e,t,r){e[t]=r?String(r):void 0}_setTags(e,t,r){if(!r||0===Object.keys(r).length)return this._setValue(e,t,null);this._setValue(e,t,r)}_setValue(e,t,r){e[t]=r}_merge(){const e=[this._remote,this._options,this._env,this._calculated,this._defaults],t=["remote_config","code","env_var","calculated","default"],r=[this._remoteUnprocessed,this._optsUnprocessed,this._envUnprocessed,{},{}],s=[];for(const n in this._defaults)for(let i=0;i<e.length;i++){const a=e[i],o=a[n];if(null!=o||a===this._defaults){if(l(this,n)===o&&p(this,n))break;d(this,n,o),s.push({name:n,value:r[i][n]||o,origin:t[i]});break}}this.sampler.sampleRate=this.sampleRate,S(s,this)}serialize(){if(this.url instanceof a){const e={...this};return e.url=this.url.toString(),e}return this}}},3636:e=>{"use strict";e.exports={SAMPLING_PRIORITY_KEY:"_sampling_priority_v1",ANALYTICS_KEY:"_dd1.sr.eausr",ORIGIN_KEY:"_dd.origin",HOSTNAME_KEY:"_dd.hostname",TOP_LEVEL_KEY:"_dd.top_level",SAMPLING_RULE_DECISION:"_dd.rule_psr",SAMPLING_LIMIT_DECISION:"_dd.limit_psr",SAMPLING_AGENT_DECISION:"_dd.agent_psr",SAMPLING_MECHANISM_DEFAULT:0,SAMPLING_MECHANISM_AGENT:1,SAMPLING_MECHANISM_RULE:3,SAMPLING_MECHANISM_MANUAL:4,SAMPLING_MECHANISM_APPSEC:5,SAMPLING_MECHANISM_SPAN:8,SAMPLING_MECHANISM_REMOTE_USER:11,SAMPLING_MECHANISM_REMOTE_DYNAMIC:12,SPAN_SAMPLING_MECHANISM:"_dd.span_sampling.mechanism",SPAN_SAMPLING_RULE_RATE:"_dd.span_sampling.rule_rate",SPAN_SAMPLING_MAX_PER_SECOND:"_dd.span_sampling.max_per_second",DATADOG_LAMBDA_EXTENSION_PATH:"/opt/extensions/datadog-agent",DECISION_MAKER_KEY:"_dd.p.dm",PROCESS_ID:"process_id",ERROR_TYPE:"error.type",ERROR_MESSAGE:"error.message",ERROR_STACK:"error.stack",COMPONENT:"component",CLIENT_PORT_KEY:"network.destination.port",PEER_SERVICE_KEY:"peer.service",PEER_SERVICE_SOURCE_KEY:"_dd.peer.service.source",PEER_SERVICE_REMAP_KEY:"_dd.peer.service.remapped_from",SCI_REPOSITORY_URL:"_dd.git.repository_url",SCI_COMMIT_SHA:"_dd.git.commit.sha",APM_TRACING_ENABLED_KEY:"_dd.apm.enabled",APPSEC_PROPAGATION_KEY:"_dd.p.appsec",PAYLOAD_TAG_REQUEST_PREFIX:"aws.request.body",PAYLOAD_TAG_RESPONSE_PREFIX:"aws.response.body",PAYLOAD_TAGGING_MAX_TAGS:758,SCHEMA_DEFINITION:"schema.definition",SCHEMA_WEIGHT:"schema.weight",SCHEMA_TYPE:"schema.type",SCHEMA_ID:"schema.id",SCHEMA_TOPIC:"schema.topic",SCHEMA_OPERATION:"schema.operation",SCHEMA_NAME:"schema.name",GRPC_CLIENT_ERROR_STATUSES:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],GRPC_SERVER_ERROR_STATUSES:[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],DYNAMODB_PTR_KIND:"aws.dynamodb.item",S3_PTR_KIND:"aws.s3.object",SPAN_POINTER_DIRECTION:Object.freeze({UPSTREAM:"u",DOWNSTREAM:"d"})}},4501:(e,t,r)=>{"use strict";const{truncateSpan:s,normalizeSpan:n}=r(1557),{Chunk:i,MsgpackEncoder:a}=r(9978),o=r(5004),{isTrue:c}=r(9421),_=r(6538);function u(e){return n(s(e,!1))}e.exports={AgentEncoder:class{constructor(e,t=8388608){this._msgpack=new a,this._limit=t,this._traceBytes=new i,this._stringBytes=new i,this._writer=e,this._reset(),this._debugEncoding=c(_(process.env.DD_TRACE_ENCODING_DEBUG,!1))}count(){return this._traceCount}encode(e){const t=this._traceBytes,r=t.length;this._traceCount++,this._encode(t,e);const s=t.length;this._debugEncoding&&o.debug((()=>`Adding encoded trace to buffer: ${t.buffer.subarray(r,s).toString("hex").match(/../g).join(" ")}`)),(this._traceBytes.length>this._limit||this._stringBytes.length>this._limit)&&(o.debug("Buffer went over soft limit, flushing"),this._writer.flush())}makePayload(){const e=this._traceBytes.length+5,t=Buffer.allocUnsafe(e);return this._writeTraces(t),this._reset(),t}reset(){this._reset()}_encode(e,t){this._encodeArrayPrefix(e,t);for(let r of t)r=u(r),e.reserve(1),r.type&&r.meta_struct?e.buffer[e.length-1]=141:r.type||r.meta_struct?e.buffer[e.length-1]=140:e.buffer[e.length-1]=139,r.type&&(this._encodeString(e,"type"),this._encodeString(e,r.type)),this._encodeString(e,"trace_id"),this._encodeId(e,r.trace_id),this._encodeString(e,"span_id"),this._encodeId(e,r.span_id),this._encodeString(e,"parent_id"),this._encodeId(e,r.parent_id),this._encodeString(e,"name"),this._encodeString(e,r.name),this._encodeString(e,"resource"),this._encodeString(e,r.resource),this._encodeString(e,"service"),this._encodeString(e,r.service),this._encodeString(e,"error"),this._encodeInteger(e,r.error),this._encodeString(e,"start"),this._encodeLong(e,r.start),this._encodeString(e,"duration"),this._encodeLong(e,r.duration),this._encodeString(e,"meta"),this._encodeMap(e,r.meta),this._encodeString(e,"metrics"),this._encodeMap(e,r.metrics),r.meta_struct&&(this._encodeString(e,"meta_struct"),this._encodeMetaStruct(e,r.meta_struct))}_reset(){this._traceCount=0,this._traceBytes.length=0,this._stringCount=0,this._stringBytes.length=0,this._stringMap={},this._cacheString("")}_encodeBuffer(e,t){this._msgpack.encodeBin(e,t)}_encodeBool(e,t){this._msgpack.encodeBoolean(e,t)}_encodeArrayPrefix(e,t){this._msgpack.encodeArrayPrefix(e,t)}_encodeMapPrefix(e,t){this._msgpack.encodeMapPrefix(e,t)}_encodeByte(e,t){this._msgpack.encodeByte(e,t)}_encodeId(e,t){const r=e.length;e.reserve(9),t=t.toArray(),e.buffer[r]=207,e.buffer[r+1]=t[0],e.buffer[r+2]=t[1],e.buffer[r+3]=t[2],e.buffer[r+4]=t[3],e.buffer[r+5]=t[4],e.buffer[r+6]=t[5],e.buffer[r+7]=t[6],e.buffer[r+8]=t[7]}_encodeNumber(e,t){this._msgpack.encodeNumber(e,t)}_encodeInteger(e,t){this._msgpack.encodeInteger(e,t)}_encodeLong(e,t){this._msgpack.encodeLong(e,t)}_encodeMap(e,t){const r=Object.keys(t).filter((e=>"string"==typeof t[e]||"number"==typeof t[e]));this._encodeMapPrefix(e,r.length);for(const s of r)this._encodeString(e,s),this._encodeValue(e,t[s])}_encodeValue(e,t){switch(typeof t){case"string":this._encodeString(e,t);break;case"number":this._encodeFloat(e,t)}}_encodeString(e,t=""){this._cacheString(t);const{start:r,end:s}=this._stringMap[t];this._stringBytes.copy(e,r,s)}_encodeFloat(e,t){this._msgpack.encodeFloat(e,t)}_encodeMetaStruct(e,t){const r=(Array.isArray(t)?[]:Object.keys(t)).filter((e=>{const r=t[e];return"string"==typeof r||"number"==typeof r||null!==r&&"object"==typeof r}));this._encodeMapPrefix(e,r.length);for(const s of r){const r=t[s];this._encodeString(e,s),this._encodeObjectAsByteArray(e,r)}}_encodeObjectAsByteArray(e,t){const r=e.length;e.reserve(5),this._encodeObject(e,t);const s=e.length-r-5;e.buffer[r]=198,e.buffer[r+1]=s>>24,e.buffer[r+2]=s>>16,e.buffer[r+3]=s>>8,e.buffer[r+4]=s}_encodeObject(e,t,r=new Set){r.add(t),Array.isArray(t)?this._encodeObjectAsArray(e,t,r):null!==t&&"object"==typeof t?this._encodeObjectAsMap(e,t,r):"string"!=typeof t&&"number"!=typeof t||this._encodeValue(e,t)}_encodeObjectAsMap(e,t,r){const s=Object.keys(t).filter((e=>{const s=t[e];return"string"==typeof s||"number"==typeof s||null!==s&&"object"==typeof s&&!r.has(s)}));this._encodeMapPrefix(e,s.length);for(const n of s){const s=t[n];this._encodeString(e,n),this._encodeObject(e,s,r)}}_encodeObjectAsArray(e,t,r){const s=t.filter((e=>"string"==typeof e||"number"==typeof e||null!==e&&"object"==typeof e&&!r.has(e)));this._encodeArrayPrefix(e,s);for(const t of s)this._encodeObject(e,t,r)}_cacheString(e){e in this._stringMap||(this._stringCount++,this._stringMap[e]={start:this._stringBytes.length,end:this._stringBytes.length+this._stringBytes.write(e)})}_writeArrayPrefix(e,t,r){return e[t++]=221,e.writeUInt32BE(r,t),t+4}_writeTraces(e,t=0){return(t=this._writeArrayPrefix(e,t,this._traceCount))+this._traceBytes.buffer.copy(e,t,0,this._traceBytes.length)}}}},4513:(e,t,r)=>{"use strict";const{truncateSpan:s,normalizeSpan:n}=r(1557),{AgentEncoder:i}=r(4501);function a(e){return n(s(e,!1))}e.exports={AgentEncoder:class extends i{makePayload(){const e=this._stringBytes.length+5,t=this._traceBytes.length+5,r=Buffer.allocUnsafe(1+e+t);let s=0;return r[s++]=146,s=this._writeStrings(r,s),s=this._writeTraces(r,s),this._reset(),r}_encode(e,t){this._encodeArrayPrefix(e,t);for(let r of t)r=a(r),this._encodeByte(e,156),this._encodeString(e,r.service),this._encodeString(e,r.name),this._encodeString(e,r.resource),this._encodeId(e,r.trace_id),this._encodeId(e,r.span_id),this._encodeId(e,r.parent_id),this._encodeLong(e,r.start||0),this._encodeLong(e,r.duration||0),this._encodeInteger(e,r.error),this._encodeMap(e,r.meta||{}),this._encodeMap(e,r.metrics||{}),this._encodeString(e,r.type)}_encodeString(e,t=""){this._cacheString(t),this._encodeInteger(e,this._stringMap[t])}_cacheString(e){e in this._stringMap||(this._stringMap[e]=this._stringCount++,this._stringBytes.write(e))}_writeStrings(e,t){return(t=this._writeArrayPrefix(e,t,this._stringCount))+this._stringBytes.buffer.copy(e,t,0,this._stringBytes.length)}}}},6906:(e,t,r)=>{"use strict";const{truncateSpan:s,normalizeSpan:n}=r(1557),{AgentEncoder:i}=r(4501),{version:a}=r(8330),{ITR_CORRELATION_ID:o}=r(7507),c=r(4248),{distributionMetric:_,TELEMETRY_ENDPOINT_PAYLOAD_SERIALIZATION_MS:u,TELEMETRY_ENDPOINT_PAYLOAD_EVENTS_COUNT:l}=r(806),p=["test_session_end","test_module_end","test_suite_end","test"];function d(e){let t=1;return"test"===e.type&&e.meta&&e.meta.test_session_id&&(t=2),{type:p.includes(e.type)?e.type:"span",version:t,content:n(s(e))}}e.exports={AgentlessCiVisibilityEncoder:class extends i{constructor(e,{runtimeId:t,service:r,env:s}){super(e,2097152),this.runtimeId=t,this.service=r,this.env=s,this._eventCount=0,this.metadataTags={},this.reset()}setMetadataTags(e){this.metadataTags=e}_encodeTestSuite(e,t){let r=12;const s=t.meta[o];s&&r++,this._encodeMapPrefix(e,r),this._encodeString(e,"type"),this._encodeString(e,t.type),this._encodeString(e,"test_session_id"),this._encodeId(e,t.trace_id),this._encodeString(e,"test_module_id"),this._encodeId(e,t.parent_id),this._encodeString(e,"test_suite_id"),this._encodeId(e,t.span_id),s&&(this._encodeString(e,o),this._encodeString(e,s),delete t.meta[o]),this._encodeString(e,"error"),this._encodeNumber(e,t.error),this._encodeString(e,"name"),this._encodeString(e,t.name),this._encodeString(e,"service"),this._encodeString(e,t.service),this._encodeString(e,"resource"),this._encodeString(e,t.resource),this._encodeString(e,"start"),this._encodeNumber(e,t.start),this._encodeString(e,"duration"),this._encodeNumber(e,t.duration),this._encodeString(e,"meta"),this._encodeMap(e,t.meta),this._encodeString(e,"metrics"),this._encodeMap(e,t.metrics)}_encodeTestModule(e,t){this._encodeMapPrefix(e,11),this._encodeString(e,"type"),this._encodeString(e,t.type),this._encodeString(e,"test_session_id"),this._encodeId(e,t.trace_id),this._encodeString(e,"test_module_id"),this._encodeId(e,t.span_id),this._encodeString(e,"error"),this._encodeNumber(e,t.error),this._encodeString(e,"name"),this._encodeString(e,t.name),this._encodeString(e,"service"),this._encodeString(e,t.service),this._encodeString(e,"resource"),this._encodeString(e,t.resource),this._encodeString(e,"start"),this._encodeNumber(e,t.start),this._encodeString(e,"duration"),this._encodeNumber(e,t.duration),this._encodeString(e,"meta"),this._encodeMap(e,t.meta),this._encodeString(e,"metrics"),this._encodeMap(e,t.metrics)}_encodeTestSession(e,t){this._encodeMapPrefix(e,10),this._encodeString(e,"type"),this._encodeString(e,t.type),this._encodeString(e,"test_session_id"),this._encodeId(e,t.trace_id),this._encodeString(e,"error"),this._encodeNumber(e,t.error),this._encodeString(e,"name"),this._encodeString(e,t.name),this._encodeString(e,"service"),this._encodeString(e,t.service),this._encodeString(e,"resource"),this._encodeString(e,t.resource),this._encodeString(e,"start"),this._encodeNumber(e,t.start),this._encodeString(e,"duration"),this._encodeNumber(e,t.duration),this._encodeString(e,"meta"),this._encodeMap(e,t.meta),this._encodeString(e,"metrics"),this._encodeMap(e,t.metrics)}_encodeEventContent(e,t){let r=11;t.meta.test_session_id&&(r+=1),t.meta.test_module_id&&(r+=1),t.meta.test_suite_id&&(r+=1);const s=t.meta[o];s&&(r+=1),t.type&&(r+=1),this._encodeMapPrefix(e,r),t.type&&(this._encodeString(e,"type"),this._encodeString(e,t.type)),this._encodeString(e,"trace_id"),this._encodeId(e,t.trace_id),this._encodeString(e,"span_id"),this._encodeId(e,t.span_id),this._encodeString(e,"parent_id"),this._encodeId(e,t.parent_id),this._encodeString(e,"name"),this._encodeString(e,t.name),this._encodeString(e,"resource"),this._encodeString(e,t.resource),this._encodeString(e,"service"),this._encodeString(e,t.service),this._encodeString(e,"error"),this._encodeNumber(e,t.error),this._encodeString(e,"start"),this._encodeNumber(e,t.start),this._encodeString(e,"duration"),this._encodeNumber(e,t.duration),t.meta.test_session_id&&(this._encodeString(e,"test_session_id"),this._encodeId(e,c(t.meta.test_session_id,10)),delete t.meta.test_session_id),t.meta.test_module_id&&(this._encodeString(e,"test_module_id"),this._encodeId(e,c(t.meta.test_module_id,10)),delete t.meta.test_module_id),t.meta.test_suite_id&&(this._encodeString(e,"test_suite_id"),this._encodeId(e,c(t.meta.test_suite_id,10)),delete t.meta.test_suite_id),s&&(this._encodeString(e,o),this._encodeString(e,s),delete t.meta[o]),this._encodeString(e,"meta"),this._encodeMap(e,t.meta),this._encodeString(e,"metrics"),this._encodeMap(e,t.metrics)}_encodeEvent(e,t){this._encodeMapPrefix(e,Object.keys(t).length),this._encodeString(e,"type"),this._encodeString(e,t.type),this._encodeString(e,"version"),this._encodeNumber(e,t.version),this._encodeString(e,"content"),"span"===t.type||"test"===t.type?this._encodeEventContent(e,t.content):"test_suite_end"===t.type?this._encodeTestSuite(e,t.content):"test_module_end"===t.type?this._encodeTestModule(e,t.content):"test_session_end"===t.type&&this._encodeTestSession(e,t.content)}_encode(e,t){this._isReset&&(this._encodePayloadStart(e),this._isReset=!1);const r=Date.now(),s=t.map(d),n=s.filter((e=>"test_session_end"===e.type||"test_suite_end"===e.type||"test_module_end"===e.type)),i=n.length?n:s;this._eventCount+=i.length;for(const t of i)this._encodeEvent(e,t);_(u,{endpoint:"test_cycle"},Date.now()-r)}makePayload(){_(l,{endpoint:"test_cycle"},this._eventCount);const e=this._traceBytes,t=this._eventsOffset,r=this._eventCount;e.buffer[t]=221,e.buffer[t+1]=r>>24,e.buffer[t+2]=r>>16,e.buffer[t+3]=r>>8,e.buffer[t+4]=r;const s=e.length,n=Buffer.allocUnsafe(s);return e.buffer.copy(n,0,0,s),this.reset(),n}_encodePayloadStart(e){const t={version:1,metadata:{"*":{language:"javascript",library_version:a},...this.metadataTags},events:[]};this.env&&(t.metadata["*"].env=this.env),this.runtimeId&&(t.metadata["*"]["runtime-id"]=this.runtimeId),this._encodeMapPrefix(e,Object.keys(t).length),this._encodeString(e,"version"),this._encodeNumber(e,t.version),this._encodeString(e,"metadata"),this._encodeMapPrefix(e,Object.keys(t.metadata).length),this._encodeString(e,"*"),this._encodeMap(e,t.metadata["*"]),t.metadata.test&&(this._encodeString(e,"test"),this._encodeMap(e,t.metadata.test)),t.metadata.test_suite_end&&(this._encodeString(e,"test_suite_end"),this._encodeMap(e,t.metadata.test_suite_end)),t.metadata.test_module_end&&(this._encodeString(e,"test_module_end"),this._encodeMap(e,t.metadata.test_module_end)),t.metadata.test_session_end&&(this._encodeString(e,"test_session_end"),this._encodeMap(e,t.metadata.test_session_end)),this._encodeString(e,"events"),this._eventsOffset=e.length,e.reserve(5)}reset(){this._reset(),this._eventCount=0,this._isReset=!0}}}},6406:(e,t,r)=>{"use strict";const{AgentEncoder:s}=r(4501),{Chunk:n}=r(9978),{distributionMetric:i,TELEMETRY_ENDPOINT_PAYLOAD_SERIALIZATION_MS:a,TELEMETRY_ENDPOINT_PAYLOAD_EVENTS_COUNT:o}=r(806),c=r(3357);e.exports={CoverageCIVisibilityEncoder:class extends s{constructor(){super(...arguments),this._coverageBytes=new n,this.form=new c,this._coveragesCount=0,this.reset()}count(){return this._coveragesCount}encode(e){const t=Date.now();this._coveragesCount++,this.encodeCodeCoverage(this._coverageBytes,e),i(a,{endpoint:"code_coverage"},Date.now()-t)}encodeCodeCoverage(e,t){t.testId?this._encodeMapPrefix(e,4):this._encodeMapPrefix(e,3),this._encodeString(e,"test_session_id"),this._encodeId(e,t.sessionId),this._encodeString(e,"test_suite_id"),this._encodeId(e,t.suiteId),t.testId&&(this._encodeString(e,"span_id"),this._encodeId(e,t.testId)),this._encodeString(e,"files"),this._encodeArrayPrefix(e,t.files);for(const r of t.files)this._encodeMapPrefix(e,1),this._encodeString(e,"filename"),this._encodeString(e,r)}reset(){this._reset(),this._coverageBytes&&(this._coverageBytes.length=0),this._coveragesCount=0,this._encodePayloadStart(this._coverageBytes)}_encodePayloadStart(e){this._encodeMapPrefix(e,2),this._encodeString(e,"version"),this._encodeInteger(e,2),this._encodeString(e,"coverages"),this._coveragesOffset=e.length,e.reserve(5)}makePayload(){i(o,{endpoint:"code_coverage"},this._coveragesCount);const e=this._coverageBytes,t=this._coveragesOffset,r=this._coveragesCount;e.buffer[t]=221,e.buffer[t+1]=r>>24,e.buffer[t+2]=r>>16,e.buffer[t+3]=r>>8,e.buffer[t+4]=r;const s=e.length,n=Buffer.allocUnsafe(s);e.buffer.copy(n,0,0,e.length),this.form.append("coverage1",n,{filename:"coverage1.msgpack",contentType:"application/msgpack"}),this.form.append("event",JSON.stringify({dummy:!0}),{filename:"event.json",contentType:"application/json"});const a=this.form;return this.form=new c,this.reset(),a}}}},1557:e=>{const t=5e3,r=200,s=25e3,n=r,i="unnamed_operation",a="unnamed-service";e.exports={truncateSpan:function(e,i=!0){i&&e.resource&&e.resource.length>t&&(e.resource=`${e.resource.slice(0,t)}...`);for(let t in e.meta){const n=e.meta[t];t.length>r&&(delete e.meta[t],t=`${t.slice(0,r)}...`,e.metrics[t]=n),n&&n.length>s&&(e.meta[t]=`${n.slice(0,s)}...`)}for(let t in e.metrics){const r=e.metrics[t];t.length>n&&(delete e.metrics[t],t=`${t.slice(0,n)}...`,e.metrics[t]=r)}return e},normalizeSpan:function(e){return e.service=e.service||a,e.service.length>100&&(e.service=e.service.slice(0,100)),e.name=e.name||i,e.name.length>100&&(e.name=e.name.slice(0,100)),e.resource||(e.resource=e.name),e.type&&e.type.length>100&&(e.type=e.type.slice(0,100)),e},MAX_META_KEY_LENGTH:r,MAX_META_VALUE_LENGTH:s,MAX_METRIC_KEY_LENGTH:n,MAX_NAME_LENGTH:100,MAX_SERVICE_LENGTH:100,MAX_TYPE_LENGTH:100,MAX_RESOURCE_NAME_LENGTH:t,DEFAULT_SPAN_NAME:i,DEFAULT_SERVICE_NAME:a}},9312:(e,t,r)=>{"use strict";const s=r(775),n=r(9896),i=r(3636);e.exports=e=>{const t=void 0!==process.env.AWS_LAMBDA_FUNCTION_NAME,a=t&&n.existsSync(i.DATADOG_LAMBDA_EXTENSION_PATH);switch(e){case s.LOG:return r(913);case s.AGENT:return r(2170);case s.DATADOG:return r(1355);case s.AGENT_PROXY:return r(9107);case s.JEST_WORKER:case s.CUCUMBER_WORKER:case s.MOCHA_WORKER:return r(2794);default:return r(t&&!a?913:2170)}}},2170:(e,t,r)=>{"use strict";const{URL:s,format:n}=r(7016),i=r(5004),a=r(9091);e.exports=class{constructor(e,t){this._config=e;const{url:r,hostname:i,port:o,lookup:c,protocolVersion:_,stats:u={},appsec:l}=e;this._url=r||new s(n({protocol:"http:",hostname:i||"localhost",port:o}));const p={};(u.enabled||l?.standalone?.enabled)&&(p["Datadog-Client-Computed-Stats"]="yes"),this._writer=new a({url:this._url,prioritySampler:t,lookup:c,protocolVersion:_,headers:p}),this._timer=void 0,process.once("beforeExit",(()=>this._writer.flush()))}setUrl(e){try{e=new s(e),this._url=e,this._writer.setUrl(e)}catch(e){i.warn(e.stack)}}export(e){this._writer.append(e);const{flushInterval:t}=this._config;0===t?this._writer.flush():t>0&&!this._timer&&(this._timer=setTimeout((()=>{this._writer.flush(),this._timer=clearTimeout(this._timer)}),t).unref())}flush(e=()=>{}){this._writer.flush(e)}}},9091:(e,t,r)=>{"use strict";const s=r(7209),{startupLog:n}=r(2471),i=r(5004),a=r(8330).version,o=r(97);function c(e,t,r){r&&(e[t]=r)}e.exports=class extends o{constructor({prioritySampler:e,lookup:t,protocolVersion:s,headers:n}){super(...arguments);const i=function(e){return"0.5"===e?r(4513).AgentEncoder:r(4501).AgentEncoder}(s);this._prioritySampler=e,this._lookup=t,this._protocolVersion=s,this._encoder=new i(this),this._headers=n}_sendPayload(e,t,r){const{_headers:o,_lookup:_,_protocolVersion:u,_url:l}=this;!function(e,t,r,o,_,u,l,p){const d={path:`/v${e}/traces`,method:"PUT",headers:{..._,"Content-Type":"application/msgpack","Datadog-Meta-Tracer-Version":a,"X-Datadog-Trace-Count":String(r)},lookup:u,url:o};c(d.headers,"Datadog-Meta-Lang","nodejs"),c(d.headers,"Datadog-Meta-Lang-Version",process.version),c(d.headers,"Datadog-Meta-Lang-Interpreter",process.jsEngine||"v8"),i.debug((()=>`Request to the agent: ${JSON.stringify(d)}`)),s(t,d,((e,t,r)=>{n({agentError:404!==r&&200!==r?e:void 0}),p(e,t)}))}(u,e,t,l,o,_,0,((e,t,s)=>{if(n({agentError:e}),e)return i.error("Error sending payload to the agent (status code: %s)",e.status,e),void r();i.debug("Response from the agent: %s",t);try{this._prioritySampler.update(JSON.parse(t).rate_by_service)}catch(e){i.error("Error updating prioritySampler rates",e)}r()}))}}},2114:(e,t,r)=>{const{URL:s,format:n}=r(7016),i=r(7209),{incrementCountMetric:a,TELEMETRY_EVENTS_ENQUEUED_FOR_SERIALIZATION:o}=r(806);e.exports=class{constructor(e){this._config=e;const{url:t,hostname:r,port:i}=this._config;this._url=t||new s(n({protocol:"http:",hostname:r||"localhost",port:i})),this._traceBuffer=[],this._isInitialized=!1}getAgentInfo(e){var t,r;t=this._url,r=e,i("",{path:"/info",url:t},((e,t)=>{if(e)return r(e);try{const e=JSON.parse(t);return r(null,e)}catch(e){return r(e)}}))}export(e){this._isInitialized?this._export(e):this._traceBuffer.push(e)}_export(e,t=this._writer,r="_timer"){this._config.isCiVisibility&&a(o,{},e.length),t.append(e);const{flushInterval:s}=this._config;0===s?t.flush():s>0&&!this[r]&&(this[r]=setTimeout((()=>{t.flush(),this[r]=clearTimeout(this[r])}),s).unref())}getUncodedTraces(){return this._traceBuffer}exportUncodedTraces(){this.getUncodedTraces().forEach((e=>{this.export(e)})),this.resetUncodedTraces()}resetUncodedTraces(){this._traceBuffer=[]}}},9056:(e,t,r)=>{"use strict";const s=r(8611),n=r(5692),{storage:i}=r(6882);function a(e){return class extends e{constructor(){super({keepAlive:!0,maxSockets:1})}createConnection(...e){return this._noop((()=>super.createConnection(...e)))}keepSocketAlive(...e){return this._noop((()=>super.keepSocketAlive(...e)))}reuseSocket(...e){return this._noop((()=>super.reuseSocket(...e)))}_noop(e){return i.run({noop:!0},e)}}}const o=a(s.Agent),c=a(n.Agent);e.exports={httpAgent:new o,HttpsAgent:new c}},9698:(e,t,r)=>{"use strict";const s=r(9896),n=new RegExp(".*([0-9a-f]{8}[-_][0-9a-f]{4}[-_][0-9a-f]{4}[-_][0-9a-f]{4}[-_][0-9a-f]{12}|[0-9a-f]{8}(?:-[0-9a-f]{4}){4}$|[0-9a-f]{64}|[0-9a-f]{32}-\\d+)(?:\\.scope)?$","m"),i=((function(){try{return s.readFileSync("/proc/self/cgroup").toString()}catch(e){}}()||"").trim().match(n)||[])[1];e.exports={id:()=>i}},3357:(e,t,r)=>{"use strict";const{Readable:s}=r(2203),n=r(4248);e.exports=class extends s{constructor(){super(),this._boundary=n().toString(),this._data=[]}append(e,t,r={}){this._appendBoundary(),r.filename?this._appendFile(e,t,r):this._appendMetadata(e,t,r)}size(){return this._data.reduce(((e,t)=>e+t.length),0)}getHeaders(){return{"Content-Type":"multipart/form-data; boundary="+this._boundary}}_appendBoundary(){this._data.push(`--${this._boundary}\r\n`)}_appendMetadata(e,t){this._data.push(`Content-Disposition: form-data; name="${e}"\r\n\r\n${t}\r\n`)}_appendFile(e,t,{filename:r,contentType:s="application/octet-stream"}){this._data.push(`Content-Disposition: form-data; name="${e}"; filename="${r}"\r\n`),this._data.push(`Content-Type: ${s}\r\n\r\n`),this._data.push(t),this._data.push("\r\n")}_read(){this.push(this._data.shift()),0===this._data.length&&(this.push(`--${this._boundary}--\r\n`),this.push(null))}}},7209:(e,t,r)=>{"use strict";const{Readable:s}=r(2203),n=r(8611),i=r(5692),a=r(3106),{urlToHttpOptions:o}=r(6139),c=r(9698),{httpAgent:_,httpsAgent:u}=r(9056),{storage:l}=r(6882),p=r(5004),d=c.id();let h=0;function g(e,t,r){if(t.headers||(t.headers={}),t.url){const e=function(e){if("object"==typeof e)return o(e);const t=o(new URL(e));if("unix:"===t.protocol&&"."===t.hostname){const r=e.slice(5);t.path=r,t.pathname=r}return t}(t.url);"unix:"===e.protocol?t.socketPath=e.pathname:(t.path||(t.path=e.path),t.protocol=e.protocol,t.hostname=e.hostname,t.port=e.port)}const c=e instanceof s,E=t.timeout||2e3,f="https:"===t.protocol,T=f?i:n,m=[].concat(e);c||(t.headers["Content-Length"]=function(e){return e.length>0?e.reduce(((e,t)=>e+Buffer.byteLength(t,"utf8")),0):0}(m)),d&&(t.headers["Datadog-Container-ID"]=d),t.agent=f?u:_;const S=e=>{const s=[];e.setTimeout(E),e.on("data",(e=>{s.push(e)})),e.on("end",(()=>{h--;const i=Buffer.concat(s);if(e.statusCode>=200&&e.statusCode<=299)"gzip"===e.headers["content-encoding"]?a.gunzip(i,((t,s)=>{t?(p.error("Could not gunzip response: %s",t.message),r(null,"",e.statusCode)):r(null,s.toString(),e.statusCode)})):r(null,i.toString(),e.statusCode);else{let s="";try{s=`Error from ${new URL(t.path,t.url||t.hostname||`http://localhost:${t.port}`).href}: ${e.statusCode} ${n.STATUS_CODES[e.statusCode]}.`}catch(e){}const a=i.toString();a&&(s+=` Response from the endpoint: "${a}"`);const o=new Error(s);o.status=e.statusCode,r(o,null,e.statusCode)}}))},I=s=>{if(!g.writable)return p.debug("Maximum number of active requests reached: payload is discarded."),r(null);h++;const n=l.getStore();l.enterWith({noop:!0});const i=T.request(t,S);i.once("error",(e=>{h--,s(e)})),i.setTimeout(E,i.abort),c?e.pipe(i):(m.forEach((e=>i.write(e))),i.end()),l.enterWith(n)};I((()=>setTimeout((()=>I(r)))))}Object.defineProperty(g,"writable",{get:()=>h<8}),e.exports=g},6139:(e,t,r)=>{"use strict";const{urlToHttpOptions:s}=r(7016);e.exports={urlToHttpOptions:s??function(e){const{hostname:t,pathname:r,port:s,username:n,password:i,search:a}=e,o={__proto__:null,...e,protocol:e.protocol,hostname:"string"==typeof t&&t.startsWith("[")?t.slice(1,-1):t,hash:e.hash,search:a,pathname:r,path:`${r||""}${a||""}`,href:e.href};return""!==s&&(o.port=Number(s)),(n||i)&&(o.auth=`${decodeURIComponent(n)}:${decodeURIComponent(i)}`),o}}},2086:e=>{e.exports={safeJSONStringify:function(e){return JSON.stringify(e,((e,t)=>"dd-api-key"!==e?t:void 0),process.env.DD_TRACE_BEAUTIFUL_LOGS?2:void 0)}}},97:(e,t,r)=>{"use strict";const s=r(7209),n=r(5004),{safeJSONStringify:i}=r(2086);e.exports=class{constructor({url:e}){this._url=e}flush(e=()=>{}){const t=this._encoder.count();if(s.writable)if(t>0){const r=this._encoder.makePayload();this._sendPayload(r,t,e)}else e();else this._encoder.reset(),e()}append(e){s.writable?(n.debug((()=>`Encoding payload: ${i(e)}`)),this._encode(e)):n.debug((()=>`Maximum number of active requests reached. Payload discarded: ${i(e)}`))}_encode(e){this._encoder.encode(e)}setUrl(e){this._url=e}}},913:(e,t,r)=>{"use strict";const s=r(5004);e.exports=class{export(e){s.debug((()=>`Adding trace to queue: ${JSON.stringify(e)}`));let t=16,r=[];for(const n of e){const e=JSON.stringify(n);e.length+16>65536?s.debug("Span too large to send to logs, dropping"):(e.length+t>65536&&(this._printSpans(r),r=[],t=16),t+=e.length+1,r.push(e))}r.length>0&&this._printSpans(r)}_printSpans(e){let t='{"traces":[[',r=!0;for(const s of e)r?(r=!1,t+=s):t+=","+s;t+="]]}\n",process.stdout.write(t)}}},9446:(e,t,r)=>{"use strict";const s=r(3636),n=r(4100),i=r(4248),{isError:a}=r(9421),{registerExtraService:o}=r(7583),c=s.SAMPLING_PRIORITY_KEY,_=s.SAMPLING_RULE_DECISION,u=s.SAMPLING_LIMIT_DECISION,l=s.SAMPLING_AGENT_DECISION,p=s.SPAN_SAMPLING_MECHANISM,d=s.SPAN_SAMPLING_RULE_RATE,h=s.SPAN_SAMPLING_MAX_PER_SECOND,g=s.SAMPLING_MECHANISM_SPAN,{MEASURED:E,BASE_SERVICE:f,ANALYTICS:T}=n,m=s.ORIGIN_KEY,S=s.HOSTNAME_KEY,I=s.TOP_LEVEL_KEY,R=s.PROCESS_ID,A=s.ERROR_MESSAGE,y=s.ERROR_STACK,b=s.ERROR_TYPE,O={"operation.name":"name","service.name":"service","span.type":"type","resource.name":"resource"};function v(e,t){t&&(e.error=1,a(t)&&(C(e.meta,e.metrics,A,t.message||t.code),C(e.meta,e.metrics,b,t.name),C(e.meta,e.metrics,y,t.stack)))}function C(e,t,r,s,n){switch(typeof s){case"string":if(!s)break;e[r]=s;break;case"number":if(isNaN(s))break;t[r]=s;break;case"boolean":t[r]=s?1:0;break;case"undefined":break;case"object":if(null===s)break;if((i=s).constructor&&"Buffer"===i.constructor.name&&"function"==typeof i.readInt8&&"function"==typeof i.toString||function(e){return e.constructor&&"URL"===e.constructor.name&&"string"==typeof e.href&&"function"==typeof e.toString}(s))t[r]=s.toString();else if(!Array.isArray(s)&&!n)for(const n in s)P(s,n)&&C(e,t,`${r}.${n}`,s[n],!0)}var i}function P(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e){const t=function(e){const t=e.context();return{trace_id:t._traceId,span_id:t._spanId,parent_id:t._parentId||i("0"),name:String(t._name),resource:String(t._name),error:0,meta:{},meta_struct:e.meta_struct,metrics:{},start:Math.round(1e6*e._startTime),duration:Math.round(1e6*e._duration),links:[]}}(e);return function(e,t){const r=[];if(t._links)for(const e of t._links){const{context:t,attributes:s}=e,n={};n.trace_id=t.toTraceId(!0),n.span_id=t.toSpanId(!0),s&&Object.keys(s).length>0&&(n.attributes=s),t?._sampling?.priority>=0&&(n.flags=t._sampling.priority>0?1:0),t?._tracestate&&(n.tracestate=t._tracestate.toString()),r.push(n)}r.length>0&&(e.meta["_dd.span_links"]=JSON.stringify(r))}(t,e),function(e,t){const r=[];if(t._events)for(const e of t._events){const t={name:e.name,time_unix_nano:Math.round(1e6*e.startTime),attributes:e.attributes&&Object.keys(e.attributes).length>0?e.attributes:void 0};r.push(t)}r.length>0&&(e.meta.events=JSON.stringify(r))}(t,e),function(e,t){const r=t.context(),s=t===r._trace.started[0],n=r._parentId;!s||n&&"0"!==n.toString(10)||(C({},e.metrics,_,r._trace[_]),C({},e.metrics,u,r._trace[u]),C({},e.metrics,l,r._trace[l]),C({},e.metrics,I,1))}(t,e),function(e,t){const r=t.context();if(t===r._trace.started[0])for(const t in r._trace.tags)C(e.meta,e.metrics,t,r._trace.tags[t])}(t,e),function(e,t){const r=t.context(),s=r._trace.origin,n=r._tags,i=r._hostname,a=r._sampling.priority;n["span.kind"]&&"internal"!==n["span.kind"]&&C({},e.metrics,E,1);const _=t.tracer()._service.toLowerCase();n["service.name"]?.toLowerCase()!==_&&(t.setTag(f,_),o(n["service.name"]));for(const t in n)switch(t){case"service.name":case"span.type":case"resource.name":C(e,{},O[t],n[t]);break;case"http.status_code":C(e.meta,{},t,n[t]&&String(n[t]));break;case"analytics.event":C({},e.metrics,T,void 0===n[t]||n[t]?1:0);break;case S:case E:C({},e.metrics,t,void 0===n[t]||n[t]?1:0);break;case"error":"fs.operation"!==r._name&&v(e,n[t]);break;case b:case A:case y:if("fs.operation"===r._name)break;n.setTraceError&&(e.error=1);default:C(e.meta,e.metrics,t,n[t])}(function(e,t){t&&(C({},e.metrics,p,g),C({},e.metrics,d,t.sampleRate),C({},e.metrics,h,t.maxPerSecond))})(e,r._spanSampling),C(e.meta,e.metrics,"language","javascript"),C(e.meta,e.metrics,R,process.pid),C(e.meta,e.metrics,c,a),C(e.meta,e.metrics,m,s),C(e.meta,e.metrics,S,i)}(t,e),t}},3014:(e,t,r)=>{const{SCI_COMMIT_SHA:s,SCI_REPOSITORY_URL:n}=r(3636);e.exports=class{constructor(e){this._config=e}tagGitMetadata(e){this._config.gitMetadataEnabled&&(e._trace.tags[s]=this._config.commitSHA,e._trace.tags[n]=this._config.repositoryUrl)}}},6213:e=>{const t=/git\.commit\.sha=([a-f\d]{40})/,r=/git\.repository_url=([\w\d:@/.-]+)/;function s(e){try{const t=new URL(e);return t.username||t.password?`${t.origin}${t.pathname}`:e}catch(t){return e}}e.exports={getGitMetadataFromGitProperties:function(e){if(!e)return{};const n=e.match(t),i=e.match(r),a=i?i[1]:void 0;return{commitSHA:n?n[1]:void 0,repositoryUrl:s(a)}},removeUserSensitiveInfo:s}},4248:(e,t,r)=>{"use strict";const{randomFillSync:s}=r(6982),n=4294967296,i=new Uint8Array(65536),a=new Uint8Array(8),o=Array.prototype.map,c=e=>`${e<16?"0":""}${e.toString(16)}`;let _=0;class u{constructor(e,t=16){this._buffer=16===t?function(e){if("0"===e)return a;if(!e)return function(){0===_&&s(i),_=(_+1)%8192;const e=8*_;return[127&i[e],i[e+1],i[e+2],i[e+3],i[e+4],i[e+5],i[e+6],i[e+7]]}();const t=16*Math.ceil(e.length/16),r=t/2,n=new Array(r);e=e.padStart(t,"0");for(let t=0;t<r;t++)n[t]=parseInt(e.substring(2*t,2*t+2),16);return n}(e):function(e,t){const r=new Array(8),s=e.length;let i=0,a=0,o=0;"-"===e[0]&&i++;const c=i;for(;i<s;){const r=parseInt(e[i++],t);if(!(r>=0))break;o=o*t+r,a=a*t+Math.floor(o/n),o%=n}return c&&(a=~a,o?o=n-o:a++),p(r,a,0),p(r,o,4),r}(e,t)}toString(e=16){return 16===e?(t=this._buffer,o.call(t,c).join("")):function(e,t){let r=l(e,e.length-8),s=l(e,e.length-4),i="";for(t=t||10;;){const e=r%t*n+s;if(r=Math.floor(r/t),s=Math.floor(e/t),i=(e%t).toString(t)+i,!r&&!s)break}return i}(this._buffer,e);var t}toBuffer(){return this._buffer}toArray(){return 8===this._buffer.length?this._buffer:this._buffer.slice(-8)}toJSON(){return this.toString()}equals(e){for(let t=this._buffer.length,r=e._buffer.length;t>=0&&r>=0;t--,r--)if(this._buffer[t]!==e._buffer[r])return!1;return!0}}function l(e,t){return 16777216*e[t+0]+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3]}function p(e,t,r){e[3+r]=255&t,t>>=8,e[2+r]=255&t,t>>=8,e[1+r]=255&t,t>>=8,e[0+r]=255&t}e.exports=(e,t)=>new u(e,t)},7853:(e,t,r)=>{"use strict";const{isFalse:s}=r(9421),n="undefined"!=typeof jest,i=process.env.DD_TRACE_ENABLED?s(process.env.DD_TRACE_ENABLED):"none"===String(process.env.OTEL_TRACES_EXPORTER).toLowerCase();e.exports=r(i||n?8698:4741)},1897:e=>{"use strict";e.exports=class{constructor(e){this._tracer=e}get enabled(){return!1}enable(e){}disable(){}trace(e={},t){"function"==typeof e&&(t=e,e={});const r=e.name||e.kind||t.name;return this._tracer.trace(r,e,t)}wrap(e={},t){"function"==typeof e&&(t=e,e={});const r=e.name||e.kind||t.name;return this._tracer.wrap(r,e,t)}decorate(e={}){const t=this;return function(r,s,n){if(!s)return r;if("object"==typeof s){const n=s;return"method"!==n.kind?r:t.wrap({name:n.name,...e},r)}{const i=s;if(n){if("function"!=typeof n.value)return n;const r=n.value;return n.value=t.wrap({name:i,...e},r),n}{if("function"!=typeof r[i])return r[i];const s=r[i];return Object.defineProperty(r,i,{...Object.getOwnPropertyDescriptor(r,i),value:t.wrap({name:i,...e},s)}),r}}}}annotate(e,t){}exportSpan(e){return{}}submitEvaluation(e,t){}flush(){}}},6402:(e,t,r)=>{"use strict";const{channel:s}=r(1247),n={trace:10,debug:20,info:30,warn:40,error:50,critical:50,off:100},i=s("datadog:log:trace"),a=s("datadog:log:debug"),o=s("datadog:log:info"),c=s("datadog:log:warn"),_=s("datadog:log:error"),u=n.debug;e.exports={LogChannel:class{constructor(e){this._level=function(e){return e&&"string"==typeof e&&n[e.toLowerCase().trim()]||u}(e)}subscribe(e){n.trace>=this._level&&i.subscribe(e.trace),n.debug>=this._level&&a.subscribe(e.debug),n.info>=this._level&&o.subscribe(e.info),n.warn>=this._level&&c.subscribe(e.warn),n.error>=this._level&&_.subscribe(e.error)}unsubscribe(e){i.hasSubscribers&&i.unsubscribe(e.trace),a.hasSubscribers&&a.unsubscribe(e.debug),o.hasSubscribers&&o.unsubscribe(e.info),c.hasSubscribers&&c.unsubscribe(e.warn),_.hasSubscribers&&_.unsubscribe(e.error)}},traceChannel:i,debugChannel:a,infoChannel:o,warnChannel:c,errorChannel:_}},5004:(e,t,r)=>{"use strict";const s=r(6538),{inspect:n}=r(9023),{isTrue:i}=r(9421),{traceChannel:a,debugChannel:o,infoChannel:c,warnChannel:_,errorChannel:u}=r(6402),l=r(7513),{Log:p}=r(726),d=e=>{const t={};return function(r){return t[r]||(t[r]=e.apply(this,arguments)),t[r]}},h={enabled:!1,logger:void 0,logLevel:"debug"},g={getConfig:()=>({...h}),use(e){return h.logger=e,l.use(e),this},toggle(e,t){return h.enabled=e,h.logLevel=t,l.toggle(e,t),this},reset(){return l.reset(),this._deprecate=d(((e,t)=>(u.publish(p.parse(t)),!0))),this},trace(...e){if(a.hasSubscribers){const t={};Error.captureStackTrace(t,this.trace);const r=t.stack.split("\n"),s=r[1].replace(/^\s+at ([^\s]+) .+/,"$1"),i={depth:2,breakLength:1/0,compact:!0,maxArrayLength:1/0},o=e.map((e=>n(e,i))).join(", ");r[0]=`Trace: ${s}(${o})`,a.publish(p.parse(r.join("\n")))}return this},debug(...e){return o.hasSubscribers&&o.publish(p.parse(...e)),this},info(...e){return c.hasSubscribers&&c.publish(p.parse(...e)),this},warn(...e){return _.hasSubscribers&&_.publish(p.parse(...e)),this},error(...e){return u.hasSubscribers&&u.publish(p.parse(...e)),this},deprecate(e,t){return this._deprecate(e,t)}};g.reset();const E=i(s(process.env.DD_TRACE_DEBUG,"debug"===process.env.OTEL_LOG_LEVEL,h.enabled)),f=s(process.env.DD_TRACE_LOG_LEVEL,process.env.OTEL_LOG_LEVEL,h.logLevel);g.toggle(E,f),e.exports=g},726:(e,t,r)=>{"use strict";const{format:s}=r(9023);class n{constructor(e,t,r,s){this.message=e,this.args=t,this.cause=r,this.delegate=s}get formatted(){const{message:e,args:t}=this;let r=e;return e&&t&&t.length&&(r=s(e,...t)),r}static parse(...e){let t,r,s;const i=e[e.length-1];i&&"object"==typeof i&&i.stack&&(r=e.pop());const a=e.shift();return a?"string"==typeof a?t=a:"object"==typeof a?t=String(a.message||a):"function"==typeof a?s=a:t=String(a):r||(t=String(a)),new n(t,e,r,s)}}e.exports={Log:n}},7513:(e,t,r)=>{"use strict";const{storage:s}=r(6882),{LogChannel:n}=r(6402),{Log:i}=r(726),a={debug:e=>console.debug(e),info:e=>console.info(e),warn:e=>console.warn(e),error:e=>console.error(e)};let o=!1,c=a,_=new n;function u(e){const t=s.getStore();s.enterWith({noop:!0}),e(),s.enterWith(t)}function l(e,t){_.unsubscribe({trace:f,debug:E,info:g,warn:h,error:d}),e&&(_=new n(t),_.subscribe({trace:f,debug:E,info:g,warn:h,error:d}))}function p(e){if(e&&"function"==typeof e.delegate){const t=e.delegate();return Array.isArray(t)?i.parse(...t):i.parse(t)}return e}function d(e){const{formatted:t,cause:r}=p(e);t&&u((()=>c.error(new Error(t)))),r&&u((()=>c.error(r)))}function h(e){const{formatted:t,cause:r}=p(e);t&&u((()=>c.warn(t))),r&&u((()=>c.warn(r)))}function g(e){const{formatted:t,cause:r}=p(e);t&&u((()=>c.info(t))),r&&u((()=>c.info(r)))}function E(e){const{formatted:t,cause:r}=p(e);t&&u((()=>c.debug(t))),r&&u((()=>c.debug(r)))}function f(e){const{formatted:t,cause:r}=p(e);t&&u((()=>c.debug(t))),r&&u((()=>c.debug(r)))}e.exports={use:function(e){e&&e.debug instanceof Function&&e.error instanceof Function&&(c=e)},toggle:function(e,t){o=e,l(o,t)},reset:function(){c=a,o=!1,l(!1)},error:function(...e){d(i.parse(...e))},warn:function(...e){const t=i.parse(...e);if(!c.warn)return E(t);h(t)},info:function(...e){const t=i.parse(...e);if(!c.info)return E(t);g(t)},debug:function(...e){E(i.parse(...e))},trace:function(...e){f(i.parse(...e))}}},4751:e=>{"use strict";e.exports=class{constructor(e=2097152){this.buffer=Buffer.allocUnsafe(e),this.view=new DataView(this.buffer.buffer),this.length=0,this._minSize=e}write(e){const t=Buffer.byteLength(e),r=this.length;return t<32?(this.reserve(t+1),this.buffer[r]=160|t):t<4294967296&&(this.reserve(t+5),this.buffer[r]=219,this.buffer[r+1]=t>>24,this.buffer[r+2]=t>>16,this.buffer[r+3]=t>>8,this.buffer[r+4]=t),this.buffer.utf8Write(e,this.length-t,t),this.length-r}copy(e,t,r){e.set(new Uint8Array(this.buffer.buffer,t,r-t))}set(e){const t=this.length;this.reserve(e.length),this.buffer.set(e,t)}reserve(e){this.length+e>this.buffer.length&&this._resize(this._minSize*Math.ceil((this.length+e)/this._minSize)),this.length+=e}_resize(e){const t=this.buffer;this.buffer=Buffer.allocUnsafe(e),this.view=new DataView(this.buffer.buffer),t.copy(this.buffer,0,0,this.length)}}},7482:(e,t,r)=>{"use strict";const s=r(4751);e.exports={MsgpackEncoder:class{encode(e){const t=new s;return this.encodeValue(t,e),t.buffer.subarray(0,t.length)}encodeValue(e,t){switch(typeof t){case"bigint":this.encodeBigInt(e,t);break;case"boolean":this.encodeBoolean(e,t);break;case"number":this.encodeNumber(e,t);break;case"object":null===t?this.encodeNull(e,t):Array.isArray(t)?this.encodeArray(e,t):Buffer.isBuffer(t)||ArrayBuffer.isView(t)?this.encodeBin(e,t):this.encodeMap(e,t);break;case"string":this.encodeString(e,t);break;case"symbol":this.encodeString(e,t.toString());break;default:this.encodeNull(e,t)}}encodeNull(e){const t=e.length;e.reserve(1),e.buffer[t]=192}encodeBoolean(e,t){const r=e.length;e.reserve(1),e.buffer[r]=t?195:194}encodeString(e,t){e.write(t)}encodeFixArray(e,t=0){const r=e.length;e.reserve(1),e.buffer[r]=144+t}encodeArrayPrefix(e,t){const r=t.length,s=e.length;e.reserve(5),e.buffer[s]=221,e.buffer[s+1]=r>>24,e.buffer[s+2]=r>>16,e.buffer[s+3]=r>>8,e.buffer[s+4]=r}encodeArray(e,t){t.length<16?this.encodeFixArray(e,t.length):this.encodeArrayPrefix(e,t);for(const r of t)this.encodeValue(e,r)}encodeFixMap(e,t=0){const r=e.length;e.reserve(1),e.buffer[r]=128+t}encodeMapPrefix(e,t){const r=e.length;e.reserve(5),e.buffer[r]=223,e.buffer[r+1]=t>>24,e.buffer[r+2]=t>>16,e.buffer[r+3]=t>>8,e.buffer[r+4]=t}encodeByte(e,t){e.reserve(1),e.buffer[e.length-1]=t}encodeBin(e,t){const r=e.length;t.byteLength<256?(e.reserve(2),e.buffer[r]=196,e.buffer[r+1]=t.byteLength):t.byteLength<65536?(e.reserve(3),e.buffer[r]=197,e.buffer[r+1]=t.byteLength>>8,e.buffer[r+2]=t.byteLength):(e.reserve(5),e.buffer[r]=198,e.buffer[r+1]=t.byteLength>>24,e.buffer[r+2]=t.byteLength>>16,e.buffer[r+3]=t.byteLength>>8,e.buffer[r+4]=t.byteLength),e.set(t)}encodeInteger(e,t){const r=e.length;e.reserve(5),e.buffer[r]=206,e.buffer[r+1]=t>>24,e.buffer[r+2]=t>>16,e.buffer[r+3]=t>>8,e.buffer[r+4]=t}encodeShort(e,t){const r=e.length;e.reserve(3),e.buffer[r]=205,e.buffer[r+1]=t>>8,e.buffer[r+2]=t}encodeLong(e,t){const r=e.length,s=t/Math.pow(2,32)|0,n=t>>>0;e.reserve(9),e.buffer[r]=207,e.buffer[r+1]=s>>24,e.buffer[r+2]=s>>16,e.buffer[r+3]=s>>8,e.buffer[r+4]=s,e.buffer[r+5]=n>>24,e.buffer[r+6]=n>>16,e.buffer[r+7]=n>>8,e.buffer[r+8]=n}encodeNumber(e,t){Number.isNaN(t)&&(t=0),Number.isInteger(t)?t>=0?this.encodeUnsigned(e,t):this.encodeSigned(e,t):this.encodeFloat(e,t)}encodeSigned(e,t){const r=e.length;if(t>=-32)e.reserve(1),e.buffer[r]=t;else if(t>=-128)e.reserve(2),e.buffer[r]=208,e.buffer[r+1]=t;else if(t>=-32768)e.reserve(3),e.buffer[r]=209,e.buffer[r+1]=t>>8,e.buffer[r+2]=t;else if(t>=-2147483648)e.reserve(5),e.buffer[r]=210,e.buffer[r+1]=t>>24,e.buffer[r+2]=t>>16,e.buffer[r+3]=t>>8,e.buffer[r+4]=t;else{const s=Math.floor(t/Math.pow(2,32)),n=t>>>0;e.reserve(9),e.buffer[r]=211,e.buffer[r+1]=s>>24,e.buffer[r+2]=s>>16,e.buffer[r+3]=s>>8,e.buffer[r+4]=s,e.buffer[r+5]=n>>24,e.buffer[r+6]=n>>16,e.buffer[r+7]=n>>8,e.buffer[r+8]=n}}encodeUnsigned(e,t){const r=e.length;if(t<=127)e.reserve(1),e.buffer[r]=t;else if(t<=255)e.reserve(2),e.buffer[r]=204,e.buffer[r+1]=t;else if(t<=65535)e.reserve(3),e.buffer[r]=205,e.buffer[r+1]=t>>8,e.buffer[r+2]=t;else if(t<=4294967295)e.reserve(5),e.buffer[r]=206,e.buffer[r+1]=t>>24,e.buffer[r+2]=t>>16,e.buffer[r+3]=t>>8,e.buffer[r+4]=t;else{const s=t/Math.pow(2,32)|0,n=t>>>0;e.reserve(9),e.buffer[r]=207,e.buffer[r+1]=s>>24,e.buffer[r+2]=s>>16,e.buffer[r+3]=s>>8,e.buffer[r+4]=s,e.buffer[r+5]=n>>24,e.buffer[r+6]=n>>16,e.buffer[r+7]=n>>8,e.buffer[r+8]=n}}encodeBigInt(e,t){const r=e.length;e.reserve(9),t>=0n?(e.buffer[r]=207,e.view.setBigUint64(r+1,t)):(e.buffer[r]=211,e.view.setBigInt64(r+1,t))}encodeMap(e,t){const r=Object.keys(t);this.encodeMapPrefix(e,r.length);for(const s of r)this.encodeValue(e,s),this.encodeValue(e,t[s])}encodeFloat(e,t){const r=e.length;e.reserve(9),e.buffer[r]=203,e.view.setFloat64(r+1,t)}}}},9978:(e,t,r)=>{"use strict";const s=r(4751),{MsgpackEncoder:n}=r(7482);e.exports={Chunk:s,MsgpackEncoder:n}},589:e=>{e.exports=class{increment(){}gauge(){}distribution(){}histogram(){}flush(){}}},8698:(e,t,r)=>{"use strict";const s=r(1301),n=r(1953),i=r(589),a=r(1897),o=new s,c=new n,_=new i,u=new a(o);e.exports=class{constructor(){this._tracer=o,this.appsec=c,this.dogstatsd=_,this.llmobs=u}init(){return this}use(){return this}profilerStarted(){return Promise.resolve(!1)}trace(e,t,r){if(r||(r=t,t={}),"function"==typeof r)return t=t||{},this._tracer.trace(e,t,r)}wrap(e,t,r){return r||(r=t,t={}),"function"!=typeof r?r:(t=t||{},this._tracer.wrap(e,t,r))}setUrl(){return this._tracer.setUrl.apply(this._tracer,arguments),this}startSpan(){return this._tracer.startSpan.apply(this._tracer,arguments)}inject(){return this._tracer.inject.apply(this._tracer,arguments)}extract(){return this._tracer.extract.apply(this._tracer,arguments)}scope(){return this._tracer.scope.apply(this._tracer,arguments)}getRumData(){return this._tracer.getRumData.apply(this._tracer,arguments)}setUser(e){return this.appsec.setUser(e),this}get TracerProvider(){return r(3434)}}},4702:e=>{"use strict";e.exports=class{active(){return null}activate(e,t){return"function"!=typeof t?t:t()}bind(e,t){return e}}},8800:(e,t,r)=>{"use strict";const s=r(9164),n=r(4248),{storage:i}=r(6882);e.exports=class{constructor(e,t){this._store=i.getHandle(),this._noopTracer=e,this._noopContext=this._createContext(t)}context(){return this._noopContext}tracer(){return this._noopTracer}setOperationName(e){return this}setBaggageItem(e,t){return this}getBaggageItem(e){}getAllBaggageItems(){}removeBaggageItem(e){return this}removeAllBaggageItems(){return this}setTag(e,t){return this}addTags(e){return this}addLink(e){return this}addSpanPointer(e,t,r){return this}log(){return this}logEvent(){}finish(e){}_createContext(e){const t=n();return new s(e?{noop:this,traceId:e._traceId,spanId:t,parentId:e._spanId,baggageItems:Object.assign({},e._baggageItems)}:{noop:this,traceId:t,spanId:t})}}},9164:(e,t,r)=>{"use strict";const s=r(4506),n=r(1013).USER_REJECT;e.exports=class extends s{constructor(e){super(e),this._sampling.priority=n}}},1301:(e,t,r)=>{"use strict";const s=r(4702),n=r(8800);e.exports=class{constructor(e){this._scope=new s,this._span=new n(this)}configure(e){}trace(e,t,r){return r(this._span,(()=>{}))}wrap(e,t,r){return r}scope(){return this._scope}getRumData(){return""}setUrl(){}startSpan(e,t){return this._span}inject(e,t,r){}extract(e,t){return this._span.context()}setUser(){return this}}},3098:(e,t,r)=>{"use strict";const{storage:s}=r(6882),{trace:n,ROOT_CONTEXT:i,propagation:a}=r(350),o=r(4506),c=r(4317),_=r(4508);e.exports=class{constructor(){this._store=s("opentelemetry")}active(){const e=_.scope().active(),t=this._store.getStore(),r=e&&e.context()||t||i;if(!(r instanceof o)){const e=n.getSpan(r);if(e&&e._spanContext&&e._spanContext._ddContext&&e._spanContext._ddContext._baggageItems){const t=e._spanContext._ddContext._baggageItems,s={};for(const[e,r]of Object.entries(t))s[e]={value:r};const n=a.createBaggage(s);return a.setBaggage(r,n)}return r}const s=JSON.parse(e.getAllBaggageItems()),u={};for(const[e,t]of Object.entries(s))u[e]={value:t};const l=a.createBaggage(u);if(!r._otelSpanContext){const e=new c(r);r._otelSpanContext=e}if(t&&n.getSpanContext(t)===r._otelSpanContext)return l?a.setBaggage(t,l):t;const p=n.setSpanContext(t||i,r._otelSpanContext);return l?a.setBaggage(p,l):p}with(e,t,r,...s){const i=n.getSpan(e),o=_.scope(),c=()=>{const n=null==r?t:t.bind(r);return this._store.run(e,n,...s)},u=a.getBaggage(e);let l=[];if(u&&(l=u.getAllEntries()),i&&i._ddSpan){i._ddSpan.removeAllBaggageItems();for(const e of l)i._ddSpan.setBaggageItem(e[0],e[1].value);return o.activate(i._ddSpan,c)}if(i&&i._spanContext&&i._spanContext._ddContext&&i._spanContext._ddContext._baggageItems){i._spanContext._ddContext._baggageItems={};for(const e of l)i._spanContext._ddContext._baggageItems[e[0]]=e[1].value}return c()}bind(e,t){const r=this;return function(...s){return r.with(e,t,this,...s)}}enable(){}disable(){}}},2573:e=>{"use strict";e.exports=class{shouldSample(e,t,r,s,n,i){return{decision:2}}toString(){return"DatadogSampler"}}},7641:(e,t,r)=>{"use strict";const s=r(350),{performance:n}=r(2987),{timeOrigin:i}=n,{timeInputToHrTime:a}=r(6372),o=r(4508),c=r(1182),{ERROR_MESSAGE:_,ERROR_TYPE:u,ERROR_STACK:l}=r(3636),{SERVICE_NAME:p,RESOURCE_NAME:d}=r(4100),h=r(9386),g=r(4317),E=r(4248);function f(e){return 1e3*e[0]+e[1]/1e6}const T={[s.SpanKind.INTERNAL]:h.INTERNAL,[s.SpanKind.SERVER]:h.SERVER,[s.SpanKind.CLIENT]:h.CLIENT,[s.SpanKind.PRODUCER]:h.PRODUCER,[s.SpanKind.CONSUMER]:h.CONSUMER};function m(e,t,r){if(e)return e;const n=r["operation.name"];if(n)return n;const{INTERNAL:i,SERVER:a,CLIENT:o}=s.SpanKind;for(const e of["http.method","http.request.method"])if(e in r){if(t===a)return"http.server.request";if(t===o)return"http.client.request"}const c=r["db.system"];if(c&&t===o)return`${c}.query`;const _=r["messaging.system"],u=r["messaging.operation"];if(_&&u&&t!==i)return`${_}.${u}`;const l=r["rpc.system"];if(l){if(t===o)return"aws-api"===l?`aws.${r["rpc.service"]||"client"}.request`:`${l}.client.request`;if(t===a)return`${l}.server.request`}const p=r["faas.invoked_provider"],d=r["faas.invoked_name"],h=r["faas.trigger"];if(t===o&&p&&d)return`${p}.${d}.invoke`;if(t===a&&h)return`${h}.invoke`;if("graphql.operation.type"in r)return"graphql.server.request";const g=r["network.protocol.name"],E=g?`${g}.`:"";return t===a?`${E}server.request`:t===o?`${E}client.request`:T[t]}e.exports=class{constructor(e,t,r,s,_,u=[],l,h){const{_tracer:g}=o,E=a(l||n.now()+i),T=f(E);this._ddSpan=new c(g,g._processor,g._prioritySampler,{operationName:m(r,_,h),context:s._ddContext,startTime:T,hostname:g._hostname,integrationName:e?._isOtelLibrary?"otel.library":"otel",tags:{[p]:g._service,[d]:r},links:u},g._debug),h&&this.setAttributes(h),this._parentTracer=e,this._context=t,this._hasStatus=!1,this.startTime=E,this.kind=_,this._spanProcessor.onStart(this,t)}get parentSpanId(){const{_parentId:e}=this._ddSpan.context();return e&&e.toString(16)}get resource(){return this._parentTracer.resource}get instrumentationLibrary(){return this._parentTracer.instrumentationLibrary}get _spanProcessor(){return this._parentTracer.getActiveSpanProcessor()}get name(){return this._ddSpan.context()._name}spanContext(){return new g(this._ddSpan.context())}setAttribute(e,t){return"http.response.status_code"===e&&this._ddSpan.setTag("http.status_code",t.toString()),this._ddSpan.setTag(e,t),this}setAttributes(e){return"http.response.status_code"in e&&(e["http.status_code"]=e["http.response.status_code"].toString()),this._ddSpan.addTags(e),this}addLink(e,t){const r=e._ddContext;return this._ddSpan.addLink(r,t),this}addSpanPointer(e,t,r){const s=new g({traceId:E("0"),spanId:E("0")}),n={"ptr.kind":e,"ptr.dir":t,"ptr.hash":r,"link.kind":"span-pointer"};return this.addLink(s,n)}setStatus({code:e,message:t}){return this.ended||this._hasStatus||!e||(this._hasStatus=!0,2===e&&this._ddSpan.addTags({[_]:t})),this}updateName(e){return this.ended||this._ddSpan.setOperationName(e),this}end(e){if(this.ended)return void s.diag.error("You can only call end() on a span once.");const t=f(a(e||n.now()+i));this._ddSpan.finish(t),this._spanProcessor.onEnd(this)}isRecording(){return!1===this.ended}addEvent(e,t,r){return r=t&&function(e){return"number"==typeof e||e instanceof Date||!(!Array.isArray(e)||2!==e.length||"number"!=typeof e[0]||"number"!=typeof e[1])}(t)?t:r,r=f(a(r||n.now()+i)),this._ddSpan.addEvent(e,t,r),this}recordException(e,t){this._ddSpan.addTags({[u]:e.name,[_]:e.message,[l]:e.stack,doNotSetTraceError:!0});const r={};e.message&&(r["exception.message"]=e.message),e.type&&(r["exception.type"]=e.type),e.escaped&&(r["exception.escaped"]=e.escaped),e.stack&&(r["exception.stacktrace"]=e.stack),this.addEvent(e.name,r,t)}get duration(){return this._ddSpan._duration}get ended(){return void 0!==this.duration}}},4317:(e,t,r)=>{"use strict";const s=r(350),{AUTO_KEEP:n}=r(1013),i=r(4506),a=r(4248);e.exports=class{constructor(e){e instanceof i||(e=e?new i(e):function(){const e=a();return new i({traceId:e,spanId:e})}()),this._ddContext=e}get traceId(){return this._ddContext.toTraceId(!0)}get spanId(){return this._ddContext.toSpanId(!0)}get traceFlags(){return this._ddContext._sampling.priority>=n?1:0}get traceState(){const e=this._ddContext._tracestate;return s.createTraceState(e?e.toString():"")}}},9702:e=>{"use strict";class t{forceFlush(){return Promise.resolve()}onStart(e,t){}onEnd(e){}shutdown(){return Promise.resolve()}}e.exports={MultiSpanProcessor:class extends t{constructor(e){super(),this._processors=e}forceFlush(){return Promise.all(this._processors.map((e=>e.forceFlush())))}onStart(e,t){for(const r of this._processors)r.onStart(e,t)}onEnd(e){for(const t of this._processors)t.onEnd(e)}shutdown(){return Promise.all(this._processors.map((e=>e.shutdown())))}},NoopSpanProcessor:t}},2056:(e,t,r)=>{"use strict";const s=r(350),{sanitizeAttributes:n}=r(6372),i=r(2573),a=r(7641),o=r(4248),c=r(4317),_=r(5711);e.exports=class{constructor(e,t,r){this._sampler=new i,this._config=t,this._tracerProvider=r,this.instrumentationLibrary=e,this._isOtelLibrary=e?.name?.startsWith("@opentelemetry/instrumentation-"),this._spanLimits={}}get resource(){return this._tracerProvider.resource}_createSpanContextFromParent(e){return new c({traceId:e._traceId,spanId:o(),parentId:e._spanId,sampling:e._sampling,baggageItems:Object.assign({},e._baggageItems),trace:e._trace,tracestate:e._tracestate})}_createSpanContextForNewSpan(e){const{traceId:t,spanId:r,traceFlags:s,traceState:n}=e;return _._convertOtelContextToDatadog(t,r,s,n)}startSpan(e,t={},r=s.context.active()){t.root&&(r=s.trace.deleteSpan(r));const i=s.trace.getSpan(r),o=i&&i.spanContext();let _;_=o&&s.trace.isSpanContextValid(o)?o._ddContext?this._createSpanContextFromParent(o._ddContext):this._createSpanContextForNewSpan(o):new c;const u=t.kind||s.SpanKind.INTERNAL,l=(t.links||[]).map((e=>({context:e.context,attributes:n(e.attributes)}))),p=n(t.attributes);return new a(this,r,e,_,u,l,t.startTime,n(p))}startActiveSpan(e,t,r,n){if(2===arguments.length)n=t,r=void 0,t=void 0;else if(3===arguments.length)n=r,r=void 0;else if(4!==arguments.length)return;const i=r||s.context.active(),a=this.startSpan(e,t,i),o=s.trace.setSpan(i,a);return s.context.with(o,n,void 0,a)}getActiveSpanProcessor(){return this._tracerProvider.getActiveSpanProcessor()}getSpanLimits(){return this._spanLimits}}},3434:(e,t,r)=>{"use strict";const{trace:s,context:n,propagation:i}=r(350),{W3CTraceContextPropagator:a}=r(6372),o=r(4508),c=r(3098),{MultiSpanProcessor:_,NoopSpanProcessor:u}=r(9702),l=r(2056);e.exports=class{constructor(e={}){this.config=e,this.resource=e.resource,this._processors=[],this._tracers=new Map,this._activeProcessor=new u,this._contextManager=new c}getTracer(e="opentelemetry",t="0.0.0",r){const s=`${e}@${t}`;return this._tracers.has(s)||this._tracers.set(s,new l({...r,name:e,version:t},this.config,this)),this._tracers.get(s)}addSpanProcessor(e){this._processors.length||this._activeProcessor.shutdown(),this._processors.push(e),this._activeProcessor=new _(this._processors)}getActiveSpanProcessor(){return this._activeProcessor}register(e={}){n.setGlobalContextManager(this._contextManager),s.setGlobalTracerProvider(this)||s.getTracerProvider().setDelegate(this),e.propagator?i.setGlobalPropagator(e.propagator):i.setGlobalPropagator(new a)}forceFlush(){const e=o._tracer._exporter;return e?(e._writer.flush(),this._activeProcessor.forceFlush()):Promise.reject(new Error("Not started"))}shutdown(){return this._activeProcessor.shutdown()}}},3716:e=>{"use strict";e.exports=class{inject(e,t){}extract(e){return null}}},2937:(e,t,r)=>{"use strict";const s=r(5711);e.exports=class extends s{}},4019:(e,t,r)=>{"use strict";const s=r(4248),n=r(4506);e.exports=class{constructor(e){this._config=e}inject(e,t){t&&(t.dd={},e&&(this._config.traceId128BitLoggingEnabled&&e._trace.tags["_dd.p.tid"]?t.dd.trace_id=e.toTraceId(!0):t.dd.trace_id=e.toTraceId(),t.dd.span_id=e.toSpanId()),this._config.service&&(t.dd.service=this._config.service),this._config.version&&(t.dd.version=this._config.version),this._config.env&&(t.dd.env=this._config.env))}extract(e){if(!(e&&e.dd&&e.dd.trace_id&&e.dd.span_id))return null;if(32===e.dd.trace_id.length){const t=e.dd.trace_id.substring(0,16),r=e.dd.trace_id.substring(16,32),i=new n({traceId:s(r,16),spanId:s(e.dd.span_id,10)});return i._trace.tags["_dd.p.tid"]=t,i}return new n({traceId:s(e.dd.trace_id,10),spanId:s(e.dd.span_id,10)})}}},5711:(e,t,r)=>{"use strict";const s=r(2963),n=r(4248),i=r(4506),a=r(5004),o=r(8667),c=r(4100),{channel:_}=r(1247),{AUTO_KEEP:u,AUTO_REJECT:l,USER_KEEP:p}=r(1013),d=_("dd-trace:span:inject"),h=_("dd-trace:span:extract"),g="x-datadog-trace-id",E="x-datadog-parent-id",f="x-datadog-origin",T="x-datadog-sampling-priority",m="x-datadog-tags",S="ot-baggage-",I="x-b3-traceid",R=/^([0-9a-f]{16}){1,2}$/i,A="x-b3-spanid",y=/^[0-9a-f]{16}$/i,b="x-b3-parentspanid",O="x-b3-sampled",v="x-b3-flags",C="b3",P=/^(([0-9a-f]{16}){1,2}-[0-9a-f]{16}(-[01d](-[0-9a-f]{16})?)?|[01d])$/i,D=new RegExp(`^${S}(.+)$`),L=/^_dd\.p\.[\x21-\x2b\x2d-\x7e]+$/,N=/^[\x20-\x2b\x2d-\x7e]*$/,M=[g,E,T,f].concat([I,A,b,O,v,C]),x=/^([a-f0-9]{2})-([a-f0-9]{32})-([a-f0-9]{16})-([a-f0-9]{2})(-.*)?$/i,U="traceparent",w=/[^\x20-\x2b\x2d-\x3a\x3c-\x7d]/g,B=/[^\x21-\x2b\x2d-\x3c\x3e-\x7e]/g,k=/[^\x20-\x2b\x2d-\x3a\x3c-\x7d]/g,G=/^0+$/;e.exports=class{constructor(e){this._config=e}inject(e,t){e&&t&&(this._injectBaggageItems(e,t),this._injectDatadog(e,t),this._injectB3MultipleHeaders(e,t),this._injectB3SingleHeader(e,t),this._injectTraceparent(e,t),d.hasSubscribers&&d.publish({spanContext:e,carrier:t}),a.debug((()=>`Inject into carrier: ${JSON.stringify(s(t,M))}.`)))}extract(e){const t=this._extractSpanContext(e);return t?(h.hasSubscribers&&h.publish({spanContext:t,carrier:e}),a.debug((()=>`Extract from carrier: ${JSON.stringify(s(e,M))}.`)),t):t}_injectDatadog(e,t){this._hasPropagationStyle("inject","datadog")&&(t[g]=e.toTraceId(),t[E]=e.toSpanId(),this._injectOrigin(e,t),this._injectSamplingPriority(e,t),this._injectTags(e,t))}_injectOrigin(e,t){const r=e._trace.origin;r&&(t[f]=r)}_injectSamplingPriority(e,t){const r=e._sampling.priority;Number.isInteger(r)&&(t[T]=r.toString())}_encodeOtelBaggageKey(e){let t=encodeURIComponent(e);return t=t.replaceAll("(","%28"),t=t.replaceAll(")","%29"),t}_injectBaggageItems(e,t){if(this._config.legacyBaggageEnabled&&e._baggageItems&&Object.keys(e._baggageItems).forEach((r=>{t[S+r]=String(e._baggageItems[r])})),this._hasPropagationStyle("inject","baggage")){let r="",s=0,n=0;for(const[t,i]of Object.entries(e._baggageItems)){const e=`${this._encodeOtelBaggageKey(String(t).trim())}=${encodeURIComponent(String(i).trim())},`;if(s+=1,n+=e.length,s>this._config.baggageMaxItems||n>this._config.baggageMaxBytes)break;r+=e}r=r.slice(0,r.length-1),r&&(t.baggage=r)}}_injectTags(e,t){const r=e._trace;if(0===this._config.tagsHeaderMaxLength)return void a.debug("Trace tag propagation is disabled, skipping injection.");const s=[];for(const e in r.tags)if(r.tags[e]&&e.startsWith("_dd.p.")){if(!this._validateTagKey(e)||!this._validateTagValue(r.tags[e]))return void a.error("Trace tags from span are invalid, skipping injection.");s.push(`${e}=${r.tags[e]}`)}const n=s.join(",");n.length>this._config.tagsHeaderMaxLength?a.error("Trace tags from span are too large, skipping injection."):n&&(t[m]=n)}_injectB3MultipleHeaders(e,t){const r=this._hasPropagationStyle("inject","b3"),s=this._hasPropagationStyle("inject","b3multi");(r||s)&&(t[I]=this._getB3TraceId(e),t[A]=e._spanId.toString(16),t[O]=e._sampling.priority>=u?"1":"0",e._sampling.priority>u&&(t[v]="1"),e._parentId&&(t[b]=e._parentId.toString(16)))}_injectB3SingleHeader(e,t){if(!this._hasPropagationStyle("inject","b3 single header"))return null;const r=this._getB3TraceId(e),s=e._spanId.toString(16),n=e._sampling.priority>=u?"1":"0";t[C]=`${r}-${s}-${n}`,e._parentId&&(t[C]+="-"+e._parentId.toString(16))}_injectTraceparent(e,t){if(!this._hasPropagationStyle("inject","tracecontext"))return;const{_sampling:{priority:r,mechanism:s},_tracestate:n=new o,_trace:{origin:i,tags:a}}=e;t[U]=e.toTraceparent(),n.forVendor("dd",(t=>{if(e._isRemote?e._trace.tags[a.DD_PARENT_ID]&&t.set("p",e._trace.tags[a.DD_PARENT_ID]):t.set("p",e._spanId),t.set("s",r),s&&t.set("t.dm",`-${s}`),"string"==typeof i){const e=i.replace(w,"_").replace(/[\x3d]/g,"~");t.set("o",e)}for(const e in a){if(!a[e]||!e.startsWith("_dd.p."))continue;const r="t."+e.slice(6).replace(B,"_"),s=a[e].toString().replace(k,"_").replace(/[\x3d]/g,"~");t.set(r,s)}})),t.tracestate=n.toString()}_hasPropagationStyle(e,t){return this._config.tracePropagationStyle[e].includes(t)}_hasTraceIdConflict(e,t){return null!==e&&t.toTraceId(!0)===e.toTraceId(!0)&&t.toSpanId()!==e.toSpanId()}_hasParentIdInTags(e){return c.DD_PARENT_ID in e._trace.tags}_updateParentIdFromDdHeaders(e,t){const r=this._extractDatadogContext(e);null!==r&&(t._trace.tags[c.DD_PARENT_ID]=r._spanId.toString().padStart(16,"0"))}_resolveTraceContextConflicts(e,t,r){return this._hasTraceIdConflict(e,t)?(this._hasParentIdInTags(e)?t._trace.tags[c.DD_PARENT_ID]=e._trace.tags[c.DD_PARENT_ID]:this._updateParentIdFromDdHeaders(r,t),t._spanId=e._spanId,t):t}_extractSpanContext(e){let t=null;for(const r of this._config.tracePropagationStyle.extract){let s=null;switch(r){case"datadog":s=this._extractDatadogContext(e);break;case"tracecontext":s=this._extractTraceparentContext(e);break;case"b3 single header":s=this._extractB3SingleContext(e);break;case"b3":s=this._config.tracePropagationStyle.otelPropagators?this._extractB3SingleContext(e):this._extractB3MultiContext(e);break;case"b3multi":s=this._extractB3MultiContext(e);break;default:"baggage"!==r&&a.warn(`Unknown propagation style: ${r}`)}if(null!==s)if(null===t){if(t=s,this._config.tracePropagationExtractFirst)return t}else if("tracecontext"===r&&(t=this._resolveTraceContextConflicts(this._extractTraceparentContext(e),t,e)),s._traceId&&s._spanId&&s.toTraceId(!0)!==t.toTraceId(!0)){const e={context:s,attributes:{reason:"terminated_context",context_headers:r}};t._links.push(e)}}return this._hasPropagationStyle("extract","baggage")&&e.baggage&&(t=t||new i,this._extractBaggageItems(e,t)),t||this._extractSqsdContext(e)}_extractDatadogContext(e){const t=this._extractGenericContext(e,g,E,10);if(!t)return t;if(this._extractOrigin(e,t),this._extractLegacyBaggageItems(e,t),this._extractSamplingPriority(e,t),this._extractTags(e,t),this._config.tracePropagationExtractFirst)return t;const r=this._extractTraceparentContext(e);return r&&t._traceId.equals(r._traceId)&&(t._traceparent=r._traceparent,t._tracestate=r._tracestate),t}_extractB3MultiContext(e){const t=this._extractB3MultipleHeaders(e);return t?this._extractB3Context(t):null}_extractB3SingleContext(e){if(!P.test(e[C]))return null;const t=this._extractB3SingleHeader(e);return t?this._extractB3Context(t):null}_extractB3Context(e){const t="1"===e[v],r=this._getPriority(e[O],t),s=this._extractGenericContext(e,I,A,16);if(void 0!==r){if(!s)return new i({traceId:n(),spanId:null,sampling:{priority:r},isRemote:!0});s._sampling.priority=r}return this._extract128BitTraceId(e[I],s),s}_extractSqsdContext(e){const t=e["x-aws-sqsd-attr-_datadog"];if(!t)return null;let r;try{r=JSON.parse(t)}catch(e){return null}return this._extractDatadogContext(r)}_extractTraceparentContext(e){const t=e[U];if(!t)return null;const r=t.trim().match(x);if(r?.length){const[t,s,a,_,u]=r.slice(1),l={version:t},p=o.fromString(e.tracestate);if(G.test(s))return null;if(G.test(a))return null;if("ff"===t)return null;if(u&&"00"===t)return null;const d=new i({traceId:n(s,16),spanId:n(a,16),isRemote:!0,sampling:{priority:1&parseInt(_,10)?1:0},traceparent:l,tracestate:p});return this._extract128BitTraceId(s,d),p.forVendor("dd",(e=>{for(const[t,r]of e.entries())switch(t){case"p":d._trace.tags[c.DD_PARENT_ID]=r;break;case"s":{const e=parseInt(r,10);if(!Number.isInteger(e))continue;(1===d._sampling.priority&&e>0||0===d._sampling.priority&&e<0)&&(d._sampling.priority=e);break}case"o":d._trace.origin=r;break;case"t.dm":{const e=Math.abs(parseInt(r,10));Number.isInteger(e)&&(d._sampling.mechanism=e,d._trace.tags["_dd.p.dm"]=`-${e}`);break}default:if(!t.startsWith("t."))continue;d._trace.tags[`_dd.p.${t.slice(2)}`]=r.replace(/[\x7e]/gm,"=")}})),this._extractLegacyBaggageItems(e,d),d}return null}_extractGenericContext(e,t,r,s){return e&&e[t]&&e[r]?G.test(e[t])?null:new i({traceId:n(e[t],s),spanId:n(e[r],s),isRemote:!0}):null}_extractB3MultipleHeaders(e){let t=!0;const r={};return R.test(e[I])&&y.test(e[A])&&(r[I]=e[I],r[A]=e[A],t=!1),e[O]&&(r[O]=e[O],t=!1),e[v]&&(r[v]=e[v],t=!1),t?null:r}_extractB3SingleHeader(e){const t=e[C];if(!t)return null;const r=t.split("-");if("d"===r[0])return{[O]:"1",[v]:"1"};if(1===r.length)return{[O]:r[0]};{const e={[I]:r[0],[A]:r[1]};return r[2]&&(e[O]="0"!==r[2]?"1":"0","d"===r[2]&&(e[v]="1")),e}}_extractOrigin(e,t){const r=e[f];"string"==typeof e[f]&&(t._trace.origin=r)}_decodeOtelBaggageKey(e){let t=decodeURIComponent(e);return t=t.replaceAll("%28","("),t=t.replaceAll("%29",")"),t}_extractLegacyBaggageItems(e,t){this._config.legacyBaggageEnabled&&Object.keys(e).forEach((r=>{const s=r.match(D);s&&(t._baggageItems[s[1]]=e[r])}))}_extractBaggageItems(e,t){const r=e.baggage.split(",");for(const e of r){if(!e.includes("="))return void(t._baggageItems={});let[r,s]=e.split("=");if(r=this._decodeOtelBaggageKey(r.trim()),s=decodeURIComponent(s.trim()),!r||!s)return void(t._baggageItems={});if(r in t._baggageItems)return;t._baggageItems[r]=s}}_extractSamplingPriority(e,t){const r=parseInt(e[T],10);Number.isInteger(r)&&(t._sampling.priority=r)}_extractTags(e,t){if(!e[m])return;const r=t._trace;if(0===this._config.tagsHeaderMaxLength)a.debug("Trace tag propagation is disabled, skipping extraction.");else if(e[m].length>this._config.tagsHeaderMaxLength)a.error("Trace tags from carrier are too large, skipping extraction.");else{const t=e[m].split(","),s={};for(const e of t){const[t,...r]=e.split("="),n=r.join("=");if(!this._validateTagKey(t)||!this._validateTagValue(n))return void a.error("Trace tags from carrier are invalid, skipping extraction.");s[t]=n}Object.assign(r.tags,s)}}_extract128BitTraceId(e,t){if(!t)return;if(16!==t._traceId.toBuffer().length)return;const r=e.substring(0,16);"0000000000000000"!==r&&(t._trace.tags["_dd.p.tid"]=r)}_validateTagKey(e){return L.test(e)}_validateTagValue(e){return N.test(e)}_getPriority(e,t){return t?p:"1"===e?u:"0"===e?l:void 0}_getB3TraceId(e){return e._traceId.toBuffer().length<=8&&e._trace.tags["_dd.p.tid"]?e._trace.tags["_dd.p.tid"]+e._traceId.toString(16):e._traceId.toString(16)}static _getSamplingPriority(e,t,r=null){const s=!t&&"rum"===r;let n;return n=s||0!==e||t&&!(t>=0)?s||1!==e||t&&!(t<0)?t:1:0,n}}},8667:e=>{"use strict";const t=/[ \t]*([^=]+)=([ \t]*[^, \t]+)[ \t]*(,|$)/gim,r=/([^:]+):([^;]+)(;|$)/gim;function s(e,t,r){if("string"!=typeof r||!r.length)return new e;const s=[];for(const e of r.matchAll(t))s.unshift(e.slice(1,3));return new e(s)}function n(e,t,r){return Array.from(e.entries()).reverse().map((e=>e.join(t))).join(r)}class i extends Map{constructor(...e){super(...e),this.changed=!1}set(...e){if(!this.has(e[0])||this.get(e[0])!==e[1])return this.changed=!0,super.set(...e)}delete(...e){return this.changed=!0,super.delete(...e)}clear(...e){return this.changed=!0,super.clear(...e)}static fromString(e){return s(i,r,e)}toString(){return n(this,":",";")}}class a extends Map{set(e,t){return this.has(e)&&this.delete(e),super.set(e,t)}forVendor(e,t){const r=super.get(e),s=i.fromString(r),n=t(s);return s.changed&&(s.toString()?this.set(e,s.toString()):this.delete(e)),n}static fromString(e){return s(a,t,e)}toString(){return n(this,"=",",")}}e.exports=a},1182:(e,t,r)=>{"use strict";const{performance:s}=r(2987),n=s.now.bind(s),i=Date.now,a=r(4506),o=r(4248),c=r(5487),_=r(5004),{storage:u}=r(6882),l=r(5608),{channel:p}=r(1247),d=r(9023),h=l.manager.namespace("tracers"),{DD_TRACE_EXPERIMENTAL_STATE_TRACKING:g}=process.env,E=!!process.env.DD_TRACE_OTEL_ENABLED,f=["string","number","boolean"],T={spans_created:{},spans_finished:{}},m=p("dd-trace:span:start"),S=p("dd-trace:span:finish");function I(e,t){const r=T[e];if(t in r)return r[t];const s=h.count(e,[`integration_name:${t.toLowerCase()}`,`otel_enabled:${E}`]);return T[e][t]=s,s}class R{constructor(e,t,r,s,n){const i=s.operationName,a=s.parent||null,o=Object.assign({},s.tags),c=s.hostname;this._parentTracer=e,this._debug=n,this._processor=t,this._prioritySampler=r,this._store=u.getHandle(),this._duration=void 0,this._events=[],this._name=i,this._integrationName=s.integrationName||"opentracing",I("spans_created",this._integrationName).inc(),this._spanContext=this._createContext(a,s),this._spanContext._name=i,this._spanContext._tags=o,this._spanContext._hostname=c,this._spanContext._trace.started.push(this),this._startTime=s.startTime||this._getTime(),this._links=[],s.links&&s.links.forEach((e=>this.addLink(e.context,e.attributes))),m.hasSubscribers&&m.publish({span:this,fields:s})}[d.inspect.custom](){return{...this,_parentTracer:`[${this._parentTracer.constructor.name}]`,_prioritySampler:`[${this._prioritySampler.constructor.name}]`,_processor:`[${this._processor.constructor.name}]`}}toString(){const e=this.context(),t=e._tags["resource.name"]||"",r=t.length>100?`${t.substring(0,97)}...`:t;return`Span${JSON.stringify({traceId:e._traceId,spanId:e._spanId,parentId:e._parentId,service:e._tags["service.name"],name:e._name,resource:r})}`}context(){return this._spanContext}tracer(){return this._parentTracer}setOperationName(e){return this._spanContext._name=e,this}setBaggageItem(e,t){return this._spanContext._baggageItems[e]=t,this}getBaggageItem(e){return this._spanContext._baggageItems[e]}getAllBaggageItems(){return JSON.stringify(this._spanContext._baggageItems)}removeBaggageItem(e){delete this._spanContext._baggageItems[e]}removeAllBaggageItems(){this._spanContext._baggageItems={}}setTag(e,t){return this._addTags({[e]:t}),this}addTags(e){return this._addTags(e),this}log(){return this}logEvent(){}addLink(e,t){this._links.push({context:e._ddContext?e._ddContext:e,attributes:this._sanitizeAttributes(t)})}addSpanPointer(e,t,r){const s=new a({traceId:o("0"),spanId:o("0")}),n={"ptr.kind":e,"ptr.dir":t,"ptr.hash":r,"link.kind":"span-pointer"};this.addLink(s,n)}addEvent(e,t,r){const s={name:e};t&&("object"==typeof t?s.attributes=this._sanitizeEventAttributes(t):r=t),s.startTime=r||this._getTime(),this._events.push(s)}finish(e){void 0===this._duration&&("true"===g&&(this._spanContext._tags["service.name"]||_.error("Finishing invalid span: %s",this)),I("spans_finished",this._integrationName).inc(),e=parseFloat(e)||this._getTime(),this._duration=e-this._startTime,this._spanContext._trace.finished.push(this),this._spanContext._isFinished=!0,S.publish(this),this._processor.process(this))}_sanitizeAttributes(e={}){const t={},r=(e,s)=>{if(Array.isArray(s))for(const t in s)r(`${e}.${t}`,s[t]);else{const r=s;f.includes(typeof r)?t[e]="string"==typeof r?r:String(r):_.warn("Dropping span link attribute. It is not of an allowed type")}};return Object.entries(e).forEach((e=>{const[t,s]=e;r(t,s)})),t}_sanitizeEventAttributes(e={}){const t={};for(const r in e){const s=e[r];if(Array.isArray(s)){const e=[];for(const t in s)f.includes(typeof s[t])?e.push(s[t]):_.warn("Dropping span event attribute. It is not of an allowed type");t[r]=e}else f.includes(typeof s)?t[r]=s:_.warn("Dropping span event attribute. It is not of an allowed type")}return t}_createContext(e,t){let r,s;if(t.context)r=t.context,r._trace.startTime||(s=i());else if(e)r=new a({traceId:e._traceId,spanId:o(),parentId:e._spanId,sampling:e._sampling,baggageItems:Object.assign({},e._baggageItems),trace:e._trace,tracestate:e._tracestate}),r._trace.startTime||(s=i());else{const e=o();s=i(),r=new a({traceId:e,spanId:e}),r._trace.startTime=s,t.traceId128BitGenerationEnabled&&(r._trace.tags["_dd.p.tid"]=Math.floor(s/1e3).toString(16).padStart(8,"0").padEnd(16,"0"))}return r._trace.ticks=r._trace.ticks||n(),s&&(r._trace.startTime=s),r._isRemote=!1,r}_getTime(){const{startTime:e,ticks:t}=this._spanContext._trace;return e+n()-t}_addTags(e){c.add(this._spanContext._tags,e),this._prioritySampler.sample(this,!1)}}e.exports=R},4506:(e,t,r)=>{"use strict";const s=r(9023),{AUTO_KEEP:n}=r(1013),i="_dd.p.tid";class a{constructor(e){e=e||{},this._traceId=e.traceId,this._spanId=e.spanId,this._isRemote=e.isRemote??!0,this._parentId=e.parentId||null,this._name=e.name,this._isFinished=e.isFinished||!1,this._tags=e.tags||{},this._sampling=e.sampling||{},this._spanSampling=void 0,this._links=e.links||[],this._baggageItems=e.baggageItems||{},this._traceparent=e.traceparent,this._tracestate=e.tracestate,this._noop=e.noop||null,this._trace=e.trace||{started:[],finished:[],tags:{}},this._otelSpanContext=void 0}[s.inspect.custom](){return{...this,_trace:{...this._trace,started:"[Array]",finished:"[Array]"}}}toTraceId(e=!1){return e?this._traceId.toBuffer().length<=8&&this._trace.tags[i]?this._trace.tags[i]+this._traceId.toString(16).padStart(16,"0"):this._traceId.toString(16).padStart(32,"0"):this._traceId.toString(10)}toSpanId(e=!1){return e?this._spanId.toString(16).padStart(16,"0"):this._spanId.toString(10)}toTraceparent(){const e=this._sampling.priority>=n?"01":"00",t=this.toTraceId(!0),r=this.toSpanId(!0);return`${this._traceparent&&this._traceparent.version||"00"}-${t}-${r}-${e}`}}e.exports=a},6527:(e,t,r)=>{"use strict";const s=r(857),n=r(1182),i=r(5214),a=r(5134),o=r(5711),c=r(2937),_=r(3716),u=r(4019),l=r(9429),p=r(5004),d=r(9312),h=r(4506);e.exports=class{constructor(e,t){const r=d(e.experimental.exporter);this._config=e,this._service=e.service,this._version=e.version,this._env=e.env,this._logInjection=e.logInjection,this._debug=e.debug,this._prioritySampler=t??new a(e.env,e.sampler),this._exporter=new r(e,this._prioritySampler),this._processor=new i(this._exporter,this._prioritySampler,e),this._url=this._exporter._url,this._enableGetRumData=e.experimental.enableGetRumData,this._traceId128BitGenerationEnabled=e.traceId128BitGenerationEnabled,this._propagators={[l.TEXT_MAP]:new o(e),[l.HTTP_HEADERS]:new c(e),[l.BINARY]:new _(e),[l.LOG]:new u(e)},e.reportHostname&&(this._hostname=s.hostname())}startSpan(e,t={}){const r=t.childOf?((i=t.childOf)instanceof n&&(i=i.context()),i instanceof h||(i=null),i):function(e=[]){let t=null;for(let r=0;r<e.length;r++){const s=e[r],n=s.type();if("child_of"===n){t=s.referencedContext();break}"follows_from"===n&&(t||(t=s.referencedContext()))}return t}(t.references),s={"service.name":t?.tags?.service?String(t.tags.service):this._service};var i;t?.tags?.service&&t.tags.service!==this._service&&(t.tags.version=void 0);const a=new n(this,this._processor,this._prioritySampler,{operationName:t.operationName||e,parent:r,tags:s,startTime:t.startTime,hostname:this._hostname,traceId128BitGenerationEnabled:this._traceId128BitGenerationEnabled,integrationName:t.integrationName,links:t.links},this._debug);return a.addTags(this._config.tags),a.addTags(t.tags),a}inject(e,t,r){e instanceof n&&(e=e.context());try{"text_map_dsm"!==t&&this._prioritySampler.sample(e),this._propagators[t].inject(e,r)}catch(e){p.error("Error injecting trace",e)}}extract(e,t){try{return this._propagators[e].extract(t)}catch(e){return p.error("Error extracting trace",e),null}}}},6569:(e,t,r)=>{const s={aws:r(8123)};function n(e,t,r){return Object.fromEntries(Object.entries(e).map((([e,s])=>[e,{request:s.request.concat(t||[]),response:s.response.concat(r||[]),expand:s.expand||[]}])))}e.exports={appendRules:function(e,t){return Object.fromEntries(Object.entries(s).map((([r,s])=>[r,n(s,e,t)])))}}},8523:(e,t,r)=>{"use strict";const s=r(9896),n=r(6928);function i(){return r.c[r.s]&&r.c[r.s].filename?n.dirname(r.c[r.s].filename):process.cwd()}function a(e,t,r){for(;;){const i=n.resolve(r,e);if(s.existsSync(i))return i;if(r===t)return;r=n.dirname(r)}}e.exports=Object.assign(function(){const e=i(),t=n.resolve(e),r=n.parse(t);if(!r)return{};const{root:o}=r,c=a("package.json",o,t);try{return JSON.parse(s.readFileSync(c,"utf8"))}catch(e){return{}}}(),{findRoot:i,findUp:a})},8092:(e,t,r)=>{const{readFileSync:s}=r(9896),{GIT_BRANCH:n,GIT_COMMIT_SHA:i,GIT_TAG:a,GIT_COMMIT_AUTHOR_EMAIL:o,GIT_COMMIT_AUTHOR_NAME:c,GIT_COMMIT_MESSAGE:_,GIT_COMMIT_AUTHOR_DATE:u,GIT_COMMIT_HEAD_SHA:l,GIT_PULL_REQUEST_BASE_BRANCH_SHA:p,GIT_PULL_REQUEST_BASE_BRANCH:d,GIT_REPOSITORY_URL:h,CI_PIPELINE_ID:g,CI_PIPELINE_NAME:E,CI_PIPELINE_NUMBER:f,CI_PIPELINE_URL:T,CI_PROVIDER_NAME:m,CI_WORKSPACE_PATH:S,CI_JOB_URL:I,CI_JOB_NAME:R,CI_STAGE_NAME:A,CI_ENV_VARS:y,GIT_COMMIT_COMMITTER_NAME:b,GIT_COMMIT_COMMITTER_EMAIL:O,CI_NODE_LABELS:v,CI_NODE_NAME:C}=r(1154),{filterSensitiveInfoFromRepository:P}=r(6866);function D(e,t,r){e[t]&&(e[t]=r(e[t]))}function L(e){return e?e.replace(/origin\/|refs\/heads\/|tags\//gm,""):e}function N(e){return e&&"string"==typeof e?"~"!==e[0]||"/"!==e[1]&&1!==e.length?e:e.replace("~",process.env.HOME):""}e.exports={normalizeRef:L,getCIMetadata(){const{env:e}=process;let t={};if(e.JENKINS_URL){const{WORKSPACE:r,BUILD_TAG:s,JOB_NAME:o,BUILD_NUMBER:c,BUILD_URL:_,GIT_BRANCH:u,GIT_COMMIT:l,GIT_URL:p,GIT_URL_1:d,DD_CUSTOM_TRACE_ID:I,NODE_NAME:R,NODE_LABELS:A}=e;if(t={[g]:s,[f]:c,[T]:_,[m]:"jenkins",[i]:l,[h]:p||d,[S]:r,[y]:JSON.stringify({DD_CUSTOM_TRACE_ID:I}),[C]:R},A){let e;try{e=JSON.stringify(A.split(" ")),t[v]=e}catch(e){}}const b=u&&u.includes("tags/")?a:n,O=L(u);t[b]=O;let P="";if(o){const e=o.split("/");P=e.length>1&&e[1].includes("=")?e[0]:o.replace(`/${O}`,""),t[E]=P}}if(e.GITLAB_CI){const{CI_PIPELINE_ID:r,CI_PROJECT_PATH:s,CI_PIPELINE_IID:l,CI_PIPELINE_URL:p,CI_PROJECT_DIR:d,CI_COMMIT_REF_NAME:b,CI_COMMIT_TAG:O,CI_COMMIT_SHA:P,CI_REPOSITORY_URL:D,CI_JOB_URL:L,CI_JOB_STAGE:N,CI_JOB_NAME:M,CI_COMMIT_MESSAGE:x,CI_COMMIT_TIMESTAMP:U,CI_COMMIT_AUTHOR:w,CI_PROJECT_URL:B,CI_JOB_ID:k,CI_RUNNER_ID:G,CI_RUNNER_TAGS:V}=e,{name:j,email:$}=function(e){if(!e)return{name:"",email:""};let t="",r="";const s=e.match(/(?:"?([^"]*)"?\s)?(?:<?(.+@[^>]+)>?)/);return s&&(t=s[1],r=s[2]),{name:t,email:r}}(w);t={[g]:r,[E]:s,[f]:l,[m]:"gitlab",[i]:P,[h]:D,[I]:L,[a]:O,[n]:b,[S]:d,[T]:p,[A]:N,[R]:M,[_]:x,[c]:j,[o]:$,[u]:U,[y]:JSON.stringify({CI_PROJECT_URL:B,CI_PIPELINE_ID:r,CI_JOB_ID:k}),[v]:V,[C]:G}}if(e.CIRCLECI){const{CIRCLE_WORKFLOW_ID:r,CIRCLE_PROJECT_REPONAME:s,CIRCLE_BUILD_URL:o,CIRCLE_WORKING_DIRECTORY:c,CIRCLE_BRANCH:_,CIRCLE_TAG:u,CIRCLE_SHA1:l,CIRCLE_REPOSITORY_URL:p,CIRCLE_JOB:d,CIRCLE_BUILD_NUM:f}=e,A=`https://app.circleci.com/pipelines/workflows/${r}`;t={[g]:r,[E]:s,[T]:A,[R]:d,[m]:"circleci",[i]:l,[h]:p,[I]:o,[S]:c,[a]:u,[n]:_,[y]:JSON.stringify({CIRCLE_WORKFLOW_ID:r,CIRCLE_BUILD_NUM:f})}}if(e.GITHUB_ACTIONS||e.GITHUB_ACTION){const{GITHUB_RUN_ID:r,GITHUB_WORKFLOW:o,GITHUB_RUN_NUMBER:c,GITHUB_WORKSPACE:_,GITHUB_HEAD_REF:u,GITHUB_REF:A,GITHUB_SHA:b,GITHUB_REPOSITORY:O,GITHUB_SERVER_URL:v,GITHUB_RUN_ATTEMPT:C,GITHUB_JOB:D,GITHUB_BASE_REF:L}=e,N=`${v}/${O}.git`;let M=`${v}/${O}/actions/runs/${r}`;C&&(M=`${M}/attempts/${C}`);const x=`${v}/${O}/commit/${b}/checks`,U=u||A||"",w=U.includes("tags/")?a:n;if(t={[g]:r,[E]:o,[f]:c,[T]:P(M),[m]:"github",[i]:b,[h]:N,[I]:P(x),[R]:D,[S]:_,[w]:U,[y]:JSON.stringify({GITHUB_SERVER_URL:P(v),GITHUB_REPOSITORY:O,GITHUB_RUN_ID:r,GITHUB_RUN_ATTEMPT:C})},L){t[d]=L;try{const e=function(){if(process.env.GITHUB_EVENT_PATH)return JSON.parse(s(process.env.GITHUB_EVENT_PATH,"utf8"))}();t[p]=e.pull_request.base.sha,t[l]=e.pull_request.head.sha}catch(e){}}}if(e.APPVEYOR){const{APPVEYOR_REPO_NAME:r,APPVEYOR_REPO_PROVIDER:s,APPVEYOR_BUILD_FOLDER:u,APPVEYOR_BUILD_ID:l,APPVEYOR_BUILD_NUMBER:p,APPVEYOR_REPO_COMMIT:d,APPVEYOR_PULL_REQUEST_HEAD_REPO_BRANCH:R,APPVEYOR_REPO_BRANCH:A,APPVEYOR_REPO_TAG_NAME:y,APPVEYOR_REPO_COMMIT_AUTHOR:b,APPVEYOR_REPO_COMMIT_AUTHOR_EMAIL:O,APPVEYOR_REPO_COMMIT_MESSAGE:v,APPVEYOR_REPO_COMMIT_MESSAGE_EXTENDED:C}=e,P=`https://ci.appveyor.com/project/${r}/builds/${l}`;t={[m]:"appveyor",[T]:P,[g]:l,[E]:r,[f]:p,[I]:P,[S]:u,[c]:b,[o]:O,[_]:v+"\n"+C},"github"===s&&(t={...t,[h]:`https://github.com/${r}.git`,[i]:d,[a]:y,[n]:R||A})}if(e.TF_BUILD){const{BUILD_SOURCESDIRECTORY:r,BUILD_BUILDID:s,BUILD_DEFINITIONNAME:u,SYSTEM_TEAMFOUNDATIONSERVERURI:l,SYSTEM_TEAMPROJECTID:p,SYSTEM_JOBID:d,SYSTEM_TASKINSTANCEID:b,SYSTEM_PULLREQUEST_SOURCEBRANCH:O,BUILD_SOURCEBRANCH:v,BUILD_SOURCEBRANCHNAME:C,SYSTEM_PULLREQUEST_SOURCECOMMITID:P,SYSTEM_PULLREQUEST_SOURCEREPOSITORYURI:D,BUILD_REPOSITORY_URI:L,BUILD_SOURCEVERSION:N,BUILD_REQUESTEDFORID:M,BUILD_REQUESTEDFOREMAIL:x,BUILD_SOURCEVERSIONMESSAGE:U,SYSTEM_STAGEDISPLAYNAME:w,SYSTEM_JOBDISPLAYNAME:B}=e,k=O||v||C,G=(k||"").includes("tags/")?a:n;if(t={[m]:"azurepipelines",[g]:s,[E]:u,[f]:s,[i]:P||N,[S]:r,[h]:D||L,[G]:k,[c]:M,[o]:x,[_]:U,[A]:w,[R]:B,[y]:JSON.stringify({SYSTEM_TEAMPROJECTID:p,BUILD_BUILDID:s,SYSTEM_JOBID:d})},l&&p&&s){const e=`${l}${p}/_build/results?buildId=${s}`,r=e,n=`${e}&view=logs&j=${d}&t=${b}`;t={...t,[T]:r,[I]:n}}}if(e.BITBUCKET_COMMIT){const{BITBUCKET_REPO_FULL_NAME:r,BITBUCKET_BUILD_NUMBER:s,BITBUCKET_BRANCH:o,BITBUCKET_COMMIT:c,BITBUCKET_GIT_SSH_ORIGIN:_,BITBUCKET_GIT_HTTP_ORIGIN:u,BITBUCKET_TAG:l,BITBUCKET_PIPELINE_UUID:p,BITBUCKET_CLONE_DIR:d}=e,R=`https://bitbucket.org/${r}/addon/pipelines/home#!/results/${s}`;t={[m]:"bitbucket",[i]:c,[f]:s,[E]:r,[I]:R,[T]:R,[n]:o,[a]:l,[h]:_||u,[S]:d,[g]:p&&p.replace(/{|}/gm,"")}}if(e.BITRISE_BUILD_SLUG){const{BITRISE_GIT_COMMIT:r,GIT_CLONE_COMMIT_HASH:s,BITRISEIO_GIT_BRANCH_DEST:o,BITRISE_GIT_BRANCH:c,BITRISE_BUILD_SLUG:u,BITRISE_TRIGGERED_WORKFLOW_ID:l,BITRISE_BUILD_NUMBER:p,BITRISE_BUILD_URL:d,BITRISE_SOURCE_DIR:I,GIT_REPOSITORY_URL:R,BITRISE_GIT_TAG:A,BITRISE_GIT_MESSAGE:y}=e;t={[m]:"bitrise",[g]:u,[E]:l,[f]:p,[T]:d,[i]:r||s,[h]:R,[S]:I,[a]:A,[n]:o||c,[_]:y}}if(e.BUILDKITE){const{BUILDKITE_BRANCH:r,BUILDKITE_COMMIT:s,BUILDKITE_REPO:u,BUILDKITE_TAG:l,BUILDKITE_BUILD_ID:p,BUILDKITE_PIPELINE_SLUG:d,BUILDKITE_BUILD_NUMBER:R,BUILDKITE_BUILD_URL:A,BUILDKITE_JOB_ID:b,BUILDKITE_BUILD_CHECKOUT_PATH:O,BUILDKITE_BUILD_AUTHOR:P,BUILDKITE_BUILD_AUTHOR_EMAIL:D,BUILDKITE_MESSAGE:L,BUILDKITE_AGENT_ID:N}=e,M=Object.keys(e).filter((e=>e.startsWith("BUILDKITE_AGENT_META_DATA_"))).map((t=>`${t.replace("BUILDKITE_AGENT_META_DATA_","").toLowerCase()}:${e[t]}`));t={[m]:"buildkite",[g]:p,[E]:d,[f]:R,[T]:A,[I]:`${A}#${b}`,[i]:s,[S]:O,[h]:u,[a]:l,[n]:r,[c]:P,[o]:D,[_]:L,[y]:JSON.stringify({BUILDKITE_BUILD_ID:p,BUILDKITE_JOB_ID:b}),[C]:N,[v]:JSON.stringify(M)}}if(e.TRAVIS){const{TRAVIS_PULL_REQUEST_BRANCH:r,TRAVIS_BRANCH:s,TRAVIS_COMMIT:o,TRAVIS_REPO_SLUG:c,TRAVIS_TAG:u,TRAVIS_JOB_WEB_URL:l,TRAVIS_BUILD_ID:p,TRAVIS_BUILD_NUMBER:d,TRAVIS_BUILD_WEB_URL:R,TRAVIS_BUILD_DIR:A,TRAVIS_COMMIT_MESSAGE:y}=e;t={[m]:"travisci",[I]:l,[g]:p,[E]:c,[f]:d,[T]:R,[i]:o,[h]:`https://github.com/${c}.git`,[S]:A,[a]:u,[n]:r||s,[_]:y}}if(e.BUDDY){const{BUDDY_EXECUTION_BRANCH:r,BUDDY_EXECUTION_ID:s,BUDDY_EXECUTION_REVISION:o,BUDDY_EXECUTION_REVISION_COMMITTER_EMAIL:c,BUDDY_EXECUTION_REVISION_COMMITTER_NAME:u,BUDDY_EXECUTION_REVISION_MESSAGE:l,BUDDY_EXECUTION_TAG:p,BUDDY_EXECUTION_URL:d,BUDDY_PIPELINE_ID:S,BUDDY_PIPELINE_NAME:I,BUDDY_SCM_URL:R}=e;t={[m]:"buddy",[g]:`${S}/${s}`,[E]:I,[f]:s,[T]:d,[i]:o,[h]:R,[n]:r,[a]:p,[_]:l,[b]:u,[O]:c}}if(e.TEAMCITY_VERSION){const{BUILD_URL:r,TEAMCITY_BUILDCONF_NAME:s,DATADOG_BUILD_ID:n}=e;t={[m]:"teamcity",[I]:r,[R]:s,[y]:JSON.stringify({DATADOG_BUILD_ID:n})}}if(e.CF_BUILD_ID){const{CF_BUILD_ID:r,CF_PIPELINE_NAME:s,CF_BUILD_URL:i,CF_STEP_NAME:o,CF_BRANCH:c}=e;t={[m]:"codefresh",[g]:r,[E]:s,[T]:i,[R]:o,[y]:JSON.stringify({CF_BUILD_ID:r})};const _=c&&c.includes("tags/")?a:n,u=L(c);t[_]=u}if(e.CODEBUILD_INITIATOR?.startsWith("codepipeline/")){const{CODEBUILD_BUILD_ARN:r,DD_ACTION_EXECUTION_ID:s,DD_PIPELINE_EXECUTION_ID:n}=e;t={[m]:"awscodepipeline",[g]:n,[y]:JSON.stringify({CODEBUILD_BUILD_ARN:r,DD_PIPELINE_EXECUTION_ID:n,DD_ACTION_EXECUTION_ID:s})}}return D(t,S,N),D(t,h,P),D(t,n,L),D(t,a,L),function(e){return Object.keys(e).reduce(((t,r)=>e[r]?{...t,[r]:e[r]}:t),{})}(t)}}},9052:(e,t,r)=>{const s=r(857),n="os.platform",i="os.version",a="os.architecture",o="runtime.name",c="runtime.version",_="_dd.host.vcpu_count";e.exports={getRuntimeAndOSMetadata:function(){return{[c]:process.version,[a]:process.arch,[n]:process.platform,[o]:"node",[i]:s.release(),[_]:s.cpus().length}},OS_PLATFORM:n,OS_VERSION:i,OS_ARCHITECTURE:a,RUNTIME_NAME:o,RUNTIME_VERSION:c,DD_HOST_CPU_COUNT:_}},2919:(e,t,r)=>{const s=r(5317),n=r(857),i=r(6928),a=r(9896),o=r(5004),{GIT_COMMIT_SHA:c,GIT_BRANCH:_,GIT_REPOSITORY_URL:u,GIT_TAG:l,GIT_COMMIT_MESSAGE:p,GIT_COMMIT_COMMITTER_DATE:d,GIT_COMMIT_COMMITTER_EMAIL:h,GIT_COMMIT_COMMITTER_NAME:g,GIT_COMMIT_AUTHOR_DATE:E,GIT_COMMIT_AUTHOR_EMAIL:f,GIT_COMMIT_AUTHOR_NAME:T,CI_WORKSPACE_PATH:m}=r(1154),{incrementCountMetric:S,distributionMetric:I,TELEMETRY_GIT_COMMAND:R,TELEMETRY_GIT_COMMAND_MS:A,TELEMETRY_GIT_COMMAND_ERRORS:y}=r(806),{filterSensitiveInfoFromRepository:b}=r(6866),{storage:O}=r(6882),v=12582912;function C(e,t,r,n,i){const a=O.getStore();let c;O.enterWith({noop:!0}),r&&S(r.name,r.tags),n&&(c=Date.now());try{const r=s.execFileSync(e,t,{stdio:"pipe"}).toString().replace(/(\r\n|\n|\r)/gm,"");return n&&I(n.name,n.tags,Date.now()-c),r}catch(e){return i&&S(i.name,{...i.tags,errorType:e.code,exitCode:e.status||e.errno}),o.error("Git plugin error executing command",e),""}finally{O.enterWith(a)}}e.exports={getGitMetadata:function(e){const{commitSHA:t,branch:r,repositoryUrl:s,tag:n,commitMessage:i,authorName:a,authorEmail:o,ciWorkspacePath:S}=e,[I,R,A,y,O,v]=C("git",["show","-s","--format=%an,%ae,%aI,%cn,%ce,%cI"]).split(",");return{[u]:b(s||C("git",["ls-remote","--get-url"])),[p]:i||C("git",["show","-s","--format=%s"]),[E]:A,[T]:a||I,[f]:o||R,[d]:v,[g]:y,[h]:O,[_]:r||C("git",["rev-parse","--abbrev-ref","HEAD"]),[c]:t||C("git",["rev-parse","HEAD"]),[l]:n,[m]:S||C("git",["rev-parse","--show-toplevel"])}},getLatestCommits:function(){S(R,{command:"get_local_commits"});const e=Date.now();try{const t=s.execFileSync("git",["log","--format=%H","-n 1000",'--since="1 month ago"'],{stdio:"pipe"}).toString().split("\n").filter((e=>e));return I(A,{command:"get_local_commits"},Date.now()-e),t}catch(e){return o.error("Get latest commits failed: %s",e.message),S(y,{command:"get_local_commits",errorType:e.status}),[]}},getRepositoryUrl:function(){return C("git",["config","--get","remote.origin.url"],{name:R,tags:{command:"get_repository"}},{name:A,tags:{command:"get_repository"}},{name:y,tags:{command:"get_repository"}})},generatePackFilesForCommits:function(e){let t=[];const r=n.tmpdir();if(!function(e){try{return a.statSync(e).isDirectory()}catch(e){return!1}}(r))return o.error(new Error("Provided path to generate packfiles is not a directory")),[];const c=String(Math.floor(1e4*Math.random())),_=i.join(r,c),u=i.join(process.cwd(),c);S(R,{command:"pack_objects"});const l=Date.now();function p(t){return s.execFileSync("git",["pack-objects","--compression=9","--max-pack-size=3m",t],{stdio:"pipe",input:e.join("\n")}).toString().split("\n").filter((e=>e)).map((e=>`${t}-${e}.pack`))}try{t=p(_)}catch(e){o.error("Git plugin error executing git pack-objects command",e),S(y,{command:"pack_objects",exitCode:e.status||e.errno,errorType:e.code});try{t=p(u)}catch(e){o.error("Git plugin error executing fallback git pack-objects command",e),S(y,{command:"pack_objects",exitCode:e.status||e.errno,errorType:e.code})}}return I(A,{command:"pack_objects"},Date.now()-l),t},getCommitsRevList:function(e,t){let r=null;const n=e.map((e=>`^${e}`));S(R,{command:"get_objects"});const i=Date.now();try{r=s.execFileSync("git",["rev-list","--objects","--no-object-names","--filter=blob:none",'--since="1 month ago"',...n,...t],{stdio:"pipe",maxBuffer:v}).toString().split("\n").filter((e=>e))}catch(e){o.error("Get commits to upload failed: %s",e.message),S(y,{command:"get_objects",errorType:e.code,exitCode:e.status||e.errno})}return I(A,{command:"get_objects"},Date.now()-i),r},GIT_REV_LIST_MAX_BUFFER:v,isShallowRepository:function(){return"true"===C("git",["rev-parse","--is-shallow-repository"],{name:R,tags:{command:"check_shallow"}},{name:A,tags:{command:"check_shallow"}},{name:y,tags:{command:"check_shallow"}})},unshallowRepository:function(){const e=function(){const e=C("git",["version"]).match(/git version (\d+)\.(\d+)\.(\d+)/);try{return{major:parseInt(e[1]),minor:parseInt(e[2]),patch:parseInt(e[3])}}catch(e){return null}}();if(!e)return void o.warn("Git version could not be extracted, so git unshallow will not proceed");if(e.major<2||2===e.major&&e.minor<27)return void o.warn("Git version is <2.27, so git unshallow will not proceed");const t=C("git",["config","--default","origin","--get","clone.defaultRemoteName"]),r=C("git",["rev-parse","HEAD"]),n=["fetch",'--shallow-since="1 month ago"',"--update-shallow","--filter=blob:none","--recurse-submodules=no",t];S(R,{command:"unshallow"});const i=Date.now();try{s.execFileSync("git",[...n,r],{stdio:"pipe"})}catch(e){o.error("Git plugin error executing git command",e),S(y,{command:"unshallow",errorType:e.code,exitCode:e.status||e.errno});const t=C("git",["rev-parse","--abbrev-ref","--symbolic-full-name","@{upstream}"]);try{s.execFileSync("git",[...n,t],{stdio:"pipe"})}catch(e){o.error("Git plugin error executing fallback git command",e),S(y,{command:"unshallow",errorType:e.code,exitCode:e.status||e.errno}),C("git",n,null,null,{name:y,tags:{command:"unshallow"}})}}I(A,{command:"unshallow"},Date.now()-i)},isGitAvailable:function(){const e="win32"===n.platform()?"where":"which";try{return s.execFileSync(e,["git"],{stdio:"pipe"}),!0}catch(e){return S(y,{command:"check_git",exitCode:"missing"}),!1}}}},1154:e=>{e.exports={GIT_COMMIT_SHA:"git.commit.sha",GIT_BRANCH:"git.branch",GIT_REPOSITORY_URL:"git.repository_url",GIT_TAG:"git.tag",GIT_COMMIT_MESSAGE:"git.commit.message",GIT_COMMIT_COMMITTER_DATE:"git.commit.committer.date",GIT_COMMIT_COMMITTER_EMAIL:"git.commit.committer.email",GIT_COMMIT_COMMITTER_NAME:"git.commit.committer.name",GIT_COMMIT_AUTHOR_DATE:"git.commit.author.date",GIT_COMMIT_AUTHOR_EMAIL:"git.commit.author.email",GIT_COMMIT_AUTHOR_NAME:"git.commit.author.name",GIT_COMMIT_HEAD_SHA:"git.commit.head_sha",GIT_PULL_REQUEST_BASE_BRANCH_SHA:"git.pull_request.base_branch_sha",GIT_PULL_REQUEST_BASE_BRANCH:"git.pull_request.base_branch",CI_PIPELINE_ID:"ci.pipeline.id",CI_PIPELINE_NAME:"ci.pipeline.name",CI_PIPELINE_NUMBER:"ci.pipeline.number",CI_PIPELINE_URL:"ci.pipeline.url",CI_PROVIDER_NAME:"ci.provider.name",CI_WORKSPACE_PATH:"ci.workspace_path",CI_JOB_URL:"ci.job.url",CI_JOB_NAME:"ci.job.name",CI_STAGE_NAME:"ci.stage.name",CI_ENV_VARS:"_dd.ci.env_vars",CI_NODE_NAME:"ci.node.name",CI_NODE_LABELS:"ci.node.labels"}},7507:(e,t,r)=>{const s=r(6928),n=r(9896),{URL:i}=r(7016),a=r(5004),o=r(1958),c=r(2535),{getGitMetadata:_}=r(2919),{getUserProviderGitMetadata:u,validateGitRepositoryUrl:l,validateGitCommitSha:p}=r(8755),{getCIMetadata:d}=r(8092),{getRuntimeAndOSMetadata:h}=r(9052),{GIT_BRANCH:g,GIT_COMMIT_SHA:E,GIT_REPOSITORY_URL:f,GIT_TAG:T,GIT_COMMIT_AUTHOR_EMAIL:m,GIT_COMMIT_AUTHOR_NAME:S,GIT_COMMIT_MESSAGE:I,CI_WORKSPACE_PATH:R,CI_PIPELINE_URL:A,CI_JOB_NAME:y}=r(1154),b=r(4248),{SPAN_TYPE:O,RESOURCE_NAME:v,SAMPLING_PRIORITY:C}=r(4100),{SAMPLING_RULE_DECISION:P}=r(3636),{AUTO_KEEP:D}=r(1013),{version:L}=r(8330),N="test.framework",M="test.framework_version",x="test.type",U="test.name",w="test.suite",B="library_version",k="test.command",G="test.module",V="test.toolchain",j="_dd.ci.itr.tests_skipped",$="test.itr.tests_skipping.enabled",Y="test.itr.tests_skipping.type",H="test.itr.tests_skipping.count",F="test.code_coverage.enabled",K="test.itr.unskippable",q="test.itr.forced_run",X="test.code_coverage.lines_pct",J="Retried by Datadog's Early Flake Detection",W=new RegExp(J+" \\(#\\d+\\): ","g");function z(){try{return process.env.npm_config_user_agent.split(" ")[0].replace("/","-")}catch(e){return""}}function Q(e){return Object.keys(e).reduce(((t,r)=>r!==f||l(e[f])?r!==E||p(e[E])?r!==A||function(e){try{const t=new i(e);return"https:"===t.protocol||"http:"===t.protocol}catch(e){return!1}}(e[A])?(t[r]=e[r],t):t:(a.error("Git commit SHA must be a full-length git SHA: %s.",e[E]),t):(a.error("Repository URL is not a valid repository URL: %s.",e[f]),t)),{})}function Z(e){return"playwright"===e||"cypress"===e?"browser":"test"}e.exports={TEST_CODE_OWNERS:"test.codeowners",TEST_SESSION_NAME:"test_session.name",TEST_FRAMEWORK:N,TEST_FRAMEWORK_VERSION:M,JEST_TEST_RUNNER:"test.jest.test_runner",JEST_DISPLAY_NAME:"test.jest.display_name",CUCUMBER_IS_PARALLEL:"test.cucumber.is_parallel",MOCHA_IS_PARALLEL:"test.mocha.is_parallel",TEST_TYPE:x,TEST_NAME:U,TEST_SUITE:w,TEST_STATUS:"test.status",TEST_PARAMETERS:"test.parameters",TEST_SKIP_REASON:"test.skip_reason",TEST_IS_RUM_ACTIVE:"test.is_rum_active",TEST_SOURCE_FILE:"test.source.file",CI_APP_ORIGIN:"ciapp-test",LIBRARY_VERSION:B,JEST_WORKER_TRACE_PAYLOAD_CODE:60,JEST_WORKER_COVERAGE_PAYLOAD_CODE:61,JEST_WORKER_LOGS_PAYLOAD_CODE:62,CUCUMBER_WORKER_TRACE_PAYLOAD_CODE:70,MOCHA_WORKER_TRACE_PAYLOAD_CODE:80,TEST_SOURCE_START:"test.source.start",TEST_SKIPPED_BY_ITR:"test.skipped_by_itr",TEST_CONFIGURATION_BROWSER_NAME:"test.configuration.browser_name",TEST_IS_NEW:"test.is_new",TEST_IS_RETRY:"test.is_retry",TEST_EARLY_FLAKE_ENABLED:"test.early_flake.enabled",TEST_EARLY_FLAKE_ABORT_REASON:"test.early_flake.abort_reason",TEST_RETRY_REASON:"test.retry_reason",getTestEnvironmentMetadata:function(e,t){const r=d(),{[E]:s,[g]:n,[f]:i,[T]:a,[S]:o,[m]:c,[I]:l,[R]:p}=r,A=_({commitSHA:s,branch:n,repositoryUrl:i,tag:a,authorName:o,authorEmail:c,commitMessage:l,ciWorkspacePath:p}),y=u(),b=h(),O={[N]:e,...A,...r,...y,...b};return t&&t.service&&(O["service.name"]=t.service),Q(O)},getTestParametersString:function(e,t){if(!e[t])return"";try{const r=e[t].shift();return JSON.stringify({arguments:r,metadata:{}})}catch(e){return""}},finishAllTraceSpans:function(e){e.context()._trace.started.forEach((t=>{t!==e&&t.finish()}))},getTestParentSpan:function(e){return e.extract("text_map",{"x-datadog-trace-id":b().toString(10),"x-datadog-parent-id":"0000000000000000"})},getTestSuitePath:function(e,t){return e?(e===t?e:s.relative(t,e)).replace(s.sep,"/"):t},getCodeOwnersFileEntries:function(e){let t,r=e,s=!1;const n=process.cwd();if(r&&r!==n||(r=n,s=!0),t=te(r),t||s||(t=te(n)),!t)return null;const i=[],a=t.split("\n");for(const e of a){const[t]=e.split("#"),r=t.trim();if(""===r)continue;const[s,...n]=r.split(/\s+/);i.push({pattern:s,owners:n})}return i.reverse()},getCodeOwnersForFilename:function(e,t){if(!t)return null;for(const r of t)try{if(c().add(r.pattern).ignores(e))return JSON.stringify(r.owners)}catch(e){return null}return null},getTestCommonTags:function(e,t,r,s){return{[O]:"test",[x]:Z(s),[P]:1,[C]:D,[U]:e,[w]:t,[v]:`${t}.${e}`,[M]:r,[B]:L}},getTestSessionCommonTags:function(e,t,r){return{[O]:"test_session_end",[v]:`test_session.${e}`,[G]:r,[V]:z(),...re(e,t,r)}},getTestModuleCommonTags:function(e,t,r){return{[O]:"test_module_end",[v]:`test_module.${e}`,[G]:r,...re(e,t,r)}},getTestSuiteCommonTags:function(e,t,r,s){return{[O]:"test_suite_end",[v]:`test_suite.${r}`,[G]:s,[w]:r,...re(e,t,s)}},TEST_COMMAND:k,TEST_TOOLCHAIN:V,TEST_SESSION_ID:"test_session_id",TEST_MODULE_ID:"test_module_id",TEST_SUITE_ID:"test_suite_id",TEST_ITR_TESTS_SKIPPED:j,TEST_MODULE:G,TEST_ITR_SKIPPING_ENABLED:$,TEST_ITR_SKIPPING_TYPE:Y,TEST_ITR_SKIPPING_COUNT:H,TEST_CODE_COVERAGE_ENABLED:F,TEST_CODE_COVERAGE_LINES_PCT:X,TEST_ITR_UNSKIPPABLE:K,TEST_ITR_FORCED_RUN:q,ITR_CORRELATION_ID:"itr_correlation_id",addIntelligentTestRunnerSpanTags:function(e,t,{isSuitesSkipped:r,isSuitesSkippingEnabled:s,isCodeCoverageEnabled:n,testCodeCoverageLinesTotal:i,skippingCount:a,skippingType:o="suite",hasUnskippableSuites:c,hasForcedToRunSuites:_}){e.setTag(j,r?"true":"false"),e.setTag($,s?"true":"false"),e.setTag(Y,o),e.setTag(H,a),e.setTag(F,n?"true":"false"),t.setTag(j,r?"true":"false"),t.setTag($,s?"true":"false"),t.setTag(Y,o),t.setTag(H,a),t.setTag(F,n?"true":"false"),c&&(e.setTag(K,"true"),t.setTag(K,"true")),_&&(e.setTag(q,"true"),t.setTag(q,"true")),void 0!==i&&(e.setTag(X,i),t.setTag(X,i))},getCoveredFilenamesFromCoverage:function(e){const t=o.createCoverageMap(e);return t.files().filter((e=>{const r=t.fileCoverageFor(e).getLineCoverage();return Object.entries(r).some((([,e])=>!!e))}))},resetCoverage:function(e){const t=o.createCoverageMap(e);return t.files().forEach((e=>{t.fileCoverageFor(e).resetHits()}))},mergeCoverage:function(e,t){const r=o.createCoverageMap(e);return r.files().forEach((e=>{const s=r.fileCoverageFor(e);t.data[e]||t.addFileCoverage(o.createFileCoverage(e)),t.addFileCoverage(s);const n=t.fileCoverageFor(e);Object.entries(n.data.b).forEach((([e,t])=>{n.data.b[e]=[...t]}))}))},fromCoverageMapToCoverage:function(e){return Object.entries(e.data).reduce(((e,[t,r])=>(e[t]=r.data,e)),{})},getTestLineStart:function(e,t){if(!e.stack)return null;const r=e.stack.split("\n").find((e=>e.includes(t)));try{const e=r.match(/at (?:(.+?)\s+\()?(?:(.+?):(\d+)(?::(\d+))?|([^)]+))\)?/);return parseInt(e[3],10)||null}catch(e){return null}},removeInvalidMetadata:Q,parseAnnotations:function(e){return e.reduce(((e,t)=>{if(!t?.type)return e;const{type:r,description:s}=t;if(r.startsWith("DD_TAGS")){const t=/\[(.*?)\]/.exec(r);let n="";t&&(n=t[1]),n&&(e[n]=s)}return e}),{})},EFD_STRING:J,EFD_TEST_NAME_REGEX:W,removeEfdStringFromTestName:function(e){return e.replace(W,"")},addEfdStringToTestName:function(e,t){return`${J} (#${t}): ${e}`},getIsFaultyEarlyFlakeDetection:function(e,t,r){let s=0;for(const r of e)t[r]||s++;const n=s/e.length*100;return s>r&&n>r},TEST_BROWSER_DRIVER:"test.browser.driver",TEST_BROWSER_DRIVER_VERSION:"test.browser.driver_version",TEST_BROWSER_NAME:"test.browser.name",TEST_BROWSER_VERSION:"test.browser.version",getTestSessionName:function(e,t,r){return e.ciVisibilityTestSessionName?e.ciVisibilityTestSessionName:r[y]?`${r[y]}-${t}`:t},TEST_LEVEL_EVENT_TYPES:["test","test_suite_end","test_module_end","test_session_end"],getNumFromKnownTests:function(e){if(!e)return 0;let t=0;for(const r of Object.values(e))for(const e of Object.values(r))t+=e.length;return t},getFileAndLineNumberFromError:function(e,t){const r=e.stack.split("\n").filter((e=>e.includes("at ")&&e.includes(t))),s=r.findIndex((e=>e.includes(t)&&!se.some((t=>e.includes(t)))));if(-1===s)return[];const n=r[s].match(/\s*at\s+(?:.*\()?(.+):(\d+):(\d+)\)?/);return n?[n[1],Number(n[2]),s]:[]},DI_ERROR_DEBUG_INFO_CAPTURED:"error.debug_info_captured",DI_DEBUG_ERROR_PREFIX:"_dd.debug.error",DI_DEBUG_ERROR_SNAPSHOT_ID_SUFFIX:"snapshot_id",DI_DEBUG_ERROR_FILE_SUFFIX:"file",DI_DEBUG_ERROR_LINE_SUFFIX:"line",getFormattedError:function(e,t){const r=new Error(e.message);return e.stack&&(r.stack=e.stack.split("\n").filter((e=>e.includes(t))).join("\n")),r.name=e.name,r}};const ee=["CODEOWNERS",".github/CODEOWNERS","docs/CODEOWNERS",".gitlab/CODEOWNERS"];function te(e){for(const t of ee)try{return n.readFileSync(s.join(e,t)).toString()}catch(e){}return""}function re(e,t,r){return{[M]:t,[B]:L,[k]:e,[x]:Z(r)}}const se=["node_modules","node:",".pnpm",".yarn",".pnp"]},6866:(e,t,r)=>{const{URL:s}=r(7016);e.exports={filterSensitiveInfoFromRepository:function(e){if(!e)return"";if(e.startsWith("git@"))return e;if(e.startsWith("ssh://")){const t=/^(ssh:\/\/)[^@/]*@/;return e.replace(t,"$1")}try{const{protocol:t,host:r,pathname:n}=new s(e);return`${t}//${r}${"/"===n?"":n}`}catch(e){return""}}}},8755:(e,t,r)=>{const{GIT_COMMIT_SHA:s,GIT_BRANCH:n,GIT_REPOSITORY_URL:i,GIT_TAG:a,GIT_COMMIT_MESSAGE:o,GIT_COMMIT_COMMITTER_DATE:c,GIT_COMMIT_COMMITTER_EMAIL:_,GIT_COMMIT_COMMITTER_NAME:u,GIT_COMMIT_AUTHOR_DATE:l,GIT_COMMIT_AUTHOR_EMAIL:p,GIT_COMMIT_AUTHOR_NAME:d}=r(1154),{normalizeRef:h}=r(8092),{filterSensitiveInfoFromRepository:g}=r(6866);e.exports={getUserProviderGitMetadata:function(){const{DD_GIT_COMMIT_SHA:e,DD_GIT_BRANCH:t,DD_GIT_REPOSITORY_URL:r,DD_GIT_TAG:E,DD_GIT_COMMIT_MESSAGE:f,DD_GIT_COMMIT_COMMITTER_NAME:T,DD_GIT_COMMIT_COMMITTER_EMAIL:m,DD_GIT_COMMIT_COMMITTER_DATE:S,DD_GIT_COMMIT_AUTHOR_NAME:I,DD_GIT_COMMIT_AUTHOR_EMAIL:R,DD_GIT_COMMIT_AUTHOR_DATE:A}=process.env,y=h(t);let b=h(E);return((t||"").includes("origin/tags")||(t||"").includes("refs/heads/tags"))&&(b=h(t)),O={[s]:e,[n]:y,[i]:g(r),[a]:b,[o]:f,[u]:T,[c]:S,[_]:m,[d]:I,[p]:R,[l]:A},Object.keys(O).reduce(((e,t)=>O[t]?{...e,[t]:O[t]}:e),{});var O},validateGitRepositoryUrl:function(e){return/(?:git|ssh|https?|git@[-\w.]+):(\/\/)?(.*?)(\/?|#[-\d\w._]+?)$/.test(e)},validateGitCommitSha:function(e){const t=/^[0-9a-f]{40}$/.test(e),r=/^[0-9a-f]{64}$/.test(e);return t||r}}},5134:(e,t,r)=>{"use strict";const s=r(5004),n=r(6748),i=r(1810),{setSamplingRules:a}=r(2471),o=r(7913),{hasOwn:c}=r(9421),{SAMPLING_MECHANISM_DEFAULT:_,SAMPLING_MECHANISM_AGENT:u,SAMPLING_MECHANISM_RULE:l,SAMPLING_MECHANISM_MANUAL:p,SAMPLING_MECHANISM_REMOTE_USER:d,SAMPLING_MECHANISM_REMOTE_DYNAMIC:h,SAMPLING_RULE_DECISION:g,SAMPLING_LIMIT_DECISION:E,SAMPLING_AGENT_DECISION:f,DECISION_MAKER_KEY:T}=r(3636),{tags:{MANUAL_KEEP:m,MANUAL_DROP:S,SAMPLING_PRIORITY:I,SERVICE_NAME:R},priority:{AUTO_REJECT:A,AUTO_KEEP:y,USER_REJECT:b,USER_KEEP:O}}=r(3973),v="service:,env:",C=new i(y);e.exports=class{constructor(e,t){this.configure(e,t),this.update({})}configure(e,t={}){const{sampleRate:r,provenance:i,rateLimit:o=100,rules:c=[]}=t;this._env=e,this._rules=this._normalizeRules(c,r,o,i),this._limiter=new n(o),s.trace(e,t),a(this._rules)}isSampled(e){const t=this._getPriorityFromAuto(e);return s.trace(e),t===O||t===y}sample(e,t=!0){if(!e)return;const r=this._getContext(e),n=r._trace.started[0];if(void 0!==r._sampling.priority)return;if(!n)return;s.trace(e,t);const i=this._getPriorityFromTags(r._tags,r);if(this.validate(i))r._sampling.priority=i,r._sampling.mechanism=p;else{if(!t)return;r._sampling.priority=this._getPriorityFromAuto(n)}this._addDecisionMaker(n)}update(e){const t={};for(const r in e){const s=e[r],n=new i(s);t[r]=n}t[v]=t[v]||C,this._samplers=t,s.trace(e)}validate(e){switch(e){case b:case O:case A:case y:return!0;default:return!1}}setPriority(e,t,r=p){if(!e||!this.validate(t))return;const n=this._getContext(e),i=n._trace.started[0];i?(n._sampling.priority=t,n._sampling.mechanism=r,s.trace(e,t,r),this._addDecisionMaker(i)):s.error("Skipping the setPriority on noop span")}_getContext(e){return"function"==typeof e.context?e.context():e}_getPriorityFromAuto(e){const t=this._getContext(e),r=this._findRule(e);return r?this._getPriorityByRule(t,r):this._getPriorityByAgent(t)}_getPriorityFromTags(e){if(c(e,m)&&!1!==e[m])return O;if(c(e,S)&&!1!==e[S])return b;{const t=parseInt(e[I],10);if(1===t||2===t)return O;if(0===t||-1===t)return b}}_getPriorityByRule(e,t){return e._trace[g]=t.sampleRate,e._sampling.mechanism=l,"customer"===t.provenance&&(e._sampling.mechanism=d),"dynamic"===t.provenance&&(e._sampling.mechanism=h),t.sample()&&this._isSampledByRateLimit(e)?O:b}_isSampledByRateLimit(e){const t=this._limiter.isAllowed();return e._trace[E]=this._limiter.effectiveRate(),t}_getPriorityByAgent(e){const t=`service:${e._tags[R]},env:${this._env}`,r=this._samplers[t]||this._samplers[v];return e._trace[f]=r.rate(),e._sampling.mechanism=r===C?_:u,r.isSampled(e)?y:A}_addDecisionMaker(e){const t=e.context(),r=t._trace,s=t._sampling.priority,n=t._sampling.mechanism;s>=y?r.tags[T]||(r.tags[T]=`-${n}`):delete r.tags[T]}_normalizeRules(e,t,r,s){return(e=[].concat(e||[])).concat({sampleRate:t,maxPerSecond:r,provenance:s}).map((e=>({...e,sampleRate:parseFloat(e.sampleRate)}))).filter((e=>!isNaN(e.sampleRate))).map(o.from)}_findRule(e){for(const t of this._rules)if(t.match(e))return t}static keepTrace(e,t){e?._prioritySampler?.setPriority(e,O,t)}}},4741:(e,t,r)=>{"use strict";const s=r(8698),n=r(9168),i=r(447),a=r(5004),o=r(589);e.exports=class extends s{constructor(){super(),this._initialized=!1,this.dogstatsd=new o,this._tracingInitialized=!1,this._modules={}}init(e){if(this._initialized)return this;this._initialized=!0;try{const t=new i(e);(t.isGCPFunction||t.isAzureFunction)&&r(3283).maybeStartServerlessMiniAgent(t),this._enableOrDisableTracing(t)}catch(e){a.error("Error initialising tracer",e)}return this}_enableOrDisableTracing(e){!1!==e.tracing?(e.appsec.enabled&&this._modules.appsec.enable(e),e.llmobs.enabled&&this._modules.llmobs.enable(e),this._tracingInitialized||(this._tracer=new n(e),this.dataStreamsCheckpointer=this._tracer.dataStreamsCheckpointer,this._tracingInitialized=!0),e.iast.enabled&&this._modules.iast.enable(e,this._tracer)):this._tracingInitialized&&(this._modules.appsec.disable(),this._modules.iast.disable(),this._modules.llmobs.disable()),this._tracingInitialized&&(this._tracer.configure(e),this._pluginManager.configure(e))}profilerStarted(){if(!this._profilerStarted)throw new Error("profilerStarted() must be called after init()");return this._profilerStarted}use(){return this._pluginManager.configurePlugin(...arguments),this}}},6748:(e,t,r)=>{"use strict";const s=r(9439);e.exports=class{constructor(e,t="second"){this._rateLimit=parseInt(e),this._limiter=new s.RateLimiter(this._rateLimit,t),this._tokensRequested=0,this._prevIntervalTokens=0,this._prevTokensRequested=0}isAllowed(){const e=this._limiter.curIntervalStart,t=this._limiter.tokensThisInterval,r=this._isAllowed();return e!==this._limiter.curIntervalStart?(this._prevIntervalTokens=t,this._prevTokensRequested=this._tokensRequested,this._tokensRequested=1):this._tokensRequested++,r}effectiveRate(){return this._rateLimit<0?1:0===this._rateLimit?0:0===this._tokensRequested?1:(this._prevIntervalTokens+this._limiter.tokensThisInterval)/(this._prevTokensRequested+this._tokensRequested)}_isAllowed(){return this._rateLimit<0||0!==this._rateLimit&&this._limiter.tryRemoveTokens(1)}_currentWindowRate(){return this._rateLimit<0?1:0===this._rateLimit?0:0===this._tokensRequested?1:this._limiter.tokensThisInterval/this._tokensRequested}}},8114:(e,t,r)=>{"use strict";const s=r(6928),n=r(9896);e.exports=function(e,t){if(s.isAbsolute(e)){const t=s.join(e,"package.json");return JSON.parse(n.readFileSync(t,"utf8"))}for(const r of t.paths){const t=s.join(r,e,"package.json");try{return JSON.parse(n.readFileSync(t,"utf8"))}catch(e){continue}}throw new Error(`could not find ${e}/package.json`)}},1810:e=>{"use strict";e.exports=class{constructor(e){this._rate=e}rate(){return this._rate}isSampled(){return 1===this._rate||Math.random()<this._rate}}},7913:(e,t,r)=>{"use strict";const{globMatch:s}=r(9421),n=r(6748),i=r(1810);class a{match(){return!0}}class o{constructor(e,t){this.pattern=e,this.locator=t}match(e){const t=this.locator(e);return!!t&&s(this.pattern,t)}}class c{constructor(e,t){this.pattern=e,this.locator=t}match(e){const t=this.locator(e);return!!t&&this.pattern.test(t)}}function _(e,t){return e instanceof RegExp?new c(e,t):"string"==typeof e&&"*"!==e?new o(e,t):new a}function u(e){return t=>t.context()._tags[e]}function l(e){return e.context()._name}function p(e){const{_tags:t}=e.context();return t.service||t["service.name"]||e.tracer()._service}class d{constructor({name:e,service:t,resource:r,tags:s,sampleRate:a=1,provenance:o,maxPerSecond:c}={}){this.matchers=[],e&&this.matchers.push(_(e,l)),t&&this.matchers.push(_(t,p)),r&&this.matchers.push(_(r,u("resource.name")));for(const[e,t]of Object.entries(s||{}))this.matchers.push(_(t,u(e)));this._sampler=new i(a),this._limiter=void 0,this.provenance=o,Number.isFinite(c)&&(this._limiter=new n(c))}static from(e){return new d(e)}get sampleRate(){return this._sampler.rate()}get effectiveRate(){return this._limiter&&this._limiter.effectiveRate()}get maxPerSecond(){return this._limiter&&this._limiter._rateLimit}match(e){for(const t of this.matchers)if(!t.match(e))return!1;return!0}sample(){return!!this._sampler.isSampled()&&(!this._limiter||this._limiter.isAllowed())}}e.exports=d},1997:(e,t,r)=>{"use strict";const{storage:s}=r(6882),n=new WeakMap;e.exports=class{active(){const e=s.getStore();return e&&e.span||null}activate(e,t){if("function"!=typeof t)return t;const r=s.getStore(),n=e?s.getStore(e._store):r;s.enterWith({...n,span:e});try{return t()}catch(t){throw e&&"function"==typeof e.setTag&&e.setTag("error",t),t}finally{s.enterWith(r)}}bind(e,t){if("function"!=typeof e)return e;const r=this,s=this._spanOrActive(t),i=function(){return r.activate(s,(()=>e.apply(this,arguments)))};return n.set(i,e),i}_spanOrActive(e){return void 0!==e?e:this.active()}_isPromise(e){return e&&"function"==typeof e.then}}},3283:(e,t,r)=>{"use strict";const s=r(5004);function n(e){return void 0!==process.env.DD_MINI_AGENT_PATH?process.env.DD_MINI_AGENT_PATH:`${e.isGCPFunction?"/workspace":"/home/site/wwwroot"}/node_modules/@datadog/sma/${"win32"===process.platform?"datadog-serverless-agent-windows-amd64":"datadog-serverless-agent-linux-amd64"}/datadog-serverless-trace-mini-agent${"win32"===process.platform?".exe":""}`}e.exports={maybeStartServerlessMiniAgent:function(e){if("win32"!==process.platform&&"linux"!==process.platform)return void s.error("Serverless Mini Agent is only supported on Windows and Linux.");const t=n(e),i=r(9896);if(s.debug(`Trying to spawn the Serverless Mini Agent at path: ${t}`),i.existsSync(t))try{r(5317).spawn(t,{stdio:"inherit"})}catch(e){s.error("Error spawning mini agent process: %s",e.message)}else s.error("Serverless Mini Agent did not start. Could not find mini agent binary.")},getIsGCPFunction:function(){const e=void 0!==process.env.FUNCTION_NAME&&void 0!==process.env.GCP_PROJECT,t=void 0!==process.env.K_SERVICE&&void 0!==process.env.FUNCTION_TARGET;return e||t},getIsAzureFunction:function(){return void 0!==process.env.FUNCTIONS_EXTENSION_VERSION&&void 0!==process.env.FUNCTIONS_WORKER_RUNTIME},getRustBinaryPath:n}},7583:e=>{"use strict";const t=new Set;e.exports={registerExtraService:function(e){e&&t.size<64&&t.add(e)},getExtraServices:function(){return[...t]},clear:function(){t.clear()}}},5214:(e,t,r)=>{"use strict";const s=r(5004),n=r(9446),i=r(1058),a=r(3014),o=new WeakSet,c=new WeakSet,{channel:_}=r(1247),u=_("dd-trace:span:process");e.exports=class{constructor(e,t,r){this._exporter=e,this._prioritySampler=t,this._config=r,this._killAll=!1,this._spanSampler=new i(r.sampler),this._gitMetadataTagger=new a(r)}process(e){const t=e.context(),r=[],s=[],i=t._trace,{flushMinSpans:a,tracing:o}=this._config,{started:c,finished:_}=i;if(!1!==i.record)if(!1!==o){if(c.length===_.length||_.length>=a){this._prioritySampler.sample(t),this._spanSampler.sample(t),this._gitMetadataTagger.tagGitMetadata(t);for(const e of c)if(void 0!==e._duration){const t=n(e);this._stats.onSpanFinished(t),s.push(t),u.publish({span:e})}else r.push(e);0!==s.length&&!1!==i.isRecording&&this._exporter.export(s),this._erase(i,r)}if(this._killAll)for(const e of c)e._finished||e.finish()}else this._erase(i,r)}killAll(){this._killAll=!0}_erase(e,t){if("true"===process.env.DD_TRACE_EXPERIMENTAL_STATE_TRACKING){const t=new Set,r=new Set,n=new Set,i=new Set;for(const t of e.finished){const r=t.context(),a=r.toSpanId();n.has(t)?s.error("Span was already finished in the same trace: %s",t):(n.add(t),i.has(a)?s.error("Another span with the same ID was already finished in the same trace: %s",t):i.add(a),r._trace!==e&&s.error("A span was finished in the wrong trace: %s",t),c.has(t)?s.error("Span was already finished in a different trace: %s",t):c.add(t))}for(const i of e.started){const a=i.context(),c=a.toSpanId();t.has(i)?s.error("Span was already started in the same trace: %s",i):(t.add(i),r.has(c)?s.error("Another span with the same ID was already started in the same trace: %s",i):r.add(c),a._trace!==e&&s.error("A span was started in the wrong trace: %s",i),o.has(i)?s.error("Span was already started in a different trace: %s",i):o.add(i)),n.has(i)||s.error("Span started in one trace but was finished in another trace: %s",i)}for(const r of e.finished)t.has(r)||s.error("Span finished in one trace but was started in another trace: %s",r)}for(const t of e.finished)t.context()._tags={};e.started=t,e.finished=[]}}},1058:(e,t,r)=>{"use strict";const{USER_KEEP:s,AUTO_KEEP:n}=r(3973).priority,i=r(7913);e.exports=class{constructor({spanSamplingRules:e=[]}={}){this._rules=e.map(i.from)}findRule(e){for(const t of this._rules)if(t.match(e))return t}sample(e){const t=e._sampling.priority;if(t===s||t===n)return;const{started:r}=e._trace;for(const e of r){const t=this.findRule(e);t&&t.sample()&&(e.context()._spanSampling={sampleRate:t.sampleRate,maxPerSecond:t.maxPerSecond})}}}},2471:(e,t,r)=>{"use strict";const{info:s,warn:n}=r(7513),i=r(857),{inspect:a}=r(9023),o=r(8330).version,c={};let _,u,l=[],p=!1;function d(){const e=_.url||`http://${_.hostname||"localhost"}:${_.port}`,t={[a.custom](){return String(this)},toString(){return JSON.stringify(this)}};return t.date=(new Date).toISOString(),t.os_name=i.type(),t.os_version=i.release(),t.architecture=i.arch(),t.version=o,t.lang="nodejs",t.lang_version=process.versions.node,t.env=_.env,t.enabled=_.enabled,t.service=_.service,t.agent_url=e,t.debug=!!_.debug,t.sample_rate=_.sampler.sampleRate,t.sampling_rules=l,t.tags=_.tags,_.tags&&_.tags.version&&(t.dd_version=_.tags.version),t.log_injection_enabled=!!_.logInjection,t.runtime_metrics_enabled=!!_.runtimeMetrics,t.profiling_enabled=!!(_.profiling||{}).enabled,Object.assign(t,function(){const e=new Set,t={};for(const t in u._pluginsByName)e.add(t);return t.integrations_loaded=Array.from(e),t}()),t.appsec_enabled=!!_.appsec.enabled,t}e.exports={startupLog:function({agentError:e}={}){if(!_||!u)return;if(p)return;if(p=!0,!_.startupLogs)return;const t=d();e&&(t.agent_error=e.message),s("DATADOG TRACER CONFIGURATION - "+t),e&&(n("DATADOG TRACER DIAGNOSTIC - Agent Error: "+e.message),c.agentError={code:e.code?e.code:"",message:`Agent Error:${e.message}`})},setStartupLogConfig:function(e){_=e},setStartupLogPluginManager:function(e){u=e},setSamplingRules:function(e){l=e},tracerInfo:d,errors:c}},5487:(e,t,r)=>{"use strict";const s=r(3636),n=r(5004),i=s.ERROR_MESSAGE,a=s.ERROR_STACK,o=s.ERROR_TYPE,c={"deployment.environment":"env","service.name":"service","service.version":"version"};e.exports={add:function e(t,r,s=!1){if(t&&r){if(Array.isArray(r))return r.forEach((r=>e(t,r)));try{if("string"==typeof r){const e=r.split(",");for(const r of e){const e=s?r.indexOf("="):r.indexOf(":");if(-1===e)continue;let n=r.slice(0,e);const i=r.slice(e+1);s&&n in c&&(n=c[n]),t[n.trim()]=i.trim()}}else(i in r||a in r||o in r)&&("doNotSetTraceError"in r||(t.setTraceError=!0)),Object.assign(t,r)}catch(e){n.error("Error adding tags",e)}}}}},6248:(e,t,r)=>{"use strict";e=r.nmd(e);const s=r(6928),n=r(5335),i=r(8114),{sendData:a}=r(7480),o=r(1247),{fileURLToPath:c}=r(7016),{isTrue:_}=r(9421),u=new Set,l=new Set,p=new Set,d=o.channel("dd-trace:moduleLoadStart");let h,g,E,f,T,m,S,I=!0;function R(e,t,r){h||(h=setImmediate((()=>{if(h=null,u.size>0){const s=Array.from(u.values()).filter((t=>{const r=_(t.split(" ")[2])||e.telemetry?.dependencyCollection;return r||u.delete(t),r})).splice(0,2e3).map((e=>{u.delete(e);const[t,r]=e.split(" ");return{name:t,version:r}}));let n;const i=m();if(i)n={reqType:"app-dependencies-loaded",payload:{dependencies:s}};else{if(!s.length)return;n={dependencies:s}}const o=i?function(e){return e.map((e=>({request_type:e.reqType,payload:e.payload})))}([n,i]):n;a(e,t,r,i?"message-batch":"app-dependencies-loaded",o,S),u.size>0&&R(e,t,r)}})),h.unref())}function A(t){if(I&&(I=!1,r.c&&Object.keys(r.c).forEach((e=>{A({filename:e})}))),t){let r=t.filename;if(r&&r.startsWith("file://"))try{r=c(r)}catch(e){}const a=r&&n(r),o=t.request||a&&a.name,_=a&&a.basedir?a.basedir:o;if(r&&o&&function(e,t){const r=y(0,t,"/");return r&&"win32"===process.platform?y(0,t,s.sep):r}(0,o)&&!l.has(_)&&(l.add(_),a)){const{name:t,basedir:r}=a;if(r)try{const{version:s}=i(r,e),n=`${t} ${s}`;p.has(n)||(u.add(`${n} ${T}`),p.add(n),R(g,E,f))}catch(e){}}}}function y(e,t,r){return 0!==t.indexOf(`..${r}`)&&0!==t.indexOf(`.${r}`)&&0!==t.indexOf(r)&&1!==t.indexOf(`:${r}`)}e.exports={start:function(e={},t,r,s,n){g=e,E=t,f=r,T=!0,m=s,S=n,d.subscribe(A),queueMicrotask((()=>{T=!1}))},stop:function(){g=null,E=null,f=null,l.clear(),u.clear(),p.clear(),d.hasSubscribers&&d.unsubscribe(A)}}},6218:(e,t,r)=>{"use strict";const s=r(8330).version,n=r(1247),i=r(857),a=r(6248),{sendData:o}=r(7480),{errors:c}=r(2471),{manager:_}=r(5608),u=r(5045),l=r(5004),p=n.channel("datadog:telemetry:start"),d=n.channel("datadog:telemetry:stop"),h=n.channel("datadog:telemetry:app-closing");let g,E,f,T,m,S,I,R,A=[],y=null;const b={},O=new Set;function v(){return y}function C(e,t){if(e)if("message-batch"===t.reqType){const e=t.payload[0].payload,r=t.payload[0].request_type;y={payload:e,reqType:r};const s=t.payload[1].payload,n=t.payload[1].request_type;"app-integrations-change"===n&&(b.integrations?b.integrations.push(s):b.integrations=[s]),"app-dependencies-loaded"===n&&(b.dependencies?b.dependencies.push(s):b.dependencies=[s])}else y=t;else y=null}function P(){const e=[];for(const t in E._pluginsByName)O.has(t)||(e.push({name:t,enabled:E._pluginsByName[t]._enabled,auto_enabled:!0}),O.add(t));return e}function D(e){const t={appsec:{enabled:e.appsec.enabled},profiler:{version:s,enabled:(r=e.profiling.enabled,"boolean"==typeof r?r:!!["auto","true"].includes(r)||"false"!==r&&void 0)}};var r;return c.profilingError&&(t.profiler.error=c.profilingError,c.profilingError={}),t}function L(e){const t={products:D(e),configuration:A},r=function(e){const{installSignature:t}=e;if(t&&(t.id||t.time||t.type))return{install_id:t.id,install_time:t.time,install_type:t.type}}(e);return r&&(t.install_signature=r),t}function N(){if(!g?.telemetry?.enabled)return;h.publish();const{reqType:e,payload:t}=B("app-closing");o(g,f,T,e,t),_.send(g,f,T),u.send(g,f,T)}function M(){process.removeListener("beforeExit",M),N()}function x(e){return{service_name:e.service,env:e.env,service_version:e.version,tracer_version:s,language_name:"nodejs",language_version:process.versions.node}}function U(){const e=i.type();return"Linux"===e||"Darwin"===e?{hostname:i.hostname(),os:e,architecture:i.arch(),kernel_version:i.version(),kernel_release:i.release(),kernel_name:e}:"Windows_NT"===e?{hostname:i.hostname(),os:e,architecture:i.arch(),os_version:i.version()}:{hostname:i.hostname(),os:e}}function w(){return{config:g,application:f,host:T,heartbeatInterval:S}}function B(e,t={}){if(v()){return{reqType:"message-batch",payload:[{reqType:e,payload:t},y].map((e=>({request_type:e.reqType,payload:e.payload})))}}return{reqType:e,payload:t}}function k(e,t,r){return m=setTimeout((()=>{_.send(e,t,r),u.send(e,t,r);const{reqType:s,payload:n}=B("app-heartbeat");o(e,t,r,s,n,C),k(e,t,r)}),S).unref(),m}e.exports={start:function(e,t){e.telemetry.enabled?(g=e,E=t,f=x(g),T=U(),S=g.telemetry.heartbeatInterval,R=P(),a.start(g,f,T,v,C),u.start(g),o(g,f,T,"app-started",L(g)),R.length>0&&o(g,f,T,"app-integrations-change",{integrations:R},C),k(g,f,T),function(e){I=setInterval((()=>{const t={...L(e),...b};o(e,f,T,"app-extended-heartbeat",t),Object.keys(b).forEach((e=>delete b[e]))}),864e5).unref()}(g),process.on("beforeExit",M),p.publish(w())):e.sca?.enabled&&l.warn("DD_APPSEC_SCA_ENABLED requires enabling telemetry to work.")},stop:function(){g&&(clearInterval(I),clearTimeout(m),process.removeListener("beforeExit",M),d.publish(w()),g=void 0)},updateIntegrations:function(){if(!g||!g.telemetry.enabled)return;const e=P();if(0===e.length)return;const{reqType:t,payload:r}=B("app-integrations-change",{integrations:e});o(g,f,T,t,r,C)},updateConfig:function(e,t){if(!t.telemetry.enabled)return;if(0===e.length)return;l.trace(e);const r=x(t),s=U(),n={sampleRate:"DD_TRACE_SAMPLE_RATE",logInjection:"DD_LOG_INJECTION",headerTags:"DD_TRACE_HEADER_TAGS",tags:"DD_TAGS","sampler.rules":"DD_TRACE_SAMPLING_RULES",traceEnabled:"DD_TRACE_ENABLED",url:"DD_TRACE_AGENT_URL","sampler.rateLimit":"DD_TRACE_RATE_LIMIT",queryStringObfuscation:"DD_TRACE_OBFUSCATION_QUERY_STRING_REGEXP",version:"DD_VERSION",env:"DD_ENV",service:"DD_SERVICE",clientIpHeader:"DD_TRACE_CLIENT_IP_HEADER","grpc.client.error.statuses":"DD_GRPC_CLIENT_ERROR_STATUSES","grpc.server.error.statuses":"DD_GRPC_SERVER_ERROR_STATUSES"},i=new Set(["DD_TAGS","peerServiceMapping","serviceMapping"]),a=[],c=[];for(const t of e){const e=n[t.name]||t.name;c.push(e);const{origin:r,value:s}=t,o={name:e,value:s,origin:r};i.has(o.name)?o.value=(_=o.value)?Object.entries(_).map((([e,t])=>`${e}:${t}`)).join(","):"":"url"===o.name?o.value&&(o.value=o.value.toString()):"DD_TRACE_SAMPLING_RULES"===o.name?o.value=JSON.stringify(o.value):Array.isArray(o.value)&&(o.value=s.join(",")),a.push(o)}var _;if(A.length){A=A.filter((function(e){return!c.includes(e.name)})),A=A.concat(a);const{reqType:e,payload:n}=B("app-client-configuration-change",{configuration:a});o(t,r,s,e,n,C)}else A=a},appClosing:N}},5045:(e,t,r)=>{"use strict";const s=r(1247),n=r(5633),{sendData:i}=r(7480),a=s.channel("datadog:telemetry:log"),o=s.channel("datadog:log:error");let c=!1;function _(e){var t;t=e?.level?.toUpperCase(),function(e){switch(e){case"ERROR":case"WARN":return!0;default:return!1}}(t)&&n.add(e)}function u(e){const{message:t,cause:r}=e;if(!t&&!r)return;const s={level:"ERROR",count:1,message:t??"Generic Error"};r&&(s.stack_trace=r.stack,s.errorType=r.constructor.name),_(s)}e.exports={start:function(e){e.telemetry.logCollection&&!c&&(c=!0,a.subscribe(_),o.subscribe(u))},stop:function(){c=!1,a.hasSubscribers&&a.unsubscribe(_),o.unsubscribe(u)},send:function(e,t,r){if(!c)return;const s=n.drain();s&&i(e,t,r,"logs",{logs:s})}}},5633:(e,t,r)=>{"use strict";const s=r(5004),{calculateDDBasePath:n}=r(9421),i=new Map;let a=1e4,o=0;function c(e){let t=0;const r=e.length;for(let s=0;s<r;s++)t=(31*t|0)+e.charCodeAt(s)|0;return t}function _(e){let t=e.level?c(e.level):0;return t=(31*t|0)+(e.message?c(e.message):0)|0,t=(31*t|0)+(e.stack_trace?c(e.stack_trace):0)|0,t}const u=n(__dirname),l=/^\s*at\s/gm,p={add(e){try{if(!function(e){return e?.level&&e.message}(e))return!1;if(i.size>=a)return o++,!1;if(!(e=function(e){const t=e.stack_trace;if(!t)return e;let r=t.split("\n");const s=r.findIndex((e=>e.match(l))),n=s>-1&&r[s].includes(u);return r=r.filter(((e,t)=>n&&t<s||e.includes(u))).map((e=>e.replace(u,""))),!n&&e.errorType&&r.length&&(r=[`${e.errorType}: redacted`,...r]),delete e.errorType,e.stack_trace=r.join("\n"),""!==e.stack_trace||e.message&&"Generic Error"!==e.message?e:null}(e)))return!1;const t=_(e);if(!i.has(t))return i.set(t,e),!0;i.get(t).count++}catch(e){s.error("Unable to add log to logCollector: %s",e.message)}return!1},hasEntry:e=>i.has(_(e)),drain(){if(0===i.size)return;const e=[...i.values()];return o>0&&e.push({message:`Omitted ${o} entries due to overflowing`,level:"ERROR"}),this.reset(),e},reset(e){i.clear(),o=0,e&&(a=e)}};p.reset(),e.exports=p},5608:(e,t,r)=>{"use strict";const{sendData:s}=r(7480);function n(e={}){if(Array.isArray(e))return e;const t=[];for(const[r,s]of Object.entries(e))t.push(`${r}:${s}`.toLowerCase());return t}function i(){return Date.now()/1e3}function a(e){return Array.from(e.values()).map((e=>e.toJSON()))}function o(e){return e.points.length>0}let c;class _{constructor(e,t,r,s){this.namespace=e.toString(),this.metric=r?t:`nodejs.${t}`,this.tags=n(s),r&&(void 0===c&&(c=`version:${process.version}`),this.tags.push(c)),this.common=r,this.points=[]}toString(){const{namespace:e,metric:t}=this;return`${e}.${t}`}reset(){this.points=[]}track(){throw new Error("not implemented")}toJSON(){const{metric:e,points:t,interval:r,type:s,tags:n,common:i}=this;return{metric:e,points:t,interval:r,type:s,tags:n,common:i}}}class u extends _{get type(){return"count"}inc(e){return this.track(e)}dec(e=1){return this.track(-e)}track(e=1){this.points.length?this.points[0][1]+=e:this.points.push([i(),e])}}class l extends _{get type(){return"distribution"}track(e=1){this.points.push(e)}toJSON(){const{metric:e,points:t,tags:r,common:s}=this;return{metric:e,points:t,common:s,tags:r}}}class p extends _{get type(){return"gauge"}mark(e){return this.track(e)}track(e=1){this.points.push([i(),e])}}class d extends _{constructor(e,t,r,s,n){super(e,t,r,s),this.interval=n,this.rate=0}get type(){return"rate"}reset(){super.reset(),this.rate=0}track(e=1){this.rate+=e;const t=this.interval?this.rate/this.interval:0;this.points=[[i(),t]]}}const h={count:u,distribution:l,gauge:p,rate:d};class g extends Map{constructor(e){super(),this.namespace=e}reset(){for(const e of this.values())e.reset()}toString(){return this.namespace}toJSON(){if(!this.size)return;const e=a(this).filter(o);if(!e.length)return;const{namespace:t}=this;return{namespace:t,series:e}}}function E(e,t,r,s,i){const a=function(e,t,r,s){return`${e}:${t}.${r}:${n(s).sort().join(",")}`}(t,e,r,s);let o=e.get(a);if(o)return o;const c=h[t];if(!c)throw new Error(`Unknown metric type ${t}`);return o=new c(e,r,!0,s,i),e.set(a,o),o}class f{constructor(e){this.distributions=new g(e),this.metrics=new g(e)}reset(){this.metrics.reset(),this.distributions.reset()}count(e,t){return E(this.metrics,"count",e,t)}gauge(e,t){return E(this.metrics,"gauge",e,t)}rate(e,t,r){return E(this.metrics,"rate",e,r,t)}distribution(e,t){return E(this.distributions,"distribution",e,t)}toJSON(){const{distributions:e,metrics:t}=this;return{distributions:e.toJSON(),metrics:t.toJSON()}}}class T extends Map{namespace(e){let t=this.get(e);return t||(t=new f(e),this.set(e,t),t)}toJSON(){return a(this)}send(e,t,r){for(const n of this.values()){const{metrics:i,distributions:a}=n.toJSON();i&&s(e,t,r,"generate-metrics",i),a&&s(e,t,r,"distributions",a),n.reset()}}}const m=new T;e.exports={CountMetric:u,DistributionMetric:l,GaugeMetric:p,RateMetric:d,MetricsCollection:g,Namespace:f,NamespaceManager:T,manager:m}},7480:(e,t,r)=>{const s=r(7209),n=r(5004),{isTrue:i}=r(9421);let a=!0;function o(e,t,r){const s={"content-type":"application/json","dd-telemetry-api-version":"v2","dd-telemetry-request-type":r,"dd-client-library-language":t.language_name,"dd-client-library-version":t.tracer_version};return e.telemetry&&e.telemetry.debug&&(s["dd-telemetry-debug-enabled"]="true"),e.apiKey&&(s["dd-api-key"]=e.apiKey),s}function c(e){return"datad0g.com"===e?"https://all-http-intake.logs.datad0g.com":`https://instrumentation-telemetry-intake.${e}`}let _=0;function u(e){if(Array.isArray(e))return e;{const{logger:t,tags:r,serviceMapping:s,...n}=e;return n}}e.exports={sendData:function(e,t,r,l,p={},d=()=>{}){const{hostname:h,port:g,isCiVisibility:E}=e;let f=e.url;const T=E&&i(process.env.DD_CIVISIBILITY_AGENTLESS_ENABLED);if(T)try{f=f||new URL(c(e.site))}catch(e){return n.error("Telemetry endpoint url is invalid",e),d(e,{payload:p,reqType:l})}const m={url:f,hostname:h,port:g,method:"POST",path:T?"/api/v2/apmtelemetry":"/telemetry/proxy/api/v2/apmtelemetry",headers:o(e,t,l)},S=JSON.stringify({api_version:"v2",naming_schema_version:e.spanAttributeSchema?e.spanAttributeSchema:"",request_type:l,tracer_time:Math.floor(Date.now()/1e3),runtime_id:e.tags["runtime-id"],seq_id:++_,payload:u(p),application:t,host:r});s(S,m,(t=>{if(t&&process.env.DD_API_KEY&&e.site){a&&(n.warn("Agent telemetry failed, started agentless telemetry"),a=!1);const t=c(e.site),r={...m.headers,"DD-API-KEY":process.env.DD_API_KEY},i={...m,url:t,headers:r,path:"/api/v2/apmtelemetry"};t?s(S,i,(e=>{n.error("Error sending telemetry data",e)})):n.error("Invalid Telemetry URL")}t||a||(a=!0,n.info("Started agent telemetry")),d(t,{payload:p,reqType:l})}))}}},9168:(e,t,r)=>{"use strict";const s=r(6527),n=r(4100),i=r(1997),{storage:a}=r(6882),{isError:o}=r(9421),{setStartupLogConfig:c}=r(2471),{ERROR_MESSAGE:_,ERROR_TYPE:u,ERROR_STACK:l}=r(3636),{DD_MAJOR:p}=r(3837),d=n.SPAN_TYPE,h=n.RESOURCE_NAME,g=n.SERVICE_NAME,E=n.MEASURED;function f(e,t){o(t)&&e.addTags({[u]:t.name,[_]:t.message,[l]:t.stack})}e.exports=class extends s{constructor(e,t){super(e,t),this._scope=new i,c(e)}configure({env:e,sampler:t}){this._prioritySampler.configure(e,t)}trace(e,t,r){if(!(t=Object.assign({childOf:this.scope().active()},t)).childOf&&!1===t.orphanable&&p<4)return r(null,(()=>{}));const s=this.startSpan(e,t);!function(e,t){const r={};t.type&&(r[d]=t.type),t.service&&(r[g]=t.service),t.resource&&(r[h]=t.resource),r[E]=t.measured,e.addTags(r)}(s,t);try{if(r.length>1)return this.scope().activate(s,(()=>r(s,(e=>{f(s,e),s.finish()}))));const e=this.scope().activate(s,(()=>r(s)));return e&&"function"==typeof e.then?e.then((e=>(s.finish(),e)),(e=>{throw f(s,e),s.finish(),e})):(s.finish(),e)}catch(e){throw f(s,e),s.finish(),e}}wrap(e,t,r){const s=this;return function(){const n=a.getStore();if(n&&n.noop)return r.apply(this,arguments);let i=t;if("function"==typeof i&&"function"==typeof r&&(i=i.apply(this,arguments)),i&&!1===i.orphanable&&!s.scope().active()&&p<4)return r.apply(this,arguments);const o=arguments.length-1,c=arguments[o];if("function"==typeof c){const t=s.scope().bind(c);return s.trace(e,i,((e,s)=>(arguments[o]=function(e){return s(e),t.apply(this,arguments)},r.apply(this,arguments))))}return s.trace(e,i,(()=>r.apply(this,arguments)))}}setUrl(e){this._exporter.setUrl(e),this._dataStreamsProcessor.setUrl(e)}scope(){return this._scope}getRumData(){return this._enableGetRumData?`<meta name="dd-trace-id" content="${this.scope().active().context().toTraceId()}" /><meta name="dd-trace-time" content="${Date.now()}" />`:""}}},9421:(e,t,r)=>{"use strict";const s=r(6928);e.exports={isTrue:function(e){return"true"===(e=String(e).toLowerCase())||"1"===e},isFalse:function(e){return"false"===(e=String(e).toLowerCase())||"0"===e},isError:function(e){return e instanceof Error||!(!e||!e.message)},globMatch:function(e,t){"string"==typeof e&&(e=e.toLowerCase()),"string"==typeof t&&(t=t.toLowerCase());let r=0,s=0,n=0,i=0;for(;r<e.length||s<t.length;){if(r<e.length){const a=e[r];switch(a){case"?":if(s<t.length){r++,s++;continue}break;case"*":n=r,i=s+1,r++;continue;default:if(s<t.length&&t[s]===a){r++,s++;continue}}}if(!(i>0&&i<=t.length))return!1;r=n,s=i}return!0},calculateDDBasePath:function(e){const t=e.split(s.sep),r=t.lastIndexOf("packages");return t.slice(0,r+1).join(s.sep)+s.sep},hasOwn:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}},3837:(e,t,r)=>{"use strict";var s=r(8330).version.match(/^(\d+)\.(\d+)\.(\d+)/),n=process.versions.node.match(/^(\d+)\.(\d+)\.(\d+)/);e.exports={DD_MAJOR:parseInt(s[1]),DD_MINOR:parseInt(s[2]),DD_PATCH:parseInt(s[3]),NODE_MAJOR:parseInt(n[1]),NODE_MINOR:parseInt(n[2]),NODE_PATCH:parseInt(n[3])}},2613:e=>{"use strict";e.exports=require("assert")},290:e=>{"use strict";e.exports=require("async_hooks")},5317:e=>{"use strict";e.exports=require("child_process")},6982:e=>{"use strict";e.exports=require("crypto")},1637:e=>{"use strict";e.exports=require("diagnostics_channel")},9896:e=>{"use strict";e.exports=require("fs")},8611:e=>{"use strict";e.exports=require("http")},5692:e=>{"use strict";e.exports=require("https")},857:e=>{"use strict";e.exports=require("os")},6928:e=>{"use strict";e.exports=require("path")},2987:e=>{"use strict";e.exports=require("perf_hooks")},2203:e=>{"use strict";e.exports=require("stream")},7016:e=>{"use strict";e.exports=require("url")},9023:e=>{"use strict";e.exports=require("util")},3106:e=>{"use strict";e.exports=require("zlib")},8330:e=>{"use strict";e.exports=JSON.parse('{"name":"dd-trace","version":"6.0.0-pre","description":"Datadog APM tracing client for JavaScript","main":"dist/dd-trace.bundle.js","typings":"index.d.ts","scripts":{"env":"bash ./plugin-env","preinstall":"node scripts/preinstall.js","bench":"node benchmark","bench:e2e":"SERVICES=mongo yarn services && cd benchmark/e2e && node benchmark-run.js --duration=30","bench:e2e:ci-visibility":"node benchmark/e2e-ci/benchmark-run.js","type:doc":"cd docs && yarn && yarn build","type:test":"cd docs && yarn && yarn test","lint":"node scripts/check_licenses.js && eslint . && yarn audit","lint-fix":"node scripts/check_licenses.js && eslint . --fix && yarn audit","release:proposal":"node scripts/release/proposal","services":"node ./scripts/install_plugin_modules && node packages/dd-trace/test/setup/services","test":"SERVICES=* yarn services && mocha --expose-gc \'packages/dd-trace/test/setup/node.js\' \'packages/*/test/**/*.spec.js\'","test:appsec":"mocha -r \\"packages/dd-trace/test/setup/mocha.js\\" --exclude \\"packages/dd-trace/test/appsec/**/*.plugin.spec.js\\" \\"packages/dd-trace/test/appsec/**/*.spec.js\\"","test:appsec:ci":"nyc --no-clean --include \\"packages/dd-trace/src/appsec/**/*.js\\" --exclude \\"packages/dd-trace/test/appsec/**/*.plugin.spec.js\\" -- npm run test:appsec","test:appsec:plugins":"mocha -r \\"packages/dd-trace/test/setup/mocha.js\\" \\"packages/dd-trace/test/appsec/**/*.@($(echo $PLUGINS)).plugin.spec.js\\"","test:appsec:plugins:ci":"yarn services && nyc --no-clean --include \\"packages/dd-trace/src/appsec/**/*.js\\" -- npm run test:appsec:plugins","test:debugger":"mocha -r \'packages/dd-trace/test/setup/mocha.js\' \'packages/dd-trace/test/debugger/**/*.spec.js\'","test:debugger:ci":"nyc --no-clean --include \'packages/dd-trace/src/debugger/**/*.js\' -- npm run test:debugger","test:trace:core":"tap packages/dd-trace/test/*.spec.js \\"packages/dd-trace/test/{ci-visibility,datastreams,encode,exporters,opentelemetry,opentracing,plugins,service-naming,telemetry}/**/*.spec.js\\"","test:trace:core:ci":"npm run test:trace:core -- --coverage --nyc-arg=--include=\\"packages/dd-trace/src/**/*.js\\"","test:instrumentations":"mocha -r \'packages/dd-trace/test/setup/mocha.js\' \'packages/datadog-instrumentations/test/**/*.spec.js\'","test:instrumentations:ci":"nyc --no-clean --include \'packages/datadog-instrumentations/src/**/*.js\' -- npm run test:instrumentations","test:core":"tap \\"packages/datadog-core/test/**/*.spec.js\\"","test:core:ci":"npm run test:core -- --coverage --nyc-arg=--include=\\"packages/datadog-core/src/**/*.js\\"","test:lambda":"mocha -r \\"packages/dd-trace/test/setup/mocha.js\\" \\"packages/dd-trace/test/lambda/**/*.spec.js\\"","test:lambda:ci":"nyc --no-clean --include \\"packages/dd-trace/src/lambda/**/*.js\\" -- npm run test:lambda","test:llmobs:sdk":"mocha -r \\"packages/dd-trace/test/setup/mocha.js\\" --exclude \\"packages/dd-trace/test/llmobs/plugins/**/*.spec.js\\" \\"packages/dd-trace/test/llmobs/**/*.spec.js\\" ","test:llmobs:sdk:ci":"nyc --no-clean --include \\"packages/dd-trace/src/llmobs/**/*.js\\" -- npm run test:llmobs:sdk","test:llmobs:plugins":"mocha -r \\"packages/dd-trace/test/setup/mocha.js\\" \\"packages/dd-trace/test/llmobs/plugins/@($(echo $PLUGINS))/*.spec.js\\"","test:llmobs:plugins:ci":"yarn services && nyc --no-clean --include \\"packages/dd-trace/src/llmobs/**/*.js\\" -- npm run test:llmobs:plugins","test:plugins":"mocha -r \\"packages/dd-trace/test/setup/mocha.js\\" \\"packages/datadog-instrumentations/test/@($(echo $PLUGINS)).spec.js\\" \\"packages/datadog-plugin-@($(echo $PLUGINS))/test/**/*.spec.js\\"","test:plugins:ci":"yarn services && nyc --no-clean --include \\"packages/datadog-instrumentations/src/@($(echo $PLUGINS)).js\\" --include \\"packages/datadog-instrumentations/src/@($(echo $PLUGINS))/**/*.js\\" --include \\"packages/datadog-plugin-@($(echo $PLUGINS))/src/**/*.js\\" -- npm run test:plugins","test:plugins:upstream":"node ./packages/dd-trace/test/plugins/suite.js","test:profiler":"tap \\"packages/dd-trace/test/profiling/**/*.spec.js\\"","test:profiler:ci":"npm run test:profiler -- --coverage --nyc-arg=--include=\\"packages/dd-trace/src/profiling/**/*.js\\"","test:integration":"mocha --timeout 60000 -r \\"packages/dd-trace/test/setup/core.js\\" \\"integration-tests/*.spec.js\\"","test:integration:appsec":"mocha --timeout 60000 -r \\"packages/dd-trace/test/setup/core.js\\" \\"integration-tests/appsec/*.spec.js\\"","test:integration:cucumber":"mocha --timeout 60000 -r \\"packages/dd-trace/test/setup/core.js\\" \\"integration-tests/cucumber/*.spec.js\\"","test:integration:cypress":"mocha --timeout 60000 -r \\"packages/dd-trace/test/setup/core.js\\" \\"integration-tests/cypress/*.spec.js\\"","test:integration:debugger":"mocha --timeout 60000 -r \\"packages/dd-trace/test/setup/core.js\\" \\"integration-tests/debugger/*.spec.js\\"","test:integration:jest":"mocha --timeout 60000 -r \\"packages/dd-trace/test/setup/core.js\\" \\"integration-tests/jest/*.spec.js\\"","test:integration:mocha":"mocha --timeout 60000 -r \\"packages/dd-trace/test/setup/core.js\\" \\"integration-tests/mocha/*.spec.js\\"","test:integration:playwright":"mocha --timeout 60000 -r \\"packages/dd-trace/test/setup/core.js\\" \\"integration-tests/playwright/*.spec.js\\"","test:integration:selenium":"mocha --timeout 60000 -r \\"packages/dd-trace/test/setup/core.js\\" \\"integration-tests/selenium/*.spec.js\\"","test:integration:vitest":"mocha --timeout 60000 -r \\"packages/dd-trace/test/setup/core.js\\" \\"integration-tests/vitest/*.spec.js\\"","test:integration:profiler":"mocha --timeout 180000 -r \\"packages/dd-trace/test/setup/core.js\\" \\"integration-tests/profiler/*.spec.js\\"","test:integration:serverless":"mocha --timeout 60000 -r \\"packages/dd-trace/test/setup/core.js\\" \\"integration-tests/serverless/*.spec.js\\"","test:integration:plugins":"mocha -r \\"packages/dd-trace/test/setup/mocha.js\\" \\"packages/datadog-plugin-@($(echo $PLUGINS))/test/integration-test/**/*.spec.js\\"","test:unit:plugins":"mocha -r \\"packages/dd-trace/test/setup/mocha.js\\" \\"packages/datadog-instrumentations/test/@($(echo $PLUGINS)).spec.js\\" \\"packages/datadog-plugin-@($(echo $PLUGINS))/test/**/*.spec.js\\" --exclude \\"packages/datadog-plugin-@($(echo $PLUGINS))/test/integration-test/**/*.spec.js\\"","test:shimmer":"mocha \'packages/datadog-shimmer/test/**/*.spec.js\'","test:shimmer:ci":"nyc --no-clean --include \'packages/datadog-shimmer/src/**/*.js\' -- npm run test:shimmer"},"repository":{"type":"git","url":"git+https://github.com/DataDog/dd-trace-js.git"},"keywords":["datadog","trace","tracing","profile","profiler","profiling","opentracing","apm"],"author":"Datadog Inc. <info@datadoghq.com>","license":"(Apache-2.0 OR BSD-3-Clause)","bugs":{"url":"https://github.com/DataDog/dd-trace-js/issues"},"homepage":"https://github.com/DataDog/dd-trace-js#readme","engines":{"node":">=18"},"dependencies":{"@datadog/libdatadog":"^0.4.0","@datadog/native-appsec":"8.4.0","@datadog/native-iast-rewriter":"2.6.1","@datadog/native-iast-taint-tracking":"3.2.0","@datadog/native-metrics":"^3.1.0","@datadog/pprof":"5.5.1","@datadog/sketches-js":"^2.1.0","@isaacs/ttlcache":"^1.4.1","@opentelemetry/api":">=1.0.0 <1.9.0","@opentelemetry/core":"^1.14.0","crypto-randomuuid":"^1.0.0","dc-polyfill":"^0.1.4","ignore":"^5.2.4","import-in-the-middle":"1.11.2","istanbul-lib-coverage":"3.2.0","jest-docblock":"^29.7.0","koalas":"^1.0.2","limiter":"1.1.5","lodash.sortby":"^4.7.0","lru-cache":"^7.14.0","module-details-from-path":"^1.0.3","opentracing":">=0.12.1","path-to-regexp":"^0.1.12","pprof-format":"^2.1.0","protobufjs":"^7.2.5","retry":"^0.13.1","rfdc":"^1.3.1","semver":"^7.5.4","shell-quote":"^1.8.1","source-map":"^0.7.4","tlhunter-sorted-set":"^0.1.0","ttl-set":"^1.0.0"},"devDependencies":{"@apollo/server":"^4.11.0","@eslint/eslintrc":"^3.1.0","@eslint/js":"^9.11.1","@msgpack/msgpack":"^3.0.0-beta3","@stylistic/eslint-plugin-js":"^2.8.0","@types/node":"^16.0.0","autocannon":"^4.5.2","aws-sdk":"^2.1446.0","axios":"^1.7.4","benchmark":"^2.1.4","body-parser":"^1.20.3","chai":"^4.3.7","chalk":"^5.3.0","checksum":"^1.0.0","cli-table3":"^0.6.3","dotenv":"16.3.1","esbuild":"0.16.12","eslint":"^8.57.0","eslint-config-standard":"^17.1.0","eslint-plugin-import":"^2.29.1","eslint-plugin-mocha":"^10.4.3","eslint-plugin-n":"^16.6.2","eslint-plugin-promise":"^6.4.0","express":"^4.21.2","get-port":"^3.2.0","glob":"^7.1.6","globals":"^15.10.0","graphql":"0.13.2","jszip":"^3.5.0","knex":"^2.4.2","mkdirp":"^3.0.1","mocha":"^10","multer":"^1.4.5-lts.1","nock":"^11.3.3","nyc":"^15.1.0","proxyquire":"^1.8.0","rimraf":"^3.0.0","sinon":"^16.1.3","sinon-chai":"^3.7.0","tap":"^16.3.7","tiktoken":"^1.0.15","time-require":"^0.1.2","webpack":"^5.97.1","yaml":"^2.5.0"}}')},8123:e=>{"use strict";e.exports=JSON.parse('{"sns":{"request":["$.Attributes.KmsMasterKeyId","$.Attributes.PlatformCredential","$.Attributes.PlatformPrincipal","$.Attributes.Token","$.AWSAccountId","$.Endpoint","$.OneTimePassword","$.phoneNumber","$.PhoneNumber","$.Token"],"response":["$.Attributes.KmsMasterKeyId","$.Attributes.Token","$.Endpoints.*.Token","$.PhoneNumber","$.PlatformApplication.*.PlatformCredential","$.PlatformApplication.*.PlatformPrincipal","$.Subscriptions.*.Endpoint","$.PhoneNumbers[*].PhoneNumber","$.phoneNumbers[*]"],"expand":["$.MessageAttributes.*.StringValue"]},"eventbridge":{"request":["$.AuthParameters.OAuthParameters.OAuthHttpParameters.HeaderParameters[*].Value","$.AuthParameters.OAuthParameters.OAuthHttpParameters.QueryStringParameters[*].Value","$.AuthParameters.OAuthParameters.OAuthHttpParameters.BodyParameters[*].Value","$.AuthParameters.InvocationHttpParameters.HeaderParameters[*].Value","$.AuthParameters.InvocationHttpParameters.QueryStringParameters[*].Value","$.AuthParameters.InvocationHttpParameters.BodyParameters[*].Value","$.Targets[*].RedshiftDataParameters.Sql","$.Targets[*].RedshiftDataParameters.Sqls","$.Targets[*].AppSyncParameters.GraphQLOperation","$.AuthParameters.BasicAuthParameters.Password","$.AuthParameters.OAuthParameters.ClientParameters.ClientSecret","$.AuthParameters.ApiKeyAuthParameters.ApiKeyValue"],"response":["$.AuthParameters.OAuthParameters.OAuthHttpParameters.HeaderParameters[*].Value","$.AuthParameters.OAuthParameters.OAuthHttpParameters.QueryStringParameters[*].Value","$.AuthParameters.OAuthParameters.OAuthHttpParameters.BodyParameters[*].Value","$.AuthParameters.InvocationHttpParameters.HeaderParameters[*].Value","$.AuthParameters.InvocationHttpParameters.QueryStringParameters[*].Value","$.AuthParameters.InvocationHttpParameters.BodyParameters[*].Value","$.Targets[*].RedshiftDataParameters.Sql","$.Targets[*].RedshiftDataParameters.Sqls","$.Targets[*].AppSyncParameters.GraphQLOperation"],"expand":[]},"s3":{"request":["$.SSEKMSKeyId","$.SSEKMSEncryptionContext","$.ServerSideEncryptionConfiguration.Rules[*].ApplyServerSideEncryptionByDefault.KMSMasterKeyID","$.InventoryConfiguration.Destination.S3BucketDestination.Encryption.SSEKMS.KeyId","$.SSECustomerKey","$.CopySourceSSECustomerKey","$.RestoreRequest.OutputLocation.S3.Encryption.KMSKeyId"],"response":["$.SSEKMSKeyId","$.SSEKMSEncryptionContext","$.ServerSideEncryptionConfiguration.Rules[*].ApplyServerSideEncryptionByDefault.KMSMasterKeyID","$.InventoryConfiguration.Destination.S3BucketDestination.Encryption.SSEKMS.KeyId","$.Credentials.SecretAccessKey","$.Credentials.SessionToken","$.InventoryConfigurationList[*].Destination.S3BucketDestination.Encryption.SSEKMS.KeyId"],"expand":[]},"sqs":{"request":[],"response":[],"expand":[]},"kinesis":{"request":[],"response":[],"expand":[]}}')}},t={};function r(s){var n=t[s];if(void 0!==n)return n.exports;var i=t[s]={id:s,loaded:!1,exports:{}};return e[s](i,i.exports,r),i.loaded=!0,i.exports}return r.c=t,r.d=(e,t)=>{for(var s in t)r.o(t,s)&&!r.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),r(r.s=5237)})()));