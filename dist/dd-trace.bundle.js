/*! For license information please see dd-trace.bundle.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["dd-trace"]=t():e["dd-trace"]=t()}(global,(()=>(()=>{var __webpack_modules__={10775:e=>{"use strict";e.exports={LOG:"log",AGENT:"agent",DATADOG:"datadog",AGENT_PROXY:"agent_proxy",JEST_WORKER:"jest_worker",CUCUMBER_WORKER:"cucumber_worker",MOCHA_WORKER:"mocha_worker"}},59429:e=>{"use strict";e.exports={TEXT_MAP:"text_map",HTTP_HEADERS:"http_headers",BINARY:"binary",LOG:"log",TEXT_MAP_DSM:"text_map_dsm"}},13973:(e,t,r)=>{"use strict";const s=r(59429),n=r(79386),i=r(1013),o=r(74100),a=r(70780),c=r(10775);e.exports={formats:s,kinds:n,priority:i,tags:o,types:a,exporters:c}},79386:e=>{"use strict";e.exports={SERVER:"server",CLIENT:"client",PRODUCER:"producer",CONSUMER:"consumer",INTERNAL:"internal"}},1013:e=>{"use strict";e.exports={USER_REJECT:-1,AUTO_REJECT:0,AUTO_KEEP:1,USER_KEEP:2}},74100:e=>{"use strict";const t={SERVICE_NAME:"service.name",RESOURCE_NAME:"resource.name",SPAN_TYPE:"span.type",SPAN_KIND:"span.kind",SAMPLING_PRIORITY:"sampling.priority",ANALYTICS:"_dd1.sr.eausr",ERROR:"error",MANUAL_KEEP:"manual.keep",MANUAL_DROP:"manual.drop",MEASURED:"_dd.measured",BASE_SERVICE:"_dd.base_service",DD_PARENT_ID:"_dd.parent_id",HTTP_URL:"http.url",HTTP_METHOD:"http.method",HTTP_STATUS_CODE:"http.status_code",HTTP_ROUTE:"http.route",HTTP_REQUEST_HEADERS:"http.request.headers",HTTP_RESPONSE_HEADERS:"http.response.headers",HTTP_USERAGENT:"http.useragent",HTTP_CLIENT_IP:"http.client_ip",PATHWAY_HASH:"pathway.hash"};t.ANALYTICS_SAMPLE_RATE=t.ANALYTICS,e.exports=t},70780:e=>{"use strict";e.exports={HTTP:"http",SERVERLESS:"serverless",WEB:"web"}},35237:(e,t,r)=>{"use strict";e.exports=r(14508)},3971:(e,t,r)=>{"use strict";e.exports=r(65963)},65963:(e,t,r)=>{"use strict";const{existsSync:s,readdirSync:n}=r(79896),i=r(70857),o=r(16928),a=i.platform(),c=process.arch,u="linux"===a?s("/etc/alpine-release")?"musl":"glibc":"",l=process.versions.modules,p="function"==typeof r?require:r(88110);function d(e){const t=h(e);if(!t)throw new Error(`Could not find a ${e} binary for ${a}${u}-${c}.`);return p(t)}function h(e,t=!1){const r=__dirname,i=`${r}/build/Release/${t?e:`${e}.node`}`;if(s(i))return i;const p=function(e){try{const t=o.join(e,"prebuilds"),r=n(t);return r.find((e=>e===`${a}${u}-${c}`))||r.find((e=>e===`${a}-${c}`))}catch(e){return null}}(r);if(!p)return;const d=o.join(r,"prebuilds",p),h=function(e,t,r=!1){const s=n(e);return r?s.find((e=>e===t)):s.find((e=>e===`${t}-${l}.node`))||s.find((e=>e===`${t}-napi.node`))||s.find((e=>e===`${t}.node`))}(d,e,t);return h?o.join(d,h):void 0}e.exports={find:h,load:d,maybeLoad:function(e){try{return d(e)}catch(e){}}}},88110:e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=88110,e.exports=t},63690:(e,t,r)=>{"use strict";e.exports=r(68169)(__dirname)},34717:(e,t,r)=>{"use strict";const s=r(16928),n=r(79896),i=r(28936),{SourceMap:o}=r(61628),a=new Map,c=new i({max:1e3});function u(e,t){const r=e.trim().split("\n"),i=r[r.length-1];let a;if(0===i.indexOf("//# sourceMappingURL=data:application/json;base64,")){const e=i.substring(50);a=Buffer.from(e,"base64").toString("utf8")}else if(0===i.indexOf("//# sourceMappingURL=")){let e=i.substring(21);e&&(e=s.isAbsolute(e)?e:s.join(t,e),a=n.readFileSync(e).toString())}if(a)return new o(JSON.parse(a))}function l(e){const t=e.split(s.sep);return t.pop(),t.join(s.sep)}function p(e,t,r,n){try{if(e){const i=l(t),{originalSource:o,originalLine:a,originalColumn:c}=e.findEntry(r-1,n-1);return{path:s.join(i,o),line:a+1,column:c+1}}}catch(e){}return{path:t,line:r,column:n}}e.exports={getSourcePathAndLineFromSourceMaps:function(e,t,r=0){return p(a.get(e),e,t,r)},getOriginalPathAndLineFromSourceMap:function(e,t,r=0){if(e&&t){let s;try{if(s=c.get(e),void 0===s){if(n.existsSync(e)){const t=l(e);s=u(n.readFileSync(e).toString(),t)}c.set(e,s||null)}return p(s,e,t,r)}catch(t){void 0===s&&c.set(e,null)}}return{path:e,line:t,column:r}},cacheRewrittenSourceMap:function(e,t){if(t){const r=u(t,l(e));a.set(e,r)}},generateSourceMapFromFileContent:u}},61628:(e,t,r)=>{"use strict";const{ArrayPrototypePush:s,ArrayPrototypeSlice:n,ArrayPrototypeSort:i,ArrayIsArray:o,ObjectPrototypeHasOwnProperty:a,StringPrototypeCharAt:c}=r(1357);let u;class l{constructor(e){this._string=e,this._position=0}next(){return c(this._string,this._position++)}peek(){return c(this._string,this._position)}hasNext(){return this._position<this._string.length}}function p(e){return","===e||";"===e}function d(e){let t,r=0,s=0;do{t=u[e.next()],r+=(31&t)<<s,s+=5}while(32&t);const n=1&r;return r>>>=1,n?-r|1<<31:r}function h(e,t){const{0:r,1:s}=e,{0:n,1:i}=t;return r!==n?r-n:s-i}e.exports={SourceMap:class{constructor(e){if(this._mappings=[],this._sources={},this._sources={},!u){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";u={};for(let t=0;t<e.length;++t)u[e[t]]=t}this._payload=function(e){e={...e};for(const t in e)a(e,t)&&o(e[t])&&(e[t]=n(e[t]));return e}(e),this._parseMappingPayload()}_parseMappingPayload(){this._payload.sections?this._parseSections(this._payload.sections):this._parseMap(this._payload,0,0),i(this._mappings,h)}_parseSections(e){for(let t=0;t<e.length;++t){const r=e[t];this._parseMap(r.map,r.offset.line,r.offset.column)}}findEntry(e,t){let r=0,s=this._mappings.length;for(;s>1;){const n=s>>1,i=r+n,o=this._mappings[i];e<o[0]||e===o[0]&&t<o[1]?s=n:(r=i,s-=n)}const n=this._mappings[r];return!r&&n&&(e<n[0]||e===n[0]&&t<n[1])?{}:n?{generatedLine:n[0],generatedColumn:n[1],originalSource:n[2],originalLine:n[3],originalColumn:n[4],name:n[5]}:{}}_parseMap(e,t,r){let n=0,i=0,o=0,a=0;const c=[],u={};for(let t=0;t<e.sources.length;++t){const r=e.sources[t];u[r]=r,s(c,r),this._sources[r]=!0,e.sourcesContent&&e.sourcesContent[t]&&(this._sources[r]=e.sourcesContent[t])}const h=new l(e.mappings);let f=c[n];for(;;){if(","===h.peek())h.next();else{for(;";"===h.peek();)t+=1,r=0,h.next();if(!h.hasNext())break}if(r+=d(h),p(h.peek())){s(this._mappings,[t,r]);continue}const u=d(h);let l;u&&(n+=u,f=c[n]),i+=d(h),o+=d(h),p(h.peek())||(a+=d(h),l=e.names?e.names[a]:void 0),s(this._mappings,[t,r,f,i,o,l])}}}}},1357:e=>{"use strict";function t(e){return function(t,...r){return e.apply(t,r)}}const r={ArrayPrototypePush:t(Array.prototype.push),ArrayPrototypeSlice:t(Array.prototype.slice),ArrayPrototypeSort:t(Array.prototype.sort),ArrayIsArray:Array.isArray,ObjectPrototypeHasOwnProperty:t(Object.prototype.hasOwnProperty),StringPrototypeCharAt:t(String.prototype.charAt)};e.exports=r},83289:(e,t,r)=>{const{getSourcePathAndLineFromSourceMaps:s}=r(34717),n=Symbol("_ddiastPrepareStackTrace");class i{constructor(e){const{path:t,line:r,column:n}=s(e.getFileName(),e.getLineNumber(),e.getColumnNumber());this.source=t,this.lineNumber=r,this.columnNumber=n,this.callSite=e}getThis(){return this.callSite}getTypeName(){return this.callSite.getTypeName()}getFunction(){return this.callSite.getFunction()}getFunctionName(){return this.callSite.getFunctionName()}getMethodName(){return this.callSite.getMethodName()}getFileName(){return this.source}getScriptNameOrSourceURL(){return null}getLineNumber(){return this.lineNumber}getColumnNumber(){return this.columnNumber}getEvalOrigin(){return this.callSite.getEvalOrigin()}isToplevel(){return this.callSite.isToplevel()}isEval(){return this.callSite.isEval()}isNative(){return this.callSite.isNative()}isConstructor(){return this.callSite.isConstructor()}toString(){return this.callSite.toString()}toLocaleString(){return this.callSite.toLocaleString()}}e.exports={getPrepareStackTrace:function(e){if(e&&e[n])return e;const t=(t,r)=>{if(e){let s;try{s=r.map((e=>new i(e)))}catch(e){s=r}return e(t,s)}const n=t.stack.split("\n");let o=-1;for(let e=0;e<n.length;e++)if(n[e].match(/^\s*at/gm)){o=e;break}return n.map(((e,t)=>{if(t<o)return e;const n=r[t-=o];if(!n)return e;let i=n.getFileName(),a=n.getLineNumber(),c=n.getColumnNumber();if(n.isEval()){const t=n.getEvalOrigin(),r=/.*\(((?:.:[/\\]?)?[/\\].*):(\d*):(\d*)\)/g.exec(t);if(!r)return e;i=r[1],a=r[2],c=r[3]}const{path:u,line:l,column:p}=s(i,a,c);return u!==i||l!==a||p!==c?e.replace(`${i}:${a}:${c}`,`${u}:${l}:${p}`):e})).join("\n")};return Object.defineProperty(t,n,{value:!0}),t},kSymbolPrepareStackTrace:n}},72539:(e,t,r)=>{"use strict";const{getPrepareStackTrace:s,kSymbolPrepareStackTrace:n}=r(83289),{cacheRewrittenSourceMap:i,getOriginalPathAndLineFromSourceMap:o}=r(34717);class a{rewrite(e,t){return{content:e}}csiMethods(){return[]}}let c;class u{constructor(e){c?(this.nativeRewriter=new c(e),this.setLogger(e)):this.nativeRewriter=new a}rewrite(e,t){const r=this.nativeRewriter.rewrite(e,t);return"notmodified"===r?.metrics?.status&&(r.content=e),r}csiMethods(){return this.nativeRewriter.csiMethods()}setLogger(e){if(e&&(e.logger||e.logLevel)){this.logger=e.logger||console;const t=e.logLevel||"ERROR";try{this.nativeRewriter.setLogger(this.logger,t)}catch(e){this.logError(e)}}}logError(e){this.logger?.error?.(e)}}class l extends u{rewrite(e,t){const r=super.rewrite(e,t);try{const{metrics:e,content:s}=r;"modified"===e?.status&&i(t,s)}catch(e){this.logError(e)}return r}}function p(e=!1){try{const t=r(44590);return c=t.Rewriter,e?u:l}catch(e){return a}}e.exports={Rewriter:p(),NonCacheRewriter:p(!0),DummyRewriter:a,getPrepareStackTrace:s,getOriginalPathAndLineFromSourceMap:o,kSymbolPrepareStackTrace:n,cacheRewrittenSourceMap:i}},68828:e=>{"use strict";let t=console||{};e.exports={setLogger:function(e){e&&(t=e)},log:function(e,r){const s=t[e.toLowerCase()];s&&s(r)}}},7671:(e,t,r)=>{var s={"./tracer_logger.js":68828};function n(e){var t=i(e);return r(t)}function i(e){if(!r.o(s,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return s[e]}n.keys=function(){return Object.keys(s)},n.resolve=i,e.exports=n,n.id=7671},44590:(e,t,r)=>{e=r.nmd(e);let s,n={};n.__wbindgen_placeholder__=e.exports;const{log:i,setLogger:o}=r(7671)(String.raw`./tracer_logger.js`),{readFileSync:a}=r(79896),{dirname:c}=r(16928),{TextEncoder:u,TextDecoder:l}=r(39023),p=new Array(128).fill(void 0);function d(e){return p[e]}p.push(void 0,null,!0,!1);let h=p.length;function f(e){const t=d(e);return function(e){e<132||(p[e]=h,h=e)}(e),t}let g=0,m=null;function _(){return null!==m&&0!==m.byteLength||(m=new Uint8Array(s.memory.buffer)),m}let y=new u("utf-8");const b="function"==typeof y.encodeInto?function(e,t){return y.encodeInto(e,t)}:function(e,t){const r=y.encode(e);return t.set(r),{read:e.length,written:r.length}};function v(e,t,r){if(void 0===r){const r=y.encode(e),s=t(r.length,1)>>>0;return _().subarray(s,s+r.length).set(r),g=r.length,s}let s=e.length,n=t(s,1)>>>0;const i=_();let o=0;for(;o<s;o++){const t=e.charCodeAt(o);if(t>127)break;i[n+o]=t}if(o!==s){0!==o&&(e=e.slice(o)),n=r(n,s,s=o+3*e.length,1)>>>0;const t=_().subarray(n+o,n+s);o+=b(e,t).written,n=r(n,s,o,1)>>>0}return g=o,n}function E(e){return null==e}let S=null;function T(){return null!==S&&0!==S.byteLength||(S=new Int32Array(s.memory.buffer)),S}let w=new l("utf-8",{ignoreBOM:!0,fatal:!0});function x(e,t){return e>>>=0,w.decode(_().subarray(e,e+t))}function A(e){h===p.length&&p.push(p.length+1);const t=h;return h=p[t],p[t]=e,t}w.decode();let I=null;function k(e){const t=typeof e;if("number"==t||"boolean"==t||null==e)return`${e}`;if("string"==t)return`"${e}"`;if("symbol"==t){const t=e.description;return null==t?"Symbol":`Symbol(${t})`}if("function"==t){const t=e.name;return"string"==typeof t&&t.length>0?`Function(${t})`:"Function"}if(Array.isArray(e)){const t=e.length;let r="[";t>0&&(r+=k(e[0]));for(let s=1;s<t;s++)r+=", "+k(e[s]);return r+="]",r}const r=/\[object ([^\]]+)\]/.exec(toString.call(e));let s;if(!(r.length>1))return toString.call(e);if(s=r[1],"Object"==s)try{return"Object("+JSON.stringify(e)+")"}catch(e){return"Object"}return e instanceof Error?`${e.name}: ${e.message}\n${e.stack}`:s}function O(e,t){try{return e.apply(this,t)}catch(e){s.__wbindgen_exn_store(A(e))}}let R=128;const C="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((e=>s.__wbg_rewriter_free(e>>>0)));e.exports.Rewriter=class{__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,C.unregister(this),e}free(){const e=this.__destroy_into_raw();s.__wbg_rewriter_free(e)}constructor(e){const t=s.rewriter_new(A(e));return this.__wbg_ptr=t>>>0,this}rewrite(e,t){try{const i=s.__wbindgen_add_to_stack_pointer(-16),o=v(e,s.__wbindgen_malloc,s.__wbindgen_realloc),a=g,c=v(t,s.__wbindgen_malloc,s.__wbindgen_realloc),u=g;s.rewriter_rewrite(i,this.__wbg_ptr,o,a,c,u);var r=T()[i/4+0],n=T()[i/4+1];if(T()[i/4+2])throw f(n);return f(r)}finally{s.__wbindgen_add_to_stack_pointer(16)}}csiMethods(){try{const r=s.__wbindgen_add_to_stack_pointer(-16);s.rewriter_csiMethods(r,this.__wbg_ptr);var e=T()[r/4+0],t=T()[r/4+1];if(T()[r/4+2])throw f(t);return f(e)}finally{s.__wbindgen_add_to_stack_pointer(16)}}setLogger(e,t){try{const n=s.__wbindgen_add_to_stack_pointer(-16),i=v(t,s.__wbindgen_malloc,s.__wbindgen_realloc),o=g;s.rewriter_setLogger(n,this.__wbg_ptr,function(e){if(1==R)throw new Error("out of js stack");return p[--R]=e,R}(e),i,o);var r=T()[n/4+0];if(T()[n/4+1])throw f(r)}finally{s.__wbindgen_add_to_stack_pointer(16),p[R++]=void 0}}},e.exports.__wbindgen_object_drop_ref=function(e){f(e)},e.exports.__wbindgen_boolean_get=function(e){const t=d(e);return"boolean"==typeof t?t?1:0:2},e.exports.__wbindgen_string_get=function(e,t){const r=d(t),n="string"==typeof r?r:void 0;var i=E(n)?0:v(n,s.__wbindgen_malloc,s.__wbindgen_realloc),o=g;T()[e/4+1]=o,T()[e/4+0]=i},e.exports.__wbindgen_is_object=function(e){const t=d(e);return"object"==typeof t&&null!==t},e.exports.__wbindgen_is_undefined=function(e){return void 0===d(e)},e.exports.__wbindgen_in=function(e,t){return d(e)in d(t)},e.exports.__wbindgen_string_new=function(e,t){return A(x(e,t))},e.exports.__wbg_log_05eff2730ce005b7=function(){return O((function(e,t){return A(i(d(e),d(t)))}),arguments)},e.exports.__wbg_setLogger_d085ec145bb510b9=function(){return O((function(e){return A(o(d(e)))}),arguments)},e.exports.__wbindgen_is_string=function(e){return"string"==typeof d(e)},e.exports.__wbindgen_error_new=function(e,t){return A(new Error(x(e,t)))},e.exports.__wbg_readFileSync_a1e5974ff058fa0e=function(){return O((function(e,t){return A(a(x(e,t)))}),arguments)},e.exports.__wbg_dirname_ca78051da71987f7=function(){return O((function(e,t){return A(c(x(e,t)))}),arguments)},e.exports.__wbindgen_jsval_loose_eq=function(e,t){return d(e)==d(t)},e.exports.__wbindgen_number_get=function(e,t){const r=d(t),n="number"==typeof r?r:void 0;(null!==I&&0!==I.byteLength||(I=new Float64Array(s.memory.buffer)),I)[e/8+1]=E(n)?0:n,T()[e/4+0]=!E(n)},e.exports.__wbg_String_91fba7ded13ba54c=function(e,t){const r=v(String(d(t)),s.__wbindgen_malloc,s.__wbindgen_realloc),n=g;T()[e/4+1]=n,T()[e/4+0]=r},e.exports.__wbindgen_number_new=function(e){return A(e)},e.exports.__wbindgen_bigint_from_u64=function(e){return A(BigInt.asUintN(64,e))},e.exports.__wbindgen_object_clone_ref=function(e){return A(d(e))},e.exports.__wbg_getwithrefkey_15c62c2b8546208d=function(e,t){return A(d(e)[d(t)])},e.exports.__wbg_set_20cbc34131e76824=function(e,t,r){d(e)[f(t)]=f(r)},e.exports.__wbg_new_abda76e883ba8a5f=function(){return A(new Error)},e.exports.__wbg_stack_658279fe44541cf6=function(e,t){const r=v(d(t).stack,s.__wbindgen_malloc,s.__wbindgen_realloc),n=g;T()[e/4+1]=n,T()[e/4+0]=r},e.exports.__wbg_error_f851667af71bcfc6=function(e,t){let r,n;try{r=e,n=t,console.error(x(e,t))}finally{s.__wbindgen_free(r,n,1)}},e.exports.__wbg_crypto_e1d53a1d73fb10b8=function(e){return A(d(e).crypto)},e.exports.__wbg_process_038c26bf42b093f8=function(e){return A(d(e).process)},e.exports.__wbg_versions_ab37218d2f0b24a8=function(e){return A(d(e).versions)},e.exports.__wbg_node_080f4b19d15bc1fe=function(e){return A(d(e).node)},e.exports.__wbg_require_78a3dcfbdba9cbce=function(){return O((function(){return A(e.require)}),arguments)},e.exports.__wbindgen_is_function=function(e){return"function"==typeof d(e)},e.exports.__wbg_msCrypto_6e7d3e1f92610cbb=function(e){return A(d(e).msCrypto)},e.exports.__wbg_randomFillSync_6894564c2c334c42=function(){return O((function(e,t,r){var s,n;d(e).randomFillSync((s=t,n=r,s>>>=0,_().subarray(s/1,s/1+n)))}),arguments)},e.exports.__wbg_getRandomValues_805f1c3d65988a5a=function(){return O((function(e,t){d(e).getRandomValues(d(t))}),arguments)},e.exports.__wbg_get_7303ed2ef026b2f5=function(e,t){return A(d(e)[t>>>0])},e.exports.__wbg_length_820c786973abdd8a=function(e){return d(e).length},e.exports.__wbg_new_0394642eae39db16=function(){return A(new Array)},e.exports.__wbg_newnoargs_c9e6043b8ad84109=function(e,t){return A(new Function(x(e,t)))},e.exports.__wbg_new_0f2b71ca2f2a6029=function(){return A(new Map)},e.exports.__wbg_next_f4bc0e96ea67da68=function(e){return A(d(e).next)},e.exports.__wbg_next_ec061e48a0e72a96=function(){return O((function(e){return A(d(e).next())}),arguments)},e.exports.__wbg_done_b6abb27d42b63867=function(e){return d(e).done},e.exports.__wbg_value_2f4ef2036bfad28e=function(e){return A(d(e).value)},e.exports.__wbg_iterator_7c7e58f62eb84700=function(){return A(Symbol.iterator)},e.exports.__wbg_get_f53c921291c381bd=function(){return O((function(e,t){return A(Reflect.get(d(e),d(t)))}),arguments)},e.exports.__wbg_call_557a2f2deacc4912=function(){return O((function(e,t){return A(d(e).call(d(t)))}),arguments)},e.exports.__wbg_new_2b6fea4ea03b1b95=function(){return A(new Object)},e.exports.__wbg_self_742dd6eab3e9211e=function(){return O((function(){return A(self.self)}),arguments)},e.exports.__wbg_window_c409e731db53a0e2=function(){return O((function(){return A(window.window)}),arguments)},e.exports.__wbg_globalThis_b70c095388441f2d=function(){return O((function(){return A(globalThis.globalThis)}),arguments)},e.exports.__wbg_global_1c72617491ed7194=function(){return O((function(){return A(global.global)}),arguments)},e.exports.__wbg_set_b4da98d504ac6091=function(e,t,r){d(e)[t>>>0]=f(r)},e.exports.__wbg_isArray_04e59fb73f78ab5b=function(e){return Array.isArray(d(e))},e.exports.__wbg_instanceof_ArrayBuffer_ef2632aa0d4bfff8=function(e){let t;try{t=d(e)instanceof ArrayBuffer}catch(e){t=!1}return t},e.exports.__wbg_call_587b30eea3e09332=function(){return O((function(e,t,r){return A(d(e).call(d(t),d(r)))}),arguments)},e.exports.__wbg_set_da7be7bf0e037b14=function(e,t,r){return A(d(e).set(d(t),d(r)))},e.exports.__wbg_buffer_55ba7a6b1b92e2ac=function(e){return A(d(e).buffer)},e.exports.__wbg_new_09938a7d020f049b=function(e){return A(new Uint8Array(d(e)))},e.exports.__wbg_set_3698e3ca519b3c3c=function(e,t,r){d(e).set(d(t),r>>>0)},e.exports.__wbg_length_0aab7ffd65ad19ed=function(e){return d(e).length},e.exports.__wbg_instanceof_Uint8Array_1349640af2da2e88=function(e){let t;try{t=d(e)instanceof Uint8Array}catch(e){t=!1}return t},e.exports.__wbg_newwithlength_89eeca401d8918c2=function(e){return A(new Uint8Array(e>>>0))},e.exports.__wbg_subarray_d82be056deb4ad27=function(e,t,r){return A(d(e).subarray(t>>>0,r>>>0))},e.exports.__wbindgen_debug_string=function(e,t){const r=v(k(d(t)),s.__wbindgen_malloc,s.__wbindgen_realloc),n=g;T()[e/4+1]=n,T()[e/4+0]=r},e.exports.__wbindgen_throw=function(e,t){throw new Error(x(e,t))},e.exports.__wbindgen_memory=function(){return A(s.memory)};const N=r(16928).join(__dirname,"wasm_iast_rewriter_bg.wasm"),P=r(79896).readFileSync(N),D=new WebAssembly.Module(P),L=new WebAssembly.Instance(D,n);s=L.exports,e.exports.__wasm=s},24760:(e,t,r)=>{"use strict";let s;try{s=r(68169)(__dirname)}catch(e){s={createTransaction:e=>e,newTaintedString:(e,t)=>t,newTaintedObject:(e,t)=>t,addSecureMarksToTaintedString:(e,t)=>t,isTainted:()=>!1,getMetrics(){},getRanges(){},removeTransaction(){},setMaxTransactions(){},replace:(e,t)=>t,concat:(e,t)=>t,trim:(e,t)=>t,trimEnd:(e,t)=>t,slice:(e,t)=>t,substring:(e,t)=>t,substr:(e,t)=>t,stringCase:(e,t)=>t,arrayJoin:(e,t)=>t}}const n={newTaintedString:s.newTaintedString,newTaintedObject:s.newTaintedObject,addSecureMarksToTaintedString:s.addSecureMarksToTaintedString,isTainted:s.isTainted,getMetrics:s.getMetrics,getRanges:s.getRanges,createTransaction:s.createTransaction,removeTransaction:s.removeTransaction,setMaxTransactions:s.setMaxTransactions,replace:r(1120)(s),concat:s.concat,trim:s.trim,trimEnd:s.trimEnd,slice:s.slice,substring:s.substring,substr:s.substr,stringCase:s.stringCase,arrayJoin:s.arrayJoin};e.exports=n},1120:e=>{const t=/(\$\$)|(\$&)|(\$`)|(\$')|(\$\d)/;e.exports=function(e){function r(r,s,n){return e.isTainted(r,s,n)&&!function(e){return e.indexOf("$")>-1&&!!e.match(t)}(n)}return e.replace?e.replace:function(t,s,n,i,o){if(t&&"string"==typeof n&&"string"==typeof o)if("string"==typeof i){if(r(t,n,o)){const r=n.indexOf(i);if(r>-1)return e.replaceStringByString(t,s,n,i,o,r)}}else if(i instanceof RegExp&&r(t,n,o)){const r=[];let a=-1;for(let e=i.exec(n),t=0;null!=e;e=i.exec(n),t++){const t=e.index;if(t===a)break;r.push([t,e[0]]),a=t}return e.replaceStringByStringUsingRegex(t,s,n,i,o,r)}return s}}},89475:(e,t,r)=>{"use strict";const s=r(68169)(__dirname);e.exports=s},78888:function(e,t,r){"use strict";var s=this&&this.__createBinding||(Object.create?function(e,t,r,s){void 0===s&&(s=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,s,n)}:function(e,t,r,s){void 0===s&&(s=r),e[s]=t[r]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&s(t,e,r);return n(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.monitorOutOfMemory=t.getAllocationProfile=t.stopSamplingHeapProfiler=t.startSamplingHeapProfiler=void 0;const o=i(r(16928)),a=r(68169)(o.join(__dirname,"..",".."));t.startSamplingHeapProfiler=function(e,t){a.heapProfiler.startSamplingHeapProfiler(e,t)},t.stopSamplingHeapProfiler=function(){a.heapProfiler.stopSamplingHeapProfiler()},t.getAllocationProfile=function(){return a.heapProfiler.getAllocationProfile()},t.monitorOutOfMemory=function(e,t,r,s,n,i,o){a.heapProfiler.monitorOutOfMemory(e,t,r,s,n,i,o)}},36253:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.monitorOutOfMemory=t.CallbackMode=t.stop=t.start=t.convertProfile=t.profile=t.v8Profile=void 0;const s=r(78888),n=r(54137),i=r(28167);let o=!1,a=0,c=0;function u(){if(!o)throw new Error("Heap profiler is not enabled.");return(0,s.getAllocationProfile)()}function l(e,t,r,s){const i=1e3*Date.now()*1e3,{external:o}=process.memoryUsage();if(o>0){const t={name:"(external)",scriptName:"",children:[],allocations:[{sizeBytes:o,count:1}]};e.children.push(t)}return(0,n.serializeHeapProfile)(e,i,a,t,r,s)}t.v8Profile=u,t.profile=function(e,t,r){return l(u(),e,t,r)},t.convertProfile=l,t.start=function(e,t){if(o)throw new Error(`Heap profiler is already started  with intervalBytes ${a} and stackDepth ${t}`);a=e,c=t,(0,s.startSamplingHeapProfiler)(a,c),o=!0},t.stop=function(){o&&(o=!1,(0,s.stopSamplingHeapProfiler)())},t.CallbackMode={Async:1,Interrupt:2,Both:3},t.monitorOutOfMemory=function(e,r,n,a,c,u){if(!o)throw new Error("Heap profiler must already be started to call monitorOutOfMemory");let p;void 0!==c&&(p=e=>{c(l(e))}),(0,s.monitorOutOfMemory)(e,r,n,a||[],p,void 0!==u?u:t.CallbackMode.Async,i.isMainThread)}},50581:function(e,t,r){"use strict";e=r.nmd(e);var s=this&&this.__createBinding||(Object.create?function(e,t,r,s){void 0===s&&(s=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,s,n)}:function(e,t,r,s){void 0===s&&(s=r),e[s]=t[r]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&s(t,e,r);return n(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.heap=t.time=t.getNativeThreadId=t.setLogger=t.SourceMapper=t.encodeSync=t.encode=void 0;const o=r(79896),a=i(r(36253)),c=r(33305),u=i(r(2800));var l=r(33305);Object.defineProperty(t,"encode",{enumerable:!0,get:function(){return l.encode}}),Object.defineProperty(t,"encodeSync",{enumerable:!0,get:function(){return l.encodeSync}});var p=r(37048);Object.defineProperty(t,"SourceMapper",{enumerable:!0,get:function(){return p.SourceMapper}});var d=r(97677);Object.defineProperty(t,"setLogger",{enumerable:!0,get:function(){return d.setLogger}});var h=r(2800);Object.defineProperty(t,"getNativeThreadId",{enumerable:!0,get:function(){return h.getNativeThreadId}}),t.time={profile:u.profile,start:u.start,stop:u.stop,getContext:u.getContext,setContext:u.setContext,isStarted:u.isStarted,v8ProfilerStuckEventLoopDetected:u.v8ProfilerStuckEventLoopDetected,getState:u.getState,constants:u.constants},t.heap={start:a.start,stop:a.stop,profile:a.profile,convertProfile:a.convertProfile,v8Profile:a.v8Profile,monitorOutOfMemory:a.monitorOutOfMemory,CallbackMode:a.CallbackMode},e.parent&&"internal/preload"===e.parent.id&&(t.time.start({}),process.on("exit",(()=>{const e=t.time.stop(),r=(0,c.encodeSync)(e);(0,o.writeFileSync)(`pprof-profile-${process.pid}.pb.gz`,r)})))},97677:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setLogger=t.logger=t.NullLogger=void 0;class r{info(...e){}error(...e){}trace(...e){}warn(...e){}fatal(...e){}debug(...e){}}t.NullLogger=r,t.logger=new r,t.setLogger=function(e){t.logger=e}},33305:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.encodeSync=t.encode=void 0;const s=r(39023),n=r(43106),i=(0,s.promisify)(n.gzip);t.encode=function(e){return e.encodeAsync().then(i)},t.encodeSync=function(e){return(0,n.gzipSync)(e.encode())}},54137:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.serializeHeapProfile=t.serializeTimeProfile=t.GARBAGE_COLLECTION_FUNCTION_NAME=t.NON_JS_THREADS_FUNCTION_NAME=void 0;const s=r(54028);function n(e,t,r,n,i,o){const a=[],c=[],u=[],l=new Map,p=new Map,d=t.children.map((e=>({node:e,stack:[]})));for(;d.length>0;){const e=d.pop(),t=e.node;if(t.scriptName.startsWith("file://")&&(t.scriptName=t.scriptName.slice(7)),i&&t.scriptName.indexOf(i)>-1)continue;const s=e.stack,n=h(t,o);s.unshift(n.id),r(e,a);for(const e of t.children)d.push({node:e,stack:s.slice()})}function h(e,t){let r={file:e.scriptName||"",line:e.lineNumber,column:e.columnNumber,name:e.name};r.line&&t&&function(e){return void 0!==e.column&&void 0!==e.line&&e.line>0}(r)&&(r=t.mappingInfo(r));const n=`${e.scriptId}:${r.line}:${r.column}:${r.name}`;let i=p.get(n);if(void 0!==i)return c[i-1];i=c.length+1,p.set(n,i);const o=(a=r,u=e.scriptId,new s.Line({functionId:f(a,u).id,line:a.line}));var a,u;const l=new s.Location({id:i,line:[o]});return c.push(l),l}function f(e,t){let r=e.name;const i=r?`${t}:${r}`:`${t}:${e.line}:${e.column}`;let o=l.get(i);if(void 0!==o)return u[o-1];o=u.length+1,l.set(i,o),r||(r=e.line?e.column?`(anonymous:L#${e.line}:C#${e.column})`:`(anonymous:L#${e.line})`:"(anonymous)");const a=n.dedup(r),c=new s.Function({id:o,name:a,systemName:a,filename:n.dedup(e.file||"")});return u.push(c),c}e.sample=a,e.location=c,e.function=u,e.stringTable=n}function i(e){return e.hitCount+e.children.reduce(((e,t)=>e+i(t)),0)}function o(e,t){const r=[];for(const[n,i]of Object.entries(e)){const e={key:t.dedup(n)};switch(typeof i){case"string":e.str=t.dedup(i);break;case"number":case"bigint":e.num=i;break;default:continue}r.push(new s.Label(e))}return r}t.NON_JS_THREADS_FUNCTION_NAME="Non JS threads activity",t.GARBAGE_COLLECTION_FUNCTION_NAME="Garbage Collection",t.serializeTimeProfile=function(e,r,a,c=!1,u){if(c){const t=i(e.topDownRoot);t>0&&(r=Math.min(Math.max(Math.floor((e.endTime-e.startTime)/t),r),2*r))}const l=1e3*r,p=new s.StringTable,d=(h=p,new s.ValueType({type:h.dedup("sample"),unit:h.dedup("count")}));var h;const f=function(e){return new s.ValueType({type:e.dedup("wall"),unit:e.dedup("nanoseconds")})}(p),g=[d,f];if(e.hasCpuTime){const e=function(e){return new s.ValueType({type:e.dedup("cpu"),unit:e.dedup("nanoseconds")})}(p);g.push(e)}const m={sampleType:g,timeNanos:1e3*Date.now()*1e3,durationNanos:1e3*(e.endTime-e.startTime),periodType:f,period:l},_=function(e){const r=[];let s;function n(){return s||(s={name:"Node.js",scriptName:"",scriptId:0,lineNumber:0,columnNumber:0,children:[],hitCount:0},r.push(s)),s}for(const s of e.topDownRoot.children)if("(idle)"!==s.name&&"(program)"!==s.name)if("(garbage collector)"===s.name){const e={...s,name:t.GARBAGE_COLLECTION_FUNCTION_NAME};n().children.push(e)}else r.push(s);if(e.hasCpuTime&&e.nonJSThreadsCpuTime){const r={name:t.NON_JS_THREADS_FUNCTION_NAME,scriptName:"",scriptId:0,lineNumber:0,columnNumber:0,children:[],hitCount:0,contexts:[{context:{},timestamp:BigInt(0),cpuTime:e.nonJSThreadsCpuTime,asyncId:-1}]};n().children.push(r)}return{...e,topDownRoot:{...e.topDownRoot,children:r}}}(e);return n(m,_.topDownRoot,((t,r)=>{let n=t.node.hitCount,i=0;for(const a of t.node.contexts||[]){const c=u?u({node:t.node,context:a}):a.context;if(Object.keys(c).length>0){const i=n>0?[1,l]:[0,0];e.hasCpuTime&&i.push(a.cpuTime);const u=new s.Sample({locationId:t.stack,value:i,label:o(c,p)});r.push(u),n--}else e.hasCpuTime&&(i+=a.cpuTime)}if(n>0||i>0){const a=u?u({node:t.node}):{},c=n>0?[n,n*l]:[0,0];e.hasCpuTime&&c.push(i);const d=new s.Sample({locationId:t.stack,value:c,label:o(a,p)});r.push(d)}}),p,void 0,a),new s.Profile(m)},t.serializeHeapProfile=function(e,t,r,i,a,c){const u=new s.StringTable,l=(p=u,new s.ValueType({type:p.dedup("objects"),unit:p.dedup("count")}));var p;const d=function(e){return new s.ValueType({type:e.dedup("space"),unit:e.dedup("bytes")})}(u),h={sampleType:[l,d],timeNanos:t,periodType:d,period:r};return n(h,e,((e,t)=>{if(e.node.allocations.length>0){const r=c?o(c({node:e.node}),u):[];for(const n of e.node.allocations){const i=new s.Sample({locationId:e.stack,value:[n.count,n.sizeBytes*n.count],label:r});t.push(i)}}}),u,i,a),new s.Profile(h)}},37048:function(e,t,r){"use strict";var s=this&&this.__createBinding||(Object.create?function(e,t,r,s){void 0===s&&(s=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,s,n)}:function(e,t,r,s){void 0===s&&(s=r),e[s]=t[r]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&s(t,e,r);return n(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SourceMapper=void 0;const a=i(r(79896)),c=i(r(16928)),u=i(r(19665)),l=r(97677),p=o(r(90165)),d=a.promises.readFile,h=".map";function f(e){return l.logger.debug(`Error: ${e}`),new Error(e)}class g{static async create(e,t=!1){t&&l.logger.debug(`Looking for source map files in dirs: [${e.join(", ")}]`);const r=[];for(const t of e)try{(await m(t)).forEach((e=>{r.push(c.resolve(t,e))}))}catch(e){throw f(`failed to get source maps from ${t}: ${e}`)}return t&&l.logger.debug(`Found source map files: [${r.join(", ")}]`),async function(e,t){const r=(0,p.default)(10),s=new g(t),n=e.map((e=>r((()=>async function(e,t,r){if(!t||!t.endsWith(h))throw f(`The path "${t}" does not specify a source map file`);let s,n;t=c.normalize(t);try{s=await d(t,"utf8")}catch(e){throw f("Could not read source map file "+t+": "+e)}try{n=await new u.SourceMapConsumer(s)}catch(e){throw f("An error occurred while reading the sourceMap file "+t+": "+e)}const i=c.dirname(t),o=[];n.file&&o.push(c.resolve(i,n.file));const p=c.resolve(i,c.basename(t,h));0!==o.length&&o[0]===p||o.push(p);for(const s of o)try{return await a.promises.access(s,a.constants.F_OK),e.set(s,{mapFileDir:i,mapConsumer:n}),void(r&&l.logger.debug(`Loaded source map for ${s} => ${t}`))}catch(e){r&&l.logger.debug(`Generated path ${s} does not exist`)}r&&l.logger.debug(`Unable to find generated file for ${t}`)}(s.infoMap,e,t)))));try{await Promise.all(n)}catch(e){throw f("An error occurred while processing the source map files"+e)}return s}(r,t)}constructor(e=!1){this.infoMap=new Map,this.debug=e}getMappingInfo(e){return this.infoMap.has(c.normalize(e))?this.infoMap.get(e):null}hasMappingInfo(e){return null!==this.getMappingInfo(e)}mappingInfo(e){const t=c.normalize(e.file),r=this.getMappingInfo(t);if(null===r)return this.debug&&l.logger.debug(`Source map lookup failed: no map found for ${e.file} (normalized: ${t})`),e;const s={line:e.line,column:e.column>0?e.column-1:0},n=r.mapConsumer.originalPositionFor(s);if(null===n.source)return this.debug&&l.logger.debug(`Source map lookup failed for ${e.name}(${e.file}:${e.line}:${e.column})`),e;const i={file:c.resolve(r.mapFileDir,n.source),line:n.line||void 0,name:n.name||e.name,column:null===n.column?void 0:n.column+1};return this.debug&&l.logger.debug(`Source map lookup succeeded for ${e.name}(${e.file}:${e.line}:${e.column}) => ${i.name}(${i.file}:${i.line}:${i.column})`),i}}async function m(e){const t=[];for await(const r of async function*(e,t=e=>!0,r=(e,t)=>!0){yield*async function*e(s){try{for await(const n of await a.promises.opendir(s)){const i=c.join(s,n.name);n.isDirectory()&&r(s,n.name)?yield*e(i):n.isFile()&&t(n.name)&&(await a.promises.access(i,a.constants.R_OK),yield i)}}catch(e){if(!function(e){return(t=e)instanceof Error&&"code"in t&&e.code&&["ENOENT","EPERM","EACCES","ELOOP"].includes(e.code);var t}(e))throw e;l.logger.debug((()=>`Non fatal error: ${e}`))}}(e)}(e,(e=>/\.[cm]?js\.map$/.test(e)),((e,t)=>"/proc"!==e&&".git"!==t&&"node_modules"!==t)))t.push(c.relative(e,r));return t}t.SourceMapper=g},45771:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNativeThreadId=t.constants=t.TimeProfiler=void 0;const s=r(16928),n=r(68169)((0,s.join)(__dirname,"..",".."));t.TimeProfiler=n.TimeProfiler,t.constants=n.constants,t.getNativeThreadId=n.getNativeThreadId},2800:function(e,t,r){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getNativeThreadId=t.constants=t.v8ProfilerStuckEventLoopDetected=t.isStarted=t.getContext=t.setContext=t.getState=t.stop=t.start=t.profile=void 0;const n=s(r(62328)),i=r(54137),o=r(45771);Object.defineProperty(t,"getNativeThreadId",{enumerable:!0,get:function(){return o.getNativeThreadId}});const a=r(28167),{kSampleCount:c}=o.constants;let u,l,p,d=0;process.once("exit",(()=>{_()&&g()}));const h={durationMillis:6e4,intervalMicros:1e3,lineNumbers:!1,withContexts:!1,workaroundV8Bug:!0,collectCpuTime:!1};function f(e={}){if(e={...h,...e},u)throw new Error("Wall profiler is already started");u=new o.TimeProfiler({...e,isMainThread:a.isMainThread}),l=e.sourceMapper,p=e.intervalMicros,d=0,u.start(),e.withContexts&&m({})}function g(e=!1,t){if(!u)throw new Error("Wall profiler is not started");const r=u.stop(e);e?(d=u.v8ProfilerStuckEventLoopDetected(),d>0&&(u.stop(!1),u.start())):d=0;const s=(0,i.serializeTimeProfile)(r,p,l,!0,t);return e||(u.dispose(),u=void 0,l=void 0),s}function m(e){if(!u)throw new Error("Wall profiler is not started");u.context=e}function _(){return!!u}t.profile=async function(e={}){return f(e={...h,...e}),await(0,n.default)(e.durationMillis),g()},t.start=f,t.stop=g,t.getState=function(){if(!u)throw new Error("Wall profiler is not started");return u.state},t.setContext=m,t.getContext=function(){if(!u)throw new Error("Wall profiler is not started");return u.context},t.isStarted=_,t.v8ProfilerStuckEventLoopDetected=function(){return d},t.constants={kSampleCount:c,GARBAGE_COLLECTION_FUNCTION_NAME:i.GARBAGE_COLLECTION_FUNCTION_NAME,NON_JS_THREADS_FUNCTION_NAME:i.NON_JS_THREADS_FUNCTION_NAME}},72136:function(e,t,r){"use strict";var s,n=this&&this.__extends||(s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},s(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.LogCollapsingHighestDenseDDSketch=t.LogCollapsingLowestDenseDDSketch=t.DDSketch=void 0;var i=r(11412),o=r(39667),a=.01,c=function(){function e(e){var t=e.mapping,r=e.store,s=e.negativeStore,n=e.zeroCount;this.mapping=t,this.store=r,this.negativeStore=s,this.zeroCount=n,this.count=this.negativeStore.count+this.zeroCount+this.store.count,this.min=1/0,this.max=-1/0,this.sum=0}return e.prototype.accept=function(e,t){if(void 0===t&&(t=1),t<=0)throw Error("Weight must be a positive number");if(e>this.mapping.minPossible){var r=this.mapping.key(e);this.store.add(r,t)}else e<-this.mapping.minPossible?(r=this.mapping.key(-e),this.negativeStore.add(r,t)):this.zeroCount+=t;this.count+=t,this.sum+=e*t,e<this.min&&(this.min=e),e>this.max&&(this.max=e)},e.prototype.getValueAtQuantile=function(e){if(e<0||e>1||0===this.count)return NaN;var t=e*(this.count-1),r=0;if(t<this.negativeStore.count){var s=this.negativeStore.count-t-1,n=this.negativeStore.keyAtRank(s,!1);r=-this.mapping.value(n)}else{if(t<this.zeroCount+this.negativeStore.count)return 0;n=this.store.keyAtRank(t-this.zeroCount-this.negativeStore.count),r=this.mapping.value(n)}return r},e.prototype.merge=function(e){if(!this.mergeable(e))throw new Error("Cannot merge two DDSketches with different `relativeAccuracy` parameters");0!==e.count&&(0!==this.count?(this.store.merge(e.store),this.zeroCount+=e.zeroCount,this.count+=e.count,this.sum+=e.sum,e.min<this.min&&(this.min=e.min),e.max>this.max&&(this.max=e.max)):this._copy(e))},e.prototype.mergeable=function(e){return this.mapping.gamma===e.mapping.gamma},e.prototype._copy=function(e){this.store.copy(e.store),this.negativeStore.copy(e.negativeStore),this.zeroCount=e.zeroCount,this.min=e.min,this.max=e.max,this.count=e.count,this.sum=e.sum},e.prototype.toProto=function(){var e=r(4072).DDSketch,t=e.create({mapping:this.mapping.toProto(),positiveValues:this.store.toProto(),negativeValues:this.negativeStore.toProto(),zeroCount:this.zeroCount});return e.encode(t).finish()},e.fromProto=function(t){var s=r(4072).DDSketch.decode(t);return new e({mapping:o.KeyMapping.fromProto(s.mapping),store:i.DenseStore.fromProto(s.positiveValues),negativeStore:i.DenseStore.fromProto(s.negativeValues),zeroCount:s.zeroCount})},e}(),u={relativeAccuracy:a},l=function(e){function t(t){var r=(void 0===t?u:t).relativeAccuracy,s=void 0===r?a:r,n=new o.LogarithmicMapping(s),c=new i.DenseStore,l=new i.DenseStore;return e.call(this,{mapping:n,store:c,negativeStore:l,zeroCount:0})||this}return n(t,e),t}(c);t.DDSketch=l;var p=function(e){function t(t){var r=void 0===t?u:t,s=r.relativeAccuracy,n=void 0===s?a:s,c=r.binLimit,l=void 0===c?2048:c,p=new o.LogarithmicMapping(n),d=new i.CollapsingLowestDenseStore(l),h=new i.CollapsingLowestDenseStore(l);return e.call(this,{mapping:p,store:d,negativeStore:h,zeroCount:0})||this}return n(t,e),t}(c);t.LogCollapsingLowestDenseDDSketch=p;var d=function(e){function t(t){var r=void 0===t?u:t,s=r.relativeAccuracy,n=void 0===s?a:s,c=r.binLimit,l=void 0===c?2048:c,p=new o.LogarithmicMapping(n),d=new i.CollapsingHighestDenseStore(l),h=new i.CollapsingHighestDenseStore(l);return e.call(this,{mapping:p,store:d,negativeStore:h,zeroCount:0})||this}return n(t,e),t}(c);t.LogCollapsingHighestDenseDDSketch=d},8426:function(e,t,r){"use strict";var s=this&&this.__createBinding||(Object.create?function(e,t,r,s){void 0===s&&(s=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,s,n)}:function(e,t,r,s){void 0===s&&(s=r),e[s]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||s(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(72136),t)},85718:function(e,t,r){"use strict";var s,n=this&&this.__extends||(s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},s(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.CubicallyInterpolatedMapping=void 0;var i=r(48952),o=r(21374),a=function(e){function t(t,r){void 0===r&&(r=0);var s=e.call(this,t,r)||this;return s.A=6/35,s.B=-.6,s.C=10/7,s._multiplier/=s.C,s}return n(t,e),t.prototype._cubicLog2Approx=function(e){var t=(0,o.frexp)(e),r=t[0],s=t[1],n=2*r-1;return((this.A*n+this.B)*n+this.C)*n+(s-1)},t.prototype._cubicExp2Approx=function(e){var t=Math.floor(e),r=this.B*this.B-3*this.A*this.C,s=2*this.B*this.B*this.B-9*this.A*this.B*this.C-27*this.A*this.A*(e-t),n=Math.cbrt((s-Math.sqrt(s*s-4*r*r*r))/2),i=(-(this.B+n+r/n)/(3*this.A)+1)/2;return(0,o.ldexp)(i,t+1)},t.prototype._logGamma=function(e){return this._cubicLog2Approx(e)*this._multiplier},t.prototype._powGamma=function(e){return this._cubicExp2Approx(e/this._multiplier)},t.prototype._protoInterpolation=function(){return r(4072).IndexMapping.Interpolation.CUBIC},t}(i.KeyMapping);t.CubicallyInterpolatedMapping=a},48952:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KeyMapping=void 0;var s=r(39667),n=Math.pow(2,-1023),i=Number.MAX_VALUE,o=function(){function e(e,t){if(void 0===t&&(t=0),e<=0||e>=1)throw Error("Relative accuracy must be between 0 and 1 when initializing a KeyMapping");this.relativeAccuracy=e,this._offset=t;var r=2*e/(1-e);this.gamma=1+r,this._multiplier=1/Math.log1p(r),this.minPossible=n*this.gamma,this.maxPossible=i/this.gamma}return e.fromGammaOffset=function(e,t){return new this((e-1)/(e+1),t)},e.prototype.key=function(e){return Math.ceil(this._logGamma(e))+this._offset},e.prototype.value=function(e){return this._powGamma(e-this._offset)*(2/(1+this.gamma))},e.prototype.toProto=function(){return r(4072).IndexMapping.create({gamma:this.gamma,indexOffset:this._offset,interpolation:this._protoInterpolation()})},e.fromProto=function(e){if(!e||null==e.gamma||null==e.indexOffset)throw Error("Failed to decode mapping from protobuf");var t=r(4072).IndexMapping.Interpolation,n=e.interpolation,i=e.gamma,o=e.indexOffset;switch(n){case t.NONE:return s.LogarithmicMapping.fromGammaOffset(i,o);case t.LINEAR:return s.LinearlyInterpolatedMapping.fromGammaOffset(i,o);case t.CUBIC:return s.CubicallyInterpolatedMapping.fromGammaOffset(i,o);default:throw Error("Unrecognized mapping when decoding from protobuf")}},e.prototype._logGamma=function(e){return Math.log2(e)*this._multiplier},e.prototype._powGamma=function(e){return Math.pow(2,e/this._multiplier)},e.prototype._protoInterpolation=function(){return r(4072).IndexMapping.Interpolation.NONE},e}();t.KeyMapping=o},12040:function(e,t,r){"use strict";var s,n=this&&this.__extends||(s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},s(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.LinearlyInterpolatedMapping=void 0;var i=r(48952),o=r(21374),a=function(e){function t(t,r){return void 0===r&&(r=0),e.call(this,t,r)||this}return n(t,e),t.prototype._log2Approx=function(e){var t=(0,o.frexp)(e);return 2*t[0]-1+(t[1]-1)},t.prototype._exp2Approx=function(e){var t=Math.floor(e)+1,r=(e-t+2)/2;return(0,o.ldexp)(r,t)},t.prototype._logGamma=function(e){return Math.log2(e)*this._multiplier},t.prototype._powGamma=function(e){return Math.pow(2,e/this._multiplier)},t.prototype._protoInterpolation=function(){return r(4072).IndexMapping.Interpolation.LINEAR},t}(i.KeyMapping);t.LinearlyInterpolatedMapping=a},39784:function(e,t,r){"use strict";var s,n=this&&this.__extends||(s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},s(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.LogarithmicMapping=void 0;var i=function(e){function t(t,r){void 0===r&&(r=0);var s=e.call(this,t,r)||this;return s._multiplier*=Math.log(2),s}return n(t,e),t.prototype._logGamma=function(e){return Math.log2(e)*this._multiplier},t.prototype._powGamma=function(e){return Math.pow(2,e/this._multiplier)},t.prototype._protoInterpolation=function(){return r(4072).IndexMapping.Interpolation.NONE},t}(r(48952).KeyMapping);t.LogarithmicMapping=i},39667:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CubicallyInterpolatedMapping=t.LinearlyInterpolatedMapping=t.LogarithmicMapping=t.KeyMapping=void 0;var s=r(48952);Object.defineProperty(t,"KeyMapping",{enumerable:!0,get:function(){return s.KeyMapping}});var n=r(39784);Object.defineProperty(t,"LogarithmicMapping",{enumerable:!0,get:function(){return n.LogarithmicMapping}});var i=r(12040);Object.defineProperty(t,"LinearlyInterpolatedMapping",{enumerable:!0,get:function(){return i.LinearlyInterpolatedMapping}});var o=r(85718);Object.defineProperty(t,"CubicallyInterpolatedMapping",{enumerable:!0,get:function(){return o.CubicallyInterpolatedMapping}})},21374:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ldexp=t.frexp=void 0,t.frexp=function(e){if(0===e||!Number.isFinite(e))return[e,0];for(var t=Math.abs(e),r=Math.max(-1023,Math.floor(Math.log2(t))+1),s=t*Math.pow(2,-r);s<.5;)s*=2,r--;for(;s>=1;)s*=.5,r++;return e<0&&(s=-s),[s,r]},t.ldexp=function(e,t){for(var r=Math.min(3,Math.ceil(Math.abs(t)/1023)),s=e,n=0;n<r;n++)s*=Math.pow(2,Math.floor((t+n)/r));return s}},4072:(e,t,r)=>{"use strict";var s=r(26946),n=s.Reader,i=s.Writer,o=s.util,a=s.roots.default||(s.roots.default={});a.DDSketch=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.mapping=null,e.prototype.positiveValues=null,e.prototype.negativeValues=null,e.prototype.zeroCount=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=i.create()),null!=e.mapping&&Object.hasOwnProperty.call(e,"mapping")&&a.IndexMapping.encode(e.mapping,t.uint32(10).fork()).ldelim(),null!=e.positiveValues&&Object.hasOwnProperty.call(e,"positiveValues")&&a.Store.encode(e.positiveValues,t.uint32(18).fork()).ldelim(),null!=e.negativeValues&&Object.hasOwnProperty.call(e,"negativeValues")&&a.Store.encode(e.negativeValues,t.uint32(26).fork()).ldelim(),null!=e.zeroCount&&Object.hasOwnProperty.call(e,"zeroCount")&&t.uint32(33).double(e.zeroCount),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,s=new a.DDSketch;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:s.mapping=a.IndexMapping.decode(e,e.uint32());break;case 2:s.positiveValues=a.Store.decode(e,e.uint32());break;case 3:s.negativeValues=a.Store.decode(e,e.uint32());break;case 4:s.zeroCount=e.double();break;default:e.skipType(7&i)}}return s},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.mapping&&e.hasOwnProperty("mapping")&&(t=a.IndexMapping.verify(e.mapping))?"mapping."+t:null!=e.positiveValues&&e.hasOwnProperty("positiveValues")&&(t=a.Store.verify(e.positiveValues))?"positiveValues."+t:null!=e.negativeValues&&e.hasOwnProperty("negativeValues")&&(t=a.Store.verify(e.negativeValues))?"negativeValues."+t:null!=e.zeroCount&&e.hasOwnProperty("zeroCount")&&"number"!=typeof e.zeroCount?"zeroCount: number expected":null;var t},e.fromObject=function(e){if(e instanceof a.DDSketch)return e;var t=new a.DDSketch;if(null!=e.mapping){if("object"!=typeof e.mapping)throw TypeError(".DDSketch.mapping: object expected");t.mapping=a.IndexMapping.fromObject(e.mapping)}if(null!=e.positiveValues){if("object"!=typeof e.positiveValues)throw TypeError(".DDSketch.positiveValues: object expected");t.positiveValues=a.Store.fromObject(e.positiveValues)}if(null!=e.negativeValues){if("object"!=typeof e.negativeValues)throw TypeError(".DDSketch.negativeValues: object expected");t.negativeValues=a.Store.fromObject(e.negativeValues)}return null!=e.zeroCount&&(t.zeroCount=Number(e.zeroCount)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.mapping=null,r.positiveValues=null,r.negativeValues=null,r.zeroCount=0),null!=e.mapping&&e.hasOwnProperty("mapping")&&(r.mapping=a.IndexMapping.toObject(e.mapping,t)),null!=e.positiveValues&&e.hasOwnProperty("positiveValues")&&(r.positiveValues=a.Store.toObject(e.positiveValues,t)),null!=e.negativeValues&&e.hasOwnProperty("negativeValues")&&(r.negativeValues=a.Store.toObject(e.negativeValues,t)),null!=e.zeroCount&&e.hasOwnProperty("zeroCount")&&(r.zeroCount=t.json&&!isFinite(e.zeroCount)?String(e.zeroCount):e.zeroCount),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),a.IndexMapping=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var t,r;return e.prototype.gamma=0,e.prototype.indexOffset=0,e.prototype.interpolation=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=i.create()),null!=e.gamma&&Object.hasOwnProperty.call(e,"gamma")&&t.uint32(9).double(e.gamma),null!=e.indexOffset&&Object.hasOwnProperty.call(e,"indexOffset")&&t.uint32(17).double(e.indexOffset),null!=e.interpolation&&Object.hasOwnProperty.call(e,"interpolation")&&t.uint32(24).int32(e.interpolation),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,s=new a.IndexMapping;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:s.gamma=e.double();break;case 2:s.indexOffset=e.double();break;case 3:s.interpolation=e.int32();break;default:e.skipType(7&i)}}return s},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.gamma&&e.hasOwnProperty("gamma")&&"number"!=typeof e.gamma)return"gamma: number expected";if(null!=e.indexOffset&&e.hasOwnProperty("indexOffset")&&"number"!=typeof e.indexOffset)return"indexOffset: number expected";if(null!=e.interpolation&&e.hasOwnProperty("interpolation"))switch(e.interpolation){default:return"interpolation: enum value expected";case 0:case 1:case 2:case 3:}return null},e.fromObject=function(e){if(e instanceof a.IndexMapping)return e;var t=new a.IndexMapping;switch(null!=e.gamma&&(t.gamma=Number(e.gamma)),null!=e.indexOffset&&(t.indexOffset=Number(e.indexOffset)),e.interpolation){case"NONE":case 0:t.interpolation=0;break;case"LINEAR":case 1:t.interpolation=1;break;case"QUADRATIC":case 2:t.interpolation=2;break;case"CUBIC":case 3:t.interpolation=3}return t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.gamma=0,r.indexOffset=0,r.interpolation=t.enums===String?"NONE":0),null!=e.gamma&&e.hasOwnProperty("gamma")&&(r.gamma=t.json&&!isFinite(e.gamma)?String(e.gamma):e.gamma),null!=e.indexOffset&&e.hasOwnProperty("indexOffset")&&(r.indexOffset=t.json&&!isFinite(e.indexOffset)?String(e.indexOffset):e.indexOffset),null!=e.interpolation&&e.hasOwnProperty("interpolation")&&(r.interpolation=t.enums===String?a.IndexMapping.Interpolation[e.interpolation]:e.interpolation),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e.Interpolation=(t={},(r=Object.create(t))[t[0]="NONE"]=0,r[t[1]="LINEAR"]=1,r[t[2]="QUADRATIC"]=2,r[t[3]="CUBIC"]=3,r),e}(),a.Store=function(){function e(e){if(this.binCounts={},this.contiguousBinCounts=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.binCounts=o.emptyObject,e.prototype.contiguousBinCounts=o.emptyArray,e.prototype.contiguousBinIndexOffset=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=i.create()),null!=e.binCounts&&Object.hasOwnProperty.call(e,"binCounts"))for(var r=Object.keys(e.binCounts),s=0;s<r.length;++s)t.uint32(10).fork().uint32(8).sint32(r[s]).uint32(17).double(e.binCounts[r[s]]).ldelim();if(null!=e.contiguousBinCounts&&e.contiguousBinCounts.length){for(t.uint32(18).fork(),s=0;s<e.contiguousBinCounts.length;++s)t.double(e.contiguousBinCounts[s]);t.ldelim()}return null!=e.contiguousBinIndexOffset&&Object.hasOwnProperty.call(e,"contiguousBinIndexOffset")&&t.uint32(24).sint32(e.contiguousBinIndexOffset),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r,s,i=void 0===t?e.len:e.pos+t,c=new a.Store;e.pos<i;){var u=e.uint32();switch(u>>>3){case 1:c.binCounts===o.emptyObject&&(c.binCounts={});var l=e.uint32()+e.pos;for(r=0,s=0;e.pos<l;){var p=e.uint32();switch(p>>>3){case 1:r=e.sint32();break;case 2:s=e.double();break;default:e.skipType(7&p)}}c.binCounts[r]=s;break;case 2:if(c.contiguousBinCounts&&c.contiguousBinCounts.length||(c.contiguousBinCounts=[]),2==(7&u))for(l=e.uint32()+e.pos;e.pos<l;)c.contiguousBinCounts.push(e.double());else c.contiguousBinCounts.push(e.double());break;case 3:c.contiguousBinIndexOffset=e.sint32();break;default:e.skipType(7&u)}}return c},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.binCounts&&e.hasOwnProperty("binCounts")){if(!o.isObject(e.binCounts))return"binCounts: object expected";for(var t=Object.keys(e.binCounts),r=0;r<t.length;++r){if(!o.key32Re.test(t[r]))return"binCounts: integer key{k:sint32} expected";if("number"!=typeof e.binCounts[t[r]])return"binCounts: number{k:sint32} expected"}}if(null!=e.contiguousBinCounts&&e.hasOwnProperty("contiguousBinCounts")){if(!Array.isArray(e.contiguousBinCounts))return"contiguousBinCounts: array expected";for(r=0;r<e.contiguousBinCounts.length;++r)if("number"!=typeof e.contiguousBinCounts[r])return"contiguousBinCounts: number[] expected"}return null!=e.contiguousBinIndexOffset&&e.hasOwnProperty("contiguousBinIndexOffset")&&!o.isInteger(e.contiguousBinIndexOffset)?"contiguousBinIndexOffset: integer expected":null},e.fromObject=function(e){if(e instanceof a.Store)return e;var t=new a.Store;if(e.binCounts){if("object"!=typeof e.binCounts)throw TypeError(".Store.binCounts: object expected");t.binCounts={};for(var r=Object.keys(e.binCounts),s=0;s<r.length;++s)t.binCounts[r[s]]=Number(e.binCounts[r[s]])}if(e.contiguousBinCounts){if(!Array.isArray(e.contiguousBinCounts))throw TypeError(".Store.contiguousBinCounts: array expected");for(t.contiguousBinCounts=[],s=0;s<e.contiguousBinCounts.length;++s)t.contiguousBinCounts[s]=Number(e.contiguousBinCounts[s])}return null!=e.contiguousBinIndexOffset&&(t.contiguousBinIndexOffset=0|e.contiguousBinIndexOffset),t},e.toObject=function(e,t){t||(t={});var r,s={};if((t.arrays||t.defaults)&&(s.contiguousBinCounts=[]),(t.objects||t.defaults)&&(s.binCounts={}),t.defaults&&(s.contiguousBinIndexOffset=0),e.binCounts&&(r=Object.keys(e.binCounts)).length){s.binCounts={};for(var n=0;n<r.length;++n)s.binCounts[r[n]]=t.json&&!isFinite(e.binCounts[r[n]])?String(e.binCounts[r[n]]):e.binCounts[r[n]]}if(e.contiguousBinCounts&&e.contiguousBinCounts.length)for(s.contiguousBinCounts=[],n=0;n<e.contiguousBinCounts.length;++n)s.contiguousBinCounts[n]=t.json&&!isFinite(e.contiguousBinCounts[n])?String(e.contiguousBinCounts[n]):e.contiguousBinCounts[n];return null!=e.contiguousBinIndexOffset&&e.hasOwnProperty("contiguousBinIndexOffset")&&(s.contiguousBinIndexOffset=e.contiguousBinIndexOffset),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),e.exports=a},53140:function(e,t,r){"use strict";var s,n=this&&this.__extends||(s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},s(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.CollapsingHighestDenseStore=void 0;var i=r(61598),o=r(54358),a=function(e){function t(t,r){var s=e.call(this,r)||this;return s.binLimit=t,s.isCollapsed=!1,s}return n(t,e),t.prototype.merge=function(e){if(0!==e.count)if(0!==this.count){(e.minKey<this.minKey||e.maxKey>this.maxKey)&&this._extendRange(e.minKey,e.maxKey);var t=e.maxKey-e.offset+1,r=Math.max(this.maxKey+1,e.minKey)-e.offset;if(t>r){var s=(0,o.sumOfRange)(e.bins,r,t);this.bins[this.length()-1]+=s}else r=t;for(var n=e.minKey;n<r+e.offset;n++)this.bins[n-this.offset]+=e.bins[n-e.offset];this.count+=e.count}else this.copy(e)},t.prototype.copy=function(t){e.prototype.copy.call(this,t),this.isCollapsed=t.isCollapsed},t.prototype._getNewLength=function(e,t){var r=t-e+1;return Math.min(this.chunkSize*Math.ceil(r/this.chunkSize),this.binLimit)},t.prototype._adjust=function(e,t){if(t-e+1>this.length())if((t=e+this.length()+1)<=this.minKey)this.offset=e,this.maxKey=t,this.bins.fill(0),this.bins[this.length()-1]=this.count;else{var r=this.offset-e;if(r>0){var s=t-this.offset+1,n=this.maxKey-this.offset+1,i=(0,o.sumOfRange)(this.bins,s,n);this.bins.fill(0,s,n),this.bins[s-1]+=i,this.maxKey=t,this._shiftBins(r)}else this.maxKey=t,this._shiftBins(r);this.minKey=e,this.isCollapsed=!0}else this._centerBins(e,t),this.minKey=e,this.maxKey=t},t.prototype._getIndex=function(e){if(e<this.minKey){if(this.isCollapsed)return this.length()-1;if(this._extendRange(e),this.isCollapsed)return this.length()-1}else e>this.maxKey&&this._extendRange(e);return e-this.offset},t}(i.DenseStore);t.CollapsingHighestDenseStore=a},70552:function(e,t,r){"use strict";var s,n=this&&this.__extends||(s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},s(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.CollapsingLowestDenseStore=void 0;var i=r(61598),o=r(54358),a=function(e){function t(t,r){var s=e.call(this,r)||this;return s.binLimit=t,s.isCollapsed=!1,s}return n(t,e),t.prototype.merge=function(e){if(0!==e.count)if(0!==this.count){(e.minKey<this.minKey||e.maxKey>this.maxKey)&&this._extendRange(e.minKey,e.maxKey);var t=e.minKey-e.offset,r=Math.min(this.minKey,e.maxKey+1)-e.offset;if(r>t){var s=(0,o.sumOfRange)(e.bins,t,r);this.bins[0]+=s}else r=t;for(var n=r+e.offset;n<e.maxKey+1;n++)this.bins[n-this.offset]+=e.bins[n-e.offset];this.count+=e.count}else this.copy(e)},t.prototype.copy=function(t){e.prototype.copy.call(this,t),this.isCollapsed=t.isCollapsed},t.prototype._getNewLength=function(e,t){var r=t-e+1;return Math.min(this.chunkSize*Math.ceil(r/this.chunkSize),this.binLimit)},t.prototype._adjust=function(e,t){if(t-e+1>this.length()){if((e=t-this.length()+1)>=this.maxKey)this.offset=e,this.minKey=e,this.bins.fill(0),this.bins[0]=this.count;else{var r=this.offset-e;if(r<0){var s=this.minKey-this.offset,n=e-this.offset,i=(0,o.sumOfRange)(this.bins,s,n);this.bins.fill(0,s,n),this.bins[n]+=i,this.minKey=e,this._shiftBins(r)}else this.minKey=e,this._shiftBins(r)}this.maxKey=t,this.isCollapsed=!0}else this._centerBins(e,t),this.minKey=e,this.maxKey=t},t.prototype._getIndex=function(e){if(e<this.minKey){if(this.isCollapsed)return 0;if(this._extendRange(e),this.isCollapsed)return 0}else e>this.maxKey&&this._extendRange(e);return e-this.offset},t}(i.DenseStore);t.CollapsingLowestDenseStore=a},61598:function(e,t,r){"use strict";var s=this&&this.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var s,n=0,i=t.length;n<i;n++)!s&&n in t||(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.DenseStore=void 0;var n=r(54358),i=function(){function e(e){void 0===e&&(e=128),this.chunkSize=e,this.bins=[],this.count=0,this.minKey=1/0,this.maxKey=-1/0,this.offset=0}return e.prototype.add=function(e,t){void 0===t&&(t=1);var r=this._getIndex(e);this.bins[r]+=t,this.count+=t},e.prototype.keyAtRank=function(e,t){void 0===t&&(t=!0);for(var r=0,s=0;s<this.length();s++)if(r+=this.bins[s],t&&r>e||!t&&r>=e+1)return s+this.offset;return this.maxKey},e.prototype.merge=function(e){if(0!==e.count)if(0!==this.count){(e.minKey<this.minKey||e.maxKey>this.maxKey)&&this._extendRange(e.minKey,e.maxKey);var t=e.minKey-e.offset,r=Math.min(this.minKey,e.maxKey+1)-e.offset;if(r>t){var s=(0,n.sumOfRange)(e.bins,t,r);this.bins[0]+=s}else r=t;for(var i=r+e.offset;i<e.maxKey+1;i++)this.bins[i-this.offset]+=e.bins[i-e.offset];this.count+=e.count}else this.copy(e)},e.prototype.copy=function(e){this.bins=s([],e.bins,!0),this.count=e.count,this.minKey=e.minKey,this.maxKey=e.maxKey,this.offset=e.offset},e.prototype.length=function(){return this.bins.length},e.prototype._getNewLength=function(e,t){var r=t-e+1;return this.chunkSize*Math.ceil(r/this.chunkSize)},e.prototype._adjust=function(e,t){this._centerBins(e,t),this.minKey=e,this.maxKey=t},e.prototype._shiftBins=function(e){var t,r;e>0?(this.bins=this.bins.slice(0,-e),(t=this.bins).unshift.apply(t,new Array(e).fill(0))):(this.bins=this.bins.slice(Math.abs(e)),(r=this.bins).push.apply(r,new Array(Math.abs(e)).fill(0))),this.offset-=e},e.prototype._centerBins=function(e,t){var r=e+Math.floor((t-e+1)/2);this._shiftBins(Math.floor(this.offset+this.length()/2)-r)},e.prototype._extendRange=function(e,t){var r;t=t||e;var s=Math.min(e,t,this.minKey),n=Math.max(e,t,this.maxKey);if(0===this.length())this.bins=new Array(this._getNewLength(s,n)).fill(0),this.offset=s,this._adjust(s,n);else if(s>=this.minKey&&n<this.offset+this.length())this.minKey=s,this.maxKey=n;else{var i=this._getNewLength(s,n);i>this.length()&&(r=this.bins).push.apply(r,new Array(i-this.length()).fill(0)),this._adjust(s,n)}},e.prototype._getIndex=function(e){return(e<this.minKey||e>this.maxKey)&&this._extendRange(e),e-this.offset},e.prototype.toProto=function(){return r(4072).Store.create({contiguousBinCounts:this.bins,contiguousBinIndexOffset:this.offset})},e.fromProto=function(e){if(!e||null==e.contiguousBinCounts||null==e.contiguousBinIndexOffset)throw Error("Failed to decode store from protobuf");var t=new this,r=e.contiguousBinIndexOffset;t.offset=r;for(var s=0,n=e.contiguousBinCounts;s<n.length;s++){var i=n[s];t.add(r,i),r+=1}return t},e}();t.DenseStore=i},11412:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CollapsingHighestDenseStore=t.CollapsingLowestDenseStore=t.DenseStore=void 0;var s=r(61598);Object.defineProperty(t,"DenseStore",{enumerable:!0,get:function(){return s.DenseStore}});var n=r(70552);Object.defineProperty(t,"CollapsingLowestDenseStore",{enumerable:!0,get:function(){return n.CollapsingLowestDenseStore}});var i=r(53140);Object.defineProperty(t,"CollapsingHighestDenseStore",{enumerable:!0,get:function(){return i.CollapsingHighestDenseStore}})},54358:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sumOfRange=void 0,t.sumOfRange=function(e,t,r){for(var s=0,n=t;n<=r;n++)s+=e[n];return s}},4685:function(e,t,r){"use strict";var s=this&&this.__createBinding||(Object.create?function(e,t,r,s){void 0===s&&(s=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,s,n)}:function(e,t,r,s){void 0===s&&(s=r),e[s]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||s(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(8426),t)},14022:e=>{const t="object"==typeof performance&&performance&&"function"==typeof performance.now?performance:Date,r=()=>t.now(),s=e=>e===1/0||(e=>e&&e===Math.floor(e)&&e>0&&isFinite(e))(e);class n{constructor({max:e=1/0,ttl:t,updateAgeOnGet:r=!1,checkAgeOnGet:n=!1,noUpdateTTL:i=!1,dispose:o,noDisposeOnSet:a=!1}={}){if(this.expirations=Object.create(null),this.data=new Map,this.expirationMap=new Map,void 0!==t&&!s(t))throw new TypeError("ttl must be positive integer or Infinity if set");if(!s(e))throw new TypeError("max must be positive integer or Infinity");if(this.ttl=t,this.max=e,this.updateAgeOnGet=!!r,this.checkAgeOnGet=!!n,this.noUpdateTTL=!!i,this.noDisposeOnSet=!!a,void 0!==o){if("function"!=typeof o)throw new TypeError("dispose must be function if set");this.dispose=o}this.timer=void 0,this.timerExpiration=void 0}setTimer(e,t){if(this.timerExpiration<e)return;this.timer&&clearTimeout(this.timer);const s=setTimeout((()=>{this.timer=void 0,this.timerExpiration=void 0,this.purgeStale();for(const e in this.expirations){this.setTimer(e,e-r());break}}),t);s.unref&&s.unref(),this.timerExpiration=e,this.timer=s}cancelTimer(){this.timer&&(clearTimeout(this.timer),this.timerExpiration=void 0,this.timer=void 0)}cancelTimers(){return process.emitWarning('TTLCache.cancelTimers has been renamed to TTLCache.cancelTimer (no "s"), and will be removed in the next major version update'),this.cancelTimer()}clear(){const e=this.dispose!==n.prototype.dispose?[...this]:[];this.data.clear(),this.expirationMap.clear(),this.cancelTimer(),this.expirations=Object.create(null);for(const[t,r]of e)this.dispose(r,t,"delete")}setTTL(e,t=this.ttl){const s=this.expirationMap.get(e);if(void 0!==s){const t=this.expirations[s];!t||t.length<=1?delete this.expirations[s]:this.expirations[s]=t.filter((t=>t!==e))}if(t!==1/0){const s=Math.floor(r()+t);this.expirationMap.set(e,s),this.expirations[s]||(this.expirations[s]=[],this.setTimer(s,t)),this.expirations[s].push(e)}else this.expirationMap.set(e,1/0)}set(e,t,{ttl:r=this.ttl,noUpdateTTL:n=this.noUpdateTTL,noDisposeOnSet:i=this.noDisposeOnSet}={}){if(!s(r))throw new TypeError("ttl must be positive integer or Infinity");if(this.expirationMap.has(e)){n||this.setTTL(e,r);const s=this.data.get(e);s!==t&&(this.data.set(e,t),i||this.dispose(s,e,"set"))}else this.setTTL(e,r),this.data.set(e,t);for(;this.size>this.max;)this.purgeToCapacity();return this}has(e){return this.data.has(e)}getRemainingTTL(e){const t=this.expirationMap.get(e);return t===1/0?t:void 0!==t?Math.max(0,Math.ceil(t-r())):0}get(e,{updateAgeOnGet:t=this.updateAgeOnGet,ttl:r=this.ttl,checkAgeOnGet:s=this.checkAgeOnGet}={}){const n=this.data.get(e);if(!s||0!==this.getRemainingTTL(e))return t&&this.setTTL(e,r),n;this.delete(e)}dispose(e,t){}delete(e){const t=this.expirationMap.get(e);if(void 0!==t){const r=this.data.get(e);this.data.delete(e),this.expirationMap.delete(e);const s=this.expirations[t];return s&&(s.length<=1?delete this.expirations[t]:this.expirations[t]=s.filter((t=>t!==e))),this.dispose(r,e,"delete"),0===this.size&&this.cancelTimer(),!0}return!1}purgeToCapacity(){for(const e in this.expirations){const t=this.expirations[e];if(!(this.size-t.length>=this.max)){const e=this.size-this.max,r=[];for(const s of t.splice(0,e))r.push([s,this.data.get(s)]),this.data.delete(s),this.expirationMap.delete(s);for(const[e,t]of r)this.dispose(t,e,"evict");return}{delete this.expirations[e];const r=[];for(const e of t)r.push([e,this.data.get(e)]),this.data.delete(e),this.expirationMap.delete(e);for(const[e,t]of r)this.dispose(t,e,"evict")}}}get size(){return this.data.size}purgeStale(){const e=Math.ceil(r());for(const t in this.expirations){if("Infinity"===t||t>e)return;const r=[...this.expirations[t]||[]],s=[];delete this.expirations[t];for(const e of r)s.push([e,this.data.get(e)]),this.data.delete(e),this.expirationMap.delete(e);for(const[e,t]of s)this.dispose(t,e,"stale")}0===this.size&&this.cancelTimer()}*entries(){for(const e in this.expirations)for(const t of this.expirations[e])yield[t,this.data.get(t)]}*keys(){for(const e in this.expirations)for(const t of this.expirations[e])yield t}*values(){for(const e in this.expirations)for(const t of this.expirations[e])yield this.data.get(t)}[Symbol.iterator](){return this.entries()}}e.exports=n},79100:(e,t,r)=>{"use strict";r.d(t,{_:()=>u});var s=r(38729),n=function(){function e(){}return e.prototype.active=function(){return s.l},e.prototype.with=function(e,t,r){for(var s=[],n=3;n<arguments.length;n++)s[n-3]=arguments[n];return t.call.apply(t,function(e,t,r){if(r||2===arguments.length)for(var s,n=0,i=t.length;n<i;n++)!s&&n in t||(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))}([r],function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var s,n,i=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(s=i.next()).done;)o.push(s.value)}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return o}(s),!1))},e.prototype.bind=function(e,t){return t},e.prototype.enable=function(){return this},e.prototype.disable=function(){return this},e}(),i=r(69627),o=r(44892),a="context",c=new n,u=function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalContextManager=function(e){return(0,i.$G)(a,e,o.K.instance())},e.prototype.active=function(){return this._getContextManager().active()},e.prototype.with=function(e,t,r){for(var s,n=[],i=3;i<arguments.length;i++)n[i-3]=arguments[i];return(s=this._getContextManager()).with.apply(s,function(e,t,r){if(r||2===arguments.length)for(var s,n=0,i=t.length;n<i;n++)!s&&n in t||(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))}([e,t,r],function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var s,n,i=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(s=i.next()).done;)o.push(s.value)}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return o}(n),!1))},e.prototype.bind=function(e,t){return this._getContextManager().bind(e,t)},e.prototype._getContextManager=function(){return(0,i.mS)(a)||c},e.prototype.disable=function(){this._getContextManager().disable(),(0,i.kv)(a,o.K.instance())},e}()},44892:(e,t,r)=>{"use strict";r.d(t,{K:()=>a});var s=r(69627),n=function(){function e(e){this._namespace=e.namespace||"DiagComponentLogger"}return e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return i("debug",this._namespace,e)},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return i("error",this._namespace,e)},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return i("info",this._namespace,e)},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return i("warn",this._namespace,e)},e.prototype.verbose=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return i("verbose",this._namespace,e)},e}();function i(e,t,r){var n=(0,s.mS)("diag");if(n)return r.unshift(t),n[e].apply(n,function(e,t,r){if(r||2===arguments.length)for(var s,n=0,i=t.length;n<i;n++)!s&&n in t||(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))}([],function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var s,n,i=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(s=i.next()).done;)o.push(s.value)}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return o}(r),!1))}var o=r(76733),a=function(){function e(){function e(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=(0,s.mS)("diag");if(n)return n[e].apply(n,function(e,t,r){if(r||2===arguments.length)for(var s,n=0,i=t.length;n<i;n++)!s&&n in t||(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))}([],function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var s,n,i=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(s=i.next()).done;)o.push(s.value)}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return o}(t),!1))}}var t=this;t.setLogger=function(e,r){var n,i,a;if(void 0===r&&(r={logLevel:o.u.INFO}),e===t){var c=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return t.error(null!==(n=c.stack)&&void 0!==n?n:c.message),!1}"number"==typeof r&&(r={logLevel:r});var u=(0,s.mS)("diag"),l=function(e,t){function r(r,s){var n=t[r];return"function"==typeof n&&e>=s?n.bind(t):function(){}}return e<o.u.NONE?e=o.u.NONE:e>o.u.ALL&&(e=o.u.ALL),t=t||{},{error:r("error",o.u.ERROR),warn:r("warn",o.u.WARN),info:r("info",o.u.INFO),debug:r("debug",o.u.DEBUG),verbose:r("verbose",o.u.VERBOSE)}}(null!==(i=r.logLevel)&&void 0!==i?i:o.u.INFO,e);if(u&&!r.suppressOverrideMessage){var p=null!==(a=(new Error).stack)&&void 0!==a?a:"<failed to generate stacktrace>";u.warn("Current logger will be overwritten from "+p),l.warn("Current logger will overwrite one already registered from "+p)}return(0,s.$G)("diag",l,t,!0)},t.disable=function(){(0,s.kv)("diag",t)},t.createComponentLogger=function(e){return new n(e)},t.verbose=e("verbose"),t.debug=e("debug"),t.info=e("info"),t.warn=e("warn"),t.error=e("error")}return e.instance=function(){return this._instance||(this._instance=new e),this._instance},e}()},11616:(e,t,r)=>{"use strict";r.d(t,{B:()=>c,L:()=>a});var s=r(44892),n=function(){function e(e){this._entries=e?new Map(e):new Map}return e.prototype.getEntry=function(e){var t=this._entries.get(e);if(t)return Object.assign({},t)},e.prototype.getAllEntries=function(){return Array.from(this._entries.entries()).map((function(e){var t=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var s,n,i=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(s=i.next()).done;)o.push(s.value)}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return o}(e,2);return[t[0],t[1]]}))},e.prototype.setEntry=function(t,r){var s=new e(this._entries);return s._entries.set(t,r),s},e.prototype.removeEntry=function(t){var r=new e(this._entries);return r._entries.delete(t),r},e.prototype.removeEntries=function(){for(var t,r,s=[],n=0;n<arguments.length;n++)s[n]=arguments[n];var i=new e(this._entries);try{for(var o=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],s=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&s>=e.length&&(e=void 0),{value:e&&e[s++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(s),a=o.next();!a.done;a=o.next()){var c=a.value;i._entries.delete(c)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return i},e.prototype.clear=function(){return new e},e}(),i=Symbol("BaggageEntryMetadata"),o=s.K.instance();function a(e){return void 0===e&&(e={}),new n(new Map(Object.entries(e)))}function c(e){return"string"!=typeof e&&(o.error("Cannot create baggage metadata from unknown type: "+typeof e),e=""),{__TYPE__:i,toString:function(){return e}}}},41844:(e,t,r)=>{"use strict";r.d(t,{_:()=>s});var s=r(79100)._.getInstance()},38729:(e,t,r)=>{"use strict";function s(e){return Symbol.for(e)}r.d(t,{l:()=>n,n:()=>s});var n=new function e(t){var r=this;r._currentContext=t?new Map(t):new Map,r.getValue=function(e){return r._currentContext.get(e)},r.setValue=function(t,s){var n=new e(r._currentContext);return n._currentContext.set(t,s),n},r.deleteValue=function(t){var s=new e(r._currentContext);return s._currentContext.delete(t),s}}},78758:(e,t,r)=>{"use strict";r.d(t,{s:()=>s});var s=r(44892).K.instance()},76733:(e,t,r)=>{"use strict";var s;r.d(t,{u:()=>s}),function(e){e[e.NONE=0]="NONE",e[e.ERROR=30]="ERROR",e[e.WARN=50]="WARN",e[e.INFO=60]="INFO",e[e.DEBUG=70]="DEBUG",e[e.VERBOSE=80]="VERBOSE",e[e.ALL=9999]="ALL"}(s||(s={}))},20350:(e,t,r)=>{"use strict";r.r(t),r.d(t,{DiagConsoleLogger:()=>c,DiagLogLevel:()=>u.u,INVALID_SPANID:()=>$.w9,INVALID_SPAN_CONTEXT:()=>$.dM,INVALID_TRACEID:()=>$.RH,ProxyTracer:()=>C.y,ProxyTracerProvider:()=>N.n,ROOT_CONTEXT:()=>o.l,SamplingDecision:()=>P.i,SpanKind:()=>k,SpanStatusCode:()=>O,TraceFlags:()=>D.X,ValueType:()=>n,baggageEntryMetadataFromString:()=>i.B,context:()=>G._,createContextKey:()=>o.n,createNoopMeter:()=>I,createTraceState:()=>F,default:()=>J,defaultTextMapGetter:()=>R.q,defaultTextMapSetter:()=>R.U,diag:()=>V.s,isSpanContextValid:()=>B.YA,isValidSpanId:()=>B.wN,isValidTraceId:()=>B.hX,metrics:()=>Q,propagation:()=>W.$,trace:()=>Z.u});var s,n,i=r(11616),o=r(38729),a=[{n:"error",c:"error"},{n:"warn",c:"warn"},{n:"info",c:"info"},{n:"debug",c:"debug"},{n:"verbose",c:"trace"}],c=function(){function e(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(console){var s=console[e];if("function"!=typeof s&&(s=console.log),"function"==typeof s)return s.apply(console,t)}}}for(var t=0;t<a.length;t++)this[a[t].n]=e(a[t].c)},u=r(76733),l=(s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},s(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),p=function(){function e(){}return e.prototype.createHistogram=function(e,t){return S},e.prototype.createCounter=function(e,t){return E},e.prototype.createUpDownCounter=function(e,t){return T},e.prototype.createObservableGauge=function(e,t){return x},e.prototype.createObservableCounter=function(e,t){return w},e.prototype.createObservableUpDownCounter=function(e,t){return A},e.prototype.addBatchObservableCallback=function(e,t){},e.prototype.removeBatchObservableCallback=function(e){},e}(),d=function(){},h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l(t,e),t.prototype.add=function(e,t){},t}(d),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l(t,e),t.prototype.add=function(e,t){},t}(d),g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l(t,e),t.prototype.record=function(e,t){},t}(d),m=function(){function e(){}return e.prototype.addCallback=function(e){},e.prototype.removeCallback=function(e){},e}(),_=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l(t,e),t}(m),y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l(t,e),t}(m),b=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l(t,e),t}(m),v=new p,E=new h,S=new g,T=new f,w=new _,x=new y,A=new b;function I(){return v}!function(e){e[e.INT=0]="INT",e[e.DOUBLE=1]="DOUBLE"}(n||(n={}));var k,O,R=r(22009),C=r(19505),N=r(74975),P=r(72674);!function(e){e[e.INTERNAL=0]="INTERNAL",e[e.SERVER=1]="SERVER",e[e.CLIENT=2]="CLIENT",e[e.PRODUCER=3]="PRODUCER",e[e.CONSUMER=4]="CONSUMER"}(k||(k={})),function(e){e[e.UNSET=0]="UNSET",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR"}(O||(O={}));var D=r(47397),L="[_0-9a-z-*/]",M=new RegExp("^(?:[a-z]"+L+"{0,255}|[a-z0-9]"+L+"{0,240}@[a-z]"+L+"{0,13})$"),q=/^[ -~]{0,255}[!-~]$/,j=/,|=/,U=function(){function e(e){this._internalState=new Map,e&&this._parse(e)}return e.prototype.set=function(e,t){var r=this._clone();return r._internalState.has(e)&&r._internalState.delete(e),r._internalState.set(e,t),r},e.prototype.unset=function(e){var t=this._clone();return t._internalState.delete(e),t},e.prototype.get=function(e){return this._internalState.get(e)},e.prototype.serialize=function(){var e=this;return this._keys().reduce((function(t,r){return t.push(r+"="+e.get(r)),t}),[]).join(",")},e.prototype._parse=function(e){e.length>512||(this._internalState=e.split(",").reverse().reduce((function(e,t){var r=t.trim(),s=r.indexOf("=");if(-1!==s){var n=r.slice(0,s),i=r.slice(s+1,t.length);(function(e){return M.test(e)})(n)&&function(e){return q.test(e)&&!j.test(e)}(i)&&e.set(n,i)}return e}),new Map),this._internalState.size>32&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,32))))},e.prototype._keys=function(){return Array.from(this._internalState.keys()).reverse()},e.prototype._clone=function(){var t=new e;return t._internalState=new Map(this._internalState),t},e}();function F(e){return new U(e)}var B=r(67823),$=r(97872),G=r(41844),V=r(78758),z=new(function(){function e(){}return e.prototype.getMeter=function(e,t,r){return v},e}()),H=r(69627),K=r(44892),Y="metrics",Q=function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalMeterProvider=function(e){return(0,H.$G)(Y,e,K.K.instance())},e.prototype.getMeterProvider=function(){return(0,H.mS)(Y)||z},e.prototype.getMeter=function(e,t,r){return this.getMeterProvider().getMeter(e,t,r)},e.prototype.disable=function(){(0,H.kv)(Y,K.K.instance())},e}().getInstance(),W=r(49348),Z=r(6664);const J={context:G._,diag:V.s,metrics:Q,propagation:W.$,trace:Z.u}},69627:(e,t,r)=>{"use strict";r.d(t,{mS:()=>p,$G:()=>l,kv:()=>d});var s="object"==typeof globalThis?globalThis:global,n="1.8.0",i=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/,o=function(e){var t=new Set([e]),r=new Set,s=e.match(i);if(!s)return function(){return!1};var n=+s[1],o=+s[2],a=+s[3];if(null!=s[4])return function(t){return t===e};function c(e){return r.add(e),!1}function u(e){return t.add(e),!0}return function(e){if(t.has(e))return!0;if(r.has(e))return!1;var s=e.match(i);if(!s)return c(e);var l=+s[1],p=+s[2],d=+s[3];return null!=s[4]||n!==l?c(e):0===n?o===p&&a<=d?u(e):c(e):o<=p?u(e):c(e)}}(n),a=n.split(".")[0],c=Symbol.for("opentelemetry.js.api."+a),u=s;function l(e,t,r,s){var i;void 0===s&&(s=!1);var o=u[c]=null!==(i=u[c])&&void 0!==i?i:{version:n};if(!s&&o[e]){var a=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+e);return r.error(a.stack||a.message),!1}return o.version!==n?(a=new Error("@opentelemetry/api: Registration of version v"+o.version+" for "+e+" does not match previously registered API v"+n),r.error(a.stack||a.message),!1):(o[e]=t,r.debug("@opentelemetry/api: Registered a global for "+e+" v"+n+"."),!0)}function p(e){var t,r,s=null===(t=u[c])||void 0===t?void 0:t.version;if(s&&o(s))return null===(r=u[c])||void 0===r?void 0:r[e]}function d(e,t){t.debug("@opentelemetry/api: Unregistering a global for "+e+" v"+n+".");var r=u[c];r&&delete r[e]}},49348:(e,t,r)=>{"use strict";r.d(t,{$:()=>_});var s=r(69627),n=function(){function e(){}return e.prototype.inject=function(e,t){},e.prototype.extract=function(e,t){return e},e.prototype.fields=function(){return[]},e}(),i=r(22009),o=r(79100),a=(0,r(38729).n)("OpenTelemetry Baggage Key");function c(e){return e.getValue(a)||void 0}function u(){return c(o._.getInstance().active())}function l(e,t){return e.setValue(a,t)}function p(e){return e.deleteValue(a)}var d=r(11616),h=r(44892),f="propagation",g=new n,m=function(){function e(){this.createBaggage=d.L,this.getBaggage=c,this.getActiveBaggage=u,this.setBaggage=l,this.deleteBaggage=p}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalPropagator=function(e){return(0,s.$G)(f,e,h.K.instance())},e.prototype.inject=function(e,t,r){return void 0===r&&(r=i.U),this._getGlobalPropagator().inject(e,t,r)},e.prototype.extract=function(e,t,r){return void 0===r&&(r=i.q),this._getGlobalPropagator().extract(e,t,r)},e.prototype.fields=function(){return this._getGlobalPropagator().fields()},e.prototype.disable=function(){(0,s.kv)(f,h.K.instance())},e.prototype._getGlobalPropagator=function(){return(0,s.mS)(f)||g},e}(),_=m.getInstance()},22009:(e,t,r)=>{"use strict";r.d(t,{U:()=>n,q:()=>s});var s={get:function(e,t){if(null!=e)return e[t]},keys:function(e){return null==e?[]:Object.keys(e)}},n={set:function(e,t,r){null!=e&&(e[t]=r)}}},6664:(e,t,r)=>{"use strict";r.d(t,{u:()=>u});var s=r(69627),n=r(74975),i=r(67823),o=r(13299),a=r(44892),c="trace",u=function(){function e(){this._proxyTracerProvider=new n.n,this.wrapSpanContext=i.IP,this.isSpanContextValid=i.YA,this.deleteSpan=o.EW,this.getSpan=o.fU,this.getActiveSpan=o.Bk,this.getSpanContext=o.w8,this.setSpan=o.Bx,this.setSpanContext=o.g_}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalTracerProvider=function(e){var t=(0,s.$G)(c,this._proxyTracerProvider,a.K.instance());return t&&this._proxyTracerProvider.setDelegate(e),t},e.prototype.getTracerProvider=function(){return(0,s.mS)(c)||this._proxyTracerProvider},e.prototype.getTracer=function(e,t){return this.getTracerProvider().getTracer(e,t)},e.prototype.disable=function(){(0,s.kv)(c,a.K.instance()),this._proxyTracerProvider=new n.n},e}().getInstance()},31440:(e,t,r)=>{"use strict";r.d(t,{d:()=>n});var s=r(97872),n=function(){function e(e){void 0===e&&(e=s.dM),this._spanContext=e}return e.prototype.spanContext=function(){return this._spanContext},e.prototype.setAttribute=function(e,t){return this},e.prototype.setAttributes=function(e){return this},e.prototype.addEvent=function(e,t){return this},e.prototype.setStatus=function(e){return this},e.prototype.updateName=function(e){return this},e.prototype.end=function(e){},e.prototype.isRecording=function(){return!1},e.prototype.recordException=function(e,t){},e}()},79755:(e,t,r)=>{"use strict";r.d(t,{o:()=>c});var s=r(79100),n=r(13299),i=r(31440),o=r(67823),a=s._.getInstance(),c=function(){function e(){}return e.prototype.startSpan=function(e,t,r){if(void 0===r&&(r=a.active()),Boolean(null==t?void 0:t.root))return new i.d;var s,c=r&&(0,n.w8)(r);return"object"==typeof(s=c)&&"string"==typeof s.spanId&&"string"==typeof s.traceId&&"number"==typeof s.traceFlags&&(0,o.YA)(c)?new i.d(c):new i.d},e.prototype.startActiveSpan=function(e,t,r,s){var i,o,c;if(!(arguments.length<2)){2===arguments.length?c=t:3===arguments.length?(i=t,c=r):(i=t,o=r,c=s);var u=null!=o?o:a.active(),l=this.startSpan(e,i,u),p=(0,n.Bx)(u,l);return a.with(p,c,void 0,l)}},e}()},19505:(e,t,r)=>{"use strict";r.d(t,{y:()=>n});var s=new(r(79755).o),n=function(){function e(e,t,r,s){this._provider=e,this.name=t,this.version=r,this.options=s}return e.prototype.startSpan=function(e,t,r){return this._getTracer().startSpan(e,t,r)},e.prototype.startActiveSpan=function(e,t,r,s){var n=this._getTracer();return Reflect.apply(n.startActiveSpan,n,arguments)},e.prototype._getTracer=function(){if(this._delegate)return this._delegate;var e=this._provider.getDelegateTracer(this.name,this.version,this.options);return e?(this._delegate=e,this._delegate):s},e}()},74975:(e,t,r)=>{"use strict";r.d(t,{n:()=>o});var s=r(19505),n=r(79755),i=new(function(){function e(){}return e.prototype.getTracer=function(e,t,r){return new n.o},e}()),o=function(){function e(){}return e.prototype.getTracer=function(e,t,r){var n;return null!==(n=this.getDelegateTracer(e,t,r))&&void 0!==n?n:new s.y(this,e,t,r)},e.prototype.getDelegate=function(){var e;return null!==(e=this._delegate)&&void 0!==e?e:i},e.prototype.setDelegate=function(e){this._delegate=e},e.prototype.getDelegateTracer=function(e,t,r){var s;return null===(s=this._delegate)||void 0===s?void 0:s.getTracer(e,t,r)},e}()},72674:(e,t,r)=>{"use strict";var s;r.d(t,{i:()=>s}),function(e){e[e.NOT_RECORD=0]="NOT_RECORD",e[e.RECORD=1]="RECORD",e[e.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"}(s||(s={}))},13299:(e,t,r)=>{"use strict";r.d(t,{Bk:()=>c,Bx:()=>u,EW:()=>l,fU:()=>a,g_:()=>p,w8:()=>d});var s=r(38729),n=r(31440),i=r(79100),o=(0,s.n)("OpenTelemetry Context Key SPAN");function a(e){return e.getValue(o)||void 0}function c(){return a(i._.getInstance().active())}function u(e,t){return e.setValue(o,t)}function l(e){return e.deleteValue(o)}function p(e,t){return u(e,new n.d(t))}function d(e){var t;return null===(t=a(e))||void 0===t?void 0:t.spanContext()}},97872:(e,t,r)=>{"use strict";r.d(t,{RH:()=>i,dM:()=>o,w9:()=>n});var s=r(47397),n="0000000000000000",i="00000000000000000000000000000000",o={traceId:i,spanId:n,traceFlags:s.X.NONE}},67823:(e,t,r)=>{"use strict";r.d(t,{IP:()=>l,YA:()=>u,hX:()=>a,wN:()=>c});var s=r(97872),n=r(31440),i=/^([0-9a-f]{32})$/i,o=/^[0-9a-f]{16}$/i;function a(e){return i.test(e)&&e!==s.RH}function c(e){return o.test(e)&&e!==s.w9}function u(e){return a(e.traceId)&&c(e.spanId)}function l(e){return new n.d(e)}},47397:(e,t,r)=>{"use strict";var s;r.d(t,{X:()=>s}),function(e){e[e.NONE=0]="NONE",e[e.SAMPLED=1]="SAMPLED"}(s||(s={}))},46372:(e,t,r)=>{"use strict";r.r(t),r.d(t,{AlwaysOffSampler:()=>tt,AlwaysOnSampler:()=>rt,AnchoredClock:()=>S,BindOnceFuture:()=>Dt,CompositePropagator:()=>Pe,DEFAULT_ATTRIBUTE_COUNT_LIMIT:()=>le,DEFAULT_ATTRIBUTE_VALUE_LENGTH_LIMIT:()=>ue,DEFAULT_ENVIRONMENT:()=>he,DEFAULT_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT:()=>pe,DEFAULT_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT:()=>de,ExportResultCode:()=>D,ParentBasedSampler:()=>st,RPCType:()=>He,RandomIdGenerator:()=>Ie,SDK_INFO:()=>Ce,TRACE_PARENT_HEADER:()=>$e,TRACE_STATE_HEADER:()=>Ge,TimeoutError:()=>It,TraceIdRatioBasedSampler:()=>nt,TraceState:()=>Be,TracesSamplerValues:()=>Z,VERSION:()=>J,W3CBaggagePropagator:()=>E,W3CTraceContextPropagator:()=>Ke,_globalThis:()=>Se,addHrTimes:()=>W,baggageUtils:()=>s,callWithTimeout:()=>kt,deleteRPCMetadata:()=>We,getEnv:()=>Ee,getEnvWithoutDefaults:()=>ve,getRPCMetadata:()=>Ze,getTimeOrigin:()=>F,globalErrorHandler:()=>P,hexToBase64:()=>Ae,hrTime:()=>B,hrTimeDuration:()=>G,hrTimeToMicroseconds:()=>K,hrTimeToMilliseconds:()=>H,hrTimeToNanoseconds:()=>z,hrTimeToTimeStamp:()=>V,internal:()=>Mt,isAttributeKey:()=>I,isAttributeValue:()=>k,isTimeInput:()=>Q,isTimeInputHrTime:()=>Y,isTracingSuppressed:()=>u,isUrlIgnored:()=>Ct,isWrapped:()=>Nt,loggingErrorHandler:()=>R,merge:()=>_t,millisToHrTime:()=>U,otperformance:()=>L,parseEnvironment:()=>be,parseTraceParent:()=>ze,sanitizeAttributes:()=>A,setGlobalErrorHandler:()=>N,setRPCMetadata:()=>Qe,suppressTracing:()=>a,timeInputToHrTime:()=>$,unrefTimer:()=>Ne,unsuppressTracing:()=>c,urlMatches:()=>Rt});var s={};r.r(s),r.d(s,{getKeyPairs:()=>y,parseKeyPairsIntoRecord:()=>v,parsePairKeyValue:()=>b,serializeKeyPairs:()=>_});var n=r(49348),i=r(38729),o=(0,i.n)("OpenTelemetry SDK Context Key SUPPRESS_TRACING");function a(e){return e.setValue(o,!0)}function c(e){return e.deleteValue(o)}function u(e){return!0===e.getValue(o)}var l="=",p=";",d=",",h="baggage",f=8192,g=r(11616),m=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var s,n,i=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(s=i.next()).done;)o.push(s.value)}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return o};function _(e){return e.reduce((function(e,t){var r=""+e+(""!==e?d:"")+t;return r.length>f?e:r}),"")}function y(e){return e.getAllEntries().map((function(e){var t=m(e,2),r=t[0],s=t[1],n=encodeURIComponent(r)+"="+encodeURIComponent(s.value);return void 0!==s.metadata&&(n+=p+s.metadata.toString()),n}))}function b(e){var t=e.split(p);if(!(t.length<=0)){var r=t.shift();if(r){var s=r.split(l);if(2===s.length){var n,i=decodeURIComponent(s[0].trim()),o=decodeURIComponent(s[1].trim());return t.length>0&&(n=(0,g.B)(t.join(p))),{key:i,value:o,metadata:n}}}}}function v(e){return"string"!=typeof e||0===e.length?{}:e.split(d).map((function(e){return b(e)})).filter((function(e){return void 0!==e&&e.value.length>0})).reduce((function(e,t){return e[t.key]=t.value,e}),{})}var E=function(){function e(){}return e.prototype.inject=function(e,t,r){var s=n.$.getBaggage(e);if(s&&!u(e)){var i=_(y(s).filter((function(e){return e.length<=4096})).slice(0,180));i.length>0&&r.set(t,h,i)}},e.prototype.extract=function(e,t,r){var s=r.get(t,h),i=Array.isArray(s)?s.join(d):s;if(!i)return e;var o={};return 0===i.length?e:(i.split(d).forEach((function(e){var t=b(e);if(t){var r={value:t.value};t.metadata&&(r.metadata=t.metadata),o[t.key]=r}})),0===Object.entries(o).length?e:n.$.setBaggage(e,n.$.createBaggage(o)))},e.prototype.fields=function(){return[h]},e}(),S=function(){function e(e,t){this._monotonicClock=t,this._epochMillis=e.now(),this._performanceMillis=t.now()}return e.prototype.now=function(){var e=this._monotonicClock.now()-this._performanceMillis;return this._epochMillis+e},e}(),T=r(78758),w=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],s=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&s>=e.length&&(e=void 0),{value:e&&e[s++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},x=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var s,n,i=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(s=i.next()).done;)o.push(s.value)}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return o};function A(e){var t,r,s={};if("object"!=typeof e||null==e)return s;try{for(var n=w(Object.entries(e)),i=n.next();!i.done;i=n.next()){var o=x(i.value,2),a=o[0],c=o[1];I(a)?k(c)?Array.isArray(c)?s[a]=c.slice():s[a]=c:T.s.warn("Invalid attribute value set for key: "+a):T.s.warn("Invalid attribute key: "+a)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}return s}function I(e){return"string"==typeof e&&e.length>0}function k(e){return null==e||(Array.isArray(e)?function(e){var t,r,s;try{for(var n=w(e),i=n.next();!i.done;i=n.next()){var o=i.value;if(null!=o){if(!s){if(O(o)){s=typeof o;continue}return!1}if(typeof o!==s)return!1}}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}return!0}(e):O(e))}function O(e){switch(typeof e){case"number":case"boolean":case"string":return!0}return!1}function R(){return function(e){T.s.error(function(e){return"string"==typeof e?e:JSON.stringify(function(e){for(var t={},r=e;null!==r;)Object.getOwnPropertyNames(r).forEach((function(e){if(!t[e]){var s=r[e];s&&(t[e]=String(s))}})),r=Object.getPrototypeOf(r);return t}(e))}(e))}}var C=R();function N(e){C=e}function P(e){try{C(e)}catch(e){}}var D,L=r(82987).performance,M=9,q=Math.pow(10,6),j=Math.pow(10,M);function U(e){var t=e/1e3;return[Math.trunc(t),Math.round(e%1e3*q)]}function F(){var e=L.timeOrigin;if("number"!=typeof e){var t=L;e=t.timing&&t.timing.fetchStart}return e}function B(e){return W(U(F()),U("number"==typeof e?e:L.now()))}function $(e){if(Y(e))return e;if("number"==typeof e)return e<F()?B(e):U(e);if(e instanceof Date)return U(e.getTime());throw TypeError("Invalid input type")}function G(e,t){var r=t[0]-e[0],s=t[1]-e[1];return s<0&&(r-=1,s+=j),[r,s]}function V(e){var t=M,r=""+"0".repeat(t)+e[1]+"Z",s=r.substr(r.length-t-1);return new Date(1e3*e[0]).toISOString().replace("000Z",s)}function z(e){return e[0]*j+e[1]}function H(e){return Math.round(1e3*e[0]+e[1]/1e6)}function K(e){return Math.round(1e6*e[0]+e[1]/1e3)}function Y(e){return Array.isArray(e)&&2===e.length&&"number"==typeof e[0]&&"number"==typeof e[1]}function Q(e){return Y(e)||"number"==typeof e||e instanceof Date}function W(e,t){var r=[e[0]+t[0],e[1]+t[1]];return r[1]>=j&&(r[1]-=j,r[0]+=1),r}!function(e){e[e.SUCCESS=0]="SUCCESS",e[e.FAILED=1]="FAILED"}(D||(D={}));var Z,J="1.14.0",X=r(70857),ee=r(76733);!function(e){e.AlwaysOff="always_off",e.AlwaysOn="always_on",e.ParentBasedAlwaysOff="parentbased_always_off",e.ParentBasedAlwaysOn="parentbased_always_on",e.ParentBasedTraceIdRatio="parentbased_traceidratio",e.TraceIdRatio="traceidratio"}(Z||(Z={}));var te="object"==typeof globalThis?globalThis:"object"==typeof self?self:"object"==typeof window?window:"object"==typeof global?global:{},re=",",se=["OTEL_SDK_DISABLED"];function ne(e){return se.indexOf(e)>-1}var ie=["OTEL_BSP_EXPORT_TIMEOUT","OTEL_BSP_MAX_EXPORT_BATCH_SIZE","OTEL_BSP_MAX_QUEUE_SIZE","OTEL_BSP_SCHEDULE_DELAY","OTEL_BLRP_EXPORT_TIMEOUT","OTEL_BLRP_MAX_EXPORT_BATCH_SIZE","OTEL_BLRP_MAX_QUEUE_SIZE","OTEL_BLRP_SCHEDULE_DELAY","OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT","OTEL_ATTRIBUTE_COUNT_LIMIT","OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT","OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT","OTEL_LOGRECORD_ATTRIBUTE_VALUE_LENGTH_LIMIT","OTEL_LOGRECORD_ATTRIBUTE_COUNT_LIMIT","OTEL_SPAN_EVENT_COUNT_LIMIT","OTEL_SPAN_LINK_COUNT_LIMIT","OTEL_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT","OTEL_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT","OTEL_EXPORTER_OTLP_TIMEOUT","OTEL_EXPORTER_OTLP_TRACES_TIMEOUT","OTEL_EXPORTER_OTLP_METRICS_TIMEOUT","OTEL_EXPORTER_OTLP_LOGS_TIMEOUT","OTEL_EXPORTER_JAEGER_AGENT_PORT"];function oe(e){return ie.indexOf(e)>-1}var ae=["OTEL_NO_PATCH_MODULES","OTEL_PROPAGATORS"];function ce(e){return ae.indexOf(e)>-1}var ue=1/0,le=128,pe=128,de=128,he={OTEL_SDK_DISABLED:!1,CONTAINER_NAME:"",ECS_CONTAINER_METADATA_URI_V4:"",ECS_CONTAINER_METADATA_URI:"",HOSTNAME:"",KUBERNETES_SERVICE_HOST:"",NAMESPACE:"",OTEL_BSP_EXPORT_TIMEOUT:3e4,OTEL_BSP_MAX_EXPORT_BATCH_SIZE:512,OTEL_BSP_MAX_QUEUE_SIZE:2048,OTEL_BSP_SCHEDULE_DELAY:5e3,OTEL_BLRP_EXPORT_TIMEOUT:3e4,OTEL_BLRP_MAX_EXPORT_BATCH_SIZE:512,OTEL_BLRP_MAX_QUEUE_SIZE:2048,OTEL_BLRP_SCHEDULE_DELAY:5e3,OTEL_EXPORTER_JAEGER_AGENT_HOST:"",OTEL_EXPORTER_JAEGER_AGENT_PORT:6832,OTEL_EXPORTER_JAEGER_ENDPOINT:"",OTEL_EXPORTER_JAEGER_PASSWORD:"",OTEL_EXPORTER_JAEGER_USER:"",OTEL_EXPORTER_OTLP_ENDPOINT:"",OTEL_EXPORTER_OTLP_TRACES_ENDPOINT:"",OTEL_EXPORTER_OTLP_METRICS_ENDPOINT:"",OTEL_EXPORTER_OTLP_LOGS_ENDPOINT:"",OTEL_EXPORTER_OTLP_HEADERS:"",OTEL_EXPORTER_OTLP_TRACES_HEADERS:"",OTEL_EXPORTER_OTLP_METRICS_HEADERS:"",OTEL_EXPORTER_OTLP_LOGS_HEADERS:"",OTEL_EXPORTER_OTLP_TIMEOUT:1e4,OTEL_EXPORTER_OTLP_TRACES_TIMEOUT:1e4,OTEL_EXPORTER_OTLP_METRICS_TIMEOUT:1e4,OTEL_EXPORTER_OTLP_LOGS_TIMEOUT:1e4,OTEL_EXPORTER_ZIPKIN_ENDPOINT:"http://localhost:9411/api/v2/spans",OTEL_LOG_LEVEL:ee.u.INFO,OTEL_NO_PATCH_MODULES:[],OTEL_PROPAGATORS:["tracecontext","baggage"],OTEL_RESOURCE_ATTRIBUTES:"",OTEL_SERVICE_NAME:"",OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT:ue,OTEL_ATTRIBUTE_COUNT_LIMIT:le,OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT:ue,OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT:le,OTEL_LOGRECORD_ATTRIBUTE_VALUE_LENGTH_LIMIT:ue,OTEL_LOGRECORD_ATTRIBUTE_COUNT_LIMIT:le,OTEL_SPAN_EVENT_COUNT_LIMIT:128,OTEL_SPAN_LINK_COUNT_LIMIT:128,OTEL_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT:pe,OTEL_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT:de,OTEL_TRACES_EXPORTER:"",OTEL_TRACES_SAMPLER:Z.ParentBasedAlwaysOn,OTEL_TRACES_SAMPLER_ARG:"",OTEL_LOGS_EXPORTER:"",OTEL_EXPORTER_OTLP_INSECURE:"",OTEL_EXPORTER_OTLP_TRACES_INSECURE:"",OTEL_EXPORTER_OTLP_METRICS_INSECURE:"",OTEL_EXPORTER_OTLP_LOGS_INSECURE:"",OTEL_EXPORTER_OTLP_CERTIFICATE:"",OTEL_EXPORTER_OTLP_TRACES_CERTIFICATE:"",OTEL_EXPORTER_OTLP_METRICS_CERTIFICATE:"",OTEL_EXPORTER_OTLP_LOGS_CERTIFICATE:"",OTEL_EXPORTER_OTLP_COMPRESSION:"",OTEL_EXPORTER_OTLP_TRACES_COMPRESSION:"",OTEL_EXPORTER_OTLP_METRICS_COMPRESSION:"",OTEL_EXPORTER_OTLP_LOGS_COMPRESSION:"",OTEL_EXPORTER_OTLP_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_TRACES_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_METRICS_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_LOGS_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_TRACES_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_METRICS_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_LOGS_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_TRACES_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_METRICS_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_LOGS_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_METRICS_TEMPORALITY_PREFERENCE:"cumulative"};function fe(e,t,r){if(void 0!==r[e]){var s=String(r[e]);t[e]="true"===s.toLowerCase()}}function ge(e,t,r,s,n){if(void 0===s&&(s=-1/0),void 0===n&&(n=1/0),void 0!==r[e]){var i=Number(r[e]);isNaN(i)||(t[e]=i<s?s:i>n?n:i)}}function me(e,t,r,s){void 0===s&&(s=re);var n=r[e];"string"==typeof n&&(t[e]=n.split(s).map((function(e){return e.trim()})))}var _e={ALL:ee.u.ALL,VERBOSE:ee.u.VERBOSE,DEBUG:ee.u.DEBUG,INFO:ee.u.INFO,WARN:ee.u.WARN,ERROR:ee.u.ERROR,NONE:ee.u.NONE};function ye(e,t,r){var s=r[e];if("string"==typeof s){var n=_e[s.toUpperCase()];null!=n&&(t[e]=n)}}function be(e){var t={};for(var r in he){var s=r;if("OTEL_LOG_LEVEL"===s)ye(s,t,e);else if(ne(s))fe(s,t,e);else if(oe(s))ge(s,t,e);else if(ce(s))me(s,t,e);else{var n=e[s];null!=n&&(t[s]=String(n))}}return t}function ve(){return"undefined"!=typeof process&&process&&process.env?be(process.env):be(te)}function Ee(){var e=be(process.env);return Object.assign({HOSTNAME:X.hostname()},he,e)}var Se="object"==typeof globalThis?globalThis:global;function Te(e){return e>=48&&e<=57?e-48:e>=97&&e<=102?e-87:e-55}var we=Buffer.alloc(8),xe=Buffer.alloc(16);function Ae(e){var t;t=16===e.length?we:32===e.length?xe:Buffer.alloc(e.length/2);for(var r=0,s=0;s<e.length;s+=2){var n=Te(e.charCodeAt(s)),i=Te(e.charCodeAt(s+1));t.writeUInt8(n<<4|i,r++)}return t.toString("base64")}var Ie=function(){this.generateTraceId=Oe(16),this.generateSpanId=Oe(8)},ke=Buffer.allocUnsafe(16);function Oe(e){return function(){for(var t=0;t<e/4;t++)ke.writeUInt32BE(Math.random()*Math.pow(2,32)>>>0,4*t);for(t=0;t<e&&!(ke[t]>0);t++)t===e-1&&(ke[e-1]=1);return ke.toString("hex",0,e)}}var Re,Ce=((Re={})["telemetry.sdk.name"]="opentelemetry",Re["process.runtime.name"]="node",Re["telemetry.sdk.language"]="nodejs",Re["telemetry.sdk.version"]=J,Re);function Ne(e){e.unref()}var Pe=function(){function e(e){var t;void 0===e&&(e={}),this._propagators=null!==(t=e.propagators)&&void 0!==t?t:[],this._fields=Array.from(new Set(this._propagators.map((function(e){return"function"==typeof e.fields?e.fields():[]})).reduce((function(e,t){return e.concat(t)}),[])))}return e.prototype.inject=function(e,t,r){var s,n;try{for(var i=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],s=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&s>=e.length&&(e=void 0),{value:e&&e[s++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(this._propagators),o=i.next();!o.done;o=i.next()){var a=o.value;try{a.inject(e,t,r)}catch(e){T.s.warn("Failed to inject with "+a.constructor.name+". Err: "+e.message)}}}catch(e){s={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(s)throw s.error}}},e.prototype.extract=function(e,t,r){return this._propagators.reduce((function(e,s){try{return s.extract(e,t,r)}catch(e){T.s.warn("Failed to inject with "+s.constructor.name+". Err: "+e.message)}return e}),e)},e.prototype.fields=function(){return this._fields.slice()},e}(),De=r(6664),Le=r(67823),Me=r(47397),qe="[_0-9a-z-*/]",je=new RegExp("^(?:[a-z]"+qe+"{0,255}|[a-z0-9]"+qe+"{0,240}@[a-z]"+qe+"{0,13})$"),Ue=/^[ -~]{0,255}[!-~]$/,Fe=/,|=/,Be=function(){function e(e){this._internalState=new Map,e&&this._parse(e)}return e.prototype.set=function(e,t){var r=this._clone();return r._internalState.has(e)&&r._internalState.delete(e),r._internalState.set(e,t),r},e.prototype.unset=function(e){var t=this._clone();return t._internalState.delete(e),t},e.prototype.get=function(e){return this._internalState.get(e)},e.prototype.serialize=function(){var e=this;return this._keys().reduce((function(t,r){return t.push(r+"="+e.get(r)),t}),[]).join(",")},e.prototype._parse=function(e){e.length>512||(this._internalState=e.split(",").reverse().reduce((function(e,t){var r=t.trim(),s=r.indexOf("=");if(-1!==s){var n=r.slice(0,s),i=r.slice(s+1,t.length);(function(e){return je.test(e)})(n)&&function(e){return Ue.test(e)&&!Fe.test(e)}(i)&&e.set(n,i)}return e}),new Map),this._internalState.size>32&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,32))))},e.prototype._keys=function(){return Array.from(this._internalState.keys()).reverse()},e.prototype._clone=function(){var t=new e;return t._internalState=new Map(this._internalState),t},e}(),$e="traceparent",Ge="tracestate",Ve=new RegExp("^\\s?((?!ff)[\\da-f]{2})-((?![0]{32})[\\da-f]{32})-((?![0]{16})[\\da-f]{16})-([\\da-f]{2})(-.*)?\\s?$");function ze(e){var t=Ve.exec(e);return t?"00"===t[1]&&t[5]?null:{traceId:t[2],spanId:t[3],traceFlags:parseInt(t[4],16)}:null}var He,Ke=function(){function e(){}return e.prototype.inject=function(e,t,r){var s=De.u.getSpanContext(e);if(s&&!u(e)&&(0,Le.YA)(s)){var n="00-"+s.traceId+"-"+s.spanId+"-0"+Number(s.traceFlags||Me.X.NONE).toString(16);r.set(t,$e,n),s.traceState&&r.set(t,Ge,s.traceState.serialize())}},e.prototype.extract=function(e,t,r){var s=r.get(t,$e);if(!s)return e;var n=Array.isArray(s)?s[0]:s;if("string"!=typeof n)return e;var i=ze(n);if(!i)return e;i.isRemote=!0;var o=r.get(t,Ge);if(o){var a=Array.isArray(o)?o.join(","):o;i.traceState=new Be("string"==typeof a?a:void 0)}return De.u.setSpanContext(e,i)},e.prototype.fields=function(){return[$e,Ge]},e}(),Ye=(0,i.n)("OpenTelemetry SDK Context Key RPC_METADATA");function Qe(e,t){return e.setValue(Ye,t)}function We(e){return e.deleteValue(Ye)}function Ze(e){return e.getValue(Ye)}!function(e){e.HTTP="http"}(He||(He={}));var Je,Xe,et=r(72674),tt=function(){function e(){}return e.prototype.shouldSample=function(){return{decision:et.i.NOT_RECORD}},e.prototype.toString=function(){return"AlwaysOffSampler"},e}(),rt=function(){function e(){}return e.prototype.shouldSample=function(){return{decision:et.i.RECORD_AND_SAMPLED}},e.prototype.toString=function(){return"AlwaysOnSampler"},e}(),st=function(){function e(e){var t,r,s,n;this._root=e.root,this._root||(P(new Error("ParentBasedSampler must have a root sampler configured")),this._root=new rt),this._remoteParentSampled=null!==(t=e.remoteParentSampled)&&void 0!==t?t:new rt,this._remoteParentNotSampled=null!==(r=e.remoteParentNotSampled)&&void 0!==r?r:new tt,this._localParentSampled=null!==(s=e.localParentSampled)&&void 0!==s?s:new rt,this._localParentNotSampled=null!==(n=e.localParentNotSampled)&&void 0!==n?n:new tt}return e.prototype.shouldSample=function(e,t,r,s,n,i){var o=De.u.getSpanContext(e);return o&&(0,Le.YA)(o)?o.isRemote?o.traceFlags&Me.X.SAMPLED?this._remoteParentSampled.shouldSample(e,t,r,s,n,i):this._remoteParentNotSampled.shouldSample(e,t,r,s,n,i):o.traceFlags&Me.X.SAMPLED?this._localParentSampled.shouldSample(e,t,r,s,n,i):this._localParentNotSampled.shouldSample(e,t,r,s,n,i):this._root.shouldSample(e,t,r,s,n,i)},e.prototype.toString=function(){return"ParentBased{root="+this._root.toString()+", remoteParentSampled="+this._remoteParentSampled.toString()+", remoteParentNotSampled="+this._remoteParentNotSampled.toString()+", localParentSampled="+this._localParentSampled.toString()+", localParentNotSampled="+this._localParentNotSampled.toString()+"}"},e}(),nt=function(){function e(e){void 0===e&&(e=0),this._ratio=e,this._ratio=this._normalize(e),this._upperBound=Math.floor(4294967295*this._ratio)}return e.prototype.shouldSample=function(e,t){return{decision:(0,Le.hX)(t)&&this._accumulate(t)<this._upperBound?et.i.RECORD_AND_SAMPLED:et.i.NOT_RECORD}},e.prototype.toString=function(){return"TraceIdRatioBased{"+this._ratio+"}"},e.prototype._normalize=function(e){return"number"!=typeof e||isNaN(e)?0:e>=1?1:e<=0?0:e},e.prototype._accumulate=function(e){for(var t=0,r=0;r<e.length/8;r++){var s=8*r;t=(t^parseInt(e.slice(s,s+8),16))>>>0}return t},e}(),it="[object Object]",ot="[object Null]",at="[object Undefined]",ct=Function.prototype.toString,ut=ct.call(Object),lt=(Je=Object.getPrototypeOf,Xe=Object,function(e){return Je(Xe(e))}),pt=Object.prototype,dt=pt.hasOwnProperty,ht=Symbol?Symbol.toStringTag:void 0,ft=pt.toString;function gt(e){if(!function(e){return null!=e&&"object"==typeof e}(e)||function(e){return null==e?void 0===e?at:ot:ht&&ht in Object(e)?function(e){var t=dt.call(e,ht),r=e[ht],s=!1;try{e[ht]=void 0,s=!0}catch(e){}var n=ft.call(e);return s&&(t?e[ht]=r:delete e[ht]),n}(e):function(e){return ft.call(e)}(e)}(e)!==it)return!1;var t=lt(e);if(null===t)return!0;var r=dt.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&ct.call(r)===ut}var mt=20;function _t(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=e.shift(),s=new WeakMap;e.length>0;)r=bt(r,e.shift(),0,s);return r}function yt(e){return Et(e)?e.slice():e}function bt(e,t,r,s){var n;if(void 0===r&&(r=0),!(r>mt)){if(r++,wt(e)||wt(t)||St(t))n=yt(t);else if(Et(e)){if(n=e.slice(),Et(t))for(var i=0,o=t.length;i<o;i++)n.push(yt(t[i]));else if(Tt(t))for(i=0,o=(a=Object.keys(t)).length;i<o;i++)n[c=a[i]]=yt(t[c])}else if(Tt(e))if(Tt(t)){if(!function(e,t){return!(!gt(e)||!gt(t))}(e,t))return t;var a;for(n=Object.assign({},e),i=0,o=(a=Object.keys(t)).length;i<o;i++){var c,u=t[c=a[i]];if(wt(u))void 0===u?delete n[c]:n[c]=u;else{var l=n[c],p=u;if(vt(e,c,s)||vt(t,c,s))delete n[c];else{if(Tt(l)&&Tt(p)){var d=s.get(l)||[],h=s.get(p)||[];d.push({obj:e,key:c}),h.push({obj:t,key:c}),s.set(l,d),s.set(p,h)}n[c]=bt(n[c],u,r,s)}}}}else n=t;return n}}function vt(e,t,r){for(var s=r.get(e[t])||[],n=0,i=s.length;n<i;n++){var o=s[n];if(o.key===t&&o.obj===e)return!0}return!1}function Et(e){return Array.isArray(e)}function St(e){return"function"==typeof e}function Tt(e){return!wt(e)&&!Et(e)&&!St(e)&&"object"==typeof e}function wt(e){return"string"==typeof e||"number"==typeof e||"boolean"==typeof e||void 0===e||e instanceof Date||e instanceof RegExp||null===e}var xt,At=(xt=function(e,t){return xt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},xt(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}xt(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),It=function(e){function t(r){var s=e.call(this,r)||this;return Object.setPrototypeOf(s,t.prototype),s}return At(t,e),t}(Error);function kt(e,t){var r,s=new Promise((function(e,s){r=setTimeout((function(){s(new It("Operation timed out."))}),t)}));return Promise.race([e,s]).then((function(e){return clearTimeout(r),e}),(function(e){throw clearTimeout(r),e}))}var Ot=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],s=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&s>=e.length&&(e=void 0),{value:e&&e[s++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};function Rt(e,t){return"string"==typeof t?e===t:!!e.match(t)}function Ct(e,t){var r,s;if(!t)return!1;try{for(var n=Ot(t),i=n.next();!i.done;i=n.next())if(Rt(e,i.value))return!0}catch(e){r={error:e}}finally{try{i&&!i.done&&(s=n.return)&&s.call(n)}finally{if(r)throw r.error}}return!1}function Nt(e){return"function"==typeof e&&"function"==typeof e.__original&&"function"==typeof e.__unwrap&&!0===e.__wrapped}var Pt=function(){function e(){var e=this;this._promise=new Promise((function(t,r){e._resolve=t,e._reject=r}))}return Object.defineProperty(e.prototype,"promise",{get:function(){return this._promise},enumerable:!1,configurable:!0}),e.prototype.resolve=function(e){this._resolve(e)},e.prototype.reject=function(e){this._reject(e)},e}(),Dt=function(){function e(e,t){this._callback=e,this._that=t,this._isCalled=!1,this._deferred=new Pt}return Object.defineProperty(e.prototype,"isCalled",{get:function(){return this._isCalled},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"promise",{get:function(){return this._deferred.promise},enumerable:!1,configurable:!0}),e.prototype.call=function(){for(var e,t=this,r=[],s=0;s<arguments.length;s++)r[s]=arguments[s];if(!this._isCalled){this._isCalled=!0;try{Promise.resolve((e=this._callback).call.apply(e,function(e,t,r){if(r||2===arguments.length)for(var s,n=0,i=t.length;n<i;n++)!s&&n in t||(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))}([this._that],function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var s,n,i=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(s=i.next()).done;)o.push(s.value)}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return o}(r),!1))).then((function(e){return t._deferred.resolve(e)}),(function(e){return t._deferred.reject(e)}))}catch(e){this._deferred.reject(e)}}return this._deferred.promise},e}(),Lt=r(41844),Mt={_export:function(e,t){return new Promise((function(r){Lt._.with(a(Lt._.active()),(function(){e.export(t,(function(e){r(e)}))}))}))}}},18045:e=>{"use strict";e.exports=function(e,t){for(var r=new Array(arguments.length-1),s=0,n=2,i=!0;n<arguments.length;)r[s++]=arguments[n++];return new Promise((function(n,o){r[s]=function(e){if(i)if(i=!1,e)o(e);else{for(var t=new Array(arguments.length-1),r=0;r<t.length;)t[r++]=arguments[r];n.apply(null,t)}};try{e.apply(t||null,r)}catch(e){i&&(i=!1,o(e))}}))}},8839:(e,t)=>{"use strict";var r=t;r.length=function(e){var t=e.length;if(!t)return 0;for(var r=0;--t%4>1&&"="===e.charAt(t);)++r;return Math.ceil(3*e.length)/4-r};for(var s=new Array(64),n=new Array(123),i=0;i<64;)n[s[i]=i<26?i+65:i<52?i+71:i<62?i-4:i-59|43]=i++;r.encode=function(e,t,r){for(var n,i=null,o=[],a=0,c=0;t<r;){var u=e[t++];switch(c){case 0:o[a++]=s[u>>2],n=(3&u)<<4,c=1;break;case 1:o[a++]=s[n|u>>4],n=(15&u)<<2,c=2;break;case 2:o[a++]=s[n|u>>6],o[a++]=s[63&u],c=0}a>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),a=0)}return c&&(o[a++]=s[n],o[a++]=61,1===c&&(o[a++]=61)),i?(a&&i.push(String.fromCharCode.apply(String,o.slice(0,a))),i.join("")):String.fromCharCode.apply(String,o.slice(0,a))};var o="invalid encoding";r.decode=function(e,t,r){for(var s,i=r,a=0,c=0;c<e.length;){var u=e.charCodeAt(c++);if(61===u&&a>1)break;if(void 0===(u=n[u]))throw Error(o);switch(a){case 0:s=u,a=1;break;case 1:t[r++]=s<<2|(48&u)>>4,s=u,a=2;break;case 2:t[r++]=(15&s)<<4|(60&u)>>2,s=u,a=3;break;case 3:t[r++]=(3&s)<<6|u,a=0}}if(1===a)throw Error(o);return r-i},r.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},24358:e=>{"use strict";function t(){this._listeners={}}e.exports=t,t.prototype.on=function(e,t,r){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:r||this}),this},t.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var r=this._listeners[e],s=0;s<r.length;)r[s].fn===t?r.splice(s,1):++s;return this},t.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var r=[],s=1;s<arguments.length;)r.push(arguments[s++]);for(s=0;s<t.length;)t[s].fn.apply(t[s++].ctx,r)}return this}},49410:e=>{"use strict";function t(e){return"undefined"!=typeof Float32Array?function(){var t=new Float32Array([-0]),r=new Uint8Array(t.buffer),s=128===r[3];function n(e,s,n){t[0]=e,s[n]=r[0],s[n+1]=r[1],s[n+2]=r[2],s[n+3]=r[3]}function i(e,s,n){t[0]=e,s[n]=r[3],s[n+1]=r[2],s[n+2]=r[1],s[n+3]=r[0]}function o(e,s){return r[0]=e[s],r[1]=e[s+1],r[2]=e[s+2],r[3]=e[s+3],t[0]}function a(e,s){return r[3]=e[s],r[2]=e[s+1],r[1]=e[s+2],r[0]=e[s+3],t[0]}e.writeFloatLE=s?n:i,e.writeFloatBE=s?i:n,e.readFloatLE=s?o:a,e.readFloatBE=s?a:o}():function(){function t(e,t,r,s){var n=t<0?1:0;if(n&&(t=-t),0===t)e(1/t>0?0:2147483648,r,s);else if(isNaN(t))e(2143289344,r,s);else if(t>34028234663852886e22)e((n<<31|2139095040)>>>0,r,s);else if(t<11754943508222875e-54)e((n<<31|Math.round(t/1401298464324817e-60))>>>0,r,s);else{var i=Math.floor(Math.log(t)/Math.LN2);e((n<<31|i+127<<23|8388607&Math.round(t*Math.pow(2,-i)*8388608))>>>0,r,s)}}function o(e,t,r){var s=e(t,r),n=2*(s>>31)+1,i=s>>>23&255,o=8388607&s;return 255===i?o?NaN:n*(1/0):0===i?1401298464324817e-60*n*o:n*Math.pow(2,i-150)*(o+8388608)}e.writeFloatLE=t.bind(null,r),e.writeFloatBE=t.bind(null,s),e.readFloatLE=o.bind(null,n),e.readFloatBE=o.bind(null,i)}(),"undefined"!=typeof Float64Array?function(){var t=new Float64Array([-0]),r=new Uint8Array(t.buffer),s=128===r[7];function n(e,s,n){t[0]=e,s[n]=r[0],s[n+1]=r[1],s[n+2]=r[2],s[n+3]=r[3],s[n+4]=r[4],s[n+5]=r[5],s[n+6]=r[6],s[n+7]=r[7]}function i(e,s,n){t[0]=e,s[n]=r[7],s[n+1]=r[6],s[n+2]=r[5],s[n+3]=r[4],s[n+4]=r[3],s[n+5]=r[2],s[n+6]=r[1],s[n+7]=r[0]}function o(e,s){return r[0]=e[s],r[1]=e[s+1],r[2]=e[s+2],r[3]=e[s+3],r[4]=e[s+4],r[5]=e[s+5],r[6]=e[s+6],r[7]=e[s+7],t[0]}function a(e,s){return r[7]=e[s],r[6]=e[s+1],r[5]=e[s+2],r[4]=e[s+3],r[3]=e[s+4],r[2]=e[s+5],r[1]=e[s+6],r[0]=e[s+7],t[0]}e.writeDoubleLE=s?n:i,e.writeDoubleBE=s?i:n,e.readDoubleLE=s?o:a,e.readDoubleBE=s?a:o}():function(){function t(e,t,r,s,n,i){var o=s<0?1:0;if(o&&(s=-s),0===s)e(0,n,i+t),e(1/s>0?0:2147483648,n,i+r);else if(isNaN(s))e(0,n,i+t),e(2146959360,n,i+r);else if(s>17976931348623157e292)e(0,n,i+t),e((o<<31|2146435072)>>>0,n,i+r);else{var a;if(s<22250738585072014e-324)e((a=s/5e-324)>>>0,n,i+t),e((o<<31|a/4294967296)>>>0,n,i+r);else{var c=Math.floor(Math.log(s)/Math.LN2);1024===c&&(c=1023),e(4503599627370496*(a=s*Math.pow(2,-c))>>>0,n,i+t),e((o<<31|c+1023<<20|1048576*a&1048575)>>>0,n,i+r)}}}function o(e,t,r,s,n){var i=e(s,n+t),o=e(s,n+r),a=2*(o>>31)+1,c=o>>>20&2047,u=4294967296*(1048575&o)+i;return 2047===c?u?NaN:a*(1/0):0===c?5e-324*a*u:a*Math.pow(2,c-1075)*(u+4503599627370496)}e.writeDoubleLE=t.bind(null,r,0,4),e.writeDoubleBE=t.bind(null,s,4,0),e.readDoubleLE=o.bind(null,n,0,4),e.readDoubleBE=o.bind(null,i,4,0)}(),e}function r(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}function s(e,t,r){t[r]=e>>>24,t[r+1]=e>>>16&255,t[r+2]=e>>>8&255,t[r+3]=255&e}function n(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function i(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}e.exports=t(t)},84153:module=>{"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},99390:e=>{"use strict";e.exports=function(e,t,r){var s=r||8192,n=s>>>1,i=null,o=s;return function(r){if(r<1||r>n)return e(r);o+r>s&&(i=e(s),o=0);var a=t.call(i,o,o+=r);return 7&o&&(o=1+(7|o)),a}}},81447:(e,t)=>{"use strict";var r=t;r.length=function(e){for(var t=0,r=0,s=0;s<e.length;++s)(r=e.charCodeAt(s))<128?t+=1:r<2048?t+=2:55296==(64512&r)&&56320==(64512&e.charCodeAt(s+1))?(++s,t+=4):t+=3;return t},r.read=function(e,t,r){if(r-t<1)return"";for(var s,n=null,i=[],o=0;t<r;)(s=e[t++])<128?i[o++]=s:s>191&&s<224?i[o++]=(31&s)<<6|63&e[t++]:s>239&&s<365?(s=((7&s)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,i[o++]=55296+(s>>10),i[o++]=56320+(1023&s)):i[o++]=(15&s)<<12|(63&e[t++])<<6|63&e[t++],o>8191&&((n||(n=[])).push(String.fromCharCode.apply(String,i)),o=0);return n?(o&&n.push(String.fromCharCode.apply(String,i.slice(0,o))),n.join("")):String.fromCharCode.apply(String,i.slice(0,o))},r.write=function(e,t,r){for(var s,n,i=r,o=0;o<e.length;++o)(s=e.charCodeAt(o))<128?t[r++]=s:s<2048?(t[r++]=s>>6|192,t[r++]=63&s|128):55296==(64512&s)&&56320==(64512&(n=e.charCodeAt(o+1)))?(s=65536+((1023&s)<<10)+(1023&n),++o,t[r++]=s>>18|240,t[r++]=s>>12&63|128,t[r++]=s>>6&63|128,t[r++]=63&s|128):(t[r++]=s>>12|224,t[r++]=s>>6&63|128,t[r++]=63&s|128);return r-i}},84487:(e,t,r)=>{"use strict";const s=r(76982);e.exports="function"==typeof s.randomUUID?s.randomUUID:r(4908)},4908:(e,t,r)=>{"use strict";const s=r(76982),{validateBoolean:n,validateObject:i,codes:{ERR_OPERATION_FAILED:o}}=r(7352),{randomFillSync:a}=s;function c(e){const t=Buffer.alloc(e);return a(t)}let u,l,p,d=0;function h(e,t=0){const r=function(){if(void 0===p){p=new Array(256);for(let e=0;e<p.length;e++){const t=e.toString(16);p[e]=t.padStart(2,"0")}}return p}();return r[e[t]]+r[e[t+1]]+r[e[t+2]]+r[e[t+3]]+"-"+r[e[t+4]]+r[e[t+5]]+"-"+r[15&e[t+6]|64]+r[e[t+7]]+"-"+r[63&e[t+8]|128]+r[e[t+9]]+"-"+r[e[t+10]]+r[e[t+11]]+r[e[t+12]]+r[e[t+13]]+r[e[t+14]]+r[e[t+15]]}e.exports=function(e){void 0!==e&&i(e,"options");const{disableEntropyCache:t=!1}=e||{};return n(t,"options.disableEntropyCache"),t?function(){if(l||(l=c(2048)),void 0===l)throw new o("Out of memory");return a(l),h(l)}():function(){if(u||(u=c(2048)),void 0===u)throw new o("Out of memory");return 0===d&&a(u),d=(d+1)%128,h(u,16*d)}()}},7352:(e,t,r)=>{"use strict";const s=r(42613),n=r(39023),i=["string","function","number","object","Function","Object","boolean","bigint","symbol"];class o extends TypeError{constructor(e){super(`Operation failed: ${e}`),this.code=this.constructor.name,Object.defineProperties(this,{toString:{value(){return`${this.name} [${this.code}]: ${this.message}`},enumerable:!1,writable:!0,configurable:!0}})}}class a extends TypeError{constructor(e,t,r){super(),s("string"==typeof e,"'name' must be a string"),Array.isArray(t)||(t=[t]);let o="The ";if(e.endsWith(" argument"))o+=`${e} `;else{const t=e.includes(".")?"property":"argument";o+=`"${e}" ${t} `}o+="must be ";const a=[],c=[],u=[];for(const e of t)s("string"==typeof e,"All expected entries have to be of type string"),i.includes(e)?a.push(e.toLowerCase()):classRegExp.test(e)?c.push(e):(s("object"!==e,'The value "object" should be written as "Object"'),u.push(e));if(c.length>0){const e=a.indexOf("object");-1!==e&&(a.splice(e,1),c.push("Object"))}if(a.length>0){if(a.length>2){const e=a.pop();o+=`one of type ${a.join(", ")}, or ${e}`}else 2===a.length?o+=`one of type ${a[0]} or ${a[1]}`:o+=`of type ${a[0]}`;(c.length>0||u.length>0)&&(o+=" or ")}if(c.length>0){if(c.length>2){const e=c.pop();o+=`an instance of ${c.join(", ")}, or ${e}`}else o+=`an instance of ${c[0]}`,2===c.length&&(o+=` or ${c[1]}`);u.length>0&&(o+=" or ")}if(u.length>0)if(u.length>2){const e=u.pop();o+=`one of ${u.join(", ")}, or ${e}`}else 2===u.length?o+=`one of ${u[0]} or ${u[1]}`:(u[0].toLowerCase()!==u[0]&&(o+="an "),o+=`${u[0]}`);if(null==r)o+=`. Received ${r}`;else if("function"==typeof r&&r.name)o+=`. Received function ${r.name}`;else if("object"==typeof r)r.constructor&&r.constructor.name?o+=`. Received an instance of ${r.constructor.name}`:o+=`. Received ${n.inspect(r,{depth:-1})}`;else{let e=n.inspect(r,{colors:!1});e.length>25&&(e=`${e.slice(0,25)}...`),o+=`. Received type ${typeof r} (${e})`}this.code=this.constructor.name,Object.defineProperties(this,{message:{value:o,enumerable:!1,writable:!0,configurable:!0},toString:{value(){return`${this.name} [${this.code}]: ${this.message}`},enumerable:!1,writable:!0,configurable:!0}})}}e.exports={validateBoolean:function(e,t){if("boolean"!=typeof e)throw new a(t,"boolean",e)},validateObject:function(e,t,{nullable:r=!1,allowArray:s=!1,allowFunction:n=!1}={}){if(!r&&null===e||!s&&Array.isArray(e)||"object"!=typeof e&&(!n||"function"!=typeof e))throw new a(t,"Object",e)},codes:{ERR_OPERATION_FAILED:o}}},14028:(e,t,r)=>{const{ObjectDefineProperty:s,SymbolFor:n}=r(16884),i=n("dc-polyfill-v1");process[i]||s(process,i,{configurable:!1,enumerable:!1,writable:!1,value:{}}),e.exports=process[i]},6427:e=>{const[t,r,s]=process.versions.node.split(".").map(Number);function n(){return t>20||t>=20&&r>=6}function i(){return t>=16||15===t&&r>=1||14===t&&r>=17}e.exports.MAJOR=t,e.exports.MINOR=r,e.exports.PATCH=s,e.exports.hasFullSupport=n,e.exports.hasTracingChannel=function(){return t>=20},e.exports.hasDiagnosticsChannel=i,e.exports.hasTopSubscribeUnsubscribe=function(){return t>=20||16===t&&r>=17||18===t&&r>=7},e.exports.hasGarbageCollectionBug=function(){return i()&&!n()},e.exports.hasZeroSubscribersBug=function(){return 19===t&&9===r},e.exports.hasChannelStoreMethods=function(){return t>=20||19===t&&r>=9},e.exports.hasChUnsubscribeReturn=function(){return t>=18||14===t&&r>=19||16===t&&r>=14||17===t&&r>=1},e.exports.hasSyncUnsubscribeBug=function(){return 20===t&&r<=5}},1247:(e,t,r)=>{const s=r(6427);r(16884);let n=s.hasDiagnosticsChannel()?r(31637):r(44285);s.hasGarbageCollectionBug()&&(n=r(10730)(n)),s.hasTopSubscribeUnsubscribe()||(n=r(81353)(n)),s.hasChUnsubscribeReturn()||(n=r(78075)(n)),s.hasChannelStoreMethods()||(n=r(93671)(n)),s.hasTracingChannel()||(n=r(68879)(n)),s.hasSyncUnsubscribeBug()&&(n=r(65591)(n)),e.exports=n},61857:(e,t,r)=>{const s=r(39023),{ObjectDefineProperties:n}=r(16884);class i extends TypeError{constructor(e,t){if(super(),null==t)e+=`. Received ${t}`;else if("function"==typeof t&&t.name)e+=`. Received function ${t.name}`;else if("object"==typeof t)t.constructor&&t.constructor.name?e+=`. Received an instance of ${t.constructor.name}`:e+=`. Received ${s.inspect(t,{depth:-1})}`;else{let r=s.inspect(t,{colors:!1});r.length>25&&(r=`${r.slice(0,25)}...`),e+=`. Received type ${typeof t} (${r})`}this.code=this.constructor.name,n(this,{message:{value:e,enumerable:!1,writable:!0,configurable:!0},toString:{value(){return`${this.name} [${this.code}]: ${this.message}`},enumerable:!1,writable:!0,configurable:!0}})}}e.exports={ERR_INVALID_ARG_TYPE:i}},93671:(e,t,r)=>{const{ReflectApply:s}=r(16884);function n(e,t,r,s=i){return()=>{let n;try{n=s(t)}catch(e){return process.nextTick((()=>{throw e})),r()}return e.run(n,r)}}function i(e){return e}e.exports=function(e){const t=new WeakSet,r=e.channel,i={...e};return i.channel=function(){const e=r.apply(this,arguments);return t.has(e)||(e._stores=new Map,e.bindStore=function(e,t){this._stores.set(e,t)},e.unbindStore=function(e){return!!this._stores.has(e)&&(this._stores.delete(e),!0)},e.runStores=function(e,t,r,...i){let o=()=>(this.publish(e),s(t,r,i));for(const t of this._stores.entries()){const r=t[0],s=t[1];o=n(r,e,o,s)}return o()}),e},i}},78075:(e,t,r)=>{const{ObjectGetPrototypeOf:s}=r(16884);e.exports=function(e){const t=new WeakSet,r=e.channel,n=(e.Channel,{...e});return n.channel=function(){const e=r.apply(this,arguments);return t.has(e)||(e.unsubscribe=function(){delete e.unsubscribe;const t=this._subscribers.length;return s(e).unsubscribe.apply(this,arguments),this._subscribers.length<t},t.add(e)),e},n}},10730:(e,t,r)=>{const s=function(){},{ObjectDefineProperty:n,ObjectGetOwnPropertyDescriptor:i}=r(16884);e.exports=function(e){const t=e.channel,r=new WeakSet,o={...e};return o.channel=function(){const e=t.apply(this,arguments);return r.has(e)||(t(arguments[0]).subscribe(s),r.add(e),i(e,"hasSubscribers")||n(e,"hasSubscribers",{get:function(){const t=e._subscribers;return t.length>1||!(t.length<1)&&t[0]!==s}})),e},o}},65591:e=>{e.exports=function(e){const t=new WeakSet,r=e.channel,s={...e};return s.channel=function(){const e=r.apply(this,arguments);if(t.has(e))return e;const s=e.publish;return e.publish=function(){return e._subscribers||(e._subscribers=[]),s.apply(e,arguments)},e},s}},81353:e=>{e.exports=function(e){const t={...e};return t.subscribe=(e,r)=>t.channel(e).subscribe(r),t.unsubscribe=(e,r)=>t.channel(e).unsubscribe(r),t}},68879:(e,t,r)=>{const{ReflectApply:s,PromiseReject:n,PromiseResolve:i,PromisePrototypeThen:o,ArrayPrototypeSplice:a,ArrayPrototypeAt:c}=r(16884),{ERR_INVALID_ARG_TYPE:u}=r(61857),l=["start","end","asyncStart","asyncEnd","error"];e.exports=function(e){const{channel:t}=e,r={...e};class p{constructor(e){if("string"==typeof e)this.start=t(`tracing:${e}:start`),this.end=t(`tracing:${e}:end`),this.asyncStart=t(`tracing:${e}:asyncStart`),this.asyncEnd=t(`tracing:${e}:asyncEnd`),this.error=t(`tracing:${e}:error`);else{if("object"!=typeof e)throw new u("nameOrChannels",["string","object","Channel"],e);{const{start:t,end:r,asyncStart:s,asyncEnd:n,error:i}=e;this.start=t,this.end=r,this.asyncStart=s,this.asyncEnd=n,this.error=i}}}subscribe(e){for(const t of l)e[t]&&this[t]&&this[t].subscribe(e[t])}unsubscribe(e){let t=!0;for(const r of l)e[r]&&(this[r]&&this[r].unsubscribe(e[r])||(t=!1));return t}traceSync(e,t={},r,...n){const{start:i,end:o,error:a}=this;return i.runStores(t,(()=>{try{const i=s(e,r,n);return t.result=i,i}catch(e){throw t.error=e,a.publish(t),e}finally{o.publish(t)}}))}tracePromise(e,t={},r,...a){const{start:c,end:u,asyncStart:l,asyncEnd:p,error:d}=this;function h(e){return t.error=e,d.publish(t),l.publish(t),p.publish(t),n(e)}function f(e){return t.result=e,l.publish(t),p.publish(t),e}return c.runStores(t,(()=>{try{let t=s(e,r,a);return t instanceof Promise||(t=i(t)),o(t,f,h)}catch(e){throw t.error=e,d.publish(t),e}finally{u.publish(t)}}))}traceCallback(e,t=-1,r={},n,...i){const{start:o,end:l,asyncStart:p,asyncEnd:d,error:h}=this,f=c(i,t);if("function"!=typeof f)throw new u("callback",["function"],f);return a(i,t,1,(function(e,t){e?(r.error=e,h.publish(r)):r.result=t,p.runStores(r,(()=>{try{if(f)return s(f,this,arguments)}finally{d.publish(r)}}))})),o.runStores(r,(()=>{try{return s(e,n,i)}catch(e){throw r.error=e,h.publish(r),e}finally{l.publish(r)}}))}}return r.tracingChannel=function(e){return new p(e)},r}},16884:e=>{const t=e=>(...t)=>e.call(...t),r=Reflect.apply,s=Promise.reject.bind(Promise),n=Promise.resolve,i=t(Promise.prototype.then),o=t(Array.prototype.splice),a=t(Array.prototype.at||function(e){if((e=Math.trunc(e)||0)<0&&(e+=this.length),!(e<0||e>=this.length))return this[e]}),c=Object.defineProperty,u=Object.defineProperties,l=Object.getOwnPropertyDescriptor,p=Object.getPrototypeOf,d=Object.setPrototypeOf,h=Symbol.for;e.exports={ReflectApply:r,PromiseReject:s,PromiseResolve:n,PromisePrototypeThen:i,ArrayPrototypeSplice:o,ArrayPrototypeAt:a,ObjectDefineProperty:c,ObjectDefineProperties:u,ObjectGetOwnPropertyDescriptor:l,ObjectGetPrototypeOf:p,ObjectSetPrototypeOf:d,SymbolFor:h}},44285:(e,t,r)=>{"use strict";const{ObjectSetPrototypeOf:s,ObjectGetPrototypeOf:n}=r(16884),{ERR_INVALID_ARG_TYPE:i}=(r(39023),r(61857)),o=r(14028);class a{subscribe(e){if("function"!=typeof e)throw new i('The "subscription" argument must be of type function',e);this._subscribers.push(e)}unsubscribe(e){const t=this._subscribers.indexOf(e);return-1!==t&&(this._subscribers.splice(t,1),this._subscribers.length||s(this,c.prototype),!0)}get hasSubscribers(){return!0}publish(e){for(let t=0;t<this._subscribers.length;t++)try{(0,this._subscribers[t])(e,this.name)}catch(e){process.nextTick((()=>{throw e}))}}}class c{constructor(e){this._subscribers=void 0,this.name=e}static[Symbol.hasInstance](e){const t=n(e);return t===c.prototype||t===a.prototype}subscribe(e){s(this,a.prototype),this._subscribers=[],this.subscribe(e)}unsubscribe(){return!1}get hasSubscribers(){return!1}publish(){}}e.exports={channel:function(e){const t=o[e];if(t)return t;if("string"!=typeof e&&"symbol"!=typeof e)throw new i('The "channel" argument must be one of type string or symbol',e);return o[e]=new c(e)},hasSubscribers:function(e){const t=o[e];return!!t&&t.hasSubscribers},Channel:c,deleteChannel:function(e){return!!o[e]&&(o[e]=null,!0)}}},62328:e=>{"use strict";const t=()=>{const e=new Error("Delay aborted");return e.name="AbortError",e},r=({clearTimeout:e,setTimeout:r,willResolve:s})=>(n,{value:i,signal:o}={})=>{if(o&&o.aborted)return Promise.reject(t());let a,c,u;const l=e||clearTimeout,p=()=>{l(a),u(t())},d=new Promise(((e,t)=>{c=()=>{o&&o.removeEventListener("abort",p),s?e(i):t(i)},u=t,a=(r||setTimeout)(c,n)}));return o&&o.addEventListener("abort",p,{once:!0}),d.clear=()=>{l(a),a=null,c()},d},s=e=>{const t=r({...e,willResolve:!0});return t.reject=r({...e,willResolve:!1}),t.range=(e,r,s)=>t(((e,t)=>Math.floor(Math.random()*(t-e+1)+e))(e,r),s),t},n=s();n.createWithTimers=s,e.exports=n,e.exports.default=n},81671:e=>{"use strict";const t=e=>{if("string"!=typeof e)throw new TypeError("Expected a string");const t=e.match(/(?:\r?\n)/g)||[];if(0===t.length)return;const r=t.filter((e=>"\r\n"===e)).length;return r>t.length-r?"\r\n":"\n"};e.exports=t,e.exports.graceful=e=>"string"==typeof e&&t(e)||"\n"},61702:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GraphQLError=i;var s=r(56716),n=r(99530);function i(e,t,r,s,o,a,c){var u=Array.isArray(t)?0!==t.length?t:void 0:t?[t]:void 0,l=r;if(!l&&u){var p=u[0];l=p&&p.loc&&p.loc.source}var d=s;!d&&u&&(d=u.reduce((function(e,t){return t.loc&&e.push(t.loc.start),e}),[])),d&&0===d.length&&(d=void 0);var h=void 0;s&&r?h=s.map((function(e){return(0,n.getLocation)(r,e)})):u&&(h=u.reduce((function(e,t){return t.loc&&e.push((0,n.getLocation)(t.loc.source,t.loc.start)),e}),[])),Object.defineProperties(this,{message:{value:e,enumerable:!0,writable:!0},locations:{value:h||void 0,enumerable:!0},path:{value:o||void 0,enumerable:!0},nodes:{value:u||void 0},source:{value:l||void 0},positions:{value:d||void 0},originalError:{value:a},extensions:{value:c||a&&a.extensions}}),a&&a.stack?Object.defineProperty(this,"stack",{value:a.stack,writable:!0,configurable:!0}):Error.captureStackTrace?Error.captureStackTrace(this,i):Object.defineProperty(this,"stack",{value:Error().stack,writable:!0,configurable:!0})}i.prototype=Object.create(Error.prototype,{constructor:{value:i},name:{value:"GraphQLError"},toString:{value:function(){return(0,s.printError)(this)}}})},35936:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e};t.formatError=function(e){return e||(0,i.default)(0,"Received null or undefined error."),s({},e.extensions,{message:e.message||"An unknown error occurred.",locations:e.locations,path:e.path})};var n,i=(n=r(61321))&&n.__esModule?n:{default:n}},79211:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r(61702);Object.defineProperty(t,"GraphQLError",{enumerable:!0,get:function(){return s.GraphQLError}});var n=r(51352);Object.defineProperty(t,"syntaxError",{enumerable:!0,get:function(){return n.syntaxError}});var i=r(96107);Object.defineProperty(t,"locatedError",{enumerable:!0,get:function(){return i.locatedError}});var o=r(56716);Object.defineProperty(t,"printError",{enumerable:!0,get:function(){return o.printError}});var a=r(35936);Object.defineProperty(t,"formatError",{enumerable:!0,get:function(){return a.formatError}})},96107:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.locatedError=function(e,t,r){return e&&Array.isArray(e.path)?e:new s.GraphQLError(e&&e.message,e&&e.nodes||t,e&&e.source,e&&e.positions,r,e)};var s=r(61702)},56716:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.printError=function(e){var t=[];if(e.nodes)e.nodes.forEach((function(e){e.loc&&t.push(n(e.loc.source,(0,s.getLocation)(e.loc.source,e.loc.start)))}));else if(e.source&&e.locations){var r=e.source;e.locations.forEach((function(e){t.push(n(r,e))}))}return 0===t.length?e.message:[e.message].concat(t).join("\n\n")+"\n"};var s=r(99530);function n(e,t){var r=t.line,s=e.locationOffset.line-1,n=function(e,t){return 1===t.line?e.locationOffset.column-1:0}(e,t),a=r+s,c=t.column+n,u=(a-1).toString(),l=a.toString(),p=(a+1).toString(),d=p.length,h=e.body.split(/\r\n|[\n\r]/g);return h[0]=i(e.locationOffset.column-1)+h[0],[e.name+" ("+a+":"+c+")",r>=2&&o(d,u)+": "+h[r-2],o(d,l)+": "+h[r-1],i(2+d+c-1)+"^",r<h.length&&o(d,p)+": "+h[r]].filter(Boolean).join("\n")}function i(e){return Array(e+1).join(" ")}function o(e,t){return i(e-t.length)+t}},51352:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.syntaxError=function(e,t,r){return new s.GraphQLError("Syntax Error: "+r,void 0,e,[t])};var s=r(61702)},16892:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultFieldResolver=void 0;var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.execute=function(e,t,r,s,n,i,o){return 1===arguments.length?E(e.schema,e.document,e.rootValue,e.contextValue,e.variableValues,e.operationName,e.fieldResolver):E(e,t,r,s,n,i,o)},t.responsePathAsArray=T,t.addPath=w,t.assertValidExecutionArguments=x,t.buildExecutionContext=A,t.getOperationRootType=I,t.collectFields=O,t.buildResolveInfo=P,t.resolveFieldValueOrError=D,t.getFieldDef=z;var n=r(48652),i=r(79211),o=v(r(61321)),a=v(r(26166)),c=v(r(72530)),u=v(r(97724)),l=v(r(2104)),p=v(r(34702)),d=v(r(25662)),h=r(6693),f=r(7030),g=r(98113),m=r(63754),_=(r(14648),r(8364)),y=r(38685),b=r(59873);function v(e){return e&&e.__esModule?e:{default:e}}function E(e,t,r,s,n,i,o){x(e,t,n);var a=A(e,t,r,s,n,i,o);if(Array.isArray(a))return{errors:a};var c=function(e,t,r){var s=I(e.schema,t),n=O(e,s,t.selectionSet,Object.create(null),Object.create(null)),i=void 0;try{var o="mutation"===t.operation?function(e,t,r,s,n){return(0,d.default)(Object.keys(n),(function(i,o){var a=n[o],c=w(s,o),l=N(e,t,r,a,c);return void 0===l?i:(0,u.default)(l)?l.then((function(e){return i[o]=e,i})):(i[o]=l,i)}),Object.create(null))}(e,s,r,i,n):k(e,s,r,i,n);return(0,u.default)(o)?o.then(void 0,(function(t){return e.errors.push(t),Promise.resolve(null)})):o}catch(t){return e.errors.push(t),null}}(a,a.operation,r);return S(a,c)}function S(e,t){return(0,u.default)(t)?t.then((function(t){return S(e,t)})):0===e.errors.length?{data:t}:{errors:e.errors,data:t}}function T(e){for(var t=[],r=e;r;)t.push(r.key),r=r.prev;return t.reverse()}function w(e,t){return{prev:e,key:t}}function x(e,t,r){t||(0,o.default)(0,"Must provide document"),(0,b.assertValidSchema)(e),r&&"object"!==(void 0===r?"undefined":s(r))&&(0,o.default)(0,"Variables must be provided as an Object where each property is a variable value. Perhaps look to see if an unparsed JSON string was provided.")}function A(e,t,r,s,n,a,c){for(var u=[],l=void 0,p=!1,d=Object.create(null),h=0;h<t.definitions.length;h++){var m=t.definitions[h];switch(m.kind){case f.Kind.OPERATION_DEFINITION:!a&&l?p=!0:(!a||m.name&&m.name.value===a)&&(l=m);break;case f.Kind.FRAGMENT_DEFINITION:d[m.name.value]=m}}l?p&&u.push(new i.GraphQLError("Must provide operation name if query contains multiple operations.")):a?u.push(new i.GraphQLError('Unknown operation named "'+a+'".')):u.push(new i.GraphQLError("Must provide an operation."));var _=void 0;if(l){var y=(0,g.getVariableValues)(e,l.variableDefinitions||[],n||{});y.errors?u.push.apply(u,y.errors):_=y.coerced}return 0!==u.length?u:(l||(0,o.default)(0,"Has operation if no errors."),_||(0,o.default)(0,"Has variables if no errors."),{schema:e,fragments:d,rootValue:r,contextValue:s,operation:l,variableValues:_,fieldResolver:c||V,errors:u})}function I(e,t){switch(t.operation){case"query":var r=e.getQueryType();if(!r)throw new i.GraphQLError("Schema does not define the required query root type.",[t]);return r;case"mutation":var s=e.getMutationType();if(!s)throw new i.GraphQLError("Schema is not configured for mutations.",[t]);return s;case"subscription":var n=e.getSubscriptionType();if(!n)throw new i.GraphQLError("Schema is not configured for subscriptions.",[t]);return n;default:throw new i.GraphQLError("Can only execute queries, mutations and subscriptions.",[t])}}function k(e,t,r,s,n){var i=!1,o=Object.keys(n).reduce((function(o,a){var c=n[a],l=w(s,a),p=N(e,t,r,c,l);return void 0===p||(o[a]=p,!i&&(0,u.default)(p)&&(i=!0)),o}),Object.create(null));return i?(0,p.default)(o):o}function O(e,t,r,s,n){for(var i=0;i<r.selections.length;i++){var o=r.selections[i];switch(o.kind){case f.Kind.FIELD:if(!R(e,o))continue;var a=(l=o).alias?l.alias.value:l.name.value;s[a]||(s[a]=[]),s[a].push(o);break;case f.Kind.INLINE_FRAGMENT:if(!R(e,o)||!C(e,o,t))continue;O(e,t,o.selectionSet,s,n);break;case f.Kind.FRAGMENT_SPREAD:var c=o.name.value;if(n[c]||!R(e,o))continue;n[c]=!0;var u=e.fragments[c];if(!u||!C(e,u,t))continue;O(e,t,u.selectionSet,s,n)}}var l;return s}function R(e,t){var r=(0,g.getDirectiveValues)(y.GraphQLSkipDirective,t,e.variableValues);if(r&&!0===r.if)return!1;var s=(0,g.getDirectiveValues)(y.GraphQLIncludeDirective,t,e.variableValues);return!s||!1!==s.if}function C(e,t,r){var s=t.typeCondition;if(!s)return!0;var n=(0,h.typeFromAST)(e.schema,s);return n===r||!!(0,m.isAbstractType)(n)&&e.schema.isPossibleType(n,r)}function N(e,t,r,s,n){var i=s[0].name.value,o=z(e.schema,t,i);if(o){var a=o.resolve||e.fieldResolver,c=P(e,o,s,t,n),u=D(e,o,s,a,r,c);return M(e,o.type,s,c,n,u)}}function P(e,t,r,s,n){return{fieldName:r[0].name.value,fieldNodes:r,returnType:t.type,parentType:s,path:n,schema:e.schema,fragments:e.fragments,rootValue:e.rootValue,operation:e.operation,variableValues:e.variableValues}}function D(e,t,r,s,n,i){try{var o=s(n,(0,g.getArgumentValues)(t,r[0],e.variableValues),e.contextValue,i);return(0,u.default)(o)?o.then(void 0,L):o}catch(e){return L(e)}}function L(e){return e instanceof Error?e:new Error(e||void 0)}function M(e,t,r,s,n,i){if((0,m.isNonNullType)(t))return q(e,t,r,s,n,i);try{var o=q(e,t,r,s,n,i);return(0,u.default)(o)?o.then(void 0,(function(t){return e.errors.push(t),Promise.resolve(null)})):o}catch(t){return e.errors.push(t),null}}function q(e,t,r,s,n,o){try{var a=j(e,t,r,s,n,o);return(0,u.default)(a)?a.then(void 0,(function(e){return Promise.reject((0,i.locatedError)(L(e),r,T(n)))})):a}catch(e){throw(0,i.locatedError)(L(e),r,T(n))}}function j(e,t,r,i,l,p){if((0,u.default)(p))return p.then((function(s){return j(e,t,r,i,l,s)}));if(p instanceof Error)throw p;if((0,m.isNonNullType)(t)){var d=j(e,t.ofType,r,i,l,p);if(null===d)throw new Error("Cannot return null for non-nullable field "+i.parentType.name+"."+i.fieldName+".");return d}if((0,c.default)(p))return null;if((0,m.isListType)(t))return function(e,t,r,s,i,a){(0,n.isCollection)(a)||(0,o.default)(0,"Expected Iterable, but did not find one for field "+s.parentType.name+"."+s.fieldName+".");var c=t.ofType,l=!1,p=[];return(0,n.forEach)(a,(function(t,n){var o=w(i,n),a=M(e,c,r,s,o,t);!l&&(0,u.default)(a)&&(l=!0),p.push(a)})),l?Promise.all(p):p}(e,t,r,i,l,p);if((0,m.isLeafType)(t))return function(e,t){e.serialize||(0,o.default)(0,"Missing serialize method on type");var r=e.serialize(t);if((0,a.default)(r))throw new Error('Expected a value of type "'+String(e)+'" but received: '+String(t));return r}(t,p);if((0,m.isAbstractType)(t))return function(e,t,r,n,i,o){var a=t.resolveType?t.resolveType(o,e.contextValue,n):function(e,t,r,n){if(null!==e&&"object"===(void 0===e?"undefined":s(e))&&"string"==typeof e.__typename)return e.__typename;for(var i=r.schema.getPossibleTypes(n),o=[],a=0;a<i.length;a++){var c=i[a];if(c.isTypeOf){var l=c.isTypeOf(e,t,r);if((0,u.default)(l))o[a]=l;else if(l)return c}}return o.length?Promise.all(o).then((function(e){for(var t=0;t<e.length;t++)if(e[t])return i[t]})):void 0}(o,e.contextValue,n,t);return(0,u.default)(a)?a.then((function(s){return F(e,U(s,e,t,r,n,o),r,n,i,o)})):F(e,U(a,e,t,r,n,o),r,n,i,o)}(e,t,r,i,l,p);if((0,m.isObjectType)(t))return F(e,t,r,i,l,p);throw new Error('Cannot complete value of unexpected type "'+String(t)+'".')}function U(e,t,r,s,n,o){var a="string"==typeof e?t.schema.getType(e):e;if(!(0,m.isObjectType)(a))throw new i.GraphQLError("Abstract type "+r.name+" must resolve to an Object type at runtime for field "+n.parentType.name+"."+n.fieldName+' with value "'+String(o)+'", received "'+String(a)+'". Either the '+r.name+' type should provide a "resolveType" function or each possible types should provide an "isTypeOf" function.',s);if(!t.schema.isPossibleType(r,a))throw new i.GraphQLError('Runtime Object type "'+a.name+'" is not a possible type for "'+r.name+'".',s);return a}function F(e,t,r,s,n,i){if(t.isTypeOf){var o=t.isTypeOf(i,e.contextValue,s);if((0,u.default)(o))return o.then((function(s){if(!s)throw B(t,i,r);return $(e,t,r,0,n,i)}));if(!o)throw B(t,i,r)}return $(e,t,r,0,n,i)}function B(e,t,r){return new i.GraphQLError('Expected value of type "'+e.name+'" but got: '+String(t)+".",r)}function $(e,t,r,s,n,i){return k(e,t,i,n,G(e,t,r))}var G=(0,l.default)((function(e,t,r){for(var s=Object.create(null),n=Object.create(null),i=0;i<r.length;i++){var o=r[i].selectionSet;o&&(s=O(e,t,o,s,n))}return s})),V=t.defaultFieldResolver=function(e,t,r,n){if("object"===(void 0===e?"undefined":s(e))||"function"==typeof e){var i=e[n.fieldName];return"function"==typeof i?e[n.fieldName](t,r,n):i}};function z(e,t,r){return r===_.SchemaMetaFieldDef.name&&e.getQueryType()===t?_.SchemaMetaFieldDef:r===_.TypeMetaFieldDef.name&&e.getQueryType()===t?_.TypeMetaFieldDef:r===_.TypeNameMetaFieldDef.name?_.TypeNameMetaFieldDef:t.getFields()[r]}},98113:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getVariableValues=function(e,t,r){for(var n=[],o={},l=0;l<t.length;l++){var h=t[l],f=h.variable.name.value,g=(0,c.typeFromAST)(e,h.type);if((0,d.isInputType)(g)){var m=r[f];if((0,i.default)(m))(0,d.isNonNullType)(g)?n.push(new s.GraphQLError('Variable "$'+f+'" of required type "'+String(g)+'" was not provided.',[h])):h.defaultValue&&(o[f]=(0,u.valueFromAST)(h.defaultValue,g));else{var _=(0,a.coerceValue)(m,g,h),y=_.errors;y?function(){var e='Variable "$'+f+'" got invalid value '+JSON.stringify(m)+"; ";y.forEach((function(t){t.message=e+t.message})),n.push.apply(n,y)}():o[f]=_.value}}else n.push(new s.GraphQLError('Variable "$'+f+'" expected value of type "'+(0,p.print)(h.type)+'" which cannot be used as an input type.',[h.type]))}return 0===n.length?{errors:void 0,coerced:o}:{errors:n,coerced:void 0}},t.getArgumentValues=f,t.getDirectiveValues=function(e,t,r){var s=t.directives&&(0,n.default)(t.directives,(function(t){return t.name.value===e.name}));if(s)return f(e,s,r)};var s=r(79211),n=h(r(57718)),i=h(r(26166)),o=h(r(94590)),a=r(68707),c=r(6693),u=r(72302),l=r(7030),p=r(70585),d=r(63754);function h(e){return e&&e.__esModule?e:{default:e}}function f(e,t,r){var n={},a=e.args,c=t.arguments;if(!a||!c)return n;for(var h=(0,o.default)(c,(function(e){return e.name.value})),f=0;f<a.length;f++){var g=a[f],m=g.name,_=g.type,y=h[m],b=g.defaultValue;if(y)if(y.value.kind===l.Kind.VARIABLE){var v=y.value.name.value;if(r&&Object.prototype.hasOwnProperty.call(r,v)&&!(0,i.default)(r[v]))n[m]=r[v];else if((0,i.default)(b)){if((0,d.isNonNullType)(_))throw new s.GraphQLError('Argument "'+m+'" of required type "'+String(_)+'" was provided the variable "$'+v+'" which was not provided a runtime value.',[y.value])}else n[m]=b}else{var E=y.value,S=(0,u.valueFromAST)(E,_,r);if((0,i.default)(S))throw new s.GraphQLError('Argument "'+m+'" has invalid value '+(0,p.print)(E)+".",[y.value]);n[m]=S}else if((0,i.default)(b)){if((0,d.isNonNullType)(_))throw new s.GraphQLError('Argument "'+m+'" of required type "'+String(_)+'" was not provided.',[t])}else n[m]=b}return n}},57718:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){for(var r=0;r<e.length;r++)if(t(e[r]))return e[r]}},79527:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=(process,function(e,t){return e instanceof t})},61321:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(!e)throw new Error(t)}},26166:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return void 0===e||e!=e}},72530:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return null==e||e!=e}},97724:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return Boolean(e&&"function"==typeof e.then)}},94590:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return e.reduce((function(e,r){return e[t(r)]=r,e}),Object.create(null))}},65785:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r){return e.reduce((function(e,s){return e[t(s)]=r(s),e}),Object.create(null))}},2104:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=void 0;return function(r,s,n){t||(t=new WeakMap);var i=t.get(r),o=void 0;if(i){if(o=i.get(s)){var a=o.get(n);if(void 0!==a)return a}}else i=new WeakMap,t.set(r,i);o||(o=new WeakMap,i.set(s,o));var c=e.apply(this,arguments);return o.set(n,c),c}}},26380:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.values||function(e){return Object.keys(e).map((function(t){return e[t]}))};t.default=r},69652:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.slice(0,r);return t.reduce((function(e,r,s){return e+(t.length>2?", ":" ")+(s===t.length-1?"or ":"")+r}))};var r=5},34702:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=Object.keys(e),r=t.map((function(t){return e[t]}));return Promise.all(r).then((function(e){return e.reduce((function(e,r,s){return e[t[s]]=r,e}),Object.create(null))}))}},25662:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r){return e.reduce((function(e,r){return(0,n.default)(e)?e.then((function(e){return t(e,r)})):t(e,r)}),r)};var s,n=(s=r(97724))&&s.__esModule?s:{default:s}},81709:(e,t)=>{"use strict";function r(e,t){if(e===t)return 0;var r=void 0,s=void 0,n=[],i=e.toLowerCase(),o=t.toLowerCase(),a=i.length,c=o.length;if(i===o)return 1;for(r=0;r<=a;r++)n[r]=[r];for(s=1;s<=c;s++)n[0][s]=s;for(r=1;r<=a;r++)for(s=1;s<=c;s++){var u=i[r-1]===o[s-1]?0:1;n[r][s]=Math.min(n[r-1][s]+1,n[r][s-1]+1,n[r-1][s-1]+u),r>1&&s>1&&i[r-1]===o[s-2]&&i[r-2]===o[s-1]&&(n[r][s]=Math.min(n[r][s],n[r-2][s-2]+u))}return n[a][c]}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){for(var s=Object.create(null),n=t.length,i=e.length/2,o=0;o<n;o++){var a=r(e,t[o]);a<=Math.max(i,t[o].length/2,1)&&(s[t[o]]=a)}return Object.keys(s).sort((function(e,t){return s[e]-s[t]}))}},37152:(e,t)=>{"use strict";function r(e){for(var t=0;t<e.length&&(" "===e[t]||"\t"===e[t]);)t++;return t}function s(e){return r(e)===e.length}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t=e.split(/\r\n|[\n\r]/g),n=null,i=1;i<t.length;i++){var o=t[i],a=r(o);if(a<o.length&&(null===n||a<n)&&0===(n=a))break}if(n)for(var c=1;c<t.length;c++)t[c]=t[c].slice(n);for(;t.length>0&&s(t[0]);)t.shift();for(;t.length>0&&s(t[t.length-1]);)t.pop();return t.join("\n")}},5919:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DirectiveLocation=Object.freeze({QUERY:"QUERY",MUTATION:"MUTATION",SUBSCRIPTION:"SUBSCRIPTION",FIELD:"FIELD",FRAGMENT_DEFINITION:"FRAGMENT_DEFINITION",FRAGMENT_SPREAD:"FRAGMENT_SPREAD",INLINE_FRAGMENT:"INLINE_FRAGMENT",SCHEMA:"SCHEMA",SCALAR:"SCALAR",OBJECT:"OBJECT",FIELD_DEFINITION:"FIELD_DEFINITION",ARGUMENT_DEFINITION:"ARGUMENT_DEFINITION",INTERFACE:"INTERFACE",UNION:"UNION",ENUM:"ENUM",ENUM_VALUE:"ENUM_VALUE",INPUT_OBJECT:"INPUT_OBJECT",INPUT_FIELD_DEFINITION:"INPUT_FIELD_DEFINITION"})},7030:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Kind=Object.freeze({NAME:"Name",DOCUMENT:"Document",OPERATION_DEFINITION:"OperationDefinition",VARIABLE_DEFINITION:"VariableDefinition",VARIABLE:"Variable",SELECTION_SET:"SelectionSet",FIELD:"Field",ARGUMENT:"Argument",FRAGMENT_SPREAD:"FragmentSpread",INLINE_FRAGMENT:"InlineFragment",FRAGMENT_DEFINITION:"FragmentDefinition",INT:"IntValue",FLOAT:"FloatValue",STRING:"StringValue",BOOLEAN:"BooleanValue",NULL:"NullValue",ENUM:"EnumValue",LIST:"ListValue",OBJECT:"ObjectValue",OBJECT_FIELD:"ObjectField",DIRECTIVE:"Directive",NAMED_TYPE:"NamedType",LIST_TYPE:"ListType",NON_NULL_TYPE:"NonNullType",SCHEMA_DEFINITION:"SchemaDefinition",OPERATION_TYPE_DEFINITION:"OperationTypeDefinition",SCALAR_TYPE_DEFINITION:"ScalarTypeDefinition",OBJECT_TYPE_DEFINITION:"ObjectTypeDefinition",FIELD_DEFINITION:"FieldDefinition",INPUT_VALUE_DEFINITION:"InputValueDefinition",INTERFACE_TYPE_DEFINITION:"InterfaceTypeDefinition",UNION_TYPE_DEFINITION:"UnionTypeDefinition",ENUM_TYPE_DEFINITION:"EnumTypeDefinition",ENUM_VALUE_DEFINITION:"EnumValueDefinition",INPUT_OBJECT_TYPE_DEFINITION:"InputObjectTypeDefinition",SCALAR_TYPE_EXTENSION:"ScalarTypeExtension",OBJECT_TYPE_EXTENSION:"ObjectTypeExtension",INTERFACE_TYPE_EXTENSION:"InterfaceTypeExtension",UNION_TYPE_EXTENSION:"UnionTypeExtension",ENUM_TYPE_EXTENSION:"EnumTypeExtension",INPUT_OBJECT_TYPE_EXTENSION:"InputObjectTypeExtension",DIRECTIVE_DEFINITION:"DirectiveDefinition"})},46083:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TokenKind=void 0,t.createLexer=function(e,t){var r=new p(c.SOF,0,0,0,0,null);return{source:e,options:t,lastToken:r,token:r,line:1,lineStart:0,advance:o,lookahead:a}},t.getTokenDesc=function(e){var t=e.value;return t?e.kind+' "'+t+'"':e.kind};var s,n=r(79211),i=(s=r(37152))&&s.__esModule?s:{default:s};function o(){return this.lastToken=this.token,this.token=this.lookahead()}function a(){var e=this.token;if(e.kind!==c.EOF)do{e=e.next||(e.next=h(this,e))}while(e.kind===c.COMMENT);return e}var c=t.TokenKind=Object.freeze({SOF:"<SOF>",EOF:"<EOF>",BANG:"!",DOLLAR:"$",AMP:"&",PAREN_L:"(",PAREN_R:")",SPREAD:"...",COLON:":",EQUALS:"=",AT:"@",BRACKET_L:"[",BRACKET_R:"]",BRACE_L:"{",PIPE:"|",BRACE_R:"}",NAME:"Name",INT:"Int",FLOAT:"Float",STRING:"String",BLOCK_STRING:"BlockString",COMMENT:"Comment"}),u=String.prototype.charCodeAt,l=String.prototype.slice;function p(e,t,r,s,n,i,o){this.kind=e,this.start=t,this.end=r,this.line=s,this.column=n,this.value=o,this.prev=i,this.next=null}function d(e){return isNaN(e)?c.EOF:e<127?JSON.stringify(String.fromCharCode(e)):'"\\u'+("00"+e.toString(16).toUpperCase()).slice(-4)+'"'}function h(e,t){var r=e.source,s=r.body,o=s.length,a=function(e,t,r){for(var s=e.length,n=t;n<s;){var i=u.call(e,n);if(9===i||32===i||44===i||65279===i)++n;else if(10===i)++n,++r.line,r.lineStart=n;else{if(13!==i)break;10===u.call(e,n+1)?n+=2:++n,++r.line,r.lineStart=n}}return n}(s,t.end,e),h=e.line,m=1+a-e.lineStart;if(a>=o)return new p(c.EOF,o,o,h,m,t);var _=u.call(s,a);if(_<32&&9!==_&&10!==_&&13!==_)throw(0,n.syntaxError)(r,a,"Cannot contain the invalid character "+d(_)+".");switch(_){case 33:return new p(c.BANG,a,a+1,h,m,t);case 35:return function(e,t,r,s,n){var i=e.body,o=void 0,a=t;do{o=u.call(i,++a)}while(null!==o&&(o>31||9===o));return new p(c.COMMENT,t,a,r,s,n,l.call(i,t+1,a))}(r,a,h,m,t);case 36:return new p(c.DOLLAR,a,a+1,h,m,t);case 38:return new p(c.AMP,a,a+1,h,m,t);case 40:return new p(c.PAREN_L,a,a+1,h,m,t);case 41:return new p(c.PAREN_R,a,a+1,h,m,t);case 46:if(46===u.call(s,a+1)&&46===u.call(s,a+2))return new p(c.SPREAD,a,a+3,h,m,t);break;case 58:return new p(c.COLON,a,a+1,h,m,t);case 61:return new p(c.EQUALS,a,a+1,h,m,t);case 64:return new p(c.AT,a,a+1,h,m,t);case 91:return new p(c.BRACKET_L,a,a+1,h,m,t);case 93:return new p(c.BRACKET_R,a,a+1,h,m,t);case 123:return new p(c.BRACE_L,a,a+1,h,m,t);case 124:return new p(c.PIPE,a,a+1,h,m,t);case 125:return new p(c.BRACE_R,a,a+1,h,m,t);case 65:case 66:case 67:case 68:case 69:case 70:case 71:case 72:case 73:case 74:case 75:case 76:case 77:case 78:case 79:case 80:case 81:case 82:case 83:case 84:case 85:case 86:case 87:case 88:case 89:case 90:case 95:case 97:case 98:case 99:case 100:case 101:case 102:case 103:case 104:case 105:case 106:case 107:case 108:case 109:case 110:case 111:case 112:case 113:case 114:case 115:case 116:case 117:case 118:case 119:case 120:case 121:case 122:return function(e,t,r,s,n){for(var i=e.body,o=i.length,a=t+1,d=0;a!==o&&null!==(d=u.call(i,a))&&(95===d||d>=48&&d<=57||d>=65&&d<=90||d>=97&&d<=122);)++a;return new p(c.NAME,t,a,r,s,n,l.call(i,t,a))}(r,a,h,m,t);case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return function(e,t,r,s,i,o){var a=e.body,h=r,g=t,m=!1;if(45===h&&(h=u.call(a,++g)),48===h){if((h=u.call(a,++g))>=48&&h<=57)throw(0,n.syntaxError)(e,g,"Invalid number, unexpected digit after 0: "+d(h)+".")}else g=f(e,g,h),h=u.call(a,g);return 46===h&&(m=!0,h=u.call(a,++g),g=f(e,g,h),h=u.call(a,g)),69!==h&&101!==h||(m=!0,43!==(h=u.call(a,++g))&&45!==h||(h=u.call(a,++g)),g=f(e,g,h)),new p(m?c.FLOAT:c.INT,t,g,s,i,o,l.call(a,t,g))}(r,a,_,h,m,t);case 34:return 34===u.call(s,a+1)&&34===u.call(s,a+2)?function(e,t,r,s,o){for(var a=e.body,h=t+3,f=h,g=0,m="";h<a.length&&null!==(g=u.call(a,h));){if(34===g&&34===u.call(a,h+1)&&34===u.call(a,h+2))return m+=l.call(a,f,h),new p(c.BLOCK_STRING,t,h+3,r,s,o,(0,i.default)(m));if(g<32&&9!==g&&10!==g&&13!==g)throw(0,n.syntaxError)(e,h,"Invalid character within String: "+d(g)+".");92===g&&34===u.call(a,h+1)&&34===u.call(a,h+2)&&34===u.call(a,h+3)?(m+=l.call(a,f,h)+'"""',f=h+=4):++h}throw(0,n.syntaxError)(e,h,"Unterminated string.")}(r,a,h,m,t):function(e,t,r,s,i){for(var o,a,h,f,m=e.body,_=t+1,y=_,b=0,v="";_<m.length&&null!==(b=u.call(m,_))&&10!==b&&13!==b;){if(34===b)return v+=l.call(m,y,_),new p(c.STRING,t,_+1,r,s,i,v);if(b<32&&9!==b)throw(0,n.syntaxError)(e,_,"Invalid character within String: "+d(b)+".");if(++_,92===b){switch(v+=l.call(m,y,_-1),b=u.call(m,_)){case 34:v+='"';break;case 47:v+="/";break;case 92:v+="\\";break;case 98:v+="\b";break;case 102:v+="\f";break;case 110:v+="\n";break;case 114:v+="\r";break;case 116:v+="\t";break;case 117:var E=(o=u.call(m,_+1),a=u.call(m,_+2),h=u.call(m,_+3),f=u.call(m,_+4),g(o)<<12|g(a)<<8|g(h)<<4|g(f));if(E<0)throw(0,n.syntaxError)(e,_,"Invalid character escape sequence: \\u"+m.slice(_+1,_+5)+".");v+=String.fromCharCode(E),_+=4;break;default:throw(0,n.syntaxError)(e,_,"Invalid character escape sequence: \\"+String.fromCharCode(b)+".")}y=++_}}throw(0,n.syntaxError)(e,_,"Unterminated string.")}(r,a,h,m,t)}throw(0,n.syntaxError)(r,a,function(e){return 39===e?"Unexpected single quote character ('), did you mean to use a double quote (\")?":"Cannot parse the unexpected character "+d(e)+"."}(_))}function f(e,t,r){var s=e.body,i=t,o=r;if(o>=48&&o<=57){do{o=u.call(s,++i)}while(o>=48&&o<=57);return i}throw(0,n.syntaxError)(e,i,"Invalid number, expected digit but got: "+d(o)+".")}function g(e){return e>=48&&e<=57?e-48:e>=65&&e<=70?e-55:e>=97&&e<=102?e-87:-1}p.prototype.toJSON=p.prototype.inspect=function(){return{kind:this.kind,value:this.value,line:this.line,column:this.column}}},99530:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getLocation=function(e,t){for(var r=/\r\n|[\n\r]/g,s=1,n=t+1,i=void 0;(i=r.exec(e.body))&&i.index<t;)s+=1,n=t+1-(i.index+i[0].length);return{line:s,column:n}}},50246:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parse=function(e,t){var r="string"==typeof e?new s.Source(e):e;if(!(r instanceof s.Source))throw new TypeError("Must provide Source. Received: "+String(r));return function(e){var t=e.token;Q(e,i.TokenKind.SOF);var r=[];do{r.push(u(e))}while(!Y(e,i.TokenKind.EOF));return{kind:o.Kind.DOCUMENT,definitions:r,loc:z(e,t)}}((0,i.createLexer)(r,t||{}))},t.parseValue=function(e,t){var r="string"==typeof e?new s.Source(e):e,n=(0,i.createLexer)(r,t||{});Q(n,i.TokenKind.SOF);var o=S(n,!1);return Q(n,i.TokenKind.EOF),o},t.parseType=function(e,t){var r="string"==typeof e?new s.Source(e):e,n=(0,i.createLexer)(r,t||{});Q(n,i.TokenKind.SOF);var o=O(n);return Q(n,i.TokenKind.EOF),o},t.parseConstValue=w,t.parseTypeReference=O,t.parseNamedType=R;var s=r(46876),n=r(79211),i=r(46083),o=r(7030),a=r(5919);function c(e){var t=Q(e,i.TokenKind.NAME);return{kind:o.Kind.NAME,value:t.value,loc:z(e,t)}}function u(e){if(K(e,i.TokenKind.NAME))switch(e.token.value){case"query":case"mutation":case"subscription":case"fragment":return l(e);case"schema":case"scalar":case"type":case"interface":case"union":case"enum":case"input":case"extend":case"directive":return C(e)}else{if(K(e,i.TokenKind.BRACE_L))return l(e);if(N(e))return C(e)}throw Z(e)}function l(e){if(K(e,i.TokenKind.NAME))switch(e.token.value){case"query":case"mutation":case"subscription":return p(e);case"fragment":return function(e){var t=e.token;return W(e,"fragment"),e.options.experimentalFragmentVariables?{kind:o.Kind.FRAGMENT_DEFINITION,name:E(e),variableDefinitions:h(e),typeCondition:(W(e,"on"),R(e)),directives:I(e,!1),selectionSet:m(e),loc:z(e,t)}:{kind:o.Kind.FRAGMENT_DEFINITION,name:E(e),typeCondition:(W(e,"on"),R(e)),directives:I(e,!1),selectionSet:m(e),loc:z(e,t)}}(e)}else if(K(e,i.TokenKind.BRACE_L))return p(e);throw Z(e)}function p(e){var t=e.token;if(K(e,i.TokenKind.BRACE_L))return{kind:o.Kind.OPERATION_DEFINITION,operation:"query",name:void 0,variableDefinitions:[],directives:[],selectionSet:m(e),loc:z(e,t)};var r=d(e),s=void 0;return K(e,i.TokenKind.NAME)&&(s=c(e)),{kind:o.Kind.OPERATION_DEFINITION,operation:r,name:s,variableDefinitions:h(e),directives:I(e,!1),selectionSet:m(e),loc:z(e,t)}}function d(e){var t=Q(e,i.TokenKind.NAME);switch(t.value){case"query":return"query";case"mutation":return"mutation";case"subscription":return"subscription"}throw Z(e,t)}function h(e){return K(e,i.TokenKind.PAREN_L)?X(e,i.TokenKind.PAREN_L,f,i.TokenKind.PAREN_R):[]}function f(e){var t=e.token;return{kind:o.Kind.VARIABLE_DEFINITION,variable:g(e),type:(Q(e,i.TokenKind.COLON),O(e)),defaultValue:Y(e,i.TokenKind.EQUALS)?S(e,!0):void 0,loc:z(e,t)}}function g(e){var t=e.token;return Q(e,i.TokenKind.DOLLAR),{kind:o.Kind.VARIABLE,name:c(e),loc:z(e,t)}}function m(e){var t=e.token;return{kind:o.Kind.SELECTION_SET,selections:X(e,i.TokenKind.BRACE_L,_,i.TokenKind.BRACE_R),loc:z(e,t)}}function _(e){return K(e,i.TokenKind.SPREAD)?function(e){var t=e.token;if(Q(e,i.TokenKind.SPREAD),K(e,i.TokenKind.NAME)&&"on"!==e.token.value)return{kind:o.Kind.FRAGMENT_SPREAD,name:E(e),directives:I(e,!1),loc:z(e,t)};var r=void 0;return"on"===e.token.value&&(e.advance(),r=R(e)),{kind:o.Kind.INLINE_FRAGMENT,typeCondition:r,directives:I(e,!1),selectionSet:m(e),loc:z(e,t)}}(e):function(e){var t=e.token,r=c(e),s=void 0,n=void 0;return Y(e,i.TokenKind.COLON)?(s=r,n=c(e)):n=r,{kind:o.Kind.FIELD,alias:s,name:n,arguments:y(e,!1),directives:I(e,!1),selectionSet:K(e,i.TokenKind.BRACE_L)?m(e):void 0,loc:z(e,t)}}(e)}function y(e,t){var r=t?v:b;return K(e,i.TokenKind.PAREN_L)?X(e,i.TokenKind.PAREN_L,r,i.TokenKind.PAREN_R):[]}function b(e){var t=e.token;return{kind:o.Kind.ARGUMENT,name:c(e),value:(Q(e,i.TokenKind.COLON),S(e,!1)),loc:z(e,t)}}function v(e){var t=e.token;return{kind:o.Kind.ARGUMENT,name:c(e),value:(Q(e,i.TokenKind.COLON),w(e)),loc:z(e,t)}}function E(e){if("on"===e.token.value)throw Z(e);return c(e)}function S(e,t){var r=e.token;switch(r.kind){case i.TokenKind.BRACKET_L:return function(e,t){var r=e.token,s=t?w:x;return{kind:o.Kind.LIST,values:J(e,i.TokenKind.BRACKET_L,s,i.TokenKind.BRACKET_R),loc:z(e,r)}}(e,t);case i.TokenKind.BRACE_L:return function(e,t){var r=e.token;Q(e,i.TokenKind.BRACE_L);for(var s=[];!Y(e,i.TokenKind.BRACE_R);)s.push(A(e,t));return{kind:o.Kind.OBJECT,fields:s,loc:z(e,r)}}(e,t);case i.TokenKind.INT:return e.advance(),{kind:o.Kind.INT,value:r.value,loc:z(e,r)};case i.TokenKind.FLOAT:return e.advance(),{kind:o.Kind.FLOAT,value:r.value,loc:z(e,r)};case i.TokenKind.STRING:case i.TokenKind.BLOCK_STRING:return T(e);case i.TokenKind.NAME:return"true"===r.value||"false"===r.value?(e.advance(),{kind:o.Kind.BOOLEAN,value:"true"===r.value,loc:z(e,r)}):"null"===r.value?(e.advance(),{kind:o.Kind.NULL,loc:z(e,r)}):(e.advance(),{kind:o.Kind.ENUM,value:r.value,loc:z(e,r)});case i.TokenKind.DOLLAR:if(!t)return g(e)}throw Z(e)}function T(e){var t=e.token;return e.advance(),{kind:o.Kind.STRING,value:t.value,block:t.kind===i.TokenKind.BLOCK_STRING,loc:z(e,t)}}function w(e){return S(e,!0)}function x(e){return S(e,!1)}function A(e,t){var r=e.token;return{kind:o.Kind.OBJECT_FIELD,name:c(e),value:(Q(e,i.TokenKind.COLON),S(e,t)),loc:z(e,r)}}function I(e,t){for(var r=[];K(e,i.TokenKind.AT);)r.push(k(e,t));return r}function k(e,t){var r=e.token;return Q(e,i.TokenKind.AT),{kind:o.Kind.DIRECTIVE,name:c(e),arguments:y(e,t),loc:z(e,r)}}function O(e){var t=e.token,r=void 0;return Y(e,i.TokenKind.BRACKET_L)?(r=O(e),Q(e,i.TokenKind.BRACKET_R),r={kind:o.Kind.LIST_TYPE,type:r,loc:z(e,t)}):r=R(e),Y(e,i.TokenKind.BANG)?{kind:o.Kind.NON_NULL_TYPE,type:r,loc:z(e,t)}:r}function R(e){var t=e.token;return{kind:o.Kind.NAMED_TYPE,name:c(e),loc:z(e,t)}}function C(e){var t=N(e)?e.lookahead():e.token;if(t.kind===i.TokenKind.NAME)switch(t.value){case"schema":return function(e){var t=e.token;W(e,"schema");var r=I(e,!0),s=X(e,i.TokenKind.BRACE_L,D,i.TokenKind.BRACE_R);return{kind:o.Kind.SCHEMA_DEFINITION,directives:r,operationTypes:s,loc:z(e,t)}}(e);case"scalar":return function(e){var t=e.token,r=P(e);W(e,"scalar");var s=c(e),n=I(e,!0);return{kind:o.Kind.SCALAR_TYPE_DEFINITION,description:r,name:s,directives:n,loc:z(e,t)}}(e);case"type":return function(e){var t=e.token,r=P(e);W(e,"type");var s=c(e),n=L(e),i=I(e,!0),a=M(e);return{kind:o.Kind.OBJECT_TYPE_DEFINITION,description:r,name:s,interfaces:n,directives:i,fields:a,loc:z(e,t)}}(e);case"interface":return function(e){var t=e.token,r=P(e);W(e,"interface");var s=c(e),n=I(e,!0),i=M(e);return{kind:o.Kind.INTERFACE_TYPE_DEFINITION,description:r,name:s,directives:n,fields:i,loc:z(e,t)}}(e);case"union":return function(e){var t=e.token,r=P(e);W(e,"union");var s=c(e),n=I(e,!0),i=F(e);return{kind:o.Kind.UNION_TYPE_DEFINITION,description:r,name:s,directives:n,types:i,loc:z(e,t)}}(e);case"enum":return function(e){var t=e.token,r=P(e);W(e,"enum");var s=c(e),n=I(e,!0),i=B(e);return{kind:o.Kind.ENUM_TYPE_DEFINITION,description:r,name:s,directives:n,values:i,loc:z(e,t)}}(e);case"input":return function(e){var t=e.token,r=P(e);W(e,"input");var s=c(e),n=I(e,!0),i=G(e);return{kind:o.Kind.INPUT_OBJECT_TYPE_DEFINITION,description:r,name:s,directives:n,fields:i,loc:z(e,t)}}(e);case"extend":return function(e){var t=e.lookahead();if(t.kind===i.TokenKind.NAME)switch(t.value){case"scalar":return function(e){var t=e.token;W(e,"extend"),W(e,"scalar");var r=c(e),s=I(e,!0);if(0===s.length)throw Z(e);return{kind:o.Kind.SCALAR_TYPE_EXTENSION,name:r,directives:s,loc:z(e,t)}}(e);case"type":return function(e){var t=e.token;W(e,"extend"),W(e,"type");var r=c(e),s=L(e),n=I(e,!0),i=M(e);if(0===s.length&&0===n.length&&0===i.length)throw Z(e);return{kind:o.Kind.OBJECT_TYPE_EXTENSION,name:r,interfaces:s,directives:n,fields:i,loc:z(e,t)}}(e);case"interface":return function(e){var t=e.token;W(e,"extend"),W(e,"interface");var r=c(e),s=I(e,!0),n=M(e);if(0===s.length&&0===n.length)throw Z(e);return{kind:o.Kind.INTERFACE_TYPE_EXTENSION,name:r,directives:s,fields:n,loc:z(e,t)}}(e);case"union":return function(e){var t=e.token;W(e,"extend"),W(e,"union");var r=c(e),s=I(e,!0),n=F(e);if(0===s.length&&0===n.length)throw Z(e);return{kind:o.Kind.UNION_TYPE_EXTENSION,name:r,directives:s,types:n,loc:z(e,t)}}(e);case"enum":return function(e){var t=e.token;W(e,"extend"),W(e,"enum");var r=c(e),s=I(e,!0),n=B(e);if(0===s.length&&0===n.length)throw Z(e);return{kind:o.Kind.ENUM_TYPE_EXTENSION,name:r,directives:s,values:n,loc:z(e,t)}}(e);case"input":return function(e){var t=e.token;W(e,"extend"),W(e,"input");var r=c(e),s=I(e,!0),n=G(e);if(0===s.length&&0===n.length)throw Z(e);return{kind:o.Kind.INPUT_OBJECT_TYPE_EXTENSION,name:r,directives:s,fields:n,loc:z(e,t)}}(e)}throw Z(e,t)}(e);case"directive":return function(e){var t=e.token,r=P(e);W(e,"directive"),Q(e,i.TokenKind.AT);var s=c(e),n=j(e);W(e,"on");var a=function(e){Y(e,i.TokenKind.PIPE);var t=[];do{t.push(V(e))}while(Y(e,i.TokenKind.PIPE));return t}(e);return{kind:o.Kind.DIRECTIVE_DEFINITION,description:r,name:s,arguments:n,locations:a,loc:z(e,t)}}(e)}throw Z(e,t)}function N(e){return K(e,i.TokenKind.STRING)||K(e,i.TokenKind.BLOCK_STRING)}function P(e){if(N(e))return T(e)}function D(e){var t=e.token,r=d(e);Q(e,i.TokenKind.COLON);var s=R(e);return{kind:o.Kind.OPERATION_TYPE_DEFINITION,operation:r,type:s,loc:z(e,t)}}function L(e){var t=[];if("implements"===e.token.value){e.advance(),Y(e,i.TokenKind.AMP);do{t.push(R(e))}while(Y(e,i.TokenKind.AMP)||e.options.allowLegacySDLImplementsInterfaces&&K(e,i.TokenKind.NAME))}return t}function M(e){return e.options.allowLegacySDLEmptyFields&&K(e,i.TokenKind.BRACE_L)&&e.lookahead().kind===i.TokenKind.BRACE_R?(e.advance(),e.advance(),[]):K(e,i.TokenKind.BRACE_L)?X(e,i.TokenKind.BRACE_L,q,i.TokenKind.BRACE_R):[]}function q(e){var t=e.token,r=P(e),s=c(e),n=j(e);Q(e,i.TokenKind.COLON);var a=O(e),u=I(e,!0);return{kind:o.Kind.FIELD_DEFINITION,description:r,name:s,arguments:n,type:a,directives:u,loc:z(e,t)}}function j(e){return K(e,i.TokenKind.PAREN_L)?X(e,i.TokenKind.PAREN_L,U,i.TokenKind.PAREN_R):[]}function U(e){var t=e.token,r=P(e),s=c(e);Q(e,i.TokenKind.COLON);var n=O(e),a=void 0;Y(e,i.TokenKind.EQUALS)&&(a=w(e));var u=I(e,!0);return{kind:o.Kind.INPUT_VALUE_DEFINITION,description:r,name:s,type:n,defaultValue:a,directives:u,loc:z(e,t)}}function F(e){var t=[];if(Y(e,i.TokenKind.EQUALS)){Y(e,i.TokenKind.PIPE);do{t.push(R(e))}while(Y(e,i.TokenKind.PIPE))}return t}function B(e){return K(e,i.TokenKind.BRACE_L)?X(e,i.TokenKind.BRACE_L,$,i.TokenKind.BRACE_R):[]}function $(e){var t=e.token,r=P(e),s=c(e),n=I(e,!0);return{kind:o.Kind.ENUM_VALUE_DEFINITION,description:r,name:s,directives:n,loc:z(e,t)}}function G(e){return K(e,i.TokenKind.BRACE_L)?X(e,i.TokenKind.BRACE_L,U,i.TokenKind.BRACE_R):[]}function V(e){var t=e.token,r=c(e);if(a.DirectiveLocation.hasOwnProperty(r.value))return r;throw Z(e,t)}function z(e,t){if(!e.options.noLocation)return new H(t,e.lastToken,e.source)}function H(e,t,r){this.start=e.start,this.end=t.end,this.startToken=e,this.endToken=t,this.source=r}function K(e,t){return e.token.kind===t}function Y(e,t){var r=e.token.kind===t;return r&&e.advance(),r}function Q(e,t){var r=e.token;if(r.kind===t)return e.advance(),r;throw(0,n.syntaxError)(e.source,r.start,"Expected "+t+", found "+(0,i.getTokenDesc)(r))}function W(e,t){var r=e.token;if(r.kind===i.TokenKind.NAME&&r.value===t)return e.advance(),r;throw(0,n.syntaxError)(e.source,r.start,'Expected "'+t+'", found '+(0,i.getTokenDesc)(r))}function Z(e,t){var r=t||e.token;return(0,n.syntaxError)(e.source,r.start,"Unexpected "+(0,i.getTokenDesc)(r))}function J(e,t,r,s){Q(e,t);for(var n=[];!Y(e,s);)n.push(r(e));return n}function X(e,t,r,s){Q(e,t);for(var n=[r(e)];!Y(e,s);)n.push(r(e));return n}H.prototype.toJSON=H.prototype.inspect=function(){return{start:this.start,end:this.end}}},70585:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.print=function(e){return(0,s.visit)(e,{leave:n})};var s=r(9111),n={Name:function(e){return e.value},Variable:function(e){return"$"+e.name},Document:function(e){return o(e.definitions,"\n\n")+"\n"},OperationDefinition:function(e){var t=e.operation,r=e.name,s=c("(",o(e.variableDefinitions,", "),")"),n=o(e.directives," "),i=e.selectionSet;return r||n||s||"query"!==t?o([t,o([r,s]),n,i]," "):i},VariableDefinition:function(e){return e.variable+": "+e.type+c(" = ",e.defaultValue)},SelectionSet:function(e){return a(e.selections)},Field:function(e){var t=e.alias,r=e.name,s=e.arguments,n=e.directives,i=e.selectionSet;return o([c("",t,": ")+r+c("(",o(s,", "),")"),o(n," "),i]," ")},Argument:function(e){return e.name+": "+e.value},FragmentSpread:function(e){return"..."+e.name+c(" ",o(e.directives," "))},InlineFragment:function(e){var t=e.typeCondition,r=e.directives,s=e.selectionSet;return o(["...",c("on ",t),o(r," "),s]," ")},FragmentDefinition:function(e){var t=e.name,r=e.typeCondition,s=e.variableDefinitions,n=e.directives,i=e.selectionSet;return"fragment "+t+c("(",o(s,", "),")")+" on "+r+" "+c("",o(n," ")," ")+i},IntValue:function(e){return e.value},FloatValue:function(e){return e.value},StringValue:function(e,t){var r=e.value;return e.block?function(e,t){var r=e.replace(/"""/g,'\\"""');return" "!==e[0]&&"\t"!==e[0]||-1!==e.indexOf("\n")?'"""\n'+(t?r:u(r))+'\n"""':'"""'+r.replace(/"$/,'"\n')+'"""'}(r,"description"===t):JSON.stringify(r)},BooleanValue:function(e){return e.value?"true":"false"},NullValue:function(){return"null"},EnumValue:function(e){return e.value},ListValue:function(e){return"["+o(e.values,", ")+"]"},ObjectValue:function(e){return"{"+o(e.fields,", ")+"}"},ObjectField:function(e){return e.name+": "+e.value},Directive:function(e){return"@"+e.name+c("(",o(e.arguments,", "),")")},NamedType:function(e){return e.name},ListType:function(e){return"["+e.type+"]"},NonNullType:function(e){return e.type+"!"},SchemaDefinition:function(e){var t=e.directives,r=e.operationTypes;return o(["schema",o(t," "),a(r)]," ")},OperationTypeDefinition:function(e){return e.operation+": "+e.type},ScalarTypeDefinition:i((function(e){return o(["scalar",e.name,o(e.directives," ")]," ")})),ObjectTypeDefinition:i((function(e){var t=e.name,r=e.interfaces,s=e.directives,n=e.fields;return o(["type",t,c("implements ",o(r," & ")),o(s," "),a(n)]," ")})),FieldDefinition:i((function(e){var t=e.name,r=e.arguments,s=e.type,n=e.directives;return t+c("(",o(r,", "),")")+": "+s+c(" ",o(n," "))})),InputValueDefinition:i((function(e){var t=e.name,r=e.type,s=e.defaultValue,n=e.directives;return o([t+": "+r,c("= ",s),o(n," ")]," ")})),InterfaceTypeDefinition:i((function(e){var t=e.name,r=e.directives,s=e.fields;return o(["interface",t,o(r," "),a(s)]," ")})),UnionTypeDefinition:i((function(e){var t=e.name,r=e.directives,s=e.types;return o(["union",t,o(r," "),s&&0!==s.length?"= "+o(s," | "):""]," ")})),EnumTypeDefinition:i((function(e){var t=e.name,r=e.directives,s=e.values;return o(["enum",t,o(r," "),a(s)]," ")})),EnumValueDefinition:i((function(e){return o([e.name,o(e.directives," ")]," ")})),InputObjectTypeDefinition:i((function(e){var t=e.name,r=e.directives,s=e.fields;return o(["input",t,o(r," "),a(s)]," ")})),ScalarTypeExtension:function(e){return o(["extend scalar",e.name,o(e.directives," ")]," ")},ObjectTypeExtension:function(e){var t=e.name,r=e.interfaces,s=e.directives,n=e.fields;return o(["extend type",t,c("implements ",o(r," & ")),o(s," "),a(n)]," ")},InterfaceTypeExtension:function(e){var t=e.name,r=e.directives,s=e.fields;return o(["extend interface",t,o(r," "),a(s)]," ")},UnionTypeExtension:function(e){var t=e.name,r=e.directives,s=e.types;return o(["extend union",t,o(r," "),s&&0!==s.length?"= "+o(s," | "):""]," ")},EnumTypeExtension:function(e){var t=e.name,r=e.directives,s=e.values;return o(["extend enum",t,o(r," "),a(s)]," ")},InputObjectTypeExtension:function(e){var t=e.name,r=e.directives,s=e.fields;return o(["extend input",t,o(r," "),a(s)]," ")},DirectiveDefinition:i((function(e){var t=e.name,r=e.arguments,s=e.locations;return"directive @"+t+c("(",o(r,", "),")")+" on "+o(s," | ")}))};function i(e){return function(t){return o([t.description,e(t)],"\n")}}function o(e,t){return e?e.filter((function(e){return e})).join(t||""):""}function a(e){return e&&0!==e.length?"{\n"+u(o(e,"\n"))+"\n}":""}function c(e,t,r){return t?e+t+(r||""):""}function u(e){return e&&"  "+e.replace(/\n/g,"\n  ")}},46876:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Source=void 0;var s,n=(s=r(61321))&&s.__esModule?s:{default:s};t.Source=function e(t,r,s){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.body=t,this.name=r||"GraphQL request",this.locationOffset=s||{line:1,column:1},this.locationOffset.line>0||(0,n.default)(0,"line in locationOffset is 1-indexed and must be positive"),this.locationOffset.column>0||(0,n.default)(0,"column in locationOffset is 1-indexed and must be positive")}},9111:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.visit=function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r,a=void 0,c=Array.isArray(e),u=[e],l=-1,p=[],d=void 0,h=void 0,f=void 0,g=[],m=[],_=e;do{var y=++l===u.length,b=y&&0!==p.length;if(y){if(h=0===m.length?void 0:g[g.length-1],d=f,f=m.pop(),b){if(c)d=d.slice();else{var v={};for(var E in d)d.hasOwnProperty(E)&&(v[E]=d[E]);d=v}for(var S=0,T=0;T<p.length;T++){var w=p[T][0],x=p[T][1];c&&(w-=S),c&&null===x?(d.splice(w,1),S++):d[w]=x}}l=a.index,u=a.keys,p=a.edits,c=a.inArray,a=a.prev}else{if(h=f?c?l:u[l]:void 0,null==(d=f?f[h]:_))continue;f&&g.push(h)}var A=void 0;if(!Array.isArray(d)){if(!n(d))throw new Error("Invalid AST Node: "+JSON.stringify(d));var I=i(t,d.kind,y);if(I){if((A=I.call(t,d,h,f,g,m))===s)break;if(!1===A){if(!y){g.pop();continue}}else if(void 0!==A&&(p.push([h,A]),!y)){if(!n(A)){g.pop();continue}d=A}}}void 0===A&&b&&p.push([h,d]),y?g.pop():(a={inArray:c,index:l,keys:u,edits:p,prev:a},u=(c=Array.isArray(d))?d:o[d.kind]||[],l=-1,p=[],f&&m.push(f),f=d)}while(void 0!==a);return 0!==p.length&&(_=p[p.length-1][1]),_},t.visitInParallel=function(e){var t=new Array(e.length);return{enter:function(r){for(var n=0;n<e.length;n++)if(!t[n]){var o=i(e[n],r.kind,!1);if(o){var a=o.apply(e[n],arguments);if(!1===a)t[n]=r;else if(a===s)t[n]=s;else if(void 0!==a)return a}}},leave:function(r){for(var n=0;n<e.length;n++)if(t[n])t[n]===r&&(t[n]=null);else{var o=i(e[n],r.kind,!0);if(o){var a=o.apply(e[n],arguments);if(a===s)t[n]=s;else if(void 0!==a&&!1!==a)return a}}}}},t.visitWithTypeInfo=function(e,t){return{enter:function(r){e.enter(r);var s=i(t,r.kind,!1);if(s){var o=s.apply(t,arguments);return void 0!==o&&(e.leave(r),n(o)&&e.enter(o)),o}},leave:function(r){var s=i(t,r.kind,!0),n=void 0;return s&&(n=s.apply(t,arguments)),e.leave(r),n}}},t.getVisitFn=i;var r=t.QueryDocumentKeys={Name:[],Document:["definitions"],OperationDefinition:["name","variableDefinitions","directives","selectionSet"],VariableDefinition:["variable","type","defaultValue"],Variable:["name"],SelectionSet:["selections"],Field:["alias","name","arguments","directives","selectionSet"],Argument:["name","value"],FragmentSpread:["name","directives"],InlineFragment:["typeCondition","directives","selectionSet"],FragmentDefinition:["name","variableDefinitions","typeCondition","directives","selectionSet"],IntValue:[],FloatValue:[],StringValue:[],BooleanValue:[],NullValue:[],EnumValue:[],ListValue:["values"],ObjectValue:["fields"],ObjectField:["name","value"],Directive:["name","arguments"],NamedType:["name"],ListType:["type"],NonNullType:["type"],SchemaDefinition:["directives","operationTypes"],OperationTypeDefinition:["type"],ScalarTypeDefinition:["description","name","directives"],ObjectTypeDefinition:["description","name","interfaces","directives","fields"],FieldDefinition:["description","name","arguments","type","directives"],InputValueDefinition:["description","name","type","defaultValue","directives"],InterfaceTypeDefinition:["description","name","directives","fields"],UnionTypeDefinition:["description","name","directives","types"],EnumTypeDefinition:["description","name","directives","values"],EnumValueDefinition:["description","name","directives"],InputObjectTypeDefinition:["description","name","directives","fields"],ScalarTypeExtension:["name","directives"],ObjectTypeExtension:["name","interfaces","directives","fields"],InterfaceTypeExtension:["name","directives","fields"],UnionTypeExtension:["name","directives","types"],EnumTypeExtension:["name","directives","values"],InputObjectTypeExtension:["name","directives","fields"],DirectiveDefinition:["description","name","arguments","locations"]},s=t.BREAK={};function n(e){return Boolean(e&&"string"==typeof e.kind)}function i(e,t,r){var s=e[t];if(s){if(!r&&"function"==typeof s)return s;var n=r?s.leave:s.enter;if("function"==typeof n)return n}else{var i=r?e.leave:e.enter;if(i){if("function"==typeof i)return i;var o=i[t];if("function"==typeof o)return o}}}},63754:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GraphQLInputObjectType=t.GraphQLEnumType=t.GraphQLUnionType=t.GraphQLInterfaceType=t.GraphQLObjectType=t.GraphQLScalarType=void 0;var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e};t.isType=d,t.assertType=h,t.isScalarType=f,t.assertScalarType=function(e){return f(e)||(0,o.default)(0,"Expected "+String(e)+" to be a GraphQL Scalar type."),e},t.isObjectType=g,t.assertObjectType=function(e){return g(e)||(0,o.default)(0,"Expected "+String(e)+" to be a GraphQL Object type."),e},t.isInterfaceType=m,t.assertInterfaceType=function(e){return m(e)||(0,o.default)(0,"Expected "+String(e)+" to be a GraphQL Interface type."),e},t.isUnionType=_,t.assertUnionType=function(e){return _(e)||(0,o.default)(0,"Expected "+String(e)+" to be a GraphQL Union type."),e},t.isEnumType=y,t.assertEnumType=function(e){return y(e)||(0,o.default)(0,"Expected "+String(e)+" to be a GraphQL Enum type."),e},t.isInputObjectType=b,t.assertInputObjectType=function(e){return b(e)||(0,o.default)(0,"Expected "+String(e)+" to be a GraphQL Input Object type."),e},t.isListType=v,t.assertListType=function(e){return v(e)||(0,o.default)(0,"Expected "+String(e)+" to be a GraphQL List type."),e},t.isNonNullType=E,t.assertNonNullType=function(e){return E(e)||(0,o.default)(0,"Expected "+String(e)+" to be a GraphQL Non-Null type."),e},t.isInputType=S,t.assertInputType=function(e){return S(e)||(0,o.default)(0,"Expected "+String(e)+" to be a GraphQL input type."),e},t.isOutputType=T,t.assertOutputType=function(e){return T(e)||(0,o.default)(0,"Expected "+String(e)+" to be a GraphQL output type."),e},t.isLeafType=w,t.assertLeafType=function(e){return w(e)||(0,o.default)(0,"Expected "+String(e)+" to be a GraphQL leaf type."),e},t.isCompositeType=x,t.assertCompositeType=function(e){return x(e)||(0,o.default)(0,"Expected "+String(e)+" to be a GraphQL composite type."),e},t.isAbstractType=A,t.assertAbstractType=function(e){return A(e)||(0,o.default)(0,"Expected "+String(e)+" to be a GraphQL abstract type."),e},t.GraphQLList=I,t.GraphQLNonNull=O,t.isWrappingType=C,t.assertWrappingType=function(e){return C(e)||(0,o.default)(0,"Expected "+String(e)+" to be a GraphQL wrapping type."),e},t.isNullableType=N,t.assertNullableType=P,t.getNullableType=function(e){if(e)return E(e)?e.ofType:e},t.isNamedType=D,t.assertNamedType=function(e){return D(e)||(0,o.default)(0,"Expected "+String(e)+" to be a GraphQL named type."),e},t.getNamedType=function(e){if(e){for(var t=e;C(t);)t=t.ofType;return t}};var i=l(r(79527)),o=l(r(61321)),a=l(r(26166)),c=r(7030),u=r(78805);function l(e){return e&&e.__esModule?e:{default:e}}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e){return f(e)||g(e)||m(e)||_(e)||y(e)||b(e)||v(e)||E(e)}function h(e){return d(e)||(0,o.default)(0,"Expected "+String(e)+" to be a GraphQL type."),e}function f(e){return(0,i.default)(e,M)}function g(e){return(0,i.default)(e,q)}function m(e){return(0,i.default)(e,F)}function _(e){return(0,i.default)(e,B)}function y(e){return(0,i.default)(e,$)}function b(e){return(0,i.default)(e,G)}function v(e){return(0,i.default)(e,I)}function E(e){return(0,i.default)(e,O)}function S(e){return f(e)||y(e)||b(e)||C(e)&&S(e.ofType)}function T(e){return f(e)||g(e)||m(e)||_(e)||y(e)||C(e)&&T(e.ofType)}function w(e){return f(e)||y(e)}function x(e){return g(e)||m(e)||_(e)}function A(e){return m(e)||_(e)}function I(e){if(!(this instanceof I))return new I(e);this.ofType=h(e)}var k=I.prototype;function O(e){if(!(this instanceof O))return new O(e);this.ofType=P(e)}k.toString=k.toJSON=k.inspect=function(){return"["+String(this.ofType)+"]"};var R=O.prototype;function C(e){return v(e)||E(e)}function N(e){return d(e)&&!E(e)}function P(e){return N(e)||(0,o.default)(0,"Expected "+String(e)+" to be a GraphQL nullable type."),e}function D(e){return f(e)||g(e)||m(e)||_(e)||y(e)||b(e)}function L(e){return"function"==typeof e?e():e}R.toString=R.toJSON=R.inspect=function(){return String(this.ofType)+"!"};var M=t.GraphQLScalarType=function(){function e(t){p(this,e),this.name=t.name,this.description=t.description,this.astNode=t.astNode,this._scalarConfig=t,"string"!=typeof t.name&&(0,o.default)(0,"Must provide name."),"function"!=typeof t.serialize&&(0,o.default)(0,this.name+' must provide "serialize" function. If this custom Scalar is also used as an input type, ensure "parseValue" and "parseLiteral" functions are also provided.'),(t.parseValue||t.parseLiteral)&&("function"!=typeof t.parseValue||"function"!=typeof t.parseLiteral)&&(0,o.default)(0,this.name+' must provide both "parseValue" and "parseLiteral" functions.')}return e.prototype.serialize=function(e){return(0,this._scalarConfig.serialize)(e)},e.prototype.parseValue=function(e){var t=this._scalarConfig.parseValue;if(!(0,a.default)(e))return t?t(e):e},e.prototype.parseLiteral=function(e,t){var r=this._scalarConfig.parseLiteral;return r?r(e,t):(0,u.valueFromASTUntyped)(e,t)},e.prototype.toString=function(){return this.name},e}();M.prototype.toJSON=M.prototype.inspect=M.prototype.toString;var q=t.GraphQLObjectType=function(){function e(t){p(this,e),this.name=t.name,this.description=t.description,this.astNode=t.astNode,this.extensionASTNodes=t.extensionASTNodes,this.isTypeOf=t.isTypeOf,this._typeConfig=t,"string"!=typeof t.name&&(0,o.default)(0,"Must provide name."),t.isTypeOf&&"function"!=typeof t.isTypeOf&&(0,o.default)(0,this.name+' must provide "isTypeOf" as a function.')}return e.prototype.getFields=function(){return this._fields||(this._fields=j(this,this._typeConfig.fields))},e.prototype.getInterfaces=function(){return this._interfaces||(this._interfaces=(e=L(this._typeConfig.interfaces)||[],Array.isArray(e)||(0,o.default)(0,this.name+" interfaces must be an Array or a function which returns an Array."),e));var e},e.prototype.toString=function(){return this.name},e}();function j(e,t){var r=L(t)||{};U(r)||(0,o.default)(0,e.name+" fields must be an object with field names as keys or a function which returns such an object.");var s=Object.create(null);return Object.keys(r).forEach((function(t){var i=r[t];U(i)||(0,o.default)(0,e.name+"."+t+" field config must be an object"),i.hasOwnProperty("isDeprecated")&&(0,o.default)(0,e.name+"."+t+' should provide "deprecationReason" instead of "isDeprecated".');var a,c=n({},i,{isDeprecated:Boolean(i.deprecationReason),name:t});null!=(a=c.resolve)&&"function"!=typeof a&&(0,o.default)(0,e.name+"."+t+" field resolver must be a function if provided, but got: "+String(c.resolve)+".");var u=i.args;u?(U(u)||(0,o.default)(0,e.name+"."+t+" args must be an object with argument names as keys."),c.args=Object.keys(u).map((function(e){var t=u[e];return{name:e,description:void 0===t.description?null:t.description,type:t.type,defaultValue:t.defaultValue,astNode:t.astNode}}))):c.args=[],s[t]=c})),s}function U(e){return e&&"object"===(void 0===e?"undefined":s(e))&&!Array.isArray(e)}q.prototype.toJSON=q.prototype.inspect=q.prototype.toString;var F=t.GraphQLInterfaceType=function(){function e(t){p(this,e),this.name=t.name,this.description=t.description,this.astNode=t.astNode,this.extensionASTNodes=t.extensionASTNodes,this.resolveType=t.resolveType,this._typeConfig=t,"string"!=typeof t.name&&(0,o.default)(0,"Must provide name."),t.resolveType&&"function"!=typeof t.resolveType&&(0,o.default)(0,this.name+' must provide "resolveType" as a function.')}return e.prototype.getFields=function(){return this._fields||(this._fields=j(this,this._typeConfig.fields))},e.prototype.toString=function(){return this.name},e}();F.prototype.toJSON=F.prototype.inspect=F.prototype.toString;var B=t.GraphQLUnionType=function(){function e(t){p(this,e),this.name=t.name,this.description=t.description,this.astNode=t.astNode,this.resolveType=t.resolveType,this._typeConfig=t,"string"!=typeof t.name&&(0,o.default)(0,"Must provide name."),t.resolveType&&"function"!=typeof t.resolveType&&(0,o.default)(0,this.name+' must provide "resolveType" as a function.')}return e.prototype.getTypes=function(){return this._types||(this._types=(e=L(this._typeConfig.types)||[],Array.isArray(e)||(0,o.default)(0,"Must provide Array of types or a function which returns such an array for Union "+this.name+"."),e));var e},e.prototype.toString=function(){return this.name},e}();B.prototype.toJSON=B.prototype.inspect=B.prototype.toString;var $=t.GraphQLEnumType=function(){function e(t){p(this,e),this.name=t.name,this.description=t.description,this.astNode=t.astNode,this._enumConfig=t,"string"!=typeof t.name&&(0,o.default)(0,"Must provide name.")}return e.prototype.getValues=function(){return this._values||(this._values=(e=this,U(t=this._enumConfig.values)||(0,o.default)(0,e.name+" values must be an object with value names as keys."),Object.keys(t).map((function(r){var s=t[r];return U(s)||(0,o.default)(0,e.name+"."+r+' must refer to an object with a "value" key representing an internal value but got: '+String(s)+"."),s.hasOwnProperty("isDeprecated")&&(0,o.default)(0,e.name+"."+r+' should provide "deprecationReason" instead of "isDeprecated".'),{name:r,description:s.description,isDeprecated:Boolean(s.deprecationReason),deprecationReason:s.deprecationReason,astNode:s.astNode,value:s.hasOwnProperty("value")?s.value:r}}))));var e,t},e.prototype.getValue=function(e){return this._getNameLookup()[e]},e.prototype.serialize=function(e){var t=this._getValueLookup().get(e);if(t)return t.name},e.prototype.parseValue=function(e){if("string"==typeof e){var t=this._getNameLookup()[e];if(t)return t.value}},e.prototype.parseLiteral=function(e,t){if(e.kind===c.Kind.ENUM){var r=this._getNameLookup()[e.value];if(r)return r.value}},e.prototype._getValueLookup=function(){if(!this._valueLookup){var e=new Map;this.getValues().forEach((function(t){e.set(t.value,t)})),this._valueLookup=e}return this._valueLookup},e.prototype._getNameLookup=function(){if(!this._nameLookup){var e=Object.create(null);this.getValues().forEach((function(t){e[t.name]=t})),this._nameLookup=e}return this._nameLookup},e.prototype.toString=function(){return this.name},e}();$.prototype.toJSON=$.prototype.inspect=$.prototype.toString;var G=t.GraphQLInputObjectType=function(){function e(t){p(this,e),this.name=t.name,this.description=t.description,this.astNode=t.astNode,this._typeConfig=t,"string"!=typeof t.name&&(0,o.default)(0,"Must provide name.")}return e.prototype.getFields=function(){return this._fields||(this._fields=this._defineFieldMap())},e.prototype._defineFieldMap=function(){var e=this,t=L(this._typeConfig.fields)||{};U(t)||(0,o.default)(0,this.name+" fields must be an object with field names as keys or a function which returns such an object.");var r=Object.create(null);return Object.keys(t).forEach((function(s){var i=n({},t[s],{name:s});i.hasOwnProperty("resolve")&&(0,o.default)(0,e.name+"."+s+" field type has a resolve property, but Input Types cannot define resolvers."),r[s]=i})),r},e.prototype.toString=function(){return this.name},e}();G.prototype.toJSON=G.prototype.toString,G.prototype.inspect=G.prototype.toString},38685:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.specifiedDirectives=t.GraphQLDeprecatedDirective=t.DEFAULT_DEPRECATION_REASON=t.GraphQLSkipDirective=t.GraphQLIncludeDirective=t.GraphQLDirective=void 0,t.isDirective=function(e){return(0,i.default)(e,u)},t.isSpecifiedDirective=function(e){return f.some((function(t){return t.name===e.name}))};var s=r(63754),n=r(11062),i=c(r(79527)),o=c(r(61321)),a=r(5919);function c(e){return e&&e.__esModule?e:{default:e}}var u=t.GraphQLDirective=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=t.name,this.description=t.description,this.locations=t.locations,this.astNode=t.astNode,t.name||(0,o.default)(0,"Directive must be named."),Array.isArray(t.locations)||(0,o.default)(0,"Must provide locations for directive.");var r=t.args;r?(Array.isArray(r)&&(0,o.default)(0,"@"+t.name+" args must be an object with argument names as keys."),this.args=Object.keys(r).map((function(e){var t=r[e];return{name:e,description:void 0===t.description?null:t.description,type:t.type,defaultValue:t.defaultValue,astNode:t.astNode}}))):this.args=[]},l=t.GraphQLIncludeDirective=new u({name:"include",description:"Directs the executor to include this field or fragment only when the `if` argument is true.",locations:[a.DirectiveLocation.FIELD,a.DirectiveLocation.FRAGMENT_SPREAD,a.DirectiveLocation.INLINE_FRAGMENT],args:{if:{type:(0,s.GraphQLNonNull)(n.GraphQLBoolean),description:"Included when true."}}}),p=t.GraphQLSkipDirective=new u({name:"skip",description:"Directs the executor to skip this field or fragment when the `if` argument is true.",locations:[a.DirectiveLocation.FIELD,a.DirectiveLocation.FRAGMENT_SPREAD,a.DirectiveLocation.INLINE_FRAGMENT],args:{if:{type:(0,s.GraphQLNonNull)(n.GraphQLBoolean),description:"Skipped when true."}}}),d=t.DEFAULT_DEPRECATION_REASON="No longer supported",h=t.GraphQLDeprecatedDirective=new u({name:"deprecated",description:"Marks an element of a GraphQL schema as no longer supported.",locations:[a.DirectiveLocation.FIELD_DEFINITION,a.DirectiveLocation.ENUM_VALUE],args:{reason:{type:n.GraphQLString,description:"Explains why this element was deprecated, usually also including a suggestion for how to access supported similar data. Formatted in [Markdown](https://daringfireball.net/projects/markdown/).",defaultValue:d}}}),f=t.specifiedDirectives=[l,p,h]},8364:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.introspectionTypes=t.TypeNameMetaFieldDef=t.TypeMetaFieldDef=t.SchemaMetaFieldDef=t.__TypeKind=t.TypeKind=t.__EnumValue=t.__InputValue=t.__Field=t.__Type=t.__DirectiveLocation=t.__Directive=t.__Schema=void 0,t.isIntrospectionType=function(e){return(0,a.isNamedType)(e)&&(e.name===p.name||e.name===d.name||e.name===h.name||e.name===f.name||e.name===g.name||e.name===m.name||e.name===_.name||e.name===b.name)};var s=l(r(26166)),n=l(r(26380)),i=r(38096),o=r(70585),a=r(63754),c=r(11062),u=r(5919);function l(e){return e&&e.__esModule?e:{default:e}}var p=t.__Schema=new a.GraphQLObjectType({name:"__Schema",isIntrospection:!0,description:"A GraphQL Schema defines the capabilities of a GraphQL server. It exposes all available types and directives on the server, as well as the entry points for query, mutation, and subscription operations.",fields:function(){return{types:{description:"A list of all types supported by this server.",type:(0,a.GraphQLNonNull)((0,a.GraphQLList)((0,a.GraphQLNonNull)(f))),resolve:function(e){return(0,n.default)(e.getTypeMap())}},queryType:{description:"The type that query operations will be rooted at.",type:(0,a.GraphQLNonNull)(f),resolve:function(e){return e.getQueryType()}},mutationType:{description:"If this server supports mutation, the type that mutation operations will be rooted at.",type:f,resolve:function(e){return e.getMutationType()}},subscriptionType:{description:"If this server support subscription, the type that subscription operations will be rooted at.",type:f,resolve:function(e){return e.getSubscriptionType()}},directives:{description:"A list of all directives supported by this server.",type:(0,a.GraphQLNonNull)((0,a.GraphQLList)((0,a.GraphQLNonNull)(d))),resolve:function(e){return e.getDirectives()}}}}}),d=t.__Directive=new a.GraphQLObjectType({name:"__Directive",isIntrospection:!0,description:"A Directive provides a way to describe alternate runtime execution and type validation behavior in a GraphQL document.\n\nIn some cases, you need to provide options to alter GraphQL's execution behavior in ways field arguments will not suffice, such as conditionally including or skipping a field. Directives provide this by describing additional information to the executor.",fields:function(){return{name:{type:(0,a.GraphQLNonNull)(c.GraphQLString)},description:{type:c.GraphQLString},locations:{type:(0,a.GraphQLNonNull)((0,a.GraphQLList)((0,a.GraphQLNonNull)(h)))},args:{type:(0,a.GraphQLNonNull)((0,a.GraphQLList)((0,a.GraphQLNonNull)(m))),resolve:function(e){return e.args||[]}},onOperation:{deprecationReason:"Use `locations`.",type:(0,a.GraphQLNonNull)(c.GraphQLBoolean),resolve:function(e){return-1!==e.locations.indexOf(u.DirectiveLocation.QUERY)||-1!==e.locations.indexOf(u.DirectiveLocation.MUTATION)||-1!==e.locations.indexOf(u.DirectiveLocation.SUBSCRIPTION)}},onFragment:{deprecationReason:"Use `locations`.",type:(0,a.GraphQLNonNull)(c.GraphQLBoolean),resolve:function(e){return-1!==e.locations.indexOf(u.DirectiveLocation.FRAGMENT_SPREAD)||-1!==e.locations.indexOf(u.DirectiveLocation.INLINE_FRAGMENT)||-1!==e.locations.indexOf(u.DirectiveLocation.FRAGMENT_DEFINITION)}},onField:{deprecationReason:"Use `locations`.",type:(0,a.GraphQLNonNull)(c.GraphQLBoolean),resolve:function(e){return-1!==e.locations.indexOf(u.DirectiveLocation.FIELD)}}}}}),h=t.__DirectiveLocation=new a.GraphQLEnumType({name:"__DirectiveLocation",isIntrospection:!0,description:"A Directive can be adjacent to many parts of the GraphQL language, a __DirectiveLocation describes one such possible adjacencies.",values:{QUERY:{value:u.DirectiveLocation.QUERY,description:"Location adjacent to a query operation."},MUTATION:{value:u.DirectiveLocation.MUTATION,description:"Location adjacent to a mutation operation."},SUBSCRIPTION:{value:u.DirectiveLocation.SUBSCRIPTION,description:"Location adjacent to a subscription operation."},FIELD:{value:u.DirectiveLocation.FIELD,description:"Location adjacent to a field."},FRAGMENT_DEFINITION:{value:u.DirectiveLocation.FRAGMENT_DEFINITION,description:"Location adjacent to a fragment definition."},FRAGMENT_SPREAD:{value:u.DirectiveLocation.FRAGMENT_SPREAD,description:"Location adjacent to a fragment spread."},INLINE_FRAGMENT:{value:u.DirectiveLocation.INLINE_FRAGMENT,description:"Location adjacent to an inline fragment."},SCHEMA:{value:u.DirectiveLocation.SCHEMA,description:"Location adjacent to a schema definition."},SCALAR:{value:u.DirectiveLocation.SCALAR,description:"Location adjacent to a scalar definition."},OBJECT:{value:u.DirectiveLocation.OBJECT,description:"Location adjacent to an object type definition."},FIELD_DEFINITION:{value:u.DirectiveLocation.FIELD_DEFINITION,description:"Location adjacent to a field definition."},ARGUMENT_DEFINITION:{value:u.DirectiveLocation.ARGUMENT_DEFINITION,description:"Location adjacent to an argument definition."},INTERFACE:{value:u.DirectiveLocation.INTERFACE,description:"Location adjacent to an interface definition."},UNION:{value:u.DirectiveLocation.UNION,description:"Location adjacent to a union definition."},ENUM:{value:u.DirectiveLocation.ENUM,description:"Location adjacent to an enum definition."},ENUM_VALUE:{value:u.DirectiveLocation.ENUM_VALUE,description:"Location adjacent to an enum value definition."},INPUT_OBJECT:{value:u.DirectiveLocation.INPUT_OBJECT,description:"Location adjacent to an input object type definition."},INPUT_FIELD_DEFINITION:{value:u.DirectiveLocation.INPUT_FIELD_DEFINITION,description:"Location adjacent to an input object field definition."}}}),f=t.__Type=new a.GraphQLObjectType({name:"__Type",isIntrospection:!0,description:"The fundamental unit of any GraphQL Schema is the type. There are many kinds of types in GraphQL as represented by the `__TypeKind` enum.\n\nDepending on the kind of a type, certain fields describe information about that type. Scalar types provide no information beyond a name and description, while Enum types provide their values. Object and Interface types provide the fields they describe. Abstract types, Union and Interface, provide the Object types possible at runtime. List and NonNull types compose other types.",fields:function(){return{kind:{type:(0,a.GraphQLNonNull)(b),resolve:function(e){if((0,a.isScalarType)(e))return y.SCALAR;if((0,a.isObjectType)(e))return y.OBJECT;if((0,a.isInterfaceType)(e))return y.INTERFACE;if((0,a.isUnionType)(e))return y.UNION;if((0,a.isEnumType)(e))return y.ENUM;if((0,a.isInputObjectType)(e))return y.INPUT_OBJECT;if((0,a.isListType)(e))return y.LIST;if((0,a.isNonNullType)(e))return y.NON_NULL;throw new Error("Unknown kind of type: "+e)}},name:{type:c.GraphQLString},description:{type:c.GraphQLString},fields:{type:(0,a.GraphQLList)((0,a.GraphQLNonNull)(g)),args:{includeDeprecated:{type:c.GraphQLBoolean,defaultValue:!1}},resolve:function(e,t){var r=t.includeDeprecated;if((0,a.isObjectType)(e)||(0,a.isInterfaceType)(e)){var s=(0,n.default)(e.getFields());return r||(s=s.filter((function(e){return!e.deprecationReason}))),s}return null}},interfaces:{type:(0,a.GraphQLList)((0,a.GraphQLNonNull)(f)),resolve:function(e){if((0,a.isObjectType)(e))return e.getInterfaces()}},possibleTypes:{type:(0,a.GraphQLList)((0,a.GraphQLNonNull)(f)),resolve:function(e,t,r,s){var n=s.schema;if((0,a.isAbstractType)(e))return n.getPossibleTypes(e)}},enumValues:{type:(0,a.GraphQLList)((0,a.GraphQLNonNull)(_)),args:{includeDeprecated:{type:c.GraphQLBoolean,defaultValue:!1}},resolve:function(e,t){var r=t.includeDeprecated;if((0,a.isEnumType)(e)){var s=e.getValues();return r||(s=s.filter((function(e){return!e.deprecationReason}))),s}}},inputFields:{type:(0,a.GraphQLList)((0,a.GraphQLNonNull)(m)),resolve:function(e){if((0,a.isInputObjectType)(e))return(0,n.default)(e.getFields())}},ofType:{type:f}}}}),g=t.__Field=new a.GraphQLObjectType({name:"__Field",isIntrospection:!0,description:"Object and Interface types are described by a list of Fields, each of which has a name, potentially a list of arguments, and a return type.",fields:function(){return{name:{type:(0,a.GraphQLNonNull)(c.GraphQLString)},description:{type:c.GraphQLString},args:{type:(0,a.GraphQLNonNull)((0,a.GraphQLList)((0,a.GraphQLNonNull)(m))),resolve:function(e){return e.args||[]}},type:{type:(0,a.GraphQLNonNull)(f)},isDeprecated:{type:(0,a.GraphQLNonNull)(c.GraphQLBoolean)},deprecationReason:{type:c.GraphQLString}}}}),m=t.__InputValue=new a.GraphQLObjectType({name:"__InputValue",isIntrospection:!0,description:"Arguments provided to Fields or Directives and the input fields of an InputObject are represented as Input Values which describe their type and optionally a default value.",fields:function(){return{name:{type:(0,a.GraphQLNonNull)(c.GraphQLString)},description:{type:c.GraphQLString},type:{type:(0,a.GraphQLNonNull)(f)},defaultValue:{type:c.GraphQLString,description:"A GraphQL-formatted string representing the default value for this input value.",resolve:function(e){return(0,s.default)(e.defaultValue)?null:(0,o.print)((0,i.astFromValue)(e.defaultValue,e.type))}}}}}),_=t.__EnumValue=new a.GraphQLObjectType({name:"__EnumValue",isIntrospection:!0,description:"One possible value for a given Enum. Enum values are unique values, not a placeholder for a string or numeric value. However an Enum value is returned in a JSON response as a string.",fields:function(){return{name:{type:(0,a.GraphQLNonNull)(c.GraphQLString)},description:{type:c.GraphQLString},isDeprecated:{type:(0,a.GraphQLNonNull)(c.GraphQLBoolean)},deprecationReason:{type:c.GraphQLString}}}}),y=t.TypeKind={SCALAR:"SCALAR",OBJECT:"OBJECT",INTERFACE:"INTERFACE",UNION:"UNION",ENUM:"ENUM",INPUT_OBJECT:"INPUT_OBJECT",LIST:"LIST",NON_NULL:"NON_NULL"},b=t.__TypeKind=new a.GraphQLEnumType({name:"__TypeKind",isIntrospection:!0,description:"An enum describing what kind of type a given `__Type` is.",values:{SCALAR:{value:y.SCALAR,description:"Indicates this type is a scalar."},OBJECT:{value:y.OBJECT,description:"Indicates this type is an object. `fields` and `interfaces` are valid fields."},INTERFACE:{value:y.INTERFACE,description:"Indicates this type is an interface. `fields` and `possibleTypes` are valid fields."},UNION:{value:y.UNION,description:"Indicates this type is a union. `possibleTypes` is a valid field."},ENUM:{value:y.ENUM,description:"Indicates this type is an enum. `enumValues` is a valid field."},INPUT_OBJECT:{value:y.INPUT_OBJECT,description:"Indicates this type is an input object. `inputFields` is a valid field."},LIST:{value:y.LIST,description:"Indicates this type is a list. `ofType` is a valid field."},NON_NULL:{value:y.NON_NULL,description:"Indicates this type is a non-null. `ofType` is a valid field."}}});t.SchemaMetaFieldDef={name:"__schema",type:(0,a.GraphQLNonNull)(p),description:"Access the current type schema of this server.",args:[],resolve:function(e,t,r,s){return s.schema}},t.TypeMetaFieldDef={name:"__type",type:f,description:"Request the type information of a single type.",args:[{name:"name",type:(0,a.GraphQLNonNull)(c.GraphQLString)}],resolve:function(e,t,r,s){var n=t.name;return s.schema.getType(n)}},t.TypeNameMetaFieldDef={name:"__typename",type:(0,a.GraphQLNonNull)(c.GraphQLString),description:"The name of the current Object type at runtime.",args:[],resolve:function(e,t,r,s){return s.parentType.name}},t.introspectionTypes=[p,d,h,f,g,m,_,b]},11062:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.specifiedScalarTypes=t.GraphQLID=t.GraphQLBoolean=t.GraphQLString=t.GraphQLFloat=t.GraphQLInt=void 0,t.isSpecifiedScalarType=function(e){return(0,s.isNamedType)(e)&&(e.name===d.name||e.name===c.name||e.name===l.name||e.name===h.name||e.name===f.name)};var s=r(63754),n=r(7030),i=2147483647,o=-2147483648;function a(e){if(""===e)throw new TypeError("Int cannot represent non 32-bit signed integer value: (empty string)");var t=Number(e);if(t!=t||t>i||t<o)throw new TypeError("Int cannot represent non 32-bit signed integer value: "+String(e));var r=Math.floor(t);if(r!==t)throw new TypeError("Int cannot represent non-integer value: "+String(e));return r}var c=t.GraphQLInt=new s.GraphQLScalarType({name:"Int",description:"The `Int` scalar type represents non-fractional signed whole numeric values. Int can represent values between -(2^31) and 2^31 - 1. ",serialize:a,parseValue:a,parseLiteral:function(e){if(e.kind===n.Kind.INT){var t=parseInt(e.value,10);if(t<=i&&t>=o)return t}}});function u(e){if(""===e)throw new TypeError("Float cannot represent non numeric value: (empty string)");var t=Number(e);if(t==t)return t;throw new TypeError("Float cannot represent non numeric value: "+String(e))}var l=t.GraphQLFloat=new s.GraphQLScalarType({name:"Float",description:"The `Float` scalar type represents signed double-precision fractional values as specified by [IEEE 754](http://en.wikipedia.org/wiki/IEEE_floating_point). ",serialize:u,parseValue:u,parseLiteral:function(e){return e.kind===n.Kind.FLOAT||e.kind===n.Kind.INT?parseFloat(e.value):void 0}});function p(e){if(Array.isArray(e))throw new TypeError("String cannot represent an array value: ["+String(e)+"]");return String(e)}var d=t.GraphQLString=new s.GraphQLScalarType({name:"String",description:"The `String` scalar type represents textual data, represented as UTF-8 character sequences. The String type is most often used by GraphQL to represent free-form human-readable text.",serialize:p,parseValue:p,parseLiteral:function(e){return e.kind===n.Kind.STRING?e.value:void 0}}),h=t.GraphQLBoolean=new s.GraphQLScalarType({name:"Boolean",description:"The `Boolean` scalar type represents `true` or `false`.",serialize:Boolean,parseValue:Boolean,parseLiteral:function(e){return e.kind===n.Kind.BOOLEAN?e.value:void 0}}),f=t.GraphQLID=new s.GraphQLScalarType({name:"ID",description:'The `ID` scalar type represents a unique identifier, often used to refetch an object or as key for a cache. The ID type appears in a JSON response as a String; however, it is not intended to be human-readable. When expected as an input type, any string (such as `"4"`) or integer (such as `4`) input value will be accepted as an ID.',serialize:String,parseValue:String,parseLiteral:function(e){return e.kind===n.Kind.STRING||e.kind===n.Kind.INT?e.value:void 0}});t.specifiedScalarTypes=[d,c,l,h,f]},14648:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GraphQLSchema=void 0;var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.isSchema=function(e){return(0,c.default)(e,d)};var n=r(63754),i=r(38685),o=r(8364),a=p(r(57718)),c=p(r(79527)),u=p(r(61321)),l=p(r(26380));function p(e){return e&&e.__esModule?e:{default:e}}var d=t.GraphQLSchema=function(){function e(t){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t&&t.assumeValid?this.__validationErrors=[]:("object"!==(void 0===t?"undefined":s(t))&&(0,u.default)(0,"Must provide configuration object."),t.types&&!Array.isArray(t.types)&&(0,u.default)(0,'"types" must be Array if provided but got: '+String(t.types)+"."),t.directives&&!Array.isArray(t.directives)&&(0,u.default)(0,'"directives" must be Array if provided but got: '+String(t.directives)+"."),t.allowedLegacyNames&&!Array.isArray(t.allowedLegacyNames)&&(0,u.default)(0,'"allowedLegacyNames" must be Array if provided but got: '+String(t.allowedLegacyNames)+".")),this.__allowedLegacyNames=t.allowedLegacyNames,this._queryType=t.query,this._mutationType=t.mutation,this._subscriptionType=t.subscription,this._directives=t.directives||i.specifiedDirectives,this.astNode=t.astNode;var a=[this.getQueryType(),this.getMutationType(),this.getSubscriptionType(),o.__Schema],c=t.types;c&&(a=a.concat(c));var l=Object.create(null);l=a.reduce(h,l),l=this._directives.reduce(f,l),this._typeMap=l,this._implementations=Object.create(null),Object.keys(this._typeMap).forEach((function(e){var t=r._typeMap[e];(0,n.isObjectType)(t)&&t.getInterfaces().forEach((function(e){if((0,n.isInterfaceType)(e)){var s=r._implementations[e.name];s?s.push(t):r._implementations[e.name]=[t]}}))}))}return e.prototype.getQueryType=function(){return this._queryType},e.prototype.getMutationType=function(){return this._mutationType},e.prototype.getSubscriptionType=function(){return this._subscriptionType},e.prototype.getTypeMap=function(){return this._typeMap},e.prototype.getType=function(e){return this.getTypeMap()[e]},e.prototype.getPossibleTypes=function(e){return(0,n.isUnionType)(e)?e.getTypes():this._implementations[e.name]},e.prototype.isPossibleType=function(e,t){var r=this._possibleTypeMap;if(r||(this._possibleTypeMap=r=Object.create(null)),!r[e.name]){var s=this.getPossibleTypes(e);Array.isArray(s)||(0,u.default)(0,"Could not find possible implementing types for "+e.name+" in schema. Check that schema.types is defined and is an array of all possible types in the schema."),r[e.name]=s.reduce((function(e,t){return e[t.name]=!0,e}),Object.create(null))}return Boolean(r[e.name][t.name])},e.prototype.getDirectives=function(){return this._directives},e.prototype.getDirective=function(e){return(0,a.default)(this.getDirectives(),(function(t){return t.name===e}))},e}();function h(e,t){if(!t)return e;if((0,n.isWrappingType)(t))return h(e,t.ofType);if(e[t.name])return e[t.name]!==t&&(0,u.default)(0,'Schema must contain unique named types but contains multiple types named "'+t.name+'".'),e;e[t.name]=t;var r=e;return(0,n.isUnionType)(t)&&(r=t.getTypes().reduce(h,r)),(0,n.isObjectType)(t)&&(r=t.getInterfaces().reduce(h,r)),((0,n.isObjectType)(t)||(0,n.isInterfaceType)(t))&&(0,l.default)(t.getFields()).forEach((function(e){if(e.args){var t=e.args.map((function(e){return e.type}));r=t.reduce(h,r)}r=h(r,e.type)})),(0,n.isInputObjectType)(t)&&(0,l.default)(t.getFields()).forEach((function(e){r=h(r,e.type)})),r}function f(e,t){return(0,i.isDirective)(t)?t.args.reduce((function(e,t){return h(e,t.type)}),e):e}},59873:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateSchema=f,t.assertValidSchema=function(e){var t=f(e);if(0!==t.length)throw new Error(t.map((function(e){return e.message})).join("\n\n"))};var s=r(63754),n=r(38685),i=r(8364),o=r(14648),a=h(r(57718)),c=h(r(61321)),u=h(r(26380)),l=r(61702),p=r(68426),d=r(73448);function h(e){return e&&e.__esModule?e:{default:e}}function f(e){if((0,o.isSchema)(e)||(0,c.default)(0,"Expected "+String(e)+" to be a GraphQL schema."),e.__validationErrors)return e.__validationErrors;var t=new g(e);!function(e){var t=e.schema,r=t.getQueryType();r?(0,s.isObjectType)(r)||e.reportError("Query root type must be Object type, it cannot be "+String(r)+".",m(t,r,"query")):e.reportError("Query root type must be provided.",t.astNode);var n=t.getMutationType();n&&!(0,s.isObjectType)(n)&&e.reportError("Mutation root type must be Object type if provided, it cannot be "+String(n)+".",m(t,n,"mutation"));var i=t.getSubscriptionType();i&&!(0,s.isObjectType)(i)&&e.reportError("Subscription root type must be Object type if provided, it cannot be "+String(i)+".",m(t,i,"subscription"))}(t),function(e){e.schema.getDirectives().forEach((function(t){if((0,n.isDirective)(t)){_(e,t);var r=Object.create(null);t.args.forEach((function(n){var i=n.name;_(e,n),r[i]?e.reportError("Argument @"+t.name+"("+i+":) can only be defined once.",I(t,i)):(r[i]=!0,(0,s.isInputType)(n.type)||e.reportError("The type of @"+t.name+"("+i+":) must be Input Type but got: "+String(n.type)+".",function(e,t){var r=I(e,t)[0];return r&&r.type}(t,i)))}))}else e.reportError("Expected directive but got: "+String(t)+".",t&&t.astNode)}))}(t),function(e){var t=e.schema.getTypeMap();(0,u.default)(t).forEach((function(t){(0,s.isNamedType)(t)?((0,i.isIntrospectionType)(t)||_(e,t),(0,s.isObjectType)(t)?(y(e,t),function(e,t){var r=Object.create(null);t.getInterfaces().forEach((function(n){(0,s.isInterfaceType)(n)?r[n.name]?e.reportError("Type "+t.name+" can only implement "+n.name+" once.",v(t,n)):(r[n.name]=!0,function(e,t,r){var n=t.getFields(),i=r.getFields();Object.keys(i).forEach((function(o){var c=n[o],u=i[o];c?((0,d.isTypeSubTypeOf)(e.schema,c.type,u.type)||e.reportError("Interface field "+r.name+"."+o+" expects type "+String(u.type)+" but "+t.name+"."+o+" is type "+String(c.type)+".",[T(r,o),T(t,o)]),u.args.forEach((function(s){var n=s.name,i=(0,a.default)(c.args,(function(e){return e.name===n}));i?(0,d.isEqualType)(s.type,i.type)||e.reportError("Interface field argument "+r.name+"."+o+"("+n+":) expects type "+String(s.type)+" but "+t.name+"."+o+"("+n+":) is type "+String(i.type)+".",[A(r,o,n),A(t,o,n)]):e.reportError("Interface field argument "+r.name+"."+o+"("+n+":) expected but "+t.name+"."+o+" does not provide it.",[w(r,o,n),E(t,o)])})),c.args.forEach((function(n){var i=n.name;!(0,a.default)(u.args,(function(e){return e.name===i}))&&(0,s.isNonNullType)(n.type)&&e.reportError("Object field argument "+t.name+"."+o+"("+i+":) is of required type "+String(n.type)+" but is not also provided by the Interface field "+r.name+"."+o+".",[A(t,o,i),E(r,o)])}))):e.reportError("Interface field "+r.name+"."+o+" expected but "+t.name+" does not provide it.",[E(r,o),t.astNode])}))}(e,t,n)):e.reportError("Type "+String(t)+" must only implement Interface types, it cannot implement "+String(n)+".",function(e,t){return v(e,t)[0]}(t,n))}))}(e,t)):(0,s.isInterfaceType)(t)?y(e,t):(0,s.isUnionType)(t)?function(e,t){var r=t.getTypes();0===r.length&&e.reportError("Union type "+t.name+" must define one or more member types.",t.astNode);var n=Object.create(null);r.forEach((function(r){n[r.name]?e.reportError("Union type "+t.name+" can only include type "+r.name+" once.",k(t,r.name)):(n[r.name]=!0,(0,s.isObjectType)(r)||e.reportError("Union type "+t.name+" can only include Object types, it cannot include "+String(r)+".",k(t,String(r))))}))}(e,t):(0,s.isEnumType)(t)?function(e,t){var r=t.getValues();0===r.length&&e.reportError("Enum type "+t.name+" must define one or more values.",t.astNode),r.forEach((function(r){var s=r.name,n=function(e,t){return e.astNode&&e.astNode.values&&e.astNode.values.filter((function(e){return e.name.value===t}))}(t,s);n&&n.length>1&&e.reportError("Enum type "+t.name+" can include value "+s+" only once.",n),_(e,r),"true"!==s&&"false"!==s&&"null"!==s||e.reportError("Enum type "+t.name+" cannot include value: "+s+".",r.astNode)}))}(e,t):(0,s.isInputObjectType)(t)&&function(e,t){var r=(0,u.default)(t.getFields());0===r.length&&e.reportError("Input Object type "+t.name+" must define one or more fields.",t.astNode),r.forEach((function(r){_(e,r),(0,s.isInputType)(r.type)||e.reportError("The type of "+t.name+"."+r.name+" must be Input Type but got: "+String(r.type)+".",r.astNode&&r.astNode.type)}))}(e,t)):e.reportError("Expected GraphQL named type but got: "+String(t)+".",t&&t.astNode)}))}(t);var r=t.getErrors();return e.__validationErrors=r,r}var g=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._errors=[],this.schema=t}return e.prototype.reportError=function(e,t){var r=(Array.isArray(t)?t:[t]).filter(Boolean);this.addError(new l.GraphQLError(e,r))},e.prototype.addError=function(e){this._errors.push(e)},e.prototype.getErrors=function(){return this._errors},e}();function m(e,t,r){var s=e.astNode,n=s&&s.operationTypes.find((function(e){return e.operation===r}));return n?n.type:t&&t.astNode}function _(e,t){if(!e.schema.__allowedLegacyNames||-1===e.schema.__allowedLegacyNames.indexOf(t.name)){var r=(0,p.isValidNameError)(t.name,t.astNode||void 0);r&&e.addError(r)}}function y(e,t){var r=(0,u.default)(t.getFields());0===r.length&&e.reportError("Type "+t.name+" must define one or more fields.",b(t)),r.forEach((function(r){_(e,r);var n=S(t,r.name);if(n.length>1)e.reportError("Field "+t.name+"."+r.name+" can only be defined once.",n);else{(0,s.isOutputType)(r.type)||e.reportError("The type of "+t.name+"."+r.name+" must be Output Type but got: "+String(r.type)+".",T(t,r.name));var i=Object.create(null);r.args.forEach((function(n){var o=n.name;_(e,n),i[o]&&e.reportError("Field argument "+t.name+"."+r.name+"("+o+":) can only be defined once.",x(t,r.name,o)),i[o]=!0,(0,s.isInputType)(n.type)||e.reportError("The type of "+t.name+"."+r.name+"("+o+":) must be Input Type but got: "+String(n.type)+".",A(t,r.name,o))}))}}))}function b(e){return e.astNode?e.extensionASTNodes?[e.astNode].concat(e.extensionASTNodes):[e.astNode]:e.extensionASTNodes||[]}function v(e,t){for(var r=[],s=function(e){return e.astNode?e.extensionASTNodes?[e.astNode].concat(e.extensionASTNodes):[e.astNode]:e.extensionASTNodes||[]}(e),n=0;n<s.length;n++){var i=s[n];i&&i.interfaces&&i.interfaces.forEach((function(e){e.name.value===t.name&&r.push(e)}))}return r}function E(e,t){return S(e,t)[0]}function S(e,t){for(var r=[],s=b(e),n=0;n<s.length;n++){var i=s[n];i&&i.fields&&i.fields.forEach((function(e){e.name.value===t&&r.push(e)}))}return r}function T(e,t){var r=E(e,t);return r&&r.type}function w(e,t,r){return x(e,t,r)[0]}function x(e,t,r){var s=[],n=E(e,t);return n&&n.arguments&&n.arguments.forEach((function(e){e.name.value===r&&s.push(e)})),s}function A(e,t,r){var s=w(e,t,r);return s&&s.type}function I(e,t){var r=[],s=e.astNode;return s&&s.arguments&&s.arguments.forEach((function(e){e.name.value===t&&r.push(e)})),r}function k(e,t){return e.astNode&&e.astNode.types&&e.astNode.types.filter((function(e){return e.name.value===t}))}},27485:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TypeInfo=void 0;var s,n=r(7030),i=r(63754),o=r(8364),a=r(6693),c=(s=r(57718))&&s.__esModule?s:{default:s};function u(e,t,r){var s=r.name.value;return s===o.SchemaMetaFieldDef.name&&e.getQueryType()===t?o.SchemaMetaFieldDef:s===o.TypeMetaFieldDef.name&&e.getQueryType()===t?o.TypeMetaFieldDef:s===o.TypeNameMetaFieldDef.name&&(0,i.isCompositeType)(t)?o.TypeNameMetaFieldDef:(0,i.isObjectType)(t)||(0,i.isInterfaceType)(t)?t.getFields()[s]:void 0}t.TypeInfo=function(){function e(t,r,s){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._schema=t,this._typeStack=[],this._parentTypeStack=[],this._inputTypeStack=[],this._fieldDefStack=[],this._directive=null,this._argument=null,this._enumValue=null,this._getFieldDef=r||u,s&&((0,i.isInputType)(s)&&this._inputTypeStack.push(s),(0,i.isCompositeType)(s)&&this._parentTypeStack.push(s),(0,i.isOutputType)(s)&&this._typeStack.push(s))}return e.prototype.getType=function(){if(this._typeStack.length>0)return this._typeStack[this._typeStack.length-1]},e.prototype.getParentType=function(){if(this._parentTypeStack.length>0)return this._parentTypeStack[this._parentTypeStack.length-1]},e.prototype.getInputType=function(){if(this._inputTypeStack.length>0)return this._inputTypeStack[this._inputTypeStack.length-1]},e.prototype.getParentInputType=function(){if(this._inputTypeStack.length>1)return this._inputTypeStack[this._inputTypeStack.length-2]},e.prototype.getFieldDef=function(){if(this._fieldDefStack.length>0)return this._fieldDefStack[this._fieldDefStack.length-1]},e.prototype.getDirective=function(){return this._directive},e.prototype.getArgument=function(){return this._argument},e.prototype.getEnumValue=function(){return this._enumValue},e.prototype.enter=function(e){var t=this._schema;switch(e.kind){case n.Kind.SELECTION_SET:var r=(0,i.getNamedType)(this.getType());this._parentTypeStack.push((0,i.isCompositeType)(r)?r:void 0);break;case n.Kind.FIELD:var s=this.getParentType(),o=void 0,u=void 0;s&&(o=this._getFieldDef(t,s,e))&&(u=o.type),this._fieldDefStack.push(o),this._typeStack.push((0,i.isOutputType)(u)?u:void 0);break;case n.Kind.DIRECTIVE:this._directive=t.getDirective(e.name.value);break;case n.Kind.OPERATION_DEFINITION:var l=void 0;"query"===e.operation?l=t.getQueryType():"mutation"===e.operation?l=t.getMutationType():"subscription"===e.operation&&(l=t.getSubscriptionType()),this._typeStack.push((0,i.isObjectType)(l)?l:void 0);break;case n.Kind.INLINE_FRAGMENT:case n.Kind.FRAGMENT_DEFINITION:var p=e.typeCondition,d=p?(0,a.typeFromAST)(t,p):(0,i.getNamedType)(this.getType());this._typeStack.push((0,i.isOutputType)(d)?d:void 0);break;case n.Kind.VARIABLE_DEFINITION:var h=(0,a.typeFromAST)(t,e.type);this._inputTypeStack.push((0,i.isInputType)(h)?h:void 0);break;case n.Kind.ARGUMENT:var f=void 0,g=void 0,m=this.getDirective()||this.getFieldDef();m&&(f=(0,c.default)(m.args,(function(t){return t.name===e.name.value})))&&(g=f.type),this._argument=f,this._inputTypeStack.push((0,i.isInputType)(g)?g:void 0);break;case n.Kind.LIST:var _=(0,i.getNullableType)(this.getInputType()),y=(0,i.isListType)(_)?_.ofType:_;this._inputTypeStack.push((0,i.isInputType)(y)?y:void 0);break;case n.Kind.OBJECT_FIELD:var b=(0,i.getNamedType)(this.getInputType()),v=void 0;if((0,i.isInputObjectType)(b)){var E=b.getFields()[e.name.value];E&&(v=E.type)}this._inputTypeStack.push((0,i.isInputType)(v)?v:void 0);break;case n.Kind.ENUM:var S=(0,i.getNamedType)(this.getInputType()),T=void 0;(0,i.isEnumType)(S)&&(T=S.getValue(e.value)),this._enumValue=T}},e.prototype.leave=function(e){switch(e.kind){case n.Kind.SELECTION_SET:this._parentTypeStack.pop();break;case n.Kind.FIELD:this._fieldDefStack.pop(),this._typeStack.pop();break;case n.Kind.DIRECTIVE:this._directive=null;break;case n.Kind.OPERATION_DEFINITION:case n.Kind.INLINE_FRAGMENT:case n.Kind.FRAGMENT_DEFINITION:this._typeStack.pop();break;case n.Kind.VARIABLE_DEFINITION:this._inputTypeStack.pop();break;case n.Kind.ARGUMENT:this._argument=null,this._inputTypeStack.pop();break;case n.Kind.LIST:case n.Kind.OBJECT_FIELD:this._inputTypeStack.pop();break;case n.Kind.ENUM:this._enumValue=null}},e}()},68426:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertValidName=function(e){var t=a(e);if(t)throw t;return e},t.isValidNameError=a;var s,n=r(61702),i=(s=r(61321))&&s.__esModule?s:{default:s},o=/^[_a-zA-Z][_a-zA-Z0-9]*$/;function a(e,t){return"string"!=typeof e&&(0,i.default)(0,"Expected string"),e.length>1&&"_"===e[0]&&"_"===e[1]?new n.GraphQLError('Name "'+e+'" must not begin with "__", which is reserved by GraphQL introspection.',t):o.test(e)?void 0:new n.GraphQLError('Names must match /^[_a-zA-Z][_a-zA-Z0-9]*$/ but "'+e+'" does not.',t)}},38096:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.astFromValue=function e(t,r){if((0,u.isNonNullType)(r)){var p=e(t,r.ofType);return p&&p.kind===c.Kind.NULL?null:p}if(null===t)return{kind:c.Kind.NULL};if((0,o.default)(t))return null;if((0,u.isListType)(r)){var h=r.ofType;if((0,n.isCollection)(t)){var f=[];return(0,n.forEach)(t,(function(t){var r=e(t,h);r&&f.push(r)})),{kind:c.Kind.LIST,values:f}}return e(t,h)}if((0,u.isInputObjectType)(r)){if(null===t||"object"!==(void 0===t?"undefined":s(t)))return null;var g=(0,a.default)(r.getFields()),m=[];return g.forEach((function(r){var s=e(t[r.name],r.type);s&&m.push({kind:c.Kind.OBJECT_FIELD,name:{kind:c.Kind.NAME,value:r.name},value:s})})),{kind:c.Kind.OBJECT,fields:m}}if((0,u.isScalarType)(r)||(0,u.isEnumType)(r)){var _=r.serialize(t);if((0,i.default)(_))return null;if("boolean"==typeof _)return{kind:c.Kind.BOOLEAN,value:_};if("number"==typeof _){var y=String(_);return d.test(y)?{kind:c.Kind.INT,value:y}:{kind:c.Kind.FLOAT,value:y}}if("string"==typeof _)return(0,u.isEnumType)(r)?{kind:c.Kind.ENUM,value:_}:r===l.GraphQLID&&d.test(_)?{kind:c.Kind.INT,value:_}:{kind:c.Kind.STRING,value:_};throw new TypeError("Cannot convert value to AST: "+String(_))}throw new Error("Unknown type: "+r+".")};var n=r(48652),i=p(r(72530)),o=p(r(26166)),a=p(r(26380)),c=r(7030),u=r(63754),l=r(11062);function p(e){return e&&e.__esModule?e:{default:e}}var d=/^-?(0|[1-9][0-9]*)$/},70434:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ASTDefinitionBuilder=void 0,t.buildASTSchema=y,t.getDescription=E,t.buildSchema=function(e,t){return y((0,c.parse)(e,t),t)};var s=m(r(94590)),n=m(r(65785)),i=r(72302),o=m(r(37152)),a=r(46083),c=r(50246),u=r(98113),l=r(7030),p=r(63754),d=r(38685),h=r(8364),f=r(11062),g=r(14648);function m(e){return e&&e.__esModule?e:{default:e}}function _(e,t){if(t.kind===l.Kind.LIST_TYPE)return(0,p.GraphQLList)(_(e,t.type));if(t.kind===l.Kind.NON_NULL_TYPE){var r=_(e,t.type);return(0,p.GraphQLNonNull)((0,p.assertNullableType)(r))}return e}function y(e,t){if(!e||e.kind!==l.Kind.DOCUMENT)throw new Error("Must provide a document ast.");for(var r=void 0,s=[],n=Object.create(null),i=[],o=0;o<e.definitions.length;o++){var a=e.definitions[o];switch(a.kind){case l.Kind.SCHEMA_DEFINITION:if(r)throw new Error("Must provide only one schema definition.");r=a;break;case l.Kind.SCALAR_TYPE_DEFINITION:case l.Kind.OBJECT_TYPE_DEFINITION:case l.Kind.INTERFACE_TYPE_DEFINITION:case l.Kind.ENUM_TYPE_DEFINITION:case l.Kind.UNION_TYPE_DEFINITION:case l.Kind.INPUT_OBJECT_TYPE_DEFINITION:var c=a.name.value;if(n[c])throw new Error('Type "'+c+'" was defined more than once.');s.push(a),n[c]=a;break;case l.Kind.DIRECTIVE_DEFINITION:i.push(a)}}var u,p=r?(u={},r.operationTypes.forEach((function(e){var t=e.type.name.value,r=e.operation;if(u[r])throw new Error("Must provide only one "+r+" type in schema.");if(!n[t])throw new Error("Specified "+r+' type "'+t+'" not found in document.');u[r]=e.type})),u):{query:n.Query,mutation:n.Mutation,subscription:n.Subscription},h=new b(n,t,(function(e){throw new Error('Type "'+e.name.value+'" not found in document.')})),f=h.buildTypes(s),m=i.map((function(e){return h.buildDirective(e)}));return m.some((function(e){return"skip"===e.name}))||m.push(d.GraphQLSkipDirective),m.some((function(e){return"include"===e.name}))||m.push(d.GraphQLIncludeDirective),m.some((function(e){return"deprecated"===e.name}))||m.push(d.GraphQLDeprecatedDirective),new g.GraphQLSchema({query:p.query?h.buildType(p.query):null,mutation:p.mutation?h.buildType(p.mutation):null,subscription:p.subscription?h.buildType(p.subscription):null,types:f,directives:m,astNode:r,assumeValid:t&&t.assumeValid,allowedLegacyNames:t&&t.allowedLegacyNames})}var b=t.ASTDefinitionBuilder=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._typeDefinitionsMap=t,this._options=r,this._resolveType=n,this._cache=(0,s.default)(f.specifiedScalarTypes.concat(h.introspectionTypes),(function(e){return e.name}))}return e.prototype.buildTypes=function(e){var t=this;return e.map((function(e){return t.buildType(e)}))},e.prototype.buildType=function(e){var t=e.name.value;if(!this._cache[t])if(e.kind===l.Kind.NAMED_TYPE){var r=this._typeDefinitionsMap[t];this._cache[t]=r?this._makeSchemaDef(r):this._resolveType(e)}else this._cache[t]=this._makeSchemaDef(e);return this._cache[t]},e.prototype._buildWrappedType=function(e){var t=this.buildType(function(e){for(var t=e;t.kind===l.Kind.LIST_TYPE||t.kind===l.Kind.NON_NULL_TYPE;)t=t.type;return t}(e));return _(t,e)},e.prototype.buildDirective=function(e){return new d.GraphQLDirective({name:e.name.value,description:E(e,this._options),locations:e.locations.map((function(e){return e.value})),args:e.arguments&&this._makeInputValues(e.arguments),astNode:e})},e.prototype.buildField=function(e){return{type:this._buildWrappedType(e.type),description:E(e,this._options),args:e.arguments&&this._makeInputValues(e.arguments),deprecationReason:v(e),astNode:e}},e.prototype._makeSchemaDef=function(e){switch(e.kind){case l.Kind.OBJECT_TYPE_DEFINITION:return this._makeTypeDef(e);case l.Kind.INTERFACE_TYPE_DEFINITION:return this._makeInterfaceDef(e);case l.Kind.ENUM_TYPE_DEFINITION:return this._makeEnumDef(e);case l.Kind.UNION_TYPE_DEFINITION:return this._makeUnionDef(e);case l.Kind.SCALAR_TYPE_DEFINITION:return this._makeScalarDef(e);case l.Kind.INPUT_OBJECT_TYPE_DEFINITION:return this._makeInputObjectDef(e);default:throw new Error('Type kind "'+e.kind+'" not supported.')}},e.prototype._makeTypeDef=function(e){var t=this,r=e.name.value,s=e.interfaces;return new p.GraphQLObjectType({name:r,description:E(e,this._options),fields:function(){return t._makeFieldDefMap(e)},interfaces:s?function(){return t.buildTypes(s)}:[],astNode:e})},e.prototype._makeFieldDefMap=function(e){var t=this;return e.fields?(0,n.default)(e.fields,(function(e){return e.name.value}),(function(e){return t.buildField(e)})):{}},e.prototype._makeInputValues=function(e){var t=this;return(0,n.default)(e,(function(e){return e.name.value}),(function(e){var r=t._buildWrappedType(e.type);return{type:r,description:E(e,t._options),defaultValue:(0,i.valueFromAST)(e.defaultValue,r),astNode:e}}))},e.prototype._makeInterfaceDef=function(e){var t=this;return new p.GraphQLInterfaceType({name:e.name.value,description:E(e,this._options),fields:function(){return t._makeFieldDefMap(e)},astNode:e})},e.prototype._makeEnumDef=function(e){var t=this;return new p.GraphQLEnumType({name:e.name.value,description:E(e,this._options),values:e.values?(0,n.default)(e.values,(function(e){return e.name.value}),(function(e){return{description:E(e,t._options),deprecationReason:v(e),astNode:e}})):{},astNode:e})},e.prototype._makeUnionDef=function(e){return new p.GraphQLUnionType({name:e.name.value,description:E(e,this._options),types:e.types?this.buildTypes(e.types):[],astNode:e})},e.prototype._makeScalarDef=function(e){return new p.GraphQLScalarType({name:e.name.value,description:E(e,this._options),astNode:e,serialize:function(e){return e}})},e.prototype._makeInputObjectDef=function(e){var t=this;return new p.GraphQLInputObjectType({name:e.name.value,description:E(e,this._options),fields:function(){return e.fields?t._makeInputValues(e.fields):{}},astNode:e})},e}();function v(e){var t=(0,u.getDirectiveValues)(d.GraphQLDeprecatedDirective,e);return t&&t.reason}function E(e,t){if(e.description)return e.description.value;if(t&&t.commentDescriptions){var r=function(e){var t=e.loc;if(t){for(var r=[],s=t.startToken.prev;s&&s.kind===a.TokenKind.COMMENT&&s.next&&s.prev&&s.line+1===s.next.line&&s.line!==s.prev.line;){var n=String(s.value);r.push(n),s=s.prev}return r.reverse().join("\n")}}(e);if(void 0!==r)return(0,o.default)("\n"+r)}}},56613:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildClientSchema=function(e,t){var r=e.__schema,f=(0,n.default)(r.types,(function(e){return e.name})),g=(0,n.default)(h.specifiedScalarTypes.concat(d.introspectionTypes),(function(e){return e.name}));function m(e){if(e.kind===d.TypeKind.LIST){var t=e.ofType;if(!t)throw new Error("Decorated type deeper than introspection query.");return(0,l.GraphQLList)(m(t))}if(e.kind===d.TypeKind.NON_NULL){var r=e.ofType;if(!r)throw new Error("Decorated type deeper than introspection query.");var s=m(r);return(0,l.GraphQLNonNull)((0,l.assertNullableType)(s))}if(!e.name)throw new Error("Unknown type reference: "+JSON.stringify(e));return _(e.name)}function _(e){if(g[e])return g[e];var t=f[e];if(!t)throw new Error("Invalid or incomplete schema, unknown type: "+e+". Ensure that a full introspection query is used in order to build a client schema.");var r=function(e){if(e&&e.name&&e.kind)switch(e.kind){case d.TypeKind.SCALAR:return r=e,new l.GraphQLScalarType({name:r.name,description:r.description,serialize:function(e){return e}});case d.TypeKind.OBJECT:return function(e){if(!e.interfaces)throw new Error("Introspection result missing interfaces: "+JSON.stringify(e));return new l.GraphQLObjectType({name:e.name,description:e.description,interfaces:e.interfaces.map(b),fields:function(){return v(e)}})}(e);case d.TypeKind.INTERFACE:return t=e,new l.GraphQLInterfaceType({name:t.name,description:t.description,fields:function(){return v(t)}});case d.TypeKind.UNION:return function(e){if(!e.possibleTypes)throw new Error("Introspection result missing possibleTypes: "+JSON.stringify(e));return new l.GraphQLUnionType({name:e.name,description:e.description,types:e.possibleTypes.map(y)})}(e);case d.TypeKind.ENUM:return function(e){if(!e.enumValues)throw new Error("Introspection result missing enumValues: "+JSON.stringify(e));return new l.GraphQLEnumType({name:e.name,description:e.description,values:(0,i.default)(e.enumValues,(function(e){return e.name}),(function(e){return{description:e.description,deprecationReason:e.deprecationReason}}))})}(e);case d.TypeKind.INPUT_OBJECT:return function(e){if(!e.inputFields)throw new Error("Introspection result missing inputFields: "+JSON.stringify(e));return new l.GraphQLInputObjectType({name:e.name,description:e.description,fields:function(){return E(e.inputFields)}})}(e)}var t,r;throw new Error("Invalid or incomplete introspection result. Ensure that a full introspection query is used in order to build a client schema:"+JSON.stringify(e))}(t);return g[e]=r,r}function y(e){var t=m(e);return(0,l.assertObjectType)(t)}function b(e){var t=m(e);return(0,l.assertInterfaceType)(t)}function v(e){if(!e.fields)throw new Error("Introspection result missing fields: "+JSON.stringify(e));return(0,i.default)(e.fields,(function(e){return e.name}),(function(e){if(!e.args)throw new Error("Introspection result missing field args: "+JSON.stringify(e));return{description:e.description,deprecationReason:e.deprecationReason,type:(t=e.type,r=m(t),(0,l.isOutputType)(r)||(0,s.default)(0,"Introspection must provide output type for fields."),r),args:E(e.args)};var t,r}))}function E(e){return(0,i.default)(e,(function(e){return e.name}),S)}function S(e){var t=function(e){var t=m(e);return(0,l.isInputType)(t)||(0,s.default)(0,"Introspection must provide input type for arguments."),t}(e.type),r=e.defaultValue?(0,o.valueFromAST)((0,a.parseValue)(e.defaultValue),t):void 0;return{name:e.name,description:e.description,type:t,defaultValue:r}}var T=r.types.map((function(e){return _(e.name)})),w=r.queryType?y(r.queryType):null,x=r.mutationType?y(r.mutationType):null,A=r.subscriptionType?y(r.subscriptionType):null,I=r.directives?r.directives.map((function(e){var t=e.locations?e.locations.slice():[].concat(e.onField?[u.DirectiveLocation.FIELD]:[],e.onOperation?[u.DirectiveLocation.QUERY,u.DirectiveLocation.MUTATION,u.DirectiveLocation.SUBSCRIPTION]:[],e.onFragment?[u.DirectiveLocation.FRAGMENT_DEFINITION,u.DirectiveLocation.FRAGMENT_SPREAD,u.DirectiveLocation.INLINE_FRAGMENT]:[]);if(!e.args)throw new Error("Introspection result missing directive args: "+JSON.stringify(e));return new p.GraphQLDirective({name:e.name,description:e.description,locations:t,args:E(e.args)})})):[];return new c.GraphQLSchema({query:w,mutation:x,subscription:A,types:T,directives:I,assumeValid:t&&t.assumeValid,allowedLegacyNames:t&&t.allowedLegacyNames})};var s=f(r(61321)),n=f(r(94590)),i=f(r(65785)),o=r(72302),a=r(50246),c=r(14648),u=r(5919),l=r(63754),p=r(38685),d=r(8364),h=r(11062);function f(e){return e&&e.__esModule?e:{default:e}}},68707:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.coerceValue=function e(t,r,u,p){if((0,l.isNonNullType)(r))return(0,o.default)(t)?h([m("Expected non-nullable type "+String(r)+" not to be null",u,p)]):e(t,r.ofType,u,p);if((0,o.default)(t))return d(null);if((0,l.isScalarType)(r))try{var b=r.parseValue(t);return(0,i.default)(b)?h([m("Expected type "+r.name,u,p)]):d(b)}catch(e){return h([m("Expected type "+r.name,u,p,e.message,e)])}if((0,l.isEnumType)(r)){if("string"==typeof t){var v=r.getValue(t);if(v)return d(v.value)}var E=(0,c.default)(String(t),r.getValues().map((function(e){return e.name}))),S=0!==E.length?"did you mean "+(0,a.default)(E)+"?":void 0;return h([m("Expected type "+r.name,u,p,S)])}if((0,l.isListType)(r)){var T=r.ofType;if((0,n.isCollection)(t)){var w=void 0,x=[];return(0,n.forEach)(t,(function(t,r){var s=e(t,T,u,g(p,r));s.errors?w=f(w,s.errors):w||x.push(s.value)})),w?h(w):d(x)}var A=e(t,T,u);return A.errors?A:d([A.value])}if((0,l.isInputObjectType)(r)){if("object"!==(void 0===t?"undefined":s(t)))return h([m("Expected type "+r.name+" to be an object",u,p)]);var I=void 0,k={},O=r.getFields();for(var R in O)if(y.call(O,R)){var C=O[R],N=t[R];if((0,i.default)(N))(0,i.default)(C.defaultValue)?(0,l.isNonNullType)(C.type)&&(I=f(I,m("Field "+_(g(p,R))+" of required type "+String(C.type)+" was not provided",u))):k[R]=C.defaultValue;else{var P=e(N,C.type,u,g(p,R));P.errors?I=f(I,P.errors):I||(k[R]=P.value)}}for(var D in t)if(y.call(t,D)&&!O[D]){var L=(0,c.default)(D,Object.keys(O)),M=0!==L.length?"did you mean "+(0,a.default)(L)+"?":void 0;I=f(I,m('Field "'+D+'" is not defined by type '+r.name,u,p,M))}return I?h(I):d(k)}throw new Error("Unexpected type: "+r+".")};var n=r(48652),i=p(r(26166)),o=p(r(72530)),a=p(r(69652)),c=p(r(81709)),u=r(79211),l=r(63754);function p(e){return e&&e.__esModule?e:{default:e}}function d(e){return{errors:void 0,value:e}}function h(e){return{errors:e,value:void 0}}function f(e,t){return(e||[]).concat(t)}function g(e,t){return{prev:e,key:t}}function m(e,t,r,s,n){var i=_(r);return new u.GraphQLError(e+(i?" at "+i:"")+(s?"; "+s:"."),t,void 0,void 0,void 0,n)}function _(e){for(var t="",r=e;r;)t=("string"==typeof r.key?"."+r.key:"["+String(r.key)+"]")+t,r=r.prev;return t?"value"+t:""}var y=Object.prototype.hasOwnProperty},73129:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.concatAST=function(e){for(var t=[],r=0;r<e.length;r++)for(var s=e[r].definitions,n=0;n<s.length;n++)t.push(s[n]);return{kind:"Document",definitions:t}}},21442:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.extendSchema=function(e,t,r){(0,c.isSchema)(e)||(0,s.default)(0,"Must provide valid GraphQLSchema"),(!t||t.kind!==p.Kind.DOCUMENT)&&(0,s.default)(0,"Must provide valid Document AST");for(var d=Object.create(null),f=Object.create(null),g=[],m=0;m<t.definitions.length;m++){var _=t.definitions[m];switch(_.kind){case p.Kind.OBJECT_TYPE_DEFINITION:case p.Kind.INTERFACE_TYPE_DEFINITION:case p.Kind.ENUM_TYPE_DEFINITION:case p.Kind.UNION_TYPE_DEFINITION:case p.Kind.SCALAR_TYPE_DEFINITION:case p.Kind.INPUT_OBJECT_TYPE_DEFINITION:var y=_.name.value;if(e.getType(y))throw new a.GraphQLError('Type "'+y+'" already exists in the schema. It cannot also be defined in this type definition.',[_]);d[y]=_;break;case p.Kind.OBJECT_TYPE_EXTENSION:case p.Kind.INTERFACE_TYPE_EXTENSION:var b=_.name.value,v=e.getType(b);if(!v)throw new a.GraphQLError('Cannot extend type "'+b+'" because it does not exist in the existing schema.',[_]);h(v,_);var E=f[b];f[b]=E?E.concat([_]):[_];break;case p.Kind.DIRECTIVE_DEFINITION:var S=_.name.value;if(e.getDirective(S))throw new a.GraphQLError('Directive "'+S+'" already exists in the schema. It cannot be redefined.',[_]);g.push(_);break;case p.Kind.SCALAR_TYPE_EXTENSION:case p.Kind.UNION_TYPE_EXTENSION:case p.Kind.ENUM_TYPE_EXTENSION:case p.Kind.INPUT_OBJECT_TYPE_EXTENSION:throw new Error("The "+_.kind+" kind is not yet supported by extendSchema().")}}if(0===Object.keys(f).length&&0===Object.keys(d).length&&0===g.length)return e;var T,w=new o.ASTDefinitionBuilder(d,r,(function(t){var r=t.name.value,s=e.getType(r);if(s)return M(s);throw new a.GraphQLError('Unknown type: "'+r+'". Ensure that this type exists either in the original schema, or is added in a type definition.',[t])})),x=Object.create(null),A=e.getQueryType(),I=A?M(A):null,k=e.getMutationType(),O=k?M(k):null,R=e.getSubscriptionType(),C=R?M(R):null,N=[].concat((0,i.default)(e.getTypeMap()).map((function(e){return M(e)})),w.buildTypes((0,i.default)(d))),P=e.__allowedLegacyNames,D=r&&r.allowedLegacyNames,L=P&&D?P.concat(D):P||D;return new c.GraphQLSchema({query:I,mutation:O,subscription:C,types:N,directives:(T=e.getDirectives(),T||(0,s.default)(0,"schema must have default directives"),T.concat(g.map((function(e){return w.buildDirective(e)})))),astNode:e.astNode,allowedLegacyNames:L});function M(e){return x[e.name]||(x[e.name]=function(e){return(0,u.isIntrospectionType)(e)?e:(0,l.isObjectType)(e)?function(e){var t=e.name,r=f[t]?e.extensionASTNodes?e.extensionASTNodes.concat(f[t]):f[t]:e.extensionASTNodes;return new l.GraphQLObjectType({name:t,description:e.description,interfaces:function(){return function(e){var t=e.getInterfaces().map(M),r=f[e.name];return r&&r.forEach((function(e){e.interfaces.forEach((function(e){t.push(w.buildType(e))}))})),t}(e)},fields:function(){return q(e)},astNode:e.astNode,extensionASTNodes:r,isTypeOf:e.isTypeOf})}(e):(0,l.isInterfaceType)(e)?function(e){var t=e.name,r=f[t]?e.extensionASTNodes?e.extensionASTNodes.concat(f[t]):f[t]:e.extensionASTNodes;return new l.GraphQLInterfaceType({name:e.name,description:e.description,fields:function(){return q(e)},astNode:e.astNode,extensionASTNodes:r,resolveType:e.resolveType})}(e):(0,l.isUnionType)(e)?function(e){return new l.GraphQLUnionType({name:e.name,description:e.description,types:e.getTypes().map(M),astNode:e.astNode,resolveType:e.resolveType})}(e):e}(e)),x[e.name]}function q(e){var t=Object.create(null),r=e.getFields();Object.keys(r).forEach((function(e){var s=r[e];t[e]={description:s.description,deprecationReason:s.deprecationReason,type:j(s.type),args:(0,n.default)(s.args,(function(e){return e.name})),astNode:s.astNode,resolve:s.resolve}}));var s=f[e.name];return s&&s.forEach((function(s){s.fields.forEach((function(s){var n=s.name.value;if(r[n])throw new a.GraphQLError('Field "'+e.name+"."+n+'" already exists in the schema. It cannot also be defined in this type extension.',[s]);t[n]=w.buildField(s)}))})),t}function j(e){return(0,l.isListType)(e)?(0,l.GraphQLList)(j(e.ofType)):(0,l.isNonNullType)(e)?(0,l.GraphQLNonNull)(j(e.ofType)):M(e)}};var s=d(r(61321)),n=d(r(94590)),i=d(r(26380)),o=r(70434),a=r(61702),c=r(14648),u=r(8364),l=r(63754),p=(r(38685),r(7030));function d(e){return e&&e.__esModule?e:{default:e}}function h(e,t){switch(t.kind){case p.Kind.OBJECT_TYPE_EXTENSION:if(!(0,l.isObjectType)(e))throw new a.GraphQLError('Cannot extend non-object type "'+e.name+'".',[t]);break;case p.Kind.INTERFACE_TYPE_EXTENSION:if(!(0,l.isInterfaceType)(e))throw new a.GraphQLError('Cannot extend non-interface type "'+e.name+'".',[t])}}},53666:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DangerousChangeType=t.BreakingChangeType=void 0,t.findBreakingChanges=function(e,t){return[].concat(c(e,t),u(e,t),d(e,t),h(e,t).breakingChanges,m(e,t),y(e,t),l(e,t).breakingChanges,v(e,t),S(e,t),T(e,t),w(e,t),A(e,t))},t.findDangerousChanges=function(e,t){return[].concat(l(e,t).dangerousChanges,b(e,t),E(e,t),_(e,t),h(e,t).dangerousChanges)},t.findRemovedTypes=c,t.findTypesThatChangedKind=u,t.findArgChanges=l,t.findFieldsThatChangedTypeOnObjectOrInterfaceTypes=d,t.findFieldsThatChangedTypeOnInputObjectTypes=h,t.findTypesRemovedFromUnions=m,t.findTypesAddedToUnions=_,t.findValuesRemovedFromEnums=y,t.findValuesAddedToEnums=b,t.findInterfacesRemovedFromObjectTypes=v,t.findInterfacesAddedToObjectTypes=E,t.findRemovedDirectives=S,t.findRemovedDirectiveArgs=T,t.findAddedNonNullDirectiveArgs=w,t.findRemovedLocationsForDirective=x,t.findRemovedDirectiveLocations=A;var s,n=r(63754),i=(s=(r(38685),r(14648),r(94590)))&&s.__esModule?s:{default:s},o=t.BreakingChangeType={FIELD_CHANGED_KIND:"FIELD_CHANGED_KIND",FIELD_REMOVED:"FIELD_REMOVED",TYPE_CHANGED_KIND:"TYPE_CHANGED_KIND",TYPE_REMOVED:"TYPE_REMOVED",TYPE_REMOVED_FROM_UNION:"TYPE_REMOVED_FROM_UNION",VALUE_REMOVED_FROM_ENUM:"VALUE_REMOVED_FROM_ENUM",ARG_REMOVED:"ARG_REMOVED",ARG_CHANGED_KIND:"ARG_CHANGED_KIND",NON_NULL_ARG_ADDED:"NON_NULL_ARG_ADDED",NON_NULL_INPUT_FIELD_ADDED:"NON_NULL_INPUT_FIELD_ADDED",INTERFACE_REMOVED_FROM_OBJECT:"INTERFACE_REMOVED_FROM_OBJECT",DIRECTIVE_REMOVED:"DIRECTIVE_REMOVED",DIRECTIVE_ARG_REMOVED:"DIRECTIVE_ARG_REMOVED",DIRECTIVE_LOCATION_REMOVED:"DIRECTIVE_LOCATION_REMOVED",NON_NULL_DIRECTIVE_ARG_ADDED:"NON_NULL_DIRECTIVE_ARG_ADDED"},a=t.DangerousChangeType={ARG_DEFAULT_VALUE_CHANGE:"ARG_DEFAULT_VALUE_CHANGE",VALUE_ADDED_TO_ENUM:"VALUE_ADDED_TO_ENUM",INTERFACE_ADDED_TO_OBJECT:"INTERFACE_ADDED_TO_OBJECT",TYPE_ADDED_TO_UNION:"TYPE_ADDED_TO_UNION",NULLABLE_INPUT_FIELD_ADDED:"NULLABLE_INPUT_FIELD_ADDED",NULLABLE_ARG_ADDED:"NULLABLE_ARG_ADDED"};function c(e,t){var r=e.getTypeMap(),s=t.getTypeMap(),n=[];return Object.keys(r).forEach((function(e){s[e]||n.push({type:o.TYPE_REMOVED,description:e+" was removed."})})),n}function u(e,t){var r=e.getTypeMap(),s=t.getTypeMap(),n=[];return Object.keys(r).forEach((function(e){if(s[e]){var t=r[e],i=s[e];t.constructor!==i.constructor&&n.push({type:o.TYPE_CHANGED_KIND,description:e+" changed from "+p(t)+" to "+p(i)+"."})}})),n}function l(e,t){var r=e.getTypeMap(),s=t.getTypeMap(),i=[],c=[];return Object.keys(r).forEach((function(e){var t=r[e],u=s[e];if(((0,n.isObjectType)(t)||(0,n.isInterfaceType)(t))&&((0,n.isObjectType)(u)||(0,n.isInterfaceType)(u))&&u.constructor===t.constructor){var l=t.getFields(),p=u.getFields();Object.keys(l).forEach((function(e){p[e]&&(l[e].args.forEach((function(r){var s=p[e].args.find((function(e){return e.name===r.name}));s?g(r.type,s.type)?void 0!==r.defaultValue&&r.defaultValue!==s.defaultValue&&c.push({type:a.ARG_DEFAULT_VALUE_CHANGE,description:t.name+"."+e+" arg "+r.name+" has changed defaultValue"}):i.push({type:o.ARG_CHANGED_KIND,description:t.name+"."+e+" arg "+r.name+" has changed type from "+r.type.toString()+" to "+s.type.toString()}):i.push({type:o.ARG_REMOVED,description:t.name+"."+e+" arg "+r.name+" was removed"})})),p[e].args.forEach((function(t){l[e].args.find((function(e){return e.name===t.name}))||((0,n.isNonNullType)(t.type)?i.push({type:o.NON_NULL_ARG_ADDED,description:"A non-null arg "+t.name+" on "+u.name+"."+e+" was added"}):c.push({type:a.NULLABLE_ARG_ADDED,description:"A nullable arg "+t.name+" on "+u.name+"."+e+" was added"}))})))}))}})),{breakingChanges:i,dangerousChanges:c}}function p(e){if((0,n.isScalarType)(e))return"a Scalar type";if((0,n.isObjectType)(e))return"an Object type";if((0,n.isInterfaceType)(e))return"an Interface type";if((0,n.isUnionType)(e))return"a Union type";if((0,n.isEnumType)(e))return"an Enum type";if((0,n.isInputObjectType)(e))return"an Input type";throw new TypeError("Unknown type "+e.constructor.name)}function d(e,t){var r=e.getTypeMap(),s=t.getTypeMap(),i=[];return Object.keys(r).forEach((function(e){var t=r[e],a=s[e];if(((0,n.isObjectType)(t)||(0,n.isInterfaceType)(t))&&((0,n.isObjectType)(a)||(0,n.isInterfaceType)(a))&&a.constructor===t.constructor){var c=t.getFields(),u=a.getFields();Object.keys(c).forEach((function(t){if(t in u){var r=c[t].type,s=u[t].type;if(!f(r,s)){var a=(0,n.isNamedType)(r)?r.name:r.toString(),l=(0,n.isNamedType)(s)?s.name:s.toString();i.push({type:o.FIELD_CHANGED_KIND,description:e+"."+t+" changed type from "+a+" to "+l+"."})}}else i.push({type:o.FIELD_REMOVED,description:e+"."+t+" was removed."})}))}})),i}function h(e,t){var r=e.getTypeMap(),s=t.getTypeMap(),i=[],c=[];return Object.keys(r).forEach((function(e){var t=r[e],u=s[e];if((0,n.isInputObjectType)(t)&&(0,n.isInputObjectType)(u)){var l=t.getFields(),p=u.getFields();Object.keys(l).forEach((function(t){if(t in p){var r=l[t].type,s=p[t].type;if(!g(r,s)){var a=(0,n.isNamedType)(r)?r.name:r.toString(),c=(0,n.isNamedType)(s)?s.name:s.toString();i.push({type:o.FIELD_CHANGED_KIND,description:e+"."+t+" changed type from "+a+" to "+c+"."})}}else i.push({type:o.FIELD_REMOVED,description:e+"."+t+" was removed."})})),Object.keys(p).forEach((function(e){e in l||((0,n.isNonNullType)(p[e].type)?i.push({type:o.NON_NULL_INPUT_FIELD_ADDED,description:"A non-null field "+e+" on input type "+u.name+" was added."}):c.push({type:a.NULLABLE_INPUT_FIELD_ADDED,description:"A nullable field "+e+" on input type "+u.name+" was added."}))}))}})),{breakingChanges:i,dangerousChanges:c}}function f(e,t){return(0,n.isNamedType)(e)?(0,n.isNamedType)(t)&&e.name===t.name||(0,n.isNonNullType)(t)&&f(e,t.ofType):(0,n.isListType)(e)?(0,n.isListType)(t)&&f(e.ofType,t.ofType)||(0,n.isNonNullType)(t)&&f(e,t.ofType):!!(0,n.isNonNullType)(e)&&(0,n.isNonNullType)(t)&&f(e.ofType,t.ofType)}function g(e,t){return(0,n.isNamedType)(e)?(0,n.isNamedType)(t)&&e.name===t.name:(0,n.isListType)(e)?(0,n.isListType)(t)&&g(e.ofType,t.ofType):!!(0,n.isNonNullType)(e)&&((0,n.isNonNullType)(t)&&g(e.ofType,t.ofType)||!(0,n.isNonNullType)(t)&&g(e.ofType,t))}function m(e,t){var r=e.getTypeMap(),s=t.getTypeMap(),i=[];return Object.keys(r).forEach((function(e){var t=r[e],a=s[e];if((0,n.isUnionType)(t)&&(0,n.isUnionType)(a)){var c=Object.create(null);a.getTypes().forEach((function(e){c[e.name]=!0})),t.getTypes().forEach((function(t){c[t.name]||i.push({type:o.TYPE_REMOVED_FROM_UNION,description:t.name+" was removed from union type "+e+"."})}))}})),i}function _(e,t){var r=e.getTypeMap(),s=t.getTypeMap(),i=[];return Object.keys(s).forEach((function(e){var t=r[e],o=s[e];if((0,n.isUnionType)(t)&&(0,n.isUnionType)(o)){var c=Object.create(null);t.getTypes().forEach((function(e){c[e.name]=!0})),o.getTypes().forEach((function(t){c[t.name]||i.push({type:a.TYPE_ADDED_TO_UNION,description:t.name+" was added to union type "+e+"."})}))}})),i}function y(e,t){var r=e.getTypeMap(),s=t.getTypeMap(),i=[];return Object.keys(r).forEach((function(e){var t=r[e],a=s[e];if((0,n.isEnumType)(t)&&(0,n.isEnumType)(a)){var c=Object.create(null);a.getValues().forEach((function(e){c[e.name]=!0})),t.getValues().forEach((function(t){c[t.name]||i.push({type:o.VALUE_REMOVED_FROM_ENUM,description:t.name+" was removed from enum type "+e+"."})}))}})),i}function b(e,t){var r=e.getTypeMap(),s=t.getTypeMap(),i=[];return Object.keys(r).forEach((function(e){var t=r[e],o=s[e];if((0,n.isEnumType)(t)&&(0,n.isEnumType)(o)){var c=Object.create(null);t.getValues().forEach((function(e){c[e.name]=!0})),o.getValues().forEach((function(t){c[t.name]||i.push({type:a.VALUE_ADDED_TO_ENUM,description:t.name+" was added to enum type "+e+"."})}))}})),i}function v(e,t){var r=e.getTypeMap(),s=t.getTypeMap(),i=[];return Object.keys(r).forEach((function(e){var t=r[e],a=s[e];if((0,n.isObjectType)(t)&&(0,n.isObjectType)(a)){var c=t.getInterfaces(),u=a.getInterfaces();c.forEach((function(t){u.some((function(e){return e.name===t.name}))||i.push({type:o.INTERFACE_REMOVED_FROM_OBJECT,description:e+" no longer implements interface "+t.name+"."})}))}})),i}function E(e,t){var r=e.getTypeMap(),s=t.getTypeMap(),i=[];return Object.keys(s).forEach((function(e){var t=r[e],o=s[e];if((0,n.isObjectType)(t)&&(0,n.isObjectType)(o)){var c=t.getInterfaces();o.getInterfaces().forEach((function(t){c.some((function(e){return e.name===t.name}))||i.push({type:a.INTERFACE_ADDED_TO_OBJECT,description:t.name+" added to interfaces implemented by "+e+"."})}))}})),i}function S(e,t){var r=[],s=I(t);return e.getDirectives().forEach((function(e){s[e.name]||r.push({type:o.DIRECTIVE_REMOVED,description:e.name+" was removed"})})),r}function T(e,t){var r=[],s=I(e);return t.getDirectives().forEach((function(e){var t=s[e.name];t&&function(e,t){var r=[],s=k(t);return e.args.forEach((function(e){s[e.name]||r.push(e)})),r}(t,e).forEach((function(t){r.push({type:o.DIRECTIVE_ARG_REMOVED,description:t.name+" was removed from "+e.name})}))})),r}function w(e,t){var r=[],s=I(e);return t.getDirectives().forEach((function(e){var t=s[e.name];t&&function(e,t){var r=[],s=k(e);return t.args.forEach((function(e){s[e.name]||r.push(e)})),r}(t,e).forEach((function(t){(0,n.isNonNullType)(t.type)&&r.push({type:o.NON_NULL_DIRECTIVE_ARG_ADDED,description:"A non-null arg "+t.name+" on directive "+e.name+" was added"})}))})),r}function x(e,t){var r=[],s=new Set(t.locations);return e.locations.forEach((function(e){s.has(e)||r.push(e)})),r}function A(e,t){var r=[],s=I(e);return t.getDirectives().forEach((function(e){var t=s[e.name];t&&x(t,e).forEach((function(t){r.push({type:o.DIRECTIVE_LOCATION_REMOVED,description:t+" was removed from "+e.name})}))})),r}function I(e){return(0,i.default)(e.getDirectives(),(function(e){return e.name}))}function k(e){return(0,i.default)(e.args,(function(e){return e.name}))}},8959:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findDeprecatedUsages=function(e,t){var r=[],a=new o.TypeInfo(e);return(0,n.visit)(t,(0,n.visitWithTypeInfo)(a,{Field:function(e){var t=a.getFieldDef();if(t&&t.isDeprecated){var n=a.getParentType();if(n){var i=t.deprecationReason;r.push(new s.GraphQLError("The field "+n.name+"."+t.name+" is deprecated."+(i?" "+i:""),[e]))}}},EnumValue:function(e){var t=a.getEnumValue();if(t&&t.isDeprecated){var n=(0,i.getNamedType)(a.getInputType());if(n){var o=t.deprecationReason;r.push(new s.GraphQLError("The enum value "+n.name+"."+t.name+" is deprecated."+(o?" "+o:""),[e]))}}}})),r};var s=r(61702),n=r(9111),i=r(63754),o=(r(14648),r(27485))},13810:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOperationAST=function(e,t){for(var r=null,n=0;n<e.definitions.length;n++){var i=e.definitions[n];if(i.kind===s.Kind.OPERATION_DEFINITION)if(t){if(i.name&&i.name.value===t)return i}else{if(r)return null;r=i}}return r};var s=r(7030)},24889:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r(83172);Object.defineProperty(t,"getIntrospectionQuery",{enumerable:!0,get:function(){return s.getIntrospectionQuery}}),Object.defineProperty(t,"introspectionQuery",{enumerable:!0,get:function(){return s.introspectionQuery}});var n=r(13810);Object.defineProperty(t,"getOperationAST",{enumerable:!0,get:function(){return n.getOperationAST}});var i=r(95197);Object.defineProperty(t,"introspectionFromSchema",{enumerable:!0,get:function(){return i.introspectionFromSchema}});var o=r(56613);Object.defineProperty(t,"buildClientSchema",{enumerable:!0,get:function(){return o.buildClientSchema}});var a=r(70434);Object.defineProperty(t,"buildASTSchema",{enumerable:!0,get:function(){return a.buildASTSchema}}),Object.defineProperty(t,"buildSchema",{enumerable:!0,get:function(){return a.buildSchema}}),Object.defineProperty(t,"getDescription",{enumerable:!0,get:function(){return a.getDescription}});var c=r(21442);Object.defineProperty(t,"extendSchema",{enumerable:!0,get:function(){return c.extendSchema}});var u=r(47460);Object.defineProperty(t,"lexicographicSortSchema",{enumerable:!0,get:function(){return u.lexicographicSortSchema}});var l=r(91772);Object.defineProperty(t,"printSchema",{enumerable:!0,get:function(){return l.printSchema}}),Object.defineProperty(t,"printType",{enumerable:!0,get:function(){return l.printType}}),Object.defineProperty(t,"printIntrospectionSchema",{enumerable:!0,get:function(){return l.printIntrospectionSchema}});var p=r(6693);Object.defineProperty(t,"typeFromAST",{enumerable:!0,get:function(){return p.typeFromAST}});var d=r(72302);Object.defineProperty(t,"valueFromAST",{enumerable:!0,get:function(){return d.valueFromAST}});var h=r(78805);Object.defineProperty(t,"valueFromASTUntyped",{enumerable:!0,get:function(){return h.valueFromASTUntyped}});var f=r(38096);Object.defineProperty(t,"astFromValue",{enumerable:!0,get:function(){return f.astFromValue}});var g=r(27485);Object.defineProperty(t,"TypeInfo",{enumerable:!0,get:function(){return g.TypeInfo}});var m=r(68707);Object.defineProperty(t,"coerceValue",{enumerable:!0,get:function(){return m.coerceValue}});var _=r(79867);Object.defineProperty(t,"isValidJSValue",{enumerable:!0,get:function(){return _.isValidJSValue}});var y=r(67707);Object.defineProperty(t,"isValidLiteralValue",{enumerable:!0,get:function(){return y.isValidLiteralValue}});var b=r(73129);Object.defineProperty(t,"concatAST",{enumerable:!0,get:function(){return b.concatAST}});var v=r(41070);Object.defineProperty(t,"separateOperations",{enumerable:!0,get:function(){return v.separateOperations}});var E=r(73448);Object.defineProperty(t,"isEqualType",{enumerable:!0,get:function(){return E.isEqualType}}),Object.defineProperty(t,"isTypeSubTypeOf",{enumerable:!0,get:function(){return E.isTypeSubTypeOf}}),Object.defineProperty(t,"doTypesOverlap",{enumerable:!0,get:function(){return E.doTypesOverlap}});var S=r(68426);Object.defineProperty(t,"assertValidName",{enumerable:!0,get:function(){return S.assertValidName}}),Object.defineProperty(t,"isValidNameError",{enumerable:!0,get:function(){return S.isValidNameError}});var T=r(53666);Object.defineProperty(t,"BreakingChangeType",{enumerable:!0,get:function(){return T.BreakingChangeType}}),Object.defineProperty(t,"DangerousChangeType",{enumerable:!0,get:function(){return T.DangerousChangeType}}),Object.defineProperty(t,"findBreakingChanges",{enumerable:!0,get:function(){return T.findBreakingChanges}}),Object.defineProperty(t,"findDangerousChanges",{enumerable:!0,get:function(){return T.findDangerousChanges}});var w=r(8959);Object.defineProperty(t,"findDeprecatedUsages",{enumerable:!0,get:function(){return w.findDeprecatedUsages}})},95197:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.introspectionFromSchema=function(e,t){var r=(0,a.parse)((0,i.getIntrospectionQuery)(t)),s=(0,o.execute)(e,r);return(s.then||s.errors||!s.data)&&(0,n.default)(0),s.data};var s,n=(s=r(61321))&&s.__esModule?s:{default:s},i=r(83172),o=(r(14648),r(16892)),a=r(50246)},83172:(e,t)=>{"use strict";function r(e){var t=!(e&&!1===e.descriptions);return"\n    query IntrospectionQuery {\n      __schema {\n        queryType { name }\n        mutationType { name }\n        subscriptionType { name }\n        types {\n          ...FullType\n        }\n        directives {\n          name\n          "+(t?"description":"")+"\n          locations\n          args {\n            ...InputValue\n          }\n        }\n      }\n    }\n\n    fragment FullType on __Type {\n      kind\n      name\n      "+(t?"description":"")+"\n      fields(includeDeprecated: true) {\n        name\n        "+(t?"description":"")+"\n        args {\n          ...InputValue\n        }\n        type {\n          ...TypeRef\n        }\n        isDeprecated\n        deprecationReason\n      }\n      inputFields {\n        ...InputValue\n      }\n      interfaces {\n        ...TypeRef\n      }\n      enumValues(includeDeprecated: true) {\n        name\n        "+(t?"description":"")+"\n        isDeprecated\n        deprecationReason\n      }\n      possibleTypes {\n        ...TypeRef\n      }\n    }\n\n    fragment InputValue on __InputValue {\n      name\n      "+(t?"description":"")+"\n      type { ...TypeRef }\n      defaultValue\n    }\n\n    fragment TypeRef on __Type {\n      kind\n      name\n      ofType {\n        kind\n        name\n        ofType {\n          kind\n          name\n          ofType {\n            kind\n            name\n            ofType {\n              kind\n              name\n              ofType {\n                kind\n                name\n                ofType {\n                  kind\n                  name\n                  ofType {\n                    kind\n                    name\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  "}Object.defineProperty(t,"__esModule",{value:!0}),t.getIntrospectionQuery=r,t.introspectionQuery=r()},79867:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isValidJSValue=function(e,t){var r=(0,s.coerceValue)(e,t).errors;return r?r.map((function(e){return e.message})):[]};var s=r(68707)},67707:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isValidLiteralValue=function(e,t){var r=new a.GraphQLSchema({}),s={kind:i.Kind.DOCUMENT,definitions:[]},l=new n.TypeInfo(r,void 0,e),p=new u.default(r,s,l),d=(0,c.ValuesOfCorrectType)(p);return(0,o.visit)(t,(0,o.visitWithTypeInfo)(l,d)),p.getErrors()};var s,n=r(27485),i=r(7030),o=r(9111),a=r(14648),c=r(35947),u=(s=r(54782))&&s.__esModule?s:{default:s}},47460:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e};t.lexicographicSortSchema=function(e){var t=Object.create(null),r=function(e){return e&&y(e)};return new o.GraphQLSchema({types:_((0,i.default)(e.getTypeMap())),directives:h(e.getDirectives()).map((function(e){return new a.GraphQLDirective({name:e.name,description:e.description,locations:f(e.locations,(function(e){return e})),args:p(e.args),astNode:e.astNode})})),query:r(e.getQueryType()),mutation:r(e.getMutationType()),subscription:r(e.getSubscriptionType()),astNode:e.astNode});function p(e){return(0,n.default)(h(e),(function(e){return e.name}),(function(e){return s({},e,{type:m(e.type)})}))}function g(e){return d(e,(function(e){return{type:m(e.type),args:p(e.args),resolve:e.resolve,subscribe:e.subscribe,deprecationReason:e.deprecationReason,description:e.description,astNode:e.astNode}}))}function m(e){return(0,c.isListType)(e)?new c.GraphQLList(m(e.ofType)):(0,c.isNonNullType)(e)?new c.GraphQLNonNull(m(e.ofType)):y(e)}function _(e){return h(e).map(y)}function y(e){if((0,u.isSpecifiedScalarType)(e)||(0,l.isIntrospectionType)(e))return e;var r=t[e.name];return r||(r=function(e){if((0,c.isScalarType)(e))return e;if((0,c.isObjectType)(e))return new c.GraphQLObjectType({name:e.name,interfaces:function(){return _(e.getInterfaces())},fields:function(){return g(e.getFields())},isTypeOf:e.isTypeOf,description:e.description,astNode:e.astNode,extensionASTNodes:e.extensionASTNodes});if((0,c.isInterfaceType)(e))return new c.GraphQLInterfaceType({name:e.name,fields:function(){return g(e.getFields())},resolveType:e.resolveType,description:e.description,astNode:e.astNode,extensionASTNodes:e.extensionASTNodes});if((0,c.isUnionType)(e))return new c.GraphQLUnionType({name:e.name,types:function(){return _(e.getTypes())},resolveType:e.resolveType,description:e.description,astNode:e.astNode});if((0,c.isEnumType)(e))return new c.GraphQLEnumType({name:e.name,values:(0,n.default)(h(e.getValues()),(function(e){return e.name}),(function(e){return{value:e.value,deprecationReason:e.deprecationReason,description:e.description,astNode:e.astNode}})),description:e.description,astNode:e.astNode});if((0,c.isInputObjectType)(e))return new c.GraphQLInputObjectType({name:e.name,fields:function(){return d(e.getFields(),(function(e){return{type:m(e.type),defaultValue:e.defaultValue,description:e.description,astNode:e.astNode}}))},description:e.description,astNode:e.astNode});throw new Error('Unknown type: "'+e+'"')}(e),t[e.name]=r),r}};var n=p(r(65785)),i=p(r(26380)),o=r(14648),a=r(38685),c=r(63754),u=r(11062),l=r(8364);function p(e){return e&&e.__esModule?e:{default:e}}function d(e,t){var r=Object.create(null),s=f(Object.keys(e),(function(e){return e})),n=!0,i=!1,o=void 0;try{for(var a,c=s[Symbol.iterator]();!(n=(a=c.next()).done);n=!0){var u=a.value,l=e[u];r[u]=t?t(l):l}}catch(e){i=!0,o=e}finally{try{!n&&c.return&&c.return()}finally{if(i)throw o}}return r}function h(e){return f(e,(function(e){return e.name}))}function f(e,t){return e.slice().sort((function(e,r){var s=t(e),n=t(r);return s.localeCompare(n)}))}},91772:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.printSchema=function(e,t){return f(e,(function(e){return!(0,l.isSpecifiedDirective)(e)}),h,t)},t.printIntrospectionSchema=function(e,t){return f(e,l.isSpecifiedDirective,p.isIntrospectionType,t)},t.printType=m;var s=d(r(72530)),n=d(r(26166)),i=d(r(26380)),o=r(38096),a=r(70585),c=r(63754),u=r(11062),l=r(38685),p=r(8364);function d(e){return e&&e.__esModule?e:{default:e}}function h(e){return!(0,u.isSpecifiedScalarType)(e)&&!(0,p.isIntrospectionType)(e)}function f(e,t,r,s){var n=e.getDirectives().filter(t),o=e.getTypeMap(),a=(0,i.default)(o).sort((function(e,t){return e.name.localeCompare(t.name)})).filter(r);return[g(e)].concat(n.map((function(e){return function(e,t){return E(t,e)+"directive @"+e.name+y(t,e.args)+" on "+e.locations.join(" | ")}(e,s)})),a.map((function(e){return m(e,s)}))).filter(Boolean).join("\n\n")+"\n"}function g(e){if(!function(e){var t=e.getQueryType();if(t&&"Query"!==t.name)return!1;var r=e.getMutationType();if(r&&"Mutation"!==r.name)return!1;var s=e.getSubscriptionType();return!s||"Subscription"===s.name}(e)){var t=[],r=e.getQueryType();r&&t.push("  query: "+r.name);var s=e.getMutationType();s&&t.push("  mutation: "+s.name);var n=e.getSubscriptionType();return n&&t.push("  subscription: "+n.name),"schema {\n"+t.join("\n")+"\n}"}}function m(e,t){if((0,c.isScalarType)(e))return function(e,t){return E(t,e)+"scalar "+e.name}(e,t);if((0,c.isObjectType)(e))return function(e,t){var r=e.getInterfaces(),s=r.length?" implements "+r.map((function(e){return e.name})).join(" & "):"";return E(t,e)+"type "+e.name+s+" {\n"+_(t,e)+"\n}"}(e,t);if((0,c.isInterfaceType)(e))return function(e,t){return E(t,e)+"interface "+e.name+" {\n"+_(t,e)+"\n}"}(e,t);if((0,c.isUnionType)(e))return function(e,t){return E(t,e)+"union "+e.name+" = "+e.getTypes().join(" | ")}(e,t);if((0,c.isEnumType)(e))return function(e,t){return E(t,e)+"enum "+e.name+" {\n"+function(e,t){return e.map((function(e,r){return E(t,e,"  ",!r)+"  "+e.name+v(e)})).join("\n")}(e.getValues(),t)+"\n}"}(e,t);if((0,c.isInputObjectType)(e))return function(e,t){var r=(0,i.default)(e.getFields());return E(t,e)+"input "+e.name+" {\n"+r.map((function(e,r){return E(t,e,"  ",!r)+"  "+b(e)})).join("\n")+"\n}"}(e,t);throw new Error("Unknown type: "+e+".")}function _(e,t){return(0,i.default)(t.getFields()).map((function(t,r){return E(e,t,"  ",!r)+"  "+t.name+y(e,t.args,"  ")+": "+String(t.type)+v(t)})).join("\n")}function y(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return 0===t.length?"":t.every((function(e){return!e.description}))?"("+t.map(b).join(", ")+")":"(\n"+t.map((function(t,s){return E(e,t,"  "+r,!s)+"  "+r+b(t)})).join("\n")+"\n"+r+")"}function b(e){var t=e.name+": "+String(e.type);return(0,n.default)(e.defaultValue)||(t+=" = "+(0,a.print)((0,o.astFromValue)(e.defaultValue,e.type))),t}function v(e){if(!e.isDeprecated)return"";var t=e.deprecationReason;return(0,s.default)(t)||""===t||t===l.DEFAULT_DEPRECATION_REASON?" @deprecated":" @deprecated(reason: "+(0,a.print)((0,o.astFromValue)(t,u.GraphQLString))+")"}function E(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(!t.description)return"";var n=function(e,t){for(var r=[],s=e.split("\n"),n=0;n<s.length;n++)if(""===s[n])r.push(s[n]);else for(var i=T(s[n],t),o=0;o<i.length;o++)r.push(i[o]);return r}(t.description,120-r.length);if(e&&e.commentDescriptions)return function(e,t,r){for(var s=t&&!r?"\n":"",n=0;n<e.length;n++)""===e[n]?s+=t+"#\n":s+=t+"# "+e[n]+"\n";return s}(n,r,s);var i=r&&!s?"\n"+r+'"""':r+'"""';if(1===n.length&&n[0].length<70&&'"'!==n[0][n[0].length-1])return i+S(n[0])+'"""\n';var o=" "===n[0][0]||"\t"===n[0][0];o||(i+="\n");for(var a=0;a<n.length;a++)0===a&&o||(i+=r),i+=S(n[a])+"\n";return i+(r+'"""\n')}function S(e){return e.replace(/"""/g,'\\"""')}function T(e,t){if(e.length<t+5)return[e];var r=e.split(new RegExp("((?: |^).{15,"+(t-40)+"}(?= |$))"));if(r.length<4)return[e];for(var s=[r[0]+r[1]+r[2]],n=3;n<r.length;n+=2)s.push(r[n].slice(1)+r[n+1]);return s}},41070:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.separateOperations=function(e){var t=[],r=Object.create(null),o=new Map,a=Object.create(null),c=void 0,u=0;(0,s.visit)(e,{OperationDefinition:function(e){c=n(e),t.push(e),o.set(e,u++)},FragmentDefinition:function(e){c=e.name.value,r[c]=e,o.set(e,u++)},FragmentSpread:function(e){var t=e.name.value;(a[c]||(a[c]=Object.create(null)))[t]=!0}});var l=Object.create(null);return t.forEach((function(e){var t=n(e),s=Object.create(null);i(s,a,t);var c=[e];Object.keys(s).forEach((function(e){c.push(r[e])})),c.sort((function(e,t){return(o.get(e)||0)-(o.get(t)||0)})),l[t]={kind:"Document",definitions:c}})),l};var s=r(9111);function n(e){return e.name?e.name.value:""}function i(e,t,r){var s=t[r];s&&Object.keys(s).forEach((function(r){e[r]||(e[r]=!0,i(e,t,r))}))}},73448:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isEqualType=function e(t,r){return t===r||((0,s.isNonNullType)(t)&&(0,s.isNonNullType)(r)||!(!(0,s.isListType)(t)||!(0,s.isListType)(r)))&&e(t.ofType,r.ofType)},t.isTypeSubTypeOf=function e(t,r,n){return r===n||((0,s.isNonNullType)(n)?!!(0,s.isNonNullType)(r)&&e(t,r.ofType,n.ofType):(0,s.isNonNullType)(r)?e(t,r.ofType,n):(0,s.isListType)(n)?!!(0,s.isListType)(r)&&e(t,r.ofType,n.ofType):!(0,s.isListType)(r)&&!!((0,s.isAbstractType)(n)&&(0,s.isObjectType)(r)&&t.isPossibleType(n,r)))},t.doTypesOverlap=function(e,t,r){return t===r||((0,s.isAbstractType)(t)?(0,s.isAbstractType)(r)?e.getPossibleTypes(t).some((function(t){return e.isPossibleType(r,t)})):e.isPossibleType(t,r):!!(0,s.isAbstractType)(r)&&e.isPossibleType(r,t))};var s=r(63754)},6693:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.typeFromAST=function e(t,r){var i=void 0;if(r.kind===s.Kind.LIST_TYPE)return(i=e(t,r.type))&&(0,n.GraphQLList)(i);if(r.kind===s.Kind.NON_NULL_TYPE)return(i=e(t,r.type))&&(0,n.GraphQLNonNull)(i);if(r.kind===s.Kind.NAMED_TYPE)return t.getType(r.name.value);throw new Error("Unexpected type kind: "+r.kind+".")};var s=r(7030),n=r(63754)},72302:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.valueFromAST=function e(t,r,c){if(t){if((0,a.isNonNullType)(r)){if(t.kind===o.Kind.NULL)return;return e(t,r.ofType,c)}if(t.kind===o.Kind.NULL)return null;if(t.kind===o.Kind.VARIABLE){var l=t.name.value;if(!c||(0,n.default)(c[l]))return;return c[l]}if((0,a.isListType)(r)){var p=r.ofType;if(t.kind===o.Kind.LIST){for(var d=[],h=t.values,f=0;f<h.length;f++)if(u(h[f],c)){if((0,a.isNonNullType)(p))return;d.push(null)}else{var g=e(h[f],p,c);if((0,n.default)(g))return;d.push(g)}return d}var m=e(t,p,c);if((0,n.default)(m))return;return[m]}if((0,a.isInputObjectType)(r)){if(t.kind!==o.Kind.OBJECT)return;for(var _=Object.create(null),y=(0,s.default)(t.fields,(function(e){return e.name.value})),b=(0,i.default)(r.getFields()),v=0;v<b.length;v++){var E=b[v],S=y[E.name];if(S&&!u(S.value,c)){var T=e(S.value,E.type,c);if((0,n.default)(T))return;_[E.name]=T}else if((0,n.default)(E.defaultValue)){if((0,a.isNonNullType)(E.type))return}else _[E.name]=E.defaultValue}return _}if((0,a.isEnumType)(r)){if(t.kind!==o.Kind.ENUM)return;var w=r.getValue(t.value);if(!w)return;return w.value}if((0,a.isScalarType)(r)){var x=void 0;try{x=r.parseLiteral(t,c)}catch(e){return}if((0,n.default)(x))return;return x}throw new Error("Unknown type: "+r+".")}};var s=c(r(94590)),n=c(r(26166)),i=c(r(26380)),o=r(7030),a=r(63754);function c(e){return e&&e.__esModule?e:{default:e}}function u(e,t){return e.kind===o.Kind.VARIABLE&&(!t||(0,n.default)(t[e.name.value]))}},78805:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.valueFromASTUntyped=function e(t,r){switch(t.kind){case i.Kind.NULL:return null;case i.Kind.INT:return parseInt(t.value,10);case i.Kind.FLOAT:return parseFloat(t.value);case i.Kind.STRING:case i.Kind.ENUM:case i.Kind.BOOLEAN:return t.value;case i.Kind.LIST:return t.values.map((function(t){return e(t,r)}));case i.Kind.OBJECT:return(0,s.default)(t.fields,(function(e){return e.name.value}),(function(t){return e(t.value,r)}));case i.Kind.VARIABLE:var o=t.name.value;return r&&!(0,n.default)(r[o])?r[o]:void 0}throw new Error("Unexpected value kind: "+t.kind)};var s=o(r(65785)),n=o(r(26166)),i=r(7030);function o(e){return e&&e.__esModule?e:{default:e}}},54782:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(79211);var s=r(9111),n=r(7030),i=(r(14648),r(27485)),o=function(){function e(t,r,s){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._schema=t,this._ast=r,this._typeInfo=s,this._errors=[],this._fragmentSpreads=new Map,this._recursivelyReferencedFragments=new Map,this._variableUsages=new Map,this._recursiveVariableUsages=new Map}return e.prototype.reportError=function(e){this._errors.push(e)},e.prototype.getErrors=function(){return this._errors},e.prototype.getSchema=function(){return this._schema},e.prototype.getDocument=function(){return this._ast},e.prototype.getFragment=function(e){var t=this._fragments;return t||(this._fragments=t=this.getDocument().definitions.reduce((function(e,t){return t.kind===n.Kind.FRAGMENT_DEFINITION&&(e[t.name.value]=t),e}),Object.create(null))),t[e]},e.prototype.getFragmentSpreads=function(e){var t=this._fragmentSpreads.get(e);if(!t){t=[];for(var r=[e];0!==r.length;)for(var s=r.pop(),i=0;i<s.selections.length;i++){var o=s.selections[i];o.kind===n.Kind.FRAGMENT_SPREAD?t.push(o):o.selectionSet&&r.push(o.selectionSet)}this._fragmentSpreads.set(e,t)}return t},e.prototype.getRecursivelyReferencedFragments=function(e){var t=this._recursivelyReferencedFragments.get(e);if(!t){t=[];for(var r=Object.create(null),s=[e.selectionSet];0!==s.length;)for(var n=s.pop(),i=this.getFragmentSpreads(n),o=0;o<i.length;o++){var a=i[o].name.value;if(!0!==r[a]){r[a]=!0;var c=this.getFragment(a);c&&(t.push(c),s.push(c.selectionSet))}}this._recursivelyReferencedFragments.set(e,t)}return t},e.prototype.getVariableUsages=function(e){var t=this._variableUsages.get(e);if(!t){var r=[],n=new i.TypeInfo(this._schema);(0,s.visit)(e,(0,s.visitWithTypeInfo)(n,{VariableDefinition:function(){return!1},Variable:function(e){r.push({node:e,type:n.getInputType()})}})),t=r,this._variableUsages.set(e,t)}return t},e.prototype.getRecursiveVariableUsages=function(e){var t=this._recursiveVariableUsages.get(e);if(!t){t=this.getVariableUsages(e);for(var r=this.getRecursivelyReferencedFragments(e),s=0;s<r.length;s++)Array.prototype.push.apply(t,this.getVariableUsages(r[s]));this._recursiveVariableUsages.set(e,t)}return t},e.prototype.getType=function(){return this._typeInfo.getType()},e.prototype.getParentType=function(){return this._typeInfo.getParentType()},e.prototype.getInputType=function(){return this._typeInfo.getInputType()},e.prototype.getParentInputType=function(){return this._typeInfo.getParentInputType()},e.prototype.getFieldDef=function(){return this._typeInfo.getFieldDef()},e.prototype.getDirective=function(){return this._typeInfo.getDirective()},e.prototype.getArgument=function(){return this._typeInfo.getArgument()},e}();t.default=o},35947:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.badValueMessage=p,t.requiredFieldMessage=d,t.unknownFieldMessage=h,t.ValuesOfCorrectType=function(e){return{NullValue:function(t){var r=e.getInputType();(0,i.isNonNullType)(r)&&e.reportError(new s.GraphQLError(p(String(r),(0,n.print)(t)),t))},ListValue:function(t){var r=(0,i.getNullableType)(e.getParentInputType());if(!(0,i.isListType)(r))return f(e,t),!1},ObjectValue:function(t){var r=(0,i.getNamedType)(e.getInputType());if(!(0,i.isInputObjectType)(r))return f(e,t),!1;var n=r.getFields(),o=(0,a.default)(t.fields,(function(e){return e.name.value}));Object.keys(n).forEach((function(a){var c=n[a].type;!o[a]&&(0,i.isNonNullType)(c)&&e.reportError(new s.GraphQLError(d(r.name,a,String(c)),t))}))},ObjectField:function(t){var r=(0,i.getNamedType)(e.getParentInputType());if(!e.getInputType()&&(0,i.isInputObjectType)(r)){var n=(0,u.default)(t.name.value,Object.keys(r.getFields())),o=0!==n.length?"Did you mean "+(0,c.default)(n)+"?":void 0;e.reportError(new s.GraphQLError(h(r.name,t.name.value,o),t))}},EnumValue:function(t){var r=(0,i.getNamedType)(e.getInputType());(0,i.isEnumType)(r)?r.getValue(t.value)||e.reportError(new s.GraphQLError(p(r.name,(0,n.print)(t),g(r,t)),t)):f(e,t)},IntValue:function(t){return f(e,t)},FloatValue:function(t){return f(e,t)},StringValue:function(t){return f(e,t)},BooleanValue:function(t){return f(e,t)}}};var s=r(79211),n=r(70585),i=r(63754),o=l(r(26166)),a=l(r(94590)),c=l(r(69652)),u=l(r(81709));function l(e){return e&&e.__esModule?e:{default:e}}function p(e,t,r){return"Expected type "+e+", found "+t+(r?"; "+r:".")}function d(e,t,r){return"Field "+e+"."+t+" of required type "+r+" was not provided."}function h(e,t,r){return'Field "'+t+'" is not defined by type '+e+(r?"; "+r:".")}function f(e,t){var r=e.getInputType();if(r){var a=(0,i.getNamedType)(r);if((0,i.isScalarType)(a))try{var c=a.parseLiteral(t,void 0);(0,o.default)(c)&&e.reportError(new s.GraphQLError(p(String(r),(0,n.print)(t)),t))}catch(i){e.reportError(new s.GraphQLError(p(String(r),(0,n.print)(t),i.message),t,void 0,void 0,void 0,i))}else e.reportError(new s.GraphQLError(p(String(r),(0,n.print)(t),g(a,t)),t))}}function g(e,t){if((0,i.isEnumType)(e)){var r=(0,u.default)((0,n.print)(t),e.getValues().map((function(e){return e.name})));if(0!==r.length)return"Did you mean the enum value "+(0,c.default)(r)+"?"}}},82535:e=>{function t(e){return Array.isArray(e)?e:[e]}const r=/^\s+$/,s=/(?:[^\\]|^)\\$/,n=/^\\!/,i=/^\\#/,o=/\r?\n/g,a=/^\.*\/|^\.+$/;let c="node-ignore";"undefined"!=typeof Symbol&&(c=Symbol.for("node-ignore"));const u=c,l=/([0-z])-([0-z])/g,p=()=>!1,d=[[/^\uFEFF/,()=>""],[/\\?\s+$/,e=>0===e.indexOf("\\")?" ":""],[/\\\s/g,()=>" "],[/[\\$.|*+(){^]/g,e=>`\\${e}`],[/(?!\\)\?/g,()=>"[^/]"],[/^\//,()=>"^"],[/\//g,()=>"\\/"],[/^\^*\\\*\\\*\\\//,()=>"^(?:.*\\/)?"],[/^(?=[^^])/,function(){return/\/(?!$)/.test(this)?"^":"(?:^|\\/)"}],[/\\\/\\\*\\\*(?=\\\/|$)/g,(e,t,r)=>t+6<r.length?"(?:\\/[^\\/]+)*":"\\/.+"],[/(^|[^\\]+)(\\\*)+(?=.+)/g,(e,t,r)=>t+r.replace(/\\\*/g,"[^\\/]*")],[/\\\\\\(?=[$.|*+(){^])/g,()=>"\\"],[/\\\\/g,()=>"\\"],[/(\\)?\[([^\]/]*?)(\\*)($|\])/g,(e,t,r,s,n)=>"\\"===t?`\\[${r}${(e=>{const{length:t}=e;return e.slice(0,t-t%2)})(s)}${n}`:"]"===n&&s.length%2==0?`[${(e=>e.replace(l,((e,t,r)=>t.charCodeAt(0)<=r.charCodeAt(0)?e:"")))(r)}${s}]`:"[]"],[/(?:[^*])$/,e=>/\/$/.test(e)?`${e}$`:`${e}(?=$|\\/$)`],[/(\^|\\\/)?\\\*$/,(e,t)=>(t?`${t}[^/]+`:"[^/]*")+"(?=$|\\/$)"]],h=Object.create(null),f=e=>"string"==typeof e;class g{constructor(e,t,r,s){this.origin=e,this.pattern=t,this.negative=r,this.regex=s}}const m=(e,t)=>{throw new t(e)},_=(e,t,r)=>f(e)?e?!_.isNotRelative(e)||r(`path should be a \`path.relative()\`d string, but got "${t}"`,RangeError):r("path must not be empty",TypeError):r(`path must be a string, but got \`${t}\``,TypeError),y=e=>a.test(e);_.isNotRelative=y,_.convert=e=>e;class b{constructor({ignorecase:e=!0,ignoreCase:t=e,allowRelativePaths:r=!1}={}){var s;s=u,Object.defineProperty(this,s,{value:true}),this._rules=[],this._ignoreCase=t,this._allowRelativePaths=r,this._initCache()}_initCache(){this._ignoreCache=Object.create(null),this._testCache=Object.create(null)}_addPattern(e){if(e&&e[u])return this._rules=this._rules.concat(e._rules),void(this._added=!0);if((e=>e&&f(e)&&!r.test(e)&&!s.test(e)&&0!==e.indexOf("#"))(e)){const t=((e,t)=>{const r=e;let s=!1;0===e.indexOf("!")&&(s=!0,e=e.substr(1));const o=((e,t)=>{let r=h[e];return r||(r=d.reduce(((t,r)=>t.replace(r[0],r[1].bind(e))),e),h[e]=r),t?new RegExp(r,"i"):new RegExp(r)})(e=e.replace(n,"!").replace(i,"#"),t);return new g(r,e,s,o)})(e,this._ignoreCase);this._added=!0,this._rules.push(t)}}add(e){return this._added=!1,t(f(e)?(e=>e.split(o))(e):e).forEach(this._addPattern,this),this._added&&this._initCache(),this}addPattern(e){return this.add(e)}_testOne(e,t){let r=!1,s=!1;return this._rules.forEach((n=>{const{negative:i}=n;s===i&&r!==s||i&&!r&&!s&&!t||n.regex.test(e)&&(r=!i,s=i)})),{ignored:r,unignored:s}}_test(e,t,r,s){const n=e&&_.convert(e);return _(n,e,this._allowRelativePaths?p:m),this._t(n,t,r,s)}_t(e,t,r,s){if(e in t)return t[e];if(s||(s=e.split("/")),s.pop(),!s.length)return t[e]=this._testOne(e,r);const n=this._t(s.join("/")+"/",t,r,s);return t[e]=n.ignored?n:this._testOne(e,r)}ignores(e){return this._test(e,this._ignoreCache,!1).ignored}createFilter(){return e=>!this.ignores(e)}filter(e){return t(e).filter(this.createFilter())}test(e){return this._test(e,this._testCache,!0)}}const v=e=>new b(e);if(v.isPathValid=e=>_(e&&_.convert(e),e,p),v.default=v,e.exports=v,"undefined"!=typeof process&&(process.env&&process.env.IGNORE_TEST_WIN32||"win32"===process.platform)){const e=e=>/^\\\\\?\\/.test(e)||/["<>|\u0000-\u001F]+/u.test(e)?e:e.replace(/\\/g,"/");_.convert=e;const t=/^[a-z]:\//i;_.isNotRelative=e=>t.test(e)||y(e)}},30616:(e,t,r)=>{const s=r(16928),n=r(55335),{fileURLToPath:i}=r(87016),{MessageChannel:o}=r(28167),{importHooks:a,specifiers:c,toHook:u}=r(16467);function l(e){a.push(e),u.forEach((([t,r])=>e(t,r)))}function p(e){const t=a.indexOf(e);t>-1&&a.splice(t,1)}function d(e,t,r,s){const n=e(t,r,s);n&&n!==t&&(t.default=n)}let h;function f(e,t,r){if(this instanceof f==0)return new f(e,t,r);"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null);const o=!!t&&!0===t.internals;h&&Array.isArray(e)&&h(e),this._iitmHook=(t,a)=>{const u=t;let l;if(t.startsWith("node:"))t=t.replace(/^node:/,"");else{if(t.startsWith("file://"))try{t=i(t)}catch(e){}const e=n(t);e&&(t=e.name,l=e.basedir)}if(e){for(const n of e)if(n===t){if(l)if(o)t=t+s.sep+s.relative(l,i(u));else if(!l.endsWith(c.get(u)))continue;d(r,a,t,l)}}else d(r,a,t,l)},l(this._iitmHook)}f.prototype.unhook=function(){p(this._iitmHook)},e.exports=f,e.exports.Hook=f,e.exports.addHook=l,e.exports.removeHook=p,e.exports.createAddHookMessageChannel=function(){const{port1:e,port2:t}=new o;let r,s=0;return h=t=>{s++,e.postMessage(t)},e.on("message",(()=>{s--,r&&s<=0&&r()})).unref(),{registerOptions:{data:{addHookMessagePort:t,include:[]},transferList:[t]},addHookMessagePort:t,waitForAllMessagesAcknowledged:function(){const e=setInterval((()=>{}),1e3),t=new Promise((e=>{r=e})).then((()=>{clearInterval(e)}));return 0===s&&r(),t}}}},16467:(e,t)=>{const r=[],s=new WeakMap,n=new WeakMap,i=new Map,o=[],a={set:(e,t,r)=>s.get(e)[t](r),get(e,t){if(t===Symbol.toStringTag)return"Module";const r=n.get(e)[t];return"function"==typeof r?r():void 0},defineProperty(e,t,r){if(!("value"in r))throw new Error("Getters/setters are not supported for exports property descriptors.");return s.get(e)[t](r.value)}};t.register=function(e,t,c,u,l){i.set(e,l),s.set(t,c),n.set(t,u);const p=new Proxy(t,a);r.forEach((t=>t(e,p))),o.push([e,p])},t.importHooks=r,t.specifiers=i,t.toHook=o},51958:(e,t,r)=>{"use strict";const{FileCoverage:s}=r(24709),{CoverageMap:n}=r(53561),{CoverageSummary:i}=r(99455);e.exports={createCoverageSummary:e=>e&&e instanceof i?e:new i(e),createCoverageMap:e=>e&&e instanceof n?e:new n(e),createFileCoverage:e=>e&&e instanceof s?e:new s(e)},e.exports.classes={FileCoverage:s}},53561:(e,t,r)=>{"use strict";const{FileCoverage:s}=r(24709),{CoverageSummary:n}=r(99455);function i(e,t){return e instanceof t?e:new t(e)}class o{constructor(e){this.data=e instanceof o?e.data:function(e){const t=Object.create(null);return e?(Object.entries(e).forEach((([e,r])=>{t[e]=i(r,s)})),t):t}(e)}merge(e){const t=i(e,o);Object.values(t.data).forEach((e=>{this.addFileCoverage(e)}))}filter(e){Object.keys(this.data).forEach((t=>{e(t)||delete this.data[t]}))}toJSON(){return this.data}files(){return Object.keys(this.data)}fileCoverageFor(e){const t=this.data[e];if(!t)throw new Error(`No file coverage available for: ${e}`);return t}addFileCoverage(e){const t=new s(e),{path:r}=t;this.data[r]?this.data[r].merge(t):this.data[r]=t}getCoverageSummary(){const e=new n;return Object.values(this.data).forEach((t=>{e.merge(t.toSummary())})),e}}e.exports={CoverageMap:o}},99455:(e,t,r)=>{"use strict";const s=r(92735),n=r(90020);class i{constructor(e){this.data=e?e instanceof i?e.data:e:{lines:{total:0,covered:0,skipped:0,pct:"Unknown"},statements:{total:0,covered:0,skipped:0,pct:"Unknown"},functions:{total:0,covered:0,skipped:0,pct:"Unknown"},branches:{total:0,covered:0,skipped:0,pct:"Unknown"},branchesTrue:{total:0,covered:0,skipped:0,pct:"Unknown"}},function(e){if(!(e&&e.lines&&e.statements&&e.functions&&e.branches))throw new Error("Invalid summary coverage object, missing keys, found:"+Object.keys(e).join(","))}(this.data)}merge(e){return["lines","statements","branches","functions","branchesTrue"].forEach((t=>{e[t]&&(this[t].total+=e[t].total,this[t].covered+=e[t].covered,this[t].skipped+=e[t].skipped,this[t].pct=s(this[t].covered,this[t].total))})),this}toJSON(){return this.data}isEmpty(){return 0===this.lines.total}}n(i,["lines","statements","functions","branches","branchesTrue"]),e.exports={CoverageSummary:i}},90020:e=>{"use strict";e.exports=function(e,t){t.forEach((t=>{Object.defineProperty(e.prototype,t,{enumerable:!0,get(){return this.data[t]}})}))}},24709:(e,t,r)=>{"use strict";const s=r(92735),n=r(90020),{CoverageSummary:i}=r(99455),o=({start:e,end:t})=>`${e.line}|${e.column}|${t.line}|${t.column}`,a=(e,t,r,s,n=o)=>{const i={};for(const[r,s]of Object.entries(e)){const e=t[r];i[n(e)]=[s,e]}for(const[e,t]of Object.entries(r)){const r=s[e],o=n(r);if(i[o]){const e=i[o];t.forEach?t.forEach(((t,r)=>{void 0!==e[0][r]?e[0][r]+=t:e[0][r]=t})):e[0]+=t}else i[o]=[t,r]}const a={},c={};return Object.values(i).forEach((([e,t],r)=>{a[r]=e,c[r]=t})),[a,c]};class c{constructor(e,t=!1){if(!e)throw new Error("Coverage must be initialized with a path or an object");if("string"==typeof e)this.data=function(e,t){const r={path:e,statementMap:{},fnMap:{},branchMap:{},s:{},f:{},b:{}};return t&&(r.bT={}),r}(e,t);else if(e instanceof c)this.data=e.data;else{if("object"!=typeof e)throw new Error("Invalid argument to coverage constructor");this.data=e}!function(e){if(!(e&&e.path&&e.statementMap&&e.fnMap&&e.branchMap&&e.s&&e.f&&e.b))throw new Error("Invalid file coverage object, missing keys, found:"+Object.keys(e).join(","))}(this.data)}getLineCoverage(){const e=this.data.statementMap,t=this.data.s,r=Object.create(null);return Object.entries(t).forEach((([t,s])=>{if(!e[t])return;const{line:n}=e[t].start,i=r[n];(void 0===i||i<s)&&(r[n]=s)})),r}getUncoveredLines(){const e=this.getLineCoverage(),t=[];return Object.entries(e).forEach((([e,r])=>{0===r&&t.push(e)})),t}getBranchCoverageByLine(){const e=this.branchMap,t=this.b,r={};return Object.entries(e).forEach((([e,s])=>{const n=s.line||s.loc.start.line,i=t[e];r[n]=r[n]||[],r[n].push(...i)})),Object.entries(r).forEach((([e,t])=>{const s=t.filter((e=>e>0)),n=s.length/t.length*100;r[e]={covered:s.length,total:t.length,coverage:n}})),r}toJSON(){return this.data}merge(e){if(!0===e.all)return;if(!0===this.all)return void(this.data=e.data);let[t,r]=a(this.s,this.statementMap,e.s,e.statementMap);this.data.s=t,this.data.statementMap=r;const s=e=>o(e.locations[0]);[t,r]=a(this.f,this.fnMap,e.f,e.fnMap,(e=>o(e.loc))),this.data.f=t,this.data.fnMap=r,[t,r]=a(this.b,this.branchMap,e.b,e.branchMap,s),this.data.b=t,this.data.branchMap=r,this.bT&&e.bT&&([t,r]=a(this.bT,this.branchMap,e.bT,e.branchMap,s),this.data.bT=t)}computeSimpleTotals(e){let t=this[e];"function"==typeof t&&(t=t.call(this));const r={total:Object.keys(t).length,covered:Object.values(t).filter((e=>!!e)).length,skipped:0};return r.pct=s(r.covered,r.total),r}computeBranchTotals(e){const t=this[e],r={total:0,covered:0,skipped:0};return Object.values(t).forEach((e=>{r.covered+=e.filter((e=>e>0)).length,r.total+=e.length})),r.pct=s(r.covered,r.total),r}resetHits(){const e=this.s,t=this.f,r=this.b,s=this.bT;Object.keys(e).forEach((t=>{e[t]=0})),Object.keys(t).forEach((e=>{t[e]=0})),Object.keys(r).forEach((e=>{r[e].fill(0)})),s&&Object.keys(s).forEach((e=>{s[e].fill(0)}))}toSummary(){const e={};return e.lines=this.computeSimpleTotals("getLineCoverage"),e.functions=this.computeSimpleTotals("f","fnMap"),e.statements=this.computeSimpleTotals("s","statementMap"),e.branches=this.computeBranchTotals("b"),this.bt&&(e.branchesTrue=this.computeBranchTotals("bT")),new i(e)}}n(c,["path","statementMap","fnMap","branchMap","s","f","b","bT","all"]),e.exports={FileCoverage:c}},92735:e=>{"use strict";e.exports=function(e,t){let r;return t>0?(r=1e5*e/t,Math.floor(r/10)/100):100}},73118:(e,t,r)=>{"use strict";function s(){const e=r(70857);return s=function(){return e},e}function n(){const e=(t=r(81671))&&t.__esModule?t:{default:t};var t;return n=function(){return e},e}Object.defineProperty(t,"__esModule",{value:!0}),t.extract=function(e){const t=e.match(a);return t?t[0].trimLeft():""},t.parse=function(e){return f(e).pragmas},t.parseWithComments=f,t.print=function({comments:e="",pragmas:t={}}){const r=(0,n().default)(e)??s().EOL,i=" *",o=Object.keys(t),a=o.flatMap((e=>g(e,t[e]))).map((e=>`${i} ${e}${r}`)).join("");if(!e){if(0===o.length)return"";if(1===o.length&&!Array.isArray(t[o[0]])){const e=t[o[0]];return`/** ${g(o[0],e)[0]} */`}}const c=e.split(r).map((e=>`${i} ${e}`)).join(r)+r;return"/**"+r+(e?c:"")+(e&&o.length?i+r:"")+a+" */"},t.strip=function(e){const t=e.match(a);return t&&t[0]?e.substring(t[0].length):e};const i=/\*\/$/,o=/^\/\*\*?/,a=/^\s*(\/\*\*?(.|\r?\n)*?\*\/)/,c=/(^|\s+)\/\/([^\r\n]*)/g,u=/^(\r?\n)+/,l=/(?:^|\r?\n) *(@[^\r\n]*?) *\r?\n *(?![^@\r\n]*\/\/[^]*)([^@\r\n\s][^@\r\n]+?) *\r?\n/g,p=/(?:^|\r?\n) *@(\S+) *([^\r\n]*)/g,d=/(\r?\n|^) *\* ?/g,h=[];function f(e){const t=(0,n().default)(e)??s().EOL;e=e.replace(o,"").replace(i,"").replace(d,"$1");let r="";for(;r!==e;)r=e,e=e.replace(l,`${t}$1 $2${t}`);e=e.replace(u,"").trimRight();const a=Object.create(null),f=e.replace(p,"").replace(u,"").trimRight();let g;for(;g=p.exec(e);){const e=g[2].replace(c,"");"string"==typeof a[g[1]]||Array.isArray(a[g[1]])?a[g[1]]=h.concat(a[g[1]],e):a[g[1]]=e}return{comments:f,pragmas:a}}function g(e,t){return h.concat(t).map((t=>`@${e} ${t}`.trim()))}},96538:e=>{"use strict";e.exports=function(){for(var e,t,r=arguments.length,s=0;s<r;s++)if(null!=(t=e=arguments[s])&&t==t)return e;return e}},19439:(e,t,r)=>{t.RateLimiter=r(33065),t.TokenBucket=r(75472)},43085:e=>{e.exports=function(){if("undefined"!=typeof process&&process.hrtime){var e=process.hrtime(),t=e[0],r=e[1];return 1e3*t+Math.floor(r/1e6)}return(new Date).getTime()}},33065:(e,t,r)=>{var s=r(75472),n=r(43085),i=function(e,t,r){this.tokenBucket=new s(e,e,t,null),this.tokenBucket.content=e,this.curIntervalStart=n(),this.tokensThisInterval=0,this.fireImmediately=r};i.prototype={tokenBucket:null,curIntervalStart:0,tokensThisInterval:0,fireImmediately:!1,removeTokens:function(e,t){if(e>this.tokenBucket.bucketSize)return process.nextTick(t.bind(null,"Requested tokens "+e+" exceeds maximum tokens per interval "+this.tokenBucket.bucketSize,null)),!1;var r=this,s=n();if((s<this.curIntervalStart||s-this.curIntervalStart>=this.tokenBucket.interval)&&(this.curIntervalStart=s,this.tokensThisInterval=0),e>this.tokenBucket.tokensPerInterval-this.tokensThisInterval){if(this.fireImmediately)process.nextTick(t.bind(null,null,-1));else{var i=Math.ceil(this.curIntervalStart+this.tokenBucket.interval-s);setTimeout((function(){r.tokenBucket.removeTokens(e,o)}),i)}return!1}return this.tokenBucket.removeTokens(e,o);function o(s,n){if(s)return t(s,null);r.tokensThisInterval+=e,t(null,n)}},tryRemoveTokens:function(e){if(e>this.tokenBucket.bucketSize)return!1;var t=n();if((t<this.curIntervalStart||t-this.curIntervalStart>=this.tokenBucket.interval)&&(this.curIntervalStart=t,this.tokensThisInterval=0),e>this.tokenBucket.tokensPerInterval-this.tokensThisInterval)return!1;var r=this.tokenBucket.tryRemoveTokens(e);return r&&(this.tokensThisInterval+=e),r},getTokensRemaining:function(){return this.tokenBucket.drip(),this.tokenBucket.content}},e.exports=i},75472:e=>{var t=function(e,t,r,s){if(this.bucketSize=e,this.tokensPerInterval=t,"string"==typeof r)switch(r){case"sec":case"second":this.interval=1e3;break;case"min":case"minute":this.interval=6e4;break;case"hr":case"hour":this.interval=36e5;break;case"day":this.interval=864e5;break;default:throw new Error("Invaid interval "+r)}else this.interval=r;this.parentBucket=s,this.content=0,this.lastDrip=+new Date};t.prototype={bucketSize:1,tokensPerInterval:1,interval:1e3,parentBucket:null,content:0,lastDrip:0,removeTokens:function(e,t){var r=this;return this.bucketSize?e>this.bucketSize?(process.nextTick(t.bind(null,"Requested tokens "+e+" exceeds bucket size "+this.bucketSize,null)),!1):(this.drip(),e>this.content?s():this.parentBucket?this.parentBucket.removeTokens(e,(function(n,i){return n?t(n,null):e>r.content?s():(r.content-=e,void t(null,Math.min(i,r.content)))})):(this.content-=e,process.nextTick(t.bind(null,null,this.content)),!0)):(process.nextTick(t.bind(null,null,e,Number.POSITIVE_INFINITY)),!0);function s(){var s=Math.ceil((e-r.content)*(r.interval/r.tokensPerInterval));return setTimeout((function(){r.removeTokens(e,t)}),s),!1}},tryRemoveTokens:function(e){return!(this.bucketSize&&(e>this.bucketSize||(this.drip(),e>this.content||this.parentBucket&&!this.parentBucket.tryRemoveTokens(e)||(this.content-=e,0))))},drip:function(){if(this.tokensPerInterval){var e=+new Date,t=Math.max(e-this.lastDrip,0);this.lastDrip=e;var r=t*(this.tokensPerInterval/this.interval);this.content=Math.min(this.content+r,this.bucketSize)}else this.content=this.bucketSize}},e.exports=t},68479:(e,t,r)=>{e=r.nmd(e);var s="__lodash_hash_undefined__",n=9007199254740991,i="[object Arguments]",o="[object Array]",a="[object Boolean]",c="[object Date]",u="[object Error]",l="[object Function]",p="[object Map]",d="[object Number]",h="[object Object]",f="[object Promise]",g="[object RegExp]",m="[object Set]",_="[object String]",y="[object Symbol]",b="[object WeakMap]",v="[object ArrayBuffer]",E="[object DataView]",S=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,T=/^\w*$/,w=/^\./,x=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,A=/\\(\\)?/g,I=/^\[object .+?Constructor\]$/,k=/^(?:0|[1-9]\d*)$/,O={};O["[object Float32Array]"]=O["[object Float64Array]"]=O["[object Int8Array]"]=O["[object Int16Array]"]=O["[object Int32Array]"]=O["[object Uint8Array]"]=O["[object Uint8ClampedArray]"]=O["[object Uint16Array]"]=O["[object Uint32Array]"]=!0,O[i]=O[o]=O[v]=O[a]=O[E]=O[c]=O[u]=O[l]=O[p]=O[d]=O[h]=O[g]=O[m]=O[_]=O[b]=!1;var R="object"==typeof global&&global&&global.Object===Object&&global,C="object"==typeof self&&self&&self.Object===Object&&self,N=R||C||Function("return this")(),P=t&&!t.nodeType&&t,D=P&&e&&!e.nodeType&&e,L=D&&D.exports===P&&R.process,M=function(){try{return L&&L.binding("util")}catch(e){}}(),q=M&&M.isTypedArray;function j(e,t){for(var r=-1,s=e?e.length:0,n=Array(s);++r<s;)n[r]=t(e[r],r,e);return n}function U(e,t){for(var r=-1,s=t.length,n=e.length;++r<s;)e[n+r]=t[r];return e}function F(e,t){for(var r=-1,s=e?e.length:0;++r<s;)if(t(e[r],r,e))return!0;return!1}function B(e){return function(t){return e(t)}}function $(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}function G(e){var t=-1,r=Array(e.size);return e.forEach((function(e,s){r[++t]=[s,e]})),r}function V(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}var z,H,K,Y=Array.prototype,Q=Function.prototype,W=Object.prototype,Z=N["__core-js_shared__"],J=(z=/[^.]+$/.exec(Z&&Z.keys&&Z.keys.IE_PROTO||""))?"Symbol(src)_1."+z:"",X=Q.toString,ee=W.hasOwnProperty,te=W.toString,re=RegExp("^"+X.call(ee).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),se=N.Symbol,ne=N.Uint8Array,ie=W.propertyIsEnumerable,oe=Y.splice,ae=se?se.isConcatSpreadable:void 0,ce=(H=Object.keys,K=Object,function(e){return H(K(e))}),ue=Math.max,le=Ge(N,"DataView"),pe=Ge(N,"Map"),de=Ge(N,"Promise"),he=Ge(N,"Set"),fe=Ge(N,"WeakMap"),ge=Ge(Object,"create"),me=Xe(le),_e=Xe(pe),ye=Xe(de),be=Xe(he),ve=Xe(fe),Ee=se?se.prototype:void 0,Se=Ee?Ee.valueOf:void 0,Te=Ee?Ee.toString:void 0;function we(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var s=e[t];this.set(s[0],s[1])}}function xe(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var s=e[t];this.set(s[0],s[1])}}function Ae(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var s=e[t];this.set(s[0],s[1])}}function Ie(e){var t=-1,r=e?e.length:0;for(this.__data__=new Ae;++t<r;)this.add(e[t])}function ke(e){this.__data__=new xe(e)}function Oe(e,t){for(var r=e.length;r--;)if(rt(e[r][0],t))return r;return-1}we.prototype.clear=function(){this.__data__=ge?ge(null):{}},we.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},we.prototype.get=function(e){var t=this.__data__;if(ge){var r=t[e];return r===s?void 0:r}return ee.call(t,e)?t[e]:void 0},we.prototype.has=function(e){var t=this.__data__;return ge?void 0!==t[e]:ee.call(t,e)},we.prototype.set=function(e,t){return this.__data__[e]=ge&&void 0===t?s:t,this},xe.prototype.clear=function(){this.__data__=[]},xe.prototype.delete=function(e){var t=this.__data__,r=Oe(t,e);return!(r<0||(r==t.length-1?t.pop():oe.call(t,r,1),0))},xe.prototype.get=function(e){var t=this.__data__,r=Oe(t,e);return r<0?void 0:t[r][1]},xe.prototype.has=function(e){return Oe(this.__data__,e)>-1},xe.prototype.set=function(e,t){var r=this.__data__,s=Oe(r,e);return s<0?r.push([e,t]):r[s][1]=t,this},Ae.prototype.clear=function(){this.__data__={hash:new we,map:new(pe||xe),string:new we}},Ae.prototype.delete=function(e){return $e(this,e).delete(e)},Ae.prototype.get=function(e){return $e(this,e).get(e)},Ae.prototype.has=function(e){return $e(this,e).has(e)},Ae.prototype.set=function(e,t){return $e(this,e).set(e,t),this},Ie.prototype.add=Ie.prototype.push=function(e){return this.__data__.set(e,s),this},Ie.prototype.has=function(e){return this.__data__.has(e)},ke.prototype.clear=function(){this.__data__=new xe},ke.prototype.delete=function(e){return this.__data__.delete(e)},ke.prototype.get=function(e){return this.__data__.get(e)},ke.prototype.has=function(e){return this.__data__.has(e)},ke.prototype.set=function(e,t){var r=this.__data__;if(r instanceof xe){var s=r.__data__;if(!pe||s.length<199)return s.push([e,t]),this;r=this.__data__=new Ae(s)}return r.set(e,t),this};var Re,Ce=(Re=function(e,t){return e&&Pe(e,t,dt)},function(e,t){if(null==e)return e;if(!it(e))return Re(e,t);for(var r=e.length,s=-1,n=Object(e);++s<r&&!1!==t(n[s],s,n););return e});function Ne(e,t,r,s,n){var i=-1,o=e.length;for(r||(r=ze),n||(n=[]);++i<o;){var a=e[i];t>0&&r(a)?t>1?Ne(a,t-1,r,s,n):U(n,a):s||(n[n.length]=a)}return n}var Pe=function(e,t,r){for(var s=-1,n=Object(e),i=r(e),o=i.length;o--;){var a=i[++s];if(!1===t(n[a],a,n))break}return e};function De(e,t){for(var r=0,s=(t=Ye(t,e)?[t]:Ue(t)).length;null!=e&&r<s;)e=e[Je(t[r++])];return r&&r==s?e:void 0}function Le(e,t){return null!=e&&t in Object(e)}function Me(e,t,r,s,n){return e===t||(null==e||null==t||!ct(e)&&!ut(t)?e!=e&&t!=t:function(e,t,r,s,n,l){var f=nt(e),b=nt(t),S=o,T=o;f||(S=(S=Ve(e))==i?h:S),b||(T=(T=Ve(t))==i?h:T);var w=S==h&&!$(e),x=T==h&&!$(t),A=S==T;if(A&&!w)return l||(l=new ke),f||pt(e)?Be(e,t,r,s,n,l):function(e,t,r,s,n,i,o){switch(r){case E:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case v:return!(e.byteLength!=t.byteLength||!s(new ne(e),new ne(t)));case a:case c:case d:return rt(+e,+t);case u:return e.name==t.name&&e.message==t.message;case g:case _:return e==t+"";case p:var l=G;case m:var h=2&i;if(l||(l=V),e.size!=t.size&&!h)return!1;var f=o.get(e);if(f)return f==t;i|=1,o.set(e,t);var b=Be(l(e),l(t),s,n,i,o);return o.delete(e),b;case y:if(Se)return Se.call(e)==Se.call(t)}return!1}(e,t,S,r,s,n,l);if(!(2&n)){var I=w&&ee.call(e,"__wrapped__"),k=x&&ee.call(t,"__wrapped__");if(I||k){var O=I?e.value():e,R=k?t.value():t;return l||(l=new ke),r(O,R,s,n,l)}}return!!A&&(l||(l=new ke),function(e,t,r,s,n,i){var o=2&n,a=dt(e),c=a.length;if(c!=dt(t).length&&!o)return!1;for(var u=c;u--;){var l=a[u];if(!(o?l in t:ee.call(t,l)))return!1}var p=i.get(e);if(p&&i.get(t))return p==t;var d=!0;i.set(e,t),i.set(t,e);for(var h=o;++u<c;){var f=e[l=a[u]],g=t[l];if(s)var m=o?s(g,f,l,t,e,i):s(f,g,l,e,t,i);if(!(void 0===m?f===g||r(f,g,s,n,i):m)){d=!1;break}h||(h="constructor"==l)}if(d&&!h){var _=e.constructor,y=t.constructor;_==y||!("constructor"in e)||!("constructor"in t)||"function"==typeof _&&_ instanceof _&&"function"==typeof y&&y instanceof y||(d=!1)}return i.delete(e),i.delete(t),d}(e,t,r,s,n,l))}(e,t,Me,r,s,n))}function qe(e){return"function"==typeof e?e:null==e?ht:"object"==typeof e?nt(e)?function(e,t){return Ye(e)&&Qe(t)?We(Je(e),t):function(r){var s=function(e,t){var r=null==e?void 0:De(e,t);return void 0===r?void 0:r}(r,e);return void 0===s&&s===t?function(e,t){return null!=e&&function(e,t,r){for(var s,n=-1,i=(t=Ye(t,e)?[t]:Ue(t)).length;++n<i;){var o=Je(t[n]);if(!(s=null!=e&&r(e,o)))break;e=e[o]}return s||!!(i=e?e.length:0)&&at(i)&&He(o,i)&&(nt(e)||st(e))}(e,t,Le)}(r,e):Me(t,s,void 0,3)}}(e[0],e[1]):(r=function(e){for(var t=dt(e),r=t.length;r--;){var s=t[r],n=e[s];t[r]=[s,n,Qe(n)]}return t}(t=e),1==r.length&&r[0][2]?We(r[0][0],r[0][1]):function(e){return e===t||function(e,t,r,s){var n=r.length,i=n;if(null==e)return!i;for(e=Object(e);n--;){var o=r[n];if(o[2]?o[1]!==e[o[0]]:!(o[0]in e))return!1}for(;++n<i;){var a=(o=r[n])[0],c=e[a],u=o[1];if(o[2]){if(void 0===c&&!(a in e))return!1}else{var l,p=new ke;if(!(void 0===l?Me(u,c,s,3,p):l))return!1}}return!0}(e,0,r)}):Ye(s=e)?(n=Je(s),function(e){return null==e?void 0:e[n]}):function(e){return function(t){return De(t,e)}}(s);var t,r,s,n}function je(e,t,r){var s=-1;t=j(t.length?t:[ht],B(qe));var n=function(e,t){var r=-1,s=it(e)?Array(e.length):[];return Ce(e,(function(e,n,i){s[++r]=t(e)})),s}(e,(function(e,r,n){return{criteria:j(t,(function(t){return t(e)})),index:++s,value:e}}));return function(e){var t=e.length;for(e.sort((function(e,t){return function(e,t,r){for(var s=-1,n=e.criteria,i=t.criteria,o=n.length,a=r.length;++s<o;){var c=Fe(n[s],i[s]);if(c)return s>=a?c:c*("desc"==r[s]?-1:1)}return e.index-t.index}(e,t,r)}));t--;)e[t]=e[t].value;return e}(n)}function Ue(e){return nt(e)?e:Ze(e)}function Fe(e,t){if(e!==t){var r=void 0!==e,s=null===e,n=e==e,i=lt(e),o=void 0!==t,a=null===t,c=t==t,u=lt(t);if(!a&&!u&&!i&&e>t||i&&o&&c&&!a&&!u||s&&o&&c||!r&&c||!n)return 1;if(!s&&!i&&!u&&e<t||u&&r&&n&&!s&&!i||a&&r&&n||!o&&n||!c)return-1}return 0}function Be(e,t,r,s,n,i){var o=2&n,a=e.length,c=t.length;if(a!=c&&!(o&&c>a))return!1;var u=i.get(e);if(u&&i.get(t))return u==t;var l=-1,p=!0,d=1&n?new Ie:void 0;for(i.set(e,t),i.set(t,e);++l<a;){var h=e[l],f=t[l];if(s)var g=o?s(f,h,l,t,e,i):s(h,f,l,e,t,i);if(void 0!==g){if(g)continue;p=!1;break}if(d){if(!F(t,(function(e,t){if(!d.has(t)&&(h===e||r(h,e,s,n,i)))return d.add(t)}))){p=!1;break}}else if(h!==f&&!r(h,f,s,n,i)){p=!1;break}}return i.delete(e),i.delete(t),p}function $e(e,t){var r,s,n=e.__data__;return("string"==(s=typeof(r=t))||"number"==s||"symbol"==s||"boolean"==s?"__proto__"!==r:null===r)?n["string"==typeof t?"string":"hash"]:n.map}function Ge(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return function(e){return!(!ct(e)||function(e){return!!J&&J in e}(e))&&(ot(e)||$(e)?re:I).test(Xe(e))}(r)?r:void 0}var Ve=function(e){return te.call(e)};function ze(e){return nt(e)||st(e)||!!(ae&&e&&e[ae])}function He(e,t){return!!(t=null==t?n:t)&&("number"==typeof e||k.test(e))&&e>-1&&e%1==0&&e<t}function Ke(e,t,r){if(!ct(r))return!1;var s=typeof t;return!!("number"==s?it(r)&&He(t,r.length):"string"==s&&t in r)&&rt(r[t],e)}function Ye(e,t){if(nt(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!lt(e))||T.test(e)||!S.test(e)||null!=t&&e in Object(t)}function Qe(e){return e==e&&!ct(e)}function We(e,t){return function(r){return null!=r&&r[e]===t&&(void 0!==t||e in Object(r))}}(le&&Ve(new le(new ArrayBuffer(1)))!=E||pe&&Ve(new pe)!=p||de&&Ve(de.resolve())!=f||he&&Ve(new he)!=m||fe&&Ve(new fe)!=b)&&(Ve=function(e){var t=te.call(e),r=t==h?e.constructor:void 0,s=r?Xe(r):void 0;if(s)switch(s){case me:return E;case _e:return p;case ye:return f;case be:return m;case ve:return b}return t});var Ze=tt((function(e){var t;e=null==(t=e)?"":function(e){if("string"==typeof e)return e;if(lt(e))return Te?Te.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}(t);var r=[];return w.test(e)&&r.push(""),e.replace(x,(function(e,t,s,n){r.push(s?n.replace(A,"$1"):t||e)})),r}));function Je(e){if("string"==typeof e||lt(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function Xe(e){if(null!=e){try{return X.call(e)}catch(e){}try{return e+""}catch(e){}}return""}var et=function(e,t){return t=ue(void 0===t?e.length-1:t,0),function(){for(var r=arguments,s=-1,n=ue(r.length-t,0),i=Array(n);++s<n;)i[s]=r[t+s];s=-1;for(var o=Array(t+1);++s<t;)o[s]=r[s];return o[t]=i,function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}(e,this,o)}}((function(e,t){if(null==e)return[];var r=t.length;return r>1&&Ke(e,t[0],t[1])?t=[]:r>2&&Ke(t[0],t[1],t[2])&&(t=[t[0]]),je(e,Ne(t,1),[])}));function tt(e,t){if("function"!=typeof e||t&&"function"!=typeof t)throw new TypeError("Expected a function");var r=function(){var s=arguments,n=t?t.apply(this,s):s[0],i=r.cache;if(i.has(n))return i.get(n);var o=e.apply(this,s);return r.cache=i.set(n,o),o};return r.cache=new(tt.Cache||Ae),r}function rt(e,t){return e===t||e!=e&&t!=t}function st(e){return function(e){return ut(e)&&it(e)}(e)&&ee.call(e,"callee")&&(!ie.call(e,"callee")||te.call(e)==i)}tt.Cache=Ae;var nt=Array.isArray;function it(e){return null!=e&&at(e.length)&&!ot(e)}function ot(e){var t=ct(e)?te.call(e):"";return t==l||"[object GeneratorFunction]"==t}function at(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=n}function ct(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function ut(e){return!!e&&"object"==typeof e}function lt(e){return"symbol"==typeof e||ut(e)&&te.call(e)==y}var pt=q?B(q):function(e){return ut(e)&&at(e.length)&&!!O[te.call(e)]};function dt(e){return it(e)?function(e,t){var r=nt(e)||st(e)?function(e,t){for(var r=-1,s=Array(e);++r<e;)s[r]=t(r);return s}(e.length,String):[],s=r.length,n=!!s;for(var i in e)!t&&!ee.call(e,i)||n&&("length"==i||He(i,s))||r.push(i);return r}(e):function(e){if(r=(t=e)&&t.constructor,t!==("function"==typeof r&&r.prototype||W))return ce(e);var t,r,s=[];for(var n in Object(e))ee.call(e,n)&&"constructor"!=n&&s.push(n);return s}(e)}function ht(e){return e}e.exports=et},55335:(e,t,r)=>{"use strict";var s=r(16928);e.exports=function(e){var t=e.split(s.sep),r=t.lastIndexOf("node_modules");if(-1!==r&&t[r+1]){var n="@"===t[r+1][0],i=n?3:2;return{name:n?t[r+1]+"/"+t[r+2]:t[r+1],basedir:t.slice(0,r+i).join(s.sep),path:t.slice(r+i).join(s.sep)}}}},68169:(e,t,r)=>{var s=r(79896),n=r(16928),i=r(70857),o=require,a=!!process.env.PREBUILDS_ONLY,c=process.versions.modules,u=process.versions&&process.versions.electron||process.env.ELECTRON_RUN_AS_NODE||"undefined"!=typeof window&&window.process&&"renderer"===window.process.type?"electron":"node",l=i.arch(),p=i.platform(),d=process.env.LIBC||(function(e){return"linux"===e&&s.existsSync("/etc/alpine-release")}(p)?"musl":"glibc"),h=process.env.ARM_VERSION||("arm64"===l?"8":process.config.variables.arm_version)||"";function f(e){return o(f.path(e))}function g(e,t){try{var r=s.readdirSync(e).filter(t);return r[0]&&n.join(e,r[0])}catch(e){return null}}function m(e){return e===u+"-napi.node"}function _(e){return"node-napi.node"===e}function y(e){var t=e.split("-");return t[0]===u&&t[1]===c+".node"}function b(e){return/\.node$/.test(e)}e.exports=f,f.path=function(e){e=n.resolve(e||".");try{var t=o(n.join(e,"package.json")).name.toUpperCase().replace(/-/g,"_");process.env[t+"_PREBUILD"]&&(e=process.env[t+"_PREBUILD"])}catch(e){}if(!a){var r=g(n.join(e,"build/Release"),b);if(r)return r;var s=g(n.join(e,"build/Debug"),b);if(s)return s}var i=[p+"-"+l];d&&i.push(p+d+"-"+l),"arm"!==l&&"arm64"!==l||!h||i.forEach((function(e){i.push(e+"-v"+h)}));for(var f=i.length;f--;){var v=g(n.join(e,"prebuilds/"+i[f]),y);if(v)return v;var E=g(n.join(e,"prebuilds/"+i[f]),m);if(E)return E;var S=g(n.join(e,"prebuilds/"+i[f]),_);if(S)return S}throw new Error("No native build was found for runtime="+u+" abi="+c+" platform="+p+d+" arch="+l)}},90165:(e,t,r)=>{"use strict";const s=r(4693);e.exports=e=>{if(!Number.isInteger(e)&&e!==1/0||!(e>0))throw new TypeError("Expected `concurrency` to be a number from 1 and up");const t=new s;let r=0;const n=async(e,s,...n)=>{r++;const i=(async()=>e(...n))();s(i);try{await i}catch{}r--,t.size>0&&t.dequeue()()},i=(s,...i)=>new Promise((o=>{((s,i,...o)=>{t.enqueue(n.bind(null,s,i,...o)),(async()=>{await Promise.resolve(),r<e&&t.size>0&&t.dequeue()()})()})(s,o,...i)}));return Object.defineProperties(i,{activeCount:{get:()=>r},pendingCount:{get:()=>t.size},clearQueue:{value:()=>{t.clear()}}}),i}},35302:e=>{e.exports=function e(r,s,n){s=s||[];var i,o=(n=n||{}).strict,a=!1!==n.end,c=n.sensitive?"":"i",u=!1!==n.lookahead,l=0,p=s.length,d=0,h=0,f=0,g="";if(r instanceof RegExp){for(;i=t.exec(r.source);)"\\"!==i[0][0]&&s.push({name:i[1]||h++,optional:!1,offset:i.index});return r}if(Array.isArray(r))return r=r.map((function(t){return e(t,s,n).source})),new RegExp(r.join("|"),c);if("string"!=typeof r)throw new TypeError("path must be a string, array of strings, or regular expression");for(r=r.replace(/\\.|(\/)?(\.)?:(\w+)(\(.*?\))?(\*)?(\?)?|[.*]|\/\(/g,(function(e,t,n,i,o,a,c,u){if("\\"===e[0])return g+=e,f+=2,e;if("."===e)return g+="\\.",l+=1,f+=1,"\\.";if(t||n?g="":g+=r.slice(f,u),f=u+e.length,"*"===e)return l+=3,"(.*)";if("/("===e)return g+="/",l+=2,"/(?:";t=t||"",n=n?"\\.":"",c=c||"",o=o?o.replace(/\\.|\*/,(function(e){return"*"===e?"(.*)":e})):g?"((?:(?!/|"+g+").)+?)":"([^/"+n+"]+?)",s.push({name:i,optional:!!c,offset:u+l});var p="(?:"+n+t+o+(a?"((?:[/"+n+"].+?)?)":"")+")"+c;return l+=p.length-e.length,p}));i=t.exec(r);)"\\"!==i[0][0]&&((p+d===s.length||s[p+d].offset>i.index)&&s.splice(p+d,0,{name:h++,optional:!1,offset:i.index}),d++);return r+=o?"":"/"===r[r.length-1]?"?":"/?",a?r+="$":"/"!==r[r.length-1]&&(r+=u?"(?=/|$)":"(?:/|$)"),new RegExp("^"+r,c)};var t=/\\.|\((?:\?<(.*?)>)?(?!\?)/g},26946:(e,t,r)=>{"use strict";e.exports=r(24394)},24394:(e,t,r)=>{"use strict";var s=t;function n(){s.util._configure(),s.Writer._configure(s.BufferWriter),s.Reader._configure(s.BufferReader)}s.build="minimal",s.Writer=r(63449),s.BufferWriter=r(60818),s.Reader=r(16237),s.BufferReader=r(33158),s.util=r(93610),s.rpc=r(95047),s.roots=r(64529),s.configure=n,n()},16237:(e,t,r)=>{"use strict";e.exports=c;var s,n=r(93610),i=n.LongBits,o=n.utf8;function a(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function c(e){this.buf=e,this.pos=0,this.len=e.length}var u,l="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new c(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new c(e);throw Error("illegal buffer")},p=function(){return n.Buffer?function(e){return(c.create=function(e){return n.Buffer.isBuffer(e)?new s(e):l(e)})(e)}:l};function d(){var e=new i(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw a(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw a(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function h(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function f(){if(this.pos+8>this.len)throw a(this,8);return new i(h(this.buf,this.pos+=4),h(this.buf,this.pos+=4))}c.create=p(),c.prototype._slice=n.Array.prototype.subarray||n.Array.prototype.slice,c.prototype.uint32=(u=4294967295,function(){if(u=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return u;if((this.pos+=5)>this.len)throw this.pos=this.len,a(this,10);return u}),c.prototype.int32=function(){return 0|this.uint32()},c.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)},c.prototype.bool=function(){return 0!==this.uint32()},c.prototype.fixed32=function(){if(this.pos+4>this.len)throw a(this,4);return h(this.buf,this.pos+=4)},c.prototype.sfixed32=function(){if(this.pos+4>this.len)throw a(this,4);return 0|h(this.buf,this.pos+=4)},c.prototype.float=function(){if(this.pos+4>this.len)throw a(this,4);var e=n.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},c.prototype.double=function(){if(this.pos+8>this.len)throw a(this,4);var e=n.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},c.prototype.bytes=function(){var e=this.uint32(),t=this.pos,r=this.pos+e;if(r>this.len)throw a(this,e);if(this.pos+=e,Array.isArray(this.buf))return this.buf.slice(t,r);if(t===r){var s=n.Buffer;return s?s.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,t,r)},c.prototype.string=function(){var e=this.bytes();return o.read(e,0,e.length)},c.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw a(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw a(this)}while(128&this.buf[this.pos++]);return this},c.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},c._configure=function(e){s=e,c.create=p(),s._configure();var t=n.Long?"toLong":"toNumber";n.merge(c.prototype,{int64:function(){return d.call(this)[t](!1)},uint64:function(){return d.call(this)[t](!0)},sint64:function(){return d.call(this).zzDecode()[t](!1)},fixed64:function(){return f.call(this)[t](!0)},sfixed64:function(){return f.call(this)[t](!1)}})}},33158:(e,t,r)=>{"use strict";e.exports=i;var s=r(16237);(i.prototype=Object.create(s.prototype)).constructor=i;var n=r(93610);function i(e){s.call(this,e)}i._configure=function(){n.Buffer&&(i.prototype._slice=n.Buffer.prototype.slice)},i.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},i._configure()},64529:e=>{"use strict";e.exports={}},95047:(e,t,r)=>{"use strict";t.Service=r(27595)},27595:(e,t,r)=>{"use strict";e.exports=n;var s=r(93610);function n(e,t,r){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");s.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(r)}(n.prototype=Object.create(s.EventEmitter.prototype)).constructor=n,n.prototype.rpcCall=function e(t,r,n,i,o){if(!i)throw TypeError("request must be specified");var a=this;if(!o)return s.asPromise(e,a,t,r,n,i);if(a.rpcImpl)try{return a.rpcImpl(t,r[a.requestDelimited?"encodeDelimited":"encode"](i).finish(),(function(e,r){if(e)return a.emit("error",e,t),o(e);if(null!==r){if(!(r instanceof n))try{r=n[a.responseDelimited?"decodeDelimited":"decode"](r)}catch(e){return a.emit("error",e,t),o(e)}return a.emit("data",r,t),o(null,r)}a.end(!0)}))}catch(e){return a.emit("error",e,t),void setTimeout((function(){o(e)}),0)}else setTimeout((function(){o(Error("already ended"))}),0)},n.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},32239:(e,t,r)=>{"use strict";e.exports=n;var s=r(93610);function n(e,t){this.lo=e>>>0,this.hi=t>>>0}var i=n.zero=new n(0,0);i.toNumber=function(){return 0},i.zzEncode=i.zzDecode=function(){return this},i.length=function(){return 1};var o=n.zeroHash="\0\0\0\0\0\0\0\0";n.fromNumber=function(e){if(0===e)return i;var t=e<0;t&&(e=-e);var r=e>>>0,s=(e-r)/4294967296>>>0;return t&&(s=~s>>>0,r=~r>>>0,++r>4294967295&&(r=0,++s>4294967295&&(s=0))),new n(r,s)},n.from=function(e){if("number"==typeof e)return n.fromNumber(e);if(s.isString(e)){if(!s.Long)return n.fromNumber(parseInt(e,10));e=s.Long.fromString(e)}return e.low||e.high?new n(e.low>>>0,e.high>>>0):i},n.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,r=~this.hi>>>0;return t||(r=r+1>>>0),-(t+4294967296*r)}return this.lo+4294967296*this.hi},n.prototype.toLong=function(e){return s.Long?new s.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var a=String.prototype.charCodeAt;n.fromHash=function(e){return e===o?i:new n((a.call(e,0)|a.call(e,1)<<8|a.call(e,2)<<16|a.call(e,3)<<24)>>>0,(a.call(e,4)|a.call(e,5)<<8|a.call(e,6)<<16|a.call(e,7)<<24)>>>0)},n.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},n.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},n.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},n.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,r=this.hi>>>24;return 0===r?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:r<128?9:10}},93610:function(e,t,r){"use strict";var s=t;function n(e,t,r){for(var s=Object.keys(t),n=0;n<s.length;++n)void 0!==e[s[n]]&&r||(e[s[n]]=t[s[n]]);return e}function i(e){function t(e,r){if(!(this instanceof t))return new t(e,r);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),r&&n(this,r)}return t.prototype=Object.create(Error.prototype,{constructor:{value:t,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return e},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),t}s.asPromise=r(18045),s.base64=r(8839),s.EventEmitter=r(24358),s.float=r(49410),s.inquire=r(84153),s.utf8=r(81447),s.pool=r(99390),s.LongBits=r(32239),s.isNode=Boolean("undefined"!=typeof global&&global&&global.process&&global.process.versions&&global.process.versions.node),s.global=s.isNode&&global||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||this,s.emptyArray=Object.freeze?Object.freeze([]):[],s.emptyObject=Object.freeze?Object.freeze({}):{},s.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},s.isString=function(e){return"string"==typeof e||e instanceof String},s.isObject=function(e){return e&&"object"==typeof e},s.isset=s.isSet=function(e,t){var r=e[t];return!(null==r||!e.hasOwnProperty(t))&&("object"!=typeof r||(Array.isArray(r)?r.length:Object.keys(r).length)>0)},s.Buffer=function(){try{var e=s.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),s._Buffer_from=null,s._Buffer_allocUnsafe=null,s.newBuffer=function(e){return"number"==typeof e?s.Buffer?s._Buffer_allocUnsafe(e):new s.Array(e):s.Buffer?s._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},s.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,s.Long=s.global.dcodeIO&&s.global.dcodeIO.Long||s.global.Long||s.inquire("long"),s.key2Re=/^true|false|0|1$/,s.key32Re=/^-?(?:0|[1-9][0-9]*)$/,s.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,s.longToHash=function(e){return e?s.LongBits.from(e).toHash():s.LongBits.zeroHash},s.longFromHash=function(e,t){var r=s.LongBits.fromHash(e);return s.Long?s.Long.fromBits(r.lo,r.hi,t):r.toNumber(Boolean(t))},s.merge=n,s.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},s.newError=i,s.ProtocolError=i("ProtocolError"),s.oneOfGetter=function(e){for(var t={},r=0;r<e.length;++r)t[e[r]]=1;return function(){for(var e=Object.keys(this),r=e.length-1;r>-1;--r)if(1===t[e[r]]&&void 0!==this[e[r]]&&null!==this[e[r]])return e[r]}},s.oneOfSetter=function(e){return function(t){for(var r=0;r<e.length;++r)e[r]!==t&&delete this[e[r]]}},s.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},s._configure=function(){var e=s.Buffer;e?(s._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,r){return new e(t,r)},s._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):s._Buffer_from=s._Buffer_allocUnsafe=null}},63449:(e,t,r)=>{"use strict";e.exports=p;var s,n=r(93610),i=n.LongBits,o=n.base64,a=n.utf8;function c(e,t,r){this.fn=e,this.len=t,this.next=void 0,this.val=r}function u(){}function l(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function p(){this.len=0,this.head=new c(u,0,0),this.tail=this.head,this.states=null}var d=function(){return n.Buffer?function(){return(p.create=function(){return new s})()}:function(){return new p}};function h(e,t,r){t[r]=255&e}function f(e,t){this.len=e,this.next=void 0,this.val=t}function g(e,t,r){for(;e.hi;)t[r++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[r++]=127&e.lo|128,e.lo=e.lo>>>7;t[r++]=e.lo}function m(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}p.create=d(),p.alloc=function(e){return new n.Array(e)},n.Array!==Array&&(p.alloc=n.pool(p.alloc,n.Array.prototype.subarray)),p.prototype._push=function(e,t,r){return this.tail=this.tail.next=new c(e,t,r),this.len+=t,this},f.prototype=Object.create(c.prototype),f.prototype.fn=function(e,t,r){for(;e>127;)t[r++]=127&e|128,e>>>=7;t[r]=e},p.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new f((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},p.prototype.int32=function(e){return e<0?this._push(g,10,i.fromNumber(e)):this.uint32(e)},p.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},p.prototype.uint64=function(e){var t=i.from(e);return this._push(g,t.length(),t)},p.prototype.int64=p.prototype.uint64,p.prototype.sint64=function(e){var t=i.from(e).zzEncode();return this._push(g,t.length(),t)},p.prototype.bool=function(e){return this._push(h,1,e?1:0)},p.prototype.fixed32=function(e){return this._push(m,4,e>>>0)},p.prototype.sfixed32=p.prototype.fixed32,p.prototype.fixed64=function(e){var t=i.from(e);return this._push(m,4,t.lo)._push(m,4,t.hi)},p.prototype.sfixed64=p.prototype.fixed64,p.prototype.float=function(e){return this._push(n.float.writeFloatLE,4,e)},p.prototype.double=function(e){return this._push(n.float.writeDoubleLE,8,e)};var _=n.Array.prototype.set?function(e,t,r){t.set(e,r)}:function(e,t,r){for(var s=0;s<e.length;++s)t[r+s]=e[s]};p.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(h,1,0);if(n.isString(e)){var r=p.alloc(t=o.length(e));o.decode(e,r,0),e=r}return this.uint32(t)._push(_,t,e)},p.prototype.string=function(e){var t=a.length(e);return t?this.uint32(t)._push(a.write,t,e):this._push(h,1,0)},p.prototype.fork=function(){return this.states=new l(this),this.head=this.tail=new c(u,0,0),this.len=0,this},p.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new c(u,0,0),this.len=0),this},p.prototype.ldelim=function(){var e=this.head,t=this.tail,r=this.len;return this.reset().uint32(r),r&&(this.tail.next=e.next,this.tail=t,this.len+=r),this},p.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),r=0;e;)e.fn(e.val,t,r),r+=e.len,e=e.next;return t},p._configure=function(e){s=e,p.create=d(),s._configure()}},60818:(e,t,r)=>{"use strict";e.exports=i;var s=r(63449);(i.prototype=Object.create(s.prototype)).constructor=i;var n=r(93610);function i(){s.call(this)}function o(e,t,r){e.length<40?n.utf8.write(e,t,r):t.utf8Write?t.utf8Write(e,r):t.write(e,r)}i._configure=function(){i.alloc=n._Buffer_allocUnsafe,i.writeBytesBuffer=n.Buffer&&n.Buffer.prototype instanceof Uint8Array&&"set"===n.Buffer.prototype.set.name?function(e,t,r){t.set(e,r)}:function(e,t,r){if(e.copy)e.copy(t,r,0,e.length);else for(var s=0;s<e.length;)t[r++]=e[s++]}},i.prototype.bytes=function(e){n.isString(e)&&(e=n._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(i.writeBytesBuffer,t,e),this},i.prototype.string=function(e){var t=n.Buffer.byteLength(e);return this.uint32(t),t&&this._push(o,t,e),this},i._configure()},75617:(e,t,r)=>{e.exports=r(58303)},58303:(e,t,r)=>{var s=r(93961);t.operation=function(e){var r=t.timeouts(e);return new s(r,{forever:e&&(e.forever||e.retries===1/0),unref:e&&e.unref,maxRetryTime:e&&e.maxRetryTime})},t.timeouts=function(e){if(e instanceof Array)return[].concat(e);var t={retries:10,factor:2,minTimeout:1e3,maxTimeout:1/0,randomize:!1};for(var r in e)t[r]=e[r];if(t.minTimeout>t.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var s=[],n=0;n<t.retries;n++)s.push(this.createTimeout(n,t));return e&&e.forever&&!s.length&&s.push(this.createTimeout(n,t)),s.sort((function(e,t){return e-t})),s},t.createTimeout=function(e,t){var r=t.randomize?Math.random()+1:1,s=Math.round(r*Math.max(t.minTimeout,1)*Math.pow(t.factor,e));return Math.min(s,t.maxTimeout)},t.wrap=function(e,r,s){if(r instanceof Array&&(s=r,r=null),!s)for(var n in s=[],e)"function"==typeof e[n]&&s.push(n);for(var i=0;i<s.length;i++){var o=s[i],a=e[o];e[o]=function(s){var n=t.operation(r),i=Array.prototype.slice.call(arguments,1),o=i.pop();i.push((function(e){n.retry(e)||(e&&(arguments[0]=n.mainError()),o.apply(this,arguments))})),n.attempt((function(){s.apply(e,i)}))}.bind(e,a),e[o].options=r}}},93961:e=>{function t(e,t){"boolean"==typeof t&&(t={forever:t}),this._originalTimeouts=JSON.parse(JSON.stringify(e)),this._timeouts=e,this._options=t||{},this._maxRetryTime=t&&t.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}e.exports=t,t.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)},t.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null},t.prototype.retry=function(e){if(this._timeout&&clearTimeout(this._timeout),!e)return!1;var t=(new Date).getTime();if(e&&t-this._operationStart>=this._maxRetryTime)return this._errors.push(e),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(e);var r=this._timeouts.shift();if(void 0===r){if(!this._cachedTimeouts)return!1;this._errors.splice(0,this._errors.length-1),r=this._cachedTimeouts.slice(-1)}var s=this;return this._timer=setTimeout((function(){s._attempts++,s._operationTimeoutCb&&(s._timeout=setTimeout((function(){s._operationTimeoutCb(s._attempts)}),s._operationTimeout),s._options.unref&&s._timeout.unref()),s._fn(s._attempts)}),r),this._options.unref&&this._timer.unref(),!0},t.prototype.attempt=function(e,t){this._fn=e,t&&(t.timeout&&(this._operationTimeout=t.timeout),t.cb&&(this._operationTimeoutCb=t.cb));var r=this;this._operationTimeoutCb&&(this._timeout=setTimeout((function(){r._operationTimeoutCb()}),r._operationTimeout)),this._operationStart=(new Date).getTime(),this._fn(this._attempts)},t.prototype.try=function(e){console.log("Using RetryOperation.try() is deprecated"),this.attempt(e)},t.prototype.start=function(e){console.log("Using RetryOperation.start() is deprecated"),this.attempt(e)},t.prototype.start=t.prototype.try,t.prototype.errors=function(){return this._errors},t.prototype.attempts=function(){return this._attempts},t.prototype.mainError=function(){if(0===this._errors.length)return null;for(var e={},t=null,r=0,s=0;s<this._errors.length;s++){var n=this._errors[s],i=n.message,o=(e[i]||0)+1;e[i]=o,o>=r&&(t=n,r=o)}return t}},89844:e=>{"use strict";function t(e){return e instanceof Buffer?Buffer.from(e):new e.constructor(e.buffer.slice(),e.byteOffset,e.length)}e.exports=function(e){return(e=e||{}).circles?function(e){var r=[],s=[];return e.proto?function e(i){if("object"!=typeof i||null===i)return i;if(i instanceof Date)return new Date(i);if(Array.isArray(i))return n(i,e);if(i instanceof Map)return new Map(n(Array.from(i),e));if(i instanceof Set)return new Set(n(Array.from(i),e));var o={};for(var a in r.push(i),s.push(o),i){var c=i[a];if("object"!=typeof c||null===c)o[a]=c;else if(c instanceof Date)o[a]=new Date(c);else if(c instanceof Map)o[a]=new Map(n(Array.from(c),e));else if(c instanceof Set)o[a]=new Set(n(Array.from(c),e));else if(ArrayBuffer.isView(c))o[a]=t(c);else{var u=r.indexOf(c);o[a]=-1!==u?s[u]:e(c)}}return r.pop(),s.pop(),o}:function e(i){if("object"!=typeof i||null===i)return i;if(i instanceof Date)return new Date(i);if(Array.isArray(i))return n(i,e);if(i instanceof Map)return new Map(n(Array.from(i),e));if(i instanceof Set)return new Set(n(Array.from(i),e));var o={};for(var a in r.push(i),s.push(o),i)if(!1!==Object.hasOwnProperty.call(i,a)){var c=i[a];if("object"!=typeof c||null===c)o[a]=c;else if(c instanceof Date)o[a]=new Date(c);else if(c instanceof Map)o[a]=new Map(n(Array.from(c),e));else if(c instanceof Set)o[a]=new Set(n(Array.from(c),e));else if(ArrayBuffer.isView(c))o[a]=t(c);else{var u=r.indexOf(c);o[a]=-1!==u?s[u]:e(c)}}return r.pop(),s.pop(),o};function n(e,n){for(var i=Object.keys(e),o=new Array(i.length),a=0;a<i.length;a++){var c=i[a],u=e[c];if("object"!=typeof u||null===u)o[c]=u;else if(u instanceof Date)o[c]=new Date(u);else if(ArrayBuffer.isView(u))o[c]=t(u);else{var l=r.indexOf(u);o[c]=-1!==l?s[l]:n(u)}}return o}}(e):e.proto?function e(s){if("object"!=typeof s||null===s)return s;if(s instanceof Date)return new Date(s);if(Array.isArray(s))return r(s,e);if(s instanceof Map)return new Map(r(Array.from(s),e));if(s instanceof Set)return new Set(r(Array.from(s),e));var n={};for(var i in s){var o=s[i];"object"!=typeof o||null===o?n[i]=o:o instanceof Date?n[i]=new Date(o):o instanceof Map?n[i]=new Map(r(Array.from(o),e)):o instanceof Set?n[i]=new Set(r(Array.from(o),e)):ArrayBuffer.isView(o)?n[i]=t(o):n[i]=e(o)}return n}:function e(s){if("object"!=typeof s||null===s)return s;if(s instanceof Date)return new Date(s);if(Array.isArray(s))return r(s,e);if(s instanceof Map)return new Map(r(Array.from(s),e));if(s instanceof Set)return new Set(r(Array.from(s),e));var n={};for(var i in s)if(!1!==Object.hasOwnProperty.call(s,i)){var o=s[i];"object"!=typeof o||null===o?n[i]=o:o instanceof Date?n[i]=new Date(o):o instanceof Map?n[i]=new Map(r(Array.from(o),e)):o instanceof Set?n[i]=new Set(r(Array.from(o),e)):ArrayBuffer.isView(o)?n[i]=t(o):n[i]=e(o)}return n};function r(e,r){for(var s=Object.keys(e),n=new Array(s.length),i=0;i<s.length;i++){var o=s[i],a=e[o];"object"!=typeof a||null===a?n[o]=a:a instanceof Date?n[o]=new Date(a):ArrayBuffer.isView(a)?n[o]=t(a):n[o]=r(a)}return n}}},93904:(e,t,r)=>{const s=Symbol("SemVer ANY");class n{static get ANY(){return s}constructor(e,t){if(t=i(t),e instanceof n){if(e.loose===!!t.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),u("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===s?this.value="":this.value=this.operator+this.semver.version,u("comp",this)}parse(e){const t=this.options.loose?o[a.COMPARATORLOOSE]:o[a.COMPARATOR],r=e.match(t);if(!r)throw new TypeError(`Invalid comparator: ${e}`);this.operator=void 0!==r[1]?r[1]:"","="===this.operator&&(this.operator=""),r[2]?this.semver=new l(r[2],this.options.loose):this.semver=s}toString(){return this.value}test(e){if(u("Comparator.test",e,this.options.loose),this.semver===s||e===s)return!0;if("string"==typeof e)try{e=new l(e,this.options)}catch(e){return!1}return c(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof n))throw new TypeError("a Comparator is required");return""===this.operator?""===this.value||new p(e.value,t).test(this.value):""===e.operator?""===e.value||new p(this.value,t).test(e.semver):!((t=i(t)).includePrerelease&&("<0.0.0-0"===this.value||"<0.0.0-0"===e.value)||!t.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))||(!this.operator.startsWith(">")||!e.operator.startsWith(">"))&&(!this.operator.startsWith("<")||!e.operator.startsWith("<"))&&(this.semver.version!==e.semver.version||!this.operator.includes("=")||!e.operator.includes("="))&&!(c(this.semver,"<",e.semver,t)&&this.operator.startsWith(">")&&e.operator.startsWith("<"))&&!(c(this.semver,">",e.semver,t)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))}}e.exports=n;const i=r(98587),{safeRe:o,t:a}=r(99718),c=r(72111),u=r(57272),l=r(53908),p=r(78311)},78311:(e,t,r)=>{const s=/\s+/g;class n{constructor(e,t){if(t=o(t),e instanceof n)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new n(e.raw,t);if(e instanceof a)return this.raw=e.value,this.set=[[e]],this.formatted=void 0,this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e.trim().replace(s," "),this.set=this.raw.split("||").map((e=>this.parseRange(e.trim()))).filter((e=>e.length)),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const e=this.set[0];if(this.set=this.set.filter((e=>!_(e[0]))),0===this.set.length)this.set=[e];else if(this.set.length>1)for(const e of this.set)if(1===e.length&&y(e[0])){this.set=[e];break}}this.formatted=void 0}get range(){if(void 0===this.formatted){this.formatted="";for(let e=0;e<this.set.length;e++){e>0&&(this.formatted+="||");const t=this.set[e];for(let e=0;e<t.length;e++)e>0&&(this.formatted+=" "),this.formatted+=t[e].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(e){const t=((this.options.includePrerelease&&g)|(this.options.loose&&m))+":"+e,r=i.get(t);if(r)return r;const s=this.options.loose,n=s?l[p.HYPHENRANGELOOSE]:l[p.HYPHENRANGE];e=e.replace(n,R(this.options.includePrerelease)),c("hyphen replace",e),e=e.replace(l[p.COMPARATORTRIM],d),c("comparator trim",e),e=e.replace(l[p.TILDETRIM],h),c("tilde trim",e),e=e.replace(l[p.CARETTRIM],f),c("caret trim",e);let o=e.split(" ").map((e=>v(e,this.options))).join(" ").split(/\s+/).map((e=>O(e,this.options)));s&&(o=o.filter((e=>(c("loose invalid filter",e,this.options),!!e.match(l[p.COMPARATORLOOSE]))))),c("range list",o);const u=new Map,y=o.map((e=>new a(e,this.options)));for(const e of y){if(_(e))return[e];u.set(e.value,e)}u.size>1&&u.has("")&&u.delete("");const b=[...u.values()];return i.set(t,b),b}intersects(e,t){if(!(e instanceof n))throw new TypeError("a Range is required");return this.set.some((r=>b(r,t)&&e.set.some((e=>b(e,t)&&r.every((r=>e.every((e=>r.intersects(e,t)))))))))}test(e){if(!e)return!1;if("string"==typeof e)try{e=new u(e,this.options)}catch(e){return!1}for(let t=0;t<this.set.length;t++)if(C(this.set[t],e,this.options))return!0;return!1}}e.exports=n;const i=new(r(68794)),o=r(98587),a=r(93904),c=r(57272),u=r(53908),{safeRe:l,t:p,comparatorTrimReplace:d,tildeTrimReplace:h,caretTrimReplace:f}=r(99718),{FLAG_INCLUDE_PRERELEASE:g,FLAG_LOOSE:m}=r(16874),_=e=>"<0.0.0-0"===e.value,y=e=>""===e.value,b=(e,t)=>{let r=!0;const s=e.slice();let n=s.pop();for(;r&&s.length;)r=s.every((e=>n.intersects(e,t))),n=s.pop();return r},v=(e,t)=>(c("comp",e,t),e=w(e,t),c("caret",e),e=S(e,t),c("tildes",e),e=A(e,t),c("xrange",e),e=k(e,t),c("stars",e),e),E=e=>!e||"x"===e.toLowerCase()||"*"===e,S=(e,t)=>e.trim().split(/\s+/).map((e=>T(e,t))).join(" "),T=(e,t)=>{const r=t.loose?l[p.TILDELOOSE]:l[p.TILDE];return e.replace(r,((t,r,s,n,i)=>{let o;return c("tilde",e,t,r,s,n,i),E(r)?o="":E(s)?o=`>=${r}.0.0 <${+r+1}.0.0-0`:E(n)?o=`>=${r}.${s}.0 <${r}.${+s+1}.0-0`:i?(c("replaceTilde pr",i),o=`>=${r}.${s}.${n}-${i} <${r}.${+s+1}.0-0`):o=`>=${r}.${s}.${n} <${r}.${+s+1}.0-0`,c("tilde return",o),o}))},w=(e,t)=>e.trim().split(/\s+/).map((e=>x(e,t))).join(" "),x=(e,t)=>{c("caret",e,t);const r=t.loose?l[p.CARETLOOSE]:l[p.CARET],s=t.includePrerelease?"-0":"";return e.replace(r,((t,r,n,i,o)=>{let a;return c("caret",e,t,r,n,i,o),E(r)?a="":E(n)?a=`>=${r}.0.0${s} <${+r+1}.0.0-0`:E(i)?a="0"===r?`>=${r}.${n}.0${s} <${r}.${+n+1}.0-0`:`>=${r}.${n}.0${s} <${+r+1}.0.0-0`:o?(c("replaceCaret pr",o),a="0"===r?"0"===n?`>=${r}.${n}.${i}-${o} <${r}.${n}.${+i+1}-0`:`>=${r}.${n}.${i}-${o} <${r}.${+n+1}.0-0`:`>=${r}.${n}.${i}-${o} <${+r+1}.0.0-0`):(c("no pr"),a="0"===r?"0"===n?`>=${r}.${n}.${i}${s} <${r}.${n}.${+i+1}-0`:`>=${r}.${n}.${i}${s} <${r}.${+n+1}.0-0`:`>=${r}.${n}.${i} <${+r+1}.0.0-0`),c("caret return",a),a}))},A=(e,t)=>(c("replaceXRanges",e,t),e.split(/\s+/).map((e=>I(e,t))).join(" ")),I=(e,t)=>{e=e.trim();const r=t.loose?l[p.XRANGELOOSE]:l[p.XRANGE];return e.replace(r,((r,s,n,i,o,a)=>{c("xRange",e,r,s,n,i,o,a);const u=E(n),l=u||E(i),p=l||E(o),d=p;return"="===s&&d&&(s=""),a=t.includePrerelease?"-0":"",u?r=">"===s||"<"===s?"<0.0.0-0":"*":s&&d?(l&&(i=0),o=0,">"===s?(s=">=",l?(n=+n+1,i=0,o=0):(i=+i+1,o=0)):"<="===s&&(s="<",l?n=+n+1:i=+i+1),"<"===s&&(a="-0"),r=`${s+n}.${i}.${o}${a}`):l?r=`>=${n}.0.0${a} <${+n+1}.0.0-0`:p&&(r=`>=${n}.${i}.0${a} <${n}.${+i+1}.0-0`),c("xRange return",r),r}))},k=(e,t)=>(c("replaceStars",e,t),e.trim().replace(l[p.STAR],"")),O=(e,t)=>(c("replaceGTE0",e,t),e.trim().replace(l[t.includePrerelease?p.GTE0PRE:p.GTE0],"")),R=e=>(t,r,s,n,i,o,a,c,u,l,p,d)=>`${r=E(s)?"":E(n)?`>=${s}.0.0${e?"-0":""}`:E(i)?`>=${s}.${n}.0${e?"-0":""}`:o?`>=${r}`:`>=${r}${e?"-0":""}`} ${c=E(u)?"":E(l)?`<${+u+1}.0.0-0`:E(p)?`<${u}.${+l+1}.0-0`:d?`<=${u}.${l}.${p}-${d}`:e?`<${u}.${l}.${+p+1}-0`:`<=${c}`}`.trim(),C=(e,t,r)=>{for(let r=0;r<e.length;r++)if(!e[r].test(t))return!1;if(t.prerelease.length&&!r.includePrerelease){for(let r=0;r<e.length;r++)if(c(e[r].semver),e[r].semver!==a.ANY&&e[r].semver.prerelease.length>0){const s=e[r].semver;if(s.major===t.major&&s.minor===t.minor&&s.patch===t.patch)return!0}return!1}return!0}},53908:(e,t,r)=>{const s=r(57272),{MAX_LENGTH:n,MAX_SAFE_INTEGER:i}=r(16874),{safeRe:o,t:a}=r(99718),c=r(98587),{compareIdentifiers:u}=r(61123);class l{constructor(e,t){if(t=c(t),e instanceof l){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>n)throw new TypeError(`version is longer than ${n} characters`);s("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const r=e.trim().match(t.loose?o[a.LOOSE]:o[a.FULL]);if(!r)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>i||this.major<0)throw new TypeError("Invalid major version");if(this.minor>i||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>i||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map((e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<i)return t}return e})):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(s("SemVer.compare",this.version,this.options,e),!(e instanceof l)){if("string"==typeof e&&e===this.version)return 0;e=new l(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof l||(e=new l(e,this.options)),u(this.major,e.major)||u(this.minor,e.minor)||u(this.patch,e.patch)}comparePre(e){if(e instanceof l||(e=new l(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const r=this.prerelease[t],n=e.prerelease[t];if(s("prerelease compare",t,r,n),void 0===r&&void 0===n)return 0;if(void 0===n)return 1;if(void 0===r)return-1;if(r!==n)return u(r,n)}while(++t)}compareBuild(e){e instanceof l||(e=new l(e,this.options));let t=0;do{const r=this.build[t],n=e.build[t];if(s("build compare",t,r,n),void 0===r&&void 0===n)return 0;if(void 0===n)return 1;if(void 0===r)return-1;if(r!==n)return u(r,n)}while(++t)}inc(e,t,r){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,r);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,r);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,r),this.inc("pre",t,r);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t,r),this.inc("pre",t,r);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":{const e=Number(r)?1:0;if(!t&&!1===r)throw new Error("invalid increment argument: identifier is empty");if(0===this.prerelease.length)this.prerelease=[e];else{let s=this.prerelease.length;for(;--s>=0;)"number"==typeof this.prerelease[s]&&(this.prerelease[s]++,s=-2);if(-1===s){if(t===this.prerelease.join(".")&&!1===r)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(e)}}if(t){let s=[t,e];!1===r&&(s=[t]),0===u(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=s):this.prerelease=s}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}e.exports=l},57414:(e,t,r)=>{const s=r(30144);e.exports=(e,t)=>{const r=s(e.trim().replace(/^[=v]+/,""),t);return r?r.version:null}},72111:(e,t,r)=>{const s=r(94641),n=r(13999),i=r(35580),o=r(54089),a=r(7059),c=r(25200);e.exports=(e,t,r,u)=>{switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e===r;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e!==r;case"":case"=":case"==":return s(e,r,u);case"!=":return n(e,r,u);case">":return i(e,r,u);case">=":return o(e,r,u);case"<":return a(e,r,u);case"<=":return c(e,r,u);default:throw new TypeError(`Invalid operator: ${t}`)}}},46170:(e,t,r)=>{const s=r(53908),n=r(30144),{safeRe:i,t:o}=r(99718);e.exports=(e,t)=>{if(e instanceof s)return e;if("number"==typeof e&&(e=String(e)),"string"!=typeof e)return null;let r=null;if((t=t||{}).rtl){const s=t.includePrerelease?i[o.COERCERTLFULL]:i[o.COERCERTL];let n;for(;(n=s.exec(e))&&(!r||r.index+r[0].length!==e.length);)r&&n.index+n[0].length===r.index+r[0].length||(r=n),s.lastIndex=n.index+n[1].length+n[2].length;s.lastIndex=-1}else r=e.match(t.includePrerelease?i[o.COERCEFULL]:i[o.COERCE]);if(null===r)return null;const a=r[2],c=r[3]||"0",u=r[4]||"0",l=t.includePrerelease&&r[5]?`-${r[5]}`:"",p=t.includePrerelease&&r[6]?`+${r[6]}`:"";return n(`${a}.${c}.${u}${l}${p}`,t)}},40909:(e,t,r)=>{const s=r(53908);e.exports=(e,t,r)=>{const n=new s(e,r),i=new s(t,r);return n.compare(i)||n.compareBuild(i)}},11763:(e,t,r)=>{const s=r(50560);e.exports=(e,t)=>s(e,t,!0)},50560:(e,t,r)=>{const s=r(53908);e.exports=(e,t,r)=>new s(e,r).compare(new s(t,r))},51832:(e,t,r)=>{const s=r(30144);e.exports=(e,t)=>{const r=s(e,null,!0),n=s(t,null,!0),i=r.compare(n);if(0===i)return null;const o=i>0,a=o?r:n,c=o?n:r,u=!!a.prerelease.length;if(c.prerelease.length&&!u)return c.patch||c.minor?a.patch?"patch":a.minor?"minor":"major":"major";const l=u?"pre":"";return r.major!==n.major?l+"major":r.minor!==n.minor?l+"minor":r.patch!==n.patch?l+"patch":"prerelease"}},94641:(e,t,r)=>{const s=r(50560);e.exports=(e,t,r)=>0===s(e,t,r)},35580:(e,t,r)=>{const s=r(50560);e.exports=(e,t,r)=>s(e,t,r)>0},54089:(e,t,r)=>{const s=r(50560);e.exports=(e,t,r)=>s(e,t,r)>=0},93007:(e,t,r)=>{const s=r(53908);e.exports=(e,t,r,n,i)=>{"string"==typeof r&&(i=n,n=r,r=void 0);try{return new s(e instanceof s?e.version:e,r).inc(t,n,i).version}catch(e){return null}}},7059:(e,t,r)=>{const s=r(50560);e.exports=(e,t,r)=>s(e,t,r)<0},25200:(e,t,r)=>{const s=r(50560);e.exports=(e,t,r)=>s(e,t,r)<=0},32938:(e,t,r)=>{const s=r(53908);e.exports=(e,t)=>new s(e,t).major},46254:(e,t,r)=>{const s=r(53908);e.exports=(e,t)=>new s(e,t).minor},13999:(e,t,r)=>{const s=r(50560);e.exports=(e,t,r)=>0!==s(e,t,r)},30144:(e,t,r)=>{const s=r(53908);e.exports=(e,t,r=!1)=>{if(e instanceof s)return e;try{return new s(e,t)}catch(e){if(!r)return null;throw e}}},24493:(e,t,r)=>{const s=r(53908);e.exports=(e,t)=>new s(e,t).patch},31729:(e,t,r)=>{const s=r(30144);e.exports=(e,t)=>{const r=s(e,t);return r&&r.prerelease.length?r.prerelease:null}},9970:(e,t,r)=>{const s=r(50560);e.exports=(e,t,r)=>s(t,e,r)},74277:(e,t,r)=>{const s=r(40909);e.exports=(e,t)=>e.sort(((e,r)=>s(r,e,t)))},97638:(e,t,r)=>{const s=r(78311);e.exports=(e,t,r)=>{try{t=new s(t,r)}catch(e){return!1}return t.test(e)}},43927:(e,t,r)=>{const s=r(40909);e.exports=(e,t)=>e.sort(((e,r)=>s(e,r,t)))},56953:(e,t,r)=>{const s=r(30144);e.exports=(e,t)=>{const r=s(e,t);return r?r.version:null}},99589:(e,t,r)=>{const s=r(99718),n=r(16874),i=r(53908),o=r(61123),a=r(30144),c=r(56953),u=r(57414),l=r(93007),p=r(51832),d=r(32938),h=r(46254),f=r(24493),g=r(31729),m=r(50560),_=r(9970),y=r(11763),b=r(40909),v=r(43927),E=r(74277),S=r(35580),T=r(7059),w=r(94641),x=r(13999),A=r(54089),I=r(25200),k=r(72111),O=r(46170),R=r(93904),C=r(78311),N=r(97638),P=r(77631),D=r(19628),L=r(270),M=r(41261),q=r(13874),j=r(97075),U=r(75571),F=r(5342),B=r(76780),$=r(72525),G=r(75032);e.exports={parse:a,valid:c,clean:u,inc:l,diff:p,major:d,minor:h,patch:f,prerelease:g,compare:m,rcompare:_,compareLoose:y,compareBuild:b,sort:v,rsort:E,gt:S,lt:T,eq:w,neq:x,gte:A,lte:I,cmp:k,coerce:O,Comparator:R,Range:C,satisfies:N,toComparators:P,maxSatisfying:D,minSatisfying:L,minVersion:M,validRange:q,outside:j,gtr:U,ltr:F,intersects:B,simplifyRange:$,subset:G,SemVer:i,re:s.re,src:s.src,tokens:s.t,SEMVER_SPEC_VERSION:n.SEMVER_SPEC_VERSION,RELEASE_TYPES:n.RELEASE_TYPES,compareIdentifiers:o.compareIdentifiers,rcompareIdentifiers:o.rcompareIdentifiers}},16874:e=>{const t=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:t,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}},57272:e=>{const t="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=t},61123:e=>{const t=/^[0-9]+$/,r=(e,r)=>{const s=t.test(e),n=t.test(r);return s&&n&&(e=+e,r=+r),e===r?0:s&&!n?-1:n&&!s?1:e<r?-1:1};e.exports={compareIdentifiers:r,rcompareIdentifiers:(e,t)=>r(t,e)}},68794:e=>{e.exports=class{constructor(){this.max=1e3,this.map=new Map}get(e){const t=this.map.get(e);return void 0===t?void 0:(this.map.delete(e),this.map.set(e,t),t)}delete(e){return this.map.delete(e)}set(e,t){if(!this.delete(e)&&void 0!==t){if(this.map.size>=this.max){const e=this.map.keys().next().value;this.delete(e)}this.map.set(e,t)}return this}}},98587:e=>{const t=Object.freeze({loose:!0}),r=Object.freeze({});e.exports=e=>e?"object"!=typeof e?t:e:r},99718:(e,t,r)=>{const{MAX_SAFE_COMPONENT_LENGTH:s,MAX_SAFE_BUILD_LENGTH:n,MAX_LENGTH:i}=r(16874),o=r(57272),a=(t=e.exports={}).re=[],c=t.safeRe=[],u=t.src=[],l=t.t={};let p=0;const d="[a-zA-Z0-9-]",h=[["\\s",1],["\\d",i],[d,n]],f=(e,t,r)=>{const s=(e=>{for(const[t,r]of h)e=e.split(`${t}*`).join(`${t}{0,${r}}`).split(`${t}+`).join(`${t}{1,${r}}`);return e})(t),n=p++;o(e,n,t),l[e]=n,u[n]=t,a[n]=new RegExp(t,r?"g":void 0),c[n]=new RegExp(s,r?"g":void 0)};f("NUMERICIDENTIFIER","0|[1-9]\\d*"),f("NUMERICIDENTIFIERLOOSE","\\d+"),f("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${d}*`),f("MAINVERSION",`(${u[l.NUMERICIDENTIFIER]})\\.(${u[l.NUMERICIDENTIFIER]})\\.(${u[l.NUMERICIDENTIFIER]})`),f("MAINVERSIONLOOSE",`(${u[l.NUMERICIDENTIFIERLOOSE]})\\.(${u[l.NUMERICIDENTIFIERLOOSE]})\\.(${u[l.NUMERICIDENTIFIERLOOSE]})`),f("PRERELEASEIDENTIFIER",`(?:${u[l.NUMERICIDENTIFIER]}|${u[l.NONNUMERICIDENTIFIER]})`),f("PRERELEASEIDENTIFIERLOOSE",`(?:${u[l.NUMERICIDENTIFIERLOOSE]}|${u[l.NONNUMERICIDENTIFIER]})`),f("PRERELEASE",`(?:-(${u[l.PRERELEASEIDENTIFIER]}(?:\\.${u[l.PRERELEASEIDENTIFIER]})*))`),f("PRERELEASELOOSE",`(?:-?(${u[l.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${u[l.PRERELEASEIDENTIFIERLOOSE]})*))`),f("BUILDIDENTIFIER",`${d}+`),f("BUILD",`(?:\\+(${u[l.BUILDIDENTIFIER]}(?:\\.${u[l.BUILDIDENTIFIER]})*))`),f("FULLPLAIN",`v?${u[l.MAINVERSION]}${u[l.PRERELEASE]}?${u[l.BUILD]}?`),f("FULL",`^${u[l.FULLPLAIN]}$`),f("LOOSEPLAIN",`[v=\\s]*${u[l.MAINVERSIONLOOSE]}${u[l.PRERELEASELOOSE]}?${u[l.BUILD]}?`),f("LOOSE",`^${u[l.LOOSEPLAIN]}$`),f("GTLT","((?:<|>)?=?)"),f("XRANGEIDENTIFIERLOOSE",`${u[l.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),f("XRANGEIDENTIFIER",`${u[l.NUMERICIDENTIFIER]}|x|X|\\*`),f("XRANGEPLAIN",`[v=\\s]*(${u[l.XRANGEIDENTIFIER]})(?:\\.(${u[l.XRANGEIDENTIFIER]})(?:\\.(${u[l.XRANGEIDENTIFIER]})(?:${u[l.PRERELEASE]})?${u[l.BUILD]}?)?)?`),f("XRANGEPLAINLOOSE",`[v=\\s]*(${u[l.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[l.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[l.XRANGEIDENTIFIERLOOSE]})(?:${u[l.PRERELEASELOOSE]})?${u[l.BUILD]}?)?)?`),f("XRANGE",`^${u[l.GTLT]}\\s*${u[l.XRANGEPLAIN]}$`),f("XRANGELOOSE",`^${u[l.GTLT]}\\s*${u[l.XRANGEPLAINLOOSE]}$`),f("COERCEPLAIN",`(^|[^\\d])(\\d{1,${s}})(?:\\.(\\d{1,${s}}))?(?:\\.(\\d{1,${s}}))?`),f("COERCE",`${u[l.COERCEPLAIN]}(?:$|[^\\d])`),f("COERCEFULL",u[l.COERCEPLAIN]+`(?:${u[l.PRERELEASE]})?`+`(?:${u[l.BUILD]})?(?:$|[^\\d])`),f("COERCERTL",u[l.COERCE],!0),f("COERCERTLFULL",u[l.COERCEFULL],!0),f("LONETILDE","(?:~>?)"),f("TILDETRIM",`(\\s*)${u[l.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",f("TILDE",`^${u[l.LONETILDE]}${u[l.XRANGEPLAIN]}$`),f("TILDELOOSE",`^${u[l.LONETILDE]}${u[l.XRANGEPLAINLOOSE]}$`),f("LONECARET","(?:\\^)"),f("CARETTRIM",`(\\s*)${u[l.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",f("CARET",`^${u[l.LONECARET]}${u[l.XRANGEPLAIN]}$`),f("CARETLOOSE",`^${u[l.LONECARET]}${u[l.XRANGEPLAINLOOSE]}$`),f("COMPARATORLOOSE",`^${u[l.GTLT]}\\s*(${u[l.LOOSEPLAIN]})$|^$`),f("COMPARATOR",`^${u[l.GTLT]}\\s*(${u[l.FULLPLAIN]})$|^$`),f("COMPARATORTRIM",`(\\s*)${u[l.GTLT]}\\s*(${u[l.LOOSEPLAIN]}|${u[l.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",f("HYPHENRANGE",`^\\s*(${u[l.XRANGEPLAIN]})\\s+-\\s+(${u[l.XRANGEPLAIN]})\\s*$`),f("HYPHENRANGELOOSE",`^\\s*(${u[l.XRANGEPLAINLOOSE]})\\s+-\\s+(${u[l.XRANGEPLAINLOOSE]})\\s*$`),f("STAR","(<|>)?=?\\s*\\*"),f("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),f("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},75571:(e,t,r)=>{const s=r(97075);e.exports=(e,t,r)=>s(e,t,">",r)},76780:(e,t,r)=>{const s=r(78311);e.exports=(e,t,r)=>(e=new s(e,r),t=new s(t,r),e.intersects(t,r))},5342:(e,t,r)=>{const s=r(97075);e.exports=(e,t,r)=>s(e,t,"<",r)},19628:(e,t,r)=>{const s=r(53908),n=r(78311);e.exports=(e,t,r)=>{let i=null,o=null,a=null;try{a=new n(t,r)}catch(e){return null}return e.forEach((e=>{a.test(e)&&(i&&-1!==o.compare(e)||(i=e,o=new s(i,r)))})),i}},270:(e,t,r)=>{const s=r(53908),n=r(78311);e.exports=(e,t,r)=>{let i=null,o=null,a=null;try{a=new n(t,r)}catch(e){return null}return e.forEach((e=>{a.test(e)&&(i&&1!==o.compare(e)||(i=e,o=new s(i,r)))})),i}},41261:(e,t,r)=>{const s=r(53908),n=r(78311),i=r(35580);e.exports=(e,t)=>{e=new n(e,t);let r=new s("0.0.0");if(e.test(r))return r;if(r=new s("0.0.0-0"),e.test(r))return r;r=null;for(let t=0;t<e.set.length;++t){const n=e.set[t];let o=null;n.forEach((e=>{const t=new s(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":o&&!i(t,o)||(o=t);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${e.operator}`)}})),!o||r&&!i(r,o)||(r=o)}return r&&e.test(r)?r:null}},97075:(e,t,r)=>{const s=r(53908),n=r(93904),{ANY:i}=n,o=r(78311),a=r(97638),c=r(35580),u=r(7059),l=r(25200),p=r(54089);e.exports=(e,t,r,d)=>{let h,f,g,m,_;switch(e=new s(e,d),t=new o(t,d),r){case">":h=c,f=l,g=u,m=">",_=">=";break;case"<":h=u,f=p,g=c,m="<",_="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(a(e,t,d))return!1;for(let r=0;r<t.set.length;++r){const s=t.set[r];let o=null,a=null;if(s.forEach((e=>{e.semver===i&&(e=new n(">=0.0.0")),o=o||e,a=a||e,h(e.semver,o.semver,d)?o=e:g(e.semver,a.semver,d)&&(a=e)})),o.operator===m||o.operator===_)return!1;if((!a.operator||a.operator===m)&&f(e,a.semver))return!1;if(a.operator===_&&g(e,a.semver))return!1}return!0}},72525:(e,t,r)=>{const s=r(97638),n=r(50560);e.exports=(e,t,r)=>{const i=[];let o=null,a=null;const c=e.sort(((e,t)=>n(e,t,r)));for(const e of c)s(e,t,r)?(a=e,o||(o=e)):(a&&i.push([o,a]),a=null,o=null);o&&i.push([o,null]);const u=[];for(const[e,t]of i)e===t?u.push(e):t||e!==c[0]?t?e===c[0]?u.push(`<=${t}`):u.push(`${e} - ${t}`):u.push(`>=${e}`):u.push("*");const l=u.join(" || "),p="string"==typeof t.raw?t.raw:String(t);return l.length<p.length?l:t}},75032:(e,t,r)=>{const s=r(78311),n=r(93904),{ANY:i}=n,o=r(97638),a=r(50560),c=[new n(">=0.0.0-0")],u=[new n(">=0.0.0")],l=(e,t,r)=>{if(e===t)return!0;if(1===e.length&&e[0].semver===i){if(1===t.length&&t[0].semver===i)return!0;e=r.includePrerelease?c:u}if(1===t.length&&t[0].semver===i){if(r.includePrerelease)return!0;t=u}const s=new Set;let n,l,h,f,g,m,_;for(const t of e)">"===t.operator||">="===t.operator?n=p(n,t,r):"<"===t.operator||"<="===t.operator?l=d(l,t,r):s.add(t.semver);if(s.size>1)return null;if(n&&l){if(h=a(n.semver,l.semver,r),h>0)return null;if(0===h&&(">="!==n.operator||"<="!==l.operator))return null}for(const e of s){if(n&&!o(e,String(n),r))return null;if(l&&!o(e,String(l),r))return null;for(const s of t)if(!o(e,String(s),r))return!1;return!0}let y=!(!l||r.includePrerelease||!l.semver.prerelease.length)&&l.semver,b=!(!n||r.includePrerelease||!n.semver.prerelease.length)&&n.semver;y&&1===y.prerelease.length&&"<"===l.operator&&0===y.prerelease[0]&&(y=!1);for(const e of t){if(_=_||">"===e.operator||">="===e.operator,m=m||"<"===e.operator||"<="===e.operator,n)if(b&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===b.major&&e.semver.minor===b.minor&&e.semver.patch===b.patch&&(b=!1),">"===e.operator||">="===e.operator){if(f=p(n,e,r),f===e&&f!==n)return!1}else if(">="===n.operator&&!o(n.semver,String(e),r))return!1;if(l)if(y&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===y.major&&e.semver.minor===y.minor&&e.semver.patch===y.patch&&(y=!1),"<"===e.operator||"<="===e.operator){if(g=d(l,e,r),g===e&&g!==l)return!1}else if("<="===l.operator&&!o(l.semver,String(e),r))return!1;if(!e.operator&&(l||n)&&0!==h)return!1}return!(n&&m&&!l&&0!==h||l&&_&&!n&&0!==h||b||y)},p=(e,t,r)=>{if(!e)return t;const s=a(e.semver,t.semver,r);return s>0?e:s<0||">"===t.operator&&">="===e.operator?t:e},d=(e,t,r)=>{if(!e)return t;const s=a(e.semver,t.semver,r);return s<0?e:s>0||"<"===t.operator&&"<="===e.operator?t:e};e.exports=(e,t,r={})=>{if(e===t)return!0;e=new s(e,r),t=new s(t,r);let n=!1;e:for(const s of e.set){for(const e of t.set){const t=l(s,e,r);if(n=n||null!==t,t)continue e}if(n)return!1}return!0}},77631:(e,t,r)=>{const s=r(78311);e.exports=(e,t)=>new s(e,t).set.map((e=>e.map((e=>e.value)).join(" ").trim().split(" ")))},13874:(e,t,r)=>{const s=r(78311);e.exports=(e,t)=>{try{return new s(e,t).range||"*"}catch(e){return null}}},29563:e=>{"use strict";for(var t="(?:"+["\\|\\|","\\&\\&",";;","\\|\\&","\\<\\(","\\<\\<\\<",">>",">\\&","<\\&","[&;()|<>]"].join("|")+")",r=new RegExp("^"+t+"$"),s="|&;()<> \\t",n=/^#$/,i="",o=0;o<4;o++)i+=(4294967296*Math.random()).toString(16);var a=new RegExp("^"+i);e.exports=function(e,o,c){var u=function(e,o,a){a||(a={});var c=a.escape||"\\",u=new RegExp(["("+t+")","((\\"+c+"['\""+s+"]|[^\\s'\""+s+"])+|\"((\\\\\"|[^\"])*?)\"|'((\\\\'|[^'])*?)')+"].join("|"),"g"),l=function(e,t){for(var r,s=t.lastIndex,n=[];r=t.exec(e);)n.push(r),t.lastIndex===r.index&&(t.lastIndex+=1);return t.lastIndex=s,n}(e,u);if(0===l.length)return[];o||(o={});var p=!1;return l.map((function(t){var s=t[0];if(s&&!p){if(r.test(s))return{op:s};var a,u=!1,l=!1,d="",h=!1;for(a=0;a<s.length;a++){var f=s.charAt(a);if(h=h||!u&&("*"===f||"?"===f),l)d+=f,l=!1;else if(u)f===u?u=!1:"'"==u?d+=f:f===c?(a+=1,d+='"'===(f=s.charAt(a))||f===c||"$"===f?f:c+f):d+="$"===f?m():f;else if('"'===f||"'"===f)u=f;else{if(r.test(f))return{op:s};if(n.test(f)){p=!0;var g={comment:e.slice(t.index+a+1)};return d.length?[d,g]:[g]}f===c?l=!0:d+="$"===f?m():f}}return h?{op:"glob",pattern:d}:d}function m(){var e,t;a+=1;var r=s.charAt(a);if("{"===r){if(a+=1,"}"===s.charAt(a))throw new Error("Bad substitution: "+s.slice(a-2,a+1));if((e=s.indexOf("}",a))<0)throw new Error("Bad substitution: "+s.slice(a));t=s.slice(a,e),a=e}else if(/[*@#?$!_-]/.test(r))t=r,a+=1;else{var n=s.slice(a);(e=n.match(/[^\w\d_]/))?(t=n.slice(0,e.index),a+=e.index-1):(t=n,a=s.length)}return function(e,t,r){var s="function"==typeof e?e(r):e[r];return void 0===s&&""!=r?s="":void 0===s&&(s="$"),"object"==typeof s?""+i+JSON.stringify(s)+i:""+s}(o,0,t)}})).reduce((function(e,t){return void 0===t?e:e.concat(t)}),[])}(e,o,c);return"function"!=typeof o?u:u.reduce((function(e,t){if("object"==typeof t)return e.concat(t);var r=t.split(RegExp("("+i+".*?"+i+")","g"));return 1===r.length?e.concat(r[0]):e.concat(r.filter(Boolean).map((function(e){return a.test(e)?JSON.parse(e.split(i)[1]):e})))}),[])}},80735:(e,t)=>{class r{constructor(){this._array=[],this._set=new Map}static fromArray(e,t){const s=new r;for(let r=0,n=e.length;r<n;r++)s.add(e[r],t);return s}size(){return this._set.size}add(e,t){const r=this.has(e),s=this._array.length;r&&!t||this._array.push(e),r||this._set.set(e,s)}has(e){return this._set.has(e)}indexOf(e){const t=this._set.get(e);if(t>=0)return t;throw new Error('"'+e+'" is not in the set.')}at(e){if(e>=0&&e<this._array.length)return this._array[e];throw new Error("No element indexed by "+e)}toArray(){return this._array.slice()}}t.C=r},17092:(e,t,r)=>{const s=r(32364);t.encode=function(e){let t,r="",n=function(e){return e<0?1+(-e<<1):0+(e<<1)}(e);do{t=31&n,n>>>=5,n>0&&(t|=32),r+=s.encode(t)}while(n>0);return r}},32364:(e,t)=>{const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");t.encode=function(e){if(0<=e&&e<r.length)return r[e];throw new TypeError("Must be between 0 and 63: "+e)}},41163:(e,t)=>{function r(e,s,n,i,o,a){const c=Math.floor((s-e)/2)+e,u=o(n,i[c],!0);return 0===u?c:u>0?s-c>1?r(c,s,n,i,o,a):a==t.LEAST_UPPER_BOUND?s<i.length?s:-1:c:c-e>1?r(e,c,n,i,o,a):a==t.LEAST_UPPER_BOUND?c:e<0?-1:e}t.GREATEST_LOWER_BOUND=1,t.LEAST_UPPER_BOUND=2,t.search=function(e,s,n,i){if(0===s.length)return-1;let o=r(-1,s.length,e,s,n,i||t.GREATEST_LOWER_BOUND);if(o<0)return-1;for(;o-1>=0&&0===n(s[o],s[o-1],!0);)--o;return o}},43302:(e,t,r)=>{const s=r(90251);t.P=class{constructor(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}unsortedForEach(e,t){this._array.forEach(e,t)}add(e){!function(e,t){const r=e.generatedLine,n=t.generatedLine,i=e.generatedColumn,o=t.generatedColumn;return n>r||n==r&&o>=i||s.compareByGeneratedPositionsInflated(e,t)<=0}(this._last,e)?(this._sorted=!1,this._array.push(e)):(this._last=e,this._array.push(e))}toArray(){return this._sorted||(this._array.sort(s.compareByGeneratedPositionsInflated),this._sorted=!0),this._array}}},56576:(e,t,r)=>{if(function(){return"undefined"!=typeof window&&this===window}.call()){let t=null;e.exports=function(){if("string"==typeof t)return fetch(t).then((e=>e.arrayBuffer()));if(t instanceof ArrayBuffer)return Promise.resolve(t);throw new Error("You must provide the string URL or ArrayBuffer contents of lib/mappings.wasm by calling SourceMapConsumer.initialize({ 'lib/mappings.wasm': ... }) before using SourceMapConsumer")},e.exports.initialize=e=>t=e}else{const t=r(79896),s=r(16928);e.exports=function(){return new Promise(((e,r)=>{const n=s.join(__dirname,"mappings.wasm");t.readFile(n,null,((t,s)=>{t?r(t):e(s.buffer)}))}))},e.exports.initialize=e=>{console.debug("SourceMapConsumer.initialize is a no-op when running in node.js")}}},47446:(e,t,r)=>{const s=r(90251),n=r(41163),i=r(80735).C,o=(r(17092),r(56576)),a=r(28991),c=Symbol("smcInternal");class u{constructor(e,t){return e==c?Promise.resolve(this):function(e,t){let r=e;"string"==typeof e&&(r=s.parseSourceMapInput(e));const n=null!=r.sections?new p(r,t):new l(r,t);return Promise.resolve(n)}(e,t)}static initialize(e){o.initialize(e["lib/mappings.wasm"])}static fromSourceMap(e,t){return function(e,t){return l.fromSourceMap(e,t)}(e,t)}static async with(e,t,r){const s=await new u(e,t);try{return await r(s)}finally{s.destroy()}}_parseMappings(e,t){throw new Error("Subclasses must implement _parseMappings")}eachMapping(e,t,r){throw new Error("Subclasses must implement eachMapping")}allGeneratedPositionsFor(e){throw new Error("Subclasses must implement allGeneratedPositionsFor")}destroy(){throw new Error("Subclasses must implement destroy")}}u.prototype._version=3,u.GENERATED_ORDER=1,u.ORIGINAL_ORDER=2,u.GREATEST_LOWER_BOUND=1,u.LEAST_UPPER_BOUND=2,t.SourceMapConsumer=u;class l extends u{constructor(e,t){return super(c).then((r=>{let n=e;"string"==typeof e&&(n=s.parseSourceMapInput(e));const o=s.getArg(n,"version");let c=s.getArg(n,"sources");const u=s.getArg(n,"names",[]);let l=s.getArg(n,"sourceRoot",null);const p=s.getArg(n,"sourcesContent",null),d=s.getArg(n,"mappings"),h=s.getArg(n,"file",null);if(o!=r._version)throw new Error("Unsupported version: "+o);return l&&(l=s.normalize(l)),c=c.map(String).map(s.normalize).map((function(e){return l&&s.isAbsolute(l)&&s.isAbsolute(e)?s.relative(l,e):e})),r._names=i.fromArray(u.map(String),!0),r._sources=i.fromArray(c,!0),r._absoluteSources=r._sources.toArray().map((function(e){return s.computeSourceURL(l,e,t)})),r.sourceRoot=l,r.sourcesContent=p,r._mappings=d,r._sourceMapURL=t,r.file=h,r._computedColumnSpans=!1,r._mappingsPtr=0,r._wasm=null,a().then((e=>(r._wasm=e,r)))}))}_findSourceIndex(e){let t=e;if(null!=this.sourceRoot&&(t=s.relative(this.sourceRoot,t)),this._sources.has(t))return this._sources.indexOf(t);for(let t=0;t<this._absoluteSources.length;++t)if(this._absoluteSources[t]==e)return t;return-1}static fromSourceMap(e,t){return new l(e.toString())}get sources(){return this._absoluteSources.slice()}_getMappingsPtr(){return 0===this._mappingsPtr&&this._parseMappings(this._mappings,this.sourceRoot),this._mappingsPtr}_parseMappings(e,t){const r=e.length,s=this._wasm.exports.allocate_mappings(r),n=new Uint8Array(this._wasm.exports.memory.buffer,s,r);for(let t=0;t<r;t++)n[t]=e.charCodeAt(t);const i=this._wasm.exports.parse_mappings(s);if(!i){const e=this._wasm.exports.get_last_error();let t=`Error parsing mappings (code ${e}): `;switch(e){case 1:t+="the mappings contained a negative line, column, source index, or name index";break;case 2:t+="the mappings contained a number larger than 2**32";break;case 3:t+="reached EOF while in the middle of parsing a VLQ";break;case 4:t+="invalid base 64 character while parsing a VLQ";break;default:t+="unknown error code"}throw new Error(t)}this._mappingsPtr=i}eachMapping(e,t,r){const n=t||null,i=r||u.GENERATED_ORDER,o=this.sourceRoot;this._wasm.withMappingCallback((t=>{null!==t.source&&(t.source=this._sources.at(t.source),t.source=s.computeSourceURL(o,t.source,this._sourceMapURL),null!==t.name&&(t.name=this._names.at(t.name))),e.call(n,t)}),(()=>{switch(i){case u.GENERATED_ORDER:this._wasm.exports.by_generated_location(this._getMappingsPtr());break;case u.ORIGINAL_ORDER:this._wasm.exports.by_original_location(this._getMappingsPtr());break;default:throw new Error("Unknown order of iteration.")}}))}allGeneratedPositionsFor(e){let t=s.getArg(e,"source");const r=s.getArg(e,"line"),n=e.column||0;if(t=this._findSourceIndex(t),t<0)return[];if(r<1)throw new Error("Line numbers must be >= 1");if(n<0)throw new Error("Column numbers must be >= 0");const i=[];return this._wasm.withMappingCallback((e=>{let t=e.lastGeneratedColumn;this._computedColumnSpans&&null===t&&(t=1/0),i.push({line:e.generatedLine,column:e.generatedColumn,lastColumn:t})}),(()=>{this._wasm.exports.all_generated_locations_for(this._getMappingsPtr(),t,r-1,"column"in e,n)})),i}destroy(){0!==this._mappingsPtr&&(this._wasm.exports.free_mappings(this._mappingsPtr),this._mappingsPtr=0)}computeColumnSpans(){this._computedColumnSpans||(this._wasm.exports.compute_column_spans(this._getMappingsPtr()),this._computedColumnSpans=!0)}originalPositionFor(e){const t={generatedLine:s.getArg(e,"line"),generatedColumn:s.getArg(e,"column")};if(t.generatedLine<1)throw new Error("Line numbers must be >= 1");if(t.generatedColumn<0)throw new Error("Column numbers must be >= 0");let r,n=s.getArg(e,"bias",u.GREATEST_LOWER_BOUND);if(null==n&&(n=u.GREATEST_LOWER_BOUND),this._wasm.withMappingCallback((e=>r=e),(()=>{this._wasm.exports.original_location_for(this._getMappingsPtr(),t.generatedLine-1,t.generatedColumn,n)})),r&&r.generatedLine===t.generatedLine){let e=s.getArg(r,"source",null);null!==e&&(e=this._sources.at(e),e=s.computeSourceURL(this.sourceRoot,e,this._sourceMapURL));let t=s.getArg(r,"name",null);return null!==t&&(t=this._names.at(t)),{source:e,line:s.getArg(r,"originalLine",null),column:s.getArg(r,"originalColumn",null),name:t}}return{source:null,line:null,column:null,name:null}}hasContentsOfAllSources(){return!!this.sourcesContent&&this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some((function(e){return null==e}))}sourceContentFor(e,t){if(!this.sourcesContent)return null;const r=this._findSourceIndex(e);if(r>=0)return this.sourcesContent[r];let n,i=e;if(null!=this.sourceRoot&&(i=s.relative(this.sourceRoot,i)),null!=this.sourceRoot&&(n=s.urlParse(this.sourceRoot))){const e=i.replace(/^file:\/\//,"");if("file"==n.scheme&&this._sources.has(e))return this.sourcesContent[this._sources.indexOf(e)];if((!n.path||"/"==n.path)&&this._sources.has("/"+i))return this.sourcesContent[this._sources.indexOf("/"+i)]}if(t)return null;throw new Error('"'+i+'" is not in the SourceMap.')}generatedPositionFor(e){let t=s.getArg(e,"source");if(t=this._findSourceIndex(t),t<0)return{line:null,column:null,lastColumn:null};const r={source:t,originalLine:s.getArg(e,"line"),originalColumn:s.getArg(e,"column")};if(r.originalLine<1)throw new Error("Line numbers must be >= 1");if(r.originalColumn<0)throw new Error("Column numbers must be >= 0");let n,i=s.getArg(e,"bias",u.GREATEST_LOWER_BOUND);if(null==i&&(i=u.GREATEST_LOWER_BOUND),this._wasm.withMappingCallback((e=>n=e),(()=>{this._wasm.exports.generated_location_for(this._getMappingsPtr(),r.source,r.originalLine-1,r.originalColumn,i)})),n&&n.source===r.source){let e=n.lastGeneratedColumn;return this._computedColumnSpans&&null===e&&(e=1/0),{line:s.getArg(n,"generatedLine",null),column:s.getArg(n,"generatedColumn",null),lastColumn:e}}return{line:null,column:null,lastColumn:null}}}l.prototype.consumer=u;class p extends u{constructor(e,t){return super(c).then((r=>{let n=e;"string"==typeof e&&(n=s.parseSourceMapInput(e));const o=s.getArg(n,"version"),a=s.getArg(n,"sections");if(o!=r._version)throw new Error("Unsupported version: "+o);r._sources=new i,r._names=new i,r.__generatedMappings=null,r.__originalMappings=null,r.__generatedMappingsUnsorted=null,r.__originalMappingsUnsorted=null;let c={line:-1,column:0};return Promise.all(a.map((e=>{if(e.url)throw new Error("Support for url field in sections not implemented.");const r=s.getArg(e,"offset"),n=s.getArg(r,"line"),i=s.getArg(r,"column");if(n<c.line||n===c.line&&i<c.column)throw new Error("Section offsets must be ordered and non-overlapping.");return c=r,new u(s.getArg(e,"map"),t).then((e=>({generatedOffset:{generatedLine:n+1,generatedColumn:i+1},consumer:e})))}))).then((e=>(r._sections=e,r)))}))}get _generatedMappings(){return this.__generatedMappings||this._sortGeneratedMappings(),this.__generatedMappings}get _originalMappings(){return this.__originalMappings||this._sortOriginalMappings(),this.__originalMappings}get _generatedMappingsUnsorted(){return this.__generatedMappingsUnsorted||this._parseMappings(this._mappings,this.sourceRoot),this.__generatedMappingsUnsorted}get _originalMappingsUnsorted(){return this.__originalMappingsUnsorted||this._parseMappings(this._mappings,this.sourceRoot),this.__originalMappingsUnsorted}_sortGeneratedMappings(){const e=this._generatedMappingsUnsorted;e.sort(s.compareByGeneratedPositionsDeflated),this.__generatedMappings=e}_sortOriginalMappings(){const e=this._originalMappingsUnsorted;e.sort(s.compareByOriginalPositions),this.__originalMappings=e}get sources(){const e=[];for(let t=0;t<this._sections.length;t++)for(let r=0;r<this._sections[t].consumer.sources.length;r++)e.push(this._sections[t].consumer.sources[r]);return e}originalPositionFor(e){const t={generatedLine:s.getArg(e,"line"),generatedColumn:s.getArg(e,"column")},r=n.search(t,this._sections,(function(e,t){return e.generatedLine-t.generatedOffset.generatedLine||e.generatedColumn-t.generatedOffset.generatedColumn})),i=this._sections[r];return i?i.consumer.originalPositionFor({line:t.generatedLine-(i.generatedOffset.generatedLine-1),column:t.generatedColumn-(i.generatedOffset.generatedLine===t.generatedLine?i.generatedOffset.generatedColumn-1:0),bias:e.bias}):{source:null,line:null,column:null,name:null}}hasContentsOfAllSources(){return this._sections.every((function(e){return e.consumer.hasContentsOfAllSources()}))}sourceContentFor(e,t){for(let t=0;t<this._sections.length;t++){const r=this._sections[t].consumer.sourceContentFor(e,!0);if(r)return r}if(t)return null;throw new Error('"'+e+'" is not in the SourceMap.')}generatedPositionFor(e){for(let t=0;t<this._sections.length;t++){const r=this._sections[t];if(-1===r.consumer._findSourceIndex(s.getArg(e,"source")))continue;const n=r.consumer.generatedPositionFor(e);if(n)return{line:n.line+(r.generatedOffset.generatedLine-1),column:n.column+(r.generatedOffset.generatedLine===n.line?r.generatedOffset.generatedColumn-1:0)}}return{line:null,column:null}}_parseMappings(e,t){const r=this.__generatedMappingsUnsorted=[],n=this.__originalMappingsUnsorted=[];for(let e=0;e<this._sections.length;e++){const t=this._sections[e],i=[];t.consumer.eachMapping((e=>i.push(e)));for(let e=0;e<i.length;e++){const o=i[e];let a=s.computeSourceURL(t.consumer.sourceRoot,null,this._sourceMapURL);this._sources.add(a),a=this._sources.indexOf(a);let c=null;o.name&&(this._names.add(o.name),c=this._names.indexOf(o.name));const u={source:a,generatedLine:o.generatedLine+(t.generatedOffset.generatedLine-1),generatedColumn:o.generatedColumn+(t.generatedOffset.generatedLine===o.generatedLine?t.generatedOffset.generatedColumn-1:0),originalLine:o.originalLine,originalColumn:o.originalColumn,name:c};r.push(u),"number"==typeof u.originalLine&&n.push(u)}}}eachMapping(e,t,r){const n=t||null;let i;switch(r||u.GENERATED_ORDER){case u.GENERATED_ORDER:i=this._generatedMappings;break;case u.ORIGINAL_ORDER:i=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}const o=this.sourceRoot;i.map((function(e){let t=null;return null!==e.source&&(t=this._sources.at(e.source),t=s.computeSourceURL(o,t,this._sourceMapURL)),{source:t,generatedLine:e.generatedLine,generatedColumn:e.generatedColumn,originalLine:e.originalLine,originalColumn:e.originalColumn,name:null===e.name?null:this._names.at(e.name)}}),this).forEach(e,n)}_findMapping(e,t,r,s,i,o){if(e[r]<=0)throw new TypeError("Line must be greater than or equal to 1, got "+e[r]);if(e[s]<0)throw new TypeError("Column must be greater than or equal to 0, got "+e[s]);return n.search(e,t,i,o)}allGeneratedPositionsFor(e){const t=s.getArg(e,"line"),r={source:s.getArg(e,"source"),originalLine:t,originalColumn:s.getArg(e,"column",0)};if(r.source=this._findSourceIndex(r.source),r.source<0)return[];if(r.originalLine<1)throw new Error("Line numbers must be >= 1");if(r.originalColumn<0)throw new Error("Column numbers must be >= 0");const i=[];let o=this._findMapping(r,this._originalMappings,"originalLine","originalColumn",s.compareByOriginalPositions,n.LEAST_UPPER_BOUND);if(o>=0){let r=this._originalMappings[o];if(void 0===e.column){const e=r.originalLine;for(;r&&r.originalLine===e;){let e=r.lastGeneratedColumn;this._computedColumnSpans&&null===e&&(e=1/0),i.push({line:s.getArg(r,"generatedLine",null),column:s.getArg(r,"generatedColumn",null),lastColumn:e}),r=this._originalMappings[++o]}}else{const e=r.originalColumn;for(;r&&r.originalLine===t&&r.originalColumn==e;){let e=r.lastGeneratedColumn;this._computedColumnSpans&&null===e&&(e=1/0),i.push({line:s.getArg(r,"generatedLine",null),column:s.getArg(r,"generatedColumn",null),lastColumn:e}),r=this._originalMappings[++o]}}}return i}destroy(){for(let e=0;e<this._sections.length;e++)this._sections[e].consumer.destroy()}}},54041:(e,t,r)=>{const s=r(17092),n=r(90251),i=r(80735).C,o=r(43302).P;class a{constructor(e){e||(e={}),this._file=n.getArg(e,"file",null),this._sourceRoot=n.getArg(e,"sourceRoot",null),this._skipValidation=n.getArg(e,"skipValidation",!1),this._sources=new i,this._names=new i,this._mappings=new o,this._sourcesContents=null}static fromSourceMap(e){const t=e.sourceRoot,r=new a({file:e.file,sourceRoot:t});return e.eachMapping((function(e){const s={generated:{line:e.generatedLine,column:e.generatedColumn}};null!=e.source&&(s.source=e.source,null!=t&&(s.source=n.relative(t,s.source)),s.original={line:e.originalLine,column:e.originalColumn},null!=e.name&&(s.name=e.name)),r.addMapping(s)})),e.sources.forEach((function(s){let i=s;null!==t&&(i=n.relative(t,s)),r._sources.has(i)||r._sources.add(i);const o=e.sourceContentFor(s);null!=o&&r.setSourceContent(s,o)})),r}addMapping(e){const t=n.getArg(e,"generated"),r=n.getArg(e,"original",null);let s=n.getArg(e,"source",null),i=n.getArg(e,"name",null);this._skipValidation||this._validateMapping(t,r,s,i),null!=s&&(s=String(s),this._sources.has(s)||this._sources.add(s)),null!=i&&(i=String(i),this._names.has(i)||this._names.add(i)),this._mappings.add({generatedLine:t.line,generatedColumn:t.column,originalLine:null!=r&&r.line,originalColumn:null!=r&&r.column,source:s,name:i})}setSourceContent(e,t){let r=e;null!=this._sourceRoot&&(r=n.relative(this._sourceRoot,r)),null!=t?(this._sourcesContents||(this._sourcesContents=Object.create(null)),this._sourcesContents[n.toSetString(r)]=t):this._sourcesContents&&(delete this._sourcesContents[n.toSetString(r)],0===Object.keys(this._sourcesContents).length&&(this._sourcesContents=null))}applySourceMap(e,t,r){let s=t;if(null==t){if(null==e.file)throw new Error('SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map\'s "file" property. Both were omitted.');s=e.file}const o=this._sourceRoot;null!=o&&(s=n.relative(o,s));const a=this._mappings.toArray().length>0?new i:this._sources,c=new i;this._mappings.unsortedForEach((function(t){if(t.source===s&&null!=t.originalLine){const s=e.originalPositionFor({line:t.originalLine,column:t.originalColumn});null!=s.source&&(t.source=s.source,null!=r&&(t.source=n.join(r,t.source)),null!=o&&(t.source=n.relative(o,t.source)),t.originalLine=s.line,t.originalColumn=s.column,null!=s.name&&(t.name=s.name))}const i=t.source;null==i||a.has(i)||a.add(i);const u=t.name;null==u||c.has(u)||c.add(u)}),this),this._sources=a,this._names=c,e.sources.forEach((function(t){const s=e.sourceContentFor(t);null!=s&&(null!=r&&(t=n.join(r,t)),null!=o&&(t=n.relative(o,t)),this.setSourceContent(t,s))}),this)}_validateMapping(e,t,r,s){if(t&&"number"!=typeof t.line&&"number"!=typeof t.column)throw new Error("original.line and original.column are not numbers -- you probably meant to omit the original mapping entirely and only map the generated position. If so, pass null for the original mapping instead of an object with empty or null values.");if(e&&"line"in e&&"column"in e&&e.line>0&&e.column>=0&&!t&&!r&&!s);else if(!(e&&"line"in e&&"column"in e&&t&&"line"in t&&"column"in t&&e.line>0&&e.column>=0&&t.line>0&&t.column>=0&&r))throw new Error("Invalid mapping: "+JSON.stringify({generated:e,source:r,original:t,name:s}))}_serializeMappings(){let e,t,r,i,o=0,a=1,c=0,u=0,l=0,p=0,d="";const h=this._mappings.toArray();for(let f=0,g=h.length;f<g;f++){if(t=h[f],e="",t.generatedLine!==a)for(o=0;t.generatedLine!==a;)e+=";",a++;else if(f>0){if(!n.compareByGeneratedPositionsInflated(t,h[f-1]))continue;e+=","}e+=s.encode(t.generatedColumn-o),o=t.generatedColumn,null!=t.source&&(i=this._sources.indexOf(t.source),e+=s.encode(i-p),p=i,e+=s.encode(t.originalLine-1-u),u=t.originalLine-1,e+=s.encode(t.originalColumn-c),c=t.originalColumn,null!=t.name&&(r=this._names.indexOf(t.name),e+=s.encode(r-l),l=r)),d+=e}return d}_generateSourcesContent(e,t){return e.map((function(e){if(!this._sourcesContents)return null;null!=t&&(e=n.relative(t,e));const r=n.toSetString(e);return Object.prototype.hasOwnProperty.call(this._sourcesContents,r)?this._sourcesContents[r]:null}),this)}toJSON(){const e={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return null!=this._file&&(e.file=this._file),null!=this._sourceRoot&&(e.sourceRoot=this._sourceRoot),this._sourcesContents&&(e.sourcesContent=this._generateSourcesContent(e.sources,e.sourceRoot)),e}toString(){return JSON.stringify(this.toJSON())}}a.prototype._version=3,t.SourceMapGenerator=a},1683:(e,t,r)=>{const s=r(54041).SourceMapGenerator,n=r(90251),i=/(\r?\n)/,o="$$$isSourceNode$$$";class a{constructor(e,t,r,s,n){this.children=[],this.sourceContents={},this.line=null==e?null:e,this.column=null==t?null:t,this.source=null==r?null:r,this.name=null==n?null:n,this[o]=!0,null!=s&&this.add(s)}static fromStringWithSourceMap(e,t,r){const s=new a,o=e.split(i);let c=0;const u=function(){return e()+(e()||"");function e(){return c<o.length?o[c++]:void 0}};let l,p=1,d=0,h=null;return t.eachMapping((function(e){if(null!==h){if(!(p<e.generatedLine)){l=o[c]||"";const t=l.substr(0,e.generatedColumn-d);return o[c]=l.substr(e.generatedColumn-d),d=e.generatedColumn,f(h,t),void(h=e)}f(h,u()),p++,d=0}for(;p<e.generatedLine;)s.add(u()),p++;d<e.generatedColumn&&(l=o[c]||"",s.add(l.substr(0,e.generatedColumn)),o[c]=l.substr(e.generatedColumn),d=e.generatedColumn),h=e}),this),c<o.length&&(h&&f(h,u()),s.add(o.splice(c).join(""))),t.sources.forEach((function(e){const i=t.sourceContentFor(e);null!=i&&(null!=r&&(e=n.join(r,e)),s.setSourceContent(e,i))})),s;function f(e,t){if(null===e||void 0===e.source)s.add(t);else{const i=r?n.join(r,e.source):e.source;s.add(new a(e.originalLine,e.originalColumn,i,t,e.name))}}}add(e){if(Array.isArray(e))e.forEach((function(e){this.add(e)}),this);else{if(!e[o]&&"string"!=typeof e)throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e);e&&this.children.push(e)}return this}prepend(e){if(Array.isArray(e))for(let t=e.length-1;t>=0;t--)this.prepend(e[t]);else{if(!e[o]&&"string"!=typeof e)throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e);this.children.unshift(e)}return this}walk(e){let t;for(let r=0,s=this.children.length;r<s;r++)t=this.children[r],t[o]?t.walk(e):""!==t&&e(t,{source:this.source,line:this.line,column:this.column,name:this.name})}join(e){let t,r;const s=this.children.length;if(s>0){for(t=[],r=0;r<s-1;r++)t.push(this.children[r]),t.push(e);t.push(this.children[r]),this.children=t}return this}replaceRight(e,t){const r=this.children[this.children.length-1];return r[o]?r.replaceRight(e,t):"string"==typeof r?this.children[this.children.length-1]=r.replace(e,t):this.children.push("".replace(e,t)),this}setSourceContent(e,t){this.sourceContents[n.toSetString(e)]=t}walkSourceContents(e){for(let t=0,r=this.children.length;t<r;t++)this.children[t][o]&&this.children[t].walkSourceContents(e);const t=Object.keys(this.sourceContents);for(let r=0,s=t.length;r<s;r++)e(n.fromSetString(t[r]),this.sourceContents[t[r]])}toString(){let e="";return this.walk((function(t){e+=t})),e}toStringWithSourceMap(e){const t={code:"",line:1,column:0},r=new s(e);let n=!1,i=null,o=null,a=null,c=null;return this.walk((function(e,s){t.code+=e,null!==s.source&&null!==s.line&&null!==s.column?(i===s.source&&o===s.line&&a===s.column&&c===s.name||r.addMapping({source:s.source,original:{line:s.line,column:s.column},generated:{line:t.line,column:t.column},name:s.name}),i=s.source,o=s.line,a=s.column,c=s.name,n=!0):n&&(r.addMapping({generated:{line:t.line,column:t.column}}),i=null,n=!1);for(let o=0,a=e.length;o<a;o++)10===e.charCodeAt(o)?(t.line++,t.column=0,o+1===a?(i=null,n=!1):n&&r.addMapping({source:s.source,original:{line:s.line,column:s.column},generated:{line:t.line,column:t.column},name:s.name})):t.column++})),this.walkSourceContents((function(e,t){r.setSourceContent(e,t)})),{code:t.code,map:r}}}t.SourceNode=a},90251:(e,t)=>{t.getArg=function(e,t,r){if(t in e)return e[t];if(3===arguments.length)return r;throw new Error('"'+t+'" is a required argument.')};const r=/^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.-]*)(?::(\d+))?(.*)$/,s=/^data:.+\,.+$/;function n(e){const t=e.match(r);return t?{scheme:t[1],auth:t[2],host:t[3],port:t[4],path:t[5]}:null}function i(e){let t="";return e.scheme&&(t+=e.scheme+":"),t+="//",e.auth&&(t+=e.auth+"@"),e.host&&(t+=e.host),e.port&&(t+=":"+e.port),e.path&&(t+=e.path),t}t.urlParse=n,t.urlGenerate=i;const o=function(){const e=[];return function(r){for(let t=0;t<e.length;t++)if(e[t].input===r){const r=e[0];return e[0]=e[t],e[t]=r,e[0].result}const s=function(e){let r=e;const s=n(e);if(s){if(!s.path)return e;r=s.path}const o=t.isAbsolute(r),a=[];let c=0,u=0;for(;;){if(c=u,u=r.indexOf("/",c),-1===u){a.push(r.slice(c));break}for(a.push(r.slice(c,u));u<r.length&&"/"===r[u];)u++}let l=0;for(u=a.length-1;u>=0;u--){const e=a[u];"."===e?a.splice(u,1):".."===e?l++:l>0&&(""===e?(a.splice(u+1,l),l=0):(a.splice(u,2),l--))}return r=a.join("/"),""===r&&(r=o?"/":"."),s?(s.path=r,i(s)):r}(r);return e.unshift({input:r,result:s}),e.length>32&&e.pop(),s}}();function a(e,t){""===e&&(e="."),""===t&&(t=".");const r=n(t),a=n(e);if(a&&(e=a.path||"/"),r&&!r.scheme)return a&&(r.scheme=a.scheme),i(r);if(r||t.match(s))return t;if(a&&!a.host&&!a.path)return a.host=t,i(a);const c="/"===t.charAt(0)?t:o(e.replace(/\/+$/,"")+"/"+t);return a?(a.path=c,i(a)):c}t.normalize=o,t.join=a,t.isAbsolute=function(e){return"/"===e.charAt(0)||r.test(e)},t.relative=function(e,t){""===e&&(e="."),e=e.replace(/\/$/,"");let r=0;for(;0!==t.indexOf(e+"/");){const s=e.lastIndexOf("/");if(s<0)return t;if((e=e.slice(0,s)).match(/^([^\/]+:\/)?\/*$/))return t;++r}return Array(r+1).join("../")+t.substr(e.length+1)};const c=!("__proto__"in Object.create(null));function u(e){return e}function l(e){if(!e)return!1;const t=e.length;if(t<9)return!1;if(95!==e.charCodeAt(t-1)||95!==e.charCodeAt(t-2)||111!==e.charCodeAt(t-3)||116!==e.charCodeAt(t-4)||111!==e.charCodeAt(t-5)||114!==e.charCodeAt(t-6)||112!==e.charCodeAt(t-7)||95!==e.charCodeAt(t-8)||95!==e.charCodeAt(t-9))return!1;for(let r=t-10;r>=0;r--)if(36!==e.charCodeAt(r))return!1;return!0}function p(e,t){return e===t?0:null===e?1:null===t?-1:e>t?1:-1}t.toSetString=c?u:function(e){return l(e)?"$"+e:e},t.fromSetString=c?u:function(e){return l(e)?e.slice(1):e},t.compareByOriginalPositions=function(e,t,r){let s=p(e.source,t.source);return 0!==s?s:(s=e.originalLine-t.originalLine,0!==s?s:(s=e.originalColumn-t.originalColumn,0!==s||r?s:(s=e.generatedColumn-t.generatedColumn,0!==s?s:(s=e.generatedLine-t.generatedLine,0!==s?s:p(e.name,t.name)))))},t.compareByGeneratedPositionsDeflated=function(e,t,r){let s=e.generatedLine-t.generatedLine;return 0!==s?s:(s=e.generatedColumn-t.generatedColumn,0!==s||r?s:(s=p(e.source,t.source),0!==s?s:(s=e.originalLine-t.originalLine,0!==s?s:(s=e.originalColumn-t.originalColumn,0!==s?s:p(e.name,t.name)))))},t.compareByGeneratedPositionsInflated=function(e,t){let r=e.generatedLine-t.generatedLine;return 0!==r?r:(r=e.generatedColumn-t.generatedColumn,0!==r?r:(r=p(e.source,t.source),0!==r?r:(r=e.originalLine-t.originalLine,0!==r?r:(r=e.originalColumn-t.originalColumn,0!==r?r:p(e.name,t.name)))))},t.parseSourceMapInput=function(e){return JSON.parse(e.replace(/^\)]}'[^\n]*\n/,""))},t.computeSourceURL=function(e,t,r){if(t=t||"",e&&("/"!==e[e.length-1]&&"/"!==t[0]&&(e+="/"),t=e+t),r){const e=n(r);if(!e)throw new Error("sourceMapURL could not be parsed");if(e.path){const t=e.path.lastIndexOf("/");t>=0&&(e.path=e.path.substring(0,t+1))}t=a(i(e),t)}return o(t)}},28991:(e,t,r)=>{const s=r(56576);function n(){this.generatedLine=0,this.generatedColumn=0,this.lastGeneratedColumn=null,this.source=null,this.originalLine=null,this.originalColumn=null,this.name=null}let i=null;e.exports=function(){if(i)return i;const e=[];return i=s().then((t=>WebAssembly.instantiate(t,{env:{mapping_callback(t,r,s,i,o,a,c,u,l,p){const d=new n;d.generatedLine=t+1,d.generatedColumn=r,s&&(d.lastGeneratedColumn=i-1),o&&(d.source=a,d.originalLine=c+1,d.originalColumn=u,l&&(d.name=p)),e[e.length-1](d)},start_all_generated_locations_for(){console.time("all_generated_locations_for")},end_all_generated_locations_for(){console.timeEnd("all_generated_locations_for")},start_compute_column_spans(){console.time("compute_column_spans")},end_compute_column_spans(){console.timeEnd("compute_column_spans")},start_generated_location_for(){console.time("generated_location_for")},end_generated_location_for(){console.timeEnd("generated_location_for")},start_original_location_for(){console.time("original_location_for")},end_original_location_for(){console.timeEnd("original_location_for")},start_parse_mappings(){console.time("parse_mappings")},end_parse_mappings(){console.timeEnd("parse_mappings")},start_sort_by_generated_location(){console.time("sort_by_generated_location")},end_sort_by_generated_location(){console.timeEnd("sort_by_generated_location")},start_sort_by_original_location(){console.time("sort_by_original_location")},end_sort_by_original_location(){console.timeEnd("sort_by_original_location")}}}))).then((t=>({exports:t.instance.exports,withMappingCallback:(t,r)=>{e.push(t);try{r()}finally{e.pop()}}}))).then(null,(e=>{throw i=null,e})),i}},19665:(e,t,r)=>{t.SourceMapGenerator=r(54041).SourceMapGenerator,t.SourceMapConsumer=r(47446).SourceMapConsumer,t.SourceNode=r(1683).SourceNode},17647:e=>{e.exports=function(e){let t,r,s,n,i,o,a;if(!e.length)return[];for(i=e.length-1;i>=0;i--){if(!e[i].length)return[];e[i]=e[i]._head.next[0].next}if(1===e.length)return e[0].toArray({field:"key"});if(2===e.length)return function(e,t){let r=Object.create(null),s=[];for(;e;e=e.next[0].next)r[e.key]=!0;for(;t;t=t.next[0].next)r[t.key]&&s.push(t.key);return s}(e[0],e[1]);if(3===e.length)return function(e,t,r){let s=Object.create(null),n=[];for(;e;e=e.next[0].next)s[e.key]=0;for(;t;t=t.next[0].next)0===s[t.key]&&(s[t.key]=1);for(;r;r=r.next[0].next)1===s[r.key]&&n.push(r.key);return n}(e[0],e[1],e[2]);for(s=Object.create(null),r=e.shift();r;r=r.next[0].next)s[r.key]=0;for(i=0,a=e.length-1;i<a;i++){for(n=0,o=i+1,r=e[i];r;r=r.next[0].next)s[r.key]===i&&(s[r.key]=o,n++);if(!n)return[]}for(t=[],r=e[i];r;r=r.next[0].next)s[r.key]===i&&t.push(r.key);return t}},70234:(e,t,r)=>{"use strict";const s=r(17647),n=Array.prototype.slice,i=1/Math.E;class o{constructor(e={}){this._unique=!!e.unique,this.empty()}static intersect(){return s.call(o,n.call(arguments))}add(e,t){let r;if(null==t)return this.rem(e);if(r=this._map.get(e),void 0!==r){if(t===r)return r;this._remove(e,r)}if(!this._insert(e,t))throw void 0===r||this._insert(e,r),new Error("unique constraint violated");return this._map.set(e,t),void 0===r?null:r}card(){return this.length?this.length:0}count(e,t){if(!this.length)return 0;if(null==e&&(e=-1/0),null==t&&(t=1/0),e<=this._head.next[0].next.value&&t>=this._tail.value)return this.length;if(t<e||e>this._tail.value||t<this._head.next[0].next.value)return 0;let r,s=this._first(e),n=0;if(!s)return 0;for(r=s.next.length-1;r>=0;r-=1)for(;s.next[r].next&&s.next[r].next.value<=t;)n+=s.next[r].span,s=s.next[r].next;return n&&n+1}del(e){return this.rem(e)}empty(){this.length=0,this._level=1,this._map=new Map,this._head=new c(32,null,0),this._tail=null;for(let e=0;e<32;e+=1)this._head.next[e]=new a(null,0)}get(e){return this.score(e)}has(e){return this._map.has(e)}incrBy(e,t){let r=this.score(t);return r?(this.add(t,r+e),r+e):(this.add(t,e),e)}intersect(){let e=n.call(arguments);return e.unshift(this),s.call(this,e)}intersectKeys(){let e=n.call(arguments);return e.unshift(this),intersectKeys.call(this,e)}keys(){if(!this.length)return[];let e,t=new Array(this.length),r=this._head.next[0].next;for(e=0;r;r=r.next[0].next)t[e]=r.key,e+=1;return t}range(e,t,r){if(0===this.length)return[];if(null==e?e=0:e<0&&(e=Math.max(this.length+e,0)),null==t?t=this.length-1:t<0&&(t=this.length+t),e>t||e>=this.length)return[];t>=this.length&&(t=this.length-1),"object"!=typeof r&&(r={withScores:!1});let s,n=0,i=t-e+1;try{s=new Array(i)}catch(r){throw console.log("start",e),console.log("stop",t),console.log("Invalid length",i),r}let o=e>0?this._get(e):this._head.next[0].next;if(r.withScores)for(;i--;o=o.next[0].next)s[n]=[o.key,o.value],n+=1;else for(;i--;o=o.next[0].next)s[n]=o.key,n+=1;return s}rangeByScore(e,t,r){if(!this.length)return[];if("object"!=typeof r&&(r={withScores:!1}),null==e&&(e=-1/0),null==t&&(t=1/0),e<=this._head.next[0].next.value&&t>=this._tail.value)return this.toArray({withScores:r.withScores});if(t<e||e>this._tail.value||t<this._head.next[0].next.value)return[];let s=this._first(e),n=[];if(r.withScores)for(;s&&s.value<=t;s=s.next[0].next)n.push([s.key,s.value]);else for(;s&&s.value<=t;s=s.next[0].next)n.push(s.key);return n}rank(e){let t,r=this._map.get(e);if(void 0===r)return null;let s=this._head,n=null,i=-1;for(t=this._level-1;t>=0;t-=1){for(;(n=s.next[t].next)&&(n.value<r||n.value===r&&n.key<=e);)i+=s.next[t].span,s=n;if(s.key&&s.key===e)return i}return null}rem(e){let t=this._map.get(e);return void 0!==t?(this._remove(e,t),this._map.delete(e),t):null}remRangeByRank(e,t){let r=this.length;if(!r)return 0;if(null==e?e=0:e<0&&(e=Math.max(r+e,0)),null==t?t=r:t<0&&(t=r+t),e>t||e>=r)return 0;if(t>r&&(t=r),0===e&&t===r)return this.empty(),r;let s,n,i=this._head,o=new Array(32),a=-1;for(s=this._level-1;s>=0;s-=1){for(;(n=i.next[s].next)&&a+i.next[s].span<e;)a+=i.next[s].span,i=n;o[s]=i}let c=0;for(a+=1,i=i.next[0].next;i&&a<t;)n=i.next[0].next,this._removeNode(i,o),this._map.delete(i.key),c+=1,a+=1,i=n;return this.length-=c,c}remRangeByScore(e,t){let r,s,n=0;if(!this.length)return 0;if(null==e&&(e=-1/0),null==t&&(t=1/0),e<=this._head.next[0].next.value&&t>=this._tail.value)return n=this.length,this.empty(),n;let i=this._head,o=new Array(32);for(s=this._level-1;s>=0;s-=1){for(;(r=i.next[s].next)&&r.value<e;)i=r;o[s]=i}for(i=i.next[0].next;i&&i.value<=t;)r=i.next[0].next,this._removeNode(i,o),this._map.delete(i.key),n+=1,i=r;return this.length-=n,n}score(e){let t=this._map.get(e);return void 0===t?null:t}set(e,t){return this.add(e,t)}slice(e,t,r){return"number"==typeof t&&0!==t&&(t-=1),this.range(e,t,r)}toArray(e){if(!this.length)return[];let t;"object"!=typeof e&&(e={withScores:!1});let r=new Array(this.length),s=this._head.next[0].next;if(e.withScores)for(t=0;s;s=s.next[0].next)r[t]=[s.key,s.value],t+=1;else for(t=0;s;s=s.next[0].next)r[t]=s.key,t+=1;return r}values(){if(!this.length)return[];let e,t=new Array(this.length),r=this._head.next[0].next;for(e=0;r;r=r.next[0].next)t[e]=r.value,e+=1;return t}_first(e){let t=this._tail;if(!t||t.value<e)return null;t=this._head;for(let r=null,s=this._level-1;s>=0;s-=1)for(;(r=t.next[s].next)&&r.value<e;)t=r;return t.next[0].next}_get(e){let t,r=this._head,s=-1;for(t=this._level-1;t>=0;t-=1){for(;r.next[t].next&&s+r.next[t].span<=e;)s+=r.next[t].span,r=r.next[t].next;if(s===e)return r}return null}_insert(e,t){let r,s=new Array(32),n=new Array(32),o=this._head,u=null;for(r=this._level-1;r>=0;r-=1){for(n[r]=r===this._level-1?0:n[r+1];(u=o.next[r].next)&&u.value<=t;){if(u.value===t){if(this._unique)return null;if(u.key>=e)break}n[r]+=o.next[r].span,o=u}if(this._unique&&o.value===t)return null;s[r]=o}if(this._unique&&o.value===t)return null;let l=function(){let e=1;for(;Math.random()<i;)e+=1;return e<32?e:32}();if(l>this._level){for(r=this._level;r<l;r+=1)n[r]=0,s[r]=this._head,s[r].next[r].span=this.length;this._level=l}for(o=new c(l,e,t),r=0;r<l;r+=1)o.next[r]=new a(s[r].next[r].next,s[r].next[r].span-(n[0]-n[r])),s[r].next[r].next=o,s[r].next[r].span=n[0]-n[r]+1;for(r=l;r<this._level;r+=1)s[r].next[r].span++;return o.prev=s[0]===this._head?null:s[0],o.next[0].next?o.next[0].next.prev=o:this._tail=o,this.length+=1,o}_next(e,t){let r,s;if(!this._tail||this._tail.value<e)return null;for(r=null;(r=t.next[t.next.length-1].next)&&r.value<e;)t=r;if(t.value===e)return t;for(s=t.next.length-1;s>=0;s-=1){for(;(r=t.next[s].next)&&r.value<e;)t=r;if(t.value===e)return t}return t.next[0].next}_remove(e,t){let r,s,n=new Array(32),i=this._head;for(r=this._level-1;r>=0;r-=1){for(;(s=i.next[r].next)&&(s.value<t||s.value===t&&s.key<e);)i=s;n[r]=i}if(i=i.next[0].next,!i||t!==i.value||i.key!==e)return!1;this._removeNode(i,n),this.length-=1}_removeNode(e,t){let r=null,s=0,n=this._level;for(;s<n;s+=1)t[s].next[s].next===e?(t[s].next[s].span+=e.next[s].span-1,t[s].next[s].next=e.next[s].next):t[s].next[s].span-=1;for((r=e.next[0].next)?r.prev=e.prev:this._tail=e.prev;this._level>1&&!this._head.next[this._level-1].next;)this._level-=1}}function a(e,t){this.next=e,this.span=t}function c(e,t,r){this.key=t,this.value=r,this.next=new Array(e),this.prev=null}e.exports=o},4693:e=>{class t{constructor(e){this.value=e,this.next=void 0}}class r{constructor(){this.clear()}enqueue(e){const r=new t(e);this._head?(this._tail.next=r,this._tail=r):(this._head=r,this._tail=r),this._size++}dequeue(){const e=this._head;if(e)return this._head=this._head.next,this._size--,e.value}clear(){this._head=void 0,this._tail=void 0,this._size=0}get size(){return this._size}*[Symbol.iterator](){let e=this._head;for(;e;)yield e.value,e=e.next}}e.exports=r},8437:(e,t,r)=>{"use strict";const{getUserLandFrames:s}=r(78834),n=Number(process.env._DD_CODE_ORIGIN_MAX_USER_FRAMES)||8;function i(e,t){const r=s(t,n),i={"_dd.code_origin.type":e};for(let e=0;e<r.length;e++){const t=r[e];i[`_dd.code_origin.frames.${e}.file`]=t.file,i[`_dd.code_origin.frames.${e}.line`]=String(t.line),i[`_dd.code_origin.frames.${e}.column`]=String(t.column),t.method&&(i[`_dd.code_origin.frames.${e}.method`]=t.method),t.type&&(i[`_dd.code_origin.frames.${e}.type`]=t.type)}return i}e.exports={entryTags:function(e){return i("entry",e)},exitTags:function(e){return i("exit",e)}}},96882:(e,t,r)=>{"use strict";const s=r(3962);e.exports={storage:s}},3962:(e,t,r)=>{"use strict";const{AsyncLocalStorage:s}=r(90290);class n extends s{enterWith(e){const t={};i.set(t,e),super.enterWith(t)}getHandle(){return super.getStore()}getStore(e){return e||(e=super.getStore()),i.get(e)}run(e,t,...r){const s=super.getStore();this.enterWith(e);try{return Reflect.apply(t,null,r)}finally{super.enterWith(s)}}}const i=new WeakMap,o=Object.create(null);function a(e){return o[e]||(o[e]=new n),o[e]}const c=new n;a.disable=c.disable.bind(c),a.enterWith=c.enterWith.bind(c),a.exit=c.exit.bind(c),a.getHandle=c.getHandle.bind(c),a.getStore=c.getStore.bind(c),a.run=c.run.bind(c),e.exports=a},98496:e=>{"use strict";e.exports=(e,t)=>{const r=t.split(".");let s=e;for(const e of r){if(void 0===s)return s;s=s[e]}return s}},4612:e=>{"use strict";e.exports=(e,t)=>{const r=t.split(".");let s=e;for(const e of r){if(!s.hasOwnProperty(e))return!1;s=s[e]}return!0}},65461:e=>{"use strict";e.exports=e=>{if("string"!=typeof e)throw new TypeError("Expected a string");return e.trim().replace(/([a-z])([A-Z])/g,"$1-$2").replace(/\s+/g,"-").replace(/^-+|-+$/g,"").replace(/_/g,"-").replace(/-{2,}/g,"-").toLowerCase()}},62963:e=>{"use strict";e.exports=(e,t)=>{const r={};return t.forEach((t=>{t in e&&(r[t]=e[t])})),r}},15204:e=>{"use strict";e.exports=(e,t,r)=>{const s=t.split(".");let n,i=e;for(n=0;n<s.length-1;n++){const e=s[n];i.hasOwnProperty(e)?i=i[e]:i[e]=i={}}i[s[n]]=r}},39587:e=>{"use strict";e.exports=function(e){return[...new Set(e)]}},96406:(e,t,r)=>{"use strict";r(92153),r(948)},68434:(e,t,r)=>{"use strict";const{addHook:s}=r(95092),n=r(81444),i=(0,r(1247).tracingChannel)("apm:aerospike:command");function o(e){return function(...t){if("function"!=typeof t[0])return e.apply(this,t);const r={commandName:this.constructor.name,commandArgs:this.args,clientConfig:this.client.config};return i.traceCallback(e,-1,r,this,...t)}}s({name:"aerospike",file:"lib/commands/command.js",versions:["4","5","6"]},(e=>n.wrapFunction(e,(e=>{return"function"!=typeof(t=e)?t:function(){const e=t.apply(this,arguments);return e?(n.wrap(e.prototype,"process",o),e):e};var t}))))},60249:(e,t,r)=>{"use strict";const{channel:s,addHook:n,AsyncResource:i}=r(95092),o=r(81444);function a(e,t,r){r&&t.publish(r),e.publish()}n({name:"amqp10",file:"lib/sender_link.js",versions:[">=3"]},(e=>{const t=s("apm:amqp10:send:start"),r=s("apm:amqp10:send:finish"),n=s("apm:amqp10:send:error");return o.wrap(e.prototype,"send",(e=>function(s,o){if(!t.hasSubscribers)return e.apply(this,arguments);const c=new i("bound-anonymous-fn");return c.runInAsyncScope((()=>{t.publish({link:this});try{const t=e.apply(this,arguments);return t?(t.then(c.bind((()=>a(r,n))),c.bind((e=>a(r,n,e)))),t):(a(r,n),t)}catch(e){throw a(r,n,e),e}}))})),e})),n({name:"amqp10",file:"lib/receiver_link.js",versions:[">=3"]},(e=>{const t=s("apm:amqp10:receive:start"),r=s("apm:amqp10:receive:finish"),n=s("apm:amqp10:receive:error");return o.wrap(e.prototype,"_messageReceived",(e=>function(s){return!s||s.aborted||s.more?e.apply(this,arguments):new i("bound-anonymous-fn").runInAsyncScope((()=>{t.publish({link:this});try{return e.apply(this,arguments)}catch(e){throw n.publish(e),e}finally{r.publish()}}))})),e}))},78481:(e,t,r)=>{"use strict";const{channel:s,addHook:n,AsyncResource:i}=r(95092),o=r(65461),a=r(81444),{NODE_MAJOR:c,NODE_MINOR:u}=r(63837),l=c>22||22===c&&u>=2?">=0.5.3":">=0.5.0",p=s("apm:amqplib:command:start"),d=s("apm:amqplib:command:finish"),h=s("apm:amqplib:command:error");let f={};function g(e,t,r,s,n,o){return p.hasSubscribers&&"basic.get"!==s?new i("bound-anonymous-fn").runInAsyncScope((()=>{p.publish({channel:t,method:s,fields:n,message:o});try{return e.apply(t,r)}catch(e){throw h.publish(e),e}finally{d.publish()}})):e.apply(t,r)}n({name:"amqplib",file:"lib/defs.js",versions:[l]},(e=>(f=Object.keys(e).filter((t=>Number.isInteger(e[t]))).filter((e=>/([A-Z][a-z0-9]+)+/.test(e))).reduce(((t,r)=>Object.assign(t,{[e[r]]:o(r).replace("-",".")})),{}),e))),n({name:"amqplib",file:"lib/channel_model.js",versions:[l]},(e=>(a.wrap(e.Channel.prototype,"get",(e=>function(t,r){return e.apply(this,arguments).then((e=>(null===e||(p.publish({method:"basic.get",message:e,fields:e.fields,queue:t}),d.publish()),e)))})),a.wrap(e.Channel.prototype,"consume",(e=>function(t,r,s){return p.hasSubscribers?(arguments[1]=(e,...s)=>{if(null===e)return r(e,...s);p.publish({method:"basic.deliver",message:e,fields:e.fields,queue:t});const n=r(e,...s);return d.publish(),n},e.apply(this,arguments)):e.apply(this,arguments)})),e))),n({name:"amqplib",file:"lib/callback_model.js",versions:[l]},(e=>(a.wrap(e.Channel.prototype,"get",(e=>function(t,r,s){return p.hasSubscribers?(arguments[2]=(e,r,...n)=>{if(null!==e||null===r)return s(e,r,...n);p.publish({method:"basic.get",message:r,fields:r.fields,queue:t});const i=s(e,r,...n);return d.publish(),i},e.apply(this,arguments)):e.apply(this,arguments)})),a.wrap(e.Channel.prototype,"consume",(e=>function(t,r){return p.hasSubscribers?(arguments[1]=(e,...s)=>{if(null===e)return r(e,...s);p.publish({method:"basic.deliver",message:e,fields:e.fields,queue:t});const n=r(e,...s);return d.publish(),n},e.apply(this,arguments)):e.apply(this,arguments)})),e))),n({name:"amqplib",file:"lib/channel.js",versions:[l]},(e=>(a.wrap(e.Channel.prototype,"sendImmediately",(e=>function(t,r){return g(e,this,arguments,f[t],r)})),a.wrap(e.Channel.prototype,"sendMessage",(e=>function(t){return g(e,this,arguments,"basic.publish",t,arguments[2])})),e)))},92612:(e,t,r)=>{"use strict";const{addHook:s}=r(95092),n=r(81444),i=r(1247).tracingChannel("datadog:apollo-server-core:request");s({name:"apollo-server-core",file:"dist/runHttpQuery.js",versions:[">3.0.0"]},(e=>{const t=e.HttpQueryError;return n.wrap(e,"runHttpQuery",(function(e){return async function(){if(!i.start.hasSubscribers)return e.apply(this,arguments);const r=new AbortController,s={},n=i.tracePromise(e,{abortController:r,abortData:s},this,...arguments),o=new Promise(((e,n)=>{r.signal.addEventListener("abort",(e=>{n(new t(s.statusCode,s.message,!0,s.headers))}),{once:!0})}));return Promise.race([n,o])}})),e}))},72342:(e,t,r)=>{"use strict";const s=r(1247),{addHook:n}=r(95092),i=r(81444),o=s.tracingChannel("datadog:apollo:middleware"),a=s.tracingChannel("datadog:apollo:request");let c;function u(e){return async function(){if(!c||!a.start.hasSubscribers)return e.apply(this,arguments);const t=new AbortController,r={},s=a.tracePromise(e,{abortController:t,abortData:r},this,...arguments),n=new Promise(((e,s)=>{t.signal.addEventListener("abort",(t=>{const s=new c;Object.keys(r.headers).forEach((e=>{s.set(e,r.headers[e])})),e({headers:s,status:r.statusCode,body:{kind:"complete",string:r.message}})}),{once:!0})}));return Promise.race([n,s])}}n({name:"@apollo/server",file:"dist/cjs/ApolloServer.js",versions:[">=4.0.0"]},(function(e){return i.wrap(e.ApolloServer.prototype,"executeHTTPGraphQLRequest",u),e})),n({name:"@apollo/server",file:"dist/cjs/express4/index.js",versions:[">=4.0.0"]},(function(e){return i.wrap(e,"expressMiddleware",(function(e){return function(t,r){const s=e.apply(this,arguments);return i.wrapFunction(s,(e=>function(t,r,s){return o.start.hasSubscribers?o.traceSync(e,{req:t},this,...arguments):e.apply(this,arguments)}))}})),e})),n({name:"@apollo/server",file:"dist/cjs/utils/HeaderMap.js",versions:[">=4.0.0"]},(function(e){return c=e.HeaderMap,e}))},37352:(e,t,r)=>{const{addHook:s,channel:n}=r(95092),i=r(81444),o=r(1247).tracingChannel,a={"gateway.request":o("apm:apollo:gateway:request"),"gateway.plan":o("apm:apollo:gateway:plan"),"gateway.validate":o("apm:apollo:gateway:validate"),"gateway.execute":o("apm:apollo:gateway:execute"),"gateway.fetch":o("apm:apollo:gateway:fetch"),"gateway.postprocessing":o("apm:apollo:gateway:postprocessing")},c=n("apm:apollo:gateway:general:error");function u(e){return function(...t){const r=a["gateway.request"],s={requestContext:t[0],gateway:this};return r.tracePromise(e,s,this,...t)}}function l(e){return class extends e{constructor(...e){super(...e),i.wrap(this,"executor",u)}}}function p(e){return function(...t){const r=t[1];return c.publish({error:r[r.length-1]}),e.apply(this,t)}}function d(e){return function(...t){const r=t[0],s=t[t.length-1];if("string"!=typeof r||"function"!=typeof s)return e.apply(this,t);const n=a[r];let i={};switch("gateway.fetch"===r&&(i={attributes:t[1].attributes}),r){case"gateway.plan":case"gateway.validate":t[t.length-1]=function(...e){return n.traceSync(s,i,this,...e)};break;case"gateway.request":break;case"gateway.execute":case"gateway.postprocessing":case"gateway.fetch":t[t.length-1]=function(...e){return n.tracePromise(s,i,this,...e)}}return e.apply(this,t)}}s({name:"@apollo/gateway",file:"dist/utilities/opentelemetry.js",versions:[">=2.3.0"]},(e=>{const t=Object.create(e.tracer);return i.wrap(t,"startActiveSpan",d),e.tracer=t,e})),s({name:"@apollo/gateway",file:"dist/utilities/opentelemetry.js",versions:[">=2.6.0"]},(e=>(i.wrap(e,"recordExceptions",p),e))),s({name:"@apollo/gateway",versions:[">=2.3.0"]},(e=>(i.wrap(e,"ApolloGateway",l),e)))},62954:(e,t,r)=>{const s=r(81444),{addHook:n}=r(95092),i=r(1247),o=i.channel("apm:avsc:serialize-start"),a=i.channel("apm:avsc:deserialize-end");n({name:"avsc",versions:[">=5.0.0"]},(e=>{var t;return t=e.Type,s.wrap(t.prototype,"fromBuffer",(e=>function(){if(!a.hasSubscribers)return e.apply(this,arguments);const t=e.apply(this,arguments);return a.publish({messageClass:t}),t})),function(e){s.wrap(e.prototype,"toBuffer",(e=>function(){return o.hasSubscribers?(o.publish({messageClass:this}),e.apply(this,arguments)):e.apply(this,arguments)}))}(e.Type),e}))},63599:(e,t,r)=>{"use strict";const{channel:s,addHook:n,AsyncResource:i}=r(95092),o=r(81444);function a(e){return function(t){if(!this.service)return e.apply(this,arguments);const r=this.service.serviceIdentifier,n=l(r),a=s(`apm:aws:request:start:${n}`);if(!a.hasSubscribers)return e.apply(this,arguments);const c=new i("apm:aws:request:inner"),u=new i("apm:aws:request:outer");return c.runInAsyncScope((()=>(this.on("complete",c.bind((e=>{const r="function"==typeof t;s(`apm:aws:request:complete:${n}`).publish({response:e,cbExists:r})}))),a.publish({serviceIdentifier:r,operation:this.operation,awsRegion:this.service.config&&this.service.config.region,awsService:this.service.api&&this.service.api.className,request:this}),"function"==typeof t&&(arguments[0]=function(e,t,r,n){return o.wrapFunction(e,(e=>function(i,o){const a={request:r,response:o};return n.runInAsyncScope((()=>{if(s(`apm:aws:response:start:${t}`).publish(a),!a.needsFinish)return e.apply(this,arguments);const r=s(`apm:aws:response:finish:${t}`);try{let t=e.apply(this,arguments);return t&&t.then?t=t.then((e=>(r.publish(),e)),(e=>{throw r.publish(e),e})):r.publish(),t}catch(e){throw r.publish(e),e}}))}))}(t,n,this,u)),e.apply(this,arguments))))}}function c(e){return function(t,...r){const n=r[r.length-1],a=new i("apm:aws:request:inner"),c=new i("apm:aws:request:outer"),p=this.config.serviceId.toLowerCase(),d=l(p),h=t.constructor.name,f=this.constructor.name.replace(/Client$/,""),g=`${h[0].toLowerCase()}${h.slice(1).replace(/Command$/,"")}`,m={operation:g,params:t.input},_=s(`apm:aws:request:start:${d}`),y=s(`apm:aws:request:region:${d}`),b=s(`apm:aws:request:complete:${d}`),v=s(`apm:aws:response:start:${d}`),E=s(`apm:aws:response:finish:${d}`);return"function"==typeof t.deserialize&&o.wrap(t,"deserialize",(e=>function(e,t){const r=s(`apm:aws:response:deserialize:${t}`);return function(t){return r.hasSubscribers&&r.publish({headers:t.headers}),e.apply(this,arguments)}}(e,d))),a.runInAsyncScope((()=>(_.publish({serviceIdentifier:p,operation:g,awsService:f,request:m}),this.config.region().then((e=>{y.publish(e)})),"function"!=typeof n?e.call(this,t,...r).then((e=>{const t=u(m,null,e);return b.publish(t),e}),(e=>{const t=u(m,e);throw b.publish(t),e})):(r[r.length-1]=o.wrapFunction(n,(e=>function(t,r){const s=u(m,t,r);b.publish(s),c.runInAsyncScope((()=>{v.publish(s),e.apply(this,arguments),s.needsFinish&&E.publish(s.response.error)}))})),e.call(this,t,...r)))))}}function u(e,t,r){const s={request:e,error:t,...r};return r&&r.$metadata&&(s.requestId=r.$metadata.requestId),{request:e,response:s}}function l(e){return e=e.replaceAll(" ",""),["cloudwatchlogs","dynamodb","eventbridge","kinesis","lambda","redshift","s3","sfn","sns","sqs","states","stepfunctions","bedrockruntime"].includes(e)?e:"default"}n({name:"@smithy/smithy-client",versions:[">=1.0.3"]},(e=>(o.wrap(e.Client.prototype,"send",c),e))),n({name:"@aws-sdk/smithy-client",versions:[">=3"]},(e=>(o.wrap(e.Client.prototype,"send",c),e))),n({name:"aws-sdk",versions:[">=2.3.0"]},(e=>(o.wrap(e.config,"setPromisesDependency",(t=>function(r){const s=t.apply(this,arguments);return o.wrap(e.Request.prototype,"promise",a),s})),e))),n({name:"aws-sdk",file:"lib/core.js",versions:[">=2.3.0"]},(e=>(o.wrap(e.Request.prototype,"promise",a),e))),n({name:"aws-sdk",file:"lib/core.js",versions:[">=2.1.35"]},(e=>(o.wrap(e.Request.prototype,"send",a),e)))},16764:(e,t,r)=>{"use strict";const{addHook:s}=r(95092),n=r(81444),i=r(1247).tracingChannel("datadog:azure:functions:invoke");function o(e){return function(t,r){if("object"==typeof r&&r.hasOwnProperty("handler")){const s=r;n.wrap(s,"handler",(r=>a(r,t,e.name)))}else if("function"==typeof r){const s=r;arguments[1]=n.wrapFunction(s,(r=>a(r,t,e.name)))}return e.apply(this,arguments)}}function a(e,t,r){return function(...s){const n=s[0],o=s[1];return i.tracePromise(e,{functionName:t,httpRequest:n,invocationContext:o,methodName:r},this,...s)}}s({name:"@azure/functions",versions:[">=4"]},(e=>{const{app:t}=e;return n.wrap(t,"deleteRequest",o),n.wrap(t,"http",o),n.wrap(t,"get",o),n.wrap(t,"patch",o),n.wrap(t,"post",o),n.wrap(t,"put",o),e}))},74464:(e,t,r)=>{"use strict";const{addHook:s}=r(95092),{wrapThen:n}=r(30060),i=r(81444);function o(e){return function(t){return function(){const r=t.apply(this,arguments);return i.wrap(r.prototype,"_then",n),i.wrap(r,"getNewLibraryCopy",o(e)),r}}}s({name:"bluebird",versions:[">=2.0.2"]},(e=>(i.wrap(e.prototype,"_then",n),e))),s({name:"bluebird",versions:["^2.11.0","^3.4.1"]},(e=>(i.wrap(e,"getNewLibraryCopy",o(e)),e)))},95175:(e,t,r)=>{"use strict";const s=r(81444),{channel:n,addHook:i,AsyncResource:o}=r(95092),a=n("datadog:body-parser:read:finish");function c(e,t,r){return s.wrapFunction(r,(r=>function(){if(a.hasSubscribers&&e){const r=new AbortController,s=e.body;if(a.publish({req:e,res:t,body:s,abortController:r}),r.signal.aborted)return}return r.apply(this,arguments)}))}i({name:"body-parser",file:"lib/read.js",versions:[">=1.4.0 <1.20.0"]},(e=>s.wrapFunction(e,(e=>function(t,r,s){const n=new o("bound-anonymous-fn");return arguments[2]=n.bind(c(t,r,s)),e.apply(this,arguments)})))),i({name:"body-parser",file:"lib/read.js",versions:[">=1.20.0"]},(e=>s.wrapFunction(e,(e=>function(t,r,s){return arguments[2]=c(t,r,s),e.apply(this,arguments)}))))},43772:(e,t,r)=>{"use strict";const{channel:s,addHook:n}=r(95092),i=r(81444);n({name:"bunyan",versions:[">=1"]},(e=>{const t=s("apm:bunyan:log");return i.wrap(e.prototype,"_emit",(e=>function(r){if(t.hasSubscribers){const e={message:r};t.publish(e),arguments[0]=e.message}return e.apply(this,arguments)})),e}))},7256:(e,t,r)=>{"use strict";const{channel:s,addHook:n,AsyncResource:i}=r(95092),o=r(81444),a=s("apm:cassandra-driver:query:start"),c=s("apm:cassandra-driver:query:finish"),u=s("apm:cassandra-driver:query:error"),l=s("apm:cassandra-driver:query:connect");function p(e,t,r){r&&t.publish(r),e.publish(void 0)}function d(e,t,r,s){return o.wrapFunction(s,(s=>r.bind((function(r){if(p(e,t,r),s)return s.apply(this,arguments)}))))}function h(e,t,r){return!!e&&t.length===r&&"function"==typeof t[r-1]}n({name:"cassandra-driver",versions:[">=3.0.0"]},(e=>(o.wrap(e.Client.prototype,"batch",(e=>function(t,r,s){if(!a.hasSubscribers)return e.apply(this,arguments);const n=new i("bound-anonymous-fn"),o=new i("bound-anonymous-fn"),l=arguments.length-1;let h=arguments[l];return"function"==typeof h&&(h=n.bind(h),arguments[l]=d(c,u,o,h)),o.runInAsyncScope((()=>{const r=this.options&&this.options.contactPoints;a.publish({keyspace:this.keyspace,query:t,contactPoints:r});try{const t=e.apply(this,arguments);if("function"!=typeof t&&t){const e=new i("bound-anonymous-fn");return t.then(e.bind((()=>p(c,u))),e.bind((e=>p(c,u,e))))}return d(c,u,o,t)}catch(e){throw p(c,u,e),e}}))})),e))),n({name:"cassandra-driver",versions:[">=4.4"]},(e=>(o.wrap(e.Client.prototype,"_execute",(e=>function(t,r,s,n){return a.hasSubscribers?new i("bound-anonymous-fn").runInAsyncScope((()=>{const r=this.options&&this.options.contactPoints;a.publish({keyspace:this.keyspace,query:t,contactPoints:r});const s=e.apply(this,arguments),n=new i("bound-anonymous-fn");return s.then(n.bind((()=>p(c,u))),n.bind((e=>p(c,u,e)))),s})):e.apply(this,arguments)})),e))),n({name:"cassandra-driver",versions:["3 - 4.3"]},(e=>(o.wrap(e.Client.prototype,"_innerExecute",(e=>function(t,r,s,n){if(!a.hasSubscribers)return e.apply(this,arguments);const o=new i("bound-anonymous-fn"),l=new i("bound-anonymous-fn");return 4!==(h=arguments).length&&"function"!=typeof h[3]?e.apply(this,arguments):l.runInAsyncScope((()=>{const r=this.options&&this.options.contactPoints;a.publish({keyspace:this.keyspace,query:t,contactPoints:r});const s=arguments.length-1;let n=arguments[s];"function"==typeof n&&(n=o.bind(n),arguments[s]=d(c,u,l,n));try{return e.apply(this,arguments)}catch(e){throw p(c,u,e),e}}));var h})),e))),n({name:"cassandra-driver",versions:[">=3.3"],file:"lib/request-execution.js"},(e=>(o.wrap(e.prototype,"_sendOnConnection",(e=>function(){return a.hasSubscribers?(l.publish({hostname:this._connection.address,port:this._connection.port}),e.apply(this,arguments)):e.apply(this,arguments)})),e))),n({name:"cassandra-driver",versions:["3.3 - 4.3"],file:"lib/request-execution.js"},(e=>(o.wrap(e.prototype,"start",(e=>function(t){if(!a.hasSubscribers)return t.apply(this,arguments);const r=new i("bound-anonymous-fn"),s=this;return h(this,arguments,1)?(t=r.bind(t),arguments[0]=i.bind((function(){return l.publish({hostname:s._connection.address,port:s._connection.port}),t.apply(this,arguments)})),e.apply(this,arguments)):e.apply(this,arguments)})),e))),n({name:"cassandra-driver",versions:["3 - 3.2"],file:"lib/request-handler.js"},(e=>(o.wrap(e.prototype,"send",(e=>function(t,r,s){if(!a.hasSubscribers)return e.apply(this,arguments);const n=this;if(!h(this,arguments,3))return e.apply(this,arguments);const o=new i("bound-anonymous-fn");return s=o.bind(s),arguments[2]=i.bind((function(){return l.publish({hostname:n.connection.address,port:n.connection.port}),s.apply(this,arguments)})),e.apply(this,arguments)})),e)))},51006:(e,t,r)=>{"use strict";const s=[],n=new Set(["@appsignal/javascript","@appsignal/nodejs","@dynatrace/oneagent","@instana/aws-fargate","@instana/aws-lambda","@instana/azure-container-services","@instana/collector","@instana/google-cloud-run","@sentry/node","appoptics-apm","atatus-nodejs","elastic-apm-node","newrelic","stackify-node-apm","sqreen"]),i=r(69657);e.exports.checkForRequiredModules=function(){const e=r(17969),t=new Set;let n=!1;for(const o of Object.keys(r.c)){const{pkg:r}=i(o);t.has(r)||r in e&&(s.push(`Warning: Package '${r}' was loaded before dd-trace! This may break instrumentation.`),t.add(r),n=!0)}n&&s.push("Warning: Please ensure dd-trace is loaded before other modules.")},e.exports.checkForPotentialConflicts=function(){const e=new Set;let t=!1;for(const o of Object.keys(r.c)){const{pkg:r}=i(o);e.has(r)||n.has(r)&&(s.push(`Warning: Package '${r}' may cause conflicts with dd-trace.`),e.add(r),t=!0)}t&&s.push("Warning: Packages were loaded that may conflict with dd-trace.")},e.exports.flushStartupLogs=function(e){for(;s.length;)e.warn(s.shift())}},92787:(e,t,r)=>{"use strict";const s=r(39023),{addHook:n,AsyncResource:i}=r(95092),o=r(81444),a=r(1247).tracingChannel("datadog:child_process:execution"),c=["execFile","spawn"];let u=!1;function l(e){throw e}function p(e,t){return t.result={error:e,status:null,signal:null,output:null,stdout:null,stderr:null,pid:0},t.result}function d(e,t){const r={command:e[0],file:e[0]};return Array.isArray(e[1])?(r.command=r.command+" "+e[1].join(" "),r.fileArgs=e[1],null!==e[2]&&"object"==typeof e[2]&&(r.options=e[2])):null!==e[1]&&"object"==typeof e[1]&&(r.options=e[1]),r.shell=t||!0===r.options?.shell||"string"==typeof r.options?.shell,r}function h(e){const t={command:e.command,file:e.file,shell:e.shell};return e.fileArgs&&(t.fileArgs=e.fileArgs),t}function f(e,t=!1){return function(r){return function(){if(!a.start.hasSubscribers||0===arguments.length)return r.apply(this,arguments);const s=d(arguments,t);return new i("bound-anonymous-fn").runInAsyncScope((()=>{const t=h(s),n=new AbortController;a.start.publish({...t,abortController:n});try{if(n.signal.aborted){const r=n.signal.reason||new Error("Aborted");return e(r,t)}const s=r.apply(this,arguments);return t.result=s,s}catch(e){throw t.error=e,a.error.publish(t),e}finally{a.end.publish(t)}}))}}}["child_process","node:child_process"].forEach((e=>{n({name:e},(e=>(u||(u=!0,o.massWrap(e,c,function(e,t=!1){return function(r){function n(){if(!a.start.hasSubscribers||0===arguments.length)return r.apply(this,arguments);const s=d(arguments,t),n=arguments[arguments.length-1];if("function"==typeof n){const e=new i("bound-anonymous-fn");arguments[arguments.length-1]=e.bind(n)}return new i("bound-anonymous-fn").runInAsyncScope((()=>{const t=h(s),n=new AbortController;let i;if(a.start.publish({...t,abortController:n}),n.signal.aborted?(i=new e,i.on("error",(()=>{})),process.nextTick((()=>{const e=n.signal.reason||new Error("Aborted");i.emit("error",e);const t=arguments[arguments.length-1];"function"==typeof t&&t(e),i.emit("close")}))):i=r.apply(this,arguments),i){let e=!1;i.on("error",(t=>{e=!0,a.error.publish(t)})),i.on("close",(r=>{r=r||0,e||0===r||a.error.publish(),a.asyncEnd.publish({...t,result:r})}))}return i}))}if(r[s.promisify.custom]){const e=o.wrapFunction(r[s.promisify.custom],(e=>function(e,t){return function(){if(!a.start.hasSubscribers||0===arguments.length)return e.apply(this,arguments);const r=h(d(arguments,t)),{start:s,end:n,asyncStart:i,asyncEnd:o,error:c}=a,u=new AbortController;let l;if(s.publish({...r,abortController:u}),u.signal.aborted)l=Promise.reject(u.signal.reason||new Error("Aborted"));else try{l=e.apply(this,arguments)}catch(c){throw c.publish({...r,error:c}),c}finally{n.publish(r)}return Promise.prototype.then.call(l,(function(e){return r.result=e,i.publish(r),o.publish(r),e}),(function(e){return r.error=e,c.publish(r),i.publish(r),o.publish(r),Promise.reject(e)}))}}(e,t))),i=Object.getOwnPropertyDescriptor(r,s.promisify.custom);Object.defineProperty(n,s.promisify.custom,{...i,value:e})}return n}}(e.ChildProcess)),o.wrap(e,"execSync",f(l,!0)),o.wrap(e,"execFileSync",f(l)),o.wrap(e,"spawnSync",f(p))),e)))}))},66757:(e,t,r)=>{"use strict";const s=r(81444),{addHook:n,channel:i}=r(95092),o=i("apm:connect:middleware:enter"),a=i("apm:connect:middleware:exit"),c=i("apm:connect:middleware:error"),u=i("apm:connect:middleware:next"),l=i("apm:connect:middleware:finish"),p=i("apm:connect:request:handle");function d(e){return"function"!=typeof e?e:function(t,r){const n=e.apply(this,arguments);if(!this||!Array.isArray(this.stack))return n;const i=this.stack.length-1,p=this.stack[i];return p&&p.handle&&(this.stack[i].handle=function(e){if("function"!=typeof e.handle)return e.handle;const t=e.handle;return s.wrapFunction(t,(t=>function(){if(!o.hasSubscribers)return t.apply(this,arguments);const r=arguments.length-1,n=t._name||t.name,i=arguments[arguments.length>3?1:0],p=arguments[r];"function"==typeof p&&(arguments[r]=function(e,t){return s.wrapFunction(t,(t=>function(r){r&&c.publish({req:e,error:r}),u.publish({req:e}),l.publish({req:e}),t.apply(this,arguments)}))}(i,p));const d=e.route;o.publish({name:n,req:i,route:d});try{return t.apply(this,arguments)}catch(e){throw c.publish({req:i,error:e}),u.publish({req:i}),l.publish({req:i}),e}finally{a.publish({req:i})}}))}(p)),n}}function h(e){return function(t,r){return p.hasSubscribers&&p.publish({req:t,res:r}),e.apply(this,arguments)}}n({name:"connect",versions:[">=3"]},(e=>s.wrapFunction(e,(e=>function(e){return"function"!=typeof e?e:function(){const t=e();return t?(s.wrap(t,"use",d),s.wrap(t,"handle",h),t):t}}(e))))),n({name:"connect",versions:["2.2.2"]},(e=>(s.wrap(e.proto,"use",d),s.wrap(e.proto,"handle",h),e)))},53325:(e,t,r)=>{"use strict";const s=r(81444),{channel:n,addHook:i}=r(95092),o=n("datadog:cookie-parser:read:finish");i({name:"cookie-parser",versions:[">=1.0.0"]},(e=>s.wrapFunction(e,(e=>function(){const t=e.apply(this,arguments);return s.wrapFunction(t,(e=>function(t,r,n){return arguments[2]=function(e,t,r){return s.wrapFunction(r,(r=>function(){if(o.hasSubscribers&&e){const r=new AbortController,s=Object.assign({},e.cookies,e.signedCookies);if(o.publish({req:e,res:t,abortController:r,cookies:s}),r.signal.aborted)return}return r.apply(this,arguments)}))}(t,r,n),e.apply(this,arguments)}))}))))},23682:(e,t,r)=>{"use strict";const s=r(81444),{channel:n,addHook:i}=r(95092),o=n("datadog:cookie:parse:finish");function a(e){return function(){const t=e.apply(this,arguments);return o.hasSubscribers&&t&&o.publish({cookies:t}),t}}i({name:"cookie",versions:[">=0.4"]},(e=>(s.wrap(e,"parse",a),e)))},12940:(e,t,r)=>{"use strict";const{channel:s,addHook:n,AsyncResource:i}=r(95092),o=r(81444);function a(e,t=2){for(let r=e.length-1;r>=t;r--)if("function"==typeof e[r])return r;return-1}function c(e){return e&&("string"==typeof e?e:e.statement)}function u(e,t){e.forEach((e=>t(e)))}function l(e){return function(t,r){if(!Array.isArray(r))return e.apply(this,arguments);const s=r.length-1,n=r[s];return n instanceof Function&&(r[s]=i.bind(n)),e.apply(this,arguments)}}function p(e){return function(t,r,s){return"function"==typeof(s=i.bind(arguments[arguments.length-1]))&&(arguments[arguments.length-1]=s),e.apply(this,arguments)}}function d(e,t,r,n,c){const u=s(`apm:couchbase:${t}:start`),l=s(`apm:couchbase:${t}:finish`),p=s(`apm:couchbase:${t}:error`);if(!u.hasSubscribers)return e.apply(n,c);const d=new i("bound-anonymous-fn"),h=new i("bound-anonymous-fn");return d.runInAsyncScope((()=>{u.publish(r);try{const t=a(c,1);if(t>=0){const e=h.bind(c[t]);c[t]=o.wrapFunction(e,(e=>d.bind((function(t,r){return t&&p.publish(t),l.publish({result:r}),e.apply(n,arguments)}))))}const r=e.apply(n,c);return r.then(d.bind((e=>l.publish({result:e}))),d.bind((e=>p.publish(e)))),r}catch(e){throw e.stack,p.publish(e),e}}))}function h(e){return function(t){return function(){return d(t,e,{collection:{name:this._name||"_default"},bucket:{name:this._scope._bucket._name},seedNodes:this._dd_connStr},this,arguments)}}}function f(e){return function(t){const r=c(t);return d(e,"query",{resource:r,seedNodes:this._connStr},this,arguments)}}n({name:"couchbase",file:"lib/bucket.js",versions:["^2.6.12"]},(e=>{const t=s("apm:couchbase:query:start"),r=s("apm:couchbase:query:finish"),n=s("apm:couchbase:query:error");return o.wrap(e.prototype,"_maybeInvoke",(e=>l(e))),o.wrap(e.prototype,"query",(e=>p(e))),o.wrap(e.prototype,"_n1qlReq",(e=>function(s,o,a,u){if(!t.hasSubscribers)return e.apply(this,arguments);if(!u||!u.once)return e.apply(this,arguments);const l=c(o),p=new i("bound-anonymous-fn");return p.runInAsyncScope((()=>{t.publish({resource:l,bucket:{name:this.name||this._name},seedNodes:this._dd_hosts}),u.once("rows",p.bind((()=>{r.publish(void 0)}))),u.once("error",p.bind((e=>{n.publish(e),r.publish(void 0)})));try{return e.apply(this,arguments)}catch(e){throw e.stack,n.publish(e),e}}))})),u(["upsert","insert","replace","append","prepend"],(t=>{o.wrap(e.prototype,t,(e=>function(e,t){const r=s(e+":start"),n=s(e+":finish"),c=s(e+":error");return function(){if(!r.hasSubscribers)return t.apply(this,arguments);const e=a(arguments);if(e<0)return t.apply(this,arguments);const s=new i("bound-anonymous-fn"),u=new i("bound-anonymous-fn");return u.runInAsyncScope((()=>{const i=s.bind(arguments[e]);r.publish({bucket:{name:this.name||this._name},seedNodes:this._dd_hosts}),arguments[e]=o.wrapFunction(i,(e=>u.bind((function(t,r){return t&&c.publish(t),n.publish(r),e.apply(this,arguments)}))));try{return t.apply(this,arguments)}catch(e){throw e.stack,c.publish(e),e}}))}}(`apm:couchbase:${t}`,e)))})),e})),n({name:"couchbase",file:"lib/cluster.js",versions:["^2.6.12"]},(e=>(o.wrap(e.prototype,"_maybeInvoke",(e=>l(e))),o.wrap(e.prototype,"query",(e=>p(e))),o.wrap(e.prototype,"openBucket",(e=>function(){const t=e.apply(this,arguments),r=this.dsnObj.hosts;return t._dd_hosts=r.map((e=>e.join(":"))).join(","),t})),e))),n({name:"couchbase",file:"lib/bucket.js",versions:["^3.0.7","^3.1.3"]},(e=>(o.wrap(e.prototype,"collection",(e=>function(){const t=e.apply(this,arguments),r=this._cluster._connStr;return t._dd_connStr=r,t})),e))),n({name:"couchbase",file:"lib/collection.js",versions:["^3.0.7","^3.1.3"]},(e=>(u(["upsert","insert","replace"],(t=>{o.wrap(e.prototype,t,h(t))})),e))),n({name:"couchbase",file:"lib/cluster.js",versions:["^3.0.7","^3.1.3"]},(e=>(o.wrap(e.prototype,"query",f),e))),n({name:"couchbase",file:"dist/collection.js",versions:[">=3.2.2"]},(e=>{const t=e.Collection;return u(["upsert","insert","replace"],(e=>{o.wrap(t.prototype,e,h(e))})),e})),n({name:"couchbase",file:"dist/bucket.js",versions:[">=3.2.2"]},(e=>{const t=e.Bucket;return o.wrap(t.prototype,"collection",(e=>function(){const t=e.apply(this,arguments),r=this._cluster._connStr;return t._dd_connStr=r,t})),e})),n({name:"couchbase",file:"dist/cluster.js",versions:[">=3.2.2"]},(e=>{const t=e.Cluster;return o.wrap(t.prototype,"query",f),e}))},61486:(e,t,r)=>{"use strict";const{channel:s,addHook:n}=r(95092),i=r(81444),o=s("datadog:crypto:hashing:start"),a=s("datadog:crypto:cipher:start"),c=["createHash","createHmac","createSign","createVerify","sign","verify"],u=["createCipheriv","createDecipheriv"];function l(e){return function(t){return function(){if(e.hasSubscribers&&arguments.length>0){const t=arguments[0];e.publish({algorithm:t})}return t.apply(this,arguments)}}}n({name:["crypto","node:crypto"]},(e=>(i.massWrap(e,c,l(o)),i.massWrap(e,u,l(a)),e)))},62543:(e,t,r)=>{"use strict";const{createCoverageMap:s}=r(51958),{addHook:n,channel:i,AsyncResource:o}=r(95092),a=r(81444),c=r(75004),u=i("ci:cucumber:test:start"),l=i("ci:cucumber:test:retry"),p=i("ci:cucumber:test:finish"),d=i("ci:cucumber:test-step:start"),h=i("ci:cucumber:error"),f=i("ci:cucumber:test-suite:start"),g=i("ci:cucumber:test-suite:finish"),m=i("ci:cucumber:test-suite:code-coverage"),_=i("ci:cucumber:library-configuration"),y=i("ci:cucumber:known-tests"),b=i("ci:cucumber:test-suite:skippable"),v=i("ci:cucumber:session:start"),E=i("ci:cucumber:session:finish"),S=i("ci:cucumber:worker-report:trace"),T=i("ci:cucumber:itr:skipped-suites"),w=i("ci:nyc:get-coverage"),{getCoveredFilenamesFromCoverage:x,resetCoverage:A,mergeCoverage:I,fromCoverageMapToCoverage:k,getTestSuitePath:O,CUCUMBER_WORKER_TRACE_PAYLOAD_CODE:R,getIsFaultyEarlyFlakeDetection:C}=r(97507),N=e=>!!e.tags.find((e=>"@datadog:unskippable"===e.name)),P=s(),D=new WeakSet,L=new Map,M=new Map,q=new Map,j=new Map;let U=null,F={};const B={},$=new o("bound-anonymous-fn");let G=[],V="",z=!1,H=!1,K=!1,Y=!1,Q=0,W=0,Z=!1,J=!1,X=!1,ee=0,te=[],re=[],se=!1;function ne(e){return e.some((e=>"fail"===e))?"fail":e.every((e=>"skip"===e))?"skip":"pass"}function ie(e){return 1===e.status?{status:"pass"}:2===e.status?{status:"skip"}:4===e.status?{status:"skip",skipReason:"not implemented"}:{status:"fail",errorMessage:e.message}}function oe(e){return"PASSED"===e.status?{status:"pass"}:"SKIPPED"===e.status||"PENDING"===e.status?{status:"skip"}:"UNDEFINED"===e.status?{status:"skip",skipReason:"not implemented"}:{status:"fail",errorMessage:e.message}}function ae(e,t){return!(te.cucumber?.[e]||[]).includes(t)}function ce(e){return e.every((e=>"fail"===e))?"fail":(e.some((e=>"pass"===e)),"pass")}function ue(e){if(!e.message)return;const[t]=e.message.split("\n"),r=new Error(t);return e.exception&&(r.type=e.exception.type),r.stack=e.message,r}function le(e){return new Promise((t=>{$.runInAsyncScope((()=>{e.publish({onDone:t})}))}))}function pe(e,t){const r=O(e.uri,process.cwd()),s=N(e);return[t.includes(r)&&!s,r]}function de(e,t){D.has(e)||(D.add(e),a.wrap(e.prototype,"run",(e=>function(){if(!u.hasSubscribers)return e.apply(this,arguments);let r=0;const s=new o("bound-anonymous-fn");q.set(r,s);const n=this.pickle.uri,i=this.gherkinDocument?.feature?.location?.line,c={testName:this.pickle.name,testFileAbsolutePath:n,testSourceLine:i,isParallel:!!process.env.CUCUMBER_WORKER_ID};s.runInAsyncScope((()=>{u.publish(c)}));const d={};try{let n;return this.eventBroadcaster.on("envelope",a.wrapFunction(null,(()=>async e=>{if(e?.testCaseFinished){const{testCaseFinished:{willBeRetried:t}}=e;if(t){let e;try{const t=this.getWorstStepResult();e=ue(t)}catch(e){}const t=q.get(r),s=0==r++;d.hitBreakpointPromise&&await d.hitBreakpointPromise,t.runInAsyncScope((()=>{l.publish({isFirstAttempt:s,error:e})}));const n=new o("bound-anonymous-fn");q.set(r,n),n.runInAsyncScope((()=>{u.publish({...c,promises:d})}))}}}))),s.runInAsyncScope((()=>{n=e.apply(this,arguments)})),n.finally((async()=>{const e=this.getWorstStepResult(),{status:s,skipReason:n}=t?oe(e):ie(e);L.has(this.pickle.id)?L.get(this.pickle.id).push(s):L.set(this.pickle.id,[s]);let i=!1,o=!1;if(X&&"skip"!==s){const e=M.get(this.pickle.id);i=void 0!==e,o=e>0}const a=q.get(r),c=ue(e);d.hitBreakpointPromise&&await d.hitBreakpointPromise,a.runInAsyncScope((()=>{p.publish({status:s,skipReason:n,error:c,isNew:i,isEfdRetry:o,isFlakyRetry:r>0})}))})),n}catch(e){throw h.publish(e),e}})),a.wrap(e.prototype,"runStep",(e=>function(){if(!d.hasSubscribers)return e.apply(this,arguments);const r=arguments[0];let s;return s=t?r.text:r.isHook?"hook":r.pickleStep.text,new o("bound-anonymous-fn").runInAsyncScope((()=>{d.publish({resource:s});try{const r=e.apply(this,arguments);return r.then((e=>{const{status:r,skipReason:s,errorMessage:n}=t?oe(e):ie(e);p.publish({isStep:!0,status:r,skipReason:s,errorMessage:n})})),r}catch(e){throw h.publish(e),e}}))})))}function he(e,t,r=!1,s=!1){return async function(){if(!_.hasSubscribers)return e.apply(this,arguments);const n=(i=this).adapter?i.adapter.worker?.options||i.adapter.options:i.options;var i;let o;!r&&this.adapter?.options&&(r=n.parallel>0);const a=await le(_);if(Y=a.libraryConfig?.isEarlyFlakeDetectionEnabled,Q=a.libraryConfig?.earlyFlakeDetectionNumRetries,W=a.libraryConfig?.earlyFlakeDetectionFaultyThreshold,K=a.libraryConfig?.isSuitesSkippingEnabled,J=a.libraryConfig?.isFlakyTestRetriesEnabled,ee=a.libraryConfig?.flakyTestRetriesCount,X=a.libraryConfig?.isKnownTestsEnabled,X){const e=await le(y);e.err?(Y=!1,X=!1):te=e.knownTests}if(K){const e=await le(b);if(o=e.err,G=e.skippableSuites,!o){const t=s?(u=G,this.sourcedPickles.reduce(((e,t)=>{const{pickle:r}=t,[s,n]=pe(r,u);return s?e.skippedSuites.add(n):e.picklesToRun.push(t),e}),{skippedSuites:new Set,picklesToRun:[]})):function(e,t){return e.pickleIds.reduce(((r,s)=>{const n=e.eventDataCollector.getPickle(s),[i,o]=pe(n,t);return i?r.skippedSuites.add(o):r.picklesToRun.push(s),r}),{skippedSuites:new Set,picklesToRun:[]})}(this,G),{picklesToRun:r}=t,n=s?this.sourcedPickles:this.pickleIds;se=r.length!==n.length,c.debug((()=>`${r.length} out of ${n.length} suites are going to run.`)),s?this.sourcedPickles=r:this.pickleIds=r,re=Array.from(t.skippedSuites),V=e.itrCorrelationId}}var u,l;F=s?this.sourcedPickles.reduce(((e,{pickle:t})=>(e[t.uri]?e[t.uri].push(t):e[t.uri]=[t],e)),{}):(l=this).pickleIds.reduce(((e,t)=>{const r=l.eventDataCollector.getPickle(t);return e[r.uri]?e[r.uri].push(r):e[r.uri]=[r],e}),{}),X&&C(Object.keys(F),te.cucumber||{},W)&&(Y=!1,X=!1,Z=!0);const p=process.argv.slice(2).join(" "),d=process.env.npm_lifecycle_script||`cucumber-js ${p}`;J&&!n.retry&&ee>0&&(n.retry=ee),$.runInAsyncScope((()=>{v.publish({command:d,frameworkVersion:t})})),!o&&re.length&&T.publish({skippedSuites:re,frameworkVersion:t});const h=await e.apply(this,arguments);let f,g;if(w.hasSubscribers&&(f=await le(w)),global.__coverage__){try{f&&P.merge(k(f)),g=P.getCoverageSummary().lines.pct}catch(e){}global.__coverage__=k(P)}return $.runInAsyncScope((()=>{E.publish({status:h?"pass":"fail",isSuitesSkipped:se,testCodeCoverageLinesTotal:g,numSkippedSuites:re.length,hasUnskippableSuites:H,hasForcedToRunSuites:z,isEarlyFlakeDetectionEnabled:Y,isEarlyFlakeDetectionFaulty:Z,isParallel:r})})),U=null,h}}function fe(e,t=!1,r=!1){return async function(){let s;s=t?arguments[0].pickle:this.eventDataCollector.getPickle(arguments[0]);const n=s.uri,i=O(n,process.cwd());r||B[n]||(H=N(s),z=H&&G.includes(i),f.publish({testFileAbsolutePath:n,isUnskippable:H,isForcedToRun:z,itrCorrelationId:V}));let o=!1;X&&(o=ae(i,s.name),o&&M.set(s.id,0));let a=await e.apply(this,arguments);const c=L.get(s.id),u=c[c.length-1];if(Y&&"skip"!==u&&o)for(let t=0;t<Q;t++)M.set(s.id,t+1),a=await e.apply(this,arguments);let l=u,p=!1;if(o&&Y&&(l=ce(c),"pass"===l&&(p=!0,this.success=!0)),B[n]?B[n].push(l):B[n]=[l],!r&&B[n].length===F[n].length){const e=ne(B[n]);if(global.__coverage__){const e=x(global.__coverage__);m.publish({coverageFiles:e,suiteFile:n,testSuitePath:i}),I(global.__coverage__,P),A(global.__coverage__)}g.publish({status:e,testSuitePath:i})}return t&&Y&&o?p:a}}function ge(e,t){return function(r,s){if(Array.isArray(s)){const[e,t]=s;if(e===R)return void $.runInAsyncScope((()=>{S.publish(t)}))}let n;if(n=t?s.envelope:s.jsonEnvelope,!n)return e.apply(this,arguments);let i,o=n;if("string"==typeof o)try{o=JSON.parse(n)}catch(t){return e.apply(this,arguments)}if(o.testCaseStarted){if(t)i=this.inProgress[r.id].pickle;else{const{pickleId:e}=this.eventDataCollector.testCaseMap[o.testCaseStarted.testCaseId];i=this.eventDataCollector.getPickle(e)}const e=i.uri;B[e]||(B[e]=[],f.publish({testFileAbsolutePath:e}))}const a=e.apply(this,arguments);if(o.testCaseFinished){let e;if(t&&U)i=this.inProgress[r.id].pickle,e=U.getTestCaseAttempt(o.testCaseFinished.testCaseStartedId).worstTestStepResult;else{const t=this.eventDataCollector.getTestCaseAttempt(o.testCaseFinished.testCaseStartedId);e=t.worstTestStepResult,i=t.pickle}const{status:s}=oe(e);let n=!1;X&&(n=ae(i.uri,i.name));const a=i.uri,c=B[a];if(Y&&n){const e=`${i.uri}:${i.name}`;let t=j.get(e);if(t?t.push(s):(t=[s],j.set(e,t)),t.length===Q+1){const e=ce(t);c.push(e)}}else B[a].push(s);c.length===F[a].length&&g.publish({status:ne(c),testSuitePath:O(a,process.cwd())})}return a}}n({name:"@cucumber/cucumber",versions:["7.0.0 - 7.2.1"],file:"lib/runtime/pickle_runner.js"},(function(e){return de(e.default,!1),e})),n({name:"@cucumber/cucumber",versions:[">=7.3.0"],file:"lib/runtime/test_case_runner.js"},(function(e){return de(e.default,!0),e})),n({name:"@cucumber/cucumber",versions:[">=7.3.0 <11.0.0"],file:"lib/runtime/index.js"},((e,t)=>(a.wrap(e.default.prototype,"runTestCase",(e=>fe(e))),a.wrap(e.default.prototype,"start",(e=>he(e,t))),e))),n({name:"@cucumber/cucumber",versions:[">=7.0.0 <7.3.0"],file:"lib/runtime/index.js"},((e,t)=>(a.wrap(e.default.prototype,"runPickle",(e=>fe(e))),a.wrap(e.default.prototype,"start",(e=>he(e,t))),e))),n({name:"@cucumber/cucumber",versions:[">=8.0.0 <11.0.0"],file:"lib/runtime/parallel/coordinator.js"},((e,t)=>(a.wrap(e.default.prototype,"start",(e=>he(e,t,!0))),a.wrap(e.default.prototype,"parseWorkerMessage",(e=>ge(e))),e))),n({name:"@cucumber/cucumber",versions:[">=11.0.0"],file:"lib/runtime/worker.js"},(e=>(a.wrap(e.Worker.prototype,"runTestCase",(e=>fe(e,!0,!!process.env.CUCUMBER_WORKER_ID))),e))),n({name:"@cucumber/cucumber",versions:[">=11.0.0"],file:"lib/runtime/coordinator.js"},((e,t)=>(a.wrap(e.Coordinator.prototype,"run",(e=>he(e,t,!1,!0))),e))),n({name:"@cucumber/cucumber",versions:[">=11.0.0"],file:"lib/formatter/helpers/event_data_collector.js"},(e=>(a.wrap(e.default.prototype,"parseEnvelope",(e=>function(){return U=this,e.apply(this,arguments)})),e))),n({name:"@cucumber/cucumber",versions:[">=11.0.0"],file:"lib/runtime/parallel/adapter.js"},(e=>(a.wrap(e.ChildProcessAdapter.prototype,"parseWorkerMessage",(e=>ge(e,!0))),a.wrap(e.ChildProcessAdapter.prototype,"startWorker",(e=>function(){return X&&(this.options.worldParameters._ddIsEarlyFlakeDetectionEnabled=Y,this.options.worldParameters._ddKnownTests=te,this.options.worldParameters._ddEarlyFlakeDetectionNumRetries=Q),e.apply(this,arguments)})),e))),n({name:"@cucumber/cucumber",versions:[">=11.0.0"],file:"lib/runtime/parallel/worker.js"},(e=>(a.wrap(e.ChildProcessWorker.prototype,"initialize",(e=>async function(){await e.apply(this,arguments),X=!!this.options.worldParameters._ddKnownTests,X&&(te=this.options.worldParameters._ddKnownTests),Y=!!this.options.worldParameters._ddIsEarlyFlakeDetectionEnabled,Y&&(Q=this.options.worldParameters._ddEarlyFlakeDetectionNumRetries)})),e)))},8600:(e,t,r)=>{const{addHook:s}=r(95092);s({name:"cypress",versions:[">=6.7.0"]},(e=>e))},74736:(e,t,r)=>{"use strict";const{channel:s,addHook:n,AsyncResource:i}=r(95092),o=r(81444),a={resolveAny:"ANY",resolve4:"A",resolve6:"AAAA",resolveCname:"CNAME",resolveMx:"MX",resolveNs:"NS",resolveTxt:"TXT",resolveSrv:"SRV",resolvePtr:"PTR",resolveNaptr:"NAPTR",resolveSoa:"SOA"},c=new WeakMap;function u(e){Object.keys(a).filter((t=>!!e[t])).forEach((t=>{c.set(e[t],a[t]),o.wrap(e,t,(e=>l("apm:dns:resolve",e,2,a[t])))}))}function l(e,t,r,n){const a=s(e+":start"),c=s(e+":finish"),u=s(e+":error");return function(){const e=i.bind(arguments[arguments.length-1]);if(!a.hasSubscribers||arguments.length<r||"function"!=typeof e)return t.apply(this,arguments);const s=Array.from(arguments);s.pop(),n&&s.push(n);const l=new i("bound-anonymous-fn");return l.runInAsyncScope((()=>{a.publish(s),arguments[arguments.length-1]=o.wrapFunction(e,(e=>l.bind((function(t,r){t&&u.publish(t),c.publish(r),e.apply(this,arguments)}))));try{return t.apply(this,arguments)}catch(e){throw e.stack,u.publish(e),e}}))}}n({name:["dns","node:dns"]},(e=>(o.wrap(e,"lookup",(e=>l("apm:dns:lookup",e,2))),o.wrap(e,"lookupService",(e=>l("apm:dns:lookup_service",e,2))),o.wrap(e,"resolve",(e=>l("apm:dns:resolve",e,2))),o.wrap(e,"reverse",(e=>l("apm:dns:reverse",e,2))),u(e),e.Resolver&&(o.wrap(e.Resolver.prototype,"resolve",(e=>l("apm:dns:resolve",e,2))),o.wrap(e.Resolver.prototype,"reverse",(e=>l("apm:dns:reverse",e,2))),u(e.Resolver.prototype)),e)))},57604:(e,t,r)=>{"use strict";const{channel:s,addHook:n,AsyncResource:i}=r(95092),o=r(81444);function a(e){const t=s(`apm:${e}:query:connect`);return function(e){return function(){const r=e.apply(this,arguments);return t.hasSubscribers&&r&&r.url&&t.publish(r.url),r}}}function c(e){const t=s(`apm:${e}:query:start`),r=s(`apm:${e}:query:finish`),n=s(`apm:${e}:query:error`);return function(e){return function(r,s,c){if(!t.hasSubscribers)return e.apply(this,arguments);if(!r)return e.apply(this,arguments);const u=new i("bound-anonymous-fn"),l=new i("bound-anonymous-fn");return l.runInAsyncScope((()=>{t.publish({params:r});try{const t=arguments.length-1;if("function"==typeof(c=arguments[t]))return c=u.bind(c),arguments[t]=o.wrapFunction(c,(e=>l.bind((function(t){return a(r,t),e.apply(null,arguments)})))),e.apply(this,arguments);{const t=e.apply(this,arguments);if(t&&"function"==typeof t.then){const e=l.bind((()=>a(r))),s=l.bind((e=>a(r,e)));t.then(e,s)}else a(r);return t}}catch(e){throw e.stack,n.publish(e),e}}))}};function a(e,t){t&&n.publish(t),r.publish({params:e})}}n({name:"@elastic/transport",file:"lib/Transport.js",versions:[">=8"]},(e=>(o.wrap(e.default.prototype,"request",c("elasticsearch")),o.wrap(e.default.prototype,"getConnection",a("elasticsearch")),e))),n({name:"@elastic/elasticsearch",file:"lib/Transport.js",versions:[">=5.6.16 <8",">=8"]},(e=>(o.wrap(e.prototype,"request",c("elasticsearch")),o.wrap(e.prototype,"getConnection",a("elasticsearch")),e))),n({name:"elasticsearch",file:"src/lib/transport.js",versions:[">=10"]},(e=>(o.wrap(e.prototype,"request",c("elasticsearch")),e))),n({name:"elasticsearch",file:"src/lib/connection_pool.js",versions:[">=10"]},(e=>(o.wrap(e.prototype,"select",function(){const e=s("apm:elasticsearch:query:connect");return function(t){return function(){if(1===arguments.length){const t=arguments[0];arguments[0]=o.wrapFunction(t,(t=>function(r,s){e.hasSubscribers&&s&&s.host&&e.publish({hostname:s.host.host,port:s.host.port}),t(r,s)}))}return t.apply(this,arguments)}}}()),e))),e.exports={createWrapRequest:c,createWrapGetConnection:a}},32444:(e,t,r)=>{"use strict";const{channel:s,addHook:n}=r(95092),i=r(81444),o=s("datadog:express-mongo-sanitize:sanitize:finish"),a=s("datadog:express-mongo-sanitize:filter:finish"),c=["body","params","headers","query"];n({name:"express-mongo-sanitize",versions:[">=1.0.0"]},(e=>(i.wrap(e,"sanitize",(e=>function(){const t=e.apply(this,arguments);return o.hasSubscribers&&o.publish({sanitizedObject:t}),t})),i.wrapFunction(e,(e=>function(){const t=e.apply(this,arguments);return i.wrapFunction(t,(e=>function(t,r,s){if(!a.hasSubscribers)return e.apply(this,arguments);const n=i.wrapFunction(s,(e=>function(){return a.publish({sanitizedProperties:c,req:t}),e.apply(this,arguments)}));return e.call(this,t,r,n)}))})))))},33951:(e,t,r)=>{"use strict";const{createWrapRouterMethod:s}=r(86658),n=r(81444),{addHook:i,channel:o}=r(95092),a=r(1247).tracingChannel,c=o("apm:express:request:handle");function u(e){return function(t,r){return c.hasSubscribers&&c.publish({req:t}),e.apply(this,arguments)}}const l=s("express"),p=o("datadog:express:response:json:start");function d(e){return function(t){return p.hasSubscribers&&(2===arguments.length&&"number"!=typeof arguments[1]&&(t=arguments[1]),p.publish({req:this.req,res:this,body:t})),e.apply(this,arguments)}}const h=a("datadog:express:response:render");function f(e){return function(t,r,s){return h.start.hasSubscribers?h.traceSync(e,{req:this.req,view:t,options:r},this,...arguments):e.apply(this,arguments)}}i({name:"express",versions:[">=4"]},(e=>(n.wrap(e.application,"handle",u),n.wrap(e.response,"json",d),n.wrap(e.response,"jsonp",d),n.wrap(e.response,"render",f),e))),i({name:"express",versions:["4"]},(e=>(n.wrap(e.Router,"use",l),n.wrap(e.Router,"route",l),e))),i({name:"express",versions:[">=5.0.0"]},(e=>(n.wrap(e.Router.prototype,"use",l),n.wrap(e.Router.prototype,"route",l),e)));const g=o("datadog:query:read:finish");i({name:"express",versions:["4"],file:"lib/middleware/query.js"},(e=>n.wrapFunction(e,(e=>function(){const t=e.apply(this,arguments);return n.wrapFunction(t,(e=>function(t,r,s){return arguments[2]=function(e,t,r){return n.wrapFunction(r,(r=>function(){if(g.hasSubscribers&&e){const r=new AbortController,s=e.query;if(g.publish({req:e,res:t,query:s,abortController:r}),r.signal.aborted)return}return r.apply(this,arguments)}))}(t,r,s),e.apply(this,arguments)}))}))));const m=o("datadog:express:process_params:start");function _(e){return function(t){return function(){if(m.hasSubscribers){const t=arguments[e],r=new AbortController;if(m.publish({req:t,res:t?.res,abortController:r,params:t?.params}),r.signal.aborted)return}return t.apply(this,arguments)}}}i({name:"express",versions:[">=4.0.0 <4.3.0"]},(e=>(n.wrap(e.Router,"process_params",_(1)),e))),i({name:"express",versions:[">=4.3.0 <5.0.0"]},(e=>(n.wrap(e.Router,"process_params",_(2)),e)));const y=o("datadog:express:query:finish");i({name:"express",file:["lib/request.js"],versions:[">=5.0.0"]},(e=>{const t=Object.getOwnPropertyDescriptor(e,"query");return n.wrap(t,"get",(function(e){return function(){const t=e.apply(this,arguments);return y.hasSubscribers&&t&&y.publish({query:t}),t}})),Object.defineProperty(e,"query",t),e}))},31875:(e,t,r)=>{"use strict";const s=r(81444),{addHook:n,channel:i,AsyncResource:o}=r(95092),a=i("apm:fastify:middleware:error"),c=i("apm:fastify:request:handle"),u=i("apm:fastify:route:added"),l=new WeakMap;function p(e,t){return"function"!=typeof e?e:function(){const r=e.apply(this,arguments);return r&&"function"==typeof r.addHook?(r.addHook("onRoute",y),r.addHook("onRequest",d),r.addHook("preHandler",h),t?(r.addHook("preParsing",g),r.addHook("preValidation",f)):(r.addHook("onRequest",g),r.addHook("preHandler",f)),r.addHook=function(e){return s.wrapFunction(e,(e=>function(t,r){return"function"!=typeof(r=arguments[arguments.length-1])||(arguments[arguments.length-1]=s.wrapFunction(r,(e=>function(r,s,n){const i=m(r);try{if("function"==typeof n)return n=arguments[arguments.length-1],arguments[arguments.length-1]=function(e){if(_(e,i),"onRequest"===t||"preParsing"===t){const e=new o("bound-anonymous-fn");return l.set(i,e),e.runInAsyncScope((()=>n.apply(this,arguments)))}return n.apply(this,arguments)},e.apply(this,arguments);{const t=e.apply(this,arguments);return t&&"function"==typeof t.catch?t.catch((e=>_(e,i))):t}}catch(e){throw _(e,i)}}))),e.apply(this,arguments)}))}(r.addHook),r):r}}function d(e,t,r){if("function"!=typeof r)return;const s=m(e),n=function(e){return e&&(e.raw||e.res||e)}(t),i=function(e){return e?.routeOptions?.config}(e);return c.publish({req:s,res:n,routeConfig:i}),r()}function h(e,t,r){if("function"!=typeof r)return;if(!t||"function"!=typeof t.send)return r();const s=m(e);t.send=function(e,t){return function(r){return r instanceof Error&&a.publish({req:t,error:r}),e.apply(this,arguments)}}(t.send,s),r()}function f(e,t,r){const s=m(e),n=l.get(s);if(!n)return r();n.runInAsyncScope((()=>r()))}function g(e,t,r,s){"function"!=typeof s&&(s=r);const n=m(e),i=new o("bound-anonymous-fn");l.set(n,i),i.runInAsyncScope((()=>s()))}function m(e){return e&&(e.raw||e.req||e)}function _(e,t){return e&&a.publish({error:e,req:t}),e}function y(e){u.publish({routeOptions:e,onRoute:y})}n({name:"fastify",versions:[">=3"]},(e=>{const t=s.wrapFunction(e,(e=>p(e,!0)));return t.fastify=t,t.default=t,t})),n({name:"fastify",versions:["2"]},(e=>s.wrapFunction(e,(e=>p(e,!0))))),n({name:"fastify",versions:["1"]},(e=>s.wrapFunction(e,(e=>p(e,!1)))))},55931:(e,t,r)=>{"use strict";const s=r(81444),{tracingChannel:n}=r(1247),{createWrapFetch:i}=r(69189);if(globalThis.fetch){const e=n("apm:fetch:request"),t=i(globalThis.Request,e);globalThis.fetch=s.wrapFunction(fetch,(e=>t(e)))}},39153:(e,t,r)=>{"use strict";const s=r(81444),{addHook:n,channel:i}=r(95092),o=i("apm:find-my-way:request:route");function a(e){return function(t,r,n){const i="function"==typeof n?2:3,a=arguments[i],c=s.wrapFunction(a,(e=>function(t){return o.publish({req:t,route:r}),e.apply(this,arguments)}));return"function"==typeof a&&(arguments[i]=c),e.apply(this,arguments)}}n({name:"find-my-way",versions:[">=1"]},(e=>(s.wrap(e.prototype,"on",a),e)))},92108:(e,t,r)=>{"use strict";const{channel:s,addHook:n,AsyncResource:i}=r(95092),o=r(81444),a=s("apm:fs:operation:start"),c=s("apm:fs:operation:finish"),u=s("apm:fs:operation:error"),l=Symbol("ddFileHandle");let p,d,h;const f={access:["path","mode"],appendFile:["path","data","options"],chmod:["path","mode"],chown:["path","uid","gid"],close:["fd"],copyFile:["src","dest","mode"],cp:["src","dest","options"],exists:["path"],fchmod:["fd","mode"],fchown:["fd","uid","gid"],fdatasync:["fd"],fstat:["fd","options"],fsync:["fd"],ftruncate:["fd","len"],futimes:["fd","atime","mtime"],lchmod:["path","mode"],lchown:["path","uid","gid"],link:["existingPath","newPath"],lstat:["path","options"],lutimes:["path","atime","mtime"],mkdir:["path","options"],mkdtemp:["prefix","options"],open:["path","flag","mode"],opendir:["path","options"],read:["fd"],readdir:["path","options"],readFile:["path","options"],readlink:["path","options"],readv:["fd"],realpath:["path","options"],rename:["oldPath","newPath"],rmdir:["path","options"],rm:["path","options"],stat:["path","options"],symlink:["target","path","type"],truncate:["path","len"],unlink:["path"],utimes:["path","atime","mtime"],write:["fd"],writeFile:["file","data","options"],writev:["fd"]},g={unwatchFile:["path","listener"],watch:["path","options","listener"],watchFile:["path","options","listener"]},m={appendFile:["data","options"],chmod:["mode"],chown:["uid","gid"],close:[],createReadStream:["options"],createWriteStream:["options"],datasync:[],read:["buffer","offset","length","position"],readableWebStream:[],readFile:["options"],readLines:["options"],readv:["buffers","position"],stat:["options"],sync:[],truncate:["len"],utimes:["atime","mtime"],write:["buffer","offset","length","position"],writeFile:["data","options"],writev:["buffers","position"]};function _(e){return e.description||e.toString()}function y(e){const t={createReadStream:"ReadStream",createWriteStream:"WriteStream"}[e.name];return function(r,s){if(!a.hasSubscribers)return e.apply(this,arguments);const n=new i("bound-anonymous-fn"),o=E(t,["path","options"],arguments);return n.runInAsyncScope((()=>{a.publish(o);try{const t=e.apply(this,arguments),r=n.bind((e=>{u.publish(e),s()})),s=n.bind((()=>{c.publish(),t.off("close",s),t.off("end",s),t.off("finish",s),t.off("error",r)}));return t.once("close",s),t.once("end",s),t.once("finish",s),t.once("error",r),t}catch(e){u.publish(e),c.publish()}}))}}function b(e=""){return function(t){const r=e||t.name,s=r,n=r;return function(){if(!a.hasSubscribers)return t.apply(this,arguments);const e=E(s,g[n],arguments,this);return new i("bound-anonymous-fn").runInAsyncScope((()=>{a.publish(e);try{const e=t.apply(this,arguments);return c.publish(),e}catch(e){throw u.publish(e),c.publish(),e}}))}}}function v(e="",t=""){return function(r){const s=t||r.name,n=`${e}${s}`,d=s.match(/^(.+?)(Sync)?(\.native)?$/)[1];return function(){if(!a.hasSubscribers)return r.apply(this,arguments);const t=arguments.length-1,h="function"==typeof arguments[t]&&arguments[t],g=new i("bound-anonymous-fn"),_=function(e){return"filehandle."===e?m:f}(e)[d],y=new AbortController,b={...E(n,_,arguments,this),abortController:y},S=g.bind((function(e){null!==e&&"object"==typeof e&&u.publish(e),c.publish()}));if(h){const e=new i("bound-anonymous-fn");arguments[t]=o.wrapFunction(h,(t=>g.bind((function(r){return S(r),e.runInAsyncScope((()=>t.apply(this,arguments)))}))))}return g.runInAsyncScope((()=>{if(a.publish(b),y.signal.aborted){const r=y.signal.reason||new Error("Aborted");if("promises."===e)return S(r),Promise.reject(r);if(s.includes("Sync")||!h)throw S(r),r;if(h)return void arguments[t](r)}try{const e=r.apply(this,arguments);return h?e:e&&"function"==typeof e.then?e.then((e=>(function(e){return!p&&"open"===e.name}(r)&&function(e){const t=function(e){return p||(p=Reflect.ownKeys(e).find((e=>"symbol"==typeof e&&e.toString().includes("kHandle")))),Object.getPrototypeOf(e)}(e),r=Reflect.getOwnPropertyDescriptor(t,p);r&&r.get||Reflect.defineProperty(t,p,{get(){return this[l]},set(e){this[l]=e,T(this,"close",v("filehandle."))},configurable:!0});for(const e of Reflect.ownKeys(t))"string"==typeof e&&"constructor"!==e&&"fd"!==e&&"getAsyncId"!==e&&T(t,e,v("filehandle."))}(e),c.publish(),e)),(e=>{throw u.publish(e),c.publish(),e})):(c.publish(),e)}catch(e){throw u.publish(e),c.publish(),e}}))}}}function E(e,t,r,s){const n={};if(t)for(let e=0;e<t.length;e++)t[e]&&"function"!=typeof r[e]&&(n[t[e]]=r[e]);return s&&(s.path&&(n.path=s.path),s.fd&&(n.fd=s.fd)),{operation:e,...n}}function S(e,t,r){for(const s of t)T(e,s,r)}function T(e,t,r){try{o.wrap(e,t,r)}catch(e){}}["fs","node:fs"].forEach((e=>{n({name:e},(e=>{const t=Object.keys(f),r=t.map((e=>`${e}Sync`));return S(e,t,v()),S(e,r,v()),S(e.promises,t,v("promises.")),T(e.realpath,"native",v("","realpath.native")),T(e.realpathSync,"native",v("","realpath.native")),T(e.promises.realpath,"native",v("","realpath.native")),T(e,"createReadStream",y),T(e,"createWriteStream",y),e.Dir&&(T(e.Dir.prototype,"close",v("dir.")),T(e.Dir.prototype,"closeSync",v("dir.")),T(e.Dir.prototype,"read",v("dir.")),T(e.Dir.prototype,"readSync",v("dir.")),T(e.Dir.prototype,Symbol.asyncIterator,(function(e){return function(){return d&&h||function(e){const t=Reflect.ownKeys(e);for(const e of t){if(d&&h)break;"symbol"==typeof e&&(!d&&_(e).includes("kDirReadPromisified")&&(d=e),!h&&_(e).includes("kDirClosePromisified")&&(h=e))}}(this),T(this,d,v("dir.","read")),T(this,h,v("dir.","close")),e.apply(this,arguments)}}))),T(e,"unwatchFile",b()),T(e,"watch",b()),T(e,"watchFile",b()),e}))}))},49389:(e,t,r)=>{"use strict";const{addHook:s,AsyncResource:n}=r(95092),i=r(81444);function o(){return function(e){return function(t,r){return"function"==typeof t&&(arguments[0]=n.bind(t)),e.apply(this,arguments)}}}s({name:"generic-pool",versions:["^2.4"]},(e=>(i.wrap(e.Pool.prototype,"acquire",o()),e))),s({name:"generic-pool",versions:["2 - 2.3"]},(e=>(i.wrap(e,"Pool",(function(e){return"function"!=typeof e?e:function(t){const r=e.apply(this,arguments);return r&&"function"==typeof r.acquire&&i.wrap(r,"acquire",o()),r}})),e)))},88422:(e,t,r)=>{"use strict";const{channel:s,addHook:n,AsyncResource:i}=r(95092),o=r(81444),a=s("apm:google-cloud-pubsub:request:start"),c=s("apm:google-cloud-pubsub:request:finish"),u=s("apm:google-cloud-pubsub:request:error"),l=s("apm:google-cloud-pubsub:receive:start"),p=s("apm:google-cloud-pubsub:receive:finish"),d=s("apm:google-cloud-pubsub:receive:error"),h=["createTopic","updateTopic","publish","getTopic","listTopics","listTopicSubscriptions","listTopicSnapshots","deleteTopic","detachSubscription"],f=["createSchema","getSchema","listSchemas","listSchemaRevisions","commitSchema","rollbackSchema","deleteSchemaRevision","deleteSchema","validateSchema","validateMessage"],g=["createSubscription","getSubscription","updateSubscription","listSubscriptions","deleteSubscription","modifyAckDeadline","acknowledge","pull","streamingPull","modifyPushConfig","getSnapshot","listSnapshots","createSnapshot","updateSnapshot","deleteSnapshot","seek"];function m(e){const t=e.name;return function(r){if(!a.hasSubscribers)return e.apply(this,arguments);const s=new i("bound-anonymous-fn");return s.runInAsyncScope((()=>{const n=this.auth._cachedProjectId,l=arguments[arguments.length-1];if(a.publish({request:r,api:t,projectId:n}),"function"==typeof l){const t=new i("bound-anonymous-fn");return arguments[arguments.length-1]=o.wrapFunction(l,(e=>s.bind((function(r){return r&&u.publish(r),c.publish(),t.runInAsyncScope((()=>e.apply(this,arguments)))})))),e.apply(this,arguments)}return e.apply(this,arguments).then((e=>(c.publish(),e)),(e=>{throw u.publish(e),c.publish(),e}))}))}}function _(e,t,r){for(const s of t)"function"==typeof e[s]&&o.wrap(e,s,r)}n({name:"@google-cloud/pubsub",versions:[">=1.2"]},(e=>{const t=e.Subscription;return o.wrap(t.prototype,"emit",(e=>function(t,r){return"message"===t&&r?new i("bound-anonymous-fn").runInAsyncScope((()=>{try{return e.apply(this,arguments)}catch(e){throw d.publish(e),e}})):e.apply(this,arguments)})),e})),n({name:"@google-cloud/pubsub",versions:[">=1.2"],file:"build/src/lease-manager.js"},(e=>{const t=e.LeaseManager;return o.wrap(t.prototype,"_dispense",(e=>function(t){return l.hasSubscribers&&l.publish({message:t}),e.apply(this,arguments)})),o.wrap(t.prototype,"remove",(e=>function(t){return p.publish({message:t}),e.apply(this,arguments)})),o.wrap(t.prototype,"clear",(e=>function(){for(const e of this._messages)p.publish({message:e});return e.apply(this,arguments)})),e})),n({name:"@google-cloud/pubsub",versions:[">=1.2"]},(e=>{const{PublisherClient:t,SchemaServiceClient:r,SubscriberClient:s}=e.v1;return _(t.prototype,h,m),_(s.prototype,g,m),r&&_(r.prototype,f,m),e}))},20902:(e,t,r)=>{"use strict";const{addHook:s,channel:n,AsyncResource:i}=r(95092),o=r(81444),a=new WeakMap,c=new WeakMap,u=new WeakSet,l=new WeakSet,p=n("apm:graphql:execute:start"),d=n("apm:graphql:execute:finish"),h=n("apm:graphql:execute:error"),f=n("apm:graphql:resolve:start"),g=n("apm:graphql:resolve:finish"),m=n("apm:graphql:resolve:updateField"),_=n("apm:graphql:resolve:error"),y=n("apm:graphql:parser:start"),b=n("apm:graphql:parser:finish"),v=n("apm:graphql:parser:error"),E=n("apm:graphql:validate:start"),S=n("apm:graphql:validate:finish"),T=n("apm:graphql:validate:error");class w extends Error{constructor(e){super(e),this.name="AbortError"}}function x(e,t){if(!e||!Array.isArray(e.definitions))return;const r=e.definitions.filter((e=>e)),s=["query","mutation","subscription"];return t?r.filter((e=>-1!==s.indexOf(e.operation))).find((e=>t===(e.name&&e.name.value))):r.find((e=>-1!==s.indexOf(e.operation)))}function A(e){return function(t){return y.hasSubscribers?new i("bound-anonymous-fn").runInAsyncScope((()=>{let r;y.publish();try{return r=e.apply(this,arguments),x(r)?(t&&c.set(r,t.body||t),r):r}catch(e){throw e.stack,v.publish(e),e}finally{b.publish({source:t,document:r,docSource:c.get(r)})}})):e.apply(this,arguments)}}function I(e){return function(t,r,s,n){return E.hasSubscribers?new i("bound-anonymous-fn").runInAsyncScope((()=>{let t;E.publish({docSource:c.get(r),document:r});try{return t=e.apply(this,arguments),t&&t[0]&&T.publish(t&&t[0]),t}catch(e){throw e.stack,T.publish(e),e}finally{S.publish({document:r,errors:t})}})):e.apply(this,arguments)}}function k(e){return function(t){const r=e.defaultFieldResolver;return function(){if(!p.hasSubscribers)return t.apply(this,arguments);const e=new i("bound-anonymous-fn");return e.runInAsyncScope((()=>{const s=function(e,t){return 1!==e.length?function(e,t){return e[3]=e[3]||{},e[6]=O(e[6]||t),e.length=Math.max(e.length,7),{schema:e[0],document:e[1],rootValue:e[2],contextValue:e[3],variableValues:e[4],operationName:e[5],fieldResolver:e[6]}}(e,t):(e[0].contextValue=e[0].contextValue||{},e[0].fieldResolver=O(e[0].fieldResolver||t),e[0])}(arguments,r),n=s.schema,i=s.document,o=c.get(i),u=s.contextValue,l=x(i,s.operationName);if(a.has(u))return t.apply(this,arguments);n&&(N(n._queryType),N(n._mutationType)),p.publish({operation:l,args:s,docSource:c.get(i)});const f={source:o,asyncResource:e,fields:{},abortController:new AbortController};return a.set(u,f),R(t,e,this,arguments,f.abortController,((e,t)=>{g.hasSubscribers&&function({fields:e}){Object.keys(e).reverse().forEach((t=>{const r=e[t];r.asyncResource.runInAsyncScope((()=>{r.error&&_.publish(r.error),g.publish(r.finishTime)}))}))}(f);const r=e||t&&t.errors&&t.errors[0];r&&h.publish(r),d.publish({res:t,args:s,context:f})}))}))}}}function O(e){if("function"!=typeof e||u.has(e))return e;function t(t,r,s,n){if(!f.hasSubscribers)return e.apply(this,arguments);const o=a.get(s);if(!o)return e.apply(this,arguments);const c=function(e,t,r){const s=function(e){const t=[];let r=e;for(;r;)t.push(r.key),r=r.prev;return t.reverse()}(t&&t.path),n=s.join("."),o=e.fields;let a=o[n];if(!a){const c=function(e,t){for(let r=t.length-1;r>0;r--){const s=C(e,t.slice(0,r));if(s)return s}return{asyncResource:e.asyncResource}}(e,s);c.asyncResource.runInAsyncScope((()=>{const s=new i("bound-anonymous-fn");s.runInAsyncScope((()=>{f.publish({info:t,context:e,args:r})})),a=o[n]={parent:c,asyncResource:s,error:null}}))}return a}(o,n,r);return R(e,c.asyncResource,this,arguments,o.abortController,(e=>{m.publish({field:c,info:n,err:e})}))}return u.add(t),t}function R(e,t,r,s,n,i){return i=i||(()=>{}),t.runInAsyncScope((()=>{if(n?.signal.aborted)throw i(null,null),new w("Aborted");try{const n=e.apply(r,s);return n&&"function"==typeof n.then?n.then(t.bind((e=>i(null,e))),t.bind((e=>i(e)))):i(null,n),n}catch(e){throw i(e),e}}))}function C(e,t){return e.fields[t.join(".")]}function N(e){e&&e._fields&&!l.has(e)&&(l.add(e),Object.keys(e._fields).forEach((t=>{const r=e._fields[t];!function(e){e&&e.resolve&&(e.resolve=O(e.resolve))}(r),function(e){if(!e||!e.type)return;let t=e.type;for(;t.ofType;)t=t.ofType;N(t)}(r)})))}s({name:"@graphql-tools/executor",file:"cjs/execution/execute.js",versions:[">=0.0.14"]},(e=>(o.wrap(e,"execute",k(e)),e))),s({name:"graphql",file:"execution/execute.js",versions:[">=0.10"]},(e=>(o.wrap(e,"execute",k(e)),e))),s({name:"graphql",file:"language/parser.js",versions:[">=0.10"]},(e=>(o.wrap(e,"parse",A),e))),s({name:"graphql",file:"validation/validate.js",versions:[">=0.10"]},(e=>(o.wrap(e,"validate",I),e)))},14143:(e,t,r)=>{"use strict";r(84238),r(76789)},84238:(e,t,r)=>{"use strict";const s=r(68317),{addHook:n,channel:i}=r(95092),o=r(81444),a=parseInt(process.versions.node.split(".")[0]),c=new WeakSet,u=new WeakMap,l=i("apm:grpc:client:request:start"),p=i("apm:grpc:client:request:asyncStart"),d=i("apm:grpc:client:request:error"),h=i("apm:grpc:client:request:finish"),f=i("apm:grpc:client:request:emit");function g(e,t=!1){return function(r){return function(s){const n=T(this,arguments,4);return S(this,r,n,s,n[4],e,t)}}}function m(e=!1){return function(t){return function(r){const s=t.apply(this,arguments);return s?(y(s,e),s):s}}}function _(e=!1){return function(t){return function(r){const s=t.apply(this,arguments);return b(s,r,e),s}}}function y(e,t=!1){for(const r in e)e[r].format||(e[r].service&&e[r].prototype?b(e[r],e[r].service,t):y(e[r],t))}function b(e,t,r=!1){const n=e.prototype;"object"!=typeof t||"format"in t||Object.keys(t).forEach((e=>{if(!t[e])return;const i=t[e].originalName,o=t[e].path,a=(c=t[e]).requestStream?c.responseStream?s.bidi:s.client_stream:c.responseStream?s.server_stream:s.unary;var c;t[e]&&(n[e]=v(n[e],o,a,r)),i&&(n[i]=v(n[i],o,a,r))}))}function v(e,t,r,s){if("function"!=typeof e||c.has(e))return e;const n=o.wrapFunction(e,(e=>function(){const n=T(this,arguments,1);return S(this,e,n,t,n[1],r,s)}));return c.add(n),n}function E(e,t=()=>{}){return o.wrapFunction(t,(t=>function(r){return r&&(e.error=r,d.publish(e)),p.runStores(e,(()=>t.apply(this,arguments)))}))}function S(e,t,r,n,i,a,c=!1){if(!l.hasSubscribers)return t.apply(e,r);const u=r.length,p=r[u-1],g={metadata:i,path:n,type:a};return l.runStores(g,(()=>{try{a!==s.unary&&a!==s.client_stream||("function"==typeof p?r[u-1]=E(g,p):r[u]=E(g));const n=t.apply(e,r);return n&&"function"==typeof n.emit&&o.wrap(n,"emit",function(e,t=!1){const r=t?function(e,t,r){e.result=t,e.peer=r.getPeer(),h.publish(e)}:function(e,t,r){e.result=t,h.publish(e)};return function(t){return function(s,n){switch(s){case"error":e.error=n,d.publish(e);break;case"status":r(e,n,this)}return f.runStores(e,(()=>t.apply(this,arguments)))}}}(g,c)),n}catch(e){g.error=e,d.publish(g)}}))}function T(e,t,r){const s=function(e){let t=e;do{const e=u.get(t);if(e)return e}while(t=Object.getPrototypeOf(t))}(e);if(!e||!s)return t;const n=t[r],i=[];for(let e=0;e<r;e++)i.push(t[e]);n&&n.constructor&&"Metadata"===n.constructor.name||i.push(new s.Metadata),n&&i.push(n);for(let e=r+1;e<t.length;e++)i.push(t[e]);return i}function w(e=!1){return function(t){const r=t.Client.prototype;return u.set(r,t),o.wrap(r,"makeBidiStreamRequest",g(s.bidi,e)),o.wrap(r,"makeClientStreamRequest",g(s.clientStream,e)),o.wrap(r,"makeServerStreamRequest",g(s.serverStream,e)),o.wrap(r,"makeUnaryRequest",g(s.unary,e)),t}}a<=14&&(n({name:"grpc",versions:[">=1.24.3"]},w(!0)),n({name:"grpc",versions:[">=1.24.3"],file:"src/client.js"},(e=>(o.wrap(e,"makeClientConstructor",_(!0)),e)))),n({name:"@grpc/grpc-js",versions:[">=1.0.3 <1.1.4"]},w(!1)),n({name:"@grpc/grpc-js",versions:[">=1.0.3 <1.1.4"],file:"build/src/make-client.js"},(e=>(o.wrap(e,"makeClientConstructor",_(!1)),o.wrap(e,"loadPackageDefinition",m(!1)),e))),n({name:"@grpc/grpc-js",versions:[">=1.1.4"]},w(!0)),n({name:"@grpc/grpc-js",versions:[">=1.1.4"],file:"build/src/make-client.js"},(e=>(o.wrap(e,"makeClientConstructor",_(!0)),o.wrap(e,"loadPackageDefinition",m(!0)),e)))},76789:(e,t,r)=>{"use strict";const s=r(68317),{channel:n,addHook:i}=r(95092),o=r(81444),a=parseInt(process.versions.node.split(".")[0]),c=n("apm:grpc:server:request:start"),u=n("apm:grpc:server:request:asyncStart"),l=n("apm:grpc:server:request:error"),p=n("apm:grpc:server:request:update"),d=n("apm:grpc:server:request:finish"),h=n("apm:grpc:server:request:emit");function f(e){return function(t,r,n,i,a){return"function"==typeof r&&(arguments[1]=function(e,t){return function(r,n){if(i=this,a=arguments,!(c.hasSubscribers&&i&&i.type&&a[0]&&("unary"===i.type||"function"==typeof(f=a[0]).emit&&"function"==typeof f.once))||"unary"===i.type&&"function"!=typeof a[1])return e.apply(this,arguments);var i,a,f;const g=r.metadata,m=s[this.type],_="unary"!==m,y={name:t,metadata:g,type:m};return c.runStores(y,(()=>{try{const t=()=>{y.code=1,d.publish(y)};return r.once("cancelled",t),_?function(e,t,r){e.call&&e.call.sendStatus&&(e.call.sendStatus=function(e,t){return function(r){return t.status=r,p.publish(t),e.apply(this,arguments)}}(e.call.sendStatus,t)),o.wrap(e,"emit",function(e,t,r){return function(s){return function(n,i){switch(n){case"error":t.error=i,l.publish(t),t.code=i.code,d.publish(t),e.removeListener("cancelled",r);break;case"prefinish":e.status&&p.publish(e.status),e.status&&0!==e.status.code||d.publish(t),e.removeListener("cancelled",r)}return s.apply(this,arguments)}}}(e,t,r))}(r,y,t):arguments[1]=function(e=()=>{},t,r,s){return o.wrapFunction(e,(e=>function(n,i,o,a){return n?(r.error=n,l.publish(r)):(r.code=0,r.trailer=o),d.publish(r),t.removeListener("cancelled",s),u.runStores(r,(()=>e.apply(this,arguments)))}))}(n,r,y,t),o.wrap(r,"emit",(e=>function(){return h.runStores(y,(()=>e.apply(this,arguments)))})),e.apply(this,arguments)}catch(e){y.error=e,l.publish(y)}}))}}(r,t)),e.apply(this,arguments)}}a<=14&&i({name:"grpc",versions:[">=1.24.3"],file:"src/server.js"},(e=>(o.wrap(e.Server.prototype,"register",f),e))),i({name:"@grpc/grpc-js",versions:[">=1.0.3"],file:"build/src/server.js"},(e=>(o.wrap(e.Server.prototype,"register",f),e)))},68317:e=>{"use strict";e.exports={unary:"unary",bidi:"bidi_streaming",client_stream:"client_streaming",clientStream:"client_streaming",server_stream:"server_streaming",serverStream:"server_streaming"}},31455:(e,t,r)=>{"use strict";const s=r(81444),{channel:n,addHook:i}=r(95092),o=n("datadog:handlebars:compile:start"),a=n("datadog:handlebars:register-partial:start");function c(e){return function(t){return o.hasSubscribers&&o.publish({source:t}),e.apply(this,arguments)}}function u(e){return function(t,r){return a.hasSubscribers&&a.publish({partial:r}),e.apply(this,arguments)}}i({name:"handlebars",file:"dist/cjs/handlebars/compiler/compiler.js",versions:[">=4.0.0"]},(e=>(s.wrap(e,"compile",c),s.wrap(e,"precompile",c),e))),i({name:"handlebars",file:"dist/cjs/handlebars/base.js",versions:[">=4.0.0"]},(e=>(s.wrap(e.HandlebarsEnvironment.prototype,"registerPartial",u),e)))},27387:(e,t,r)=>{"use strict";const s=r(1247).tracingChannel,n=r(81444),{addHook:i,channel:o}=r(95092),a=o("apm:hapi:request:handle"),c=o("apm:hapi:request:route"),u=o("apm:hapi:request:error"),l=s("apm:hapi:extension");function p(e){return function(t){const r=e.apply(this,arguments);return r?("function"==typeof r.ext&&(r.ext=h(r.ext)),"function"==typeof r.start&&(r.start=d(r.start)),r):r}}function d(e){return n.wrapFunction(e,(e=>function(){return this&&"function"==typeof this.ext&&this.ext("onPreResponse",y),e.apply(this,arguments)}))}function h(e){return n.wrapFunction(e,(e=>function(t,r,s){return null!==t&&"object"==typeof t?arguments[0]=function(e){return[].concat(e).map((e=>e&&e.method?Object.assign({},e,{method:m(e.method)}):e))}(t):arguments[1]=m(r),e.apply(this,arguments)}))}function f(e){return function(t){const r=e.apply(this,arguments);return"function"!=typeof r?r:function(e,t){return a.publish({req:e,res:t}),r.apply(this,arguments)}}}function g(e){return function(t){const r=e.apply(this,arguments);return this&&Array.isArray(this._cycle)&&(this._cycle=this._cycle.map(_)),r}}function m(e){return[].concat(e).map(_)}function _(e){return"function"!=typeof e?e:n.wrapFunction(e,(e=>function(t,r){return t&&t.raw&&t.raw.req?l.traceSync((()=>e.apply(this,arguments))):e.apply(this,arguments)}))}function y(e,t){if(!e||!e.raw)return b(0,t);const r=e.raw.req;return e.response instanceof Error&&u.publish(e.response),e.route&&c.publish({req:r,route:e.route.path}),b(0,t)}function b(e,t){return t.continue?"function"==typeof t.continue?t.continue():t.continue:"function"==typeof t?t():void 0}i({name:"@hapi/hapi",versions:[">=17.9"]},(e=>(n.massWrap(e,["server","Server"],p),e))),i({name:"@hapi/hapi",versions:[">=17.9"],file:"lib/core.js"},(e=>(n.wrap(e.prototype,"_dispatch",f),e))),i({name:"@hapi/hapi",versions:[">=17.9"],file:"lib/route.js"},(e=>(n.wrap(e.prototype,"rebuild",g),e))),i({name:"hapi",versions:[">=17"]},(e=>(n.massWrap(e,["server","Server"],p),e))),i({name:"hapi",versions:["16"]},(e=>(n.wrap(e.Server.prototype,"start",d),n.wrap(e.Server.prototype,"ext",h),e))),i({name:"hapi",versions:["16"],file:"lib/connection.js"},(e=>(n.wrap(e.prototype,"_dispatch",f),e))),i({name:"hapi",versions:[">=17"],file:"lib/core.js"},(e=>(n.wrap(e.prototype,"_dispatch",f),e))),i({name:"hapi",versions:[">=16"],file:"lib/route.js"},(e=>(n.wrap(e.prototype,"rebuild",g),e)))},92153:(e,t,r)=>{"use strict";const s=r(1247),{filename:n,loadChannel:i,matchVersion:o}=r(948),a=r(17969),c=r(10502),u=r(75004);s.subscribe||(s.subscribe=(e,t)=>{s.channel(e).subscribe(t)}),s.unsubscribe||(s.unsubscribe=(e,t)=>{s.channel(e).hasSubscribers&&s.channel(e).unsubscribe(t)}),s.subscribe("dd-trace:bundler:load",(e=>{try{a[e.package]()}catch(t){throw u.error("esbuild-wrapped %s missing in list of hooks",e.package),t}if(c[e.package]){for(const{name:t,file:r,versions:s,hook:a}of c[e.package])if(e.path===n(t,r)&&o(e.version,s))try{i.publish({name:t,version:e.version,file:r}),e.module=a(e.module,e.version)}catch(e){u.error("Error executing bundler hook",e)}}else u.error("esbuild-wrapped %s missing in list of instrumentations",e.package)}))},69189:(e,t)=>{"use strict";t.createWrapFetch=function(e,t){return function(r){return"function"!=typeof r?r:function(s,n){if(!t.start.hasSubscribers)return r.apply(this,arguments);if(s instanceof e){const e={req:s};return t.tracePromise((()=>r.call(this,s,n)),e)}{const i=new e(s,n),o={req:i};return t.tracePromise((()=>r.call(this,i)),o)}}}}},21042:(e,t,r)=>{"use strict";const s=r(16928),n=r(23212),i=r(39995);function o(e,t,r){if(!(this instanceof o))return new o(e,t,r);"function"==typeof t&&(r=t,t={}),this._patched=Object.create(null);const a=(e,t,n,i)=>{const o=[n,t].filter((e=>e)),a=s.join(...o);return this._patched[a]?e:(this._patched[a]=!0,r(e,t,n,i))};this._ritmHook=i(e,{},a),this._iitmHook=n(e,t,((e,t,r)=>e&&e.default?(e.default=a(e.default,t,r),e):a(e,t,r)))}o.prototype.unhook=function(){this._ritmHook.unhook(),this._iitmHook.unhook(),this._patched=Object.create(null)},e.exports=o},17969:(e,t,r)=>{"use strict";e.exports={"@apollo/server":()=>r(72342),"@apollo/gateway":()=>r(37352),"apollo-server-core":()=>r(92612),"@aws-sdk/smithy-client":()=>r(63599),"@azure/functions":()=>r(16764),"@cucumber/cucumber":()=>r(62543),"@playwright/test":()=>r(99668),"@elastic/elasticsearch":()=>r(57604),"@elastic/transport":()=>r(57604),"@google-cloud/pubsub":()=>r(88422),"@graphql-tools/executor":()=>r(20902),"@grpc/grpc-js":()=>r(14143),"@hapi/hapi":()=>r(27387),"@jest/core":()=>r(54437),"@jest/reporters":()=>r(54437),"@jest/test-sequencer":()=>r(54437),"@jest/transform":()=>r(54437),"@koa/router":()=>r(62126),"@langchain/core":()=>r(95322),"@langchain/openai":()=>r(95322),"@node-redis/client":()=>r(6692),"@opensearch-project/opensearch":()=>r(20879),"@opentelemetry/sdk-trace-node":()=>r(1128),"@redis/client":()=>r(6692),"@smithy/smithy-client":()=>r(63599),"@vitest/runner":{esmFirst:!0,fn:()=>r(48502)},aerospike:()=>r(68434),amqp10:()=>r(60249),amqplib:()=>r(78481),avsc:()=>r(62954),"aws-sdk":()=>r(63599),bluebird:()=>r(74464),"body-parser":()=>r(95175),bunyan:()=>r(43772),"cassandra-driver":()=>r(7256),child_process:()=>r(92787),connect:()=>r(66757),cookie:()=>r(23682),"cookie-parser":()=>r(53325),couchbase:()=>r(12940),crypto:()=>r(61486),cypress:()=>r(8600),dns:()=>r(74736),elasticsearch:()=>r(57604),express:()=>r(33951),"express-mongo-sanitize":()=>r(32444),fastify:()=>r(31875),"find-my-way":()=>r(39153),fs:()=>r(92108),"generic-pool":()=>r(49389),graphql:()=>r(20902),grpc:()=>r(14143),handlebars:()=>r(31455),hapi:()=>r(27387),http:()=>r(61507),http2:()=>r(53221),https:()=>r(61507),ioredis:()=>r(38736),"jest-circus":()=>r(54437),"jest-config":()=>r(54437),"jest-environment-node":()=>r(54437),"jest-environment-jsdom":()=>r(54437),"jest-runtime":()=>r(54437),"jest-worker":()=>r(54437),knex:()=>r(44643),koa:()=>r(62126),"koa-router":()=>r(62126),kafkajs:()=>r(52450),langchain:()=>r(95322),ldapjs:()=>r(14365),"limitd-client":()=>r(11304),lodash:()=>r(18294),mariadb:()=>r(13359),memcached:()=>r(37776),"microgateway-core":()=>r(47269),mocha:()=>r(84605),"mocha-each":()=>r(84605),moleculer:()=>r(84081),mongodb:()=>r(88033),"mongodb-core":()=>r(4525),mongoose:()=>r(7314),mquery:()=>r(55266),multer:()=>r(96742),mysql:()=>r(86309),mysql2:()=>r(26375),net:()=>r(61732),next:()=>r(19470),"node-serialize":()=>r(40016),"node:child_process":()=>r(92787),"node:crypto":()=>r(61486),"node:dns":()=>r(74736),"node:http":()=>r(61507),"node:http2":()=>r(53221),"node:https":()=>r(61507),"node:net":()=>r(61732),"node:url":()=>r(56878),"node:vm":()=>r(89714),nyc:()=>r(87133),oracledb:()=>r(40123),openai:()=>r(42917),paperplane:()=>r(37615),passport:()=>r(60193),"passport-http":()=>r(84746),"passport-local":()=>r(45611),pg:()=>r(57562),pino:()=>r(46755),"pino-pretty":()=>r(46755),playwright:()=>r(99668),"promise-js":()=>r(87196),promise:()=>r(88038),protobufjs:()=>r(71335),pug:()=>r(81419),q:()=>r(20012),redis:()=>r(6692),restify:()=>r(11907),rhea:()=>r(87455),router:()=>r(86658),"selenium-webdriver":()=>r(48055),sequelize:()=>r(82864),sharedb:()=>r(51826),tedious:()=>r(810),undici:()=>r(36303),url:()=>r(56878),vitest:{esmFirst:!0,fn:()=>r(48502)},vm:()=>r(89714),when:()=>r(11243),winston:()=>r(56143),workerpool:()=>r(84605)}},95092:(e,t,r)=>{"use strict";const s=r(1247),n=r(99589),i=r(10502),{AsyncResource:o}=r(90290),a={};t.channel=function(e){const t=a[e];if(t)return t;const r=s.channel(e);return a[e]=r,r},t.addHook=function({name:e,versions:t,file:r,filePattern:s},n){"string"==typeof e&&(e=[e]);for(const o of e)i[o]||(i[o]=[]),i[o].push({name:o,versions:t,file:r,filePattern:s,hook:n})},n.satisfies(process.versions.node,">=17.8.0")?t.AsyncResource=o:t.AsyncResource=class extends o{static bind(e,r,s){return r=r||e.name,new t.AsyncResource(r||"bound-anonymous-fn").bind(e,s)}bind(e,t){let r;if(void 0===t){const t=this;r=function(...r){return r.unshift(e,this),Reflect.apply(t.runInAsyncScope,t,r)}}else r=this.runInAsyncScope.bind(this,e,t);return Object.defineProperties(r,{length:{configurable:!0,enumerable:!1,value:e.length,writable:!1},asyncResource:{configurable:!0,enumerable:!0,value:this,writable:!0}}),r}}},10502:e=>{"use strict";const t=Symbol.for("_ddtrace_instrumentations");global[t]=global[t]||{},e.exports=global[t]},30060:(e,t,r)=>{"use strict";const{AsyncResource:s}=r(90290);function n(e,t){return"function"!=typeof t?t:function(){return e.runInAsyncScope((()=>t.apply(this,arguments)))}}t.wrapThen=function(e){return function(t,r,i){const o=new s("bound-anonymous-fn");return arguments[0]=n(o,t),arguments[1]=n(o,r),i&&(arguments[2]=n(o,i)),e.apply(this,arguments)}}},948:(e,t,r)=>{"use strict";e=r.nmd(e);const{channel:s}=r(1247),n=r(16928),i=r(99589),o=r(21042),a=r(98114),c=r(75004),u=r(51006),l=r(32427),{DD_TRACE_DISABLED_INSTRUMENTATIONS:p="",DD_TRACE_DEBUG:d=""}=process.env,h=r(17969),f=r(10502),g=Object.keys(h),m=new RegExp(`\\${n.sep}`,"g"),_=new Set(p?p.split(","):[]);for(const[e,t]of Object.entries(process.env)){const r=e.match(/^DD_TRACE_(.+)_ENABLED$/);if(r&&("false"===t.toLowerCase()||"0"===t)){const e=r[1].toLowerCase();_.add(e)}}const y=s("dd-trace:instrumentation:load");_.has("fetch")||r(55931),_.has("process")||r(44962);const b=Symbol("hookExportsMap");d&&"false"!==d.toLowerCase()&&(u.checkForRequiredModules(),setImmediate(u.checkForPotentialConflicts));const v=new Set;for(const e of g){if(_.has(e))continue;const t={};let r=h[e];"object"==typeof r&&(t.internals=r.esmFirst,r=r.fn),o([e],t,((t,s,n,i)=>{if(s=s.replace(m,"/"),r(),!f[e])return t;const o={};for(const{name:r,file:a,versions:u,hook:p,filePattern:d}of f[e]){let e=d;const h=T(r,a);e&&(e=T(r,e)),p[b]||(p[b]=new WeakMap);let f=!1;if(f=s===h,e&&(f=f||new RegExp(e).test(s)),f){let e=i;try{e=e||S(n)}catch(e){c.error('Error getting version for "%s": %s',r,e.message,e);continue}if(void 0===o[`${r}@${e}`]&&(o[`${r}@${e}`]=!1),E(e,u)){if(p[b].has(t))return o[`${r}@${e}`]=!0,t;try{y.publish({name:r,version:e,file:a}),t=p(t,e,r),p[b].set(t,r)}catch(t){c.info("Error during ddtrace instrumentation of application, aborting."),c.info(t),l("error",[`error_type:${t.constructor.name}`,`integration:${r}`,`integration_version:${e}`])}o[`${r}@${e}`]=!0}}}for(const e of Object.keys(o)){const[t,r]=e.split("@");o[e]||v.has(e)||(l("abort.integration",[`integration:${t}`,`integration_version:${r}`]),c.info("Found incompatible integration version: %s",e),v.add(e))}return t}))}function E(e,t){return!e||t&&t.some((t=>i.satisfies(i.coerce(e),t)))}function S(t){if(t)return a(t,e).version}function T(e,t){return[e,t].filter((e=>e)).join("/")}e.exports={filename:T,pathSepExpr:m,loadChannel:y,matchVersion:E}},61507:(e,t,r)=>{"use strict";r(32341),r(10049)},32341:(e,t,r)=>{"use strict";const s=r(87016),{channel:n,addHook:i}=r(95092),o=r(81444),a=r(75004),c=n("apm:http:client:request:start"),u=n("apm:http:client:request:finish"),l=n("apm:http:client:request:end"),p=n("apm:http:client:request:asyncStart"),d=n("apm:http:client:request:error");function h(e,t){function r(e,t,r){const i=e;e=function(e){if("string"!=typeof e)return e instanceof s.URL?n(e):e;try{return n(new s.URL(e))}catch(t){return s.parse(e)}}(e);const[o,a]=function(e,t,r){return"function"==typeof e?[e,r||{}]:[t,e]}(t,r,e),c=function(e,t){return null!==t&&"object"==typeof t?Object.assign(e||{},t):e}(e,a);return function(e){e.headers=e.headers||{}}(c),{uri:s.format(c),options:c,callback:o,originalUrl:i}}function n(t){const r=t.agent||e.globalAgent,s={protocol:t.protocol||r.protocol,hostname:"string"==typeof t.hostname&&t.hostname.startsWith("[")?t.hostname.slice(1,-1):t.hostname||t.host||"localhost",hash:t.hash,search:t.search,pathname:t.pathname,path:`${t.pathname||""}${t.search||""}`,href:t.href};return""!==t.port&&(s.port=Number(t.port)),(t.username||t.password)&&(s.auth=`${t.username}:${t.password}`),s}o.wrap(e,t,(function(t){return function(){if(!c.hasSubscribers)return t.apply(this,arguments);let s;try{s=r.apply(null,arguments)}catch(e){return a.error("Error normalising http req arguments",e),t.apply(this,arguments)}const n=new AbortController,i={args:s,http:e,abortController:n};return c.runStores(i,(()=>{let e=!1,r=s.callback;r&&(r=o.wrapFunction(s.callback,(e=>function(){return p.runStores(i,(()=>e.apply(this,arguments)))})));const a=s.options,c=()=>{e||(e=!0,u.publish(i))};try{const e=t.call(this,a,r),s=e.emit,o=e.setTimeout;i.req=e;let u=!1;return e.setTimeout=function(){return u=!0,o.apply(this,arguments)},e.emit=function(e,t){switch(e){case"response":{const e=t;i.res=e,e.on("end",c),e.on("error",c);break}case"connect":case"upgrade":i.res=t,c();break;case"error":case"timeout":i.error=t,i.customRequestTimeout=u,d.publish(i);case"abort":case"close":c()}return s.apply(this,arguments)},n.signal.aborted&&e.destroy(n.signal.reason||new Error("Aborted")),e}catch(e){throw i.error=e,d.publish(i),e}finally{l.publish(i)}}))}}))}i({name:["http","https","node:http","node:https"]},(function(e){return h(e,"request"),h(e,"get"),e}))},10049:(e,t,r)=>{"use strict";const{channel:s,addHook:n}=r(95092),i=r(81444),o=s("apm:http:server:request:start"),a=s("apm:http:server:request:exit"),c=s("apm:http:server:request:error"),u=s("apm:http:server:request:finish"),l=s("apm:http:server:response:writeHead:start"),p=s("datadog:http:server:response:set-header:finish"),d=s("datadog:http:server:response:set-header:start"),h=new WeakSet;function f(e){return function(t,r){return u.hasSubscribers?(["finish","close"].includes(t)&&!h.has(this)&&(u.publish({req:this.req}),h.add(this)),e.apply(this,arguments)):e.apply(this,arguments)}}function g(e){return function(t,r,s){if(!o.hasSubscribers)return e.apply(this,arguments);if("request"===t){s.req=r;const n=new AbortController;o.publish({req:r,res:s,abortController:n});try{return n.signal.aborted?this.listenerCount(t)>0:e.apply(this,arguments)}catch(e){throw c.publish(e),e}finally{a.publish({req:r})}}return e.apply(this,arguments)}}function m(e){return function(t,r,s){if(!l.hasSubscribers)return e.apply(this,arguments);const n=new AbortController;if("string"!=typeof r&&(s??=r),Array.isArray(s)){const e={};for(let t=0;t<s.length;t+=2)e[s[t]]=s[t+1];s=e}const i=Object.assign(this.getHeaders(),s);return l.publish({req:this.req,res:this,abortController:n,statusCode:t,responseHeaders:i}),n.signal.aborted?this:e.apply(this,arguments)}}function _(e){return function(){if(!l.hasSubscribers)return e.apply(this,arguments);const t=new AbortController,r=this.getHeaders();return l.publish({req:this.req,res:this,abortController:t,statusCode:this.statusCode,responseHeaders:r}),!!t.signal.aborted||e.apply(this,arguments)}}function y(e){return function(t,r){if(!d.hasSubscribers&&!p.hasSubscribers)return e.apply(this,arguments);if(d.hasSubscribers){const e=new AbortController;if(d.publish({res:this,abortController:e}),e.signal.aborted)return}const s=e.apply(this,arguments);return p.hasSubscribers&&p.publish({name:t,value:r,res:this}),s}}function b(e){return function(){if(!d.hasSubscribers)return e.apply(this,arguments);const t=new AbortController;return d.publish({res:this,abortController:t}),t.signal.aborted?this:e.apply(this,arguments)}}function v(e){return function(){if(!l.hasSubscribers)return e.apply(this,arguments);const t=new AbortController,r=this.getHeaders();return l.publish({req:this.req,res:this,abortController:t,statusCode:this.statusCode,responseHeaders:r}),t.signal.aborted?this:e.apply(this,arguments)}}n({name:["http","node:http"]},(e=>(i.wrap(e.ServerResponse.prototype,"emit",f),i.wrap(e.Server.prototype,"emit",g),i.wrap(e.ServerResponse.prototype,"writeHead",m),i.wrap(e.ServerResponse.prototype,"write",_),i.wrap(e.ServerResponse.prototype,"end",v),i.wrap(e.ServerResponse.prototype,"setHeader",y),i.wrap(e.ServerResponse.prototype,"removeHeader",b),e.ServerResponse.prototype.appendHeader&&i.wrap(e.ServerResponse.prototype,"appendHeader",b),e))),n({name:["https","node:https"]},(e=>(i.wrap(e.Server.prototype,"emit",g),e)))},53221:(e,t,r)=>{"use strict";r(75351),r(22411)},75351:(e,t,r)=>{"use strict";const s=r(81444),{addHook:n,channel:i}=r(95092),o=i("apm:http2:client:connect:start"),a=i("apm:http2:client:request:start"),c=i("apm:http2:client:request:end"),u=i("apm:http2:client:request:asyncStart"),l=i("apm:http2:client:request:asyncEnd"),p=i("apm:http2:client:request:error");function d(e){return function(t,r){o.hasSubscribers&&o.publish({authority:t});const n=e.apply(this,arguments);return s.wrap(n,"request",function(e,t){return function(r){return function(n){if(!a.hasSubscribers)return r.apply(this,arguments);const i={headers:n,authority:e,options:t};return a.runStores(i,(()=>{try{const e=r.apply(this,arguments);return s.wrap(e,"emit",function(e){return function(t){return function(r,s){return e.eventName=r,e.eventData=s,u.runStores(e,(()=>{try{return t.apply(this,arguments)}finally{l.publish(e)}}))}}}(i)),e}catch(e){throw i.error=e,p.publish(i),e}finally{c.publish(i)}}))}}}(t,r)),n}}n({name:["http2","node:http2"]},(e=>(s.wrap(e,"connect",d),e)))},22411:(e,t,r)=>{"use strict";const{channel:s,addHook:n,AsyncResource:i}=r(95092),o=r(81444),a=s("apm:http2:server:request:start"),c=s("apm:http2:server:request:error"),u=s("apm:http2:server:request:finish");function l(e){return function(...t){const r=e.apply(this,t);return o.wrap(r,"emit",d),r}}function p(e){const t=new i("bound-anonymous-fn");return function(r,s){return t.runInAsyncScope((()=>("close"===r&&u.hasSubscribers&&u.publish({req:this.req}),e.apply(this,arguments))))}}function d(e){return function(t,r,s){return a.hasSubscribers&&"request"===t?(s.req=r,new i("bound-anonymous-fn").runInAsyncScope((()=>{a.publish({req:r,res:s}),o.wrap(s,"emit",p);try{return e.apply(this,arguments)}catch(e){throw c.publish(e),e}}))):e.apply(this,arguments)}}n({name:["http2","node:http2"]},(e=>(o.wrap(e,"createSecureServer",l),o.wrap(e,"createServer",l),e)))},38736:(e,t,r)=>{"use strict";const{channel:s,addHook:n,AsyncResource:i}=r(95092),o=r(81444),a=s("apm:ioredis:command:start"),c=s("apm:ioredis:command:finish"),u=s("apm:ioredis:command:error");function l(e,t,r){r&&t.publish(r),e.publish()}n({name:"ioredis",versions:[">=2"]},(e=>(o.wrap(e.prototype,"sendCommand",(e=>function(t,r){if(!a.hasSubscribers)return e.apply(this,arguments);if(!t||!t.promise)return e.apply(this,arguments);const s=this.options||{},n=s.connectionName,o=s.db,p={host:s.host,port:s.port},d=new i("bound-anonymous-fn");return d.runInAsyncScope((()=>{a.publish({db:o,command:t.name,args:t.args,connectionOptions:p,connectionName:n});const r=d.bind((()=>l(c,u))),s=d.bind((e=>l(c,u,e)));t.promise.then(r,s);try{return e.apply(this,arguments)}catch(e){throw u.publish(e),e}}))})),e)))},54437:(e,t,r)=>{"use strict";const{addHook:s,channel:n,AsyncResource:i}=r(95092),o=r(81444),a=r(75004),{getCoveredFilenamesFromCoverage:c,JEST_WORKER_TRACE_PAYLOAD_CODE:u,JEST_WORKER_COVERAGE_PAYLOAD_CODE:l,getTestLineStart:p,getTestSuitePath:d,getTestParametersString:h,addEfdStringToTestName:f,removeEfdStringFromTestName:g,getIsFaultyEarlyFlakeDetection:m,JEST_WORKER_LOGS_PAYLOAD_CODE:_}=r(97507),{getFormattedJestTestParameters:y,getJestTestName:b,getJestSuitesToRun:v}=r(25500),E=n("ci:jest:session:start"),S=n("ci:jest:session:finish"),T=n("ci:jest:session:configuration"),w=n("ci:jest:test-suite:start"),x=n("ci:jest:test-suite:finish"),A=n("ci:jest:worker-report:trace"),I=n("ci:jest:worker-report:coverage"),k=n("ci:jest:worker-report:logs"),O=n("ci:jest:test-suite:code-coverage"),R=n("ci:jest:test:start"),C=n("ci:jest:test:skip"),N=n("ci:jest:test:finish"),P=n("ci:jest:test:err"),D=n("ci:jest:test-suite:skippable"),L=n("ci:jest:library-configuration"),M=n("ci:jest:known-tests"),q=n("ci:jest:itr:skipped-suites"),j=Symbol.for("RETRY_TIMES");let U=[],F={},B=!1,$=!1,G=!1,V=!1,z=0,H=!1,K=!1,Y=!1,Q=0,W=30,Z=!1,J=!1,X=!1;const ee=new i("bound-anonymous-fn"),te=new WeakMap,re=new WeakMap,se=new Map,ne=new Map;function ie(e){let t;if(Array.isArray(e)){const[r,s]=e;null!==r&&r.stack?t=r:(t=s,t.message=r)}else t=e;return t}function oe(e){return e.reduce(((e,t)=>(e[t]++,e)),{pass:0,fail:0})}function ae(e,t){return class extends e{constructor(e,t){super(e,t);const r=e.globalConfig?e.globalConfig.rootDir:e.rootDir;this.rootDir=r,this.testSuite=d(t.testPath,r),this.nameToParams={},this.global._ddtrace=global._ddtrace,this.hasSnapshotTests=void 0,this.displayName=e.projectConfig?.displayName?.name,this.testEnvironmentOptions=function(e){return e.projectConfig&&e.projectConfig.testEnvironmentOptions?e.projectConfig.testEnvironmentOptions:e.testEnvironmentOptions?e.testEnvironmentOptions:{}}(e);const s=this.testEnvironmentOptions._ddRepositoryRoot;if(s&&(this.testSourceFile=d(t.testPath,s),this.repositoryRoot=s),this.isEarlyFlakeDetectionEnabled=this.testEnvironmentOptions._ddIsEarlyFlakeDetectionEnabled,this.isFlakyTestRetriesEnabled=this.testEnvironmentOptions._ddIsFlakyTestRetriesEnabled,this.flakyTestRetriesCount=this.testEnvironmentOptions._ddFlakyTestRetriesCount,this.isDiEnabled=this.testEnvironmentOptions._ddIsDiEnabled,this.isKnownTestsEnabled=this.testEnvironmentOptions._ddIsKnownTestsEnabled,this.isKnownTestsEnabled)try{const e=!!F.jest;Q=this.testEnvironmentOptions._ddEarlyFlakeDetectionNumRetries,this.knownTestsForThisSuite=e?F.jest[this.testSuite]||[]:this.getKnownTestsForSuite(this.testEnvironmentOptions._ddKnownTests)}catch(e){this.isEarlyFlakeDetectionEnabled=!1,this.isKnownTestsEnabled=!1}this.isFlakyTestRetriesEnabled&&(this.global[j]||(this.global[j]=this.flakyTestRetriesCount))}getHasSnapshotTests(){if(void 0!==this.hasSnapshotTests)return this.hasSnapshotTests;let e=!0;try{const{_snapshotData:t}=this.getVmContext().expect.getState().snapshotState;e=Object.keys(t).length>0}catch(e){}return this.hasSnapshotTests=e,e}getKnownTestsForSuite(e){if(this.knownTestsForThisSuite)return this.knownTestsForThisSuite;let t=e;return"string"==typeof t&&(t=JSON.parse(t)),t}getTestNameFromAddTestEvent(e,t){const r=b(t.currentDescribeBlock),s=r?`${r} ${e.testName}`:e.testName;return g(s)}async handleTestEvent(e,r){super.handleTestEvent&&await super.handleTestEvent(e,r);const s=(e,t)=>{this.nameToParams[e]=[...t]};if("setup"===e.name&&this.global.test&&o.wrap(this.global.test,"each",(e=>function(){const t=y(arguments),r=e.apply(this,arguments);return function(){const[e]=arguments;return s(e,t),r.apply(this,arguments)}})),"test_start"===e.name){let r=!1,s=null;const n=h(this.nameToParams,e.test.name),o=new i("bound-anonymous-fn");te.set(e.test,o);const a=b(e.test);if(this.isKnownTestsEnabled){const e=g(a);r=se.has(e),r&&(s=se.get(e),se.set(e,s+1))}const c=e.test?.invocations>1;o.runInAsyncScope((()=>{R.publish({name:g(a),suite:this.testSuite,testSourceFile:this.testSourceFile,displayName:this.displayName,testParameters:n,frameworkVersion:t,isNew:r,isEfdRetry:s>0,isJestRetry:c}),re.set(e.test,e.test.fn),e.test.fn=o.bind(e.test.fn)}))}if("add_test"===e.name&&this.isKnownTestsEnabled){const t=this.getTestNameFromAddTestEvent(e,r),s=!this.knownTestsForThisSuite?.includes(t),n="todo"===e.mode||"skip"===e.mode;if(s&&!n&&!se.has(t)&&(se.set(t,0),this.isEarlyFlakeDetectionEnabled)){if(this.getHasSnapshotTests())return void a.warn("Early flake detection is disabled for suites with snapshots");for(let t=0;t<Q;t++)this.global.test?this.global.test(f(e.testName,t),e.fn,e.timeout):a.error("Early flake detection could not retry test because global.test is undefined")}}if("test_done"===e.name){let t="pass";if(e.test.errors&&e.test.errors.length&&(t="fail"),e.test.fn=re.get(e.test),this.isKnownTestsEnabled){const r=b(e.test),s=g(r);se.has(s)&&(ne.has(s)?ne.get(s).push(t):ne.set(s,[t]))}const r={},s=this.global[j],n=e.test?.invocations,i=s>0&&n-1<s,o=this.isDiEnabled&&n>=2,a=te.get(e.test);if("fail"===t){const t=this.isDiEnabled&&i&&1===n;a.runInAsyncScope((()=>{P.publish({error:ie(e.test.errors[0]),shouldSetProbe:t,promises:r})}))}"fail"===t&&o&&await new Promise((e=>{setTimeout((()=>{e()}),200)})),a.runInAsyncScope((()=>{N.publish({status:t,testStartLine:p(e.test.asyncError,this.testSuite),promises:r})})),r.isProbeReady&&await r.isProbeReady}"test_skip"!==e.name&&"test_todo"!==e.name||new i("bound-anonymous-fn").runInAsyncScope((()=>{C.publish({name:b(e.test),suite:this.testSuite,testSourceFile:this.testSourceFile,displayName:this.displayName,frameworkVersion:t,testStartLine:p(e.test.asyncError,this.testSuite)})}))}}}function ce(e,t){if(e.default){const r=ae(e.default,t);return e.default=r,e.TestEnvironment=r,e}return ae(e,t)}function ue(e,t,r){const s=v(U,e,t||process.cwd());return J=!0,a.debug((()=>`${s.suitesToRun.length} out of ${e.length} suites are going to run.`)),H=s.hasUnskippableSuites,K=s.hasForcedToRunSuites,V=s.suitesToRun.length!==e.length,z=s.skippedSuites.length,q.publish({skippedSuites:s.skippedSuites,frameworkVersion:r}),s.suitesToRun}function le(e,t){return async function(r){if(!$||J)return e.apply(this,arguments);const[s]=r,n=s?.context?.config?.rootDir;return arguments[0]=ue(r,n,t),e.apply(this,arguments)}}function pe(e){const t=e.default?e.default:e;return o.wrap(t.prototype,"_addUntestedFiles",(e=>async function(){return $&&!G?Promise.resolve():e.apply(this,arguments)})),e}function de(e){const{configs:t}=e;if(ee.runInAsyncScope((()=>{T.publish(t.map((e=>e.testEnvironmentOptions)))})),t.forEach((e=>{e.testEnvironmentOptions._ddTestCodeCoverageEnabled=B})),G=!!e.globalConfig.collectCoverage,e.globalConfig.forceExit&&a.warn("Jest's '--forceExit' flag has been passed. This may cause loss of data."),B){const t={...e.globalConfig,collectCoverage:!0};e.globalConfig=t}if($){const t={...e.globalConfig,coverageReporters:["none"],passWithNoTests:!0};e.globalConfig=t}return e}s({name:"jest-environment-node",versions:[">=24.8.0"]},ce),s({name:"jest-environment-jsdom",versions:[">=24.8.0"]},ce),s({name:"@jest/core",file:"build/TestScheduler.js",versions:[">=27.0.0"]},((e,t)=>{const r=e.createTestScheduler;return e.createTestScheduler=async function(){if(!$||J)return r.apply(this,arguments);const e=await r.apply(this,arguments);return o.wrap(e,"scheduleTests",(e=>le(e,t))),e},e})),s({name:"@jest/core",file:"build/TestScheduler.js",versions:[">=24.8.0 <27.0.0"]},((e,t)=>(o.wrap(e.default.prototype,"scheduleTests",(e=>le(e,t))),e))),s({name:"@jest/test-sequencer",versions:[">=28"]},((e,t)=>(o.wrap(e.default.prototype,"shard",(e=>function(){const r=e.apply(this,arguments);if(!r.length||!$||!U.length)return r;const[s]=r,n=s?.context?.config?.rootDir;return ue(r,n,t)})),e))),s({name:"@jest/reporters",file:"build/coverage_reporter.js",versions:[">=24.8.0 <26.6.2"]},pe),s({name:"@jest/reporters",file:"build/CoverageReporter.js",versions:[">=26.6.2"]},pe),s({name:"@jest/core",file:"build/cli/index.js",versions:[">=24.8.0"]},(function(e,t){const r=o.wrap(e,"runCLI",(e=>async function(){let r;const s=new Promise((e=>{r=e}));if(!L.hasSubscribers)return e.apply(this,arguments);ee.runInAsyncScope((()=>{L.publish({onDone:r})}));try{const{err:e,libraryConfig:t}=await s;e||(B=t.isCodeCoverageEnabled,$=t.isSuitesSkippingEnabled,Y=t.isEarlyFlakeDetectionEnabled,Q=t.earlyFlakeDetectionNumRetries,W=t.earlyFlakeDetectionFaultyThreshold,X=t.isKnownTestsEnabled)}catch(e){a.error("Jest library configuration error",e)}if(X){const e=new Promise((e=>{r=e}));ee.runInAsyncScope((()=>{M.publish({onDone:r})}));try{const{err:t,knownTests:r}=await e;t?(Y=!1,X=!1):F=r}catch(e){a.error("Jest known tests error",e)}}if($){const e=new Promise((e=>{r=e}));ee.runInAsyncScope((()=>{D.publish({onDone:r})}));try{const{err:t,skippableSuites:r}=await e;t||(U=r)}catch(e){a.error("Jest test-suite skippable error",e)}}const n=process.argv.slice(2).join(" ");ee.runInAsyncScope((()=>{E.publish({command:`jest ${n}`,frameworkVersion:t})}));const i=await e.apply(this,arguments),{results:{success:o,coverageMap:c,numFailedTestSuites:u,numFailedTests:l,numTotalTests:p,numTotalTestSuites:d}}=i;let h,f,g,m;if(G)try{const{pct:e,total:t}=c.getCoverageSummary().lines;h=0!==t?e:0}catch(e){}o?f=0===p&&0===d?"skip":"pass":(f="fail",g=new Error(`Failed test suites: ${u}. Failed tests: ${l}`));const _=new Promise((e=>{r=()=>{clearTimeout(m),e()}})),y=new Promise((e=>{m=setTimeout((()=>{e("timeout")}),1e4).unref()}));if(ee.runInAsyncScope((()=>{S.publish({status:f,isSuitesSkipped:V,isSuitesSkippingEnabled:$,isCodeCoverageEnabled:B,testCodeCoverageLinesTotal:h,numSkippedSuites:z,hasUnskippableSuites:H,hasForcedToRunSuites:K,error:g,isEarlyFlakeDetectionEnabled:Y,isEarlyFlakeDetectionFaulty:Z,onDone:r})})),"timeout"===await Promise.race([_,y])&&a.error("Timeout waiting for the tracer to flush"),z=0,Y){let e=0;for(const t of ne.values()){const{pass:r,fail:s}=oe(t);r>0&&(e+=s)}0!==e&&i.results.numFailedTests===e&&(i.results.success=!0)}return i}));return e.runCLI=r.runCLI,e})),s({name:"jest-circus",file:"build/legacy-code-todo-rewrite/jestAdapter.js",versions:[">=24.8.0"]},(function(e,t){const r=e.default?e.default:e,s=o.wrapFunction(r,(e=>function(){const r=arguments[2];if(!r)return e.apply(this,arguments);const s=new i("bound-anonymous-fn");return s.runInAsyncScope((()=>(w.publish({testSuite:r.testSuite,testEnvironmentOptions:r.testEnvironmentOptions,testSourceFile:r.testSourceFile,displayName:r.displayName,frameworkVersion:t}),e.apply(this,arguments).then((e=>{const{numFailingTests:t,skipped:n,failureMessage:i}=e;let o="pass";if(n?o="skipped":0!==t&&(o="fail"),r.testEnvironmentOptions?._ddTestCodeCoverageEnabled){const e=r.repositoryRoot||r.rootDir,t=c(r.global.__coverage__).map((t=>d(t,e)));s.runInAsyncScope((()=>{O.publish({coverageFiles:t,testSuite:r.testSourceFile})}))}return x.publish({status:o,errorMessage:i}),e})).catch((e=>{throw x.publish({status:"fail",error:e}),e})))))}));return e.default?e.default=s:e=s,e})),s({name:"@jest/transform",versions:[">=24.8.0"],file:"build/ScriptTransformer.js"},(e=>{const t=e.createScriptTransformer;return e.createScriptTransformer=async function(e){const{testEnvironmentOptions:r,...s}=e,{_ddTestModuleId:n,_ddTestSessionId:i,_ddTestCommand:o,_ddTestSessionName:a,_ddForcedToRun:c,_ddUnskippable:u,_ddItrCorrelationId:l,_ddKnownTests:p,_ddIsEarlyFlakeDetectionEnabled:d,_ddEarlyFlakeDetectionNumRetries:h,_ddRepositoryRoot:f,_ddIsFlakyTestRetriesEnabled:g,_ddFlakyTestRetriesCount:m,_ddIsDiEnabled:_,_ddIsKnownTestsEnabled:y,...b}=r;return s.testEnvironmentOptions=b,arguments[0]=s,t.apply(this,arguments)},e})),s({name:"@jest/core",versions:[">=24.8.0"],file:"build/SearchSource.js"},((e,t)=>{const r=e.default?e.default:e;return o.wrap(r.prototype,"getTestPaths",(e=>async function(){const r=await e.apply(this,arguments),[{rootDir:s,shard:n}]=arguments;if(X){const e=r.tests.map((e=>d(e.path,e.context.config.rootDir)));if(m(e,F.jest||{},W)){a.error("Early flake detection is disabled because the number of new suites is too high."),Y=!1,X=!1;const e=r.tests[0]?.context?.config?.testEnvironmentOptions;e&&(e._ddIsEarlyFlakeDetectionEnabled=!1,e._ddIsKnownTestsEnabled=!1),Z=!0}}if(n?.shardCount>1||!$||!U.length)return r;const{tests:i}=r,o=ue(i,s,t);return{...r,tests:o}})),e})),s({name:"jest-config",versions:[">=25.1.0"]},(function(e){return o.wrap(e,"readConfigs",(e=>async function(){const t=await e.apply(this,arguments);return de(t),t})),e})),s({name:"jest-config",versions:["24.8.0 - 24.9.0"]},(function(e){return o.wrap(e,"readConfigs",(e=>function(){const t=e.apply(this,arguments);return de(t),t})),e}));const he=["selenium-webdriver","selenium-webdriver/chrome","selenium-webdriver/edge","selenium-webdriver/safari","selenium-webdriver/firefox","selenium-webdriver/ie","selenium-webdriver/chromium","winston"];s({name:"jest-runtime",versions:[">=24.8.0"]},(e=>{const t=e.default?e.default:e;return o.wrap(t.prototype,"requireModuleOrMock",(e=>function(t,r){return function(e){return he.includes(e)}(r)?this._requireCoreModule(r):e.apply(this,arguments)})),e})),s({name:"jest-worker",versions:[">=24.9.0"],file:"build/workers/ChildProcessWorker.js"},(e=>{const t=e.default;return o.wrap(t.prototype,"send",(e=>function(t){if(!X)return e.apply(this,arguments);const[r]=t;if(1===r){const r=t[t.length-1];if(r.length>1)return e.apply(this,arguments);if(!r[0]?.config)return e.apply(this,arguments);const[{globalConfig:s,config:n,path:i}]=r,o=d(i,s.rootDir||process.cwd()),a=F.jest?.[o]||[];r[0].config={...n,testEnvironmentOptions:{...n.testEnvironmentOptions,_ddKnownTests:a}}}return e.apply(this,arguments)})),o.wrap(t.prototype,"_onMessage",(e=>function(){const[t,r]=arguments[0];if(t!==u)if(t!==l){if(t!==_)return e.apply(this,arguments);ee.runInAsyncScope((()=>{k.publish(r)}))}else ee.runInAsyncScope((()=>{I.publish(r)}));else ee.runInAsyncScope((()=>{A.publish(r)}))})),e}))},52450:(e,t,r)=>{"use strict";const{channel:s,addHook:n,AsyncResource:i}=r(95092),o=r(81444),a=s("apm:kafkajs:produce:start"),c=s("apm:kafkajs:produce:commit"),u=s("apm:kafkajs:produce:finish"),l=s("apm:kafkajs:produce:error"),p=s("apm:kafkajs:consume:start"),d=s("apm:kafkajs:consume:commit"),h=s("apm:kafkajs:consume:finish"),f=s("apm:kafkajs:consume:error"),g=s("apm:kafkajs:consume-batch:start"),m=s("apm:kafkajs:consume-batch:finish"),_=s("apm:kafkajs:consume-batch:error");function y(e){const{payload:{groupId:t,topics:r}}=e,s=[];for(const{topic:e,partitions:n}of r)for(const{partition:r,offset:i}of n)s.push({groupId:t,partition:r,offset:i,topic:e});d.publish(s)}n({name:"kafkajs",file:"src/index.js",versions:[">=1.4"]},(e=>{class t extends e{constructor(e){super(e),this._brokers=e.brokers&&"function"!=typeof e.brokers?e.brokers.join(","):void 0}}return o.wrap(t.prototype,"producer",(e=>function(){const t=e.apply(this,arguments),r=t.send,s=this._brokers,n=v(this);return t.send=function(){const e=e=>{const t=new i("bound-anonymous-fn");return t.runInAsyncScope((()=>{if(!a.hasSubscribers)return r.apply(this,arguments);try{const{topic:n,messages:i=[]}=arguments[0];for(const e of i)null!==e&&"object"==typeof e&&(e.headers=e.headers||{});a.publish({topic:n,messages:i,bootstrapServers:s,clusterId:e});const o=r.apply(this,arguments);return o.then(t.bind((e=>{u.publish(void 0),c.publish(e)})),t.bind((e=>{e&&l.publish(e),u.publish(void 0)}))),o}catch(e){throw l.publish(e),u.publish(void 0),e}}))};return E(n)?n.then((t=>e(t))):e(n)},t})),o.wrap(t.prototype,"consumer",(e=>function(){if(!p.hasSubscribers)return e.apply(this,arguments);const t=v(this),r=(e,t)=>{const{topic:r,partition:s,message:n}=e[0];return{topic:r,partition:s,message:n,groupId:o,clusterId:t}},s=(e,t)=>{const{batch:r}=e[0],{topic:s,partition:n,messages:i}=r;return{topic:s,partition:n,messages:i,groupId:o,clusterId:t}},n=e.apply(this,arguments);n.on(n.events.COMMIT_OFFSETS,y);const i=n.run,o=arguments[0].groupId;return n.run=function({eachMessage:e,eachBatch:n,...o}){const a=t=>i({eachMessage:b(e,p,h,f,r,t),eachBatch:b(n,g,m,_,s,t),...o});return E(t)?t.then((e=>a(e))):a(t)},n})),t}));const b=(e,t,r,s,n,o)=>"function"==typeof e?function(...a){const c=new i("bound-anonymous-fn");return c.runInAsyncScope((()=>{const i=n(a,o);t.publish(i);try{const t=e.apply(this,a);return t&&"function"==typeof t.then?t.then(c.bind((()=>r.publish(void 0))),c.bind((e=>{e&&s.publish(e),r.publish(void 0)}))):r.publish(void 0),t}catch(e){throw s.publish(e),r.publish(void 0),e}}))}:e,v=e=>{if(e._ddKafkaClusterId)return e._ddKafkaClusterId;if(!e.admin)return null;const t=e.admin();return t.describeCluster?t.connect().then((()=>t.describeCluster())).then((r=>{const s=r?.clusterId;return e._ddKafkaClusterId=s,t.disconnect(),s})).catch((e=>{throw e})):null};function E(e){return!!e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof e.then}},44643:(e,t,r)=>{"use strict";const{addHook:s,channel:n,AsyncResource:i}=r(95092),{wrapThen:o}=r(30060),a=r(81444),c=n("datadog:knex:raw:start"),u=n("datadog:knex:raw:finish");function l(e){s({name:"knex",versions:[">=0.8.0"],file:e},(e=>(a.wrap(e.prototype,"then",o),e)))}function p(e,t){return"function"!=typeof e?e:a.wrapFunction(e,(e=>function(){t(),e.apply(this,arguments)}))}l("lib/query/builder.js"),l("lib/raw.js"),l("lib/schema/builder.js"),s({name:"knex",versions:[">=2"],file:"lib/knex-builder/Knex.js"},(e=>(a.wrap(e.Client.prototype,"raw",(e=>function(){if(!c.hasSubscribers)return e.apply(this,arguments);const t=arguments[0];if("DEFAULT"===t)return e.apply(this,arguments);const r=new i("bound-anonymous-fn");function s(){u.publish()}return r.runInAsyncScope((()=>{c.publish({sql:t,dialect:this.dialect});const n=e.apply(this,arguments);return a.wrap(n,"then",(e=>function(){return r.runInAsyncScope((()=>{arguments[0]=p(arguments[0],s),arguments[1]&&(arguments[1]=p(arguments[1],s));const t=e.apply(this,arguments);return a.wrap(t,"catch",(e=>function(){return arguments[0]=p(arguments[0],s),e.apply(this,arguments)})),t}))})),a.wrap(n,"asCallback",(e=>function(){return r.runInAsyncScope((()=>(arguments[0]=p(arguments[0],s),e.apply(this,arguments))))})),n}))})),e)))},62126:(e,t,r)=>{"use strict";const s=r(81444),{addHook:n,channel:i}=r(95092),o=i("apm:koa:middleware:enter"),a=i("apm:koa:middleware:exit"),c=i("apm:koa:middleware:error"),u=i("apm:koa:middleware:next"),l=i("apm:koa:middleware:finish"),p=i("apm:koa:request:handle"),d=i("apm:koa:request:route"),h=new WeakMap;function f(e){return function(){const t=e.apply(this,arguments);return"function"!=typeof t?t:function(e,r){return p.publish({req:e,res:r}),t.apply(this,arguments)}}}function g(e){return function(){const t=e.apply(this,arguments);if(!Array.isArray(this.middleware))return t;const r=this.middleware.pop();return this.middleware.push(b(r)),t}}function m(e){return function(t,r,s,n){const i=e.apply(this,arguments);return!Array.isArray(t)&&i&&Array.isArray(i.stack)&&y(i),i}}function _(e){return function(){const t=e.apply(this,arguments);return t.stack.forEach(y),t}}function y(e){e.stack=e.stack.map((t=>{if("function"!=typeof t)return t;t=h.get(t)||t;const r=s.wrapFunction(t,(t=>b(t,e)));return h.set(r,t),r}))}function b(e,t){if("function"!=typeof e)return e;const r=e.name;return s.wrapFunction(e,(e=>function(n,i){if(!n||!o.hasSubscribers)return e.apply(this,arguments);const c=n.req,l=t&&t.path,p="string"==typeof l&&!l.endsWith("(.*)")&&!l.endsWith("([^/]*)")&&l;o.publish({req:c,name:r,route:p}),"function"==typeof i&&(arguments[1]=function(e,t){return s.wrapFunction(t,(t=>function(){return u.publish({req:e}),t.apply(this,arguments)}))}(c,i));try{const t=e.apply(this,arguments);return t&&"function"==typeof t.then?t.then((e=>(v(n),e)),(e=>{throw v(n,e),e})):(v(n),t)}catch(e){throw v(n,e),e}finally{a.publish({req:c})}}))}function v(e,t){const r=e.req,s=e.routePath;t&&c.publish({req:r,error:t}),s&&d.publish({req:r,route:s}),l.publish({req:r})}n({name:"koa",versions:[">=2"]},(e=>(s.wrap(e.prototype,"callback",f),s.wrap(e.prototype,"use",g),e))),n({name:"@koa/router",versions:[">=8"]},(e=>(s.wrap(e.prototype,"register",m),s.wrap(e.prototype,"use",_),e))),n({name:"koa-router",versions:[">=7"]},(e=>(s.wrap(e.prototype,"register",m),s.wrap(e.prototype,"use",_),e)))},95322:(e,t,r)=>{"use strict";const{addHook:s}=r(95092),n=r(81444),i=(0,r(1247).tracingChannel)("apm:langchain:invoke");function o(e,t,r=[]){return function(){if(!i.start.hasSubscribers)return e.apply(this,arguments);const s=[...this.lc_namespace||r,this.constructor.name].join("."),n={args:arguments,instance:this,type:t,resource:s};return i.tracePromise(e,n,this,...arguments)}}const a=["js","cjs"];for(const e of a)s({name:"@langchain/core",file:`dist/runnables/base.${e}`,versions:[">=0.1"]},(e=>{const t=e.RunnableSequence;return n.wrap(t.prototype,"invoke",(e=>o(e,"chain"))),n.wrap(t.prototype,"batch",(e=>o(e,"chain"))),e})),s({name:"@langchain/core",file:`dist/language_models/chat_models.${e}`,versions:[">=0.1"]},(e=>{const t=e.BaseChatModel;return n.wrap(t.prototype,"generate",(e=>o(e,"chat_model"))),e})),s({name:"@langchain/core",file:`dist/language_models/llms.${e}`,versions:[">=0.1"]},(e=>{const t=e.BaseLLM;return n.wrap(t.prototype,"generate",(e=>o(e,"llm"))),e})),s({name:"@langchain/openai",file:`dist/embeddings.${e}`,versions:[">=0.1"]},(e=>{const t=e.OpenAIEmbeddings,r=["langchain","embeddings","openai"];return n.wrap(t.prototype,"embedDocuments",(e=>o(e,"embedding",r))),n.wrap(t.prototype,"embedQuery",(e=>o(e,"embedding",r))),e}))},14365:(e,t,r)=>{"use strict";const{channel:s,addHook:n,AsyncResource:i}=r(95092),o=r(81444);function a(e){return"string"==typeof e||e instanceof String}n({name:"ldapjs",versions:[">=2"]},(e=>{const t=s("datadog:ldapjs:client:search");return o.wrap(e.Client.prototype,"search",(e=>function(r,s){if(t.hasSubscribers){let e;a(s)?e=s:null!==s&&"object"==typeof s&&s.filter&&a(s.filter)&&(e=s.filter),t.publish({base:r,filter:e})}return e.apply(this,arguments)})),o.wrap(e.Client.prototype,"_send",(e=>function(){const t=function(e){let t=-1;for(let r=e.length-1;r>=0;r--)if("function"==typeof e[r]){t=r;break}return t}(arguments);if(t>-1){const e=arguments[t];arguments[t]=o.wrapFunction(e,(e=>function(t,r){null!==r&&"object"==typeof r&&"function"==typeof r.on&&function(e){const t=new WeakMap,r=e=>function(r,s){if("function"==typeof s){let e=t.get(s);e||(e=new i("bound-anonymous-fn").bind(s),t.set(s,e)),arguments[1]=e}return e.apply(this,arguments)};o.wrap(e,"on",r),o.wrap(e,"addListener",r);const s=e=>function(r,s){if("function"==typeof s){const e=t.get(s);e&&(arguments[1]=e)}return e.apply(this,arguments)};o.wrap(e,"off",s),o.wrap(e,"removeListener",s)}(r),e.apply(this,arguments)}))}return e.apply(this,arguments)})),o.wrap(e.Client.prototype,"bind",(e=>function(t,r,s,n){return"function"==typeof s?arguments[2]=i.bind(s):"function"==typeof n&&(arguments[3]=i.bind(n)),e.apply(this,arguments)})),e}))},11304:(e,t,r)=>{"use strict";const{addHook:s,AsyncResource:n}=r(95092),i=r(81444);function o(e){return function(){const t=arguments.length-1;return arguments[t]=n.bind(arguments[t]),e.apply(this,arguments)}}s({name:"limitd-client",versions:[">=2.8"]},(e=>(i.wrap(e.prototype,"_directRequest",o),i.wrap(e.prototype,"_retriedRequest",o),e)))},18294:(e,t,r)=>{"use strict";const{channel:s,addHook:n}=r(95092),i=r(81444);n({name:"lodash",versions:[">=4"]},(e=>{const t=s("datadog:lodash:operation");return i.massWrap(e,["trim","trimStart","trimEnd","toLower","toUpper","join"],(e=>function(){if(!t.hasSubscribers)return e.apply(this,arguments);const r=e.apply(this,arguments),s={operation:e.name,arguments,result:r};return t.publish(s),s.result})),e}))},13359:(e,t,r)=>{"use strict";const{channel:s,addHook:n,AsyncResource:i}=r(95092),o=r(81444),a=s("apm:mariadb:query:start"),c=s("apm:mariadb:query:finish"),u=s("apm:mariadb:query:error"),l=s("apm:mariadb:pool:skip"),p=s("apm:mariadb:pool:unskip");function d(e){return class extends e{constructor(...e){super(...e);const t=new i("bound-anonymous-fn");this.start&&(this.start=function(e,t){return o.wrapFunction(e,(e=>function(){if(!a.hasSubscribers)return e.apply(this,arguments);const r=t.bind(this.resolve),s=t.bind(this.reject),n=t.runInAsyncScope((()=>new i("bound-anonymous-fn")));return o.wrap(this,"resolve",(function(){return function(){return n.runInAsyncScope((()=>{c.publish()})),r.apply(this,arguments)}})),o.wrap(this,"reject",(function(){return function(e){return n.runInAsyncScope((()=>{u.publish(e),c.publish()})),s.apply(this,arguments)}})),n.runInAsyncScope((()=>(a.publish({sql:this.sql,conf:this.opts}),e.apply(this,arguments))))}))}(this.start,t))}}}function h(e){return function(t){return function(r){return a.hasSubscribers?new i("bound-anonymous-fn").runInAsyncScope((()=>(a.publish({sql:r,conf:e}),t.apply(this,arguments).then((e=>(c.publish(),e)),(e=>{throw u.publish(e),c.publish(),e})))),"bound-anonymous-fn"):t.apply(this,arguments)}}}function f(e,t){return function(r){t.apply(this,arguments),o.wrap(this,e,h(r)),o.wrap(this,"_queryCallback",function(e){return function(t){return function(r){if(!a.hasSubscribers)return t.apply(this,arguments);const s=arguments[arguments.length-1],n=new i("bound-anonymous-fn"),l=new i("bound-anonymous-fn");return"function"!=typeof s&&(arguments.length=arguments.length+1),arguments[arguments.length-1]=o.wrapFunction(s,(e=>n.bind((function(t){if(t&&u.publish(t),c.publish(),"function"==typeof e)return l.runInAsyncScope((()=>e.apply(this,arguments)))})))),n.runInAsyncScope((()=>(a.publish({sql:r,conf:e}),t.apply(this,arguments))),"bound-anonymous-fn")}}}(r))}}function g(e){return function(t,r,s,n){arguments[1]=m(r),arguments[2]=m(s),e.apply(this,arguments),o.wrap(this,"query",h(t.connOptions))}}function m(e){return function(){l.publish();try{return e.apply(this,arguments)}finally{p.publish()}}}const _="mariadb";n({name:_,file:"lib/cmd/query.js",versions:[">=3"]},(e=>d(e))),n({name:_,file:"lib/cmd/execute.js",versions:[">=3"]},(e=>d(e))),n({name:_,file:"lib/pool.js",versions:[">=3"]},(e=>(o.wrap(e.prototype,"_createConnection",m),e))),n({name:_,file:"lib/connection.js",versions:[">=2.5.2 <3"]},(e=>o.wrapFunction(e,f.bind(null,"_queryPromise")))),n({name:_,file:"lib/connection.js",versions:[">=2.0.4 <=2.5.1"]},(e=>o.wrapFunction(e,f.bind(null,"query")))),n({name:_,file:"lib/pool-base.js",versions:[">=2.0.4 <3"]},(e=>o.wrapFunction(e,g)))},37776:(e,t,r)=>{"use strict";const{channel:s,addHook:n,AsyncResource:i}=r(95092),o=r(81444);n({name:"memcached",versions:[">=2.2"]},(e=>{const t=s("apm:memcached:command:start"),r=s("apm:memcached:command:finish"),n=s("apm:memcached:command:error");return o.wrap(e.prototype,"command",(e=>function(s,a){if(!t.hasSubscribers)return e.apply(this,arguments);const c=new i("bound-anonymous-fn"),u=new i("bound-anonymous-fn"),l=this,p=u.bind((function(){const e=s.apply(this,arguments),i=c.bind(e.callback);return e.callback=o.wrapFunction(i,(e=>u.bind((function(t){return t&&n.publish(t),r.publish(),e.apply(this,arguments)})))),t.publish({client:l,server:a,query:e}),e}));return u.runInAsyncScope((()=>(arguments[0]=p,e.apply(this,arguments))))})),e}))},47269:(e,t,r)=>{"use strict";const s=r(81444),{addHook:n,channel:i,AsyncResource:o}=r(95092),a=i("apm:microgateway-core:request:handle"),c=i("apm:microgateway-core:request:route"),u=i("apm:microgateway-core:request:error"),l="microgateway-core",p=[">=2.1 <=3.0.0"],d=new WeakMap;function h(e){return function(){const t=e.apply(this,arguments);return function(e,r,s){const n=new o("bound-anonymous-fn");return d.set(e,n),a.publish({req:e,res:r}),t.apply(this,arguments)}}}function f(e){return function(t){const r=e.apply(this,arguments);return function(e,t,n){return arguments[2]=function(e,t,r){return s.wrapFunction(r,(r=>function(s){return d.get(e).runInAsyncScope((()=>{s&&u.publish(s),t.proxy&&t.proxy.base_path&&c.publish({req:e,res:t,route:t.proxy.base_path})})),r.apply(this,arguments)}))}(e,t,n),r.apply(this,arguments)}}}n({name:l,versions:p,file:"lib/config-proxy-middleware.js"},(e=>s.wrapFunction(e,h))),n({name:l,versions:p,file:"lib/plugins-middleware.js"},(e=>s.wrapFunction(e,f)))},84605:(e,t,r)=>{process.env.MOCHA_WORKER_ID?r(17782):r(34361)},37769:(e,t,r)=>{const{addHook:s,channel:n}=r(95092),i=r(81444),{getCallSites:o}=r(78834),{testToStartLine:a}=r(679),c=n("ci:mocha:test:parameterize"),u=new WeakSet;s({name:"mocha-each",versions:[">=2.0.1"]},(e=>u.has(e)?e:(u.add(e),i.wrapFunction(e,(e=>function(){const[t]=arguments,{it:r,...s}=e.apply(this,arguments);return{it:function(e){c.publish({title:e,params:t}),r.apply(this,arguments)},...s}}))))),s({name:"mocha",versions:[">=5.2.0"],file:"lib/suite.js"},(e=>(i.wrap(e.prototype,"addTest",(e=>function(t){let r;const s=o().find((e=>e.getFileName()===t.file));return s&&(r=s.getLineNumber(),a.set(t,r)),e.apply(this,arguments)})),e)))},34361:(e,t,r)=>{"use strict";const{createCoverageMap:s}=r(51958),{addHook:n,channel:i,AsyncResource:o}=r(95092),a=r(81444),{isMarkedAsUnskippable:c}=r(25500),u=r(75004),{getTestSuitePath:l,MOCHA_WORKER_TRACE_PAYLOAD_CODE:p,fromCoverageMapToCoverage:d,getCoveredFilenamesFromCoverage:h,mergeCoverage:f,resetCoverage:g,getIsFaultyEarlyFlakeDetection:m}=r(97507),{isNewTest:_,getSuitesByTestFile:y,runnableWrapper:b,getOnTestHandler:v,getOnTestEndHandler:E,getOnTestRetryHandler:S,getOnHookEndHandler:T,getOnFailHandler:w,getOnPendingHandler:x,testFileToSuiteAr:A,newTests:I,getTestFullName:k,getRunTestsWrapper:O}=r(679);r(37769);const R=new o("bound-anonymous-fn"),C=new WeakSet,N=[];let P=[],D=!1,L=[],M="",q=!1;const j={},U=s();let F;const B=i("ci:mocha:test:start"),$=i("ci:mocha:test-suite:start"),G=i("ci:mocha:test-suite:finish"),V=i("ci:mocha:test-suite:error"),z=i("ci:mocha:test-suite:code-coverage"),H=i("ci:mocha:library-configuration"),K=i("ci:mocha:known-tests"),Y=i("ci:mocha:test-suite:skippable"),Q=i("ci:mocha:worker-report:trace"),W=i("ci:mocha:session:start"),Z=i("ci:mocha:session:finish"),J=i("ci:mocha:itr:skipped-suites"),X=i("ci:nyc:get-coverage");function ee(e){return e.isFailed?e.isFailed():!!e.isPending&&!e.isPending()&&"failed"!==e.state}function te(e,t){return R.bind((function(){const r=`mocha ${process.argv.slice(2).join(" ")}`;W.publish({command:r,frameworkVersion:t}),!e&&L.length&&J.publish({skippedSuites:L,frameworkVersion:t})}))}function re(e){return R.bind((function(){let t,r,s="pass";if(this.stats?(s=0===this.stats.failures?"pass":"fail",0===this.stats.tests&&(s="skip")):0!==this.failures&&(s="fail"),j.isEarlyFlakeDetectionEnabled)for(const e of Object.values(I)){const t=e.filter((e=>ee(e))),r=t.length===e.length;t.length&&!r&&(this.stats.failures-=t.length,this.failures-=t.length)}if("fail"===s&&(t=new Error(`Failed tests: ${this.failures}.`)),A.clear(),global.__coverage__){try{F&&U.merge(d(F)),r=U.getCoverageSummary().lines.pct}catch(e){}global.__coverage__=d(U)}Z.publish({status:s,isSuitesSkipped:D,testCodeCoverageLinesTotal:r,numSkippedSuites:L.length,hasForcedToRunSuites:q,hasUnskippableSuites:!!N.length,error:t,isEarlyFlakeDetectionEnabled:j.isEarlyFlakeDetectionEnabled,isEarlyFlakeDetectionFaulty:j.isEarlyFlakeDetectionFaulty,isParallel:e})}))}function se(e,t,r){const s=new o("bound-anonymous-fn"),n=({err:t,skippableSuites:s,itrCorrelationId:n})=>{t?P=[]:(P=s,M=n);const i=e.suite.suites.reduce(((e,t)=>{const r=l(t.file,process.cwd()),s=P.includes(r),n=N.includes(t.file);return s&&!n?e.skippedSuites.add(r):e.suitesToRun.push(t),e}),{suitesToRun:[],skippedSuites:new Set}),{suitesToRun:o}=i;D=o.length!==e.suite.suites.length,u.debug((()=>`${o.length} out of ${e.suite.suites.length} suites are going to run.`)),e.suite.suites=o,L=Array.from(i.skippedSuites),r()},i=({err:e,knownTests:t})=>{e?(j.knownTests=[],j.isEarlyFlakeDetectionEnabled=!1,j.isKnownTestsEnabled=!1):j.knownTests=t,j.isSuitesSkippingEnabled?Y.publish({onDone:s.bind(n)}):r()};H.publish({onDone:s.bind((({err:e,libraryConfig:o})=>{if(e||!Y.hasSubscribers||!K.hasSubscribers)return r();j.isEarlyFlakeDetectionEnabled=o.isEarlyFlakeDetectionEnabled,j.earlyFlakeDetectionNumRetries=o.earlyFlakeDetectionNumRetries,j.earlyFlakeDetectionFaultyThreshold=o.earlyFlakeDetectionFaultyThreshold,j.isKnownTestsEnabled=o.isKnownTestsEnabled,j.isSuitesSkippingEnabled=!t&&o.isSuitesSkippingEnabled,j.isFlakyTestRetriesEnabled=!t&&o.isFlakyTestRetriesEnabled,j.flakyTestRetriesCount=!t&&o.flakyTestRetriesCount,j.isKnownTestsEnabled?K.publish({onDone:s.bind(i)}):j.isSuitesSkippingEnabled?Y.publish({onDone:s.bind(n)}):r()}))})}n({name:"mocha",versions:[">=5.2.0"],file:"lib/mocha.js"},(e=>(a.wrap(e.prototype,"run",(e=>function(){if(!B.hasSubscribers||process.env.MOCHA_WORKER_ID||this.options.parallel)return e.apply(this,arguments);this.options.delay=!0;const t=e.apply(this,arguments);return this.files.forEach((e=>{c({path:e})&&N.push(e)})),se(t,!1,(()=>{if(j.isKnownTestsEnabled){const e=this.files.map((e=>l(e,process.cwd())));m(e,j.knownTests?.mocha||{},j.earlyFlakeDetectionFaultyThreshold)&&(j.isEarlyFlakeDetectionEnabled=!1,j.isEarlyFlakeDetectionFaulty=!0,j.isKnownTestsEnabled=!1)}X.hasSubscribers?X.publish({onDone:e=>{F=e,global.run()}}):global.run()})),t})),e))),n({name:"mocha",versions:[">=5.2.0"],file:"lib/cli/run-helpers.js"},(e=>(a.wrap(e,"runMocha",(e=>async function(){if(!B.hasSubscribers)return e.apply(this,arguments);const t=arguments[0];return t.options.parallel||(t.options.delay=!0),e.apply(this,arguments)})),e))),n({name:"mocha",versions:[">=5.2.0"],file:"lib/runner.js"},(function(e,t){return C.has(e)||(C.add(e),a.wrap(e.prototype,"runTests",(e=>O(e,j))),a.wrap(e.prototype,"run",(e=>function(){if(!B.hasSubscribers)return e.apply(this,arguments);const{suitesByTestFile:r,numSuitesByTestFile:s}=y(this.suite);return this.once("start",te(!1,t)),this.once("end",re(!1)),this.on("test",v(!0,I)),this.on("test end",E()),this.on("retry",S()),this.on("hook end",T()),this.on("fail",w(!0)),this.on("pending",x()),this.on("suite",(function(e){if(e.root||!e.tests.length)return;let t=A.get(e.file);if(!t){t=new o("bound-anonymous-fn"),A.set(e.file,t);const r=N.includes(e.file);q=r&&P.includes(l(e.file,process.cwd())),t.runInAsyncScope((()=>{$.publish({testSuiteAbsolutePath:e.file,isUnskippable:r,isForcedToRun:q,itrCorrelationId:M})}))}})),this.on("suite end",(function(e){if(e.root)return;const t=r[e.file];if(0!=--s[e.file])return;let n="pass";if(t.every((e=>e.pending))?n="skip":t.forEach((e=>{e.eachTest((e=>{("failed"===e.state||e.timedOut)&&(n="fail")}))})),global.__coverage__){const t=h(global.__coverage__);z.publish({coverageFiles:t,suiteFile:e.file}),f(global.__coverage__,U),g(global.__coverage__)}const i=A.get(e.file);i?i.runInAsyncScope((()=>{G.publish(n)})):u.warn((()=>`No AsyncResource found for suite ${e.file}`))})),e.apply(this,arguments)}))),e})),n({name:"mocha",versions:[">=5.2.0"],file:"lib/runnable.js"},(e=>b(e,j))),n({name:"workerpool",versions:[">=6.0.0"],file:"src/WorkerHandler.js"},(e=>(a.wrap(e.prototype,"exec",(e=>function(t,r){if(!B.hasSubscribers)return e.apply(this,arguments);if(!r?.length)return e.apply(this,arguments);const[s]=r,n=new o("bound-anonymous-fn");function i(e){if(Array.isArray(e)){const[t,r]=e;t===p&&n.runInAsyncScope((()=>{Q.publish(r)}))}}this.worker.on("message",i),n.runInAsyncScope((()=>{$.publish({testSuiteAbsolutePath:s})}));try{const t=e.apply(this,arguments);return t.then((e=>{const t=0===e.failureCount?"pass":"fail";n.runInAsyncScope((()=>{G.publish(t)})),this.worker.off("message",i)}),(e=>{n.runInAsyncScope((()=>{V.publish(e),G.publish("fail")})),this.worker.off("message",i)})),t}catch(e){throw n.runInAsyncScope((()=>{V.publish(e),G.publish("fail")})),this.worker.off("message",i),e}})),e))),n({name:"mocha",versions:[">=8.0.0"],file:"lib/nodejs/parallel-buffered-runner.js"},((e,t)=>(a.wrap(e.prototype,"run",(e=>function(r,{files:s}){return B.hasSubscribers?(this.once("start",te(!0,t)),this.once("end",re(!0)),se(this,!0,(()=>{if(j.isKnownTestsEnabled){const e=s.map((e=>l(e,process.cwd())));m(e,j.knownTests?.mocha||{},j.earlyFlakeDetectionFaultyThreshold)&&(j.isKnownTestsEnabled=!1,j.isEarlyFlakeDetectionEnabled=!1,j.isEarlyFlakeDetectionFaulty=!0)}e.apply(this,arguments)})),this):e.apply(this,arguments)})),e))),n({name:"mocha",versions:[">=8.0.0"],file:"lib/nodejs/buffered-worker-pool.js"},(e=>{const{BufferedWorkerPool:t}=e;return a.wrap(t.prototype,"run",(e=>async function(t,r){if(!B.hasSubscribers||!j.isKnownTestsEnabled)return e.apply(this,arguments);const s=l(t,process.cwd()),n=j.knownTests.mocha?.[s]||[],i=await e.apply(this,[t,{...r,_ddEfdNumRetries:j.earlyFlakeDetectionNumRetries,_ddIsEfdEnabled:j.isEarlyFlakeDetectionEnabled,_ddKnownTests:{mocha:{[s]:n}}}]),o=i.events.filter((e=>"test end"===e.eventName)).map((e=>e.data));for(const e of o)if(_(e,j.knownTests)){const t=k(e),r=I[t];r?r.push(e):I[t]=[e]}return i})),e}))},679:(e,t,r)=>{"use strict";const{getTestSuitePath:s,removeEfdStringFromTestName:n,addEfdStringToTestName:i}=r(97507),{channel:o,AsyncResource:a}=r(95092),c=r(81444),u=o("ci:mocha:test:start"),l=o("ci:mocha:test:finish"),p=o("ci:mocha:test:retry"),d=o("ci:mocha:test:error"),h=o("ci:mocha:test:skip"),f=o("ci:mocha:test-suite:error"),g=new WeakMap,m=new WeakMap,_=new WeakMap,y=new Map,b=new WeakSet,v={};function E(e,t){const r=s(e.file,process.cwd()),i=n(e.fullTitle());return!(t.mocha?.[r]||[]).includes(i)}function S(e,t){const r=e.title,s=e.parent;for(let n=0;n<t;n++){const t=e.clone();t.title=i(r,n+1),s.addTest(t),t._ddIsNew=!0,t._ddIsEfdRetry=!0}}function T(e){return void 0!==e._currentRetry&&0!==e._currentRetry}function w(e){return e._currentRetry===e._retries}function x(e){return`mocha.${s(e.file,process.cwd())}.${n(e.fullTitle())}`}function A(e){return e.isPending()?"skip":e.isFailed()||e.timedOut?"fail":"pass"}function I(e){return e.fn?b.has(e.fn)?m.get(e.fn):e.fn:e}function k(e){const t=I(e);return g.get(t)}e.exports={isNewTest:E,retryTest:S,getSuitesByTestFile:function(e){const t={};!function e(r){r.file&&(t[r.file]?t[r.file].push(r):t[r.file]=[r]),r.suites.forEach((t=>{e(t)}))}(e);const r=Object.keys(t).reduce(((e,r)=>(e[r]=t[r].length,e)),{});return{suitesByTestFile:t,numSuitesByTestFile:r}},isMochaRetry:T,getTestFullName:x,getTestStatus:A,runnableWrapper:function(e,t){return c.wrap(e.prototype,"run",(e=>function(){if(!u.hasSubscribers)return e.apply(this,arguments);t?.isFlakyTestRetriesEnabled&&this.retries(t?.flakyTestRetriesCount);const r=this.parent._beforeEach.includes(this),s=this.parent._afterEach.includes(this),n=r||s;if(b.has(this.fn)){const e=m.get(this.fn);this.fn=e,b.delete(this.fn)}if(n||"test"===this.type){const e=k(n?this.ctx.currentTest:this);if(e){const t=e.bind(this.fn);m.set(t,this.fn),this.fn=t,b.add(this.fn)}}return e.apply(this,arguments)})),e},testToAr:g,originalFns:m,getTestAsyncResource:k,testToStartLine:_,getOnTestHandler:function(e){return function(t){const r=_.get(t),s=new a("bound-anonymous-fn");if(b.has(t.fn)){const e=m.get(t.fn);t.fn=e,b.delete(t.fn)}g.set(t.fn,s);const{file:n,title:i,_ddIsNew:o,_ddIsEfdRetry:c}=t,l={testName:t.fullTitle(),testSuiteAbsolutePath:n,title:i,testStartLine:r};if(e||(l.isParallel=!0),l.isNew=o,l.isEfdRetry=c,o){const e=x(t);v[e]?v[e].push(t):v[e]=[t]}s.runInAsyncScope((()=>{u.publish(l)}))}},getOnTestEndHandler:function(){return async function(e){const t=k(e),r=A(e);(e._ddShouldWaitForHitProbe||e._retriedTest?._ddShouldWaitForHitProbe)&&await new Promise((e=>{setTimeout((()=>{e()}),200)})),t&&!e.parent._afterEach.length&&t.runInAsyncScope((()=>{l.publish({status:r,hasBeenRetried:T(e),isLastRetry:w(e)})}))}},getOnTestRetryHandler:function(){return function(e,t){const r=k(e);if(r){const s=0===e._currentRetry,n=e._currentRetry<e._retries;r.runInAsyncScope((()=>{p.publish({isFirstAttempt:s,err:t,willBeRetried:n,test:e})}))}const s=I(e);g.delete(s)}},getOnHookEndHandler:function(){return function(e){const t=e.ctx.currentTest;if(t&&e.parent._afterEach.includes(e)){const r=w(t);if(t._retries>0&&!r)return;if(e.parent._afterEach.indexOf(e)===e.parent._afterEach.length-1){const e=A(t),s=k(t);s&&s.runInAsyncScope((()=>{l.publish({status:e,hasBeenRetried:T(t),isLastRetry:r})}))}}}},getOnFailHandler:function(e){return function(t,r){const s=t.file;let n=t;const i="hook"===t.type;let o;if(i&&t.ctx&&(n=t.ctx.currentTest),n&&(o=k(n)),o&&o.runInAsyncScope((()=>{i?(r.message=`${t.fullTitle()}: ${r.message}`,d.publish(r),l.publish({status:"fail",hasBeenRetried:T(n)})):d.publish(r)})),e){const e=y.get(s);if(e){const s=new Error(`"${t.parent.fullTitle()}" failed with message "${r.message}"`);s.stack=r.stack,e.runInAsyncScope((()=>{f.publish(s)}))}}}},getOnPendingHandler:function(){return function(e){const t=_.get(e),{file:r,title:s}=e,n={testName:e.fullTitle(),testSuiteAbsolutePath:r,title:s,testStartLine:t},i=k(e);if(i)i.runInAsyncScope((()=>{h.publish(n)}));else{const t=new a("bound-anonymous-fn");e.fn?g.set(e.fn,t):g.set(e,t),t.runInAsyncScope((()=>{h.publish(n)}))}}},testFileToSuiteAr:y,getRunTestsWrapper:function(e,t){return function(r,s){return t.isKnownTestsEnabled&&r.tests.forEach((e=>{!e.isPending()&&E(e,t.knownTests)&&(e._ddIsNew=!0,t.isEarlyFlakeDetectionEnabled&&S(e,t.earlyFlakeDetectionNumRetries))})),e.apply(this,arguments)}},newTests:v}},17782:(e,t,r)=>{"use strict";const{addHook:s,channel:n}=r(95092),i=r(81444),{runnableWrapper:o,getOnTestHandler:a,getOnTestEndHandler:c,getOnHookEndHandler:u,getOnFailHandler:l,getOnPendingHandler:p,getRunTestsWrapper:d}=r(679);r(37769);const h=n("ci:mocha:worker:finish"),f={};s({name:"mocha",versions:[">=8.0.0"],file:"lib/mocha.js"},(e=>(i.wrap(e.prototype,"run",(e=>function(){return this.options._ddKnownTests&&(f.isKnownTestsEnabled=!0,f.isEarlyFlakeDetectionEnabled=this.options._ddIsEfdEnabled,f.knownTests=this.options._ddKnownTests,f.earlyFlakeDetectionNumRetries=this.options._ddEfdNumRetries,delete this.options._ddIsEfdEnabled,delete this.options._ddKnownTests,delete this.options._ddEfdNumRetries),e.apply(this,arguments)})),e))),s({name:"mocha",versions:[">=5.2.0"],file:"lib/runner.js"},(function(e){return i.wrap(e.prototype,"runTests",(e=>d(e,f))),i.wrap(e.prototype,"run",(e=>function(){return h.hasSubscribers?(this.on("end",(()=>{h.publish()})),this.on("test",a(!1)),this.on("test end",c()),this.on("hook end",u()),this.on("fail",l(!1)),this.on("pending",p()),e.apply(this,arguments)):e.apply(this,arguments)})),e})),s({name:"mocha",versions:[">=5.2.0"],file:"lib/runnable.js"},o)},84081:(e,t,r)=>{"use strict";r(70675),r(66847)},70675:(e,t,r)=>{"use strict";const{channel:s,addHook:n,AsyncResource:i}=r(95092),o=r(81444),a=s("apm:moleculer:call:start"),c=s("apm:moleculer:call:finish"),u=s("apm:moleculer:call:error");function l(e){return function(t,r,s){const n=new i("bound-anonymous-fn");return(s=arguments[2]=s||{}).meta=s.meta||{},arguments.length=Math.max(3,arguments.length),n.runInAsyncScope((()=>{a.publish({actionName:t,params:r,opts:s});const n=e.apply(this,arguments),i=this,o=n.ctx;return n.then((e=>(c.publish({broker:i,ctx:o}),e)),(e=>{throw u.publish(e),c.publish({broker:i,ctx:o}),e}))}))}}n({name:"moleculer",versions:[">=0.14"]},(e=>(o.wrap(e.ServiceBroker.prototype,"call",l),e)))},66847:(e,t,r)=>{"use strict";const{channel:s,addHook:n,AsyncResource:i}=r(95092),o=r(81444),a=s("apm:moleculer:action:start"),c=s("apm:moleculer:action:finish"),u=s("apm:moleculer:action:error");function l(e){return function(t){return this.middlewares&&this.middlewares.add&&this.middlewares.add({name:"Datadog",localAction(e,t){const r=this;return o.wrapFunction(e,(e=>function(s){return new i("bound-anonymous-fn").runInAsyncScope((()=>{a.publish({action:t,ctx:s,broker:r});try{return e(s).then((e=>(c.publish(),e)),(e=>{throw u.publish(e),c.publish(),e}))}catch(e){u.publish(e),c.publish()}}))}))}}),e.apply(this,arguments)}}n({name:"moleculer",versions:[">=0.14"]},(e=>(o.wrap(e.ServiceBroker.prototype,"registerMiddlewares",l),e)))},4525:(e,t,r)=>{"use strict";const{channel:s,addHook:n,AsyncResource:i}=r(95092),o=r(81444),a=s("apm:mongodb:query:start"),c=s("apm:mongodb:query:finish"),u=s("apm:mongodb:query:error");function l(e){return o.wrap(e,"command",(e=>p(e,"command"))),o.wrap(e,"insert",(e=>p(e,"insert","insert"))),o.wrap(e,"update",(e=>p(e,"update","update"))),o.wrap(e,"remove",(e=>p(e,"remove","remove"))),o.wrap(e,"query",(e=>p(e,"query"))),o.wrap(e,"getMore",(e=>p(e,"getMore","getMore"))),o.wrap(e,"killCursors",(e=>p(e,"killCursors","killCursors"))),e}function p(e,t,r){return function(t,s,n){return a.hasSubscribers?g(0,e,this,arguments,t,s,n,{name:r}):e.apply(this,arguments)}}function d(e,t,r,s=g){return function(n,i){if(!a.hasSubscribers)return e.apply(this,arguments);const o="string"==typeof this.address?this.address.split(":"):"",c={s:{options:2===o.length?{host:o[0],port:o[1]}:{}}};return n=`${n.db}.${n.collection}`,s(t,e,this,arguments,c,n,i,{name:r})}}function h(e,t,r){return function(){if(!a.hasSubscribers)return e.apply(this,arguments);const t=this.server.s.pool,s=this.ns;return g(0,e,this,arguments,t,s,{},{name:r})}}function f(e,t,r){return function(t,s){return a.hasSubscribers?g(0,e,this,arguments,this,t,s,{name:r}):e.apply(this,arguments)}}function g(e,t,r,s,n,l,p,d={}){const h=d.name||p&&Object.keys(p)[0],f=s.length-1;let g=s[f];if("function"!=typeof g)return t.apply(r,s);const m=n&&n.s&&n.s.options,_=new i("bound-anonymous-fn"),y=new i("bound-anonymous-fn");return g=_.bind(g),y.runInAsyncScope((()=>{a.publish({ns:l,ops:p,options:m,name:h}),s[f]=o.wrapFunction(g,(e=>y.bind((function(t,r){if(t&&u.publish(t),c.publish(),e)return e.apply(this,arguments)}))));try{return t.apply(r,s)}catch(e){throw u.publish(e),e}}))}function m(e,t,r,s,n,o,l,p={}){const d=p.name||l&&Object.keys(l)[0],h=n&&n.s&&n.s.options;return new i("bound-anonymous-fn").runInAsyncScope((()=>(a.publish({ns:o,ops:l,options:h,name:d}),t.apply(r,s).then((function(e){return c.publish(),e}),(function(e){return u.publish(e),c.publish(),Promise.reject(e)})))))}n({name:"mongodb-core",versions:["2 - 3.1.9"]},(e=>{const t=e.Server.prototype;o.wrap(t,"command",(e=>f(e))),o.wrap(t,"insert",(e=>f(e,0,"insert"))),o.wrap(t,"update",(e=>f(e,0,"update"))),o.wrap(t,"remove",(e=>f(e,0,"remove")));const r=e.Cursor.prototype;return o.wrap(r,"_getmore",(e=>h(e,0,"getMore"))),o.wrap(r,"_find",(e=>{return t=e,function(){if(!a.hasSubscribers)return t.apply(this,arguments);const e=this.server.s.pool,r=this.ns,s=this.cmd;return g(0,t,this,arguments,e,r,s)};var t})),o.wrap(r,"kill",(e=>h(e,0,"killCursors"))),e})),n({name:"mongodb",versions:[">=4 <4.6.0"],file:"lib/cmap/connection.js"},(e=>{const t=e.Connection.prototype;return o.wrap(t,"command",(e=>d(e,"command"))),o.wrap(t,"query",(e=>d(e,"query"))),e})),n({name:"mongodb",versions:[">=4.6.0 <6.4.0"],file:"lib/cmap/connection.js"},(e=>{const t=e.Connection.prototype;return o.wrap(t,"command",(e=>d(e,"command"))),e})),n({name:"mongodb",versions:[">=6.4.0"],file:"lib/cmap/connection.js"},(e=>{const t=e.Connection.prototype;return o.wrap(t,"command",(e=>d(e,"command",void 0,m))),e})),n({name:"mongodb",versions:[">=3.3 <4"],file:"lib/core/wireprotocol/index.js"},(e=>l(e))),n({name:"mongodb-core",versions:[">=3.2"],file:"lib/wireprotocol/index.js"},(e=>l(e))),n({name:"mongodb-core",versions:["~3.1.10"],file:"lib/wireprotocol/3_2_support.js"},(e=>(o.wrap(e.prototype,"command",(e=>p(e))),e))),n({name:"mongodb-core",versions:["~3.1.10"],file:"lib/wireprotocol/2_6_support.js"},(e=>(o.wrap(e.prototype,"command",(e=>p(e))),e))),n({name:"mongodb",versions:[">=3.5.4 <4.11.0"],file:"lib/utils.js"},(e=>(o.wrap(e,"maybePromise",(e=>function(t,r,s){const n=new i("bound-anonymous-fn"),o=arguments.length-2;return"function"==typeof(r=arguments[o])&&(arguments[o]=n.bind(r)),e.apply(this,arguments)})),e)))},88033:(e,t,r)=>{"use strict";r(4525);const{channel:s,addHook:n,AsyncResource:i}=r(95092),o=r(81444),a=["count","countDocuments","deleteMany","deleteOne","find","findOneAndDelete","findOneAndReplace","replaceOne"],c=["findOneAndUpdate","updateMany","updateOne"],u=s("datadog:mongodb:collection:filter:start");n({name:"mongodb",versions:[">=3.3 <5","5",">=6"]},(e=>([...a,...c].forEach((t=>{if(!(t in e.Collection.prototype))return;const r=c.includes(t);o.wrap(e.Collection.prototype,t,(e=>function(){return u.hasSubscribers?new i("bound-anonymous-fn").runInAsyncScope((()=>{const s=[arguments[0]];return r&&s.push(arguments[1]),u.publish({filters:s,methodName:t}),e.apply(this,arguments)})):e.apply(this,arguments)}))})),e)))},7314:(e,t,r)=>{"use strict";const{addHook:s,channel:n}=r(95092),{wrapThen:i}=r(30060),{AsyncResource:o}=r(95092),a=r(81444);function c(e){return function(t){return"function"==typeof t?arguments[0]=o.bind(t):"function"==typeof this[t]&&(arguments[0]=o.bind(((...e)=>this[t](...e)))),e.apply(this,arguments)}}s({name:"mongoose",versions:[">=4.6.4 <5","5","6",">=7"]},(e=>(e.Promise&&e.Promise!==global.Promise&&a.wrap(e.Promise.prototype,"then",i),a.wrap(e.Collection.prototype,"addQueue",c),e)));const u=n("datadog:mongoose:model:filter:start"),l=n("datadog:mongoose:model:filter:finish"),p=["count","countDocuments","deleteMany","deleteOne","find","findOne","findOneAndDelete","findOneAndReplace","replaceOne","remove"],d=["findOneAndUpdate","updateMany","updateOne"];s({name:"mongoose",versions:[">=4.6.4 <5","5","6",">=7"],file:"lib/model.js"},(e=>([...p,...d].forEach((t=>{const r=d.includes(t);t in e&&a.wrap(e,t,(e=>function(){if(!u.hasSubscribers)return e.apply(this,arguments);const s=new o("bound-anonymous-fn"),n=[arguments[0]];r&&n.push(arguments[1]);const i=s.bind((function(){l.publish()}));let c=!1;const p=e=>{const t=e.length-1;"function"==typeof e[t]&&(a.wrap(e,t,(e=>function(){return i(),e.apply(this,arguments)})),c=!0)};return p(arguments),s.runInAsyncScope((()=>{u.publish({filters:n,methodName:t});const r=e.apply(this,arguments);return c||a.wrap(r,"exec",(e=>function(){c||p(arguments);const t=e.apply(this,arguments);return c||"function"!=typeof t?.then||a.wrap(t,"then",(e=>function(){const t=arguments[0],r=arguments[1];return arguments[0]=a.wrapFunction(t,(e=>function(){if(i(),e)return e.apply(this,arguments)})),arguments[1]=a.wrapFunction(r,(e=>function(){if(i(),e)return e.apply(this,arguments)})),e.apply(this,arguments)})),t})),r}))}))})),e)));const h=n("datadog:mongoose:sanitize-filter:finish");s({name:"mongoose",versions:["6",">=7"],file:"lib/helpers/query/sanitizeFilter.js"},(e=>a.wrapFunction(e,(e=>function(){const t=e.apply(this,arguments);return h.hasSubscribers&&h.publish({sanitizedObject:t}),t}))))},55266:(e,t,r)=>{"use strict";const s=r(1247),{channel:n,addHook:i}=r(95092),o=r(81444),a=n("datadog:mquery:filter:prepare"),c=s.tracingChannel("datadog:mquery:filter"),u=["find","findOne","findOneAndRemove","findOneAndDelete","count","distinct","where"],l=["findOneAndUpdate"];i({name:"mquery",versions:[">=5.0.0"]},(e=>([...u,...l].forEach((t=>{t in e.prototype&&o.wrap(e.prototype,t,(e=>function(){if(a.hasSubscribers){const e=function(e,t){const[r,s]=e,n=null!==r&&"object"==typeof r?[r]:[];return null!==s&&"object"==typeof s&&l.includes(t)&&n.push(s),n}(arguments,t);e?.length&&a.publish({filters:e})}return e.apply(this,arguments)}))})),o.wrap(e.prototype,"exec",(e=>function(){return c.tracePromise(e,{},this,arguments)})),e)))},96742:(e,t,r)=>{"use strict";const s=r(81444),{channel:n,addHook:i,AsyncResource:o}=r(95092),a=n("datadog:multer:read:finish");i({name:"multer",file:"lib/make-middleware.js",versions:["^1.4.4-lts.1"]},(e=>s.wrapFunction(e,(e=>function(){const t=e.apply(this,arguments);return s.wrapFunction(t,(e=>function(t,r,n){const i=new o("bound-anonymous-fn");return arguments[2]=i.bind(function(e,t,r){return s.wrapFunction(r,(r=>function(){if(a.hasSubscribers&&e){const r=new AbortController,s=e.body;if(a.publish({req:e,res:t,body:s,abortController:r}),r.signal.aborted)return}return r.apply(this,arguments)}))}(t,r,n)),e.apply(this,arguments)}))}))))},86309:(e,t,r)=>{"use strict";const{channel:s,addHook:n,AsyncResource:i}=r(95092),o=r(81444);n({name:"mysql",file:"lib/Connection.js",versions:[">=2"]},(e=>{const t=s("apm:mysql:query:start"),r=s("apm:mysql:query:finish"),n=s("apm:mysql:query:error");return o.wrap(e.prototype,"query",(e=>function(){if(!t.hasSubscribers)return e.apply(this,arguments);const s={sql:arguments[0].sql||arguments[0],conf:this.config},a=new i("bound-anonymous-fn"),c=new i("bound-anonymous-fn");return c.runInAsyncScope((()=>{t.publish(s),arguments[0].sql?arguments[0].sql=s.sql:arguments[0]=s.sql;try{const t=e.apply(this,arguments);if(t._callback){const e=a.bind(t._callback);t._callback=o.wrapFunction(e,(e=>c.bind((function(t,s){return t&&n.publish(t),r.publish(s),e.apply(this,arguments)}))))}else{const e=c.bind((function(){r.publish(void 0)}));t.on("end",e)}return t}catch(e){throw e.stack,n.publish(e),e}}))})),e})),n({name:"mysql",file:"lib/Pool.js",versions:[">=2"]},(e=>{const t=s("datadog:mysql:pool:query:start"),r=s("datadog:mysql:pool:query:finish");return o.wrap(e.prototype,"getConnection",(e=>function(t){return arguments[0]=i.bind(t),e.apply(this,arguments)})),o.wrap(e.prototype,"query",(e=>function(){if(!t.hasSubscribers)return e.apply(this,arguments);const s=new i("bound-anonymous-fn"),n=arguments[0].sql||arguments[0];return s.runInAsyncScope((()=>{t.publish({sql:n});const i=s.bind((function(){r.publish()})),a=arguments[arguments.length-1];"function"==typeof a&&(arguments[arguments.length-1]=o.wrapFunction(a,(e=>function(){return i(),e.apply(this,arguments)})));const c=e.apply(this,arguments);return c&&c.then&&c.then(i).catch(i),c}))})),e}))},26375:(e,t,r)=>{"use strict";const{channel:s,addHook:n,AsyncResource:i}=r(95092),o=r(81444),a=r(99589);function c(e,t){const r=s("apm:mysql2:query:start"),n=s("apm:mysql2:query:finish"),c=s("apm:mysql2:query:error"),u=s("datadog:mysql2:outerquery:start"),l=a.intersects(t,">=1.3.3");return o.wrap(e.prototype,"addCommand",(e=>function(t){if(!r.hasSubscribers)return e.apply(this,arguments);const s=new i("bound-anonymous-fn"),a=t&&t.constructor&&t.constructor.name,u="function"==typeof t.execute&&("Execute"===a||"Query"===a);return t.execute=u?function(e,t,s,a){const u=new i("bound-anonymous-fn");return o.wrapFunction(t,(t=>s.bind((function(i,l){const p={sql:e.statement?e.statement.query:e.sql,conf:a};if(r.publish(p),e.statement?e.statement.query=p.sql:e.sql=p.sql,this.onResult){const e=u.bind(this.onResult);this.onResult=o.wrapFunction(e,(e=>s.bind((function(t){t&&c.publish(t),n.publish(void 0),e.apply(this,arguments)}),"bound-anonymous-fn",this)))}else this.on("error",s.bind((e=>c.publish(e)))),this.on("end",s.bind((()=>n.publish(void 0))));this.execute=t;try{return t.apply(this,arguments)}catch(e){c.publish(e)}}),e)))}(t,t.execute,s,this.config):function(e,t,r){return o.wrapFunction(t,(t=>r.bind((function(e,s){return this.onResult&&(this.onResult=r.bind(this.onResult)),t.apply(this,arguments)}),e)))}(t,t.execute,s),s.bind(e,this).apply(this,arguments)})),o.wrap(e.prototype,"query",(e=>function(t,r,s){if(!u.hasSubscribers)return e.apply(this,arguments);if("object"==typeof t&&(t=t?.sql),!t)return e.apply(this,arguments);const n=new AbortController;if(u.publish({sql:t,abortController:n}),n.signal.aborted){const t=this.addCommand;let r;this.addCommand=function(e){return e};try{r=e.apply(this,arguments)}finally{this.addCommand=t}return s=r.onResult,process.nextTick((()=>{s?s(n.signal.reason):r.emit("error",n.signal.reason),l&&r.emit("end")})),r}return e.apply(this,arguments)})),o.wrap(e.prototype,"execute",(e=>function(t,r,s){if(!u.hasSubscribers)return e.apply(this,arguments);if("object"==typeof t&&(t=t?.sql),!t)return e.apply(this,arguments);const n=new AbortController;if(u.publish({sql:t,abortController:n}),n.signal.aborted){const t=this.addCommand;let r;this.addCommand=function(e){return e};try{r=e.apply(this,arguments)}finally{this.addCommand=t}return r?.onResult(n.signal.reason),r}return e.apply(this,arguments)})),e}n({name:"mysql2",file:"lib/base/connection.js",versions:[">=3.11.5"]},c),n({name:"mysql2",file:"lib/connection.js",versions:["1 - 3.11.4"]},c),n({name:"mysql2",file:"lib/pool.js",versions:["1 - 3.11.4"]},(function(e,t){const r=s("datadog:mysql2:outerquery:start"),n=a.intersects(t,">=1.3.3");return o.wrap(e.prototype,"query",(e=>function(t,s,i){if(!r.hasSubscribers)return e.apply(this,arguments);if("object"==typeof t&&(t=t?.sql),!t)return e.apply(this,arguments);const o=new AbortController;if(r.publish({sql:t,abortController:o}),o.signal.aborted){const t=this.getConnection;let r;this.getConnection=function(){};try{r=e.apply(this,arguments)}finally{this.getConnection=t}return process.nextTick((()=>{r.onResult?r.onResult(o.signal.reason):r.emit("error",o.signal.reason),n&&r.emit("end")})),r}return e.apply(this,arguments)})),o.wrap(e.prototype,"execute",(e=>function(t,s,n){if(!r.hasSubscribers)return e.apply(this,arguments);if("object"==typeof t&&(t=t?.sql),!t)return e.apply(this,arguments);const i=new AbortController;return r.publish({sql:t,abortController:i}),i.signal.aborted?("function"==typeof s&&(n=s),void process.nextTick((()=>{n(i.signal.reason)}))):e.apply(this,arguments)})),e})),n({name:"mysql2",file:"lib/pool_cluster.js",versions:["2.3.0 - 3.11.4"]},(function(e){const t=s("datadog:mysql2:outerquery:start"),r=new WeakSet;return o.wrap(e.prototype,"of",(e=>function(){const s=e.apply(this,arguments);return t.hasSubscribers&&!r.has(s)&&(o.wrap(s,"query",(e=>function(r,s,n){if("object"==typeof r&&(r=r?.sql),!r)return e.apply(this,arguments);const i=new AbortController;if(t.publish({sql:r,abortController:i}),i.signal.aborted){const t=this.getConnection;let r;this.getConnection=function(){};try{r=e.apply(this,arguments)}finally{this.getConnection=t}return process.nextTick((()=>{r.onResult?r.onResult(i.signal.reason):r.emit("error",i.signal.reason),r.emit("end")})),r}return e.apply(this,arguments)})),o.wrap(s,"execute",(e=>function(r,s,n){if("object"==typeof r&&(r=r?.sql),!r)return e.apply(this,arguments);const i=new AbortController;return t.publish({sql:r,abortController:i}),i.signal.aborted?("function"==typeof s&&(n=s),void process.nextTick((()=>{n(i.signal.reason)}))):e.apply(this,arguments)})),r.add(s)),s})),e}))},61732:(e,t,r)=>{"use strict";const{channel:s,addHook:n,AsyncResource:i}=r(95092),o=r(81444),a=s("apm:net:ipc:start"),c=s("apm:net:ipc:finish"),u=s("apm:net:ipc:error"),l=s("apm:net:tcp:start"),p=s("apm:net:tcp:finish"),d=s("apm:net:tcp:error"),h=s("apm:net:tcp:connection");function f(e){if(e[0])switch(typeof e[0]){case"object":return Array.isArray(e[0])?f(e[0]):e[0];case"string":if(isNaN(parseFloat(e[0])))return{path:e[0]};case"number":return{port:e[0],host:"string"==typeof e[1]?e[1]:"localhost"}}}function g(e,t,r){const s=["connect","error","close","timeout"],n=r.bind((function(e){e&&("ipc"===t?u.publish(e):d.publish(e)),"ipc"===t?c.publish(void 0):p.publish(void 0)})),i=r.bind((function(){h.publish({socket:e})})),o=function(){e.removeListener("connect",i),s.forEach((t=>{e.removeListener(t,n),e.removeListener(t,o)}))};"tcp"===t&&e.once("connect",i),s.forEach((t=>{e.once(t,n),e.once(t,o)}))}n({name:["net","node:net"]},((e,t,s)=>(r("net"===s?72250:40610),o.wrap(e.Socket.prototype,"connect",(e=>function(){if(!a.hasSubscribers||!l.hasSubscribers)return e.apply(this,arguments);const t=f(arguments),r=arguments.length-1,s=arguments[r];if(!t)return e.apply(this,arguments);const n=new i("bound-anonymous-fn"),c=new i("bound-anonymous-fn");"function"==typeof s&&(arguments[r]=n.bind(s));const p=t.path?"ipc":"tcp";return c.runInAsyncScope((()=>{"ipc"===p?(a.publish({options:t}),g(this,"ipc",c)):(l.publish({options:t}),g(this,"tcp",c));const r=this.emit;this.emit=o.wrapFunction(r,(e=>function(t){switch(t){case"ready":case"connect":return n.runInAsyncScope((()=>e.apply(this,arguments)));default:return e.apply(this,arguments)}}));try{return e.apply(this,arguments)}catch(e){throw"ipc"===p?u.publish(e):d.publish(e),e}}))})),e)))},19470:(e,t,r)=>{"use strict";const{channel:s,addHook:n}=r(95092),i=r(81444),o=s("apm:next:request:start"),a=s("apm:next:request:finish"),c=s("apm:next:request:error"),u=s("apm:next:page:load"),l=s("apm:next:body-parsed"),p=s("apm:next:query-parsed"),d=new WeakSet,h=new WeakMap,f=Symbol.for("NextInternalRequestMeta"),g=new WeakSet;function m(e){return function(t,r,s,n){return x(t,r,(()=>e.apply(this,arguments)))}}function _(e){return function(t,r,s,n){return x(t,r,(()=>e.apply(this,arguments).then((e=>e?this.hasPage(s).then((t=>{const r=t?{page:s}:function(e,t=[]){for(const r of t)if(r.page.startsWith("/api")&&r.match(e))return w(r.page);return w(e)}(s,this.dynamicRoutes);return u.publish(r),e})):e))))}}function y(e){return function(t,r,s,n){return x(t,r,(()=>{const t=null!==n&&"object"==typeof n&&"object"==typeof n.definition?n.definition.pathname:void 0;return u.publish({page:t}),e.apply(this,arguments)}))}}function b(e){return function(t,r,s,n,i){return x(t,r,(()=>e.apply(this,arguments)))}}function v(e){return function(t,r,s,n,i){return x(r,s,t,(()=>e.apply(this,arguments)))}}function E(e){return function(t){return x(t.req,t.res,(()=>e.apply(this,arguments)))}}function S(e){return function(t,r){return x(t.req,t.res,r,(()=>e.apply(this,arguments)))}}function T(e){return function(t,r){const s=e.apply(this,arguments);return s&&u.publish(w(t)),s}}function w(e){if("object"!=typeof e)return{page:e};const t=e.isAppPath;return{page:e.pathname||e.page,isAppPath:t}}function x(e,t,r,s){"function"==typeof r&&(s=r,r=null),e=e.originalRequest||e,t=t.originalResponse||t;const n=e.headers["x-middleware-invoke"]||function(e,t){const r=e[f]||{};return r[t]}(e,"middlewareInvoke");if(n&&!g.has(e)||d.has(e))return g.add(e),r&&c.publish({error:r}),s();d.add(e);const i={req:e,res:t};return o.runStores(i,(()=>{try{return s(i).then((e=>I(i,e)),(e=>I(i,null,e)))}catch(e){return I(i,null,e)}}))}function A(e){return function(t,r,s){return x(t,r,(()=>(u.hasSubscribers&&s&&u.publish({page:s,isStatic:!0}),e.apply(this,arguments))))}}function I(e,t,r){r&&(e.error=r,c.publish(e));const s=h.get(e.req);if(s&&(e.nextRequest=s),a.publish(e),r)throw r;return t}n({name:"next",versions:[">=13.3.0"],file:"dist/server/web/spec-extension/adapters/next-request.js"},(e=>(i.wrap(e.NextRequestAdapter,"fromNodeNextRequest",(e=>function(t){const r=e.apply(this,arguments);return h.set(t.originalRequest,r),r})),e))),n({name:"next",versions:[">=11.1"],file:"dist/server/serve-static.js"},(e=>i.wrap(e,"serveStatic",A))),n({name:"next",versions:[">=10.2 <11.1"],file:"dist/next-server/server/serve-static.js"},(e=>i.wrap(e,"serveStatic",A))),n({name:"next",versions:[">=11.1"],file:"dist/server/next-server.js"},(e=>{const t=e.default;return i.wrap(t.prototype,"handleRequest",m),i.wrap(t.prototype,"renderToResponse",E),i.wrap(t.prototype,"renderErrorToResponse",S),i.wrap(t.prototype,"findPageComponents",T),e})),n({name:"next",versions:[">=13.2"],file:"dist/server/next-server.js"},(e=>{const t=e.default;return i.wrap(t.prototype,"handleApiRequest",y),e})),n({name:"next",versions:[">=11.1 <13.2"],file:"dist/server/next-server.js"},(e=>{const t=e.default;return i.wrap(t.prototype,"handleApiRequest",_),e})),n({name:"next",versions:[">=10.2 <11.1"],file:"dist/next-server/server/next-server.js"},(e=>{const t=e.default;return i.wrap(t.prototype,"handleRequest",m),i.wrap(t.prototype,"handleApiRequest",_),i.wrap(t.prototype,"renderToHTML",b),i.wrap(t.prototype,"renderErrorToHTML",v),i.wrap(t.prototype,"findPageComponents",T),e})),n({name:"next",versions:[">=13"],file:"dist/server/web/spec-extension/request.js"},(e=>{const t=Object.getOwnPropertyDescriptor(e.NextRequest.prototype,"nextUrl");return i.wrap(t,"get",(function(e){return function(){const t=e.apply(this,arguments);if(p.hasSubscribers){const e={};for(const r of t.searchParams.keys())e[r]||(e[r]=t.searchParams.getAll(r));p.publish({query:e})}return t}})),Object.defineProperty(e.NextRequest.prototype,"nextUrl",t),i.massWrap(e.NextRequest.prototype,["text","json"],(function(e){return async function(){const t=await e.apply(this,arguments);return l.publish({body:t}),t}})),i.wrap(e.NextRequest.prototype,"formData",(function(e){return async function(){const t=await e.apply(this,arguments);let r=t;return"function"==typeof t.entries&&(r=Object.fromEntries(t.entries())),l.publish({body:r}),t}})),e}))},40016:(e,t,r)=>{"use strict";const s=r(81444),{channel:n,addHook:i}=r(95092),o=n("datadog:node-serialize:unserialize:start");function a(e){return function(t){return o.hasSubscribers&&o.publish({obj:t}),e.apply(this,arguments)}}i({name:"node-serialize",versions:["0.0.4"]},(e=>(s.wrap(e,"unserialize",a),e)))},87133:(e,t,r)=>{const{addHook:s,channel:n}=r(95092),i=r(81444),o=n("ci:nyc:wrap");s({name:"nyc",versions:[">=17"]},(e=>(i.wrap(e.prototype,"wrap",(e=>async function(){try{JSON.parse(process.env.NYC_CONFIG).all&&o.publish(this)}catch(e){}return e.apply(this,arguments)})),e)))},42917:(e,t,r)=>{"use strict";const{addHook:s}=r(95092),n=r(81444),i=r(1247).tracingChannel("apm:openai:request"),o=[{file:"resources/chat/completions.js",targetClass:"Completions",baseResource:"chat.completions",methods:["create"],streamedResponse:!0},{file:"resources/completions.js",targetClass:"Completions",baseResource:"completions",methods:["create"],streamedResponse:!0},{file:"resources/embeddings.js",targetClass:"Embeddings",baseResource:"embeddings",methods:["create"]},{file:"resources/files.js",targetClass:"Files",baseResource:"files",methods:["create","del","list","retrieve"]},{file:"resources/files.js",targetClass:"Files",baseResource:"files",methods:["retrieveContent"],versions:[">=4.0.0 <4.17.1"]},{file:"resources/files.js",targetClass:"Files",baseResource:"files",methods:["content"],versions:[">=4.17.1"]},{file:"resources/images.js",targetClass:"Images",baseResource:"images",methods:["createVariation","edit","generate"]},{file:"resources/fine-tuning/jobs/jobs.js",targetClass:"Jobs",baseResource:"fine_tuning.jobs",methods:["cancel","create","list","listEvents","retrieve"],versions:[">=4.34.0"]},{file:"resources/fine-tuning/jobs.js",targetClass:"Jobs",baseResource:"fine_tuning.jobs",methods:["cancel","create","list","listEvents","retrieve"],versions:[">=4.1.0 <4.34.0"]},{file:"resources/fine-tunes.js",targetClass:"FineTunes",baseResource:"fine-tune",methods:["cancel","create","list","listEvents","retrieve"],versions:[">=4.0.0 <4.1.0"]},{file:"resources/models.js",targetClass:"Models",baseResource:"models",methods:["del","list","retrieve"]},{file:"resources/moderations.js",targetClass:"Moderations",baseResource:"moderations",methods:["create"]},{file:"resources/audio/transcriptions.js",targetClass:"Transcriptions",baseResource:"audio.transcriptions",methods:["create"]},{file:"resources/audio/translations.js",targetClass:"Translations",baseResource:"audio.translations",methods:["create"]}];function a(e,t){e.usage=t.usage;for(const r of t.choices){const t=r.index,s=e.choices.find((e=>e?.index===t));if(s){s.finish_reason||(s.finish_reason=r.finish_reason);const e=r.delta;if(e){const t=e.content;t&&(s.delta.content?s.delta.content+=t:s.delta.content=t)}else{const e=r.text;e&&(s.text?s.text+=e:s.text=e)}const t=e&&r.delta.tool_calls;t&&(s.delta.tool_calls=t.map(((e,t)=>{const r=s.delta.tool_calls?.[t];return r?(r.function.arguments+=e.function.arguments,r):e})))}else e.choices[t]=r}}function c(e,t,r,s){let i=!1,o=[];return function(c){return function(){const l=c.apply(this,arguments);return n.wrap(l,"next",(n=>function(){return n.apply(this,arguments).then((n=>{const{done:c,value:l}=n;if(l&&(o.push(l),l instanceof Buffer&&(i=!0)),c){let n={};if(o=o.filter((e=>null!=e)),o&&(i&&(o=function(e=[]){return Buffer.concat(e).toString().split(/(?=data:)/).map((e=>e.split("\n").join(""))).map((e=>e.substring(6))).slice(0,-1).map(JSON.parse)}(o)),o.length)){n={...o[0],choices:Array.from({length:r})};for(let e=0;e<o.length;e++)a(n,o[e])}u(s,{headers:e.headers,data:n,request:{path:e.url,method:t.method}})}return n})).catch((e=>{throw u(s,void 0,e),e}))})),l}}}s({name:"openai",file:"dist/api.js",versions:[">=3.0.0 <4"]},(e=>{const t=Object.getOwnPropertyNames(e.OpenAIApi.prototype);t.shift();for(const r of t)n.wrap(e.OpenAIApi.prototype,r,(e=>function(){if(!i.start.hasSubscribers)return e.apply(this,arguments);const t={methodName:r,args:arguments,basePath:this.basePath,apiKey:this.configuration.apiKey};return i.tracePromise(e,t,this,...arguments)}));return e}));for(const e of o){const{file:t,targetClass:r,baseResource:o,methods:a,versions:p,streamedResponse:d}=e;s({name:"openai",file:t,versions:p||[">=4"]},(e=>{const t=e[r].prototype;for(const e of a)n.wrap(t,e,(t=>function(){if(!i.start.hasSubscribers)return t.apply(this,arguments);const r=d&&l(arguments,"stream",!1);let s;if(r){s=l(arguments,"n",1);const e=l(arguments,"prompt");Array.isArray(e)&&"number"!=typeof e[0]&&(s*=e.length)}const a=this._client||this.client,p={methodName:`${o}.${e}`,args:arguments,basePath:a.baseURL,apiKey:a.apiKey};return i.start.runStores(p,(()=>{const e=t.apply(this,arguments);return n.wrap(e,"parse",(t=>function(){return t.apply(this,arguments).then((e=>Promise.all([this.responsePromise,e]))).then((([{response:e,options:t},i])=>(r?i.iterator?n.wrap(i,"iterator",c(e,t,s,p)):n.wrap(i.response.body,Symbol.asyncIterator,c(e,t,s,p)):u(p,{headers:e.headers,data:i,request:{path:e.url,method:t.method}}),i))).catch((e=>{throw u(p,void 0,e),e})).finally((()=>{n.unwrap(e,"parse")}))})),i.end.publish(p),e}))}));return e}))}function u(e,t,r){r&&(e.error=r,i.error.publish(e)),e.result=t,i.asyncEnd.publish(e)}function l(e,t,r){return e[e.length-1]?.[t]||r}},20879:(e,t,r)=>{"use strict";const{addHook:s}=r(95092),n=r(81444),{createWrapRequest:i,createWrapGetConnection:o}=r(57604);s({name:"@opensearch-project/opensearch",file:"lib/Transport.js",versions:[">=1"]},(e=>(n.wrap(e.prototype,"request",i("opensearch")),n.wrap(e.prototype,"getConnection",o("opensearch")),e)))},40123:(e,t,r)=>{"use strict";const{channel:s,addHook:n,AsyncResource:i}=r(95092),o=r(81444),a=new WeakMap,c=new WeakMap,u=s("apm:oracledb:query:start"),l=s("apm:oracledb:query:error"),p=s("apm:oracledb:query:finish");function d(e){e&&l.publish(e),p.publish(void 0)}n({name:"oracledb",versions:[">=5"]},(e=>(o.wrap(e.Connection.prototype,"execute",(e=>function(t,...r){if(!u.hasSubscribers)return e.apply(this,arguments);if(arguments.length&&"function"==typeof arguments[arguments.length-1]){const e=arguments[arguments.length-1],t=new i("apm:oracledb:outer-scope");arguments[arguments.length-1]=o.wrapFunction(e,(e=>function(r,s){return d(r),t.runInAsyncScope((()=>e.apply(this,arguments)))}))}return new i("apm:oracledb:inner-scope").runInAsyncScope((()=>{const r=a.get(this);u.publish({query:t,connAttrs:r});try{let t=e.apply(this,arguments);return t&&"function"==typeof t.then&&(t=t.then((e=>(d(),e)),(e=>{throw d(e),e}))),t}catch(e){throw l.publish(e),e}}))})),o.wrap(e,"getConnection",(e=>function(t,r){if(!r)return e.apply(this,arguments).then((e=>(a.set(e,t),e)));arguments[1]=o.wrapFunction(r,(e=>(r,s)=>{s&&a.set(s,t),e(r,s)})),e.apply(this,arguments)})),o.wrap(e,"createPool",(e=>function(t,r){if(!r)return e.apply(this,arguments).then((e=>(c.set(e,t),e)));arguments[1]=o.wrapFunction(r,(e=>(r,s)=>{s&&c.set(s,t),e(r,s)})),e.apply(this,arguments)})),o.wrap(e.Pool.prototype,"getConnection",(e=>function(){let t;if("function"==typeof arguments[arguments.length-1]&&(t=arguments[arguments.length-1]),!t)return e.apply(this,arguments).then((e=>(a.set(e,c.get(this)),e)));arguments[arguments.length-1]=o.wrapFunction(t,(e=>(t,r)=>{r&&a.set(r,c.get(this)),e(t,r)})),e.apply(this,arguments)})),e)))},1128:(e,t,r)=>{"use strict";const{addHook:s}=r(95092),n=r(81444),i=r(14508);(process.env.DD_TRACE_OTEL_ENABLED||process.env.OTEL_SDK_DISABLED?!process.env.OTEL_SDK_DISABLED:void 0)&&s({name:"@opentelemetry/sdk-trace-node",file:"build/src/NodeTracerProvider.js",versions:["*"]},(e=>(n.wrap(e,"NodeTracerProvider",(()=>i.TracerProvider)),e)))},37615:(e,t,r)=>{"use strict";const{addHook:s,channel:n}=r(95092),i=r(81444),o=n("apm:paperplane:log"),a=n("apm:paperplane:request:handle"),c=n("apm:paperplane:request:route"),u=Number(process.versions.node.split(".")[0]),l="paperplane",p=u<=12?[">=2.3.2"]:u<=14?[">=3.1.1"]:[],d=e=>t=>{const{original:r,route:s}=t;return c.hasSubscribers&&c.publish({req:r,route:s}),e(t)},h=e=>t=>{const r={message:t};return o.publish(r),e(r.message)},f=e=>t=>{const r=e(t);return function(e,t){return a.publish(e),r.apply(this,arguments)}},g=e=>t=>{const r={};for(const e in t)r[e]=d(t[e]);return e(r)};s({name:l,versions:p,file:"lib/logger.js"},(e=>(i.wrap(e,"logger",h),e))),s({name:l,versions:p,file:"lib/mount.js"},(e=>(i.wrap(e,"mount",f),e))),s({name:l,versions:p,file:"lib/routes.js"},(e=>(i.wrap(e,"routes",g),e))),u<=12&&s({name:l,versions:["2.3.0 - 2.3.1"]},(e=>(i.wrap(e,"mount",f),i.wrap(e,"routes",g),e)))},84746:(e,t,r)=>{"use strict";const{addHook:s}=r(95092),{strategyHook:n}=r(18589);s({name:"passport-http",file:"lib/passport-http/strategies/basic.js",versions:[">=0.3.0"]},n)},45611:(e,t,r)=>{"use strict";const{addHook:s}=r(95092),{strategyHook:n}=r(18589);s({name:"passport-local",file:"lib/strategy.js",versions:[">=1.0.0"]},n)},18589:(e,t,r)=>{"use strict";const s=r(81444),{channel:n}=r(95092),i=n("datadog:passport:verify:finish");function o(e,t,r){return s.wrapFunction(r,(function(r){return function(s,n){if(!s){const r=new AbortController;if(i.publish({framework:e,login:t,user:n,success:!!n,abortController:r}),r.signal.aborted)return}return r.apply(this,arguments)}}))}function a(e){return function(t,r,s,n){if(i.hasSubscribers){const e=`passport-${this.name}`;this._passReqToCallback?arguments[3]=o(e,arguments[1],arguments[3]):arguments[2]=o(e,arguments[0],arguments[2])}return e.apply(this,arguments)}}function c(e){return function(){return"function"==typeof arguments[0]?arguments[0]=a(arguments[0]):arguments[1]=a(arguments[1]),e.apply(this,arguments)}}e.exports={strategyHook:function(e){return s.wrapFunction(e,c)}}},60193:(e,t,r)=>{"use strict";const s=r(81444),{channel:n,addHook:i}=r(95092),o=n("datadog:passport:deserializeUser:finish");function a(e){return function(t,r){if(!t&&r){const e=new AbortController;if(o.publish({user:r,abortController:e}),e.signal.aborted)return}return e.apply(this,arguments)}}function c(e){return function(t,r,s){return"function"==typeof t||("function"==typeof r?arguments[1]=a(s=r):arguments[2]=a(s)),e.apply(this,arguments)}}i({name:"passport",file:"lib/authenticator.js",versions:[">=0.3.0"]},(e=>(s.wrap(e.prototype,"deserializeUser",c),e)))},57562:(e,t,r)=>{"use strict";const{channel:s,addHook:n,AsyncResource:i}=r(95092),o=r(81444),a=s("apm:pg:query:start"),c=s("apm:pg:query:finish"),u=s("apm:pg:query:error"),l=s("datadog:pg:pool:query:start"),p=s("datadog:pg:pool:query:finish");function d(e){return function(){if(!a.hasSubscribers)return e.apply(this,arguments);const t=new i("bound-anonymous-fn"),r=new i("bound-anonymous-fn"),s=this.processID,n=null!==arguments[0]&&"object"==typeof arguments[0]?arguments[0]:{text:arguments[0]},o=Object.getOwnPropertyDescriptor(n,"text");if(!o||o.configurable){const e=n.text;Object.defineProperty(n,"text",{get(){return this?.__ddInjectableQuery||e}})}return r.runInAsyncScope((()=>{const i=new AbortController;a.publish({params:this.connectionParameters,query:n,processId:s,abortController:i});const o=r.bind((function(e,t){e&&u.publish(e),c.publish({result:t?.rows})}));if(i.signal.aborted){const e=i.signal.reason||new Error("Aborted"),t="function"==typeof n.submit,r=arguments[arguments.length-1];return o(e),t?(n.callback||"function"!=typeof r||(n.callback=r),n.callback?n.callback(e):process.nextTick((()=>{n.emit("error",e)})),n):"function"==typeof r?void r(e):Promise.reject(e)}arguments[0]=n;const l=e.apply(this,arguments),p=this.queryQueue||this._queryQueue,d=this.activeQuery||this._activeQuery,h=p[p.length-1]||d;if(!h)return l;if(h.callback){const e=t.bind(h.callback);h.callback=function(t,r){return o(t,r),e.apply(this,arguments)}}else h.once?h.once("error",o).once("end",(e=>o(null,e))):h.then((e=>o(null,e)),o);try{return l}catch(e){u.publish(e)}}))}}n({name:"pg",versions:[">=8.0.3"]},(e=>(o.wrap(e.Client.prototype,"query",(e=>d(e))),o.wrap(e.Pool.prototype,"query",(e=>function(e){return function(){if(!l.hasSubscribers)return e.apply(this,arguments);const t=new i("bound-anonymous-fn"),r=null!==arguments[0]&&"object"==typeof arguments[0]?arguments[0]:{text:arguments[0]};return t.runInAsyncScope((()=>{const s=new AbortController;l.publish({query:r,abortController:s});const n=t.bind((function(){p.publish()})),i=arguments[arguments.length-1];if(s.signal.aborted){const e=s.signal.reason||new Error("Aborted");return n(),"function"==typeof i?void i(e):Promise.reject(e)}"function"==typeof i&&(arguments[arguments.length-1]=o.wrapFunction(i,(e=>function(){return n(),e.apply(this,arguments)})));const a=e.apply(this,arguments);return a&&a.then&&a.then((()=>{n()})).catch((()=>{n()})),a}))}}(e))),e))),n({name:"pg",file:"lib/native/index.js",versions:[">=8.0.3"]},(e=>(o.wrap(e.prototype,"query",(e=>d(e))),e)))},46755:(e,t,r)=>{"use strict";const{channel:s,addHook:n}=r(95092),i=r(81444);function o(e,t,r){return function(){const s=r.apply(this,arguments);return Object.defineProperty(s,e,{configurable:!0,enumerable:!0,writable:!0,value:t(s[e])}),s}}function a(e){const t=s("apm:pino:log");return function(r,s,n,i){const o={message:r=arguments[0]=r||{}};return t.publish(o),arguments[0]=o.message,e.apply(this,arguments)}}function c(e){const t=s("apm:pino:log");return function(){let r={};e&&(r=e.apply(this,arguments));const s={message:r};return t.publish(s),s.message}}function u(e){const t=s("apm:pino:log");return function(r){const s={message:r.input};return t.publish(s),r.input=s.message,e.apply(this,arguments)}}function l(e){const t=s("apm:pino:log");return function(){const r=e.apply(this,arguments);return function(e){const s={message:e};return t.publish(s),arguments[0]=s.message,r.apply(this,arguments)}}}n({name:"pino",versions:["2 - 3","4",">=5 <5.14.0"]},(e=>{const t=e.symbols&&e.symbols.asJsonSym||"asJson";return i.wrapFunction(e,(e=>o(t,a,e)))})),n({name:"pino",versions:[">=5.14.0 <6.8.0"]},(e=>{const t=e.symbols.mixinSym;return i.wrapFunction(e,(e=>o(t,c,e)))})),n({name:"pino",versions:[">=6.8.0"]},(e=>{const t=e.symbols.mixinSym,r=i.wrapFunction(e,(e=>o(t,c,e)));return r.pino=r,r.default=r,r})),n({name:"pino-pretty",file:"lib/utils.js",versions:[">=3"]},(e=>(i.wrap(e,"prettifyObject",u),e))),n({name:"pino-pretty",versions:["1 - 2"]},(e=>i.wrapFunction(e,l)))},99668:(e,t,r)=>{const s=r(99589),{addHook:n,channel:i,AsyncResource:o}=r(95092),a=r(81444),{parseAnnotations:c,getTestSuitePath:u}=r(97507),l=r(75004),p=i("ci:playwright:test:start"),d=i("ci:playwright:test:finish"),h=i("ci:playwright:session:start"),f=i("ci:playwright:session:finish"),g=i("ci:playwright:library-configuration"),m=i("ci:playwright:known-tests"),_=i("ci:playwright:test-suite:start"),y=i("ci:playwright:test-suite:finish"),b=new WeakMap,v=new Map,E=new Map,S=new Map,T=new o("bound-anonymous-fn");let w=null,x=[];const A={passed:"pass",failed:"fail",timedOut:"fail",skipped:"skip"};let I={},k=!1,O=!1,R=0,C=!1,N=0,P={},D="";const L="1.38.0";function M(e){const t=u(e._requireFile,D);return!(P?.playwright?.[t]||[]).includes(z(e))}function q(e,t){let r=e.parent;for(;r&&r._type!==t;)r=r.parent;return r}function j(e,t){const r=e._clone();for(const s of e._entries)if("Suite"===s.constructor.name)r._addSuite(j(s,t));else if(t(s)){const e=s._clone();e._ddIsNew=!0,e._ddIsEfdRetry=!0,r._addTest(e)}return r}function U(e){try{return e._configLoader.fullConfig()}catch(t){try{return e._loader.fullConfig()}catch(t){return e._config||{}}}}function F(e){const t=e._config?.config?.projects;return t||e._loader?.fullConfig()?.projects}function B(e,t){if(!e||!t)return null;const{_projectIndex:r,_projectId:s}=t;return void 0!==r?e[r]?.name:e.find((({__projectId:e,_id:t,name:r})=>void 0!==e?e===s:void 0!==t?t===s:r===s))?.name}function $(e,t){S.has(e)?S.get(e).push(t):S.set(e,[t])}function G(e,t){if(e._testById)return e._testById.get(t)?.test;const r=e._allTests||e._ddAllTests;return r?r.find((({id:e})=>e===t)):void 0}function V(e){return new Promise((t=>{T.runInAsyncScope((()=>{e.publish({onDone:t})}))}))}function z(e){let t=e.parent;const r=[e.title];for(;"describe"===t?._type||t?._isDescribe;)t.title&&r.unshift(t.title),t=t.parent;return r.join(" ")}function H(e,t){const{_requireFile:r,_type:s,location:{line:n}}=e;if("beforeAll"===s||"afterAll"===s)return;const i=z(e);if(!x.includes(r)){x.push(r);const e=new o("bound-anonymous-fn");v.set(r,e),e.runInAsyncScope((()=>{_.publish(r)}))}const a=new o("bound-anonymous-fn");b.set(e,a),a.runInAsyncScope((()=>{p.publish({testName:i,testSuiteAbsolutePath:r,testSourceLine:n,browserName:t})}))}function K(e,t,r,s,n){let i;t.length&&(i=c(t));const{_requireFile:o,results:a,_type:u}=e;if("beforeAll"===u||"afterAll"===u){const e=function(e,t,r){let s=e;return e&&(s.message=`Error in ${t} hook: ${e.message}`),!s&&r&&(s=new Error(`${t} hook timed out`)),s}(s,u,n);return void(e&&$(o,e))}const l=a[a.length-1];if(b.get(e).runInAsyncScope((()=>{d.publish({testStatus:r,steps:l?.steps||[],isRetry:l?.retry>0,error:s,extraTags:i,isNew:e._ddIsNew,isEfdRetry:e._ddIsEfdRetry})})),E.has(o)?E.get(o).push(r):E.set(o,[r]),s&&$(o,s),function(e,t){return"fail"===t&&e.results.length<=e.retries}(e,r)||(I[o]=I[o].filter((t=>t!==e))),!I[o].length){const e=E.get(o);let t="pass";e.some((e=>"fail"===e))?t="fail":e.every((e=>"skip"===e))&&(t="skip");const r=function(e){const t=S.get(e);return t?1===t.length?t[0]:new Error(`${t.length} errors in this test suite:\n${t.map((e=>e.message)).join("\n------\n")}`):null}(o);v.get(o).runInAsyncScope((()=>{y.publish({status:t,error:r})}))}}function Y(e){return function(){return I=function(e){const t={};for(const{test:r}of e.values()){const{_requireFile:e}=r;"beforeAll"!==r._type&&"afterAll"!==r._type&&(t[e]?t[e].push(r):t[e]=[r])}return t}(this._testById),e.apply(this,arguments)}}function Q(e){return function(t){return this._allTests||(this._ddAllTests=t.map((e=>e.tests)).flat()),I=function(e){return e.reduce(((e,{requireFile:t,tests:r})=>(e[t]?e[t]=e[t].concat(r):e[t]=r,e)),{})}(arguments[0]),e.apply(this,arguments)}}function W(e,t){return a.wrap(e.Dispatcher.prototype,"run",t),a.wrap(e.Dispatcher.prototype,"_createWorker",(e=>function(){const t=this,r=e.apply(this,arguments);return r.on("testBegin",(({testId:e})=>{const r=G(t,e);H(r,B(F(t),r))})),r.on("testEnd",(({testId:e,status:r,errors:s,annotations:n})=>{const i="timedOut"===r;K(G(t,e),n,A[r],s&&s[0],i)})),r})),e}function Z(e,t){return a.wrap(e.Runner.prototype,"runAllTests",(e=>async function(){let r;D=function(e){const t=U(e);return t.rootDir?t.rootDir:e._configDir?e._configDir:e._config&&e._config.config?.rootDir||process.cwd()}(this);const n=`playwright ${process.argv.slice(2).join(" ")}`;T.runInAsyncScope((()=>{h.publish({command:n,frameworkVersion:t,rootDir:D})}));try{const{err:e,libraryConfig:t}=await V(g);e||(k=t.isKnownTestsEnabled,O=t.isEarlyFlakeDetectionEnabled,R=t.earlyFlakeDetectionNumRetries,C=t.isFlakyTestRetriesEnabled,N=t.flakyTestRetriesCount)}catch(e){O=!1,k=!1,l.error("Playwright session start error",e)}if(k&&s.gte(t,L))try{const{err:e,knownTests:t}=await V(m);e?(O=!1,k=!1):P=t}catch(e){O=!1,k=!1,l.error("Playwright known tests error",e)}const i=function(e){const t=U(e);return t.projects?.map((e=>e.project?e.project:e))}(this);C&&N>0&&i.forEach((e=>{0===e.retries&&(e.retries=N)}));const o=await e.apply(this,arguments);Object.values(I).forEach((e=>{e.forEach((e=>{H(e,B(i,e)),K(e,[],"skip")}))}));const a=o.status||o,c=new Promise((e=>{r=e}));return T.runInAsyncScope((()=>{f.publish({status:A[a],isEarlyFlakeDetectionEnabled:O,onDone:r})})),await c,x=[],I={},o})),e}n({name:"@playwright/test",file:"lib/runner.js",versions:[">=1.18.0 <=1.30.0"]},Z),n({name:"@playwright/test",file:"lib/dispatcher.js",versions:[">=1.18.0 <1.30.0"]},(function(e){return a.wrap(e.Dispatcher.prototype,"run",Y),a.wrap(e.Dispatcher.prototype,"_createWorker",(e=>function(){const t=this,r=e.apply(this,arguments);return r.process.on("message",(({method:e,params:r})=>{if("testBegin"===e){const{test:e}=t._testById.get(r.testId);H(e,B(F(t),e))}else if("testEnd"===e){const{test:e}=t._testById.get(r.testId),{results:s}=e,n=s[s.length-1],i="timedOut"===n.status;K(e,r.annotations,A[n.status],n.error,i)}})),r})),e})),n({name:"@playwright/test",file:"lib/dispatcher.js",versions:[">=1.30.0 <1.31.0"]},(e=>W(e,Y))),n({name:"@playwright/test",file:"lib/runner/dispatcher.js",versions:[">=1.31.0 <1.38.0"]},(e=>W(e,Q))),n({name:"@playwright/test",file:"lib/runner/runner.js",versions:[">=1.31.0 <1.38.0"]},Z),n({name:"playwright",file:"lib/runner/runner.js",versions:[">=1.38.0"]},Z),n({name:"playwright",file:"lib/runner/dispatcher.js",versions:[">=1.38.0"]},(e=>W(e,Q))),n({name:"playwright",file:"lib/common/suiteUtils.js",versions:[`>=${L}`]},(e=>(w=e.applyRepeatEachIndex,e))),n({name:"playwright",file:"lib/runner/loadUtils.js",versions:[`>=${L}`]},(e=>{const t=e.createRootSuite;return e.createRootSuite=async function(){const e=await t.apply(this,arguments);return k?(e.allTests().filter(M).forEach((e=>{if(e._ddIsNew=!0,O&&"skipped"!==e.expectedStatus){const t=q(e,"file"),r=q(e,"project");for(let e=0;e<R;e++){const s=j(t,M);w(r._fullProject,s,e+1),r._addSuite(s)}}})),e):e},e}))},44962:(e,t,r)=>{"use strict";const s=r(81444),{channel:n}=r(1247),i=n("datadog:process:setUncaughtExceptionCaptureCallback:start");if(process.setUncaughtExceptionCaptureCallback){let e;s.wrap(process,"setUncaughtExceptionCaptureCallback",(function(t){return function(r){if(i.hasSubscribers){const t=new AbortController;if(i.publish({newCallback:r,currentCallback:e,abortController:t}),t.signal.aborted)return}const s=t.apply(this,arguments);return e=r,s}}))}},87196:(e,t,r)=>{"use strict";const{addHook:s}=r(95092),{wrapThen:n}=r(30060),i=r(81444);s({name:"promise-js",versions:[">=0.0.3"]},(e=>(e!==global.Promise&&i.wrap(e.prototype,"then",n),e)))},88038:(e,t,r)=>{"use strict";const{addHook:s}=r(95092),{wrapThen:n}=r(30060),i=r(81444);s({name:"promise",file:"lib/core.js",versions:[">=7"]},(e=>(i.wrap(e.prototype,"then",n),e)))},71335:(e,t,r)=>{const s=r(81444),{addHook:n}=r(95092),i=r(1247),o=i.channel("apm:protobufjs:serialize-start"),a=i.channel("apm:protobufjs:deserialize-end");function c(e){e?.setup&&s.wrap(e,"setup",(t=>function(){const r=t.apply(this,arguments);return function(e){e?.encode&&s.wrap(e,"encode",(e=>function(){return o.hasSubscribers?(o.publish({messageClass:this}),e.apply(this,arguments)):e.apply(this,arguments)}))}(e),function(e){e?.decode&&s.wrap(e,"decode",(e=>function(){if(!a.hasSubscribers)return e.apply(this,arguments);const t=e.apply(this,arguments);return a.publish({messageClass:t}),t}))}(e),r}))}function u(e){if(e&&(e.decode&&c(e),e.nestedArray))for(const t of e.nestedArray)u(t)}n({name:"protobufjs",versions:[">=6.8.0"]},(e=>(s.wrap(e.Root.prototype,"load",(e=>function(){const t=e.apply(this,arguments);return!(r=t)||"object"!=typeof r&&"function"!=typeof r||"function"!=typeof r.then?(u(t),t):t.then((e=>(u(e),e)));var r})),s.wrap(e.Root.prototype,"loadSync",(e=>function(){const t=e.apply(this,arguments);return u(t),t})),s.wrap(e,"Type",(e=>function(){const t=new e(...arguments);return c(t),t})),function(e){[{target:e.Root,name:"fromJSON"},{target:e.Type.prototype,name:"fromObject"}].forEach((e=>{s.wrap(e.target,e.name,(e=>function(){const t=e.apply(this,arguments);if(t.nested)for(const e in t.nested)c(t.nested[e]);return t.$type&&c(t.$type),t}))}))}(e),e)))},81419:(e,t,r)=>{"use strict";const s=r(81444),{channel:n,addHook:i}=r(95092),o=n("datadog:pug:compile:start");function a(e){return function(t){return o.hasSubscribers&&o.publish({source:t}),e.apply(this,arguments)}}i({name:"pug",versions:[">=2.0.4"]},(e=>(s.wrap(e,"compile",a),s.wrap(e,"compileClientWithDependenciesTracked",a),e)))},20012:(e,t,r)=>{"use strict";const{addHook:s}=r(95092),{wrapThen:n}=r(30060),i=r(81444);s({name:"q",versions:["1"]},(e=>(i.wrap(e.makePromise.prototype,"then",n),e))),s({name:"q",versions:[">=2"]},(e=>(i.wrap(e.Promise.prototype,"then",n),e)))},6692:(e,t,r)=>{"use strict";const{channel:s,addHook:n,AsyncResource:i}=r(95092),o=r(81444),a=s("apm:redis:command:start"),c=s("apm:redis:command:finish"),u=s("apm:redis:command:error");let l;function p(e){return function(t){if(!a.hasSubscribers)return e.apply(this,arguments);const r=t[0],s=t.slice(1),n=new i("bound-anonymous-fn");return n.runInAsyncScope((()=>{f(this,r,s,this._url);const t=e.apply(this,arguments),i=n.bind((()=>m(c,u))),o=n.bind((e=>m(c,u,e)));return t.then(i,o),t}))}}function d(e){return class extends e{constructor(){if(super(arguments),l)try{const e=new URL(l);e&&(this._url={host:e.hostname,port:+e.port||6379})}catch(e){}this._url=this._url||{host:"localhost",port:6379}}}}function h(e){return function(t){l=t&&t.url;const r=e.apply(this,arguments);return l=void 0,r}}function f(e,t,r,s={}){const n=e.selected_db,i=e.connection_options||e.connection_option||e.connectionOption||s;a.publish({db:n,command:t,args:r,connectionOptions:i})}function g(e,t,r){return o.wrapFunction(r,(r=>function(s){if(m(e,t,s),r)return r.apply(this,arguments)}))}function m(e,t,r){r&&t.publish(r),e.publish()}n({name:"@node-redis/client",file:"dist/lib/client/commands-queue.js",versions:[">=1"]},(e=>(e.default=d(e.default),o.wrap(e.default.prototype,"addCommand",p),e))),n({name:"@node-redis/client",file:"dist/lib/client/index.js",versions:[">=1"]},(e=>(o.wrap(e.default,"create",h),e))),n({name:"@redis/client",file:"dist/lib/client/index.js",versions:[">=1.1"]},(e=>(o.wrap(e.default,"create",h),e))),n({name:"@redis/client",file:"dist/lib/client/commands-queue.js",versions:[">=1.1"]},(e=>(e.default=d(e.default),o.wrap(e.default.prototype,"addCommand",p),e))),n({name:"redis",versions:[">=2.6 <4"]},(e=>(o.wrap(e.RedisClient.prototype,"internal_send_command",(e=>function(t){if(!a.hasSubscribers)return e.apply(this,arguments);if(!t.callback)return e.apply(this,arguments);const r=new i("bound-anonymous-fn"),s=new i("bound-anonymous-fn"),n=r.bind(t.callback);return s.runInAsyncScope((()=>{f(this,t.command,t.args),t.callback=s.bind(g(c,u,n));try{return e.apply(this,arguments)}catch(e){throw u.publish(e),e}}))})),e))),n({name:"redis",versions:[">=0.12 <2.6"]},(e=>(o.wrap(e.RedisClient.prototype,"send_command",(e=>function(t,r,s){if(!a.hasSubscribers)return e.apply(this,arguments);const n=new i("bound-anonymous-fn"),o=new i("bound-anonymous-fn");return o.runInAsyncScope((()=>{if(f(this,t,r),"function"==typeof s){const e=n.bind(s);arguments[2]=o.bind(g(c,u,e))}else if(Array.isArray(r)&&"function"==typeof r[r.length-1]){const e=n.bind(r[r.length-1]);r[r.length-1]=o.bind(g(c,u,e))}else arguments[2]=o.bind(g(c,u));try{return e.apply(this,arguments)}catch(e){throw u.publish(e),e}}))})),e)))},11907:(e,t,r)=>{"use strict";const s=r(81444),{addHook:n,channel:i}=r(95092),o=["use","pre"],a=["del","get","head","opts","post","put","patch"],c=i("apm:restify:request:handle"),u=i("apm:restify:middleware:error"),l=i("apm:restify:middleware:enter"),p=i("apm:restify:middleware:exit"),d=i("apm:restify:middleware:finish"),h=i("apm:restify:middleware:next");function f(e){return function(t,r){return c.publish({req:t,res:r}),e.apply(this,arguments)}}function g(e){return function(t){const r=_(Array.prototype.slice.call(arguments,1));return e.apply(this,[t].concat(r))}}function m(e){return function(){return e.apply(this,_(arguments))}}function _(e){return Array.prototype.map.call(e,y)}function y(e){return Array.isArray(e)?_(e):s.wrapFunction(e,(e=>function(t,r,n){"function"==typeof n&&(arguments[2]=function(e,t){return s.wrapFunction(t,(t=>function(){h.publish({req:e}),d.publish({req:e}),t.apply(this,arguments)}))}(t,n));const i=t.route&&t.route.path;l.publish({req:t,route:i});try{const r=e.apply(this,arguments);return null!==r&&"object"==typeof r&&"function"==typeof r.then?r.then((function(){return h.publish({req:t}),d.publish({req:t}),arguments[0]})).catch((function(e){throw u.publish({req:t,error:e}),h.publish({req:t}),d.publish({req:t}),e})):r}catch(e){throw u.publish({req:t,error:e}),h.publish({req:t}),d.publish({req:t}),e}finally{p.publish({req:t})}}))}n({name:"restify",versions:[">=3"],file:"lib/server.js"},(e=>(s.wrap(e.prototype,"_setupRequest",f),s.massWrap(e.prototype,o,m),s.massWrap(e.prototype,a,g),e)))},87455:(e,t,r)=>{"use strict";const{channel:s,addHook:n,AsyncResource:i}=r(95092),o=r(81444),a=Symbol("circularBufferConstructor"),c=Symbol("inFlightDeliveries"),u=new WeakSet,l=s("apm:rhea:send:start"),p=s("apm:rhea:send:encode"),d=s("apm:rhea:send:error"),h=s("apm:rhea:send:finish"),f=s("apm:rhea:receive:start"),g=s("apm:rhea:receive:dispatch"),m=s("apm:rhea:receive:error"),_=s("apm:rhea:receive:finish"),y=new WeakMap;function b(e){return e.connection&&e.session&&e.session.outgoing}function v(e,t){let r=e[c];r||(r=new Set,e[c]=r),r.add(t)}n({name:"rhea",versions:[">=1"]},(e=>(o.wrap(e.message,"encode",(e=>function(t){return p.publish(t),e.apply(this,arguments)})),e))),n({name:"rhea",versions:[">=1"],file:"lib/link.js"},(e=>{const t=e.Sender,r=e.Receiver;return o.wrap(t.prototype,"send",(e=>function(t,r,s){if(!b(this))return e.apply(this,arguments);const{host:n,port:o}=function(e){let t,r;return e&&e.options&&(t=e.options.host,r=e.options.port),{host:t,port:r}}(this.connection),a=this.options&&this.options.target&&this.options.target.address?this.options.target.address:void 0,c=new i("bound-anonymous-fn");return c.runInAsyncScope((()=>{l.publish({targetAddress:a,host:n,port:o,msg:t});const r=e.apply(this,arguments),s={asyncResource:c,connection:this.connection};y.set(r,s),v(this.connection,r);try{return r}catch(e){throw d.publish(e),e}}))})),o.wrap(r.prototype,"dispatch",(e=>function(t,r){if(!b(this))return e.apply(this,arguments);if("message"===t&&r){const t=new i("bound-anonymous-fn");return t.runInAsyncScope((()=>{if(f.publish({msgObj:r,connection:this.connection}),r.delivery){const e={asyncResource:t,connection:this.connection};y.set(r.delivery,e),r.delivery.update=function(e,t){const r=y.get(e).asyncResource;if(e&&r){const e=r.bind(t);return o.wrapFunction(e,(e=>i.bind((function(t,r){const s=function(e){if(e&&e.descriptor&&e.descriptor)switch(e.descriptor.value){case 36:return"accepted";case 37:return"rejected";case 38:return"released";case 39:return"modified"}}(r);return g.publish({state:s}),e.apply(this,arguments)}))))}return function(e,r){return t.apply(this,arguments)}}(r.delivery,r.delivery.update),v(this.connection,r.delivery)}try{return e.apply(this,arguments)}catch(e){throw m.publish(e),e}}))}return e.apply(this,arguments)})),e})),n({name:"rhea",versions:[">=1"],file:"lib/connection.js"},(e=>(o.wrap(e.prototype,"dispatch",(e=>function(r,s){if("disconnected"===r){const e=s.error||this.saved_error;this[c]&&this[c].forEach((r=>{const s=y.get(r),n=s&&s.asyncResource;n&&n.runInAsyncScope((()=>{m.publish(e),t.beforeFinish(r,null),_.publish()}))}))}return e.apply(this,arguments)})),e))),n({name:"rhea",versions:[">=1"],file:"lib/session.js"},(e=>{var r;return r=e.prototype,Object.defineProperty(r,"outgoing",{configurable:!0,get(){},set(e){if(delete r.outgoing,this.outgoing=e,e){let s;if(e.deliveries&&(s=e.deliveries.constructor),s&&!u.has(s.prototype)){o.wrap(s.prototype,"pop_if",(e=>function(r){return arguments[0]=o.wrapFunction(r,(e=>i.bind((function(r){const s=y.get(r),n=s&&s.asyncResource;if(!n)return e(r);const i=n.runInAsyncScope((()=>e(r)));if(i){const e=r.remote_state,s=e&&e.constructor?r.remote_state.constructor.composite_type:void 0;n.runInAsyncScope((()=>{t.beforeFinish(r,s),h.publish()}))}return i})))),e.apply(this,arguments)})),u.add(s.prototype);const e=r.constructor;e&&(e[a]=s)}}}}),e})),e.exports.inFlightDeliveries=c,e.exports.beforeFinish=function(e,t){const r=y.get(e);r&&(t&&g.publish({state:t}),r.connection&&r.connection[c]&&r.connection[c].delete(e))},e.exports.contexts=y},86658:(e,t,r)=>{"use strict";const s=r(58611).METHODS.map((e=>e.toLowerCase())).concat("all"),n=r(35302),i=r(81444),{addHook:o,channel:a}=r(95092);function c(e){const t=a(`apm:${e}:middleware:enter`),r=a(`apm:${e}:middleware:exit`),o=a(`apm:${e}:middleware:finish`),c=a(`apm:${e}:middleware:error`),u=a(`apm:${e}:middleware:next`),l=new WeakMap,p=Object.create(null);function d(e,s){s._name=s._name||e.name;const n=i.wrapFunction(s,(s=>function(){if(!t.hasSubscribers)return s.apply(this,arguments);const n=l.get(e),a=arguments.length-1,p=s._name||s.name,d=arguments[arguments.length>3?1:0],h=arguments[a];let f;if("function"==typeof h&&(arguments[a]=function(e,t){return i.wrapFunction(t,(t=>function(r){r&&"route"!==r&&"router"!==r&&c.publish({req:e,error:r}),u.publish({req:e}),o.publish({req:e}),t.apply(this,arguments)}))}(d,h)),n)for(let t=0;t<n.length;t++)if(n[t].test(e)){f=n[t].path;break}t.publish({name:p,req:d,route:f});try{return s.apply(this,arguments)}catch(e){throw c.publish({req:d,error:e}),u.publish({req:d}),o.publish({req:d}),e}finally{r.publish({req:d})}}));return n._datadog_orig=s,n}function h(e){const t=f([].concat(e));return"function"==typeof t[0]?[]:t.map((e=>({path:e instanceof RegExp?`(${e})`:e,test:t=>{const r=l.get(t);return!function(e,t){return void 0!==e.regexp?.fast_star?e.regexp.fast_star:t.some((e=>"*"===e.path))}(t,r)&&!function(e,t){return void 0!==e.regexp?.fast_slash?e.regexp.fast_slash:t.some((e=>"/"===e.path))}(t,r)&&function(e){const t=p[e];if(t)return t;const r=n(e);return p[e]=r,r}(e).test(t.path)}})))}function f(e){return e.reduce(((e,t)=>Array.isArray(t)?e.concat(f(t)):e.concat(t)),[])}return function e(t){return i.wrapFunction(t,(t=>function(r){const n=this.stack?[].concat(this.stack).length:0,i=t.apply(this,arguments);return"function"==typeof this.stack&&(this.stack=[{handle:this.stack}]),function(t,r,n){[].concat(t).slice(r).forEach((t=>{t.__handle?t.__handle=d(t,t.__handle):t.handle=d(t,t.handle),l.set(t,n),t.route&&s.forEach((r=>{"function"==typeof t.route.stack&&(t.route.stack=[{handle:t.route.stack}]),t.route[r]=e(t.route[r])}))}))}(this.stack,n,h(r)),i}))}}const u=c("router");o({name:"router",versions:[">=1 <2"]},(e=>(i.wrap(e.prototype,"use",u),i.wrap(e.prototype,"route",u),e)));const l=a("datadog:query:read:finish");o({name:"router",versions:[">=2"]},(e=>{const t=i.wrapFunction(e,(function(e){return function(){const t=e.apply(this,arguments);return i.wrap(t,"handle",(function(e){return function(t,r,s){const n=new AbortController;if(!(l.hasSubscribers&&t&&(l.publish({req:t,res:r,query:t.query,abortController:n}),n.signal.aborted)))return e.apply(this,arguments)}})),t}}));return i.wrap(t.prototype,"use",u),i.wrap(t.prototype,"route",u),t}));const p=a("datadog:router:param:start"),d=new WeakSet;function h(e){return function(t,r,s){if(p.hasSubscribers&&Object.keys(t.params).length&&!d.has(t.params)){d.add(t.params);const e=new AbortController;if(p.publish({req:t,res:r,params:t?.params,abortController:e}),e.signal.aborted)return}return e.apply(this,arguments)}}function f(e){return function(){return arguments[1]=i.wrapFunction(arguments[1],(e=>function(t,r){if(p.hasSubscribers&&Object.keys(t.params).length&&!d.has(t.params)){d.add(t.params);const e=new AbortController;if(p.publish({req:t,res:r,params:t?.params,abortController:e}),e.signal.aborted)return}return e.apply(this,arguments)})),e.apply(this,arguments)}}o({name:"router",file:"lib/layer.js",versions:[">=2"]},(e=>(i.wrap(e.prototype,"handleRequest",h),e))),o({name:"router",versions:[">=2"]},(e=>(i.wrap(e.prototype,"param",f),e))),e.exports={createWrapRouterMethod:c}},48055:(e,t,r)=>{const{addHook:s,channel:n}=r(95092),i=r(81444),o=n("ci:selenium:driver:get"),a="datadog-ci-visibility-test-execution-id";s({name:"selenium-webdriver",versions:[">=4.11.0"]},((e,t)=>(i.wrap(e.WebDriver.prototype,"get",(e=>async function(){if(!o.hasSubscribers)return e.apply(this,arguments);let r;const s=await e.apply(this,arguments),n=await this.executeScript("return !!window.DD_RUM"),i=await this.getCapabilities();return o.publish({setTraceId:e=>{r=e},seleniumVersion:t,browserName:i.getBrowserName(),browserVersion:i.getBrowserVersion(),isRumActive:n}),r&&n&&await this.manage().addCookie({name:a,value:r}),s})),i.wrap(e.WebDriver.prototype,"quit",(e=>async function(){return o.hasSubscribers?(await this.executeScript("\nif (window.DD_RUM && window.DD_RUM.stopSession) {\n  window.DD_RUM.stopSession();\n  return true;\n} else {\n  return false;\n}\n")&&(await new Promise((e=>{setTimeout((()=>{e()}),500)})),await this.manage().deleteCookie(a)),e.apply(this,arguments)):e.apply(this,arguments)})),e)))},82864:(e,t,r)=>{"use strict";const{channel:s,addHook:n,AsyncResource:i}=r(95092),o=r(81444);n({name:"sequelize",versions:[">=4"]},(e=>{const t=s("datadog:sequelize:query:start"),r=s("datadog:sequelize:query:finish");return o.wrap(e.prototype,"query",(e=>function(s,n){if(!t.hasSubscribers)return e.apply(this,arguments);const o=new i("bound-anonymous-fn");let a;function c(e){"RAW"===(n?.type||"RAW")&&e?.length>1&&(e=e[0]),o.bind((function(){r.publish({result:e})}),this).apply(this)}return this.options&&this.options.dialect?a=this.options.dialect:this.dialect&&this.dialect.name&&(a=this.dialect.name),o.bind((function(){t.publish({sql:s,dialect:a});const r=e.apply(this,arguments);return r.then(c,(()=>{c()})),r}),this).apply(this,arguments)})),e}))},51826:(e,t,r)=>{"use strict";const{channel:s,addHook:n,AsyncResource:i}=r(95092),o=r(81444),a={hs:"handshake",qf:"query-fetch",qs:"query-subscribe",qu:"query-unsubscribe",bf:"bulk-fetch",bs:"bulk-subscribe",bu:"bulk-unsubscribe",f:"fetch",s:"subscribe",u:"unsubscribe",op:"op",nf:"snapshot-fetch",nt:"snapshot-fetch-by-ts",p:"presence-broadcast",pr:"presence-request",ps:"presence-subscribe",pu:"presence-unsubscribe"};n({name:"sharedb",versions:[">=1"],file:"lib/agent.js"},(e=>{const t=s("apm:sharedb:request:start"),r=s("apm:sharedb:request:finish"),n=s("apm:sharedb:request:error");return o.wrap(e.prototype,"_handleMessage",(e=>function(s,c){const u=new i("bound-anonymous-fn"),l=new i("bound-anonymous-fn"),p=function(e){const t=a[e];return void 0===t?e:t}(s.a);return l.runInAsyncScope((()=>{t.publish({actionName:p,request:s}),c=u.bind(c),arguments[1]=o.wrapFunction(c,(e=>l.bind((function(t,i){return t&&n.publish(t),r.publish({request:s,res:i}),e.apply(this,arguments)}))));try{return e.apply(this,arguments)}catch(e){throw n.publish(e),e}}))})),e}))},810:(e,t,r)=>{"use strict";const{channel:s,addHook:n,AsyncResource:i}=r(95092),o=r(81444);n({name:"tedious",versions:[">=1.0.0"]},(e=>{const t=s("apm:tedious:request:start"),r=s("apm:tedious:request:finish"),n=s("apm:tedious:request:error");return o.wrap(e.Connection.prototype,"makeRequest",(e=>function(s){if(!t.hasSubscribers)return e.apply(this,arguments);const o=function(e){if(!e.parameters)return;const t=e.parametersByName.statement||e.parametersByName.stmt;return t?t.value:e.sqlTextOrProcedure}(s);if(!o)return e.apply(this,arguments);const a=new i("bound-anonymous-fn"),c=new i("bound-anonymous-fn"),u=this.config;return c.runInAsyncScope((()=>{t.publish({queryOrProcedure:o,connectionConfig:u});const i=a.bind(s.callback,s);s.callback=c.bind((function(e){return e&&n.publish(e),r.publish(void 0),i.apply(this,arguments)}),null,s);try{return e.apply(this,arguments)}catch(e){throw n.publish(e),e}}))})),e}))},36303:(e,t,r)=>{"use strict";const{addHook:s}=r(95092),n=r(81444),i=(0,r(1247).tracingChannel)("apm:undici:fetch"),{createWrapFetch:o}=r(69189);s({name:"undici",versions:["^4.4.1","5",">=6.0.0"]},(e=>n.wrap(e,"fetch",o(e.Request,i))))},56878:(e,t,r)=>{"use strict";const{addHook:s,channel:n}=r(95092),i=r(81444),o=n("datadog:url:parse:finish"),a=n("datadog:url:getter:finish"),c=["host","origin","hostname"];s({name:["url","node:url"]},(function(e){i.wrap(e,"parse",(e=>function(t){const r=e.apply(this,arguments);return o.hasSubscribers?(o.publish({input:t,parsed:r,isURL:!1}),r):r}));const t=e.URL.prototype.constructor.prototype;return c.forEach((e=>{const r=Object.getOwnPropertyDescriptor(t,e);if(r?.get){const s=i.wrap(r,"get",(function(t){return function(){const r=t.apply(this,arguments);if(!a.hasSubscribers)return r;const s={urlObject:this,result:r,property:e};return a.publish(s),s.result}}));Object.defineProperty(t,e,s)}})),i.wrap(e,"URL",(e=>class extends e{constructor(e,t){super(...arguments),o.hasSubscribers&&o.publish({input:e,base:t,parsed:this,isURL:!0})}static[Symbol.hasInstance](t){return t instanceof e}})),e.URL.parse&&i.wrap(e.URL,"parse",(e=>function(t,r){const s=e.apply(this,arguments);return o.hasSubscribers?(o.publish({input:t,base:r,parsed:s,isURL:!0}),s):s})),e}))},69657:e=>{"use strict";e.exports=function(e){const t=e.lastIndexOf("node_modules/");if(t<0)return{pkg:null,path:null};const r=e.substring(t+13),s=r.indexOf("/"),n=e.substring(e[0],t+13);if("@"===r[0]){const e=r.substring(s+1).indexOf("/");return{pkg:r.substring(0,s+1+e),path:r.substring(s+1+e+1),pkgJson:n+r.substring(0,s+1+e)+"/package.json"}}return{pkg:r.substring(0,s),path:r.substring(s+1),pkgJson:n+r.substring(0,s)+"/package.json"}}},48502:(e,t,r)=>{const{addHook:s,channel:n,AsyncResource:i}=r(95092),o=r(81444),a=r(75004),c=n("ci:vitest:test:start"),u=n("ci:vitest:test:finish-time"),l=n("ci:vitest:test:pass"),p=n("ci:vitest:test:error"),d=n("ci:vitest:test:skip"),h=n("ci:vitest:test:is-new"),f=n("ci:vitest:test-suite:start"),g=n("ci:vitest:test-suite:finish"),m=n("ci:vitest:test-suite:error"),_=n("ci:vitest:session:start"),y=n("ci:vitest:session:finish"),b=n("ci:vitest:library-configuration"),v=n("ci:vitest:known-tests"),E=n("ci:vitest:is-early-flake-detection-faulty"),S=new WeakMap,T=new WeakMap,w=new WeakSet;let x=!1;const A=new WeakSet,I=new i("bound-anonymous-fn");function k(){return new Promise((e=>{setTimeout((()=>{e()}),400)}))}function O(){try{const{_ddIsEarlyFlakeDetectionEnabled:e,_ddIsDiEnabled:t,_ddKnownTests:r,_ddEarlyFlakeDetectionNumRetries:s,_ddIsKnownTestsEnabled:n}=globalThis.__vitest_worker__.providedContext;return{isDiEnabled:t,isEarlyFlakeDetectionEnabled:e,knownTests:r,numRepeats:s,isKnownTestsEnabled:n}}catch(e){return a.error("Vitest workers could not parse provided context, so some features will not work."),{isDiEnabled:!1,isEarlyFlakeDetectionEnabled:!1,knownTests:{},numRepeats:0,isKnownTestsEnabled:!1}}}function R(e){return new Promise((t=>{I.runInAsyncScope((()=>{e.publish({onDone:t})}))}))}function C(e,t="test"){const r=[];return function e(s){for(const n of s)n.type===t?r.push(n):n.tasks&&e(n.tasks)}(e),r}function N(e){let t=e.name,r=e.suite;for(;r;)r.name&&(t=`${r.name} ${t}`),r=r.suite;return t}function P(e){return async function(){if(!y.hasSubscribers)return e.apply(this,arguments);let t,r=!1,s=0,n=!1,i=0,c=!1,u=!1,l=!1,p={};try{const{err:e,libraryConfig:t}=await R(b);e||(r=t.isFlakyTestRetriesEnabled,s=t.flakyTestRetriesCount,n=t.isEarlyFlakeDetectionEnabled,i=t.earlyFlakeDetectionNumRetries,l=t.isDiEnabled,u=t.isKnownTestsEnabled)}catch(e){r=!1,n=!1,l=!1,u=!1}if(r&&!this.ctx.config.retry&&s>0&&(this.ctx.config.retry=s),u){const e=await R(v);if(e.err)n=!1,u=!1;else{p=e.knownTests;const t=this.ctx.getTestFilepaths||this.ctx._globTestFilepaths,r=await t.call(this.ctx);if(E.publish({knownTests:p.vitest||{},testFilepaths:r,onDone:e=>{c=e}}),c)n=!1,u=!1,a.warn("New test detection is disabled because the number of new tests is too high.");else try{const e=this.ctx.getCoreWorkspaceProject();e._provided._ddIsKnownTestsEnabled=u,e._provided._ddKnownTests=p.vitest||{},e._provided._ddIsEarlyFlakeDetectionEnabled=n,e._provided._ddEarlyFlakeDetectionNumRetries=i}catch(e){a.warn("Could not send known tests to workers so Early Flake Detection will not work.")}}}if(l)try{this.ctx.getCoreWorkspaceProject()._provided._ddIsDiEnabled=l}catch(e){a.warn("Could not send Dynamic Instrumentation configuration to workers.")}return this.ctx.coverageProvider?.generateCoverage&&o.wrap(this.ctx.coverageProvider,"generateCoverage",(e=>async function(){const r=await e.apply(this,arguments);try{t=r.getCoverageSummary().lines.pct}catch(e){}return r})),o.wrap(this.ctx,"exit",(e=>async function(){let r;const s=new Promise((e=>{r=e})),i=this.state.getFailedFilepaths();let o;return i.length&&(o=new Error(`Test suites failed: ${i.length}.`)),I.runInAsyncScope((()=>{var e;y.publish({status:(e=this.state,e.getCountOfFailedTests()>0?"fail":0===e.pathsSet.size?"skip":"pass"),testCodeCoverageLinesTotal:t,error:o,isEarlyFlakeDetectionEnabled:n,isEarlyFlakeDetectionFaulty:c,onFinish:r})})),await s,e.apply(this,arguments)})),e.apply(this,arguments)}}function D(e,t){return o.wrap(e,"c",(e=>function(){return _.hasSubscribers?(I.runInAsyncScope((()=>{const e=process.argv.slice(2).join(" ");_.publish({command:`vitest ${e}`,frameworkVersion:t})})),e.apply(this,arguments)):e.apply(this,arguments)})),e}s({name:"vitest",versions:[">=1.6.0"],file:"dist/runners.js"},(e=>{const{VitestTestRunner:t}=e;return o.wrap(t.prototype,"onBeforeRunTask",(e=>async function(t){const r=N(t),{knownTests:s,isEarlyFlakeDetectionEnabled:n,isKnownTestsEnabled:i,numRepeats:o}=O();return i&&h.publish({knownTests:s,testSuiteAbsolutePath:t.file.filepath,testName:r,onDone:e=>{e&&(n&&(x=t.repeats!==o,t.repeats=o),w.add(t),T.set(t,[]))}}),e.apply(this,arguments)})),o.wrap(t.prototype,"onAfterRunTask",(e=>async function(t){const{isEarlyFlakeDetectionEnabled:r}=O();return r&&T.has(t)&&T.get(t).includes("pass")&&("fail"===t.result.state&&A.add(t),t.result.state="pass"),e.apply(this,arguments)})),o.wrap(t.prototype,"onBeforeTryTask",(e=>async function(t,r){if(!c.hasSubscribers)return e.apply(this,arguments);const s=N(t);let n=!1;const{isKnownTestsEnabled:o,isEarlyFlakeDetectionEnabled:a,isDiEnabled:u}=O();o&&(n=w.has(t));const{retry:d,repeats:h}=r;if(d>0){u&&d>1&&await k();const e={},r=u&&1===d,s=S.get(t),n=t.result?.errors?.[0];s&&(s.runInAsyncScope((()=>{p.publish({error:n,shouldSetProbe:r,promises:e})})),e.setProbePromise&&await e.setProbePromise)}const f=t.result.state;if(h>0&&h<t.repeats){const e=S.get(t);if(e){if("fail"===f){const r=t.result?.errors?.[0];e.runInAsyncScope((()=>{p.publish({error:r})}))}else e.runInAsyncScope((()=>{l.publish({task:t})}));a&&(T.get(t).push(f),t.result.state="pass")}}else if(h===t.repeats){const e=S.get(t);if("fail"===f){const r=t.result?.errors?.[0];e.runInAsyncScope((()=>{p.publish({error:r})}))}else e.runInAsyncScope((()=>{l.publish({task:t})}))}const g=new i("bound-anonymous-fn");return S.set(t,g),g.runInAsyncScope((()=>{c.publish({testName:s,testSuiteAbsolutePath:t.file.filepath,isRetry:d>0||h>0,isRetryReasonEfd:x,isNew:n,mightHitProbe:u&&d>0})})),e.apply(this,arguments)})),o.wrap(t.prototype,"onAfterTryTask",(e=>async function(t,{retry:r}){if(!u.hasSubscribers)return e.apply(this,arguments);const s=await e.apply(this,arguments),n=function(e,t){if("fail"!==e.result.state){if(!e.repeats)return"pass";if(e.repeats&&(e.retry??0)===t)return"pass"}return"fail"}(t,r),i=S.get(t),{isDiEnabled:o}=O();return o&&r>1&&await k(),i&&i.runInAsyncScope((()=>{u.publish({status:n,task:t})})),s})),e})),s({name:"vitest",versions:[">=1.6.0 <2.0.0"],filePattern:"dist/vendor/index.*"},(e=>(function(e){return"BaseSequencer"===e.B?.name}(e)&&o.wrap(e.B.prototype,"sort",P),e))),s({name:"vitest",versions:[">=2.0.0 <2.0.5"],filePattern:"dist/vendor/index.*"},(e=>(function(e){return"BaseSequencer"===e.e?.name}(e)&&o.wrap(e.e.prototype,"sort",P),e))),s({name:"vitest",versions:[">=2.0.5 <2.1.0"],filePattern:"dist/chunks/index.*"},(e=>(function(e){return"BaseSequencer"===e.h?.name}(e)&&o.wrap(e.h.prototype,"sort",P),e))),s({name:"vitest",versions:[">=2.1.0 <3.0.0"],filePattern:"dist/chunks/RandomSequencer.*"},(e=>(o.wrap(e.B.prototype,"sort",P),e))),s({name:"vitest",versions:[">=3.0.0"],filePattern:"dist/chunks/resolveConfig.*"},(e=>(o.wrap(e.B.prototype,"sort",P),e))),s({name:"vitest",versions:[">=1.6.0 <2.0.5"],filePattern:"dist/vendor/cac.*"},D),s({name:"vitest",versions:[">=2.0.5"],filePattern:"dist/chunks/cac.*"},D),s({name:"@vitest/runner",versions:[">=1.6.0"],file:"dist/index.js"},((e,t)=>(o.wrap(e,"startTests",(e=>async function(r){let s=null;if(!f.hasSubscribers)return e.apply(this,arguments);const n=r[0]?.filepath||r[0],o=new i("bound-anonymous-fn");o.runInAsyncScope((()=>{f.publish({testSuiteAbsolutePath:n,frameworkVersion:t})}));const a=await e.apply(this,arguments);let c=null;const u=new Promise((e=>{c=e}));C(a[0].tasks).forEach((e=>{const t=S.get(e),{result:r}=e,n=A.has(e);if(r){const{state:i,duration:o,errors:a}=r;if("skip"===i)d.publish({testName:N(e),testSuiteAbsolutePath:e.file.filepath,isNew:w.has(e)});else if("pass"!==i||n){if("fail"===i||n){let r;if(a?.length&&(r=a[0]),t){const s=e.result?.retryCount>0;t.runInAsyncScope((()=>{p.publish({duration:s?void 0:o,error:r})}))}a?.length&&(s=r)}}else t&&t.runInAsyncScope((()=>{l.publish({task:e})}))}else d.publish({testName:N(e),testSuiteAbsolutePath:e.file.filepath,isNew:w.has(e)})}));const h=a[0].result;if(h.errors?.length)s=h.errors[0];else if("fail"===h.state){const e=C(a[0].tasks,"suite").filter((e=>"fail"===e.result?.state));e.length&&e[0].result?.errors?.length&&(s=e[0].result.errors[0])}return s&&o.runInAsyncScope((()=>{m.publish({error:s})})),o.runInAsyncScope((()=>{g.publish({status:h.state,onFinish:c})})),await u,a})),e)))},89714:(e,t,r)=>{"use strict";const{channel:s,addHook:n}=r(95092),i=r(81444),o=s("datadog:vm:run-script:start"),a=s("datadog:vm:source-text-module:start");function c(e){return function(t){return o.hasSubscribers&&t&&o.publish({code:t}),e.apply(this,arguments)}}n({name:["vm","node:vm"]},(function(e){return e.Script=class extends e.Script{constructor(e){super(...arguments),o.hasSubscribers&&e&&o.publish({code:e})}},e.SourceTextModule&&"function"==typeof e.SourceTextModule&&(e.SourceTextModule=class extends e.SourceTextModule{constructor(e){super(...arguments),a.hasSubscribers&&e&&a.publish({code:e})}}),i.wrap(e,"runInContext",c),i.wrap(e,"runInNewContext",c),i.wrap(e,"runInThisContext",c),i.wrap(e,"compileFunction",c),e}))},11243:(e,t,r)=>{"use strict";const{addHook:s}=r(95092),{wrapThen:n}=r(30060),i=r(81444);s({name:"when",file:"lib/Promise.js",versions:[">=3"]},(e=>(i.wrap(e.prototype,"then",n),e)))},56143:(e,t,r)=>{"use strict";const{channel:s,addHook:n}=r(95092),i=r(81444),o=new WeakSet,a=s("ci:log-submission:winston:configure"),c=s("ci:log-submission:winston:add-transport");function u(e,t){return function(){const r=e.apply(this,arguments);if(t.hasSubscribers)for(const e in this.transports){const r=this.transports[e];o.has(r)||"function"!=typeof r.log||(i.wrap(r,"log",(e=>function(r,s,n,i){const o={message:n||{}};t.publish(o),arguments[2]=o.message,e.apply(this,arguments)})),o.add(r))}return r}}n({name:"winston",file:"lib/winston/transports/index.js",versions:[">=3"]},(e=>(a.hasSubscribers&&a.publish(e.Http),e))),n({name:"winston",file:"lib/winston/logger.js",versions:[">=3"]},(e=>{const t=s("apm:winston:log");return i.wrap(e.prototype,"write",(e=>function(r,s,n){if(t.hasSubscribers){const e={message:r};t.publish(e),arguments[0]=e.message}return e.apply(this,arguments)})),i.wrap(e.prototype,"configure",(e=>function(){const t=e.apply(this,arguments);return c.hasSubscribers&&c.publish(this),t})),e})),n({name:"winston",file:"lib/winston/logger.js",versions:["1","2"]},(e=>{const t=s("apm:winston:log");return e.Logger.prototype.configure&&i.wrap(e.Logger.prototype,"configure",(e=>u(e,t))),i.wrap(e.Logger.prototype,"add",(e=>u(e,t))),e}))},61471:(e,t,r)=>{"use strict";const{storage:s}=r(96882),n=r(42537),i="aerospike.namespace";e.exports=class extends n{static get id(){return"aerospike"}static get operation(){return"command"}static get system(){return"aerospike"}static get prefix(){return"tracing:apm:aerospike:command"}static get peerServicePrecursors(){return[i]}bindStart(e){const{commandName:t,commandArgs:r}=e,n=t.slice(0,t.indexOf("Command")),o=s.getStore(),a=o?o.span:null,c=function(e,t){let r={};if(e.includes("Index")){const[e,s,n,o]=t;r=function(e,t,r,s){return{[i]:e,"aerospike.setname":t,"aerospike.bin":r,"aerospike.index":s}}(e,s,n,o)}else if("Query"===e){const{ns:e,set:s}=t[2];r=function(e){const{ns:t,set:r}=e;return{[i]:t,"aerospike.setname":r}}({ns:e,set:s})}else if((s=t[0])&&void 0!==s.ns&&void 0!==s.set&&void 0!==s.key){const{ns:e,set:s,key:n}=t[0];r=function(e,t,r){return{"aerospike.key":`${e}:${t}:${r}`,[i]:e,"aerospike.setname":t,"aerospike.userkey":r}}(e,s,n)}var s;return r}(n,r),u=this.startSpan(this.operationName(),{childOf:a,service:this.serviceName({pluginConfig:this.config}),type:"aerospike",kind:"client",resource:n,meta:c},!1);return e.parentStore=o,e.currentStore={...o,span:u},e.currentStore}bindAsyncStart(e){return e.currentStore&&(this.tagPeerService(e.currentStore.span),e.currentStore.span.finish()),e.parentStore}end(e){e.result&&(this.tagPeerService(e.currentStore.span),e.currentStore.span.finish())}error(e){if(e.error){const t=e.error;e.currentStore.span.setTag("error",t)}}}},56348:(e,t,r)=>{"use strict";const s=r(57232),{getAddress:n,getShortName:i}=r(7400);e.exports=class extends s{static get id(){return"amqp10"}static get system(){return"amqp"}start({link:e}){const t=i(e),r=n(e);this.startSpan({resource:["receive",t].filter((e=>e)).join(" "),type:"worker",meta:{"amqp.link.source.address":t,"amqp.link.role":"receiver","amqp.link.name":e.name,"amqp.link.handle":e.handle,"amqp.connection.host":r.host,"amqp.connection.port":r.port,"amqp.connection.user":r.user}})}}},70358:(e,t,r)=>{"use strict";const s=r(94866),n=r(56348),i=r(42257);e.exports=class extends i{static get id(){return"amqp10"}static get plugins(){return{producer:s,consumer:n}}}},94866:(e,t,r)=>{"use strict";const s=r(36878),{CLIENT_PORT_KEY:n}=r(23636),{getAddress:i,getShortName:o}=r(7400);e.exports=class extends s{static get id(){return"amqp10"}static get operation(){return"send"}static get system(){return"amqp"}start({link:e}){const t=i(e),r=o(e);this.startSpan({resource:["send",r].filter((e=>e)).join(" "),meta:{"amqp.link.target.address":r,"amqp.link.role":"sender","out.host":t.host,[n]:t.port,"amqp.link.name":e.name,"amqp.link.handle":e.handle,"amqp.connection.host":t.host,"amqp.connection.port":t.port,"amqp.connection.user":t.user}})}}},7400:e=>{"use strict";e.exports={getAddress:function(e){return e&&e.session&&e.session.connection&&e.session.connection.address||{}},getShortName:function(e){return e&&e.name?e.name.split("_").slice(0,-1).join("_"):null}}},63657:(e,t,r)=>{"use strict";const{TEXT_MAP:s}=r(59429),{CLIENT_PORT_KEY:n}=r(23636),i=r(77723),{getResourceName:o}=r(70906);e.exports=class extends i{static get id(){return"amqplib"}static get type(){return"messaging"}static get operation(){return"command"}start({channel:e={},method:t,fields:r}){if("basic.deliver"===t||"basic.get"===t)return;if("basic.publish"===t)return;const i=e.connection&&e.connection.stream||{},a=this.startSpan(this.operationName(),{service:this.config.service||this.serviceName(),resource:o(t,r),kind:this.constructor.kind,meta:{"out.host":i._host,[n]:i.remotePort,"amqp.queue":r.queue,"amqp.exchange":r.exchange,"amqp.routingKey":r.routingKey,"amqp.consumerTag":r.consumerTag,"amqp.source":r.source,"amqp.destination":r.destination}});r.headers=r.headers||{},this.tracer.inject(a,s,r.headers)}}},26970:(e,t,r)=>{"use strict";const{TEXT_MAP:s}=r(59429),n=r(57232),{getAmqpMessageSize:i}=r(63011),{getResourceName:o}=r(70906);e.exports=class extends n{static get id(){return"amqplib"}static get operation(){return"command"}start({method:e,fields:t,message:r,queue:n}){if("basic.deliver"!==e&&"basic.get"!==e)return;const a=function(e,t){return t?e.extract(s,t.properties.headers):null}(this.tracer,r),c=n||t.queue||t.routingKey,u=this.startSpan({childOf:a,resource:o(e,t),type:"worker",meta:{"amqp.queue":c,"amqp.exchange":t.exchange,"amqp.routingKey":t.routingKey,"amqp.consumerTag":t.consumerTag,"amqp.source":t.source,"amqp.destination":t.destination}});if(this.config.dsmEnabled&&r?.properties?.headers){const e=i({headers:r.properties.headers,content:r.content});this.tracer.decodeDataStreamsContext(r.properties.headers),this.tracer.setCheckpoint(["direction:in",`topic:${c}`,"type:rabbitmq"],u,e)}}}},20912:(e,t,r)=>{"use strict";const s=r(6116),n=r(26970),i=r(63657),o=r(42257);e.exports=class extends o{static get id(){return"amqplib"}static get plugins(){return{producer:s,consumer:n,client:i}}}},6116:(e,t,r)=>{"use strict";const{TEXT_MAP:s}=r(59429),{CLIENT_PORT_KEY:n}=r(23636),i=r(36878),{DsmPathwayCodec:o}=r(71793),{getAmqpMessageSize:a}=r(63011),{getResourceName:c}=r(70906);e.exports=class extends i{static get id(){return"amqplib"}static get operation(){return"command"}start({channel:e={},method:t,fields:r,message:i}){if("basic.publish"!==t)return;const u=e.connection&&e.connection.stream||{},l=this.startSpan({resource:c(t,r),meta:{"out.host":u._host,[n]:u.remotePort,"amqp.queue":r.queue,"amqp.exchange":r.exchange,"amqp.routingKey":r.routingKey,"amqp.consumerTag":r.consumerTag,"amqp.source":r.source,"amqp.destination":r.destination}});if(r.headers=r.headers||{},this.tracer.inject(l,s,r.headers),this.config.dsmEnabled){const e=null!=r.routingKey,t=a({content:i,headers:r.headers}),s=e&&!r.exchange?`topic:${r.routingKey}`:`exchange:${r.exchange}`,n=this.tracer.setCheckpoint(["direction:out",s,`has_routing_key:${e}`,"type:rabbitmq"],l,t);o.encode(n,r.headers)}}}},70906:e=>{"use strict";e.exports={getResourceName:function(e,t={}){return[e,t.exchange,t.routingKey,t.queue,t.source,t.destination].filter((e=>e)).join(" ")}}},71461:(e,t,r)=>{"use strict";const s=r(54311);e.exports=class extends s{static get operation(){return"execute"}static get prefix(){return"tracing:apm:apollo:gateway:execute"}}},82050:(e,t,r)=>{"use strict";const{storage:s}=r(96882),n=r(54311);e.exports=class extends n{static get operation(){return"fetch"}static get prefix(){return"tracing:apm:apollo:gateway:fetch"}bindStart(e){const t=s.getStore(),r={childOf:t?t.span:null,service:this.getServiceName(),type:this.constructor.type,meta:{}},n=e?.attributes?.service;n&&(r.meta.serviceName=n);const i=this.startSpan(this.getOperationName(),r,!1);return e.parentStore=t,e.currentStore={...t,span:i},e.currentStore}}},93638:(e,t,r)=>{"use strict";const{storage:s}=r(96882),n=r(42257),i=r(71461),o=r(98117),a=r(58183),c=r(49015),u=r(92786),l=r(82050);e.exports=class extends n{static get id(){return"gateway"}static get plugins(){return{execute:i,postprocessing:o,request:a,plan:c,fetch:l,validate:u}}constructor(...e){super(...e),this.addSub("apm:apollo:gateway:general:error",(e=>{const t=s.getStore(),r=t?.span;r&&r.setTag("error",e.error)}))}}},49015:(e,t,r)=>{"use strict";const s=r(54311);e.exports=class extends s{static get operation(){return"plan"}static get prefix(){return"tracing:apm:apollo:gateway:plan"}}},98117:(e,t,r)=>{"use strict";const s=r(54311);e.exports=class extends s{static get operation(){return"postprocessing"}static get prefix(){return"tracing:apm:apollo:gateway:postprocessing"}}},58183:(e,t,r)=>{"use strict";const{storage:s}=r(96882),n=r(54311);let i;e.exports=class extends n{static get operation(){return"request"}static get prefix(){return"tracing:apm:apollo:gateway:request"}bindStart(e){const t=s.getStore(),n={childOf:t?t.span:null,service:this.serviceName({id:`${this.constructor.id}.${this.constructor.operation}`,pluginConfig:this.config}),type:this.constructor.type,kind:this.constructor.kind,meta:{}},{requestContext:o,gateway:a}=e;o?.operationName&&(n.meta["graphql.operation.name"]=o.operationName),(this.config.source||a?.config?.telemetry?.includeDocument)&&o?.source&&(n.meta["graphql.source"]=o.source);const c=function(e,t,r){let s,n=0;const i=Object.create(null);try{t.definitions.forEach((e=>{switch(e.kind){case"OperationDefinition":if(n++,!r&&n>1)return;(!r||e.name&&e.name.value===r)&&(s=e);break;case"FragmentDefinition":i[e.name.value]=e}}))}catch(e){}return{schema:e,operation:s,fragments:i}}(a.schema,o.document,o.request.operationName);if(c?.operation?.operation){const e=o?.document,t=c?.operation?.operation,s=c?.operation?.name&&c?.operation?.name?.value;n.resource=function(e,t,s,n){if(!1!==n&&!1!==i)try{try{i=i||r(94275)}catch(e){throw i=!1,e}return i.defaultEngineReportingSignature(e,t)}catch(e){}return[s,t].filter((e=>e)).join(" ")}(e,s,t,this?.config?.signature),n.meta["graphql.operation.type"]=t}const u=this.startSpan(this.operationName({id:`${this.constructor.id}.${this.constructor.operation}`}),n,!1);return e.parentStore=t,e.currentStore={...t,span:u},e.currentStore}asyncStart(e){const t=e?.result?.errors;return t instanceof Array&&t[t.length-1]&&t[t.length-1].stack&&t[t.length-1].message&&e.currentStore.span.setTag("error",t[t.length-1]),e.currentStore.span.finish(),e.parentStore}}},92786:(e,t,r)=>{"use strict";const s=r(54311);e.exports=class extends s{static get operation(){return"validate"}static get prefix(){return"tracing:apm:apollo:gateway:validate"}end(e){const t=e.result,r=e.currentStore?.span;r&&(t instanceof Array&&t[t.length-1]&&t[t.length-1].stack&&t[t.length-1].message&&r.setTag("error",t[t.length-1]),r.finish())}}},32855:(e,t,r)=>{"use strict";const s=r(42257),n=r(93638);e.exports=class extends s{static get id(){return"apollo"}static get plugins(){return{gateway:n}}}},41637:(e,t,r)=>{const s=r(56875),n=r(42999);e.exports=class extends s{static get id(){return"avsc"}static get schemaExtractor(){return n}}},42999:(e,t,r)=>{const{SCHEMA_DEFINITION:s,SCHEMA_ID:n,SCHEMA_NAME:i,SCHEMA_OPERATION:o,SCHEMA_WEIGHT:a,SCHEMA_TYPE:c}=r(23636),u=r(75004),{SchemaBuilder:l}=r(62957);class p{constructor(e){this.schema=e}static getType(e){const t=e.typeName??e.name??e;return"null"===t?t:{string:"string",int:"integer",long:"integer",float:"number",double:"number",boolean:"boolean",bytes:"string",record:"object",enum:"string",array:"array",map:"object",fixed:"string"}[t]||"string"}static extractProperty(e,t,r,s,n){let i,o,a,c,u=!1;const l=e.type?.types??e.type?.typeName??e.type;if(Array.isArray(l))i="union["+l.map((e=>p.getType(e.type||e))).join(",")+"]";else if("array"===l){u=!0;const t=e.type.itemsType.typeName;i=p.getType(t)}else if("record"===l){if(i="object",c=`#/components/schemas/${e.type.name}`,!p.extractSchema(e.type,s,n+1,this))return!1}else if("enum"===l){a=[];let t=0;for(i="string";e.type.symbols[t];)a.push(e.type.symbols[t]),t+=1}else i=p.getType(l.type||l),"bytes"===l?o="byte":"int"===l?o="int32":"long"===l?o="int64":"float"===l?o="float":"double"===l&&(o="double");return s.addProperty(t,r,u,i,void 0,c,o,a)}static extractSchema(e,t,r,s){r+=1;const n=e.name;if(s){const r=new p(e);t.iterator=r;const s=l.getSchema(n,r,t);for(const e in s.components.schemas)s.components.schemas.hasOwnProperty(e)&&(t.schema.components.schemas[e]=s.components.schemas[e]);return!0}if(!t.shouldExtractSchema(n,r))return!1;if(e.fields?.[Symbol.iterator])for(const s of e.fields)this.extractProperty(s,n,s.name,t,r)||u.warn("DSM: Unable to extract field with name: %s from Avro schema with name: %s",s.name,n);else u.warn("DSM: schema.fields is not iterable from Avro schema with name: %s",n);return!0}static extractSchemas(e,t){return t.getSchema(e.name,new p(e))}iterateOverSchema(e){this.constructor.extractSchema(this.schema,e,0)}static attachSchemaOnSpan(e,t,r,u){const{messageClass:p}=e,d=p?.constructor?.type??p;if(!d||!t)return;if(t.context()._tags[c]&&"serialization"===r)return;if(t.setTag(c,"avro"),t.setTag(i,d.name),t.setTag(o,r),!u._dataStreamsProcessor.canSampleSchema(r))return;if(!u._prioritySampler.isSampled(t))return;const h=u._dataStreamsProcessor.trySampleSchema(r);if(0===h)return;const f=l.getSchemaDefinition(this.extractSchemas(d,u._dataStreamsProcessor));t.setTag(s,f.definition),t.setTag(a,h),t.setTag(n,f.id)}}e.exports=p},85209:(e,t,r)=>{"use strict";const s=r(88378),n=r(77723),{storage:i}=r(96882),{isTrue:o}=r(89421),a=r(96538),{tagsFromRequest:c,tagsFromResponse:u}=r(85458);e.exports=class extends n{static get id(){return"aws"}static get isPayloadReporter(){return!1}get serviceIdentifier(){const e=this.constructor.id.toLowerCase();return Object.defineProperty(this,"serviceIdentifier",{configurable:!0,writable:!0,enumerable:!0,value:e}),e}get cloudTaggingConfig(){return this._tracerConfig.cloudPayloadTagging}get payloadTaggingRules(){return this.cloudTaggingConfig.rules.aws?.[this.constructor.id]}constructor(...e){super(...e),this.addSub(`apm:aws:request:start:${this.serviceIdentifier}`,(({request:e,operation:t,awsRegion:r,awsService:n})=>{if(!this.isEnabled(e))return;const o=this.tracer.scope().active(),a={"span.kind":"client","service.name":this.serviceName(),"aws.operation":t,"aws.region":r,region:r,aws_service:n,"aws.service":n,component:"aws-sdk"};this.requestTags&&this.requestTags.set(e,a);const u=this.tracer.startSpan(this.operationFromRequest(e),{childOf:o,tags:a});if(s.sample(u,this.config.measured),this.requestInject(u,e),this.constructor.isPayloadReporter&&this.cloudTaggingConfig.requestsEnabled){const t=this.cloudTaggingConfig.maxDepth,r=c(this.payloadTaggingRules,e.params,{maxDepth:t});u.addTags(r)}const l=i.getStore();this.enter(u,l)})),this.addSub(`apm:aws:request:region:${this.serviceIdentifier}`,(e=>{const t=i.getStore();if(!t)return;const{span:r}=t;r&&(r.setTag("aws.region",e),r.setTag("region",e))})),this.addSub(`apm:aws:request:complete:${this.serviceIdentifier}`,(({response:e,cbExists:t=!1})=>{const r=i.getStore();if(!r)return;const{span:s}=r;if(s){if(!t&&"sqs"===this.serviceIdentifier){const t=e.request.params,r=e.request.operation;this.responseExtractDSMContext(r,t,e.data??e,s)}this.addResponseTags(s,e),this.addSpanPointers(s,e),this.finish(s,e,e.error)}}))}requestInject(e,t){}addSpanPointers(e,t){}operationFromRequest(e){return this.operationName({id:"aws",type:"web",kind:"client",awsService:this.serviceIdentifier})}serviceName(){return this.config.service||super.serviceName({id:"aws",type:"web",kind:"client",awsService:this.serviceIdentifier})}isEnabled(e){const t=this.serviceIdentifier.toUpperCase(),r=process.env[`DD_TRACE_AWS_SDK_${t}_ENABLED`];return!r||o(r)}addResponseTags(e,t){if(!e||!t.request)return;const r=t.request.params,s=t.request.operation,n=this.generateTags(r,s,t)||{},i=Object.assign({"aws.response.request_id":t.requestId,"resource.name":s,"span.kind":"client"},n);if(e.addTags(i),this.constructor.isPayloadReporter&&this.cloudTaggingConfig.responsesEnabled){const r=this.cloudTaggingConfig.maxDepth,s=this.extractResponseBody(t),n=u(this.payloadTaggingRules,s,{maxDepth:r});e.addTags(n)}}extractResponseBody(e){return e.hasOwnProperty("data")?e.data:Object.fromEntries(Object.entries(e).filter((([e])=>!["request","requestId","error","$metadata"].includes(e))))}generateTags(){}finish(e,t,r){if(r){e.setTag("error",r);const t=r.RequestId||r.requestId;t&&e.addTags({"aws.response.request_id":t})}t&&this.config.hooks.request(e,t),super.finish()}configure(e){super.configure(function(e,t){const r=function(e){return{request:e.hooks&&e.hooks.request||(()=>{})}}(e);let s=e[t];switch(typeof s){case"undefined":s={};break;case"boolean":s={enabled:s}}const n=t.toUpperCase(),i=o(a(s.batchPropagationEnabled,process.env[`DD_TRACE_AWS_SDK_${n}_BATCH_PROPAGATION_ENABLED`],e.batchPropagationEnabled,process.env.DD_TRACE_AWS_SDK_BATCH_PROPAGATION_ENABLED,!1));return Object.assign({},e,s,{splitByAwsService:!1!==e.splitByAwsService,batchPropagationEnabled:i,hooks:r})}(e,this.serviceIdentifier))}}},17914:(e,t,r)=>{"use strict";const s=r(12583),n=r(70867);e.exports=class extends s{static get id(){return"aws-sdk"}constructor(...e){super(...e),this.services={};for(const t in n){const r=n[t];this.services[t]=new r(...e)}}configure(e){for(const t of Object.values(this.services))t.configure(e)}}},71378:(e,t,r)=>{const s=r(42257),n=r(26872),i=r(37290);e.exports=class extends s{static get id(){return"bedrockruntime"}static get plugins(){return{llmobs:i,tracing:n}}}},26872:(e,t,r)=>{"use strict";const s=r(85209),{parseModelId:n,extractRequestParams:i,extractTextAndResponseReason:o}=r(14003),a=["invokeModel"];e.exports=class extends s{static get id(){return"bedrockruntime"}isEnabled(e){const t=e.operation;return!!a.includes(t)&&super.isEnabled(e)}generateTags(e,t,r){const{modelProvider:s,modelName:a}=n(e.modelId),c=function(e,t,r,s,n){const i={};return i["resource.name"]=n,i["aws.bedrock.request.model"]=s,i["aws.bedrock.request.model_provider"]=r.toLowerCase(),i["aws.bedrock.request.prompt"]=e.prompt,i["aws.bedrock.request.temperature"]=e.temperature,i["aws.bedrock.request.top_p"]=e.topP,i["aws.bedrock.request.top_k"]=e.topK,i["aws.bedrock.request.max_tokens"]=e.maxTokens,i["aws.bedrock.request.stop_sequences"]=e.stopSequences,i["aws.bedrock.request.input_type"]=e.inputType,i["aws.bedrock.request.truncate"]=e.truncate,i["aws.bedrock.request.stream"]=e.stream,i["aws.bedrock.request.n"]=e.n,s.includes("embed")&&(i["aws.bedrock.response.embedding_length"]=t.message.length),t.choiceId&&(i["aws.bedrock.response.choices.id"]=t.choiceId),i["aws.bedrock.response.choices.text"]=t.message,i["aws.bedrock.response.choices.finish_reason"]=t.finishReason,i}(i(e,s),o(r,s,a),s,a,t);return c}}},14003:(e,t,r)=>{"use strict";const s=r(75004),n=["foundation-model/","custom-model/","provisioned-model/","imported-module/","prompt/","endpoint/","inference-profile/","default-prompt-router/"],i={AI21:"AI21",AMAZON:"AMAZON",ANTHROPIC:"ANTHROPIC",COHERE:"COHERE",META:"META",STABILITY:"STABILITY",MISTRAL:"MISTRAL"};class o{constructor({message:e="",finishReason:t="",choiceId:r="",role:s,inputTokens:n,outputTokens:i}={}){this.message="string"==typeof e?e:JSON.stringify(e)||"",this.finishReason=t||"",this.choiceId=r||void 0,this.role=s,this.usage={inputTokens:n,outputTokens:i}}}class a{constructor({prompt:e="",temperature:t,topP:r,topK:s,maxTokens:n,stopSequences:i=[],inputType:o="",truncate:a="",stream:c="",n:u}={}){this.prompt="string"==typeof e?e:JSON.stringify(e)||"",this.temperature=void 0!==t?t:void 0,this.topP=void 0!==r?r:void 0,this.topK=void 0!==s?s:void 0,this.maxTokens=void 0!==n?n:void 0,this.stopSequences=i||[],this.inputType=o||"",this.truncate=a||"",this.stream=c||"",this.n=void 0!==u?u:void 0}}e.exports={Generation:o,RequestParams:a,parseModelId:function(e){if(!(e=e.toLowerCase()).startsWith("arn:aws")){const t=e.split(".");return t.length<2?{modelProvider:"custom",modelName:t[0]}:{modelProvider:t[t.length-2],modelName:t[t.length-1]}}for(const t of n)if(e.includes(t)){if(e=e.split(t).pop(),["foundation-model/","custom-model/"].includes(t)){const t=e.split(".");return t.length<2?{modelProvider:"custom",modelName:e}:{modelProvider:t[t.length-2],modelName:t[t.length-1]}}return{modelProvider:"custom",modelName:e}}return{modelProvider:"custom",modelName:"custom"}},extractRequestParams:function(e,t){const r=JSON.parse(e.body),s=e.modelId;switch(t.toUpperCase()){case i.AI21:{let e=r.prompt;if(s.includes("jamba"))for(const t of r.messages)"user"===t.role&&(e=t.content);return new a({prompt:e,temperature:r.temperature,topP:r.top_p,maxTokens:r.max_tokens,stopSequences:r.stop_sequences})}case i.AMAZON:{if(s.includes("embed"))return new a({prompt:r.inputText});const e=r.textGenerationConfig||{};return new a({prompt:r.inputText,temperature:e.temperature,topP:e.topP,maxTokens:e.maxTokenCount,stopSequences:e.stopSequences})}case i.ANTHROPIC:{const e=r.prompt||r.messages;return new a({prompt:e,temperature:r.temperature,topP:r.top_p,maxTokens:r.max_tokens_to_sample,stopSequences:r.stop_sequences})}case i.COHERE:return s.includes("embed")?new a({prompt:r.texts,inputType:r.input_type,truncate:r.truncate}):new a({prompt:r.prompt,temperature:r.temperature,topP:r.p,maxTokens:r.max_tokens,stopSequences:r.stop_sequences,stream:r.stream,n:r.num_generations});case i.META:return new a({prompt:r.prompt,temperature:r.temperature,topP:r.top_p,maxTokens:r.max_gen_len});case i.MISTRAL:return new a({prompt:r.prompt,temperature:r.temperature,topP:r.top_p,maxTokens:r.max_tokens,stopSequences:r.stop,topK:r.top_k});default:return new a}},extractTextAndResponseReason:function(e,t,r){const n=JSON.parse(Buffer.from(e.body).toString("utf8")),a=t.toUpperCase()===i.COHERE&&!r.includes("embed");try{switch(t.toUpperCase()){case i.AI21:{if(r.includes("jamba")){const e=n.choices||[];if(e.length>0){const t=e[0];return new o({message:t.message.content,finishReason:t.finish_reason,choiceId:a?t.id:void 0,role:t.message.role,inputTokens:n.usage?.prompt_tokens,outputTokens:n.usage?.completion_tokens})}}const e=n.completions||[];if(e.length>0){const t=e[0];return new o({message:t.data?.text,finishReason:t?.finishReason,choiceId:a?t?.id:void 0,inputTokens:n.usage?.prompt_tokens,outputTokens:n.usage?.completion_tokens})}return new o}case i.AMAZON:{if(r.includes("embed"))return new o({message:n.embedding});const e=n.results||[];if(e.length>0){const t=e[0];return new o({message:t.outputText,finishReason:t.completionReason,inputTokens:n.inputTextTokenCount,outputTokens:t.tokenCount})}break}case i.ANTHROPIC:return new o({message:n.completion||n.content,finishReason:n.stop_reason});case i.COHERE:{if(r.includes("embed")){const e=n.embeddings||[[]];if(e.length>0)return new o({message:e[0]})}const e=n.generations||[];if(e.length>0){const t=e[0];return new o({message:t.text,finishReason:t.finish_reason,choiceId:a?t.id:void 0})}break}case i.META:return new o({message:n.generation,finishReason:n.stop_reason,inputTokens:n.prompt_token_count,outputTokens:n.generation_token_count});case i.MISTRAL:{const e=n.outputs||[];if(e.length>0){const t=e[0];return new o({message:t.text,finishReason:t.stop_reason})}break}default:return new o}}catch(e){return s.warn("Unable to extract text/finishReason from response body. Defaulting to empty text/finishReason."),new o}return new o},PROVIDER:i}},85468:(e,t,r)=>{"use strict";const s=r(85209);e.exports=class extends s{static get id(){return"cloudwatchlogs"}generateTags(e,t){const r={};return e&&e.logGroupName?Object.assign(r,{"resource.name":`${t} ${e.logGroupName}`,"aws.cloudwatch.logs.log_group_name":e.logGroupName,loggroupname:e.logGroupName}):r}}},12118:(e,t,r)=>{"use strict";const s=r(85209);e.exports=class extends s{}},28335:(e,t,r)=>{"use strict";const s=r(85209),n=r(75004),{DYNAMODB_PTR_KIND:i,SPAN_POINTER_DIRECTION:o}=r(23636),{extractPrimaryKeys:a,generatePointerHash:c}=r(39556);class u extends s{static get id(){return"dynamodb"}static get peerServicePrecursors(){return["tablename"]}generateTags(e,t,r){const s={};if(e&&(e.TableName&&Object.assign(s,{"resource.name":`${t} ${e.TableName}`,"aws.dynamodb.table_name":e.TableName,tablename:e.TableName}),null!==e.RequestItems&&"object"==typeof e.RequestItems&&1===Object.keys(e.RequestItems).length)){const r=Object.keys(e.RequestItems)[0];Object.assign(s,{"resource.name":`${t} ${r}`,"aws.dynamodb.table_name":r,tablename:r})}return Object.assign(s,{"span.type":"dynamodb"}),s}addSpanPointers(e,t){const r=t?.request,s=r?.operation,n=[];switch(s){case"putItem":{const e=u.calculatePutItemHash(r?.params?.TableName,r?.params?.Item,this.getPrimaryKeyConfig());e&&n.push(e);break}case"updateItem":case"deleteItem":{const e=u.calculateHashWithKnownKeys(r?.params?.TableName,r?.params?.Key);e&&n.push(e);break}case"transactWriteItems":{const e=r?.params?.TransactItems||[];for(const t of e)if(t.Put){const e=u.calculatePutItemHash(t.Put.TableName,t.Put.Item,this.getPrimaryKeyConfig());e&&n.push(e)}else if(t.Update||t.Delete){const e=t.Update?t.Update:t.Delete,r=u.calculateHashWithKnownKeys(e.TableName,e.Key);r&&n.push(r)}break}case"batchWriteItem":{const e=r?.params.RequestItems||{};for(const[t,r]of Object.entries(e))if(Array.isArray(r))for(const e of r)if(e?.PutRequest){const r=u.calculatePutItemHash(t,e.PutRequest.Item,this.getPrimaryKeyConfig());r&&n.push(r)}else if(e?.DeleteRequest){const r=u.calculateHashWithKnownKeys(t,e.DeleteRequest.Key);r&&n.push(r)}break}}for(const t of n)e.addSpanPointer(i,o.DOWNSTREAM,t)}getPrimaryKeyConfig(){if(this.dynamoPrimaryKeyConfig)return this.dynamoPrimaryKeyConfig;const e=this._tracerConfig?.aws?.dynamoDb?.tablePrimaryKeys;if(e)try{const t=JSON.parse(e),r={};for(const[e,s]of Object.entries(t))Array.isArray(s)&&s.length>0&&s.length<=2?r[e]=new Set(s):n.warn(`Invalid primary key configuration for table: ${e}.Please fix the DD_AWS_SDK_DYNAMODB_TABLE_PRIMARY_KEYS env var.`);return this.dynamoPrimaryKeyConfig=r,r}catch(e){n.warn("Failed to parse DD_AWS_SDK_DYNAMODB_TABLE_PRIMARY_KEYS:",e.message)}else n.warn("Missing DD_AWS_SDK_DYNAMODB_TABLE_PRIMARY_KEYS env variable. Please add your table's primary keys under this env variable.")}static calculatePutItemHash(e,t,r){if(!e||!t)return void n.debug("Unable to calculate hash because missing required parameters");if(!r)return void n.warn("Missing DD_AWS_SDK_DYNAMODB_TABLE_PRIMARY_KEYS env variable");const s=r[e];if(!s||!(s instanceof Set)||0===s.size||s.size>2)return void n.warn(`span pointers: failed to extract PutItem span pointer: table ${e} not found in primary key names or the DD_AWS_SDK_DYNAMODB_TABLE_PRIMARY_KEYS env var was invalid.Please update the env var.`);const i=a(s,t);return i?c([e,...i]):void 0}static calculateHashWithKnownKeys(e,t){if(!e||!t)return void n.debug("Unable to calculate hash because missing parameters");const r=new Set(Object.keys(t)),s=a(r,t);return s?c([e,...s]):void 0}}e.exports=u},65190:(e,t,r)=>{"use strict";const s=r(75004),n=r(85209);e.exports=class extends n{static get id(){return"eventbridge"}static get isPayloadReporter(){return!0}generateTags(e,t,r){if(!e||!e.source)return{};const s=e.Name?e.Name:"";return{"resource.name":t?`${t} ${e.source}`:e.source,"aws.eventbridge.source":`${e.source}`,rulename:`${s}`}}requestInject(e,t){if("putEvents"===t.operation&&t.params&&t.params.Entries&&t.params.Entries.length>0&&t.params.Entries[0].Detail)try{const r=JSON.parse(t.params.Entries[0].Detail);r._datadog={},this.tracer.inject(e,"text_map",r._datadog);const n=JSON.stringify(r);if(Buffer.byteLength(n)>=262144)return void s.info("Payload size too large to pass context");t.params.Entries[0].Detail=n}catch(e){s.error("EventBridge error injecting request",e)}}}},70867:(e,t,r)=>{"use strict";t.cloudwatchlogs=r(85468),t.dynamodb=r(28335),t.eventbridge=r(65190),t.kinesis=r(99065),t.lambda=r(51128),t.redshift=r(65006),t.s3=r(93657),t.sfn=r(97642),t.sns=r(48677),t.sqs=r(26242),t.states=r(96525),t.stepfunctions=r(19684),t.bedrockruntime=r(71378),t.default=r(12118)},99065:(e,t,r)=>{"use strict";const{getSizeOrZero:s}=r(63011),{DsmPathwayCodec:n}=r(71793),i=r(75004),o=r(85209),{storage:a}=r(96882);e.exports=class extends o{static get id(){return"kinesis"}static get peerServicePrecursors(){return["streamname"]}static get isPayloadReporter(){return!0}constructor(...e){super(...e),this.requestTags=new WeakMap,this.addSub("apm:aws:response:start:kinesis",(e=>{const{request:t,response:r}=e,s=a.getStore(),n=this;if("getShardIterator"!==t.operation&&"listShards"!==t.operation){if("getRecords"===t.operation){let i;const o=this.responseExtract(t.params,t.operation,r);if(o&&o.maybeChildOf){e.needsFinish=!0;const r={childOf:o.maybeChildOf,tags:Object.assign({},this.requestTags.get(t)||{},{"span.kind":"server"})};i=n.tracer.startSpan("aws.response",r),this.enter(i,s)}const{streamName:c}=a.getStore();this.responseExtractDSMContext(t.operation,t.params,r,i||null,{streamName:c})}}else this.storeStreamName(t.params,t.operation,s)})),this.addSub("apm:aws:response:finish:kinesis",(e=>{const{span:t}=a.getStore();this.finish(t,null,e)}))}generateTags(e,t,r){return e&&e.StreamName?{"resource.name":`${t} ${e.StreamName}`,"aws.kinesis.stream_name":e.StreamName,streamname:e.StreamName}:{}}storeStreamName(e,t,r){if(!t||"getShardIterator"!==t&&"listShards"!==t)return;if(!e||!e.StreamName)return;const s=e.StreamName;a.enterWith({...r,streamName:s})}responseExtract(e,t,r){if("getRecords"!==t)return;if(e.Limit&&1!==e.Limit)return;if(!r||!r.Records||!r.Records[0])return;const s=r.Records[0];try{const e=JSON.parse(Buffer.from(s.Data).toString());return{maybeChildOf:this.tracer.extract("text_map",e._datadog),parsedAttributes:e._datadog}}catch(e){i.error("Kinesis error extracting response",e)}}responseExtractDSMContext(e,t,r,n,i={}){const{streamName:o}=i;this.config.dsmEnabled&&"getRecords"===e&&r&&r.Records&&r.Records[0]&&(n=r.Records.length>1?null:n,r.Records.forEach((e=>{const t=JSON.parse(Buffer.from(e.Data).toString()),r=s(e.Data);t?._datadog&&this.tracer.decodeDataStreamsContext(t._datadog);const i=o?["direction:in",`topic:${o}`,"type:kinesis"]:["direction:in","type:kinesis"];this.tracer.setCheckpoint(i,n,r)})))}_tryParse(e){try{return JSON.parse(e)}catch(e){i.info("Not JSON string. Trying Base64 encoded JSON string")}try{return JSON.parse(Buffer.from(e,"base64").toString("ascii"),!0)}catch(e){return null}}requestInject(e,t){const{operation:r,params:s}=t;if(!s)return;let n;switch(r){case"putRecord":n=s.StreamArn?s.StreamArn:s.StreamName?s.StreamName:"",this.injectToMessage(e,s,n,!0);break;case"putRecords":n=s.StreamArn?s.StreamArn:s.StreamName?s.StreamName:"";for(let t=0;t<s.Records.length;t++)this.injectToMessage(e,s.Records[t],n,0===t||this.config.batchPropagationEnabled)}}injectToMessage(e,t,r,s){if(!t)return;let o;if((s||this.config.dsmEnabled)&&(o=this._tryParse(t.Data),!o))return void i.error("Unable to parse payload, unable to pass trace context or set DSM checkpoint (if enabled)");const a={};if(s&&this.tracer.inject(e,"text_map",a),this.config.dsmEnabled){o._datadog=a;const t=this.setDSMCheckpoint(e,o,r);n.encode(t,a)}if(0!==Object.keys(a).length){o._datadog=a;const e=Buffer.from(JSON.stringify(o));if(e.length>=1048576)return void i.info("Payload size too large to pass context");t.Data=e}}setDSMCheckpoint(e,t,r){const s=Buffer.from(JSON.stringify(t)).byteLength;return this.tracer.setCheckpoint(["direction:out",`topic:${r}`,"type:kinesis"],e,s)}}},51128:(e,t,r)=>{"use strict";const s=r(75004),n=r(85209);e.exports=class extends n{static get id(){return"lambda"}generateTags(e,t,r){const s={};return e&&e.FunctionName?Object.assign(s,{"resource.name":`${t} ${e.FunctionName}`,functionname:e.FunctionName,"aws.lambda":e.FunctionName}):s}requestInject(e,t){if("invoke"===t.operation&&(t.params||(t.params={}),!t.params.InvocationType||"RequestResponse"===t.params.InvocationType))try{let r={};if(t.params.ClientContext){const e=Buffer.from(t.params.ClientContext,"base64").toString("utf-8");r=JSON.parse(e)}r.custom||(r.custom={}),this.tracer.inject(e,"text_map",r.custom);const s=Buffer.from(JSON.stringify(r)).toString("base64");t.params.ClientContext=s}catch(e){s.error("Lambda error injecting request",e)}}operationFromRequest(e){return"invoke"===e.operation?this.operationName({type:"web",kind:"client"}):this.operationName({id:"aws",type:"web",kind:"client",awsService:"lambda"})}}},65006:(e,t,r)=>{"use strict";const s=r(85209);e.exports=class extends s{static get id(){return"redshift"}generateTags(e,t,r){const s={};return e&&e.ClusterIdentifier?Object.assign(s,{"resource.name":`${t} ${e.ClusterIdentifier}`,"aws.redshift.cluster_identifier":e.ClusterIdentifier,clusteridentifier:e.ClusterIdentifier}):s}}},93657:(e,t,r)=>{"use strict";const s=r(85209),n=r(75004),{generatePointerHash:i}=r(39556),{S3_PTR_KIND:o,SPAN_POINTER_DIRECTION:a}=r(23636);e.exports=class extends s{static get id(){return"s3"}static get peerServicePrecursors(){return["bucketname"]}static get isPayloadReporter(){return!0}generateTags(e,t,r){const s={};return e&&e.Bucket?Object.assign(s,{"resource.name":`${t} ${e.Bucket}`,"aws.s3.bucket_name":e.Bucket,bucketname:e.Bucket}):s}addSpanPointers(e,t){const r=t?.request,s=r?.operation;if(!["putObject","copyObject","completeMultipartUpload"].includes(s))return;const c=r?.params?.Bucket,u=r?.params?.Key;let l=t?.ETag||t?.CopyObjectResult?.ETag||t?.data?.ETag||t?.data?.CopyObjectResult?.ETag;if(!c||!u||!l)return void n.debug("Unable to calculate span pointer hash because of missing parameters.");l.startsWith('"')&&l.endsWith('"')&&(l=l.slice(1,-1));const p=i([c,u,l]);e.addSpanPointer(o,a.DOWNSTREAM,p)}}},97642:(e,t,r)=>{"use strict";const s=r(19684);e.exports=class extends s{static get id(){return"sfn"}}},48677:(e,t,r)=>{"use strict";const{getHeadersSize:s}=r(63011),{DsmPathwayCodec:n}=r(71793),i=r(75004),o=r(85209);e.exports=class extends o{static get id(){return"sns"}static get peerServicePrecursors(){return["topicname"]}static get isPayloadReporter(){return!0}generateTags(e,t,r){if(!e)return{};if(!(e.TopicArn||r.data&&r.data.TopicArn))return{};const s=e.TopicArn||r.data.TopicArn,n=s.split(":"),i=n[n.length-1];return{"resource.name":`${t} ${e.TopicArn||r.data.TopicArn}`,"aws.sns.topic_arn":s,topicname:i}}operationFromRequest(e){switch(e.operation){case"publish":case"publishBatch":return this.operationName({type:"messaging",kind:"producer"})}return this.operationName({id:"aws",type:"web",kind:"client",awsService:"sns"})}requestInject(e,t){const{operation:r,params:s}=t;if(s)switch(r){case"publish":this.injectToMessage(e,s,s.TopicArn,!0);break;case"publishBatch":for(let t=0;t<s.PublishBatchRequestEntries.length;t++)this.injectToMessage(e,s.PublishBatchRequestEntries[t],s.TopicArn,0===t||this.config.batchPropagationEnabled)}}injectToMessage(e,t,r,s){if(t.MessageAttributes||(t.MessageAttributes={}),Object.keys(t.MessageAttributes).length>=10)return void i.info("Message attributes full, skipping trace context injection");const o={};if(s&&(this.tracer.inject(e,"text_map",o),t.MessageAttributes._datadog={DataType:"Binary",BinaryValue:o}),this.config.dsmEnabled){t.MessageAttributes._datadog||(t.MessageAttributes._datadog={DataType:"Binary",BinaryValue:o});const s=this.setDSMCheckpoint(e,t,r);n.encode(s,o)}0!==Object.keys(o).length?t.MessageAttributes._datadog.BinaryValue=Buffer.from(JSON.stringify(o)):t.MessageAttributes._datadog&&delete t.MessageAttributes._datadog}setDSMCheckpoint(e,t,r){if(r){const n=s(t);return this.tracer.setCheckpoint(["direction:out",`topic:${r}`,"type:sns"],e,n)}}}},26242:(e,t,r)=>{"use strict";const s=r(75004),n=r(85209),{storage:i}=r(96882),{getHeadersSize:o}=r(63011),{DsmPathwayCodec:a}=r(71793);e.exports=class extends n{static get id(){return"sqs"}static get peerServicePrecursors(){return["queuename"]}static get isPayloadReporter(){return!0}constructor(...e){super(...e),this.requestTags=new WeakMap,this.addSub("apm:aws:response:start:sqs",(e=>{const{request:t,response:r}=e,s=i.getStore(),n=this,o=this.responseExtract(t.params,t.operation,r);let a,c=null;if(o&&o.datadogContext){e.needsFinish=!0;const r={childOf:o.datadogContext,tags:Object.assign({},this.requestTags.get(t)||{},{"span.kind":"server"})};c=o.parsedAttributes,a=n.tracer.startSpan("aws.response",r),this.enter(a,s)}this.responseExtractDSMContext(t.operation,t.params,r,a||null,{parsedAttributes:c})})),this.addSub("apm:aws:response:finish:sqs",(e=>{const{span:t}=i.getStore();this.finish(t,null,e)}))}operationFromRequest(e){switch(e.operation){case"receiveMessage":return this.operationName({type:"messaging",kind:"consumer"});case"sendMessage":case"sendMessageBatch":return this.operationName({type:"messaging",kind:"producer"})}return this.operationName({id:"aws",type:"web",kind:"client",awsService:"sqs"})}isEnabled(e){const t=this.config;switch(e.operation){case"receiveMessage":return!1!==t.consumer;case"sendMessage":case"sendMessageBatch":return!1!==t.producer;default:return!0}}generateTags(e,t,r){const s={};if(!e||!e.QueueName&&!e.QueueUrl)return s;let n=e.QueueName;switch(e.QueueUrl&&(n=e.QueueUrl.split("/")[e.QueueUrl.split("/").length-1]),Object.assign(s,{"resource.name":`${t} ${e.QueueName||e.QueueUrl}`,"aws.sqs.queue_name":e.QueueName||e.QueueUrl,queuename:n}),t){case"receiveMessage":s["span.type"]="worker",s["span.kind"]="consumer";break;case"sendMessage":case"sendMessageBatch":s["span.kind"]="producer"}return s}responseExtract(e,t,r){if("receiveMessage"!==t)return;if(e.MaxNumberOfMessages&&1!==e.MaxNumberOfMessages)return;if(!r||!r.Messages||!r.Messages[0])return;let s=r.Messages[0];if(s.Body)try{const e=JSON.parse(s.Body);"Notification"===e.Type&&(s=e)}catch(e){}if(!s.MessageAttributes||!s.MessageAttributes._datadog)return;const n=s.MessageAttributes._datadog,i=this.parseDatadogAttributes(n);return i?{datadogContext:this.tracer.extract("text_map",i),parsedAttributes:i}:void 0}parseDatadogAttributes(e){try{if(e.StringValue){const t=e.StringValue;return JSON.parse(t)}if("Binary"===e.Type||"Binary"===e.DataType){const t=Buffer.from(e.Value??e.BinaryValue,"base64");return JSON.parse(t)}}catch(e){s.error("Sqs error parsing DD attributes",e)}}responseExtractDSMContext(e,t,r,s,n={}){let{parsedAttributes:i}=n;this.config.dsmEnabled&&"receiveMessage"===e&&r&&r.Messages&&r.Messages[0]&&(s=r.Messages.length>1?null:s,r.Messages.forEach((e=>{if(!i){if(e.Body)try{const t=JSON.parse(e.Body);"Notification"===t.Type&&(e=t)}catch(e){}!i&&e.MessageAttributes&&e.MessageAttributes._datadog&&(i=this.parseDatadogAttributes(e.MessageAttributes._datadog))}const r=o({Body:e.Body,MessageAttributes:e.MessageAttributes}),n=t.QueueUrl.split("/").pop();i&&this.tracer.decodeDataStreamsContext(i),this.tracer.setCheckpoint(["direction:in",`topic:${n}`,"type:sqs"],s,r)})))}requestInject(e,t){const{operation:r,params:s}=t;if(s)switch(r){case"sendMessage":this.injectToMessage(e,s,s.QueueUrl,!0);break;case"sendMessageBatch":for(let t=0;t<s.Entries.length;t++)this.injectToMessage(e,s.Entries[t],s.QueueUrl,0===t||this.config.batchPropagationEnabled);break;case"receiveMessage":s.MessageAttributeNames?s.MessageAttributeNames.includes("_datadog")||s.MessageAttributeNames.includes(".*")||s.MessageAttributeNames.includes("All")||s.MessageAttributeNames.push("_datadog"):s.MessageAttributeNames=["_datadog"]}}injectToMessage(e,t,r,s){if(t||(t={}),t.MessageAttributes){if(Object.keys(t.MessageAttributes).length>=10)return}else t.MessageAttributes={};const n={};if(s&&(this.tracer.inject(e,"text_map",n),t.MessageAttributes._datadog={DataType:"String",StringValue:JSON.stringify(n)}),this.config.dsmEnabled){t.MessageAttributes._datadog||(t.MessageAttributes._datadog={DataType:"String",StringValue:JSON.stringify(n)});const s=this.setDSMCheckpoint(e,t,r);s&&(a.encode(s,n),t.MessageAttributes._datadog.StringValue=JSON.stringify(n))}t.MessageAttributes._datadog&&0===Object.keys(n).length&&delete t.MessageAttributes._datadog}setDSMCheckpoint(e,t,r){const s=o({Body:t.MessageBody,MessageAttributes:t.MessageAttributes}),n=r.split("/").pop();return this.tracer.setCheckpoint(["direction:out",`topic:${n}`,"type:sqs"],e,s)}}},96525:(e,t,r)=>{"use strict";const s=r(19684);e.exports=class extends s{static get id(){return"states"}}},19684:(e,t,r)=>{"use strict";const s=r(75004),n=r(85209);e.exports=class extends n{static get id(){return"stepfunctions"}generateTags(e,t,r){if(!e)return{};const s={"resource.name":e.name?`${t} ${e.name}`:`${t}`};return"startExecution"!==t&&"startSyncExecution"!==t||(s.statemachinearn=`${e.stateMachineArn}`),s}requestInject(e,t){const r=t.operation;if("startExecution"===r||"startSyncExecution"===r){if(!t.params||!t.params.input)return;const r=t.params.input;try{const s=JSON.parse(r);if(null!==s&&"object"==typeof s){s._datadog={},this.tracer.inject(e,"text_map",s._datadog);const r=JSON.stringify(s);t.params.input=r}}catch(e){s.info("Unable to treat input as JSON")}}}}},39556:(e,t,r)=>{"use strict";const s=r(76982),n=r(75004);function i(e){if(e)try{const t=Object.keys(e)[0],r=e[t];switch(t){case"S":return Buffer.from(r);case"N":return Buffer.from(r.toString());case"B":return Buffer.isBuffer(r)?r:Buffer.from(r);default:n.debug(`Found unknown type while trying to create DynamoDB span pointer: ${t}`)}}catch(e){n.debug(`Failed to encode value while trying to create DynamoDB span pointer: ${e.message}`)}}e.exports={generatePointerHash:function(e){const t=e.join("|");return s.createHash("sha256").update(t).digest("hex").substring(0,32)},encodeValue:i,extractPrimaryKeys:(e,t)=>{const r=Array.from(e);if(0!==r.length)if(1===r.length){const e=i(t[r[0]]);if(e)return[r[0],e,"",""]}else{const[e,s]=r.sort(),n=i(t[e]),o=i(t[s]);if(n&&o)return[e,n,s,o]}}}},93693:(e,t,r)=>{"use strict";const s=r(5288),{storage:n}=r(96882),i=r(67121),o=r(5593),a={deleteRequest:"Http",http:"Http",get:"Http",patch:"Http",post:"Http",put:"Http"};function c(e){return a[e]||"Unknown"}e.exports=class extends s{static get id(){return"azure-functions"}static get operation(){return"invoke"}static get kind(){return"server"}static get type(){return"serverless"}static get prefix(){return"tracing:datadog:azure:functions:invoke"}bindStart(e){const{functionName:t,methodName:r}=e,s=n.getStore(),i=this.startSpan(this.operationName(),{service:this.serviceName(),type:"serverless",meta:{"aas.function.name":t,"aas.function.trigger":c(r)}},!1);return e.span=i,e.parentStore=s,e.currentStore={...s,span:i},e.currentStore}error(e){this.addError(e.error),e.currentStore.span.setTag("error.message",e.error)}asyncEnd(e){const{httpRequest:t,result:r={}}=e,s=new URL(t.url).pathname,n={method:t.method,headers:Object.fromEntries(t.headers.entries()),url:s},a=o.patch(n);a.config=this.config,a.paths=[s],a.res={statusCode:r.status},a.span=e.currentStore.span,i.finishSpan(a)}configure(e){return super.configure(o.normalizeConfig(e))}}},27671:(e,t,r)=>{"use strict";const s=r(15700);e.exports=class extends s{static get id(){return"bunyan"}}},18595:(e,t,r)=>{"use strict";const s=r(42537),n="db.cassandra.contact.points";e.exports=class extends s{static get id(){return"cassandra-driver"}static get system(){return"cassandra"}static get peerServicePrecursors(){return[n]}start({keyspace:e,query:t,contactPoints:r={}}){var s,i;Array.isArray(t)&&(t=t.map((e=>(e.query||e).replace(/;?$/,";"))).join(" ")),this.startSpan(this.operationName(),{service:this.serviceName({pluginConfig:this.config,system:this.system}),resource:(s=t,i=5e3,!s||s.length<=i?s:`${s.substr(0,i-3)}...`),type:"cassandra",kind:"client",meta:{"db.type":"cassandra","cassandra.query":t,"cassandra.keyspace":e,[n]:r.join(",")||null}})}}},25182:(e,t,r)=>{"use strict";const s=r(5288),n=r(76475),i=4096;e.exports=class extends s{static get id(){return"child_process"}static get prefix(){return"tracing:datadog:child_process:execution"}get tracer(){return this._tracer}start({command:e,shell:t}){if("string"!=typeof e)return;const r=n(e),s=function(e){let t=e[0].length,r=!1;for(let s=1;s<e.length;s++){if(t>=i){r=!0,e[s]="";continue}const n=e[s].length;t<i&&t+n>i&&(e[s]=e[s].substring(0,2),r=!0),t+=n}return r}(r),o=!0===t?"cmd.shell":"cmd.exec",a={component:"subprocess",[o]:!0===t?r.join(" "):JSON.stringify(r)};s&&(a["cmd.truncated"]=`${s}`),this.startSpan("command_execution",{service:this.config.service||this._tracerConfig.service,resource:!0===t?"sh":r[0],type:"system",meta:a})}end({result:e,error:t}){let r;if(void 0!==e)r=e?.status||0;else{if(void 0===t)return;r=t?.status||t?.code||0}this.activeSpan?.setTag("cmd.exit_code",`${r}`),this.activeSpan?.finish()}error(e){this.addError(e)}asyncEnd({result:e}){this.activeSpan?.setTag("cmd.exit_code",`${e}`),this.activeSpan?.finish()}}},76475:(e,t,r)=>{"use strict";const s=r(29563),n=["LD_PRELOAD","LD_LIBRARY_PATH","PATH"],i=["md5"],o=/\$([\w\d_]*)(?:[^\w\d_]|$)/gim,a=new RegExp("^-{0,2}(?:p(?:ass(?:w(?:or)?d)?)?|address|api[-_]?key|e?mail|secret(?:[-_]?key)?|a(?:ccess|uth)[-_]?token|mysql_pwd|credentials|(?:stripe)?token)$","i"),c=new RegExp("^(\\w+=\\w+;)*\\w+=\\w+;?$"),u="?";e.exports=function(e){const t=function(e){const t=new Set;let r;for(;r=o.exec(e);)t.add(r[1]);const s={};for(const e of t.keys())s[e]=`$${e}`;return s}(e),r=function(e){const t=[];let r=[],s=!0;return e.forEach((e=>{s&&(t.push(r),s=!1),r.push(e),e.op&&(r=[],s=!0)})),t}(s(e,t)),l=[];return r.forEach((e=>{let t=!1;for(let r=0;r<e.length;r++){const s=e[r];if(null!==s)if("object"==typeof s)s.pattern?l.push(s.pattern):s.op?l.push(s.op):s.comment&&l.push(`#${s.comment}`);else if(t){const t=s.split("="),n=t[0];a.test(n)?1===t.length?(e[r+1]=u,l.push(s)):l.push(`${n}=${u}`):l.push(s)}else if(c.test(s)){const t=s.split("=");if(n.includes(t[0]))l.push(s);else{t[1]=u;const s=t.join("=");e[r]=s,l.push(s)}}else if(t=!0,l.push(s),i.includes(s)){for(r++;r<e.length;r++){const t=e[r];t.op?l.push(t.op):(e[r]=u,l.push(u))}break}}})),l}},37232:(e,t,r)=>{"use strict";const s=r(78693);e.exports=class extends s{static get id(){return"connect"}constructor(...e){super(...e),this.addSub("apm:connect:request:handle",(({req:e})=>{this.setFramework(e,"connect",this.config)}))}}},35753:(e,t,r)=>{"use strict";const s=r(58423),{storage:n}=r(96882);e.exports=class extends s{static get id(){return"couchbase"}static get peerServicePrecursors(){return["db.couchbase.seed.nodes"]}addSubs(e,t){this.addSub(`apm:couchbase:${e}:start`,t),this.addSub(`apm:couchbase:${e}:error`,(e=>this.addError(e))),this.addSub(`apm:couchbase:${e}:finish`,(e=>this.finish(e)))}startSpan(e,t,r,{bucket:s,collection:n,seedNodes:i}){const o={"db.type":"couchbase",component:"couchbase","resource.name":`couchbase.${e}`,"span.kind":this.constructor.kind,"db.couchbase.seed.nodes":i};s&&(o["couchbase.bucket.name"]=s.name),n&&(o["couchbase.collection.name"]=n.name);for(const e in t)o[e]=t[e];return super.startSpan(this.operationName({operation:e}),{service:this.serviceName({pluginConfig:this.config}),meta:o})}constructor(...e){super(...e),this.addSubs("query",(({resource:e,bucket:t,seedNodes:r})=>{const s=n.getStore(),i=this.startSpan("query",{"span.type":"sql","resource.name":e,"span.kind":this.constructor.kind},s,{bucket:t,seedNodes:r});this.enter(i,s)})),this._addCommandSubs("upsert"),this._addCommandSubs("insert"),this._addCommandSubs("replace"),this._addCommandSubs("append"),this._addCommandSubs("prepend")}_addCommandSubs(e){this.addSubs(e,(({bucket:t,collection:r,seedNodes:s})=>{const i=n.getStore(),o=this.startSpan(e,{},i,{bucket:t,collection:r,seedNodes:s});this.enter(o,i)}))}}},88240:(e,t,r)=>{"use strict";const s=r(32028),{storage:n}=r(96882),{TEST_SKIP_REASON:i,TEST_STATUS:o,TEST_SOURCE_START:a,finishAllTraceSpans:c,getTestSuitePath:u,getTestSuiteCommonTags:l,addIntelligentTestRunnerSpanTags:p,TEST_ITR_UNSKIPPABLE:d,TEST_ITR_FORCED_RUN:h,TEST_CODE_OWNERS:f,ITR_CORRELATION_ID:g,TEST_SOURCE_FILE:m,TEST_EARLY_FLAKE_ENABLED:_,TEST_EARLY_FLAKE_ABORT_REASON:y,TEST_IS_NEW:b,TEST_IS_RETRY:v,TEST_SUITE_ID:E,TEST_SESSION_ID:S,TEST_COMMAND:T,TEST_MODULE:w,TEST_MODULE_ID:x,TEST_SUITE:A,CUCUMBER_IS_PARALLEL:I,TEST_RETRY_REASON:k}=r(97507),{RESOURCE_NAME:O}=r(74100),{COMPONENT:R,ERROR_MESSAGE:C}=r(23636),{TELEMETRY_EVENT_CREATED:N,TELEMETRY_EVENT_FINISHED:P,TELEMETRY_CODE_COVERAGE_STARTED:D,TELEMETRY_CODE_COVERAGE_FINISHED:L,TELEMETRY_ITR_FORCED_TO_RUN:M,TELEMETRY_CODE_COVERAGE_EMPTY:q,TELEMETRY_ITR_UNSKIPPABLE:j,TELEMETRY_CODE_COVERAGE_NUM_FILES:U,TEST_IS_RUM_ACTIVE:F,TEST_BROWSER_DRIVER:B,TELEMETRY_TEST_SESSION:$}=r(60806),G=r(94248),V=!!process.env.CUCUMBER_WORKER_ID;e.exports=class extends s{static get id(){return"cucumber"}constructor(...e){super(...e),this.sourceRoot=process.cwd(),this.testSuiteSpanByPath={},this.addSub("ci:cucumber:session:finish",(({status:e,isSuitesSkipped:t,numSkippedSuites:r,testCodeCoverageLinesTotal:s,hasUnskippableSuites:n,hasForcedToRunSuites:i,isEarlyFlakeDetectionEnabled:a,isEarlyFlakeDetectionFaulty:u,isParallel:l})=>{const{isSuitesSkippingEnabled:d,isCodeCoverageEnabled:h}=this.libraryConfig||{};p(this.testSessionSpan,this.testModuleSpan,{isSuitesSkipped:t,isSuitesSkippingEnabled:d,isCodeCoverageEnabled:h,testCodeCoverageLinesTotal:s,skippingCount:r,skippingType:"suite",hasUnskippableSuites:n,hasForcedToRunSuites:i}),a&&this.testSessionSpan.setTag(_,"true"),u&&this.testSessionSpan.setTag(y,"faulty"),l&&this.testSessionSpan.setTag(I,"true"),this.testSessionSpan.setTag(o,e),this.testModuleSpan.setTag(o,e),this.testModuleSpan.finish(),this.telemetry.ciVisEvent(P,"module"),this.testSessionSpan.finish(),this.telemetry.ciVisEvent(P,"session"),c(this.testSessionSpan),this.telemetry.count($,{provider:this.ciProviderName}),this.libraryConfig=null,this.tracer._exporter.flush()})),this.addSub("ci:cucumber:test-suite:start",(({testFileAbsolutePath:e,isUnskippable:t,isForcedToRun:r,itrCorrelationId:s})=>{const n=u(e,process.cwd()),i=u(e,this.repositoryRoot),o=l(this.command,this.frameworkVersion,n,"cucumber");t&&(this.telemetry.count(j,{testLevel:"suite"}),o[d]="true"),r&&(this.telemetry.count(M,{testLevel:"suite"}),o[h]="true"),s&&(o[g]=s),i&&(o[m]=i,o[a]=1);const c=this.getCodeOwners(o);c&&(o[f]=c);const p=this.tracer.startSpan("cucumber.test_suite",{childOf:this.testModuleSpan,tags:{[R]:this.constructor.id,...this.testEnvironmentMetadata,...o}});this.testSuiteSpanByPath[n]=p,this.telemetry.ciVisEvent(N,"suite"),this.libraryConfig?.isCodeCoverageEnabled&&this.telemetry.ciVisEvent(D,"suite",{library:"istanbul"})})),this.addSub("ci:cucumber:test-suite:finish",(({status:e,testSuitePath:t})=>{const r=this.testSuiteSpanByPath[t];r.setTag(o,e),r.finish(),this.telemetry.ciVisEvent(P,"suite")})),this.addSub("ci:cucumber:test-suite:code-coverage",(({coverageFiles:e,suiteFile:t,testSuitePath:r})=>{if(!this.libraryConfig?.isCodeCoverageEnabled)return;e.length||this.telemetry.count(q);const s=this.testSuiteSpanByPath[r],n=[...e,t].map((e=>u(e,this.repositoryRoot)));this.telemetry.distribution(U,{},n.length);const i={sessionId:s.context()._traceId,suiteId:s.context()._spanId,files:n};this.tracer._exporter.exportCoverage(i),this.telemetry.ciVisEvent(L,"suite",{library:"istanbul"})})),this.addSub("ci:cucumber:test:start",(({testName:e,testFileAbsolutePath:t,testSourceLine:r,isParallel:s,promises:i})=>{const o=n.getStore(),c=u(t,this.sourceRoot),l=u(t,this.repositoryRoot),p={[a]:r,[m]:l};s&&(p[I]="true");const d=this.startTestSpan(e,c,p);this.enter(d,o),this.activeTestSpan=d,i&&this.runningTestProbe&&(i.hitBreakpointPromise=new Promise((e=>{setTimeout(e,200)})))})),this.addSub("ci:cucumber:test:retry",(({isFirstAttempt:e,error:t})=>{const r=n.getStore().span;if(e||r.setTag(v,"true"),r.setTag("error",t),e&&this.di&&t&&this.libraryConfig?.isDiEnabled){const e=this.addDiProbe(t);if(e){const{file:t,line:r,stackIndex:s}=e;this.runningTestProbe={file:t,line:r},this.testErrorStackIndex=s}}r.setTag(o,"fail"),r.finish(),c(r)})),this.addSub("ci:cucumber:test-step:start",(({resource:e})=>{const t=n.getStore(),r=t?t.span:t,s=this.tracer.startSpan("cucumber.step",{childOf:r,tags:{[R]:this.constructor.id,"cucumber.step":e,[O]:e}});this.enter(s,t)})),this.addSub("ci:cucumber:worker-report:trace",(e=>{JSON.parse(e).map((e=>e.map((e=>({...e,span_id:G(e.span_id),trace_id:G(e.trace_id),parent_id:G(e.parent_id)}))))).forEach((e=>{e.forEach((e=>{if("cucumber.test"===e.name){const t=e.meta[A],r=function(e){const t={[E]:e.context().toSpanId(),[S]:e.context().toTraceId(),[T]:e.context()._tags[T],[w]:"cucumber"};return e.context()._parentId&&(t[x]=e.context()._parentId.toString(10)),t}(this.testSuiteSpanByPath[t]);e.meta={...e.meta,...r}}})),this.tracer._exporter.export(e)}))})),this.addSub("ci:cucumber:test:finish",(({isStep:e,status:t,skipReason:r,error:s,errorMessage:a,isNew:u,isEfdRetry:l,isFlakyRetry:p})=>{const d=n.getStore().span,h=e?"step.status":o;if(d.setTag(h,t),u&&(d.setTag(b,"true"),l&&(d.setTag(v,"true"),d.setTag(k,"efd"))),r&&d.setTag(i,r),s?d.setTag("error",s):a&&d.setTag(C,a),p>0&&d.setTag(v,"true"),d.finish(),!e){const e=d.context()._tags;this.telemetry.ciVisEvent(P,"test",{hasCodeOwners:!!e[f],isNew:u,isRum:"true"===e[F],browserDriver:e[B]}),c(d),V&&this.tracer._exporter.flush(),this.activeTestSpan=null,this.runningTestProbe&&(this.removeDiProbe(this.runningTestProbe),this.runningTestProbe=null)}})),this.addSub("ci:cucumber:error",(e=>{e&&n.getStore().span.setTag("error",e)}))}startTestSpan(e,t,r){const s=this.testSuiteSpanByPath[t];return super.startTestSpan(e,t,s,r)}}},74257:(e,t,r)=>{const s=r(12583);e.exports=class extends s{static get id(){return"cypress"}}},40653:(e,t,r)=>{"use strict";const s=r(12583),n=r(95608).manager.namespace("tracers"),i=new WeakMap,o="injection_enabled:"+(process.env.DD_INJECTION_ENABLED?"yes":"no");e.exports=class extends s{static get id(){return"dd-trace-api"}constructor(...e){super(...e);const t=this._tracer;this.addSub("datadog-api:v1:tracerinit",(({proxy:e})=>{const r=e();i.set(r,t),i.set(r.appsec,t.appsec),i.set(r.dogstatsd,t.dogstatsd)}));const r=e=>{const t=n.count("dd_trace_api.called",[`name:${e.replaceAll(":",".")}`,"api_version:v1",o]);this.addSub(`datadog-api:v1:${e}`,(({self:r,args:s,ret:n,proxy:o,revProxy:a})=>{t.inc(),e.includes(":")&&(e=e.split(":").pop()),i.has(r)&&(r=i.get(r));for(let e=0;e<s.length;e++)if(i.has(s[e])&&(s[e]=i.get(s[e])),"function"==typeof s[e]){const t=s[e];s[e]=(...e)=>{for(let t=0;t<e.length;t++)if(a&&a[t]){const r=a[t]();i.set(r,e[t]),e[t]=r}return t(...e)}}try{if(n.value=r[e](...s),o){const e=o();i.set(e,n.value),n.value=e}else if(n.value&&"object"==typeof n.value)throw new TypeError(`Objects need proxies when returned via API (${e})`)}catch(e){n.error=e}}))};r("startSpan"),r("wrap"),r("trace"),r("inject"),r("extract"),r("getRumData"),r("profilerStarted"),r("context:toTraceId"),r("context:toSpanId"),r("context:toTraceparent"),r("span:context"),r("span:setTag"),r("span:addTags"),r("span:finish"),r("span:addLink"),r("scope"),r("scope:activate"),r("scope:active"),r("scope:bind"),r("appsec:blockRequest"),r("appsec:isUserBlocked"),r("appsec:setUser"),r("appsec:trackCustomEvent"),r("appsec:trackUserLoginFailureEvent"),r("appsec:trackUserLoginSuccessEvent"),r("dogstatsd:decrement"),r("dogstatsd:distribution"),r("dogstatsd:flush"),r("dogstatsd:gauge"),r("dogstatsd:histogram"),r("dogstatsd:increment"),r("use")}}},13653:(e,t,r)=>{"use strict";const s=r(42257),n=r(11679),i=r(19059),o=r(67561),a=r(47623);e.exports=class extends s{static get id(){return"dns"}static get plugins(){return{lookup:n,lookup_service:i,resolve:o,reverse:a}}}},11679:(e,t,r)=>{"use strict";const s=r(77723);e.exports=class extends s{static get id(){return"dns"}static get operation(){return"lookup"}start([e]){this.startSpan("dns.lookup",{service:this.config.service,resource:e,kind:"client",meta:{"dns.hostname":e,"dns.address":"","dns.addresses":""}})}finish(e){const t=this.activeSpan;if(Array.isArray(e)){const r=Array.isArray(e)?e.map((e=>e.address)).sort():[e];t.setTag("dns.address",r[0]),t.setTag("dns.addresses",r.join(","))}else t.setTag("dns.address",e);super.finish()}}},19059:(e,t,r)=>{"use strict";const s=r(77723);e.exports=class extends s{static get id(){return"dns"}static get operation(){return"lookup_service"}start([e,t]){this.startSpan("dns.lookup_service",{service:this.config.service,resource:`${e}:${t}`,kind:"client",meta:{"dns.address":e},metrics:{"dns.port":t}})}}},67561:(e,t,r)=>{"use strict";const s=r(77723);e.exports=class extends s{static get id(){return"dns"}static get operation(){return"resolve"}start([e,t]){const r="string"==typeof t?t:"A";this.startSpan("dns.resolve",{service:this.config.service,resource:`${r} ${e}`,kind:"client",meta:{"dns.hostname":e,"dns.rrtype":r}})}}},47623:(e,t,r)=>{"use strict";const s=r(77723);e.exports=class extends s{static get id(){return"dns"}static get operation(){return"reverse"}start([e]){this.startSpan("dns.reverse",{service:this.config.service,resource:e,kind:"client",meta:{"dns.ip":e}})}}},45613:(e,t,r)=>{"use strict";const s=r(42537);e.exports=class extends s{static get id(){return"elasticsearch"}start({params:e}){const t=function(e){return e&&JSON.stringify(e)}(e.body||e.bulkBody);var r;this.startSpan(this.operationName(),{service:this.serviceName({pluginConfig:this.config}),resource:`${e.method} ${r=e.path,r&&r.replace(/[0-9]+/g,"?")}`,type:"elasticsearch",kind:"client",meta:{"db.type":this.system,[`${this.system}.url`]:e.path,[`${this.system}.method`]:e.method,[`${this.system}.body`]:t,[`${this.system}.params`]:JSON.stringify(e.querystring||e.query)}})}finish({params:e}){const t=this.activeSpan;this.config.hooks.query(t,e),super.finish({params:e})}}},51450:(e,t,r)=>{"use strict";const s=r(78693);e.exports=class extends s{static get id(){return"express"}constructor(...e){super(...e),this.addSub("apm:express:request:handle",(({req:e})=>{this.setFramework(e,"express",this.config)}))}}},55770:(e,t,r)=>{"use strict";const{entryTags:s}=r(8437),n=r(12583),i=r(5593),o=Symbol("datadog.codeOriginForSpansTags");e.exports=class extends n{static get id(){return"fastify"}constructor(...e){super(...e),this.addSub("apm:fastify:request:handle",(({req:e,routeConfig:t})=>{const r=t?.[o];if(!r)return;const s=i.getContext(e);s.span?.addTags(r)})),this.addSub("apm:fastify:route:added",(({routeOptions:e,onRoute:t})=>{e.config||(e.config={}),e.config[o]=s(t)}))}}},85202:(e,t,r)=>{"use strict";const s=r(76696),n=r(55770),i=r(42257);e.exports=class extends i{static get id(){return"fastify"}static get plugins(){return{tracing:s,codeOriginForSpans:n}}}},76696:(e,t,r)=>{"use strict";const s=r(78693);e.exports=class extends s{static get id(){return"fastify"}constructor(...e){super(...e),this.addSub("apm:fastify:request:handle",(({req:e})=>{this.setFramework(e,"fastify",this.config)}))}}},87222:(e,t,r)=>{"use strict";const s=r(28725);e.exports=class extends s{static get id(){return"fetch"}static get prefix(){return"tracing:apm:fetch:request"}bindStart(e){const t=e.req,r=new URL(t.url);r.headers=Object.fromEntries(t.headers.entries()),r.method=t.method,e.args={options:r};const s=super.bindStart(e);for(const e in r.headers)t.headers.has(e)||t.headers.set(e,r.headers[e]);return s}error(e){if("AbortError"!==e.error.name)return super.error(e)}asyncEnd(e){return e.res=e.result,this.finish(e)}}},29160:(e,t,r)=>{"use strict";const s=r(12583),n=r(5593);e.exports=class extends s{static get id(){return"find-my-way"}constructor(...e){super(...e),this.addSub("apm:find-my-way:request:route",(({req:e,route:t})=>{n.setRoute(e,t)}))}}},71276:(e,t,r)=>{"use strict";const s=r(77723);e.exports=class extends s{static get id(){return"google-cloud-pubsub"}static get type(){return"messaging"}static get operation(){return"request"}start({request:e,api:t,projectId:r}){"publish"!==t&&this.startSpan(this.operationName(),{service:this.config.service||this.serviceName(),resource:[t,e.name].filter((e=>e)).join(" "),kind:this.constructor.kind,meta:{"pubsub.method":t,"gcloud.project_id":r}})}}},95899:(e,t,r)=>{"use strict";const{getMessageSize:s}=r(63011),n=r(57232);e.exports=class extends n{static get id(){return"google-cloud-pubsub"}static get operation(){return"receive"}start({message:e}){const t=e._subscriber._subscription,r=t.metadata&&t.metadata.topic,n=this.tracer.extract("text_map",e.attributes)||null,i=this.startSpan({childOf:n,resource:r,type:"worker",meta:{"gcloud.project_id":t.pubsub.projectId,"pubsub.topic":r},metrics:{"pubsub.ack":0}});if(this.config.dsmEnabled&&e?.attributes){const t=s(e);this.tracer.decodeDataStreamsContext(e.attributes),this.tracer.setCheckpoint(["direction:in",`topic:${r}`,"type:google-pubsub"],i,t)}}finish(e){const t=this.activeSpan;t&&(e.message._handled&&t.setTag("pubsub.ack",1),super.finish())}}},1219:(e,t,r)=>{"use strict";const s=r(53581),n=r(95899),i=r(71276),o=r(42257);e.exports=class extends o{static get id(){return"google-cloud-pubsub"}static get plugins(){return{producer:s,consumer:n,client:i}}}},53581:(e,t,r)=>{"use strict";const s=r(36878),{DsmPathwayCodec:n}=r(71793),{getHeadersSize:i}=r(63011);e.exports=class extends s{static get id(){return"google-cloud-pubsub"}static get operation(){return"request"}start({request:e,api:t,projectId:r}){if("publish"!==t)return;const s=e.messages||[],o=e.topic,a=this.startSpan({resource:`${t} ${o}`,meta:{"gcloud.project_id":r,"pubsub.method":t,"pubsub.topic":o}});for(const e of s)if(e.attributes||(e.attributes={}),this.tracer.inject(a,"text_map",e.attributes),this.config.dsmEnabled){const t=i(e),r=this.tracer.setCheckpoint(["direction:out",`topic:${o}`,"type:google-pubsub"],a,t);n.encode(r,e.attributes)}}}},83800:(e,t,r)=>{"use strict";const s=r(5288),{extractErrorIntoSpanEvent:n}=r(65322);let i;function o(e,t,s,n){if(!1!==n&&!1!==i)try{try{i=i||r(94275)}catch(e){throw i=!1,e}return i.defaultEngineReportingSignature(e,t)}catch(e){}return[s,t].filter((e=>e)).join(" ")}e.exports=class extends s{static get id(){return"graphql"}static get operation(){return"execute"}static get type(){return"graphql"}static get kind(){return"server"}start({operation:e,args:t,docSource:r}){const s=e&&e.operation,n=e&&e.name&&e.name.value,i=t.document,a=this.config.source&&i&&r,c=this.startSpan(this.operationName(),{service:this.config.service||this.serviceName(),resource:o(i,n,s,this.config.signature),kind:this.constructor.kind,type:this.constructor.type,meta:{"graphql.operation.type":s,"graphql.operation.name":n,"graphql.source":a}});!function(e,t,r){const s={};if(r&&e.variables){const t=e.variables(r);for(const e in t)s[`graphql.variables.${e}`]=t[e]}t.addTags(s)}(this.config,c,t.variableValues)}finish({res:e,args:t}){const r=this.activeSpan;if(this.config.hooks.execute(r,t,e),e?.errors)for(const t of e.errors)n(this._tracerConfig,r,t);super.finish()}}},20655:(e,t,r)=>{"use strict";const s=r(62963),n=r(42257),i=r(75004),o=r(83800),a=r(94616),c=r(88301),u=r(67871);function l(e){return"number"==typeof e.depth?e.depth:(e.hasOwnProperty("depth")&&i.error("Expected `depth` to be a integer."),-1)}function p(e){return"function"==typeof e.variables?e.variables:e.variables instanceof Array?t=>s(t,e.variables):(e.hasOwnProperty("variables")&&i.error("Expected `variables` to be an array or function."),null)}function d(e){const t=()=>{};return{execute:e.hooks?.execute||t,parse:e.hooks?.parse||t,validate:e.hooks?.validate||t}}e.exports=class extends n{static get id(){return"graphql"}static get plugins(){return{execute:o,parse:a,validate:c,resolve:u}}configure(e){return super.configure(function(e){return Object.assign({},e,{depth:l(e),variables:p(e),collapse:void 0===e.collapse||!!e.collapse,hooks:d(e)})}(e))}}},94616:(e,t,r)=>{"use strict";const s=r(5288);e.exports=class extends s{static get id(){return"graphql"}static get operation(){return"parser"}start(){this.startSpan("graphql.parse",{service:this.config.service,type:"graphql",meta:{"graphql.source":""}})}finish({source:e,document:t,docSource:r}){const s=this.activeSpan;this.config.source&&t&&s.setTag("graphql.source",r),this.config.hooks.parse(s,e,t),super.finish()}}},67871:(e,t,r)=>{"use strict";const s=r(5288),n=r(1247),i=Symbol("collapsedPaths");function o(e,t){const r=t.filter((e=>"string"==typeof e)).length;return e.depth<0||e.depth>=r}function a(e,t){const r=t.collapse?function(e){return function(){return e.apply(this,arguments).map((e=>"number"==typeof e?"*":e))}}(c):c;return r(e&&e.path)}function c(e){const t=[];let r=e;for(;r;)t.push(r.key),r=r.prev;return t.reverse()}function u(e,t){let r=null;const s={};t&&Object.keys(t).length&&Object.assign(s,t);const n=e.fieldNodes?.[0]?.directives;if(Array.isArray(n))for(const e of n){const t={};for(const r of e.arguments)t[r.name.value]=r.value.value;Object.keys(t).length&&(s[e.name.value]=t)}return Object.keys(s).length&&(r={[e.fieldName]:s}),r}e.exports=class extends s{static get id(){return"graphql"}static get operation(){return"resolve"}start({info:e,context:t,args:r}){const s=a(e,this.config);if(!o(this.config,s))return;const n=s.join(".");if(this.config.collapse){if(t[i]||(t[i]={}),t.fields[n])return;if(t[i][n])return;t[i][n]=!0}const c=t.source,l=e.fieldNodes.find((e=>"Field"===e.kind)),p=this.config.source&&c&&l&&l.loc,d=p&&c.substring(p.start,p.end),h=this.startSpan("graphql.resolve",{service:this.config.service,resource:`${e.fieldName}:${e.returnType}`,type:"graphql",meta:{"graphql.field.name":e.fieldName,"graphql.field.path":n,"graphql.field.type":e.returnType.name,"graphql.source":d}});if(l&&this.config.variables&&l.arguments){const t=this.config.variables(e.variableValues);l.arguments.filter((e=>e.value&&"Variable"===e.value.kind)).filter((e=>e.value.name&&t[e.value.name.value])).map((e=>e.value.name.value)).forEach((e=>{h.setTag(`graphql.variables.${e}`,t[e])}))}this.resolverStartCh.hasSubscribers&&this.resolverStartCh.publish({context:t,resolverInfo:u(e,r)})}constructor(...e){super(...e),this.addTraceSub("updateField",(({field:e,info:t,err:r})=>{const s=a(t,this.config);if(!o(this.config,s))return;const n=this.activeSpan;e.finishTime=n._getTime?n._getTime():0,e.error=e.error||r})),this.resolverStartCh=n.channel("datadog:graphql:resolver:start")}configure(e){super.configure(0!==e.depth&&e)}finish(e){this.activeSpan.finish(e)}}},94275:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r(68461);t.defaultEngineReportingSignature=s.defaultEngineReportingSignature},68461:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(2294);t.defaultEngineReportingSignature=function(e,t){return s.printWithReducedWhitespace(s.sortAST(s.removeAliases(s.hideLiterals(s.dropUnusedDefinitions(e,t)))))}},2294:function(e,t,r){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(9111),i=r(70585),o=r(24889),a=s(r(68479));function c(e){if(e)return a.default.apply(null,arguments)}t.hideLiterals=function(e){return n.visit(e,{IntValue:e=>Object.assign({},e,{value:"0"}),FloatValue:e=>Object.assign({},e,{value:"0"}),StringValue:e=>Object.assign({},e,{value:"",block:!1}),ListValue:e=>Object.assign({},e,{values:[]}),ObjectValue:e=>Object.assign({},e,{fields:[]})})},t.hideStringAndNumericLiterals=function(e){return n.visit(e,{IntValue:e=>Object.assign({},e,{value:"0"}),FloatValue:e=>Object.assign({},e,{value:"0"}),StringValue:e=>Object.assign({},e,{value:"",block:!1})})},t.dropUnusedDefinitions=function(e,t){return o.separateOperations(e)[t]||e},t.sortAST=function(e){return n.visit(e,{OperationDefinition:e=>Object.assign({},e,{variableDefinitions:c(e.variableDefinitions,"variable.name.value")}),SelectionSet:e=>Object.assign({},e,{selections:a.default(e.selections,"kind","name.value")}),Field:e=>Object.assign({},e,{arguments:c(e.arguments,"name.value")}),FragmentSpread:e=>Object.assign({},e,{directives:c(e.directives,"name.value")}),InlineFragment:e=>Object.assign({},e,{directives:c(e.directives,"name.value")}),FragmentDefinition:e=>Object.assign({},e,{directives:c(e.directives,"name.value"),variableDefinitions:c(e.variableDefinitions,"variable.name.value")}),Directive:e=>Object.assign({},e,{arguments:c(e.arguments,"name.value")})})},t.removeAliases=function(e){return n.visit(e,{Field:e=>Object.assign({},e,{alias:void 0})})},t.printWithReducedWhitespace=function(e){const t=n.visit(e,{StringValue:e=>Object.assign({},e,{value:Buffer.from(e.value,"utf8").toString("hex"),block:!1})});return i.print(t).replace(/\s+/g," ").replace(/([^_a-zA-Z0-9]) /g,((e,t)=>t)).replace(/ ([^_a-zA-Z0-9])/g,((e,t)=>t)).replace(/"([a-f0-9]+)"/g,((e,t)=>JSON.stringify(Buffer.from(t,"hex").toString("utf8"))))}},65322:e=>{e.exports={extractErrorIntoSpanEvent:function(e,t,r){const s={};if(r.name&&(s.type=r.name),r.stack&&(s.stacktrace=r.stack),r.locations){s.locations=[];for(const e of r.locations)s.locations.push(`${e.line}:${e.column}`)}if(r.path&&(s.path=r.path.map(String)),r.message&&(s.message=r.message),e.graphqlErrorExtensions)for(const t of e.graphqlErrorExtensions)r.extensions?.[t]&&(s[`extensions.${t}`]=r.extensions[t].toString());t.addEvent("dd.graphql.query.error",s,Date.now())}}},88301:(e,t,r)=>{"use strict";const s=r(5288),{extractErrorIntoSpanEvent:n}=r(65322);e.exports=class extends s{static get id(){return"graphql"}static get operation(){return"validate"}start({docSource:e,document:t}){const r=this.config.source&&t&&e;this.startSpan("graphql.validate",{service:this.config.service,type:"graphql",meta:{"graphql.source":r}})}finish({document:e,errors:t}){const r=this.activeSpan;if(this.config.hooks.validate(r,e,t),t)for(const e of t)n(this._tracerConfig,r,e);super.finish()}}},22413:(e,t,r)=>{"use strict";const{storage:s}=r(96882),n=r(77723),{TEXT_MAP:i}=r(59429),{addMetadataTags:o,getFilter:a,getMethodMetadata:c}=r(54422);e.exports=class extends n{static get id(){return"grpc"}static get operation(){return"client:request"}static get prefix(){return"apm:grpc:client:request"}static get peerServicePrecursors(){return["rpc.service"]}constructor(...e){super(...e),this.addTraceBind("emit",(({parentStore:e})=>e))}bindStart(e){const t=s.getStore(),{metadata:r,path:n,type:a}=e,u=this.config.metadataFilter,l=c(n,a),p=this.startSpan(this.operationName(),{service:this.config.service||this.serviceName(),resource:n,kind:"client",type:"http",meta:{component:"grpc","grpc.method.kind":l.kind,"grpc.method.path":l.path,"grpc.method.name":l.name,"grpc.method.service":l.service,"grpc.method.package":l.package},metrics:{"grpc.status.code":0}},!1);return l.service&&l.package&&p.setTag("rpc.service",l.package+"."+l.service),r&&(o(p,r,u,"request"),function(e,t,r){if("function"!=typeof r.set)return;const s={};e.inject(t,i,s);for(const e in s)r.set(e,s[e])}(this.tracer,p,r)),e.span=p,e.parentStore=t,e.currentStore={...t,span:p},e.currentStore}bindAsyncStart({parentStore:e}){return e}error({span:e=this.activeSpan,error:t}){this.addCode(e,t.code),t.code&&!this._tracerConfig.grpc.client.error.statuses.includes(t.code)||this.addError(t,e)}finish({span:e,result:t,peer:r}){if(!e)return;const{code:s,metadata:n}=t||{},i=this.config.metadataFilter;if(this.addCode(e,s),n&&i&&o(e,n,i,"response"),r){const t=r.split(":");if(t[t.length-1].match(/^\d+/)){const r=t[t.length-1],s=t.slice(0,-1).join(":");e.setTag("network.destination.ip",s),e.setTag("network.destination.port",r)}else e.setTag("network.destination.ip",r)}this.tagPeerService(e),e.finish()}configure(e){const t=a(e,"metadata");return super.configure({...e,metadataFilter:t})}addCode(e,t){void 0!==t&&e&&e.setTag("grpc.status.code",t)}}},93940:(e,t,r)=>{"use strict";const s=r(52009),n=r(22413),i=r(42257);e.exports=class extends i{static get id(){return"grpc"}static get plugins(){return{server:s,client:n}}}},52009:(e,t,r)=>{"use strict";const{storage:s}=r(96882),n=r(38103),{TEXT_MAP:i}=r(59429),{addMetadataTags:o,getFilter:a,getMethodMetadata:c}=r(54422);e.exports=class extends n{static get id(){return"grpc"}static get operation(){return"server:request"}static get prefix(){return"apm:grpc:server:request"}constructor(...e){super(...e),this.addTraceSub("update",(({code:e})=>{const t=this.activeSpan;t&&this.addCode(t,e)})),this.addTraceBind("emit",(({currentStore:e})=>e))}bindStart(e){const t=s.getStore(),{name:r,metadata:n,type:a}=e,u=this.config.metadataFilter,l=function(e,t){return t&&"function"==typeof t.getMap?e.extract(i,t.getMap()):null}(this.tracer,n),p=c(r,a),d=this.startSpan(this.operationName(),{childOf:l,service:this.config.service||this.serviceName(),resource:r,kind:"server",type:"web",meta:{component:"grpc","grpc.method.kind":p.kind,"grpc.method.path":p.path,"grpc.method.name":p.name,"grpc.method.service":p.service,"grpc.method.package":p.package},metrics:{"grpc.status.code":0}});return o(d,n,u,"request"),e.span=d,e.parentStore=t,e.currentStore={...t,span:d},e.currentStore}bindAsyncStart({parentStore:e}){return e}error({error:e}){const t=this.activeSpan;t&&(this.addCode(t,e.code),e.code&&!this._tracerConfig.grpc.server.error.statuses.includes(e.code)||this.addError(e))}finish({span:e,code:t,trailer:r}){if(!e)return;const s=this.config.metadataFilter;this.addCode(e,t),r&&s&&o(e,r,s,"response"),e.finish()}configure(e){const t=a(e,"metadata");return super.configure({...e,metadataFilter:t})}addCode(e,t){void 0!==t&&e.setTag("grpc.status.code",t)}}},54422:(e,t,r)=>{"use strict";const s=r(62963),n=r(75004);e.exports={getMethodMetadata(e,t){const r={path:e,kind:t,name:"",service:"",package:""};if("string"!=typeof e)return r;const s=e.split("/");if(s.length>2){const e=s[1].split("."),t=s[2],n=e.pop(),i=e.join(".");r.name=t,r.service=n,r.package=i}else r.name=s[s.length-1];return r},addMetadataTags(e,t,r,s){if(!t||"function"!=typeof t.getMap)return;const n=r(t.getMap());for(const t in n)e.setTag(`grpc.${s}.metadata.${t}`,n[t])},getFilter:(e,t)=>"function"==typeof e[t]?e[t]:e[t]instanceof Array?r=>s(r,e[t]):(e.hasOwnProperty(t)&&n.error("Expected '%s' to be an array or function.",t),()=>({}))}},68292:(e,t,r)=>{"use strict";const{storage:s}=r(96882),n=r(78693),i=r(5593);e.exports=class extends n{static get id(){return"hapi"}constructor(...e){super(...e),this._requestSpans=new WeakMap,this.addSub("apm:hapi:request:handle",(({req:e})=>{const t=s.getStore(),r=t&&t.span;this.setFramework(e,"hapi",this.config),this._requestSpans.set(e,r)})),this.addSub("apm:hapi:request:route",(({req:e,route:t})=>{i.setRoute(e,t)})),this.addSub("apm:hapi:request:error",(e=>{e&&e.isBoom&&this.config.validateStatus(e.output.statusCode)||this.addError(e)})),this.addBind("apm:hapi:extension:start",(({req:e})=>this._requestSpans.get(e)))}}},28725:(e,t,r)=>{"use strict";const s=r(77723),{storage:n}=r(96882),i=r(74100),o=r(88378),a=r(59429).HTTP_HEADERS,c=r(70240),u=r(75004),{CLIENT_PORT_KEY:l,COMPONENT:p,ERROR_MESSAGE:d,ERROR_TYPE:h,ERROR_STACK:f}=r(23636),{URL:g}=r(87016),m=i.HTTP_STATUS_CODE,_=i.HTTP_REQUEST_HEADERS,y=i.HTTP_RESPONSE_HEADERS;function b(e){return e=Object.assign({},e,{blocklist:e.blocklist||[]}),c.getFilter(e)}function v(e){return"string"==typeof e?new g(e).host:{host:e.hostname||e.host||"localhost",port:e.port}}e.exports=class extends s{static get id(){return"http"}static get prefix(){return"apm:http:client:request"}bindStart(e){const{args:t,http:r={}}=e,s=n.getStore(),i=t.options,c=i.agent||i._defaultAgent||r.globalAgent||{},u=i.protocol||c.protocol||"http:",d=i.hostname||i.host||"localhost",h=i.port?`${d}:${i.port}`:d,f=i.path||i.pathname,g=`${u}//${h}${f?f.split(/[?#]/)[0]:"/"}`,m=this.config.filter(g),_=(i.method||"GET").toUpperCase(),y=s&&m?s.span:null,b=this.startSpan(this.operationName(),{childOf:y,meta:{[p]:this.constructor.id,"span.kind":"client","service.name":this.serviceName({pluginConfig:this.config,sessionDetails:v(i)}),"resource.name":_,"span.type":"http","http.method":_,"http.url":g,"out.host":d},metrics:{[l]:parseInt(i.port)}},!1);return m||(b._spanContext._trace.record=!1),this.shouldInjectTraceHeaders(i,g)&&(i.headers=Object.assign({},i.headers),this.tracer.inject(b,a,i.headers)),o.sample(b,this.config.measured),e.span=b,e.parentStore=s,e.currentStore={...s,span:b},e.currentStore}shouldInjectTraceHeaders(e,t){return!!this.config.propagationFilter(t)}bindAsyncStart({parentStore:e}){return e}finish({req:e,res:t,span:r}){if(r){if(t){const e=t.status||t.statusCode;r.setTag(m,e),this.config.validateStatus(e)||r.setTag("error",1),function(e,t,r){if(!e.headers)return;const s="function"==typeof e.headers.entries?Object.fromEntries(e.headers.entries()):e.headers;r.headers.forEach((([e,r])=>{const n=s[e];n&&t.setTag(r||`${y}.${e}`,n)}))}(t,r,this.config)}!function(e,t,r){const s=e.headers&&"function"==typeof e.headers.entries?Object.fromEntries(e.headers.entries()):e.headers||e.getHeaders();r.headers.forEach((([e,r])=>{const n=Array.isArray(s[e])?s[e].toString():s[e];n&&t.setTag(r||`${_}.${e}`,n)}))}(e,r,this.config),this.config.hooks.request(r,e,t),this.tagPeerService(r),r.finish()}}error({span:e,error:t,args:r,customRequestTimeout:s}){if(e)if(t)e.addTags({[h]:t.name,[d]:t.message||t.code,[f]:t.stack});else{if(!r.options.agent?.options?.timeout&&!s)return;e.setTag("error",1)}}configure(e){return super.configure(function(e){const t=function(e){return"function"==typeof e.validateStatus?e.validateStatus:(e.hasOwnProperty("validateStatus")&&u.error("Expected `validateStatus` to be a function."),e=>e<400||e>=500)}(e),r=b(e),s=b({blocklist:e.propagationBlocklist}),n=function(e){return Array.isArray(e.headers)?e.headers.filter((e=>"string"==typeof e)).map((e=>e.split(":"))).map((([e,t])=>[e.toLowerCase(),t])):[]}(e),i=function(e){return{request:e.hooks&&e.hooks.request||(()=>{})}}(e);return Object.assign({},e,{validateStatus:t,filter:r,propagationFilter:s,headers:n,hooks:i})}(e))}}},81068:(e,t,r)=>{"use strict";const s=r(28193),n=r(28725),i=r(42257);e.exports=class extends i{static get id(){return"http"}static get plugins(){return{server:s,client:n}}}},28193:(e,t,r)=>{"use strict";const s=r(38103),{storage:n}=r(96882),i=r(5593),{incomingHttpRequestStart:o,incomingHttpRequestEnd:a}=r(69932),{COMPONENT:c}=r(23636);e.exports=class extends s{static get id(){return"http"}constructor(...e){super(...e),this._parentStore=void 0,this.addTraceSub("exit",(e=>this.exit(e)))}addTraceSub(e,t){this.addSub(`apm:${this.constructor.id}:server:${this.operation}:${e}`,t)}start({req:e,res:t,abortController:r}){const s=n.getStore(),a=i.startSpan(this.tracer,{...this.config,service:this.config.service||this.serviceName()},e,t,this.operationName());a.setTag(c,this.constructor.id),this._parentStore=s,this.enter(a,{...s,req:e,res:t});const u=i.getContext(e);u.instrumented||(u.res.writeHead=i.wrapWriteHead(u),u.instrumented=!0),o.hasSubscribers&&o.publish({req:e,res:t,abortController:r})}error(e){i.addError(e)}finish({req:e}){const t=i.getContext(e);t&&t.res&&(a.hasSubscribers&&a.publish({req:e,res:t.res}),i.finishAll(t))}exit({req:e}){const t=this._parentStore&&this._parentStore.span;this.enter(t,this._parentStore),this._parentStore=void 0}configure(e){return super.configure(i.normalizeConfig(e))}}},91581:(e,t,r)=>{"use strict";const{storage:s}=r(96882),n=r(77723),i=r(87016).URL,o=r(75004),a=r(74100),c=r(79386),u=r(59429),{COMPONENT:l,CLIENT_PORT_KEY:p}=r(23636),d=r(70240),h=u.HTTP_HEADERS,f=a.HTTP_STATUS_CODE,g=a.HTTP_REQUEST_HEADERS,m=a.HTTP_RESPONSE_HEADERS,_=a.SPAN_KIND,y=c.CLIENT;function b(e,t,r,s){t&&s.headers.forEach((s=>{const n=t[s];n&&e.setTag(`${r}.${s}`,n)}))}e.exports=class extends n{static get id(){return"http2"}static get prefix(){return"apm:http2:client:request"}bindStart(e){const{authority:t,options:r,headers:n={}}=e,o=function(e,t){"string"==typeof e&&(e=new i(e));const r=e.protocol||t.protocol||"https:";let s=""+(""!==e.port?e.port:"http:"===e.protocol?80:443),n=e.hostname||e.host||"localhost";return"https:"===r&&t&&(s=t.port||s,n=t.host||n),{protocol:r,port:s,host:n}}(t,r),a=n[":path"]||"/",c=a.split(/[?#]/)[0],u=n[":method"]||"GET",d=`${o.protocol}//${o.host}:${o.port}${c}`,f=this.config.filter(d),m=s.getStore(),v=m&&f?m.span:null,E=this.startSpan(this.operationName(),{childOf:v,meta:{[l]:this.constructor.id,[_]:y,"service.name":this.serviceName({pluginConfig:this.config,sessionDetails:o}),"resource.name":u,"span.type":"http","http.method":u,"http.url":d,"out.host":o.host},metrics:{[p]:parseInt(o.port)}},!1);return f||(E._spanContext._trace.record=!1),b(E,n,g,this.config),function(e,t){if(e){if((e=Object.keys(e).reduce(((t,r)=>Object.assign(t,{[r.toLowerCase()]:e[r]})),{}))["x-amz-signature"])return!0;if([].concat(e.authorization).some((e=>String(e).startsWith("AWS4-HMAC-SHA256"))))return!0}return t&&-1!==t.toLowerCase().indexOf("x-amz-signature=")}(n,a)||this.tracer.inject(E,h,n),e.parentStore=m,e.currentStore={...m,span:E},e.currentStore}bindAsyncStart({eventName:e,eventData:t,currentStore:r,parentStore:n}){switch(e){case"response":return this._onResponse(r,t),n;case"error":return this._onError(r,t),n;case"close":return this._onClose(r,t),n}return s.getStore()}configure(e){return super.configure(function(e){const t=function(e){return"function"==typeof e.validateStatus?e.validateStatus:(e.hasOwnProperty("validateStatus")&&o.error("Expected `validateStatus` to be a function."),e=>e<400||e>=500)}(e),r=function(e){return e=Object.assign({},e,{blocklist:e.blocklist||[]}),d.getFilter(e)}(e),s=function(e){return Array.isArray(e.headers)?e.headers.filter((e=>"string"==typeof e)).map((e=>e.toLowerCase())):[]}(e);return Object.assign({},e,{validateStatus:t,filter:r,headers:s})}(e))}_onResponse(e,t){const r=t&&t[":status"];e.span.setTag(f,r),this.config.validateStatus(r)||s.run(e,(()=>this.addError())),b(e.span,t,m,this.config)}_onError({span:e},t){e.setTag("error",t),e.finish()}_onClose({span:e}){this.tagPeerService(e),e.finish()}}},98436:(e,t,r)=>{"use strict";const s=r(43577),n=r(91581),i=r(42257);e.exports=class extends i{static get id(){return"http2"}static get plugins(){return{server:s,client:n}}}},43577:(e,t,r)=>{"use strict";const s=r(38103),{storage:n}=r(96882),i=r(5593),{COMPONENT:o}=r(23636);e.exports=class extends s{static get id(){return"http2"}addTraceSub(e,t){this.addSub(`apm:${this.constructor.id}:server:${this.operation}:${e}`,t)}start({req:e,res:t}){const r=n.getStore(),s=i.startSpan(this.tracer,{...this.config,service:this.config.service||this.serviceName()},e,t,this.operationName());s.setTag(o,this.constructor.id),this.enter(s,{...r,req:e,res:t});const a=i.getContext(e);a.instrumented||(a.res.writeHead=i.wrapWriteHead(a),a.instrumented=!0)}finish({req:e}){const t=i.getContext(e);t&&t.res&&i.finishAll(t)}error(e){i.addError(e)}configure(e){return super.configure(i.normalizeConfig(e))}}},93881:(e,t,r)=>{"use strict";const s=r(83197);e.exports=class extends s{static get id(){return"ioredis"}}},31954:(e,t,r)=>{const s=r(32028),{storage:n}=r(96882),{TEST_STATUS:i,JEST_TEST_RUNNER:o,finishAllTraceSpans:a,getTestSuiteCommonTags:c,addIntelligentTestRunnerSpanTags:u,TEST_PARAMETERS:l,TEST_COMMAND:p,TEST_FRAMEWORK_VERSION:d,TEST_SOURCE_START:h,TEST_ITR_UNSKIPPABLE:f,TEST_ITR_FORCED_RUN:g,TEST_CODE_OWNERS:m,ITR_CORRELATION_ID:_,TEST_SOURCE_FILE:y,TEST_IS_NEW:b,TEST_IS_RETRY:v,TEST_EARLY_FLAKE_ENABLED:E,TEST_EARLY_FLAKE_ABORT_REASON:S,JEST_DISPLAY_NAME:T,TEST_IS_RUM_ACTIVE:w,TEST_BROWSER_DRIVER:x,getFormattedError:A,TEST_RETRY_REASON:I}=r(97507),{COMPONENT:k}=r(23636),O=r(94248),{TELEMETRY_EVENT_CREATED:R,TELEMETRY_EVENT_FINISHED:C,TELEMETRY_CODE_COVERAGE_STARTED:N,TELEMETRY_CODE_COVERAGE_FINISHED:P,TELEMETRY_ITR_FORCED_TO_RUN:D,TELEMETRY_CODE_COVERAGE_EMPTY:L,TELEMETRY_ITR_UNSKIPPABLE:M,TELEMETRY_CODE_COVERAGE_NUM_FILES:q,TELEMETRY_TEST_SESSION:j}=r(60806),U=!!process.env.JEST_WORKER_ID;e.exports=class extends s{static get id(){return"jest"}getUnskippableSuites(e){return this.unskippableSuites||(this.unskippableSuites=JSON.parse(e)),this.unskippableSuites}getForcedToRunSuites(e){return this.forcedToRunSuites||(this.forcedToRunSuites=JSON.parse(e)),this.forcedToRunSuites}constructor(...e){if(super(...e),U){const e=([t])=>{2===t&&(this.testSuiteSpan&&(this.testSuiteSpan.finish(),a(this.testSuiteSpan)),this.tracer._exporter.flush(),process.removeListener("message",e))};process.on("message",e)}this.addSub("ci:jest:session:finish",(({status:e,isSuitesSkipped:t,isSuitesSkippingEnabled:r,isCodeCoverageEnabled:s,testCodeCoverageLinesTotal:n,numSkippedSuites:o,hasUnskippableSuites:c,hasForcedToRunSuites:l,error:p,isEarlyFlakeDetectionEnabled:d,isEarlyFlakeDetectionFaulty:h,onDone:f})=>{this.testSessionSpan.setTag(i,e),this.testModuleSpan.setTag(i,e),p&&(this.testSessionSpan.setTag("error",p),this.testModuleSpan.setTag("error",p)),u(this.testSessionSpan,this.testModuleSpan,{isSuitesSkipped:t,isSuitesSkippingEnabled:r,isCodeCoverageEnabled:s,testCodeCoverageLinesTotal:n,skippingType:"suite",skippingCount:o,hasUnskippableSuites:c,hasForcedToRunSuites:l}),d&&this.testSessionSpan.setTag(E,"true"),h&&this.testSessionSpan.setTag(S,"faulty"),this.testModuleSpan.finish(),this.telemetry.ciVisEvent(C,"module"),this.testSessionSpan.finish(),this.telemetry.ciVisEvent(C,"session"),a(this.testSessionSpan),this.telemetry.count(j,{provider:this.ciProviderName}),this.tracer._exporter.flush((()=>{f&&f()}))})),this.addSub("ci:jest:session:configuration",(e=>{e.forEach((e=>{e._ddTestSessionId=this.testSessionSpan.context().toTraceId(),e._ddTestModuleId=this.testModuleSpan.context().toSpanId(),e._ddTestCommand=this.testSessionSpan.context()._tags[p],e._ddItrCorrelationId=this.itrCorrelationId,e._ddIsEarlyFlakeDetectionEnabled=!!this.libraryConfig?.isEarlyFlakeDetectionEnabled,e._ddEarlyFlakeDetectionNumRetries=this.libraryConfig?.earlyFlakeDetectionNumRetries??0,e._ddRepositoryRoot=this.repositoryRoot,e._ddIsFlakyTestRetriesEnabled=this.libraryConfig?.isFlakyTestRetriesEnabled??!1,e._ddFlakyTestRetriesCount=this.libraryConfig?.flakyTestRetriesCount,e._ddIsDiEnabled=this.libraryConfig?.isDiEnabled??!1,e._ddIsKnownTestsEnabled=this.libraryConfig?.isKnownTestsEnabled??!1}))})),this.addSub("ci:jest:test-suite:start",(({testSuite:e,testSourceFile:t,testEnvironmentOptions:r,frameworkVersion:s,displayName:n})=>{const{_ddTestSessionId:i,_ddTestCommand:o,_ddTestModuleId:a,_ddItrCorrelationId:u,_ddForcedToRun:l,_ddUnskippable:p,_ddTestCodeCoverageEnabled:d}=r,b=this.tracer.extract("text_map",{"x-datadog-trace-id":i,"x-datadog-parent-id":a}),v=c(o,s,e,"jest");p&&(this.getUnskippableSuites(p)[e]&&(this.telemetry.count(M,{testLevel:"suite"}),v[f]="true"),l&&this.getForcedToRunSuites(l)[e]&&(this.telemetry.count(D,{testLevel:"suite"}),v[g]="true")),u&&(v[_]=u),n&&(v[T]=n),t&&(v[y]=t,v[h]=1);const E=this.getCodeOwners(v);E&&(v[m]=E),this.testSuiteSpan=this.tracer.startSpan("jest.test_suite",{childOf:b,tags:{[k]:this.constructor.id,...this.testEnvironmentMetadata,...v}}),this.telemetry.ciVisEvent(R,"suite"),d&&this.telemetry.ciVisEvent(N,"suite",{library:"istanbul"})})),this.addSub("ci:jest:worker-report:trace",(e=>{JSON.parse(e).map((e=>e.map((e=>({...e,span_id:O(e.span_id),trace_id:O(e.trace_id),parent_id:O(e.parent_id)}))))).forEach((e=>{this.tracer._exporter.export(e)}))})),this.addSub("ci:jest:worker-report:coverage",(e=>{JSON.parse(e).map((e=>({sessionId:O(e.sessionId),suiteId:O(e.suiteId),files:e.files}))).forEach((e=>{this.tracer._exporter.exportCoverage(e)}))})),this.addSub("ci:jest:worker-report:logs",(e=>{JSON.parse(e).forEach((({testConfiguration:e,logMessage:t})=>{this.tracer._exporter.exportDiLogs(e,t)}))})),this.addSub("ci:jest:test-suite:finish",(({status:e,errorMessage:t,error:r})=>{this.testSuiteSpan.setTag(i,e),r?this.testSuiteSpan.setTag("error",r):t&&this.testSuiteSpan.setTag("error",new Error(t)),this.testSuiteSpan.finish(),this.telemetry.ciVisEvent(C,"suite"),a(this.testSuiteSpan),U&&this.tracer._exporter.flush(),this.removeAllDiProbes()})),this.addSub("ci:jest:test-suite:code-coverage",(({coverageFiles:e,testSuite:t})=>{e.length||this.telemetry.count(L);const r=[...e,t],{_traceId:s,_spanId:n}=this.testSuiteSpan.context(),i={sessionId:s,suiteId:n,files:r};this.tracer._exporter.exportCoverage(i),this.telemetry.ciVisEvent(P,"suite",{library:"istanbul"}),this.telemetry.distribution(q,{},r.length)})),this.addSub("ci:jest:test:start",(e=>{const t=n.getStore(),r=this.startTestSpan(e);this.enter(r,t),this.activeTestSpan=r})),this.addSub("ci:jest:test:finish",(({status:e,testStartLine:t})=>{const r=n.getStore().span;r.setTag(i,e),t&&r.setTag(h,t);const s=r.context()._tags;this.telemetry.ciVisEvent(C,"test",{hasCodeOwners:!!s[m],isNew:"true"===s[b],isRum:"true"===s[w],browserDriver:s[x]}),r.finish(),a(r),this.activeTestSpan=null})),this.addSub("ci:jest:test:err",(({error:e,shouldSetProbe:t,promises:r})=>{if(e){const o=n.getStore();if(o&&o.span){const n=o.span;if(n.setTag(i,"fail"),n.setTag("error",A(e,this.repositoryRoot)),t){const t=this.addDiProbe(e);if(t){const{setProbePromise:e}=t;r.isProbeReady=(s=e,new Promise((e=>{setTimeout(e,2e3),s.then(e)})))}}}}var s})),this.addSub("ci:jest:test:skip",(e=>{const t=this.startTestSpan(e);t.setTag(i,"skip"),t.finish()}))}startTestSpan(e){const{suite:t,name:r,displayName:s,testParameters:n,frameworkVersion:i,testStartLine:a,testSourceFile:c,isNew:u,isEfdRetry:p,isJestRetry:f}=e,g={[o]:"jest-circus",[l]:n,[d]:i};return a&&(g[h]=a),g[y]=c||t,s&&(g[T]=s),u&&(g[b]="true",p&&(g[v]="true",g[I]="efd")),f&&(g[v]="true"),super.startTestSpan(r,t,this.testSuiteSpan,g)}}},25500:(e,t,r)=>{const{readFileSync:s}=r(79896),{parse:n,extract:i}=r(73118),{getTestSuitePath:o}=r(97507),a=r(75004);function c(e){let t;try{const r=s(e.path,"utf8");t=n(i(r))}catch(e){return!1}if(!t?.datadog)return!1;try{return JSON.parse(t.datadog).unskippable}catch(e){return a.warn("@datadog block comment is malformed."),!0}}e.exports={getFormattedJestTestParameters:function(e){if(!e||!e.length)return;const[t,...r]=e;if(0===r.length)return t;const s=t[0].split("|").map((e=>e.trim())),n=[];for(let e=0;e<r.length;e++){const t=r[e],i=e%s.length;i||n.push({});const o=s[i];n[n.length-1][o]=t}return n},getJestTestName:function(e){const t=[];let r=e;do{t.unshift(r.name)}while(r=r.parent);return t.shift(),t.join(" ")},getJestSuitesToRun:function(e,t,r){const s={},n={},i=[],a=[];for(const u of t){const t=o(u.path,r),l=e.includes(t);c(u)?(a.push(u),s[t]=!0,l&&(n[t]=!0)):l?i.push(t):a.push(u)}const u=Object.keys(s).length>0,l=Object.keys(n).length>0;if(t.length){const[e]=t;e?.context?.config?.testEnvironmentOptions&&(u&&(e.context.config.testEnvironmentOptions._ddUnskippable=JSON.stringify(s)),l&&(e.context.config.testEnvironmentOptions._ddForcedToRun=JSON.stringify(n)))}return{skippedSuites:i,suitesToRun:a,hasUnskippableSuites:u,hasForcedToRunSuites:l}},isMarkedAsUnskippable:c}},22204:(e,t,r)=>{const s=r(57232),{getMessageSize:n}=r(63011);e.exports=class extends s{static get id(){return"kafkajs"}static get operation(){return"consume-batch"}start({topic:e,partition:t,messages:r,groupId:s,clusterId:i}){if(this.config.dsmEnabled)for(const t of r){if(!t||!t.headers)continue;const r=n(t);this.tracer.decodeDataStreamsContext(t.headers);const o=["direction:in",`group:${s}`,`topic:${e}`,"type:kafka"];i&&o.push(`kafka_cluster_id:${i}`),this.tracer.setCheckpoint(o,null,r)}}}},3131:(e,t,r)=>{"use strict";const s=r(1247),{getMessageSize:n}=r(63011),i=r(57232),o=s.channel("dd-trace:kafkajs:consumer:afterStart"),a=s.channel("dd-trace:kafkajs:consumer:beforeFinish");e.exports=class extends i{static get id(){return"kafkajs"}static get operation(){return"consume"}constructor(){super(...arguments),this.addSub("apm:kafkajs:consume:commit",(e=>this.commit(e)))}transformCommit(e){const{groupId:t,partition:r,offset:s,topic:n}=e;return{partition:r,topic:n,type:"kafka_commit",offset:Number(s),consumer_group:t}}commit(e){if(!this.config.dsmEnabled)return;const t=["consumer_group","type","partition","offset","topic"];for(const r of e.map(this.transformCommit))t.some((e=>!r.hasOwnProperty(e)))||this.tracer.setOffset(r)}start({topic:e,partition:t,message:r,groupId:s,clusterId:i}){const a=function(e,t){if(!t)return null;const r={};for(const e of Object.keys(t))null!==t[e]&&void 0!==t[e]&&(r[e]=t[e].toString());return e.extract("text_map",r)}(this.tracer,r.headers),c=this.startSpan({childOf:a,resource:e,type:"worker",meta:{component:"kafkajs","kafka.topic":e,"kafka.message.offset":r.offset,"kafka.cluster_id":i},metrics:{"kafka.partition":t}});if(this.config.dsmEnabled&&r?.headers){const t=n(r);this.tracer.decodeDataStreamsContext(r.headers);const o=["direction:in",`group:${s}`,`topic:${e}`,"type:kafka"];i&&o.push(`kafka_cluster_id:${i}`),this.tracer.setCheckpoint(o,c,t)}o.hasSubscribers&&o.publish({topic:e,partition:t,message:r,groupId:s})}finish(){a.hasSubscribers&&a.publish(),super.finish()}}},6531:(e,t,r)=>{"use strict";const s=r(78893),n=r(3131),i=r(22204),o=r(42257);e.exports=class extends o{static get id(){return"kafkajs"}static get plugins(){return{producer:s,consumer:n,batchConsumer:i}}}},78893:(e,t,r)=>{"use strict";const s=r(36878),{DsmPathwayCodec:n}=r(71793),{getMessageSize:i}=r(63011),o="messaging.kafka.bootstrap.servers";e.exports=class extends s{static get id(){return"kafkajs"}static get operation(){return"produce"}static get peerServicePrecursors(){return[o]}constructor(){super(...arguments),this.addSub("apm:kafkajs:produce:commit",(e=>this.commit(e)))}transformProduceResponse(e){const{topicName:t,partition:r,offset:s,baseOffset:n}=e,i=s||n;return{type:"kafka_produce",partition:r,offset:i?Number(i):void 0,topic:t}}commit(e){if(!this.config.dsmEnabled)return;const t=["type","partition","offset","topic"];for(const r of e.map(this.transformProduceResponse))t.some((e=>!r.hasOwnProperty(e)))||this.tracer.setOffset(r)}start({topic:e,messages:t,bootstrapServers:r,clusterId:s}){const a=this.startSpan({resource:e,meta:{component:"kafkajs","kafka.topic":e,"kafka.cluster_id":s},metrics:{"kafka.batch_size":t.length}});r&&a.setTag(o,r);for(const r of t)if(null!==r&&"object"==typeof r&&(this.tracer.inject(a,"text_map",r.headers),this.config.dsmEnabled)){const t=i(r),o=["direction:out",`topic:${e}`,"type:kafka"];s&&o.push(`kafka_cluster_id:${s}`);const c=this.tracer.setCheckpoint(o,a,t);n.encode(c,r.headers)}}}},5943:(e,t,r)=>{"use strict";const s=r(78693),n=r(5593);e.exports=class extends s{static get id(){return"koa"}constructor(...e){super(...e),this.addSub("apm:koa:request:handle",(({req:e})=>{this.setFramework(e,"koa",this.config)})),this.addSub("apm:koa:request:route",(({req:e,route:t})=>{n.setRoute(e,t)}))}}},72544:(e,t,r)=>{"use strict";const s=r(47280);e.exports=class extends s{getSpanStartTags(e){const t={};if(!this.isPromptCompletionSampled())return t;let r=e.args?.[0];r=Array.isArray(r)?r:[r];for(const e in r){const s=r[e];if("object"!=typeof s)t[`langchain.request.inputs.${e}`]=this.normalize(s);else for(const[r,n]of Object.entries(s))r.includes("lc_")||(t[`langchain.request.inputs.${e}.${r}`]=this.normalize(n))}return t}getSpanEndTags(e){const t={};if(!this.isPromptCompletionSampled())return t;let r=e.result;r=Array.isArray(r)?r:[r];for(const e in r){const s=r[e];t[`langchain.response.outputs.${e}`]=this.normalize("string"==typeof s?s:JSON.stringify(s))}return t}}},47280:(e,t,r)=>{"use strict";const s=r(89612);e.exports=class{constructor(e){const t=s("langchain",e);this.normalize=t.normalize,this.isPromptCompletionSampled=t.isPromptCompletionSampled}getSpanStartTags(e){}getSpanEndTags(e){}extractApiKey(e){}extractProvider(e){}extractModel(e){}}},90416:(e,t,r)=>{"use strict";const s=r(47280);e.exports=class extends s{getSpanStartTags(e){const t={},r=e.args?.[0],s=this.isPromptCompletionSampled();if("string"==typeof r)s&&(t["langchain.request.inputs.0.text"]=this.normalize(r)),t["langchain.request.input_counts"]=1;else{if(s)for(const e in r){const s=r[e];t[`langchain.request.inputs.${e}.text`]=this.normalize(s)}t["langchain.request.input_counts"]=r.length}return t}getSpanEndTags(e){const t={},{result:r}=e;if(Array.isArray(r))return t["langchain.response.outputs.embedding_length"]=(Array.isArray(r[0])?r[0]:r).length,t}extractApiKey(e){const t=e.clientConfig?.apiKey;return!t||t.length<4?"":`...${t.slice(-4)}`}extractProvider(e){return e.constructor.name.split("Embeddings")[0].toLowerCase()}extractModel(e){for(const t of["model","modelName","modelId","modelKey","repoId"]){const r=e[t];if(r)return r}}}},72255:(e,t,r)=>{"use strict";const s=r(81011),n="langchain.response.completions";e.exports=class extends s{getSpanStartTags(e,t){const r={},s=e.args?.[0];for(const e in s){const t=s[e];for(const s in t){const n=t[s];this.isPromptCompletionSampled()&&(r[`langchain.request.messages.${e}.${s}.content`]=this.normalize(n.content)||""),r[`langchain.request.messages.${e}.${s}.message_type`]=n.constructor.name}}const n=e.instance,i="function"==typeof n._identifyingParams&&n._identifyingParams()||{};for(const[e,s]of Object.entries(i))if(!e.toLowerCase().includes("apikey")&&!e.toLowerCase().includes("apitoken"))if("object"==typeof s)for(const[n,i]of Object.entries(s))r[`langchain.request.${t}.parameters.${e}.${n}`]=i;else r[`langchain.request.${t}.parameters.${e}`]=s;return r}getSpanEndTags(e){const{result:t}=e,r={};this.extractTokenMetrics(e.currentStore?.span,t);for(const e in t?.generations){const s=t.generations[e];for(const t in s){const i=s[t],o=i.text,a=i.message;let c=a.tool_calls;if(o&&this.isPromptCompletionSampled()&&(r[`${n}.${e}.${t}.content`]=this.normalize(o)),r[`${n}.${e}.${t}.message_type`]=a.constructor.name,c){Array.isArray(c)||(c=[c]);for(const s in c){const i=c[s];r[`${n}.${e}.${t}.tool_calls.${s}.id`]=i.id,r[`${n}.${e}.${t}.tool_calls.${s}.name`]=i.name;const o=i.args||{};for(const[i,a]of Object.entries(o))r[`${n}.${e}.${t}.tool_calls.${s}.args.${i}`]=this.normalize(a)}}}}return r}}},81011:(e,t,r)=>{"use strict";const{getTokensFromLlmOutput:s}=r(31069),n=r(47280);e.exports=class extends n{extractApiKey(e){let t=e[Object.keys(e).find((e=>{const t=e.toLowerCase();return t.includes("apikey")||t.includes("apitoken")}))];return t?.secretValue&&"function"==typeof t.secretValue&&(t=t.secretValue()),!t||t.length<4?"":`...${t.slice(-4)}`}extractProvider(e){return"function"==typeof e._llmType&&e._llmType().split("-")[0]}extractModel(e){for(const t of["model","modelName","modelId","modelKey","repoId"]){const r=e[t];if(r)return r}}extractTokenMetrics(e,t){if(!e||!t)return;if("openai"!==e.context()._tags["langchain.request.provider"])return;const r=s(t);for(const[t,s]of Object.entries(r))e.setTag(`langchain.tokens.${t}_tokens`,s)}}},16156:(e,t,r)=>{"use strict";const s=r(81011);e.exports=class extends s{getSpanStartTags(e,t){const r={},s=e.args?.[0];for(const e in s){if(!this.isPromptCompletionSampled())continue;const t=s[e];r[`langchain.request.prompts.${e}.content`]=this.normalize(t)||""}const n=e.instance,i="function"==typeof n._identifyingParams&&n._identifyingParams()||{};for(const[e,s]of Object.entries(i))if(!e.toLowerCase().includes("apikey")&&!e.toLowerCase().includes("apitoken"))if("object"==typeof s)for(const[n,i]of Object.entries(s))r[`langchain.request.${t}.parameters.${e}.${n}`]=i;else r[`langchain.request.${t}.parameters.${e}`]=s;return r}getSpanEndTags(e){const{result:t}=e,r={};this.extractTokenMetrics(e.currentStore?.span,t);for(const e in t?.generations){const s=t.generations[e];if(this.isPromptCompletionSampled()&&(r[`langchain.response.completions.${e}.text`]=this.normalize(s[0].text)||""),s&&s[0].generationInfo){const t=s[0].generationInfo;r[`langchain.response.completions.${e}.finish_reason`]=t.finishReason,r[`langchain.response.completions.${e}.logprobs`]=t.logprobs}}return r}}},85771:(e,t,r)=>{"use strict";const s=r(51189),n=r(40796),i=r(42257);e.exports=class extends i{static get id(){return"langchain"}static get plugins(){return{llmobs:n,tracing:s}}}},31069:e=>{"use strict";e.exports={getTokensFromLlmOutput:function(e){const t={input:0,output:0,total:0},{llmOutput:r}=e;if(!r)return t;const s=r.tokenUsage||r.usage_metadata||r.usage_metadata;if(!s)return t;for(const e of[["input","prompt"],["output","completion"],["total"]]){let r=0;for(const t of e){const e=`${t}Tokens`;r=s[`${t}_tokens`]||s[e]||r}t[e[0]]=r}return t.total=t.total||t.input+t.output,t}}},51189:(e,t,r)=>{"use strict";const{MEASURED:s}=r(74100),{storage:n}=r(96882),i=r(5288),o=r(47280),a=r(72255),c=r(16156),u=r(72544),l=r(90416);e.exports=class extends i{static get id(){return"langchain"}static get operation(){return"invoke"}static get system(){return"langchain"}static get prefix(){return"tracing:apm:langchain:invoke"}constructor(){super(...arguments),this.handlers={chain:new u(this._tracerConfig),chat_model:new a(this._tracerConfig),llm:new c(this._tracerConfig),embedding:new l(this._tracerConfig),default:new o(this._tracerConfig)}}bindStart(e){const{resource:t,type:r}=e,i=this.handlers[r],o=e.instance,a=i.extractApiKey(o),c=i.extractProvider(o),u=i.extractModel(o),l=i.getSpanStartTags(e,c)||[];a&&(l["langchain.request.api_key"]=a),c&&(l["langchain.request.provider"]=c),u&&(l["langchain.request.model"]=u),r&&(l["langchain.request.type"]=r);const p=this.startSpan("langchain.request",{service:this.config.service,resource:t,kind:"client",meta:{[s]:1,...l}},!1),d=n.getStore()||{};return e.currentStore={...d,span:p},e.currentStore}asyncEnd(e){const t=e.currentStore.span,{type:r}=e,s=this.handlers[r].getSpanEndTags(e)||{};t.addTags(s),t.finish()}getHandler(e){return this.handlers[e]||this.handlers.default}}},60526:(e,t,r)=>{"use strict";const{storage:s}=r(96882),n=r(63324);let i;e.exports=class extends n{static get id(){return"mariadb"}static get system(){return"mariadb"}constructor(...e){super(...e),this.addSub(`apm:${this.component}:pool:skip`,(()=>{i=s.getStore(),s.enterWith({noop:!0})})),this.addSub(`apm:${this.component}:pool:unskip`,(()=>{s.enterWith(i),i=void 0}))}}},39465:(e,t,r)=>{"use strict";const{CLIENT_PORT_KEY:s}=r(23636),n=r(58500);e.exports=class extends n{static get id(){return"memcached"}start({client:e,server:t,query:r}){const n=function(e,t,r){if(!t)if(1===e.servers.length)t=e.servers[0];else{let s=e.redundancy&&e.redundancy<e.servers.length;const n=r.redundancyEnabled;s&&n?(s=e.HashRing.range(r.key,e.redundancy+1,!0),t=s.shift()):t=e.HashRing.get(r.key)}return t&&t.split(":")}(e,t,r),i={"out.host":n[0],[s]:n[1]};this.config.memcachedCommandEnabled&&(i["memcached.command"]=r.command),this.startSpan({service:this.serviceName({pluginConfig:this.config,system:this.system}),resource:r.type,type:"memcached",meta:i})}}},12076:(e,t,r)=>{"use strict";const s=r(78693),n=r(5593);e.exports=class extends s{static get id(){return"microgateway-core"}constructor(...e){super(...e),this.addSub("apm:microgateway-core:request:handle",(({req:e})=>{this.setFramework(e,"microgateway",this.config)})),this.addSub("apm:microgateway-core:request:route",(({req:e,route:t})=>{n.setRoute(e,t)})),this.addSub("apm:microgateway-core:request:error",this.addError)}}},30364:(e,t,r)=>{"use strict";const s=r(32028),{storage:n}=r(96882),{TEST_STATUS:i,TEST_PARAMETERS:o,finishAllTraceSpans:a,getTestSuitePath:c,getTestParametersString:u,getTestSuiteCommonTags:l,addIntelligentTestRunnerSpanTags:p,TEST_SOURCE_START:d,TEST_ITR_UNSKIPPABLE:h,TEST_ITR_FORCED_RUN:f,TEST_CODE_OWNERS:g,ITR_CORRELATION_ID:m,TEST_SOURCE_FILE:_,removeEfdStringFromTestName:y,TEST_IS_NEW:b,TEST_IS_RETRY:v,TEST_EARLY_FLAKE_ENABLED:E,TEST_EARLY_FLAKE_ABORT_REASON:S,TEST_SESSION_ID:T,TEST_MODULE_ID:w,TEST_MODULE:x,TEST_SUITE_ID:A,TEST_COMMAND:I,TEST_SUITE:k,MOCHA_IS_PARALLEL:O,TEST_IS_RUM_ACTIVE:R,TEST_BROWSER_DRIVER:C,TEST_RETRY_REASON:N}=r(97507),{COMPONENT:P}=r(23636),{TELEMETRY_EVENT_CREATED:D,TELEMETRY_EVENT_FINISHED:L,TELEMETRY_CODE_COVERAGE_STARTED:M,TELEMETRY_CODE_COVERAGE_FINISHED:q,TELEMETRY_ITR_FORCED_TO_RUN:j,TELEMETRY_CODE_COVERAGE_EMPTY:U,TELEMETRY_ITR_UNSKIPPABLE:F,TELEMETRY_CODE_COVERAGE_NUM_FILES:B,TELEMETRY_TEST_SESSION:$}=r(60806),G=r(94248),V=r(75004);e.exports=class extends s{static get id(){return"mocha"}constructor(...e){super(...e),this._testSuites=new Map,this._testTitleToParams={},this.sourceRoot=process.cwd(),this.addSub("ci:mocha:test-suite:code-coverage",(({coverageFiles:e,suiteFile:t})=>{if(!this.libraryConfig?.isCodeCoverageEnabled)return;const r=c(t,this.sourceRoot),s=this._testSuites.get(r);e.length||this.telemetry.count(U);const n=[...e,t].map((e=>c(e,this.repositoryRoot||this.sourceRoot))),{_traceId:i,_spanId:o}=s.context(),a={sessionId:i,suiteId:o,files:n};this.tracer._exporter.exportCoverage(a),this.telemetry.ciVisEvent(q,"suite",{library:"istanbul"}),this.telemetry.distribution(B,{},n.length)})),this.addSub("ci:mocha:test-suite:start",(({testSuiteAbsolutePath:e,isUnskippable:t,isForcedToRun:r,itrCorrelationId:s})=>{if(!this.testModuleSpan)return;const i=c(e,this.sourceRoot),o=l(this.command,this.frameworkVersion,i,"mocha");t&&(o[h]="true",this.telemetry.count(F,{testLevel:"suite"})),r&&(o[f]="true",this.telemetry.count(j,{testLevel:"suite"})),this.repositoryRoot!==this.sourceRoot&&this.repositoryRoot?o[_]=c(e,this.repositoryRoot):o[_]=i,o[_]&&(o[d]=1);const a=this.getCodeOwners(o);a&&(o[g]=a);const u=this.tracer.startSpan("mocha.test_suite",{childOf:this.testModuleSpan,tags:{[P]:this.constructor.id,...this.testEnvironmentMetadata,...o}});this.telemetry.ciVisEvent(D,"suite"),this.libraryConfig?.isCodeCoverageEnabled&&this.telemetry.ciVisEvent(M,"suite",{library:"istanbul"}),s&&u.setTag(m,s);const p=n.getStore();this.enter(u,p),this._testSuites.set(i,u)})),this.addSub("ci:mocha:test-suite:finish",(e=>{const t=n.getStore();if(t&&t.span){const r=t.span;r.context()._tags[i]||r.setTag(i,e),r.finish(),this.telemetry.ciVisEvent(L,"suite")}})),this.addSub("ci:mocha:test-suite:error",(e=>{const t=n.getStore();if(t&&t.span){const r=t.span;r.setTag("error",e),r.setTag(i,"fail")}})),this.addSub("ci:mocha:test:start",(e=>{const t=n.getStore(),r=this.startTestSpan(e);this.enter(r,t),this.activeTestSpan=r})),this.addSub("ci:mocha:worker:finish",(()=>{this.tracer._exporter.flush()})),this.addSub("ci:mocha:test:finish",(({status:e,hasBeenRetried:t,isLastRetry:r})=>{const s=n.getStore(),o=s?.span;if(o){o.setTag(i,e),t&&o.setTag(v,"true");const s=o.context()._tags;this.telemetry.ciVisEvent(L,"test",{hasCodeOwners:!!s[g],isNew:"true"===s[b],isRum:"true"===s[R],browserDriver:s[C]}),o.finish(),a(o),this.activeTestSpan=null,this.di&&this.libraryConfig?.isDiEnabled&&this.runningTestProbe&&r&&(this.removeDiProbe(this.runningTestProbe),this.runningTestProbe=null)}})),this.addSub("ci:mocha:test:skip",(e=>{const t=n.getStore();if(!t){const r=this.startTestSpan(e);this.enter(r,t)}})),this.addSub("ci:mocha:test:error",(e=>{const t=n.getStore(),r=t?.span;e&&r&&("Pending"!==e.constructor.name||this.forbidPending?(r.setTag(i,"fail"),r.setTag("error",e)):r.setTag(i,"skip"))})),this.addSub("ci:mocha:test:retry",(({isFirstAttempt:e,willBeRetried:t,err:r,test:s})=>{const o=n.getStore(),c=o?.span;if(c){c.setTag(i,"fail"),e||c.setTag(v,"true"),r&&c.setTag("error",r);const n=c.context()._tags;if(this.telemetry.ciVisEvent(L,"test",{hasCodeOwners:!!n[g],isNew:"true"===n[b],isRum:"true"===n[R],browserDriver:n[C]}),e&&t&&this.di&&this.libraryConfig?.isDiEnabled){const e=this.addDiProbe(r);if(e){const{file:t,line:r,stackIndex:n}=e;this.runningTestProbe={file:t,line:r},this.testErrorStackIndex=n,s._ddShouldWaitForHitProbe=!0}}c.finish(),a(c)}})),this.addSub("ci:mocha:test:parameterize",(({title:e,params:t})=>{this._testTitleToParams[e]=t})),this.addSub("ci:mocha:session:finish",(({status:e,isSuitesSkipped:t,testCodeCoverageLinesTotal:r,numSkippedSuites:s,hasForcedToRunSuites:n,hasUnskippableSuites:o,error:c,isEarlyFlakeDetectionEnabled:u,isEarlyFlakeDetectionFaulty:l,isParallel:d})=>{if(this.testSessionSpan){const{isSuitesSkippingEnabled:h,isCodeCoverageEnabled:f}=this.libraryConfig||{};this.testSessionSpan.setTag(i,e),this.testModuleSpan.setTag(i,e),c&&(this.testSessionSpan.setTag("error",c),this.testModuleSpan.setTag("error",c)),d&&this.testSessionSpan.setTag(O,"true"),p(this.testSessionSpan,this.testModuleSpan,{isSuitesSkipped:t,isSuitesSkippingEnabled:h,isCodeCoverageEnabled:f,testCodeCoverageLinesTotal:r,skippingCount:s,skippingType:"suite",hasForcedToRunSuites:n,hasUnskippableSuites:o}),u&&this.testSessionSpan.setTag(E,"true"),l&&this.testSessionSpan.setTag(S,"faulty"),this.testModuleSpan.finish(),this.telemetry.ciVisEvent(L,"module"),this.testSessionSpan.finish(),this.telemetry.ciVisEvent(L,"session"),a(this.testSessionSpan),this.telemetry.count($,{provider:this.ciProviderName})}this.libraryConfig=null,this.tracer._exporter.flush()})),this.addSub("ci:mocha:worker-report:trace",(e=>{JSON.parse(e).map((e=>e.map((e=>{const t={...e,span_id:G(e.span_id),trace_id:G(e.trace_id),parent_id:G(e.parent_id)};if("mocha.test"===t.name){const r=e.meta[k],s=this._testSuites.get(r);if(!s)return V.warn(`Test suite span not found for test span with test suite ${r}`),t;const n=function(e){const t=e.context(),r={[A]:t.toSpanId(),[T]:t.toTraceId(),[I]:t._tags[I],[x]:"mocha"};return t._parentId&&(r[w]=t._parentId.toString(10)),r}(s);t.meta={...t.meta,...n}}return t})))).forEach((e=>{this.tracer._exporter.export(e)}))}))}startTestSpan(e){const{testSuiteAbsolutePath:t,title:r,isNew:s,isEfdRetry:n,testStartLine:i,isParallel:a}=e,l=y(e.testName),p={},h=u(this._testTitleToParams,r);h&&(p[o]=h),i&&(p[d]=i),a&&(p[O]="true");const f=c(t,this.sourceRoot),g=this._testSuites.get(f);return this.repositoryRoot!==this.sourceRoot&&this.repositoryRoot?p[_]=c(t,this.repositoryRoot):p[_]=f,s&&(p[b]="true",n&&(p[v]="true",p[N]="efd")),super.startTestSpan(l,f,g,p)}}},69285:(e,t,r)=>{"use strict";const s=r(77723),{moleculerTags:n}=r(65502);e.exports=class extends s{static get id(){return"moleculer"}static get operation(){return"call"}start({actionName:e,opts:t}){const r=this.startSpan(this.operationName(),{service:this.config.service||this.serviceName(),resource:e,kind:"client"});this.tracer.inject(r,"text_map",t.meta)}finish({broker:e,ctx:t}){const r=this.activeSpan;if(t){const s=(t.endpoint||{}).node||{};this.addHost(s.hostname,s.port),r.addTags(n(e,t,this.config))}super.finish()}}},39900:(e,t,r)=>{"use strict";const s=r(90641),n=r(69285),i=r(42257);e.exports=class extends i{static get id(){return"moleculer"}static get plugins(){return{server:s,client:n}}}},90641:(e,t,r)=>{"use strict";const s=r(38103),{moleculerTags:n}=r(65502);e.exports=class extends s{static get id(){return"moleculer"}static get operation(){return"action"}start({action:e,ctx:t,broker:r}){const s=this.tracer.extract("text_map",t.meta);this.startSpan(this.operationName(),{childOf:s||this.activeSpan,service:this.config.service||this.serviceName(),resource:e.name,kind:"server",type:"web",meta:{"resource.name":e.name,...n(r,t,this.config)}})}}},65502:e=>{"use strict";e.exports={moleculerTags:function(e,t,r){const s=t.service||{},n=t.action||{},i=r.meta&&t.meta;return{"moleculer.context.action":n.name,"moleculer.context.meta":i,"moleculer.context.node_id":t.nodeID,"moleculer.context.request_id":t.requestID,"moleculer.context.service":s.name,"moleculer.namespace":e.namespace,"moleculer.node_id":e.nodeID}}}},40030:(e,t,r)=>{"use strict";const s=r(42537);function n(e){return JSON.stringify(e,((e,t)=>"bigint"==typeof t?t.toString():t))}function i(e){return!(null!==(t=e)&&"object"==typeof t&&!Array.isArray(t)&&"function"!=typeof e.toJSON);var t}function o(e){return Buffer.isBuffer(e)||"function"==typeof e||u(e)}function a(e){if(c(e)&&(e=e.toJSON()),o(e))return"?";if(i(e))return e;const t={},r=[{input:e,output:t,depth:0}];for(;r.length;){const{input:e,output:t,depth:s}=r.pop(),n=s+1;for(const a in e){if("function"==typeof e[a])continue;let u=e[a];c(u)&&(u="function"==typeof u.toJSON?u.toJSON():"?"),s>=10||o(u)?t[a]="?":i(u)?t[a]=u:r.push({input:u,output:t[a]={},depth:n})}}return t}function c(e){return e&&e._bsontype&&!u(e)}function u(e){return e&&"Binary"===e._bsontype}e.exports=class extends s{static get id(){return"mongodb-core"}static get component(){return"mongodb"}static get peerServicePrecursors(){return[]}start({ns:e,ops:t,options:r={},name:s}){const i=function(e){if(e&&"object"==typeof e&&!Array.isArray(e))return e.query?n(a(e.query)):e.filter?n(a(e.filter)):void 0}(t),o=(c=function(e,t,r,s){const n=[s,t];return e.config.queryInResourceName&&r&&n.push(r),n.join(" ")}(this,e,i,s),c.slice(0,Math.min(c.length,1e4)));var c;this.startSpan(this.operationName(),{service:this.serviceName({pluginConfig:this.config}),resource:o,type:"mongodb",kind:"client",meta:{"db.name":e,"mongodb.query":i,"out.host":r.host,"out.port":r.port}})}getPeerService(e){const t=e["db.name"];return t&&void 0===e["peer.service"]&&(e["peer.service"]=t.split(".",1)[0]),super.getPeerService(e)}}},63324:(e,t,r)=>{"use strict";const s=r(23636),n=r(42537);e.exports=class extends n{static get id(){return"mysql"}static get system(){return"mysql"}start(e){const t=this.serviceName({pluginConfig:this.config,dbConfig:e.conf,system:this.system}),r=this.startSpan(this.operationName(),{service:t,resource:e.sql,type:"sql",kind:"client",meta:{"db.type":this.system,"db.user":e.conf.user,"db.name":e.conf.database,"out.host":e.conf.host,[s]:e.conf.port}});e.sql=this.injectDbmQuery(r,e.sql,t)}}},39668:(e,t,r)=>{"use strict";const s=r(63324);e.exports=class extends s{static get id(){return"mysql2"}}},27209:(e,t,r)=>{"use strict";const s=r(12583),n=r(71615),i=r(35434);e.exports=class extends s{static get id(){return"net"}constructor(...e){super(...e),this._ipc=new n(...e),this._tcp=new i(...e)}configure(e){this._ipc.configure(e),this._tcp.configure(e)}}},71615:(e,t,r)=>{"use strict";const s=r(77723);e.exports=class extends s{static get id(){return"net"}static get operation(){return"ipc"}start({options:e}){this.startSpan("ipc.connect",{service:this.config.service,resource:e.path,kind:"client",meta:{"ipc.path":e.path}})}}},35434:(e,t,r)=>{"use strict";const{CLIENT_PORT_KEY:s}=r(23636),n=r(77723);e.exports=class extends n{static get id(){return"net"}static get operation(){return"tcp"}constructor(...e){super(...e),this.addTraceSub("connection",(({socket:e})=>{this.activeSpan.addTags({"tcp.local.address":e.localAddress,"tcp.local.port":e.localPort})}))}start({options:e}){const t=e.host||"localhost",r=e.port||0,n=e.family||4;this.startSpan("tcp.connect",{service:this.config.service,resource:[t,r].filter((e=>e)).join(":"),kind:"client",meta:{"tcp.remote.host":t,"tcp.family":`IPv${n}`,"tcp.local.address":"","out.host":t},metrics:{"tcp.remote.port":r,"tcp.local.port":0,[s]:r}})}}},83857:(e,t,r)=>{"use strict";const s=r(38103),{storage:n}=r(96882),i=r(88378),{COMPONENT:o}=r(23636),a=r(5593),c=["/404","/500","/_error","/_not-found","/_not-found/page"];e.exports=class extends s{static get id(){return"next"}constructor(...e){super(...e),this._requests=new WeakMap,this.addSub("apm:next:page:load",(e=>this.pageLoad(e)))}bindStart({req:e,res:t}){const r=n.getStore(),s=r?r.span:r,a=this.tracer.startSpan(this.operationName(),{childOf:s,tags:{[o]:this.constructor.id,"service.name":this.config.service||this.serviceName(),"resource.name":e.method,"span.type":"web","span.kind":"server","http.method":e.method}});return i.sample(a,this.config.measured,!0),this._requests.set(a,e),{...r,span:a}}error({span:e,error:t}){if(!e){const t=n.getStore();if(!t)return;e=t.span}this.addError(t,e)}finish({req:e,res:t,nextRequest:r={}}){const s=n.getStore();if(!s)return;const i=s.span,o=i.context()._tags.error,c=e.error||r.error;c?(i.setTag("error",c),a.addError(e,c)):o?(i.setTag("error",o),a.addError(e,c||o)):this.config.validateStatus(t.statusCode)||(i.setTag("error",!0),a.addError(e,!0)),i.addTags({"http.status_code":t.statusCode}),this.config.hooks.request(i,e,t),i.finish()}pageLoad({page:e,isAppPath:t=!1,isStatic:r=!1}){const s=n.getStore();if(!s)return;const i=s.span,u=this._requests.get(i);if(!u)return;const l=i.context()._tags["next.page"],p=c.includes(e);l&&p||(t&&!p&&(e=e.substring(0,e.lastIndexOf("/"))),r&&(e=u.url.includes("_next/static")?"/_next/static/*":"/public/*"),i.addTags({[o]:this.constructor.id,"resource.name":`${u.method} ${e}`.trim(),"next.page":e}),a.setRoute(u,e))}configure(e){return super.configure(function(e){const t=function(e){return{request:e.hooks&&e.hooks.request||(()=>{})}}(e),r="function"==typeof e.validateStatus?e.validateStatus:e=>e<500;return Object.assign({},e,{hooks:t,validateStatus:r})}(e))}}},95688:(e,t,r)=>{const s=r(32028);e.exports=class extends s{static get id(){return"nyc"}constructor(...e){super(...e),this.addSub("ci:nyc:wrap",(e=>{e?.config?.all&&(this.nyc=e)})),this.addSub("ci:nyc:get-coverage",(({onDone:e})=>{this.nyc?.getCoverageMapFromAllCoverageFiles?this.nyc.getCoverageMapFromAllCoverageFiles().then((t=>{this.nyc=null,e(t)})).catch((t=>{this.nyc=null,e()})):(this.nyc=null,e())}))}}},4126:(e,t,r)=>{"use strict";const s=r(42257),n=r(98564),i=r(10902);e.exports=class extends s{static get id(){return"openai"}static get plugins(){return{llmobs:i,tracing:n}}}},89656:(e,t,r)=>{"use strict";const{DogStatsDClient:s}=r(2770),n=r(60589),{ExternalLogger:i,NoopExternalLogger:o}=r(47885);let a=null,c=null,u=null;e.exports.init=function(e){return a=e&&e.dogstatsd?new s({host:e.dogstatsd.hostname,port:e.dogstatsd.port,tags:[`service:${e.tags.service}`,`env:${e.tags.env}`,`version:${e.tags.version}`]}):new n,c=e&&e.apiKey?new i({ddsource:"openai",hostname:e.hostname,service:e.service,apiKey:e.apiKey,interval:1e4}):new o,u=setInterval((()=>{a.flush()}),1e4).unref(),{metrics:a,logger:c}},e.exports.shutdown=function(){clearInterval(u),a=null,c=null,u=null}},72992:e=>{"use strict";e.exports.estimateTokens=function(e){let t=0;if("string"==typeof e){const r=e.length/4,s=e.match(/[\w']+|[.,!?;~@#$%^&*()+/-]/g),n=s?.75*s.length:0;t=Math.round((1.5*r+.5*n)/2)}else Array.isArray(e)&&"number"==typeof e[0]&&(t=e.length);return t}},98564:(e,t,r)=>{"use strict";const s=r(16928),n=r(5288),{storage:i}=r(96882),o=r(89656),a=r(99429),{MEASURED:c}=r(74100),{estimateTokens:u}=r(72992),l=r(89612);let p;const d=function(){try{return r(46063)("tiktoken")}catch{return null}}()?.encoding_for_model;function h(e,t){if(d)try{const r=d(t),s=r.encode(e).length;return r.free(),{tokens:s,estimated:!1}}catch{}return{tokens:u(e),estimated:!0}}function f(e,t,r,s){let n=0,i=0,o=0;if(t&&t.usage)n=t.usage.prompt_tokens,i=t.usage.completion_tokens,o=t.usage.total_tokens;else if(t.model&&["chat.completions.create","completions.create"].includes(r)){const{model:a}=t;let c=!1,u=!1;const l=function(e,t,r){let s=0,n=!1;if("chat.completions.create"===e){const e=t.messages;for(const t of e){const e=t.content;if("string"==typeof e){const{tokens:t,estimated:i}=h(e,r);s+=t,n=i}else if(Array.isArray(e))for(const t of e)if("text"===t.type){const{tokens:e,estimated:i}=h(t.text,r);s+=e,n=i}}}else if("completions.create"===e){let e=t.prompt;Array.isArray(e)||(e=[e]);for(const t of e){const{tokens:e,estimated:i}=h(t,r);s+=e,n=i}}return{promptTokens:s,promptEstimated:n}}(r,s,a);n=l.promptTokens,c=l.promptEstimated;const p=function(e,t){let r=0,s=!1;if(e?.choices)for(const n of e.choices){const e=n.message||n.delta,i=n.text||e?.content,{tokens:o,estimated:a}=h(i,t);r+=o,s=a}return{completionTokens:r,completionEstimated:s}}(t,a);i=p.completionTokens,u=p.completionEstimated,o=n+i,c&&(e["openai.response.usage.prompt_tokens_estimated"]=!0),u&&(e["openai.response.usage.completion_tokens_estimated"]=!0)}null!=n&&(e["openai.response.usage.prompt_tokens"]=n),null!=i&&(e["openai.response.usage.completion_tokens"]=i),null!=o&&(e["openai.response.usage.total_tokens"]=o)}function g(e){return e&&`sk-...${e.substr(e.length-4)}`}function m(e,t,r){if("string"==typeof e)r[`openai.request.messages.${t}.content`]=e;else if(Array.isArray(e))for(const s in e){const n=e[s],i=n.type;r[`openai.request.messages.${t}.content.${s}.type`]=n.type,"text"===i?r[`openai.request.messages.${t}.content.${s}.text`]=p(n.text):"image_url"===i&&(r[`openai.request.messages.${t}.content.${s}.image_url.url`]=p(n.image_url.url))}}function _(e,t){const r=Array.isArray(e)?`[${e.join(", ")}]`:e;return t?p(r):r}function y(e){if(e)return Array.isArray(e)?e.length:1}e.exports=class extends n{static get id(){return"openai"}static get operation(){return"request"}static get system(){return"openai"}static get prefix(){return"tracing:apm:openai:request"}constructor(...e){super(...e);const{metrics:t,logger:r}=o.init(this._tracerConfig);if(this.metrics=t,this.logger=r,this.sampler=new a(.1),this._tracerConfig){const e=l("openai",this._tracerConfig);p=e.normalize}}configure(e){!1===e.enabled&&o.shutdown(),super.configure(e)}bindStart(e){const{methodName:t,args:r,basePath:n,apiKey:o}=e,a=function(e,t){switch(e){case"listModels":case"models.list":case"listFiles":case"files.list":case"listFineTunes":case"fine_tuning.jobs.list":case"fine-tune.list":return{};case"retrieveModel":case"models.retrieve":return{id:t[0]};case"createFile":return{file:t[0],purpose:t[1]};case"deleteFile":case"files.del":case"retrieveFile":case"files.retrieve":case"downloadFile":case"files.retrieveContent":case"files.content":return{file_id:t[0]};case"listFineTuneEvents":case"fine_tuning.jobs.listEvents":case"fine-tune.listEvents":return{fine_tune_id:t[0],stream:t[1]};case"retrieveFineTune":case"fine_tuning.jobs.retrieve":case"fine-tune.retrieve":case"deleteModel":case"models.del":case"cancelFineTune":case"fine_tuning.jobs.cancel":case"fine-tune.cancel":return{fine_tune_id:t[0]};case"createImageEdit":return{file:t[0],prompt:t[1],mask:t[2],n:t[3],size:t[4],response_format:t[5],user:t[6]};case"createImageVariation":return{file:t[0],n:t[1],size:t[2],response_format:t[3],user:t[4]};case"createTranscription":case"createTranslation":return{file:t[0],model:t[1],prompt:t[2],response_format:t[3],temperature:t[4],language:t[5]}}return t[0]}(t,r),u=i.getStore()||{},l=this.startSpan("openai.request",{service:this.config.service,resource:t,type:"openai",kind:"client",meta:{[c]:1,"openai.user.api_key":g(o),"openai.api_base":n,"openai.request.best_of":a.best_of,"openai.request.echo":a.echo,"openai.request.logprobs":a.logprobs,"openai.request.max_tokens":a.max_tokens,"openai.request.model":a.model,"openai.request.n":a.n,"openai.request.presence_penalty":a.presence_penalty,"openai.request.frequency_penalty":a.frequency_penalty,"openai.request.stop":a.stop,"openai.request.suffix":a.suffix,"openai.request.temperature":a.temperature,"openai.request.top_p":a.top_p,"openai.request.user":a.user,"openai.request.file_id":a.file_id}},!1),d=Object.create(null),h={};if(a.prompt){const e=a.prompt;if(d.prompt=e,"string"==typeof e||Array.isArray(e)&&"number"==typeof e[0])h["openai.request.prompt"]=_(e,!0);else if(Array.isArray(e))for(let t=0;t<e.length;t++)h[`openai.request.prompt.${t}`]=_(e[t],!0)}if(a.input){const e=_(a.input,!1);h["openai.request.input"]=p(e),d.input=e}if(null!==a.logit_bias&&"object"==typeof a.logit_bias)for(const[e,t]of Object.entries(a.logit_bias))h[`openai.request.logit_bias.${e}`]=t;switch(a.stream&&(h["openai.request.stream"]=a.stream),t){case"createFineTune":case"fine_tuning.jobs.create":case"fine-tune.create":!function(e,t){e["openai.request.training_file"]=t.training_file,e["openai.request.validation_file"]=t.validation_file,e["openai.request.n_epochs"]=t.n_epochs,e["openai.request.batch_size"]=t.batch_size,e["openai.request.learning_rate_multiplier"]=t.learning_rate_multiplier,e["openai.request.prompt_loss_weight"]=t.prompt_loss_weight,e["openai.request.compute_classification_metrics"]=t.compute_classification_metrics,e["openai.request.classification_n_classes"]=t.classification_n_classes,e["openai.request.classification_positive_class"]=t.classification_positive_class,e["openai.request.classification_betas_count"]=y(t.classification_betas)}(h,a);break;case"createImage":case"images.generate":case"createImageEdit":case"images.edit":case"createImageVariation":case"images.createVariation":!function(e,t,r){const n=t.file||t.image;if(null!==n&&"object"==typeof n&&n.path){const t=s.basename(n.path);e["openai.request.image"]=t,r.file=t}if(null!==t.mask&&"object"==typeof t.mask&&t.mask.path){const n=s.basename(t.mask.path);e["openai.request.mask"]=n,r.mask=n}e["openai.request.size"]=t.size,e["openai.request.response_format"]=t.response_format,e["openai.request.language"]=t.language}(h,a,d);break;case"createChatCompletion":case"chat.completions.create":!function(e,t,r){if(y(t.messages)){r.messages=t.messages;for(let r=0;r<t.messages.length;r++){const s=t.messages[r];m(s.content,r,e),e[`openai.request.messages.${r}.role`]=s.role,e[`openai.request.messages.${r}.name`]=s.name,e[`openai.request.messages.${r}.finish_reason`]=s.finish_reason}}}(h,a,d);break;case"createFile":case"files.create":case"retrieveFile":case"files.retrieve":!function(e,t){e["openai.request.purpose"]=t.purpose,null!==t.file&&"object"==typeof t.file&&t.file.path&&(e["openai.request.filename"]=s.basename(t.file.path))}(h,a);break;case"createTranscription":case"audio.transcriptions.create":case"createTranslation":case"audio.translations.create":!function(e,t,r){if(e["openai.request.response_format"]=t.response_format,e["openai.request.language"]=t.language,null!==t.file&&"object"==typeof t.file&&t.file.path){const n=s.basename(t.file.path);e["openai.request.filename"]=n,r.file=n}}(h,a,d);break;case"retrieveModel":case"models.retrieve":!function(e,t){e["openai.request.id"]=t.id}(h,a);break;case"listFineTuneEvents":case"fine_tuning.jobs.listEvents":case"fine-tune.listEvents":case"retrieveFineTune":case"fine_tuning.jobs.retrieve":case"fine-tune.retrieve":case"deleteModel":case"models.del":case"cancelFineTune":case"fine_tuning.jobs.cancel":case"fine-tune.cancel":!function(e,t){e["openai.request.fine_tune_id"]=t.fine_tune_id,e["openai.request.stream"]=!!t.stream}(h,a);break;case"createEdit":case"edits.create":!function(e,t,r){const s=t.instruction;e["openai.request.instruction"]=s,r.instruction=s}(h,a,d)}return l.addTags(h),e.currentStore={...u,span:l,openai:d},e.currentStore}asyncEnd(e){const{result:t}=e,r=e.currentStore,s=r?.span;if(!s)return;const n=!!s.context()._tags.error;let i,o,a,c;n||(i=t.headers,o=t.data,a=t.request.method,c=t.request.path),n||"Headers"!==i?.constructor.name||(i=Object.fromEntries(i));const u=s._spanContext._tags["resource.name"];o=function(e,t){switch(t){case"downloadFile":case"files.retrieveContent":case"files.content":return{file:e}}const r=typeof e;if("string"!==r)return"object"===r?e:{};try{return JSON.parse(e)}catch{return e}}(o,u);const l=r.openai;n||!c?.startsWith("https://")&&!c?.startsWith("http://")||(c=new URL(c).pathname);const d=function(e,t){switch(e){case"deleteModel":case"models.del":case"retrieveModel":case"models.retrieve":return"/v1/models/*";case"deleteFile":case"files.del":case"retrieveFile":case"files.retrieve":return"/v1/files/*";case"downloadFile":case"files.retrieveContent":case"files.content":return"/v1/files/*/content";case"retrieveFineTune":case"fine-tune.retrieve":return"/v1/fine-tunes/*";case"fine_tuning.jobs.retrieve":return"/v1/fine_tuning/jobs/*";case"listFineTuneEvents":case"fine-tune.listEvents":return"/v1/fine-tunes/*/events";case"fine_tuning.jobs.listEvents":return"/v1/fine_tuning/jobs/*/events";case"cancelFineTune":case"fine-tune.cancel":return"/v1/fine-tunes/*/cancel";case"fine_tuning.jobs.cancel":return"/v1/fine_tuning/jobs/*/cancel"}return t}(u,c),h=n?{}:{"openai.request.endpoint":d,"openai.request.method":a.toUpperCase(),"openai.organization.id":o.organization_id,"openai.organization.name":i["openai-organization"],"openai.response.model":i["openai-model"]||o.model,"openai.response.id":o.id,"openai.response.deleted":o.deleted,"openai.response.created":o.created,"openai.response.created_at":o.created_at};!function(e,t,r,s){switch(e){case"createModeration":case"moderations.create":!function(e,t){if(e["openai.response.id"]=t.id,t.results){e["openai.response.flagged"]=t.results[0].flagged;for(const[r,s]of Object.entries(t.results[0].categories))e[`openai.response.categories.${r}`]=s;for(const[r,s]of Object.entries(t.results[0].category_scores))e[`openai.response.category_scores.${r}`]=s}}(t,r);break;case"createCompletion":case"completions.create":case"createChatCompletion":case"chat.completions.create":case"createEdit":case"edits.create":!function(e,t,r,s){if(f(e,t,s,r),t.choices){e["openai.response.choices_count"]=t.choices.length,r.choices=t.choices;for(let r=0;r<t.choices.length;r++){const s=t.choices[r],n=-1!==Object.keys(s).indexOf("logprobs");e[`openai.response.choices.${r}.finish_reason`]=s.finish_reason,e[`openai.response.choices.${r}.logprobs`]=n?"returned":void 0,e[`openai.response.choices.${r}.text`]=p(s.text);const i=s.message||s.delta;if(i&&(e[`openai.response.choices.${r}.message.role`]=i.role,e[`openai.response.choices.${r}.message.content`]=p(i.content),e[`openai.response.choices.${r}.message.name`]=p(i.name),i.tool_calls)){const t=i.tool_calls;for(let s=0;s<t.length;s++)e[`openai.response.choices.${r}.message.tool_calls.${s}.function.name`]=t[s].function.name,e[`openai.response.choices.${r}.message.tool_calls.${s}.function.arguments`]=t[s].function.arguments,e[`openai.response.choices.${r}.message.tool_calls.${s}.id`]=t[s].id}}}}(t,r,s,e);break;case"listFiles":case"files.list":case"listFineTunes":case"fine_tuning.jobs.list":case"fine-tune.list":case"listFineTuneEvents":case"fine_tuning.jobs.listEvents":case"fine-tune.listEvents":case"listModels":case"models.list":!function(e,t){t.data&&(e["openai.response.count"]=t.data.length)}(t,r);break;case"createEmbedding":case"embeddings.create":!function(e,t,r){if(f(e,t,r),t.data){e["openai.response.embeddings_count"]=t.data.length;for(let r=0;r<t.data.length;r++)e[`openai.response.embedding.${r}.embedding_length`]=t.data[r].embedding.length}}(t,r,s);break;case"createFile":case"files.create":case"retrieveFile":case"files.retrieve":!function(e,t){e["openai.response.filename"]=t.filename,e["openai.response.purpose"]=t.purpose,e["openai.response.bytes"]=t.bytes,e["openai.response.status"]=t.status,e["openai.response.status_details"]=t.status_details}(t,r);break;case"deleteFile":case"files.del":!function(e,t){e["openai.response.id"]=t.id}(t,r);break;case"downloadFile":case"files.retrieveContent":case"files.content":!function(e,t){t.file&&(e["openai.response.total_bytes"]=t.file.length)}(t,r);break;case"createFineTune":case"fine_tuning.jobs.create":case"fine-tune.create":case"retrieveFineTune":case"fine_tuning.jobs.retrieve":case"fine-tune.retrieve":case"cancelFineTune":case"fine_tuning.jobs.cancel":case"fine-tune.cancel":!function(e,t){e["openai.response.events_count"]=y(t.events),e["openai.response.fine_tuned_model"]=t.fine_tuned_model;const r=t.hyperparams||t.hyperparameters,s=t.hyperparams?"hyperparams":"hyperparameters";r&&(e[`openai.response.${s}.n_epochs`]=r.n_epochs,e[`openai.response.${s}.batch_size`]=r.batch_size,e[`openai.response.${s}.prompt_loss_weight`]=r.prompt_loss_weight,e[`openai.response.${s}.learning_rate_multiplier`]=r.learning_rate_multiplier),e["openai.response.training_files_count"]=y(t.training_files||t.training_file),e["openai.response.result_files_count"]=y(t.result_files),e["openai.response.validation_files_count"]=y(t.validation_files||t.validation_file),e["openai.response.updated_at"]=t.updated_at,e["openai.response.status"]=t.status}(t,r);break;case"createTranscription":case"audio.transcriptions.create":case"createTranslation":case"audio.translations.create":!function(e,t){e["openai.response.text"]=t.text,e["openai.response.language"]=t.language,e["openai.response.duration"]=t.duration,e["openai.response.segments_count"]=y(t.segments)}(t,r);break;case"createImage":case"images.generate":case"createImageEdit":case"images.edit":case"createImageVariation":case"images.createVariation":!function(e,t){if(t.data){e["openai.response.images_count"]=t.data.length;for(let r=0;r<t.data.length;r++){const s=t.data[r];e[`openai.response.images.${r}.url`]=p(s.url),e[`openai.response.images.${r}.b64_json`]=s.b64_json&&"returned"}}}(t,r);break;case"retrieveModel":case"models.retrieve":!function(e,t){e["openai.response.owned_by"]=t.owned_by,e["openai.response.parent"]=t.parent,e["openai.response.root"]=t.root,t.permission&&(e["openai.response.permission.id"]=t.permission[0].id,e["openai.response.permission.created"]=t.permission[0].created,e["openai.response.permission.allow_create_engine"]=t.permission[0].allow_create_engine,e["openai.response.permission.allow_sampling"]=t.permission[0].allow_sampling,e["openai.response.permission.allow_logprobs"]=t.permission[0].allow_logprobs,e["openai.response.permission.allow_search_indices"]=t.permission[0].allow_search_indices,e["openai.response.permission.allow_view"]=t.permission[0].allow_view,e["openai.response.permission.allow_fine_tuning"]=t.permission[0].allow_fine_tuning,e["openai.response.permission.organization"]=t.permission[0].organization,e["openai.response.permission.group"]=t.permission[0].group,e["openai.response.permission.is_blocking"]=t.permission[0].is_blocking)}(t,r)}}(u,h,o,l),s.addTags(h),s.finish(),this.sendLog(u,s,h,l,n),this.sendMetrics(i,o,d,s._duration,n,h)}sendMetrics(e,t,r,s,n,i){const o=[`error:${Number(!!n)}`];n?this.metrics.increment("openai.request.error",1,o):(o.push(`org:${e["openai-organization"]}`),o.push(`endpoint:${r}`),o.push(`model:${e["openai-model"]||t.model}`)),this.metrics.distribution("openai.request.duration",1e3*s,o);const a=i["openai.response.usage.prompt_tokens"],c=i["openai.response.usage.prompt_tokens_estimated"],u=i["openai.response.usage.completion_tokens"],l=i["openai.response.usage.completion_tokens_estimated"],p=i["openai.response.usage.total_tokens"];n||(null!=a&&(c?this.metrics.distribution("openai.tokens.prompt",a,[...o,"openai.estimated:true"]):this.metrics.distribution("openai.tokens.prompt",a,o)),null!=u&&(l?this.metrics.distribution("openai.tokens.completion",u,[...o,"openai.estimated:true"]):this.metrics.distribution("openai.tokens.completion",u,o)),null!=p&&(c||l?this.metrics.distribution("openai.tokens.total",p,[...o,"openai.estimated:true"]):this.metrics.distribution("openai.tokens.total",p,o))),e&&(e["x-ratelimit-limit-requests"]&&this.metrics.gauge("openai.ratelimit.requests",Number(e["x-ratelimit-limit-requests"]),o),e["x-ratelimit-remaining-requests"]&&this.metrics.gauge("openai.ratelimit.remaining.requests",Number(e["x-ratelimit-remaining-requests"]),o),e["x-ratelimit-limit-tokens"]&&this.metrics.gauge("openai.ratelimit.tokens",Number(e["x-ratelimit-limit-tokens"]),o),e["x-ratelimit-remaining-tokens"]&&this.metrics.gauge("openai.ratelimit.remaining.tokens",Number(e["x-ratelimit-remaining-tokens"]),o))}sendLog(e,t,r,s,n){if(!s)return;if(!Object.keys(s).length)return;if(!this.sampler.isSampled())return;const i={status:n?"error":"info",message:`sampled ${e}`,...s};this.logger.log(i,t,r)}}},46063:e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=46063,e.exports=t},43196:(e,t,r)=>{"use strict";const s=r(45613);e.exports=class extends s{static get id(){return"opensearch"}}},18824:(e,t,r)=>{"use strict";const{CLIENT_PORT_KEY:s}=r(23636),n=r(42537),i=r(75004);e.exports=class extends n{static get id(){return"oracledb"}static get system(){return"oracle"}static get peerServicePrecursors(){return["db.instance","db.hostname"]}start({query:e,connAttrs:t}){const r=this.serviceName({pluginConfig:this.config,params:t}),n=function(e){try{return new URL(`http://${e}`)}catch(e){return i.error("Invalid oracle connection string",e),{}}}(t.connectString);this.startSpan(this.operationName(),{service:r,resource:e,type:"sql",kind:"client",meta:{"db.user":this.config.user,"db.instance":n.pathname&&n.pathname.substring(1),"db.hostname":n.hostname,[s]:n.port}})}}},4896:(e,t,r)=>{"use strict";const s=r(12583),n=r(78526),i=r(65405);e.exports=class extends s{static get id(){return"paperplane"}constructor(...e){super(...e),this.server=new i(...e),this.logger=new n(...e)}configure(e){this.server.configure(e),this.logger.configure(e)}}},78526:(e,t,r)=>{"use strict";const s=r(15700);e.exports=class extends s{static get id(){return"paperplane"}}},65405:(e,t,r)=>{"use strict";const s=r(78693),n=r(5593);e.exports=class extends s{static get id(){return"paperplane"}constructor(...e){super(...e),this.addSub("apm:paperplane:request:handle",(e=>{this.setFramework(e,"paperplane",this.config)})),this.addSub("apm:paperplane:request:route",(({req:e,route:t})=>{n.setRoute(e,t)}))}}},52369:(e,t,r)=>{"use strict";const{CLIENT_PORT_KEY:s}=r(23636),n=r(42537);e.exports=class extends n{static get id(){return"pg"}static get operation(){return"query"}static get system(){return"postgres"}start({params:e={},query:t,processId:r}){const n=this.serviceName({pluginConfig:this.config,params:e}),i=this.maybeTruncate(t.text),o=this.startSpan(this.operationName(),{service:n,resource:i,type:"sql",kind:"client",meta:{"db.type":"postgres","db.pid":r,"db.name":e.database,"db.user":e.user,"out.host":e.host,[s]:e.port}});t.__ddInjectableQuery=this.injectDbmQuery(o,t.text,n,!!t.name)}}},56952:(e,t,r)=>{"use strict";const s=r(15700);e.exports=class extends s{static get id(){return"pino"}}},15635:(e,t,r)=>{"use strict";const{storage:s}=r(96882),n=r(32028),{TEST_STATUS:i,finishAllTraceSpans:o,getTestSuitePath:a,getTestSuiteCommonTags:c,TEST_SOURCE_START:u,TEST_CODE_OWNERS:l,TEST_SOURCE_FILE:p,TEST_CONFIGURATION_BROWSER_NAME:d,TEST_IS_NEW:h,TEST_IS_RETRY:f,TEST_EARLY_FLAKE_ENABLED:g,TELEMETRY_TEST_SESSION:m,TEST_RETRY_REASON:_}=r(97507),{RESOURCE_NAME:y}=r(74100),{COMPONENT:b}=r(23636),{TELEMETRY_EVENT_CREATED:v,TELEMETRY_EVENT_FINISHED:E}=r(60806),{appClosing:S}=r(33837);e.exports=class extends n{static get id(){return"playwright"}constructor(...e){super(...e),this._testSuites=new Map,this.numFailedTests=0,this.numFailedSuites=0,this.addSub("ci:playwright:session:finish",(({status:e,isEarlyFlakeDetectionEnabled:t,onDone:r})=>{if(this.testModuleSpan.setTag(i,e),this.testSessionSpan.setTag(i,e),t&&this.testSessionSpan.setTag(g,"true"),this.numFailedSuites>0){let e=`Test suites failed: ${this.numFailedSuites}.`;this.numFailedTests>0&&(e+=` Tests failed: ${this.numFailedTests}`);const t=new Error(e);this.testModuleSpan.setTag("error",t),this.testSessionSpan.setTag("error",t)}this.testModuleSpan.finish(),this.telemetry.ciVisEvent(E,"module"),this.testSessionSpan.finish(),this.telemetry.ciVisEvent(E,"session"),o(this.testSessionSpan),this.telemetry.count(m,{provider:this.ciProviderName}),S(),this.tracer._exporter.flush(r),this.numFailedTests=0})),this.addSub("ci:playwright:test-suite:start",(e=>{const t=s.getStore(),r=a(e,this.rootDir),n=a(e,this.repositoryRoot),i=c(this.command,this.frameworkVersion,r,"playwright");n&&(i[p]=n,i[u]=1);const o=this.getCodeOwners(i);o&&(i[l]=o);const d=this.tracer.startSpan("playwright.test_suite",{childOf:this.testModuleSpan,tags:{[b]:this.constructor.id,...this.testEnvironmentMetadata,...i}});this.telemetry.ciVisEvent(v,"suite"),this.enter(d,t),this._testSuites.set(r,d)})),this.addSub("ci:playwright:test-suite:finish",(({status:e,error:t})=>{const r=s.getStore(),n=r&&r.span;n&&(t?(n.setTag("error",t),n.setTag(i,"fail")):n.setTag(i,e),("fail"===e||t)&&this.numFailedSuites++,n.finish(),this.telemetry.ciVisEvent(E,"suite"))})),this.addSub("ci:playwright:test:start",(({testName:e,testSuiteAbsolutePath:t,testSourceLine:r,browserName:n})=>{const i=s.getStore(),o=a(t,this.rootDir),c=a(t,this.repositoryRoot),u=this.startTestSpan(e,o,c,r,n);this.enter(u,i)})),this.addSub("ci:playwright:test:finish",(({testStatus:e,steps:t,error:r,extraTags:n,isNew:a,isEfdRetry:c,isRetry:u})=>{const p=s.getStore(),d=p&&p.span;d&&(d.setTag(i,e),r&&d.setTag("error",r),n&&d.addTags(n),a&&(d.setTag(h,"true"),c&&(d.setTag(f,"true"),d.setTag(_,"efd"))),u&&d.setTag(f,"true"),t.forEach((e=>{const t=e.startTime.getTime(),r=this.tracer.startSpan("playwright.step",{childOf:d,startTime:t,tags:{[b]:this.constructor.id,"playwright.step":e.title,[y]:e.title}});e.error&&r.setTag("error",e.error);let s=e.duration;(s<=0||isNaN(s))&&(s=0),r.finish(t+s)})),"fail"===e&&this.numFailedTests++,this.telemetry.ciVisEvent(E,"test",{hasCodeOwners:!!d.context()._tags[l],isNew:a,browserDriver:"playwright"}),d.finish(),o(d))}))}startTestSpan(e,t,r,s,n){const i=this._testSuites.get(t),o={[u]:s};return r&&(o[p]=r||t),n&&(o[d]=n),super.startTestSpan(e,t,i,o)}}},35812:(e,t,r)=>{const s=r(56875),n=r(98110);e.exports=class extends s{static get id(){return"protobufjs"}static get schemaExtractor(){return n}}},98110:(e,t,r)=>{const{SCHEMA_DEFINITION:s,SCHEMA_ID:n,SCHEMA_NAME:i,SCHEMA_OPERATION:o,SCHEMA_WEIGHT:a,SCHEMA_TYPE:c}=r(23636),u=r(75004),{SchemaBuilder:l}=r(62957);class p{constructor(e){this.schema=e}static getTypeAndFormat(e){return{int32:["integer","int32"],int64:["integer","int64"],uint32:["integer","uint32"],uint64:["integer","uint64"],sint32:["integer","sint32"],sint64:["integer","sint64"],fixed32:["integer","fixed32"],fixed64:["integer","fixed64"],sfixed32:["integer","sfixed32"],sfixed64:["integer","sfixed64"],float:["number","float"],double:["number","double"],bool:["boolean",null],string:["string",null],bytes:["string","byte"],Enum:["enum",null],Type:["type",null],map:["map",null],repeated:["array",null]}[e]||["string",null]}static extractProperty(e,t,r,s,n){let i,o,a=!1;const c=e.resolvedType?e.resolvedType.constructor.name:e.type,u="repeated"===e.rule;let l=this.getTypeAndFormat(u?"repeated":c),p=l[0],h=l[1];if("array"===p&&(a=!0,l=this.getTypeAndFormat(c),p=l[0],h=l[1]),"type"===p){h=null,i=`#/components/schemas/${d(e.resolvedType.fullName)}`;const t=s.iterator;if(!this.extractSchema(e.resolvedType,s,n,this))return!1;p="object",s.iterator=t}else if("enum"===p){o=[];let t=0;for(;e.resolvedType.valuesById[t];)o.push(e.resolvedType.valuesById[t]),t+=1}return s.addProperty(t,r,a,p,void 0,i,h,o)}static extractSchema(e,t,r,s){r+=1;const n=d(e.resolvedType?e.resolvedType.fullName:e.fullName);if(s){const r=new p(e);t.iterator=r;const s=l.getSchema(n,r,t);for(const e in s.components.schemas)s.components.schemas.hasOwnProperty(e)&&(t.schema.components.schemas[e]=s.components.schemas[e]);return!0}if(!t.shouldExtractSchema(n,r))return!1;for(const s of e.fieldsArray)this.extractProperty(s,n,s.name,t,r)||u.warn(`DSM: Unable to extract field with name: ${s.name} from Avro schema with name: ${n}`);return!0}static extractSchemas(e,t){const r=d(e.resolvedType?e.resolvedType.fullName:e.fullName);return t.getSchema(r,new p(e))}iterateOverSchema(e){this.constructor.extractSchema(this.schema,e,0)}static attachSchemaOnSpan(e,t,r,u){const{messageClass:p}=e,h=p.$type??p;if(!h||!t)return;if(t.context()._tags[c]&&"serialization"===r)return;if(t.setTag(c,"protobuf"),t.setTag(i,d(h.fullName)),t.setTag(o,r),!u._dataStreamsProcessor.canSampleSchema(r))return;if(!u._prioritySampler.isSampled(t))return;const f=u._dataStreamsProcessor.trySampleSchema(r);if(0===f)return;const g=l.getSchemaDefinition(this.extractSchemas(h,u._dataStreamsProcessor));t.setTag(s,g.definition),t.setTag(a,f),t.setTag(n,g.id)}}function d(e){return"."===e.charAt(0)?e.slice(1):e}e.exports=p},83197:(e,t,r)=>{"use strict";const{CLIENT_PORT_KEY:s}=r(23636),n=r(58500),i=r(70240);function o(e,t){if(!t||"AUTH"===e)return e;for(let r=0,s=t.length;r<s;r++)if("function"!=typeof t[r]&&(e=`${e} ${a(t[r])}`).length>1e3)return c(e,1e3);return e}function a(e){switch(typeof e){case"string":case"number":return c(String(e),100);default:return"?"}}function c(e,t){return e.length>t&&(e=e.substr(0,t-3)+"..."),e}function u(e){for(let t=0;t<e.length;t++)e[t]=String(e[t]).toUpperCase()}e.exports=class extends n{static get id(){return"redis"}static get system(){return"redis"}start({db:e,command:t,args:r,connectionOptions:n={},connectionName:i}){const a=t,c=t.toUpperCase();if(!this.config.filter(c))return this.skip();this.startSpan({resource:a,service:this.serviceName({pluginConfig:this.config,system:this.system,connectionName:i}),type:"redis",meta:{"db.type":"redis","db.name":e||"0","redis.raw_command":o(c,r),"out.host":n.host,[s]:n.port}})}configure(e){super.configure(function(e){e.allowlist&&u(e.allowlist),e.whitelist&&u(e.whitelist),e.blocklist&&u(e.blocklist),e.blacklist&&u(e.blacklist);const t=i.getFilter(e);return Object.assign({},e,{filter:t})}(e))}}},91370:(e,t,r)=>{"use strict";const s=r(78693),n=r(5593);e.exports=class extends s{static get id(){return"restify"}constructor(...e){super(...e),this.addSub("apm:restify:request:handle",(({req:e})=>{this.setFramework(e,"restify",this.config)})),this.addSub("apm:restify:request:route",(({req:e,route:t})=>{n.setRoute(e,t)}))}configure(e){return super.configure({...e,middleware:!1})}}},1014:(e,t,r)=>{"use strict";const s=r(57232),{storage:n}=r(96882),{getAmqpMessageSize:i}=r(63011);e.exports=class extends s{static get id(){return"rhea"}constructor(...e){super(...e),this.addTraceSub("dispatch",(({state:e})=>{n.getStore().span.setTag("amqp.delivery.state",e)}))}start({msgObj:e}){const t=function(e){let t="amq.topic",r={};return e.receiver&&e.receiver.options&&(r=e.receiver.options),r.source&&r.source.address&&(t=r.source.address),t}(e),r=function(e,t){if(e.message)return t.extract("text_map",e.message.delivery_annotations)}(e,this.tracer),s=this.startSpan({childOf:r,resource:t,type:"worker",meta:{component:"rhea","amqp.link.source.address":t,"amqp.link.role":"receiver"}});if(this.config.dsmEnabled&&e?.message?.delivery_annotations){const r=i({headers:e.message.delivery_annotations,content:e.message.body});this.tracer.decodeDataStreamsContext(e.message.delivery_annotations),this.tracer.setCheckpoint(["direction:in",`topic:${t}`,"type:rabbitmq"],s,r)}}}},16452:(e,t,r)=>{"use strict";const s=r(52056),n=r(1014),i=r(42257);e.exports=class extends i{static get id(){return"rhea"}static get plugins(){return{producer:s,consumer:n}}}},52056:(e,t,r)=>{"use strict";const{CLIENT_PORT_KEY:s}=r(23636),n=r(36878),{DsmPathwayCodec:i}=r(71793),{getAmqpMessageSize:o}=r(63011);e.exports=class extends n{static get id(){return"rhea"}static get operation(){return"send"}constructor(...e){super(...e),this.addTraceSub("encode",this.encode.bind(this))}start({targetAddress:e,host:t,port:r}){const n=e||"amq.topic";this.startSpan({resource:n,meta:{component:"rhea","amqp.link.target.address":n,"amqp.link.role":"sender","out.host":t,[s]:r}})}encode(e){!function(e,t,r){if(e&&(e.delivery_annotations=e.delivery_annotations||{},t.inject(r,"text_map",e.delivery_annotations),t._config.dsmEnabled)){const s=r.context()._tags["amqp.link.target.address"],n=o({content:e.body,headers:e.delivery_annotations}),a=t.setCheckpoint(["direction:out",`exchange:${s}`,"type:rabbitmq"],r,n);i.encode(a,e.delivery_annotations)}}(e,this.tracer,this.activeSpan)}}},78693:(e,t,r)=>{"use strict";const s=r(5593),n=r(46528),i=r(88378),{storage:o}=r(96882),{COMPONENT:a}=r(23636);function c(e){return e.includes("(/")}e.exports=class extends n{static get id(){return"router"}constructor(...e){super(...e),this._storeStack=[],this._contexts=new WeakMap,this.addSub(`apm:${this.constructor.id}:middleware:enter`,(({req:e,name:t,route:r})=>{const n=this._getActive(e)||this._getStoreSpan();if(!n)return;const i=this._getMiddlewareSpan(t,n),a=this._createContext(e,r,n);n!==i&&a.middleware.push(i);const c=o.getStore();this._storeStack.push(c),this.enter(i,c),s.patch(e),s.setRoute(e,a.route)})),this.addSub(`apm:${this.constructor.id}:middleware:next`,(({req:e})=>{const t=this._contexts.get(e);t&&t.stack.pop()})),this.addSub(`apm:${this.constructor.id}:middleware:finish`,(({req:e})=>{const t=this._contexts.get(e);t&&0!==t.middleware.length&&t.middleware.pop().finish()})),this.addSub(`apm:${this.constructor.id}:middleware:exit`,(({req:e})=>{const t=this._storeStack.pop(),r=t&&t.span;this.enter(r,t)})),this.addSub(`apm:${this.constructor.id}:middleware:error`,(({req:e,error:t})=>{if(s.addError(e,t),!this.config.middleware)return;const r=this._getActive(e);r&&r.setTag("error",t)})),this.addSub("apm:http:server:request:finish",(({req:e})=>{const t=this._contexts.get(e);if(!t)return;let r;for(;r=t.middleware.pop();)r.finish()}))}_getActive(e){const t=this._contexts.get(e);if(t)return 0===t.middleware.length?t.span:t.middleware[t.middleware.length-1]}_getStoreSpan(){const e=o.getStore();return e&&e.span}_getMiddlewareSpan(e,t){if(!1===this.config.middleware)return t;const r=this.tracer.startSpan(`${this.constructor.id}.middleware`,{childOf:t,tags:{[a]:this.constructor.id,"resource.name":e||"<anonymous>"}});return i.sample(r,this.config.measured),r}_createContext(e,t,r){let s=this._contexts.get(e);return t&&"/"!==t&&"*"!==t||(t=""),s?(s.stack.push(t),n=t=s.stack.join(""),i=s.route,(!(c(n)||!c(i))||n.length>i.length)&&(s.route=t)):(s={span:r,stack:[t],route:t,middleware:[]},this._contexts.set(e,s)),s;var n,i}}},96112:(e,t,r)=>{const s=r(32028),{storage:n}=r(96882),{TEST_IS_RUM_ACTIVE:i,TEST_BROWSER_DRIVER:o,TEST_BROWSER_DRIVER_VERSION:a,TEST_BROWSER_NAME:c,TEST_BROWSER_VERSION:u,TEST_TYPE:l}=r(97507),{SPAN_TYPE:p}=r(74100);function d(e){return"test"===e.context()._tags[p]}e.exports=class extends s{static get id(){return"selenium"}constructor(...e){super(...e),this.addSub("ci:selenium:driver:get",(({setTraceId:e,seleniumVersion:t,browserName:r,browserVersion:s,isRumActive:p})=>{const h=n.getStore(),f=h?.span;if(!f)return;let g;g=d(f)?f:function(e){for(const t of e.started)if(d(t))return t;return null}(f.context()._trace),g&&(e&&e(g.context().toTraceId()),p&&g.setTag(i,"true"),g.setTag(o,"selenium"),g.setTag(a,t),g.setTag(c,r),g.setTag(u,s),g.setTag(l,"browser"))}))}}},96887:(e,t,r)=>{"use strict";const s=r(38103);function n(e,t,r){return t&&(e+=" "+t),r&&(e+=" "+JSON.stringify(i(r))),e}function i(e){const t={};if(null===(r=e)||"object"!=typeof r||Array.isArray(r)||Buffer.isBuffer(e))return"?";var r;for(const r in e)"function"!=typeof e[r]&&(t[r]=i(e[r]));return t}e.exports=class extends s{static get id(){return"sharedb"}start({actionName:e,request:t}){const r=this.startSpan("sharedb.request",{service:this.config.service,resource:n(e,t.c,t.q),kind:"server",meta:{"sharedb.action":e}});this.config.hooks&&this.config.hooks.receive&&this.config.hooks.receive(r,t)}finish({request:e,res:t}){const r=this.activeSpan;this.config.hooks&&this.config.hooks.reply&&this.config.hooks.reply(r,e,t),super.finish()}}},87703:(e,t,r)=>{"use strict";const{CLIENT_PORT_KEY:s}=r(23636),n=r(42537);e.exports=class extends n{static get id(){return"tedious"}static get operation(){return"request"}static get system(){return"mssql"}start({queryOrProcedure:e,connectionConfig:t}){this.startSpan(this.operationName(),{service:this.serviceName({pluginConfig:this.config,system:this.system}),resource:e,type:"sql",kind:"client",meta:{"db.type":"mssql",component:"tedious","out.host":t.server,[s]:t.options.port,"db.user":t.userName||t.authentication.options.userName,"db.name":t.options.database,"db.instance":t.options.instanceName}})}}},91268:(e,t,r)=>{"use strict";const s=r(87222);e.exports=class extends s{static get id(){return"undici"}static get prefix(){return"tracing:apm:undici:fetch"}}},4853:(e,t,r)=>{const s=r(32028),{storage:n}=r(96882),{TEST_STATUS:i,finishAllTraceSpans:o,getTestSuitePath:a,getTestSuiteCommonTags:c,getTestSessionName:u,getIsFaultyEarlyFlakeDetection:l,TEST_SOURCE_FILE:p,TEST_IS_RETRY:d,TEST_CODE_COVERAGE_LINES_PCT:h,TEST_CODE_OWNERS:f,TEST_LEVEL_EVENT_TYPES:g,TEST_SESSION_NAME:m,TEST_SOURCE_START:_,TEST_IS_NEW:y,TEST_EARLY_FLAKE_ENABLED:b,TEST_EARLY_FLAKE_ABORT_REASON:v,TEST_RETRY_REASON:E}=r(97507),{COMPONENT:S}=r(23636),{TELEMETRY_EVENT_CREATED:T,TELEMETRY_EVENT_FINISHED:w,TELEMETRY_TEST_SESSION:x}=r(60806);e.exports=class extends s{static get id(){return"vitest"}constructor(...e){super(...e),this.taskToFinishTime=new WeakMap,this.addSub("ci:vitest:test:is-new",(({knownTests:e,testSuiteAbsolutePath:t,testName:r,onDone:s})=>{s(!(e[a(t,this.repositoryRoot)]||[]).includes(r))})),this.addSub("ci:vitest:is-early-flake-detection-faulty",(({knownTests:e,testFilepaths:t,onDone:r})=>{r(l(t.map((e=>a(e,this.repositoryRoot))),e,this.libraryConfig.earlyFlakeDetectionFaultyThreshold))})),this.addSub("ci:vitest:test:start",(({testName:e,testSuiteAbsolutePath:t,isRetry:r,isNew:s,mightHitProbe:i,isRetryReasonEfd:o})=>{const c=a(t,this.repositoryRoot),u=n.getStore(),l={[p]:c};r&&(l[d]="true"),s&&(l[y]="true"),o&&(l[E]="efd");const h=this.startTestSpan(e,c,this.testSuiteSpan,l);this.enter(h,u),i&&(this.activeTestSpan=h)})),this.addSub("ci:vitest:test:finish-time",(({status:e,task:t})=>{const r=n.getStore(),s=r?.span;s&&(s.setTag(i,e),this.taskToFinishTime.set(t,s._getTime()))})),this.addSub("ci:vitest:test:pass",(({task:e})=>{const t=n.getStore(),r=t?.span;r&&(this.telemetry.ciVisEvent(w,"test",{hasCodeowners:!!r.context()._tags[f]}),r.setTag(i,"pass"),r.finish(this.taskToFinishTime.get(e)),o(r))})),this.addSub("ci:vitest:test:error",(({duration:e,error:t,shouldSetProbe:r,promises:s})=>{const a=n.getStore(),c=a?.span;if(c){if(r&&this.di){const e=this.addDiProbe(t);if(e){const{file:t,line:r,stackIndex:n,setProbePromise:i}=e;this.runningTestProbe={file:t,line:r},this.testErrorStackIndex=n,s.setProbePromise=i}}this.telemetry.ciVisEvent(w,"test",{hasCodeowners:!!c.context()._tags[f]}),c.setTag(i,"fail"),t&&c.setTag("error",t),e?c.finish(c._startTime+e-5):c.finish(),o(c)}})),this.addSub("ci:vitest:test:skip",(({testName:e,testSuiteAbsolutePath:t,isNew:r})=>{const s=a(t,this.repositoryRoot),n=this.startTestSpan(e,s,this.testSuiteSpan,{[p]:s,[_]:1,[i]:"skip",...r?{[y]:"true"}:{}});this.telemetry.ciVisEvent(w,"test",{hasCodeowners:!!n.context()._tags[f]}),n.finish()})),this.addSub("ci:vitest:test-suite:start",(({testSuiteAbsolutePath:e,frameworkVersion:t})=>{this.command=process.env.DD_CIVISIBILITY_TEST_COMMAND,this.frameworkVersion=t;const r=this.tracer.extract("text_map",{"x-datadog-trace-id":process.env.DD_CIVISIBILITY_TEST_SESSION_ID,"x-datadog-parent-id":process.env.DD_CIVISIBILITY_TEST_MODULE_ID}),s=u(this.config,this.command,this.testEnvironmentMetadata),i={};for(const e of g)i[e]={[m]:s};this.tracer._exporter.setMetadataTags&&this.tracer._exporter.setMetadataTags(i);const o=a(e,this.repositoryRoot),l=c(this.command,this.frameworkVersion,o,"vitest");l[p]=o,l[_]=1;const d=this.getCodeOwners(l);d&&(l[f]=d);const h=this.tracer.startSpan("vitest.test_suite",{childOf:r,tags:{[S]:this.constructor.id,...this.testEnvironmentMetadata,...l}});this.telemetry.ciVisEvent(T,"suite");const y=n.getStore();this.enter(h,y),this.testSuiteSpan=h})),this.addSub("ci:vitest:test-suite:finish",(({status:e,onFinish:t})=>{const r=n.getStore(),s=r?.span;s&&(s.setTag(i,e),s.finish(),o(s)),this.telemetry.ciVisEvent(w,"suite"),this.tracer._exporter.flush(t),this.runningTestProbe&&this.removeDiProbe(this.runningTestProbe)})),this.addSub("ci:vitest:test-suite:error",(({error:e})=>{const t=n.getStore(),r=t?.span;r&&e&&(r.setTag("error",e),r.setTag(i,"fail"))})),this.addSub("ci:vitest:session:finish",(({status:e,error:t,testCodeCoverageLinesTotal:r,isEarlyFlakeDetectionEnabled:s,isEarlyFlakeDetectionFaulty:n,onFinish:a})=>{this.testSessionSpan.setTag(i,e),this.testModuleSpan.setTag(i,e),t&&(this.testModuleSpan.setTag("error",t),this.testSessionSpan.setTag("error",t)),r&&(this.testModuleSpan.setTag(h,r),this.testSessionSpan.setTag(h,r)),s&&this.testSessionSpan.setTag(b,"true"),n&&this.testSessionSpan.setTag(v,"faulty"),this.testModuleSpan.finish(),this.telemetry.ciVisEvent(w,"module"),this.testSessionSpan.finish(),this.telemetry.ciVisEvent(w,"session"),o(this.testSessionSpan),this.telemetry.count(x,{provider:this.ciProviderName}),this.tracer._exporter.flush(a)}))}}},46528:(e,t,r)=>{"use strict";const s=r(12583),n=r(5593);e.exports=class extends s{static get id(){return"web"}configure(e){return super.configure(n.normalizeConfig(e))}setFramework(e,t,r){n.setFramework(e,t,r)}}},68506:(e,t,r)=>{"use strict";const s=r(15700);e.exports=class extends s{static get id(){return"winston"}}},81444:(e,t,r)=>{"use strict";e.exports=r(41262)},41262:(e,t,r)=>{"use strict";const s=r(75004),n=new WeakMap;function i(e,t){const r=Object.getPrototypeOf(e);r!==Function.prototype&&Object.setPrototypeOf(t,r);const s=Object.getOwnPropertyDescriptors(e),n=Reflect.ownKeys(s);for(const e of n)try{Object.defineProperty(t,e,s[e])}catch(e){}}class o{constructor(){this.called=!1,this.completed=!1,this.retVal=void 0}startCall(){this.called=!0}endCall(e){this.completed=!0,this.retVal=e}}function a(e){return e&&"object"==typeof e&&"function"==typeof e.then}let c=!!process.env.DD_INEJCTION_ENABLED;function u(e,t,r,u){u||(function(e,t){if(!e)throw new Error("No target object provided.");if("object"!=typeof e&&"function"!=typeof e)throw new Error("Invalid target.");if(!e[t])throw new Error(`No original method ${t}.`);if("function"!=typeof e[t])throw new Error(`Original method ${t} is not a function.`)}(e,t),function(e){if(!e)throw new Error("No function provided.");if("function"!=typeof e)throw new Error("Target is not a function.")}(r));const l=e[t];let p;if(c&&l){let e;const t=r((function(...t){const r=e;r.startCall();const s=l.apply(this,t);return a(s)?s.then(r.endCall.bind(r)):r.endCall(s),s})),n=function(e,t,r){if(t.completed)return s.error("Shimmer error was thrown after original function returned/resolved",r),t.retVal;if(!t.called)return s.error("Shimmer error was thrown before original function was called",r),l.apply(this,e);throw r};p=function(...r){e=new o;const s=n.bind(this,r,e);try{const e=t.apply(this,r);return a(e)?e.catch(s):e}catch(e){return s(e)}}}else p=r(l);const d=Object.getOwnPropertyDescriptor(e,t),h={configurable:!0,...d};if("function"==typeof l&&i(l,p),d){if(n.set(p,(()=>Object.defineProperty(e,t,d))),d.get||d.set?h.get=()=>p:h.value=p,!1===d.configurable)return Object.create(e,{[t]:h})}else n.set(p,(()=>delete e[t])),h.value=p,h.writable=!0;return Object.defineProperty(e,t,h),e}function l(e,t,r){return"function"==typeof t?function(){throw new Error("calling `wrap()` with 2 args is deprecated. Use wrapFunction instead.")}():u(e,t,r)}function p(e,t){if(!e)return e;const r=n.get(t?e[t]:e);return r?(r(),e):e}function d(e){return Array.isArray(e)?e:[e]}e.exports={wrap:l,wrapFunction:function(e,t){"function"==typeof e&&function(e){if(Function.prototype.toString.call(e).startsWith("class"))throw new Error("Target is a native class constructor and cannot be wrapped.")}(e);const r={func:e};u(r,"func",t,"function"!=typeof e);let s=r.func;const o=function(){return s.apply(this,arguments)};return n.set(o,(()=>{s=e})),"function"==typeof e&&i(e,o),o},massWrap:function(e,t,r){e=d(e),t=d(t);for(const s of e)for(const e of t)l(s,e,r)},unwrap:p,massUnwrap:function(e,t){e=d(e),t=d(t);for(const r of e)for(const e of t)p(r,e)},setSafe:function(e){c=e}}},14508:(e,t,r)=>{"use strict";if(!global._ddtrace){const e=r(97853);Object.defineProperty(global,"_ddtrace",{value:new e,enumerable:!1,configurable:!0,writable:!0}),global._ddtrace.default=global._ddtrace,global._ddtrace.tracer=global._ddtrace}e.exports=global._ddtrace},88378:(e,t,r)=>{"use strict";const{MEASURED:s}=r(74100);e.exports={sample(e,t,r){null!==t&&"object"==typeof t?this.sample(e,t[e.context()._name],r):void 0!==t?e.setTag(s,!!t):r&&e.setTag(s,!0)}}},14332:e=>{"use strict";const t={ONECLICK:"OneClick",ENABLED:"Enabled",DISABLED:"Disabled",fromConfig(e){switch(e.appsec.enabled){case!0:return t.ENABLED;case!1:return t.DISABLED;case void 0:return t.ONECLICK;default:return t.DISABLED}}};e.exports=t},84250:e=>{"use strict";e.exports={HTTP_INCOMING_BODY:"server.request.body",HTTP_INCOMING_QUERY:"server.request.query",HTTP_INCOMING_HEADERS:"server.request.headers.no_cookies",HTTP_INCOMING_URL:"server.request.uri.raw",HTTP_INCOMING_METHOD:"server.request.method",HTTP_INCOMING_PARAMS:"server.request.path_params",HTTP_INCOMING_COOKIES:"server.request.cookies",HTTP_INCOMING_RESPONSE_CODE:"server.response.status",HTTP_INCOMING_RESPONSE_HEADERS:"server.response.headers.no_cookies",HTTP_INCOMING_GRAPHQL_RESOLVERS:"graphql.server.all_resolvers",HTTP_INCOMING_GRAPHQL_RESOLVER:"graphql.server.resolver",HTTP_INCOMING_RESPONSE_BODY:"server.response.body",HTTP_CLIENT_IP:"http.client_ip",USER_ID:"usr.id",USER_LOGIN:"usr.login",WAF_CONTEXT_PROCESSOR:"waf.context.processor",HTTP_OUTGOING_URL:"server.io.net.url",FS_OPERATION_PATH:"server.io.fs.file",DB_STATEMENT:"server.db.statement",DB_SYSTEM:"server.db.system",EXEC_COMMAND:"server.sys.exec.cmd",SHELL_COMMAND:"server.sys.shell.cmd",LOGIN_SUCCESS:"server.business_logic.users.login.success",LOGIN_FAILURE:"server.business_logic.users.login.failure"}},4668:(e,t,r)=>{"use strict";const s=r(14022),n=r(5593),i=r(75004),{AUTO_REJECT:o,USER_REJECT:a}=r(1013);let c,u;class l{clear(){}set(e){}has(e){return!1}}function p(e){return u.has(e)}function d(e,t){const r=n.getContext(e)?.paths?.join("")||"",s=e.method,o=t.statusCode;return s&&o?s+r+o:(i.warn("[ASM] Unsupported groupkey for API security"),null)}function h(e){const t=e.context?.();return t._sampling?.priority}e.exports={configure:function({apiSecurity:e}){c=e.enabled,u=0===e.sampleDelay?new l:new s({max:4096,ttl:1e3*e.sampleDelay})},disable:function(){c=!1,u?.clear()},sampleRequest:function(e,t,r=!1){if(!c)return!1;const s=d(e,t);if(!s||p(s))return!1;const i=n.root(e);if(!i)return!1;let l=h(i);return l||(i._prioritySampler?.sample(i),l=h(i)),l!==o&&l!==a&&(r&&u.set(s),!0)},isSampled:p,computeKey:d}},8534:e=>{"use strict";e.exports={html:'<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>You\'ve been blocked</title><style>a,body,div,html,span{margin:0;padding:0;border:0;font-size:100%;font:inherit;vertical-align:baseline}body{background:-webkit-radial-gradient(26% 19%,circle,#fff,#f4f7f9);background:radial-gradient(circle at 26% 19%,#fff,#f4f7f9);display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-ms-flex-line-pack:center;align-content:center;width:100%;min-height:100vh;line-height:1;flex-direction:column}p{display:block}main{text-align:center;flex:1;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-ms-flex-line-pack:center;align-content:center;flex-direction:column}p{font-size:18px;line-height:normal;color:#646464;font-family:sans-serif;font-weight:400}a{color:#4842b7}footer{width:100%;text-align:center}footer p{font-size:16px}</style></head><body><main><p>Sorry, you cannot access this page. Please contact the customer service team.</p></main><footer><p>Security provided by <a href="https://www.datadoghq.com/product/security-platform/application-security-monitoring/" target="_blank">Datadog</a></p></footer></body></html>',json:'{"errors":[{"title":"You\'ve been blocked","detail":"Sorry, you cannot access this page. Please contact the customer service team. Security provided by Datadog."}]}',graphqlJson:'{"errors":[{"message":"You\'ve been blocked","extensions":{"detail":"Sorry, you cannot perform this operation. Please contact the customer service team. Security provided by Datadog."}}]}'}},92255:(e,t,r)=>{"use strict";const s=r(75004),n=r(8534),i={};let o,a=n.html,c=n.json,u=n.graphqlJson;const l=new WeakSet,p={GRAPHQL:"graphql"};function d(e,t){return`${e}+${t}`}function h(e,t,r){return r?.location?function(e){let t=e.status_code;return(!t||t<300||t>=400)&&(t=303),{headers:{Location:e.location},statusCode:t}}(r):function(e,t,r){let s,n;const o=t||i[d(e.method,e.url)];if(o){const e=function(e){if(e===p.GRAPHQL)return{type:"application/json",body:u}}(o);s=e?.type,n=e?.body}if(!s){const t=e.headers.accept?.split(",").map((e=>e.split(";",1)[0].trim()));r&&"auto"!==r.type?"html"===r.type?(s="text/html; charset=utf-8",n=a):(s="application/json",n=c):t?.includes("text/html")&&!t.includes("application/json")?(s="text/html; charset=utf-8",n=a):(s="application/json",n=c)}return{body:n,statusCode:r?.status_code||403,headers:{"Content-Type":s,"Content-Length":Buffer.byteLength(n)}}}(e,t,r)}e.exports={addSpecificEndpoint:function(e,t,r){i[d(e,t)]=r},block:function(e,t,r,n,i=o){if(t.headersSent)return void s.warn("[ASM] Cannot send blocking response when headers have already been sent");const{body:a,headers:c,statusCode:u}=h(e,null,i);r.addTags({"appsec.blocked":"true"});for(const e of t.getHeaderNames())t.removeHeader(e);t.writeHead(u,c),t.constructor.prototype.end.call(t,a),l.add(t),n?.abort()},specificBlockingTypes:p,getBlockingData:h,getBlockingAction:function(e){return e?.redirect_request||e?.block_request},setTemplates:function(e){a=e.appsec.blockedTemplateHtml?e.appsec.blockedTemplateHtml:n.html,c=e.appsec.blockedTemplateJson?e.appsec.blockedTemplateJson:n.json,u=e.appsec.blockedTemplateGraphql?e.appsec.blockedTemplateGraphql:n.graphqlJson},isBlocked:function(e){return l.has(e)},setDefaultBlockingActionParameters:function(e){const t=e?.find((e=>"block"===e.id));o=t?.parameters}}},69932:(e,t,r)=>{"use strict";const s=r(1247);e.exports={bodyParser:s.channel("datadog:body-parser:read:finish"),cookieParser:s.channel("datadog:cookie-parser:read:finish"),multerParser:s.channel("datadog:multer:read:finish"),startGraphqlResolve:s.channel("datadog:graphql:resolver:start"),graphqlMiddlewareChannel:s.tracingChannel("datadog:apollo:middleware"),apolloChannel:s.tracingChannel("datadog:apollo:request"),apolloServerCoreChannel:s.tracingChannel("datadog:apollo-server-core:request"),incomingHttpRequestStart:s.channel("dd-trace:incomingHttpRequestStart"),incomingHttpRequestEnd:s.channel("dd-trace:incomingHttpRequestEnd"),passportVerify:s.channel("datadog:passport:verify:finish"),passportUser:s.channel("datadog:passport:deserializeUser:finish"),queryParser:s.channel("datadog:query:read:finish"),setCookieChannel:s.channel("datadog:iast:set-cookie"),nextBodyParsed:s.channel("apm:next:body-parsed"),nextQueryParsed:s.channel("apm:next:query-parsed"),expressProcessParams:s.channel("datadog:express:process_params:start"),routerParam:s.channel("datadog:router:param:start"),responseBody:s.channel("datadog:express:response:json:start"),responseWriteHead:s.channel("apm:http:server:response:writeHead:start"),httpClientRequestStart:s.channel("apm:http:client:request:start"),responseSetHeader:s.channel("datadog:http:server:response:set-header:start"),setUncaughtExceptionCaptureCallbackStart:s.channel("datadog:process:setUncaughtExceptionCaptureCallback:start"),pgQueryStart:s.channel("apm:pg:query:start"),pgPoolQueryStart:s.channel("datadog:pg:pool:query:start"),mysql2OuterQueryStart:s.channel("datadog:mysql2:outerquery:start"),wafRunFinished:s.channel("datadog:waf:run:finish"),fsOperationStart:s.channel("apm:fs:operation:start"),expressMiddlewareError:s.channel("apm:express:middleware:error"),childProcessExecutionTracingChannel:s.tracingChannel("datadog:child_process:execution")}},67143:(e,t,r)=>{"use strict";const{storage:s}=r(96882),{addSpecificEndpoint:n,specificBlockingTypes:i,getBlockingData:o,getBlockingAction:a}=r(92255),c=r(41339),u=r(84250),l=r(5593),{startGraphqlResolve:p,graphqlMiddlewareChannel:d,apolloChannel:h,apolloServerCoreChannel:f}=r(69932),g=new WeakMap;function m({context:e,resolverInfo:t}){const r=s.getStore()?.req;if(!r)return;if(!t||"object"!=typeof t)return;const n=c.run({ephemeral:{[u.HTTP_INCOMING_GRAPHQL_RESOLVER]:t}},r),i=a(n);if(i){const t=g.get(r);t?.isInGraphqlRequest&&(t.blocked=!0,t.wafAction=i,e?.abortController?.abort())}}function _(e){const t=e?.req||s.getStore()?.req;t&&g.set(t,{inApolloMiddleware:!0,blocked:!1})}function y(){const e=s.getStore()?.req;e&&g.set(e,{isInGraphqlRequest:!0,blocked:!1})}function b(e){const t=e?.req||s.getStore()?.req,r=g.get(t);r&&(r.inApolloMiddleware=!1)}function v(){const e=s.getStore()?.req,t=g.get(e);t?.inApolloMiddleware&&(t.isInGraphqlRequest=!0,n(e.method,e.originalUrl||e.url,i.GRAPHQL))}function E({abortController:e,abortData:t}){const r=s.getStore()?.req;if(!r)return;const n=g.get(r);if(n?.blocked){const s=l.root(r);if(!s)return;const a=o(r,i.GRAPHQL,n.wafAction);t.statusCode=a.statusCode,t.headers=a.headers,t.message=a.body,s.setTag("appsec.blocked","true"),e?.abort()}g.delete(r)}e.exports={enable:function(){d.subscribe({start:_,end:b}),f.subscribe({start:y,asyncEnd:E}),h.subscribe({start:v,asyncEnd:E}),p.subscribe(m)},disable:function(){d.unsubscribe({start:_,end:b}),f.unsubscribe({start:y,asyncEnd:E}),h.unsubscribe({start:v,asyncEnd:E}),p.hasSubscribers&&p.unsubscribe(m)}}},28401:(e,t,r)=>{"use strict";e.exports={CODE_INJECTION_ANALYZER:r(11380),COMMAND_INJECTION_ANALYZER:r(65330),HARCODED_PASSWORD_ANALYZER:r(4821),HARCODED_SECRET_ANALYZER:r(46994),HEADER_INJECTION_ANALYZER:r(16668),HSTS_HEADER_MISSING_ANALYZER:r(9284),INSECURE_COOKIE_ANALYZER:r(7964),LDAP_ANALYZER:r(95796),NO_HTTPONLY_COOKIE_ANALYZER:r(97428),NO_SAMESITE_COOKIE_ANALYZER:r(74799),NOSQL_MONGODB_INJECTION:r(82915),PATH_TRAVERSAL_ANALYZER:r(33379),SQL_INJECTION_ANALYZER:r(1317),SSRF:r(37569),TEMPLATE_INJECTION_ANALYZER:r(67881),UNVALIDATED_REDIRECT_ANALYZER:r(11717),UNTRUSTED_DESERIALIZATION_ANALYZER:r(52907),WEAK_CIPHER_ANALYZER:r(52313),WEAK_HASH_ANALYZER:r(5324),WEAK_RANDOMNESS_ANALYZER:r(90520),XCONTENTTYPE_HEADER_MISSING_ANALYZER:r(77941)}},11380:(e,t,r)=>{"use strict";const s=r(42334),{CODE_INJECTION:n}=r(58720),{INSTRUMENTED_SINK:i}=r(86226),{storage:o}=r(96882),{getIastContext:a}=r(88283);e.exports=new class extends s{constructor(){super(n),this.evalInstrumentedInc=!1}onConfigure(){this.addSub("datadog:eval:call",(({script:e})=>{if(!this.evalInstrumentedInc){const e=o.getStore(),t=a(e),r=i.formatTags(n);for(const e of r)i.inc(t,e);this.evalInstrumentedInc=!0}this.analyze(e)})),this.addSub("datadog:vm:run-script:start",(({code:e})=>this.analyze(e))),this.addSub("datadog:vm:source-text-module:start",(({code:e})=>this.analyze(e)))}_areRangesVulnerable(){return!0}}},65330:(e,t,r)=>{"use strict";const s=r(42334),{COMMAND_INJECTION:n}=r(58720);e.exports=new class extends s{constructor(){super(n)}onConfigure(){this.addSub("tracing:datadog:child_process:execution:start",(({command:e})=>this.analyze(e)))}}},35689:(e,t,r)=>{"use strict";const s=r(33979),{getNodeModulesPaths:n}=r(11562),i=r(75004),o=n("express/lib/response.js");e.exports=class extends s{constructor(e,t){super(e),this.propertyToBeSafe=t.toLowerCase()}onConfigure(e){try{this.cookieFilterRegExp=new RegExp(e.iast.cookieFilterPattern)}catch{i.error("[ASM] Invalid regex in cookieFilterPattern"),this.cookieFilterRegExp=/.{32,}/}this.addSub({channelName:"datadog:iast:set-cookie",moduleName:"http"},(e=>this.analyze(e)))}_isVulnerable({cookieProperties:e,cookieValue:t}){return t&&!(e&&e.map((e=>e.toLowerCase().trim())).includes(this.propertyToBeSafe))}_getEvidence({cookieName:e}){return{value:e}}_createHashSource(e,t,r){return"string"==typeof t.value&&t.value.match(this.cookieFilterRegExp)?"FILTERED_"+this._type:`${e}:${t.value}`}_getExcludedPaths(){return o}_checkOCE(e,t){return!(!t||!t.location)||super._checkOCE(e,t)}_getLocation(e,t){if(!e)return super._getLocation(e,t);if(e.location)return e.location;const r=super._getLocation(e,t);return e.location=r,r}}},41761:(e,t,r)=>{"use strict";const s=r(33979),{getRelativePath:n}=r(11562);e.exports=class extends s{constructor(e,t=[],r=[]){super(e),this.allRules=t,this.valueOnlyRules=r}onConfigure(){this.addSub("datadog:secrets:result",(e=>{this.analyze(e)}))}analyze(e){if(!e?.file||!e.literals)return;const{allRules:t,valueOnlyRules:r}=this,s=[];for(const n of e.literals){const{value:e,locations:i}=n;if(e&&i)for(const n of i){let i;if(n.ident){const r=`${n.ident}=${e}`;i=t.find((e=>r.match(e.regex)))}else i=r.find((t=>e.match(t.regex)));i&&s.push({location:n,ruleId:i.id})}}if(s.length){const t=n(e.file);s.forEach((e=>this._report({file:t,line:e.location.line,column:e.location.column,ident:e.location.ident,data:e.ruleId})))}}_getEvidence(e){return{value:`${e.data}`}}_getLocation(e){return{path:e.file,line:e.line,column:e.column,isInternal:!1}}}},4821:(e,t,r)=>{"use strict";const{HARDCODED_PASSWORD:s}=r(58720),n=r(41761),i=r(7020);e.exports=new class extends n{constructor(){super(s,i)}_getEvidence(e){return{value:`${e.ident}`}}}},7020:(e,t,r)=>{"use strict";const{NameAndValue:s}=r(26574);e.exports=[{id:"hardcoded-password",regex:/(?:pwd|pswd|pass|secret)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([0-9a-z\-_.=]{10,150})(?:['"\s\x60;]|$)/i,type:s}]},26574:e=>{"use strict";e.exports={ValueOnly:"ValueOnly",NameAndValue:"NameAndValue"}},46994:(e,t,r)=>{"use strict";const{HARDCODED_SECRET:s}=r(58720),n=r(41761),{ValueOnly:i}=r(26574),o=r(5745);e.exports=new class extends n{constructor(){super(s,o,o.filter((e=>e.type===i)))}}},5745:(e,t,r)=>{"use strict";const{ValueOnly:s,NameAndValue:n}=r(26574);e.exports=[{id:"adafruit-api-key",regex:/(?:adafruit)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-z0-9_-]{32})(?:['"\s\x60;]|$)/i,type:n},{id:"adobe-client-id",regex:/(?:adobe)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-f0-9]{32})(?:['"\s\x60;]|$)/i,type:n},{id:"adobe-client-secret",regex:/\b((p8e-)[a-z0-9]{32})(?:['"\s\x60;]|$)/i,type:s},{id:"age-secret-key",regex:/AGE-SECRET-KEY-1[QPZRY9X8GF2TVDW0S3JN54KHCE6MUA7L]{58}/,type:s},{id:"airtable-api-key",regex:/(?:airtable)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-z0-9]{17})(?:['"\s\x60;]|$)/i,type:n},{id:"algolia-api-key",regex:/(?:algolia)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-z0-9]{32})(?:['"\s\x60;]|$)/i,type:n},{id:"alibaba-access-key-id",regex:/\b((LTAI)[a-z0-9]{20})(?:['"\s\x60;]|$)/i,type:s},{id:"asana-client-id",regex:/(?:asana)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([0-9]{16})(?:['"\s\x60;]|$)/i,type:n},{id:"asana-client-secret",regex:/(?:asana)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-z0-9]{32})(?:['"\s\x60;]|$)/i,type:n},{id:"atlassian-api-token",regex:/(?:atlassian|confluence|jira)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-z0-9]{24})(?:['"\s\x60;]|$)/i,type:n},{id:"authress-service-client-access-key",regex:/\b((?:sc|ext|scauth|authress)_[a-z0-9]{5,30}\.[a-z0-9]{4,6}\.acc[_-][a-z0-9-]{10,32}\.[a-z0-9+/_=-]{30,120})(?:['"\s\x60;]|$)/i,type:s},{id:"aws-access-token",regex:/\b((A3T[A-Z0-9]|AKIA|AGPA|AIDA|AROA|AIPA|ANPA|ANVA|ASIA)[A-Z0-9]{16})(?:['"\s\x60;]|$)/,type:s},{id:"beamer-api-token",regex:/(?:beamer)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}(b_[a-z0-9=_-]{44})(?:['"\s\x60;]|$)/i,type:n},{id:"bitbucket-client-id",regex:/(?:bitbucket)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-z0-9]{32})(?:['"\s\x60;]|$)/i,type:n},{id:"bitbucket-client-secret",regex:/(?:bitbucket)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-z0-9=_-]{64})(?:['"\s\x60;]|$)/i,type:n},{id:"bittrex-access-key",regex:/(?:bittrex)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-z0-9]{32})(?:['"\s\x60;]|$)/i,type:n},{id:"clojars-api-token",regex:/(CLOJARS_)[a-z0-9]{60}/i,type:s},{id:"codecov-access-token",regex:/(?:codecov)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-z0-9]{32})(?:['"\s\x60;]|$)/i,type:n},{id:"coinbase-access-token",regex:/(?:coinbase)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-z0-9_-]{64})(?:['"\s\x60;]|$)/i,type:n},{id:"confluent-access-token",regex:/(?:confluent)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-z0-9]{16})(?:['"\s\x60;]|$)/i,type:n},{id:"confluent-secret-key",regex:/(?:confluent)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-z0-9]{64})(?:['"\s\x60;]|$)/i,type:n},{id:"contentful-delivery-api-token",regex:/(?:contentful)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-z0-9=_-]{43})(?:['"\s\x60;]|$)/i,type:n},{id:"databricks-api-token",regex:/\b(dapi[a-h0-9]{32})(?:['"\s\x60;]|$)/i,type:s},{id:"datadog-access-token",regex:/(?:datadog)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-z0-9]{40})(?:['"\s\x60;]|$)/i,type:n},{id:"defined-networking-api-token",regex:/(?:dnkey)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}(dnkey-[a-z0-9=_-]{26}-[a-z0-9=_-]{52})(?:['"\s\x60;]|$)/i,type:n},{id:"digitalocean-access-token",regex:/\b(doo_v1_[a-f0-9]{64})(?:['"\s\x60;]|$)/i,type:s},{id:"digitalocean-pat",regex:/\b(dop_v1_[a-f0-9]{64})(?:['"\s\x60;]|$)/i,type:s},{id:"digitalocean-refresh-token",regex:/\b(dor_v1_[a-f0-9]{64})(?:['"\s\x60;]|$)/i,type:s},{id:"discord-api-token",regex:/(?:discord)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-f0-9]{64})(?:['"\s\x60;]|$)/i,type:n},{id:"discord-client-id",regex:/(?:discord)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([0-9]{18})(?:['"\s\x60;]|$)/i,type:n},{id:"discord-client-secret",regex:/(?:discord)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-z0-9=_-]{32})(?:['"\s\x60;]|$)/i,type:n},{id:"doppler-api-token",regex:/(dp\.pt\.)[a-z0-9]{43}/i,type:s},{id:"droneci-access-token",regex:/(?:droneci)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-z0-9]{32})(?:['"\s\x60;]|$)/i,type:n},{id:"dropbox-api-token",regex:/(?:dropbox)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-z0-9]{15})(?:['"\s\x60;]|$)/i,type:n},{id:"dropbox-long-lived-api-token",regex:/(?:dropbox)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-z0-9]{11}(AAAAAAAAAA)[a-z0-9\-_=]{43})(?:['"\s\x60;]|$)/i,type:n},{id:"dropbox-short-lived-api-token",regex:/(?:dropbox)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}(sl\.[a-z0-9\-=_]{135})(?:['"\s\x60;]|$)/i,type:n},{id:"duffel-api-token",regex:/duffel_(test|live)_[a-z0-9_\-=]{43}/i,type:s},{id:"dynatrace-api-token",regex:/dt0c01\.[a-z0-9]{24}\.[a-z0-9]{64}/i,type:s},{id:"easypost-api-token",regex:/\bEZAK[a-z0-9]{54}/i,type:s},{id:"etsy-access-token",regex:/(?:etsy)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-z0-9]{24})(?:['"\s\x60;]|$)/i,type:n},{id:"facebook",regex:/(?:facebook)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-f0-9]{32})(?:['"\s\x60;]|$)/i,type:n},{id:"fastly-api-token",regex:/(?:fastly)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-z0-9=_-]{32})(?:['"\s\x60;]|$)/i,type:n},{id:"finicity-api-token",regex:/(?:finicity)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-f0-9]{32})(?:['"\s\x60;]|$)/i,type:n},{id:"finicity-client-secret",regex:/(?:finicity)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-z0-9]{20})(?:['"\s\x60;]|$)/i,type:n},{id:"finnhub-access-token",regex:/(?:finnhub)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-z0-9]{20})(?:['"\s\x60;]|$)/i,type:n},{id:"flickr-access-token",regex:/(?:flickr)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-z0-9]{32})(?:['"\s\x60;]|$)/i,type:n},{id:"flutterwave-public-key",regex:/FLWPUBK_TEST-[a-h0-9]{32}-X/i,type:s},{id:"frameio-api-token",regex:/fio-u-[a-z0-9\-_=]{64}/i,type:s},{id:"freshbooks-access-token",regex:/(?:freshbooks)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-z0-9]{64})(?:['"\s\x60;]|$)/i,type:n},{id:"gcp-api-key",regex:/\b(AIza[0-9a-z\-_]{35})(?:['"\s\x60;]|$)/i,type:s},{id:"github-app-token",regex:/(ghu|ghs)_[0-9a-zA-Z]{36}/,type:s},{id:"github-fine-grained-pat",regex:/github_pat_[0-9a-zA-Z_]{82}/,type:s},{id:"github-oauth",regex:/gho_[0-9a-zA-Z]{36}/,type:s},{id:"github-pat",regex:/ghp_[0-9a-zA-Z]{36}/,type:s},{id:"gitlab-pat",regex:/glpat-[0-9a-zA-Z\-_]{20}/,type:s},{id:"gitlab-ptt",regex:/glptt-[0-9a-f]{40}/,type:s},{id:"gitlab-rrt",regex:/GR1348941[0-9a-zA-Z\-_]{20}/,type:s},{id:"gitter-access-token",regex:/(?:gitter)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-z0-9_-]{40})(?:['"\s\x60;]|$)/i,type:n},{id:"gocardless-api-token",regex:/(?:gocardless)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}(live_[a-z0-9\-_=]{40})(?:['"\s\x60;]|$)/i,type:n},{id:"grafana-api-key",regex:/\b(eyJrIjoi[a-z0-9]{70,400}={0,2})(?:['"\s\x60;]|$)/i,type:s},{id:"grafana-cloud-api-token",regex:/\b(glc_[a-z0-9+/]{32,400}={0,2})(?:['"\s\x60;]|$)/i,type:s},{id:"grafana-service-account-token",regex:/\b(glsa_[a-z0-9]{32}_[a-f0-9]{8})(?:['"\s\x60;]|$)/i,type:s},{id:"hashicorp-tf-api-token",regex:/[a-z0-9]{14}\.atlasv1\.[a-z0-9\-_=]{60,70}/i,type:s},{id:"heroku-api-key",regex:/(?:heroku)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})(?:['"\s\x60;]|$)/i,type:n},{id:"hubspot-api-key",regex:/(?:hubspot)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12})(?:['"\s\x60;]|$)/i,type:n},{id:"intercom-api-key",regex:/(?:intercom)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-z0-9=_-]{60})(?:['"\s\x60;]|$)/i,type:n},{id:"jfrog-api-key",regex:/(?:jfrog|artifactory|bintray|xray)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-z0-9]{73})(?:['"\s\x60;]|$)/i,type:n},{id:"jwt",regex:/\b(ey[a-zA-Z0-9]{17,}\.ey[a-zA-Z0-9/_-]{17,}\.(?:[a-zA-Z0-9/_-]{10,}={0,2})?)(?:['"\s\x60;]|$)/,type:s},{id:"kraken-access-token",regex:/(?:kraken)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-z0-9/=_+-]{80,90})(?:['"\s\x60;]|$)/i,type:n},{id:"kucoin-access-token",regex:/(?:kucoin)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-f0-9]{24})(?:['"\s\x60;]|$)/i,type:n},{id:"launchdarkly-access-token",regex:/(?:launchdarkly)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-z0-9=_-]{40})(?:['"\s\x60;]|$)/i,type:n},{id:"linear-api-key",regex:/lin_api_[a-z0-9]{40}/i,type:s},{id:"linkedin-client-secret",regex:/(?:linkedin|linked-in)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-z0-9]{16})(?:['"\s\x60;]|$)/i,type:n},{id:"lob-pub-api-key",regex:/(?:lob)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}((test|live)_pub_[a-f0-9]{31})(?:['"\s\x60;]|$)/i,type:n},{id:"mailchimp-api-key",regex:/(?:mailchimp)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-f0-9]{32}-us20)(?:['"\s\x60;]|$)/i,type:n},{id:"mailgun-private-api-token",regex:/(?:mailgun)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}(key-[a-f0-9]{32})(?:['"\s\x60;]|$)/i,type:n},{id:"mailgun-pub-key",regex:/(?:mailgun)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}(pubkey-[a-f0-9]{32})(?:['"\s\x60;]|$)/i,type:n},{id:"mailgun-signing-key",regex:/(?:mailgun)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-h0-9]{32}-[a-h0-9]{8}-[a-h0-9]{8})(?:['"\s\x60;]|$)/i,type:n},{id:"mapbox-api-token",regex:/(?:mapbox)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}(pk\.[a-z0-9]{60}\.[a-z0-9]{22})(?:['"\s\x60;]|$)/i,type:n},{id:"mattermost-access-token",regex:/(?:mattermost)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-z0-9]{26})(?:['"\s\x60;]|$)/i,type:n},{id:"messagebird-api-token",regex:/(?:messagebird|message-bird|message_bird)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-z0-9]{25})(?:['"\s\x60;]|$)/i,type:n},{id:"netlify-access-token",regex:/(?:netlify)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-z0-9=_-]{40,46})(?:['"\s\x60;]|$)/i,type:n},{id:"new-relic-browser-api-token",regex:/(?:new-relic|newrelic|new_relic)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}(NRJS-[a-f0-9]{19})(?:['"\s\x60;]|$)/i,type:n},{id:"new-relic-user-api-id",regex:/(?:new-relic|newrelic|new_relic)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-z0-9]{64})(?:['"\s\x60;]|$)/i,type:n},{id:"new-relic-user-api-key",regex:/(?:new-relic|newrelic|new_relic)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}(NRAK-[a-z0-9]{27})(?:['"\s\x60;]|$)/i,type:n},{id:"npm-access-token",regex:/\b(npm_[a-z0-9]{36})(?:['"\s\x60;]|$)/i,type:s},{id:"nytimes-access-token",regex:/(?:nytimes|new-york-times,|newyorktimes)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-z0-9=_-]{32})(?:['"\s\x60;]|$)/i,type:n},{id:"okta-access-token",regex:/(?:okta)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-z0-9=_-]{42})(?:['"\s\x60;]|$)/i,type:n},{id:"openai-api-key",regex:/\b(sk-[a-z0-9]{20}T3BlbkFJ[a-z0-9]{20})(?:['"\s\x60;]|$)/i,type:s},{id:"plaid-api-token",regex:/(?:plaid)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}(access-(?:sandbox|development|production)-[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})(?:['"\s\x60;]|$)/i,type:n},{id:"plaid-client-id",regex:/(?:plaid)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-z0-9]{24})(?:['"\s\x60;]|$)/i,type:n},{id:"plaid-secret-key",regex:/(?:plaid)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-z0-9]{30})(?:['"\s\x60;]|$)/i,type:n},{id:"planetscale-api-token",regex:/\b(pscale_tkn_[a-z0-9=\-_.]{32,64})(?:['"\s\x60;]|$)/i,type:s},{id:"planetscale-oauth-token",regex:/\b(pscale_oauth_[a-z0-9=\-_.]{32,64})(?:['"\s\x60;]|$)/i,type:s},{id:"planetscale-password",regex:/\b(pscale_pw_[a-z0-9=\-_.]{32,64})(?:['"\s\x60;]|$)/i,type:s},{id:"postman-api-token",regex:/\b(PMAK-[a-f0-9]{24}-[a-f0-9]{34})(?:['"\s\x60;]|$)/i,type:s},{id:"prefect-api-token",regex:/\b(pnu_[a-z0-9]{36})(?:['"\s\x60;]|$)/i,type:s},{id:"private-key",regex:/-----BEGIN[ A-Z0-9_-]{0,100}PRIVATE KEY( BLOCK)?-----[\s\S]*KEY( BLOCK)?----/i,type:s},{id:"pulumi-api-token",regex:/\b(pul-[a-f0-9]{40})(?:['"\s\x60;]|$)/i,type:s},{id:"pypi-upload-token",regex:/pypi-AgEIcHlwaS5vcmc[A-Za-z0-9\-_]{50,1000}/,type:s},{id:"rapidapi-access-token",regex:/(?:rapidapi)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-z0-9_-]{50})(?:['"\s\x60;]|$)/i,type:n},{id:"readme-api-token",regex:/\b(rdme_[a-z0-9]{70})(?:['"\s\x60;]|$)/i,type:s},{id:"rubygems-api-token",regex:/\b(rubygems_[a-f0-9]{48})(?:['"\s\x60;]|$)/i,type:s},{id:"scalingo-api-token",regex:/tk-us-[a-zA-Z0-9-_]{48}/,type:s},{id:"sendbird-access-id",regex:/(?:sendbird)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})(?:['"\s\x60;]|$)/i,type:n},{id:"sendbird-access-token",regex:/(?:sendbird)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-f0-9]{40})(?:['"\s\x60;]|$)/i,type:n},{id:"sendgrid-api-token",regex:/\b(SG\.[a-z0-9=_\-.]{66})(?:['"\s\x60;]|$)/i,type:s},{id:"sendinblue-api-token",regex:/\b(xkeysib-[a-f0-9]{64}-[a-z0-9]{16})(?:['"\s\x60;]|$)/i,type:s},{id:"sentry-access-token",regex:/(?:sentry)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-f0-9]{64})(?:['"\s\x60;]|$)/i,type:n},{id:"shippo-api-token",regex:/\b(shippo_(live|test)_[a-f0-9]{40})(?:['"\s\x60;]|$)/i,type:s},{id:"shopify-access-token",regex:/shpat_[a-fA-F0-9]{32}/,type:s},{id:"shopify-custom-access-token",regex:/shpca_[a-fA-F0-9]{32}/,type:s},{id:"shopify-private-app-access-token",regex:/shppa_[a-fA-F0-9]{32}/,type:s},{id:"shopify-shared-secret",regex:/shpss_[a-fA-F0-9]{32}/,type:s},{id:"sidekiq-secret",regex:/(?:BUNDLE_ENTERPRISE__CONTRIBSYS__COM|BUNDLE_GEMS__CONTRIBSYS__COM)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-f0-9]{8}:[a-f0-9]{8})(?:['"\s\x60;]|$)/i,type:n},{id:"slack-app-token",regex:/(xapp-\d-[A-Z0-9]+-\d+-[a-z0-9]+)/i,type:s},{id:"slack-bot-token",regex:/(xoxb-[0-9]{10,13}-[0-9]{10,13}[a-zA-Z0-9-]*)/,type:s},{id:"slack-config-access-token",regex:/(xoxe.xox[bp]-\d-[A-Z0-9]{163,166})/i,type:s},{id:"slack-config-refresh-token",regex:/(xoxe-\d-[A-Z0-9]{146})/i,type:s},{id:"slack-legacy-bot-token",regex:/(xoxb-[0-9]{8,14}-[a-zA-Z0-9]{18,26})/,type:s},{id:"slack-legacy-token",regex:/(xox[os]-\d+-\d+-\d+-[a-fA-F\d]+)/,type:s},{id:"slack-legacy-workspace-token",regex:/(xox[ar]-(?:\d-)?[0-9a-zA-Z]{8,48})/,type:s},{id:"slack-user-token",regex:/(xox[pe](?:-[0-9]{10,13}){3}-[a-zA-Z0-9-]{28,34})/,type:s},{id:"slack-webhook-url",regex:/(https?:\/\/)?hooks.slack.com\/(services|workflows)\/[A-Za-z0-9+/]{43,46}/,type:s},{id:"snyk-api-token",regex:/(?:snyk)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})(?:['"\s\x60;]|$)/i,type:n},{id:"square-access-token",regex:/\b(sq0atp-[0-9a-z\-_]{22})(?:['"\s\x60;]|$)/i,type:s},{id:"square-secret",regex:/\b(sq0csp-[0-9a-z\-_]{43})(?:['"\s\x60;]|$)/i,type:s},{id:"squarespace-access-token",regex:/(?:squarespace)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})(?:['"\s\x60;]|$)/i,type:n},{id:"stripe-access-token",regex:/(sk|pk)_(test|live)_[0-9a-z]{10,32}/i,type:s},{id:"sumologic-access-token",regex:/(?:sumo)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-z0-9]{64})(?:['"\s\x60;]|$)/i,type:n},{id:"telegram-bot-api-token",regex:/(?:^|[^0-9])([0-9]{5,16}:A[a-z0-9_-]{34})(?:$|[^a-z0-9_-])/i,type:s},{id:"travisci-access-token",regex:/(?:travis)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-z0-9]{22})(?:['"\s\x60;]|$)/i,type:n},{id:"trello-access-token",regex:/(?:trello)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-z-0-9]{32})(?:['"\s\x60;]|$)/i,type:n},{id:"twilio-api-key",regex:/SK[0-9a-fA-F]{32}/,type:s},{id:"twitch-api-token",regex:/(?:twitch)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-z0-9]{30})(?:['"\s\x60;]|$)/i,type:n},{id:"twitter-access-secret",regex:/(?:twitter)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-z0-9]{45})(?:['"\s\x60;]|$)/i,type:n},{id:"twitter-access-token",regex:/(?:twitter)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([0-9]{15,25}-[a-z0-9]{20,40})(?:['"\s\x60;]|$)/i,type:n},{id:"twitter-api-key",regex:/(?:twitter)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-z0-9]{25})(?:['"\s\x60;]|$)/i,type:n},{id:"twitter-api-secret",regex:/(?:twitter)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-z0-9]{50})(?:['"\s\x60;]|$)/i,type:n},{id:"twitter-bearer-token",regex:/(?:twitter)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}(A{22}[a-z0-9%]{80,100})(?:['"\s\x60;]|$)/i,type:n},{id:"typeform-api-token",regex:/(?:typeform)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}(tfp_[a-z0-9\-_.=]{59})(?:['"\s\x60;]|$)/i,type:n},{id:"vault-batch-token",regex:/\b(hvb\.[a-z0-9_-]{138,212})(?:['"\s\x60;]|$)/i,type:s},{id:"vault-service-token",regex:/\b(hvs\.[a-z0-9_-]{90,100})(?:['"\s\x60;]|$)/i,type:s},{id:"yandex-access-token",regex:/(?:yandex)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}(t1\.[A-Z0-9a-z_-]+[=]{0,2}\.[A-Z0-9a-z_-]{86}[=]{0,2})(?:['"\s\x60;]|$)/i,type:n},{id:"yandex-api-key",regex:/(?:yandex)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}(AQVN[a-z0-9_-]{35,38})(?:['"\s\x60;]|$)/i,type:n},{id:"yandex-aws-access-token",regex:/(?:yandex)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}(YC[a-z0-9_-]{38})(?:['"\s\x60;]|$)/i,type:n},{id:"zendesk-secret-key",regex:/(?:zendesk)(?:[0-9a-z\-_\t.]{0,20})(?:[\s|']|[\s|""]){0,3}(?:=|>|:{1,3}=|\|\|:|<=|=>|:|\?=)(?:'|""|\s|=|\x60){0,5}([a-z0-9]{40})(?:['"\s\x60;]|$)/i,type:n}]},16668:(e,t,r)=>{"use strict";const s=r(42334),{HEADER_INJECTION:n}=r(58720),{getNodeModulesPaths:i}=r(11562),{HEADER_NAME_VALUE_SEPARATOR:o}=r(52017),{getRanges:a}=r(53827),{HTTP_REQUEST_COOKIE_VALUE:c,HTTP_REQUEST_HEADER_VALUE:u}=r(98916),l=i("express"),p=["location","sec-websocket-location","sec-websocket-accept","upgrade","connection"];e.exports=new class extends s{constructor(){super(n)}onConfigure(){this.addSub("datadog:http:server:response:set-header:finish",(({name:e,value:t})=>{if(Array.isArray(t))for(let r=0;r<t.length;r++){const s=t[r];this.analyze({name:e,value:s})}else this.analyze({name:e,value:t})}))}_isVulnerable({name:e,value:t},r){const s=e?.trim().toLowerCase();if(this.isExcludedHeaderName(s)||"string"!=typeof t)return;const n=a(r,t);return n?.length>0&&!this.shouldIgnoreHeader(s,n)}_getEvidence(e,t){const r=e.name+o,s=r.length,n=super._getEvidence(e.value,t);return n.value=r+n.value,n.ranges=n.ranges.map((e=>({...e,start:e.start+s,end:e.end+s}))),n}isExcludedHeaderName(e){return p.includes(e)}isAllRangesFromHeader(e,t){return e.every((e=>e.iinfo.type===u&&e.iinfo.parameterName?.toLowerCase()===t))}isAllRangesFromSource(e,t){return e.every((e=>e.iinfo.type===t))}isAccessControlAllowExclusion(e,t){return!!e?.startsWith("access-control-allow-")&&this.isAllRangesFromSource(t,u)}isSameHeaderExclusion(e,t){return 1===t.length&&e===t[0].iinfo.parameterName?.toLowerCase()}shouldIgnoreHeader(e,t){switch(e){case"set-cookie":return this.isAllRangesFromSource(t,c);case"pragma":return this.isAllRangesFromHeader(t,"cache-control");case"transfer-encoding":case"content-encoding":return this.isAllRangesFromHeader(t,"accept-encoding")}return this.isAccessControlAllowExclusion(e,t)||this.isSameHeaderExclusion(e,t)}_getExcludedPaths(){return l}}},9284:(e,t,r)=>{"use strict";const{HSTS_HEADER_MISSING:s}=r(58720),{MissingHeaderAnalyzer:n}=r(59981),i="Strict-Transport-Security";e.exports=new class extends n{constructor(){super(s,i)}_isVulnerableFromRequestAndResponse(e,t){const r=this._getHeaderValues(t,i);return this._isHttpsProtocol(e)&&(0===r.length||r.some((e=>!this._isHeaderValid(e))))}_isHeaderValid(e){if(!e)return!1;if(!(e=e.trim()).startsWith("max-age"))return!1;const t=e.indexOf(";");let r;r=t>-1?e.substring(8,t):e.substring(8);const s=parseInt(r);return s==r&&s>0}_isHttpsProtocol(e){return"https"===e.protocol||"https"===e.headers["x-forwarded-proto"]}}},1622:(e,t,r)=>{"use strict";const s=r(28401),n=r(56666);e.exports={enableAllAnalyzers:function(e){n.configure({enabled:!0,tracerConfig:e});for(const t in s)s[t].configure({enabled:!0,tracerConfig:e})},disableAllAnalyzers:function(){n.configure(!1);for(const e in s)s[e].configure(!1)}}},42334:(e,t,r)=>{"use strict";const s=r(33979),{getRanges:n}=r(53827),{SQL_ROW_VALUE:i}=r(98916);e.exports=class extends s{_isVulnerable(e,t){const r=e&&n(t,e);return r?.length>0&&this._areRangesVulnerable(r)}_getEvidence(e,t){return{value:e,ranges:n(t,e)}}_areRangesVulnerable(e){return e?.some((e=>e.iinfo.type!==i))}}},7964:(e,t,r)=>{"use strict";const{INSECURE_COOKIE:s}=r(58720),n=r(35689);e.exports=new class extends n{constructor(){super(s,"secure")}}},95796:(e,t,r)=>{"use strict";const s=r(42334),{LDAP_INJECTION:n}=r(58720),{getNodeModulesPaths:i}=r(11562),o=i("ldapjs-promise");e.exports=new class extends s{constructor(){super(n)}onConfigure(){this.addSub("datadog:ldapjs:client:search",(({base:e,filter:t})=>this.analyzeAll(e,t)))}_getExcludedPaths(){return o}}},59981:(e,t,r)=>{"use strict";const s=r(33979),n=[301,302,304,307,404,410,500],i=["text/html","application/xhtml+xml"];e.exports={MissingHeaderAnalyzer:class extends s{constructor(e,t){super(e),this.headerName=t}onConfigure(){this.addSub({channelName:"datadog:iast:response-end",moduleName:"http"},(e=>this.analyze(e)))}_getHeaderValues(e,t){const r=e.getHeader(t);return Array.isArray(r)?r:r?[r.toString()]:[]}_getLocation(){}_checkOCE(e){return!0}_createHashSource(e,t,r){return`${e}:${this.config.tracerConfig.service}`}_getEvidence({res:e}){const t=this._getHeaderValues(e,this.headerName);let r;return 1===t.length?r=t[0]:t.length>0&&(r=JSON.stringify(t)),{value:r}}_isVulnerable({req:e,res:t},r){return!(n.includes(t.statusCode)||!this._isResponseHtml(t))&&this._isVulnerableFromRequestAndResponse(e,t)}_isVulnerableFromRequestAndResponse(e,t){return!1}_isResponseHtml(e){return this._getHeaderValues(e,"content-type").some((e=>e&&i.some((t=>t===e||e.startsWith(t+";")))))}}}},97428:(e,t,r)=>{"use strict";const{NO_HTTPONLY_COOKIE:s}=r(58720),n=r(35689);e.exports=new class extends n{constructor(){super(s,"HttpOnly")}}},74799:(e,t,r)=>{"use strict";const{NO_SAMESITE_COOKIE:s}=r(58720),n=r(35689);e.exports=new class extends n{constructor(){super(s,"SameSite=strict")}}},82915:(e,t,r)=>{"use strict";const s=r(42334),{NOSQL_MONGODB_INJECTION:n}=r(58720),{getRanges:i,addSecureMark:o}=r(53827),{getNodeModulesPaths:a}=r(11562),{getNextSecureMark:c}=r(75583),{storage:u}=r(96882),{getIastContext:l}=r(88283),{HTTP_REQUEST_PARAMETER:p,HTTP_REQUEST_BODY:d}=r(98916),h=a("mongodb","mongoose","mquery"),f=c();function g(e,t,r=[],s=20,n=new Set){null!==e&&"object"==typeof e&&Object.keys(e).forEach((i=>{const o=[...r,i],a=e[i];"string"==typeof a?t(a,o,e,i):s>0&&!n.has(a)&&(g(a,t,o,s-1,n),n.add(a))}))}e.exports=new class extends s{constructor(){super(n),this.sanitizedObjects=new WeakSet}onConfigure(){this.configureSanitizers();const e=({filters:e})=>{const t=u.getStore();return t&&!t.nosqlAnalyzed&&e?.length&&e.forEach((e=>{this.analyze({filter:e},t)})),t},t=t=>{const r=e(t||{});r&&u.enterWith({...r,nosqlAnalyzed:!0,nosqlParentStore:r})},r=()=>{const e=u.getStore();e?.nosqlParentStore&&u.enterWith(e.nosqlParentStore)};this.addSub("datadog:mongodb:collection:filter:start",e),this.addSub("datadog:mongoose:model:filter:start",t),this.addSub("datadog:mongoose:model:filter:finish",r),this.addSub("datadog:mquery:filter:prepare",e),this.addSub("tracing:datadog:mquery:filter:start",t),this.addSub("tracing:datadog:mquery:filter:asyncEnd",r)}configureSanitizers(){this.addNotSinkSub("datadog:express-mongo-sanitize:filter:finish",(({sanitizedProperties:e,req:t})=>{const r=u.getStore(),s=l(r);s&&e.forEach((e=>{g(t[e],(function(r,n){if("string"==typeof r){let i=t[e];const a=n.length;for(let e=0;e<a;e++){const t=n[e];e===a-1?i[t]=o(s,r,f):i=i[t]}}}))}))})),this.addNotSinkSub("datadog:express-mongo-sanitize:sanitize:finish",(({sanitizedObject:e})=>{const t=u.getStore(),r=l(t);r&&g(e,(function(e,t,s,n){try{s[n]=o(r,e,f)}catch{}}))})),this.addNotSinkSub("datadog:mongoose:sanitize-filter:finish",(({sanitizedObject:e})=>{this.sanitizedObjects.add(e)}))}_isVulnerableRange(e){const t=e?.iinfo?.type;return(t===p||t===d)&&(e.secureMarks&f)!==f}_isVulnerable(e,t){if(e?.filter&&t){let r=!1;if(this.sanitizedObjects.has(e.filter))return!1;const s={},n=[];return g(e.filter,((e,o)=>{const a=i(t,e);if(a?.length){const e=[];for(const t of a)this._isVulnerableRange(t)&&(r=!0,e.push(t));e.length>0&&(s[o.join(".")]=e,n.push(...e))}}),[],4),r&&(e.rangesToApply=s,e.ranges=n),r}return!1}_getEvidence(e,t){return{value:e.filter,rangesToApply:e.rangesToApply,ranges:e.ranges}}_getExcludedPaths(){return h}},e.exports.MONGODB_NOSQL_SECURE_MARK=f},33379:(e,t,r)=>{"use strict";const s=r(16928),n=r(42334),{getIastContext:i}=r(88283),{storage:o}=r(96882),{PATH_TRAVERSAL:a}=r(58720),c=["dir.close","close"];e.exports=new class extends n{constructor(){super(a),this.exclusionList=[s.join("node_modules","send")+s.sep],this.internalExclusionList=["node:fs","node:internal/fs","node:internal\\fs","fs.js","internal/fs","internal\\fs"]}onConfigure(){this.addSub("apm:fs:operation:start",(e=>{const t=o.getStore(),r=!t?.fs?.root;if(c.includes(e.operation)||r)return;const s=[];e.dest&&s.push(e.dest),e.existingPath&&s.push(e.existingPath),e.file&&s.push(e.file),e.newPath&&s.push(e.newPath),e.oldPath&&s.push(e.oldPath),e.path&&s.push(e.path),e.prefix&&s.push(e.prefix),e.src&&s.push(e.src),e.target&&s.push(e.target),this.analyze(s)}))}_isExcluded(e){let t=!0;return e&&e.path&&(t=e.isInternal?this.internalExclusionList.some((t=>e.path.includes(t))):this.exclusionList.some((t=>e.path.includes(t)))),t}analyze(e){const t=i(o.getStore());if(t&&e&&e.constructor===Array)for(const r of e)if(this._isVulnerable(r,t)&&this._checkOCE(t)){this._report(r,t);break}}}},56666:(e,t,r)=>{"use strict";const s=r(12583),{setCookieChannel:n}=r(69932);e.exports=new class extends s{constructor(){super(),this.cookiesInRequest=new WeakMap,this.addSub("datadog:http:server:response:set-header:finish",(({name:e,value:t,res:r})=>{if("set-cookie"===e.toLowerCase()){let e=t;"string"==typeof t&&(e=[t]);const s=this._getAlreadyCheckedCookiesInResponse(r);let i;e.forEach((e=>{if(!s.includes(e)){s.push(e);const t=this._parseCookie(e,i);n.publish(t),i=t.location}}))}}))}_parseCookie(e,t){const r=e.split(";"),s=r[0].split("=");return{cookieName:s[0],cookieValue:s.slice(1).join("="),cookieProperties:r.slice(1).map((e=>e.trim())),cookieString:e,location:t}}_getAlreadyCheckedCookiesInResponse(e){let t=this.cookiesInRequest.get(e);return t||(t=[],this.cookiesInRequest.set(e,t)),t}}},1317:(e,t,r)=>{"use strict";const s=r(42334),{SQL_INJECTION:n}=r(58720),{getRanges:i}=r(53827),{storage:o}=r(96882),{getNodeModulesPaths:a}=r(11562),c=a("mysql","mysql2","sequelize","pg-pool","knex");e.exports=new class extends s{constructor(){super(n)}onConfigure(){this.addSub("apm:mysql:query:start",(({sql:e})=>this.analyze(e,void 0,"MYSQL"))),this.addSub("apm:mysql2:query:start",(({sql:e})=>this.analyze(e,void 0,"MYSQL"))),this.addSub("apm:pg:query:start",(({query:e})=>this.analyze(e.text,void 0,"POSTGRES"))),this.addSub("datadog:sequelize:query:start",(({sql:e,dialect:t})=>this.getStoreAndAnalyze(e,t.toUpperCase()))),this.addSub("datadog:sequelize:query:finish",(()=>this.returnToParentStore())),this.addSub("datadog:pg:pool:query:start",(({query:e})=>this.getStoreAndAnalyze(e.text,"POSTGRES"))),this.addSub("datadog:pg:pool:query:finish",(()=>this.returnToParentStore())),this.addSub("datadog:mysql:pool:query:start",(({sql:e})=>this.getStoreAndAnalyze(e,"MYSQL"))),this.addSub("datadog:mysql:pool:query:finish",(()=>this.returnToParentStore())),this.addSub("datadog:knex:raw:start",(({sql:e,dialect:t})=>{const r=this.normalizeKnexDialect(t);this.getStoreAndAnalyze(e,r)})),this.addSub("datadog:knex:raw:finish",(()=>this.returnToParentStore()))}getStoreAndAnalyze(e,t){const r=o.getStore();r&&(this.analyze(e,r,t),o.enterWith({...r,sqlAnalyzed:!0,sqlParentStore:r}))}returnToParentStore(){const e=o.getStore();e&&e.sqlParentStore&&o.enterWith(e.sqlParentStore)}_getEvidence(e,t,r){return{value:e,ranges:i(t,e),dialect:r}}analyze(e,t,r){(t=t||o.getStore())&&t.sqlAnalyzed||super.analyze(e,t,r)}_getExcludedPaths(){return c}normalizeKnexDialect(e){return"postgresql"===e?"POSTGRES":"sqlite3"===e?"SQLITE":"string"==typeof e?e.toUpperCase():void 0}_areRangesVulnerable(){return!0}}},37569:(e,t,r)=>{"use strict";const s=r(42334),{SSRF:n}=r(58720);e.exports=new class extends s{constructor(){super(n)}onConfigure(){this.addSub("apm:http:client:request:start",(({args:e})=>{"string"==typeof e.originalUrl?this.analyze(e.originalUrl):e.options&&e.options.host&&this.analyze(e.options.host)})),this.addSub("apm:http2:client:connect:start",(({authority:e})=>{e&&"string"==typeof e&&this.analyze(e)}))}}},67881:(e,t,r)=>{"use strict";const s=r(42334),{TEMPLATE_INJECTION:n}=r(58720);e.exports=new class extends s{constructor(){super(n)}onConfigure(){this.addSub("datadog:handlebars:compile:start",(({source:e})=>this.analyze(e))),this.addSub("datadog:handlebars:register-partial:start",(({partial:e})=>this.analyze(e))),this.addSub("datadog:pug:compile:start",(({source:e})=>this.analyze(e)))}_areRangesVulnerable(){return!0}}},52907:(e,t,r)=>{"use strict";const s=r(42334),{UNTRUSTED_DESERIALIZATION:n}=r(58720);e.exports=new class extends s{constructor(){super(n)}onConfigure(){this.addSub("datadog:node-serialize:unserialize:start",(({obj:e})=>this.analyze(e)))}}},11717:(e,t,r)=>{"use strict";const s=r(42334),{UNVALIDATED_REDIRECT:n}=r(58720),{getNodeModulesPaths:i}=r(11562),{getRanges:o}=r(53827),{HTTP_REQUEST_HEADER_VALUE:a,HTTP_REQUEST_PATH_PARAM:c,HTTP_REQUEST_URI:u}=r(98916),l=i("express/lib/response.js");e.exports=new class extends s{constructor(){super(n)}onConfigure(){this.addSub("datadog:http:server:response:set-header:finish",(({name:e,value:t})=>this.analyze(e,t)))}analyze(e,t){this.isLocationHeader(e)&&"string"==typeof t&&super.analyze(t)}isLocationHeader(e){return e&&"location"===e.trim().toLowerCase()}_isVulnerable(e,t){if(!e)return!1;const r=o(t,e);return r&&r.length>0&&!this._areSafeRanges(r)}_areSafeRanges(e){return e&&e.every((e=>this._isPathParam(e)||this._isUrl(e)||this._isRefererHeader(e)))}_isRefererHeader(e){return e.iinfo.type===a&&e.iinfo.parameterName&&"referer"===e.iinfo.parameterName.toLowerCase()}_isPathParam(e){return e.iinfo.type===c}_isUrl(e){return e.iinfo.type===u}_getExcludedPaths(){return l}}},33979:(e,t,r)=>{"use strict";const{storage:s}=r(96882),{getNonDDCallSiteFrames:n}=r(11562),{getIastContext:i,getIastStackTraceId:o}=r(88283),a=r(84049),{SinkIastPlugin:c}=r(67397),{addVulnerability:u,getVulnerabilityCallSiteFrames:l,replaceCallSiteFromSourceMap:p}=r(95748);e.exports=class extends c{constructor(e){super(),this._type=e}_isVulnerable(e,t){return!1}_isExcluded(e){return!1}_report(e,t,r){const s=this._getEvidence(e,t,r);this._reportEvidence(e,t,s)}_reportEvidence(e,t,r){const s=l(),i=n(s,this._getExcludedPaths()),a=this._getLocation(e,i);if(!this._isExcluded(a)){const e=this._getOriginalLocation(a),s=t&&t.rootSpan&&t.rootSpan.context().toSpanId(),n=o(t),c=this._createVulnerability(this._type,r,s,e,n);u(t,c,i)}}_reportIfVulnerable(e,t,r){return!(!this._isVulnerable(e,t)||!this._checkOCE(t,e)||(this._report(e,t,r),0))}_getEvidence(e){return{value:e}}_getLocation(e,t){return t[0]}_getOriginalLocation(e){const t=p(e),r={};return t?.path&&(r.path=t.path),t?.line&&(r.line=t.line),t?.column&&(r.column=t.column),r}_getExcludedPaths(){}_isInvalidContext(e,t){return e&&!t}analyze(e,t=s.getStore(),r){const n=i(t);this._isInvalidContext(t,n)||this._reportIfVulnerable(e,n,r)}analyzeAll(...e){const t=s.getStore(),r=i(t);if(!this._isInvalidContext(t,r))for(let t=0;t<e.length;t++){const s=e[t];if(this._isVulnerable(s,r)){this._checkOCE(r,s)&&this._report(s,r);break}}}_checkOCE(e){return a.hasQuota(a.OPERATIONS.REPORT_VULNERABILITY,e)}_createVulnerability(e,t,r,s,n){return e&&t?{type:e,evidence:t,stackId:n,location:{spanId:r||0,...s},hash:this._createHash(this._createHashSource(e,t,s))}:null}_createHashSource(e,t,r){return r?`${e}:${r.path}:${r.line}`:e}_createHash(e){let t=0,r=0;const s=e.length;for(let n=0;n<s;n++)t=(t<<5)-t+e.charCodeAt(r++);return t}addSub(e,t){const r="string"==typeof e?{channelName:e}:e;super.addSub({tag:this._type,...r},t)}}},52313:(e,t,r)=>{"use strict";const s=r(33979),{WEAK_CIPHER:n}=r(58720),i=new Set(["des","des-cbc","des-cfb","des-cfb1","des-cfb8","des-ecb","des-ede","des-ede-cbc","des-ede-cfb","des-ede-ecb","des-ede-ofb","des-ede3","des-ede3-cbc","des-ede3-cfb","des-ede3-cfb1","des-ede3-cfb8","des-ede3-ecb","des-ede3-ofb","des-ofb","des3","des3-wrap","rc2","rc2-128","rc2-40","rc2-40-cbc","rc2-64","rc2-64-cbc","rc2-cbc","rc2-cfb","rc2-ecb","rc2-ofb","blowfish","rc4","rc4-40","rc4-hmac-md5"].map((e=>e.toLowerCase())));e.exports=new class extends s{constructor(){super(n)}onConfigure(){this.addSub("datadog:crypto:cipher:start",(({algorithm:e})=>this.analyze(e)))}_isVulnerable(e){return!(!e||"string"!=typeof e)&&i.has(e.toLowerCase())}}},5324:(e,t,r)=>{"use strict";const s=r(16928),{getNodeModulesPaths:n}=r(11562),i=r(33979),{WEAK_HASH:o}=r(58720),a=new Set(["md4","md4WithRSAEncryption","RSA-MD4","RSA-MD5","md5","md5-sha1","ssl3-md5","md5WithRSAEncryption","RSA-SHA1","RSA-SHA1-2","sha1","md5-sha1","sha1WithRSAEncryption","ssl3-sha1"].map((e=>e.toLowerCase()))),c=n("etag/index.js","@mikro-orm/core/utils/Utils.js","mongodb/lib/core/connection/connection.js","mysql2/lib/auth_41.js","pusher/lib/utils.js","redlock/dist/cjs","sqreen/lib/package-reader/index.js","ws/lib/websocket-server.js","google-gax/build/src/grpc.js","cookie-signature/index.js","express-session/index.js"),u=[s.join("node_modules","object-hash",s.sep),s.join("node_modules","aws-sdk","lib","util.js"),s.join("node_modules","keygrip",s.sep)];e.exports=new class extends i{constructor(){super(o)}onConfigure(){this.addSub("datadog:crypto:hashing:start",(({algorithm:e})=>this.analyze(e)))}_isVulnerable(e){return"string"==typeof e&&a.has(e.toLowerCase())}_isExcluded(e){return!!e&&c.some((t=>e.path.includes(t)))}_getExcludedPaths(){return u}}},90520:(e,t,r)=>{"use strict";const s=r(33979),{WEAK_RANDOMNESS:n}=r(58720);e.exports=new class extends s{constructor(){super(n)}onConfigure(){this.addSub("datadog:random:call",(({fn:e})=>this.analyze(e)))}_isVulnerable(e){return e===Math.random}}},77941:(e,t,r)=>{"use strict";const{XCONTENTTYPE_HEADER_MISSING:s}=r(58720),{MissingHeaderAnalyzer:n}=r(59981),i="X-Content-Type-Options";e.exports=new class extends n{constructor(){super(s,i)}_isVulnerableFromRequestAndResponse(e,t){const r=this._getHeaderValues(t,i);return 0===r.length||r.some((e=>"nosniff"!==e.trim().toLowerCase()))}}},9329:(e,t,r)=>{"use strict";const{storage:s}=r(96882),n=r(88283),i=r(84049),{IastPlugin:o}=r(67397),{IAST_ENABLED_TAG_KEY:a}=r(21201),{createTransaction:c,removeTransaction:u}=r(53827),l=r(95748),{TagKey:p}=r(86226);e.exports=class extends o{startCtxOn(e,t){super.addSub(e,(e=>this.startContext())),this._getAndRegisterSubscription({channelName:e,tag:t,tagKey:p.SOURCE_TYPE})}finishCtxOn(e){super.addSub(e,(e=>this.finishContext()))}getRootSpan(e){return e?.span}getTopContext(){return{}}newIastContext(e){return{rootSpan:e}}addIastEnabledTag(e,t){t?.addTags&&t.addTags({[a]:e?1:0})}startContext(){let e,t=!1;const r=s.getStore();if(r){const s=this.getTopContext(),o=this.getRootSpan(r);t=i.acquireRequest(o),t&&(e=n.saveIastContext(r,s,this.newIastContext(o)),c(o.context().toSpanId(),e),i.initializeRequestContext(e)),this.addIastEnabledTag(t,o)}return{isRequestAcquired:t,iastContext:e,store:r}}finishContext(){const e=s.getStore();if(e){const t=this.getTopContext(),r=n.getIastContext(e,t),s=r?.rootSpan;r&&s&&(l.sendVulnerabilities(r.vulnerabilities,s),u(r)),n.cleanIastContext(e,t,r)&&i.releaseRequest()}}}},24930:(e,t,r)=>{"use strict";const{KAFKA_MESSAGE_KEY:s,KAFKA_MESSAGE_VALUE:n}=r(98916),i=r(9329);e.exports=new class extends i{onConfigure(){this.startCtxOn("dd-trace:kafkajs:consumer:afterStart",[s,n]),this.finishCtxOn("dd-trace:kafkajs:consumer:beforeFinish")}}},88283:e=>{const t=Symbol("_dd.iast.context"),r=Symbol("_dd.iast.transactionId");e.exports={getIastContext:function(e,r){let s=e&&e[t];return s||(s=r&&r[t]),s},saveIastContext:function(e,r,s){if(e&&r)return e[t]=s,r[t]=s,e[t]},cleanIastContext:function(e,r,s){return e&&(s||(s=e[t]),e[t]=null),r&&(s||(s=r[t]),r[t]=null),!!s&&(Object.keys(s).forEach((e=>delete s[e])),!0)},getIastStackTraceId:function(e){return e?(e.stackTraceId||(e.stackTraceId=0),e.stackTraceId+=1,e.stackTraceId):0},IAST_CONTEXT_KEY:t,IAST_TRANSACTION_ID:r}},67397:(e,t,r)=>{"use strict";const{channel:s}=r(1247),n=r(12583),i=r(21194),{getInstrumentedMetric:o,getExecutedMetric:a,TagKey:c,EXECUTED_SOURCE:u,formatTags:l}=r(86226),{storage:p}=r(96882),{getIastContext:d}=r(88283),h=r(10502),f=r(75004);class g{constructor(e,t,r,s=c.VULNERABILITY_TYPE){this.moduleName=e,this.channelName=t,r=Array.isArray(r)?r:[r],this.tags=l(r,s),this.executedMetric=a(s),this.instrumentedMetric=o(s),this.moduleInstrumented=!1}increaseInstrumented(){this.moduleInstrumented||(this.moduleInstrumented=!0,this.tags.forEach((e=>this.instrumentedMetric.inc(void 0,e))))}increaseExecuted(e){this.tags.forEach((t=>this.executedMetric.inc(e,t)))}matchesModuleInstrumented(e){return e="https"===e?"http":e,this.moduleName===e}}class m extends n{constructor(){super(),this.configured=!1,this.pluginSubs=[]}_getTelemetryHandler(e){return()=>{const t=d(p.getStore());e.increaseExecuted(t)}}_execHandlerAndIncMetric({handler:e,metric:t,tags:r,iastContext:s=d(p.getStore())}){try{const n=e();return i.isEnabled()&&(Array.isArray(r)?r.forEach((e=>t.inc(s,e))):t.inc(s,r)),n}catch(e){f.error("[ASM] Error executing handler or increasing metrics",e)}}addSub(e,t){"string"==typeof e?super.addSub(e,t):(e=this._getAndRegisterSubscription(e))&&(super.addSub(e.channelName,t),i.isEnabled()&&super.addSub(e.channelName,this._getTelemetryHandler(e)))}enable(e){this.iastConfig=e,this.configure(!0)}disable(){this.configure(!1)}onConfigure(){}configure(e){"object"!=typeof e&&(e={enabled:e}),e.enabled&&!this.configured&&(this.onConfigure(e.tracerConfig),this.configured=!0),i.isEnabled()&&(e.enabled?this.enableTelemetry():this.disableTelemetry()),super.configure(e)}_getAndRegisterSubscription({moduleName:e,channelName:t,tag:r,tagKey:s}){if(!t&&!e)return;if(!e){let r=t.indexOf(":");if(-1===r)e=t;else{t.startsWith("tracing:")&&(r=t.indexOf(":",9));const s=t.indexOf(":",r+1);e=t.substring(r+1,-1!==s?s:t.length)}}const n=new g(e,t,r,s);return this.pluginSubs.push(n),n}enableTelemetry(){if(!this.onInstrumentationLoadedListener){this.onInstrumentationLoadedListener=({name:e})=>this._onInstrumentationLoaded(e),s("dd-trace:instrumentation:load").subscribe(this.onInstrumentationLoadedListener);for(const e in h)this._onInstrumentationLoaded(e)}}disableTelemetry(){if(!this.onInstrumentationLoadedListener)return;const e=s("dd-trace:instrumentation:load");e.hasSubscribers&&e.unsubscribe(this.onInstrumentationLoadedListener),this.onInstrumentationLoadedListener=null}_onInstrumentationLoaded(e){this.pluginSubs.filter((t=>t.matchesModuleInstrumented(e))).forEach((e=>e.increaseInstrumented()))}}e.exports={SourceIastPlugin:class extends m{addSub(e,t){return super.addSub({tagKey:c.SOURCE_TYPE,...e},t)}addInstrumentedSource(e,t){this._getAndRegisterSubscription({moduleName:e,tag:t,tagKey:c.SOURCE_TYPE})}execSource(e){this._execHandlerAndIncMetric({metric:u,...e})}},SinkIastPlugin:class extends m{addSub(e,t){return super.addSub({tagKey:c.VULNERABILITY_TYPE,...e},t)}addNotSinkSub(e,t){return super.addSub(e,t)}},IastPlugin:m}},31938:(e,t,r)=>{const s=r(95748),{enableAllAnalyzers:n,disableAllAnalyzers:i}=r(1622),o=r(5593),{storage:a}=r(96882),c=r(84049),u=r(1247),l=r(88283),{enableTaintTracking:p,disableTaintTracking:d,createTransaction:h,removeTransaction:f,taintTrackingPlugin:g}=r(38905),{IAST_ENABLED_TAG_KEY:m}=r(21201),_=r(21194),{enable:y,disable:b,IAST_MODULE:v}=r(24792),E=u.channel("dd-trace:incomingHttpRequestStart"),S=u.channel("dd-trace:incomingHttpRequestEnd"),T=u.channel("datadog:iast:response-end");let w=!1;function x(e){if(e?.req){const t=a.getStore();if(t){const r=o.getContext(e.req);if(r){const s=r.span,n=c.acquireRequest(s);if(n){const n=l.saveIastContext(t,r,{rootSpan:s,req:e.req});h(s.context().toSpanId(),n),c.initializeRequestContext(n),_.onRequestStart(n),g.taintRequest(e.req,n)}s.addTags&&s.addTags({[m]:n?1:0})}}}}function A(e){if(e?.req){const t=a.getStore(),r=o.getContext(e.req),n=l.getIastContext(t,r);if(n?.rootSpan){T.publish(e);const t=n.vulnerabilities,r=n.rootSpan;s.sendVulnerabilities(t,r),f(n),_.onRequestEnd(n,n.rootSpan)}l.cleanIastContext(t,r,n)&&c.releaseRequest()}}e.exports={enable:function(e,t){w||(_.configure(e,e.iast?.telemetryVerbosity),y(v),n(e),p(e.iast,_.verbosity),E.subscribe(x),S.subscribe(A),c.configure(e.iast),c.startGlobalContext(),s.start(e,t),w=!0)},disable:function(){w&&(w=!1,_.stop(),b(v),i(),d(),c.finishGlobalContext(),E.hasSubscribers&&E.unsubscribe(x),S.hasSubscribers&&S.unsubscribe(A),s.stop())},onIncomingHttpRequestEnd:A,onIncomingHttpRequestStart:x}},84049:e=>{"use strict";const t="oce",r="REPORT_VULNERABILITY",s={};let n,i={},o=0;const a={REPORT_VULNERABILITY:{hasQuota:e=>{const t=e&&e.tokens&&e.tokens[r]>0;return t&&e.tokens[r]--,t},name:r,initialTokenBucketSize:()=>"number"==typeof i.maxContextOperations?i.maxContextOperations:2,initContext:function(e){e.tokens[r]=this.initialTokenBucketSize()}}};function c(){const e={tokens:{}};for(const t in a)a[t].initContext(e);return e}function u(){Object.assign(s,c())}e.exports={OVERHEAD_CONTROLLER_CONTEXT_KEY:t,OPERATIONS:a,startGlobalContext:function(){n||(u(),n=setInterval((()=>{u()}),6e4),n.unref&&n.unref())},finishGlobalContext:function(){n&&(clearInterval(n),n=null)},_resetGlobalContext:u,initializeRequestContext:function(e){e&&(e[t]=c())},hasQuota:function(e,r){const n=function(e){return e&&e[t]?e[t]:s}(r);return e.hasQuota(n)},acquireRequest:function(e){if(o>0&&e){const t=i&&"number"==typeof i.requestSampling?i.requestSampling:30;if(e.context().toSpanId().slice(-2)<=t)return o--,!0}return!1},releaseRequest:function(){o<i.maxConcurrentRequests&&o++},configure:function(e){i=e,o=i.maxConcurrentRequests}}},11562:(e,t,r)=>{"use strict";const s=r(16928),n=r(932),{calculateDDBasePath:i}=r(89421),o={getNodeModulesPaths:function(...e){const t=[];return e.forEach((e=>{const r=e.split("/");t.push(s.join("node_modules",...r))})),t},getRelativePath:u,getNonDDCallSiteFrames:function(e,t){if(!e)return[];const r=[];for(const n of e){const e=n.file;l(n,t)||-1!==e.indexOf(o.ddBasePath)||(n.path=u(e),n.isInternal=!s.isAbsolute(e),r.push(n))}return r},calculateDDBasePath:i,ddBasePath:i(__dirname)},a=[s.join(s.sep,"node_modules","dc-polyfill")],c=["node:diagnostics_channel","diagnostics_channel","node:child_process","child_process","node:async_hooks","async_hooks"];function u(e){return s.relative(n.cwd(),e)}function l(e,t){if(e.isNative)return!0;const r=e.file;if(!r)return!0;let s=a;t&&(s=[...s,...t]);for(let e=0;e<s.length;e++)if(r.indexOf(s[e])>-1)return!0;for(let e=0;e<c.length;e++)if(0===r.indexOf(c[e]))return!0;return!1}e.exports=o},21201:e=>{"use strict";e.exports={IAST_ENABLED_TAG_KEY:"_dd.iast.enabled",IAST_JSON_TAG_KEY:"_dd.iast.json",IAST_TRACE_METRIC_PREFIX:"_dd.iast.telemetry"}},672:e=>{"use strict";e.exports={LOG_MESSAGE:"LOG",REWRITTEN_MESSAGE:"REWRITTEN"}},36971:e=>{"use strict";e.exports={csiMethods:[{src:"concat"},{src:"join"},{src:"parse"},{src:"plusOperator",operator:!0},{src:"random"},{src:"replace"},{src:"slice"},{src:"substr"},{src:"substring"},{src:"toLowerCase",dst:"stringCase"},{src:"toUpperCase",dst:"stringCase"},{src:"tplOperator",operator:!0},{src:"trim"},{src:"trimEnd"},{src:"trimStart",dst:"trim"},{src:"eval",allowedWithoutCallee:!0}]}},21467:e=>{"use strict";e.exports={isPrivateModule:function(e){return e&&-1===e.indexOf("node_modules")},isNotLibraryFile:function(e){return e&&-1===e.indexOf("dd-trace-js")&&-1===e.indexOf("dd-trace")}}},38905:(e,t,r)=>{"use strict";const{enableRewriter:s,disableRewriter:n}=r(24455),{createTransaction:i,removeTransaction:o,setMaxTransactions:a,enableTaintOperations:c,disableTaintOperations:u}=r(53827),l=r(10790),p=r(13360),d=r(24930);e.exports={enableTaintTracking(e,t){s(t),c(t),l.enable(e),d.enable(e),p.enable(e),a(e.maxConcurrentRequests)},disableTaintTracking(){n(),u(),l.disable(),d.disable(),p.disable()},setMaxTransactions:a,createTransaction:i,removeTransaction:o,taintTrackingPlugin:l}},17780:(e,t,r)=>{"use strict";const s=r(24760),{IAST_TRANSACTION_ID:n}=r(88283),i=r(75004);e.exports={taintObject:function(e,t,r){let o=t;const a=e?.[n];if(a){const e=[{parent:null,property:null,value:t}],n=new WeakSet;for(;e.length>0;){const{parent:t,property:c,value:u,key:l}=e.pop();if(null!==u)try{if("string"==typeof u){const e=s.newTaintedString(a,u,c,r);t?t[l]=e:o=e}else if("object"==typeof u&&!n.has(u)){n.add(u);for(const t of Object.keys(u))e.push({parent:u,property:c?`${c}.${t}`:t,value:u[t],key:t})}}catch(e){i.error("[ASM] Error in taintObject when visiting property : %s",c,e)}}}return o}}},53827:(e,t,r)=>{"use strict";const s=r(1247),n=r(24760),{IAST_TRANSACTION_ID:i}=r(88283),o=r(21194),{REQUEST_TAINTED:a}=r(86226),{isInfoAllowed:c}=r(57111),{getTaintTrackingImpl:u,getTaintTrackingNoop:l,lodashTaintTrackingHandler:p}=r(7990),{taintObject:d}=r(17780),h=s.channel("datadog:lodash:operation");let f=(e,t)=>{};function g(e,t){const r=n.getMetrics(e,o.verbosity);r?.requestCount&&a.inc(t,r.requestCount)}e.exports={addSecureMark:function(e,t,r){const s=e?.[i];return s?n.addSecureMarksToTaintedString(s,t,r):t},createTransaction:function(e,t){e&&t&&(t[i]=n.createTransaction(e))},removeTransaction:function(e){const t=e?.[i];t&&(f(t,e),n.removeTransaction(t),delete e[i])},newTaintedString:function(e,t,r,s){let o;const a=e?.[i];return o=a?n.newTaintedString(a,t,r,s):t,o},newTaintedObject:function(e,t,r,s){let o;const a=e?.[i];return o=a?n.newTaintedObject(a,t,r,s):t,o},taintObject:d,isTainted:function(e,t){let r;const s=e?.[i];return r=!!s&&n.isTainted(s,t),r},getRanges:function(e,t){let r;const s=e?.[i];return r=s?n.getRanges(s,t):[],r},enableTaintOperations:function(e){c(e)&&(f=g),global._ddiast=u(e),h.subscribe(p)},disableTaintOperations:function(){global._ddiast=l(),h.unsubscribe(p)},setMaxTransactions:function(e){e&&n.setMaxTransactions(e)},IAST_TRANSACTION_ID:i}},10790:(e,t,r)=>{"use strict";const{SourceIastPlugin:s}=r(67397),{getIastContext:n}=r(88283),{storage:i}=r(96882),{taintObject:o,newTaintedString:a,getRanges:c}=r(53827),{HTTP_REQUEST_BODY:u,HTTP_REQUEST_COOKIE_VALUE:l,HTTP_REQUEST_COOKIE_NAME:p,HTTP_REQUEST_HEADER_VALUE:d,HTTP_REQUEST_HEADER_NAME:h,HTTP_REQUEST_PARAMETER:f,HTTP_REQUEST_PATH_PARAM:g,HTTP_REQUEST_URI:m,SQL_ROW_VALUE:_}=r(98916),{EXECUTED_SOURCE:y}=r(86226),b=y.formatTags(d,h),v=y.formatTags(m);e.exports=new class extends s{constructor(){super(),this._type="taint-tracking",this._taintedURLs=new WeakMap}configure(e){super.configure(e);let t=this.iastConfig?.dbRowsToTaint;"number"!=typeof t&&(t=1),this._rowsToTaint=t}onConfigure(){const e=({req:e})=>{const t=n(i.getStore());t&&t.body!==e.body&&(this._taintTrackingHandler(u,e,"body",t),t.body=e.body)};this.addSub({channelName:"datadog:body-parser:read:finish",tag:u},e),this.addSub({channelName:"datadog:multer:read:finish",tag:u},e),this.addSub({channelName:"datadog:query:read:finish",tag:f},(({query:e})=>this._taintTrackingHandler(f,e))),this.addSub({channelName:"datadog:express:query:finish",tag:f},(({query:e})=>this._taintTrackingHandler(f,e))),this.addSub({channelName:"apm:express:middleware:next",tag:u},(({req:e})=>{if(e&&null!==e.body&&"object"==typeof e.body){const t=n(i.getStore());t&&t.body!==e.body&&(this._taintTrackingHandler(u,e,"body",t),t.body=e.body)}})),this.addSub({channelName:"datadog:cookie:parse:finish",tag:[l,p]},(({cookies:e})=>this._cookiesTaintTrackingHandler(e))),this.addSub({channelName:"datadog:sequelize:query:finish",tag:_},(({result:e})=>this._taintDatabaseResult(e,"sequelize"))),this.addSub({channelName:"apm:pg:query:finish",tag:_},(({result:e})=>this._taintDatabaseResult(e,"pg"))),this.addSub({channelName:"datadog:express:process_params:start",tag:g},(({req:e})=>{e&&null!==e.params&&"object"==typeof e.params&&this._taintTrackingHandler(g,e,"params")})),this.addSub({channelName:"datadog:router:param:start",tag:g},(({req:e})=>{e&&null!==e.params&&"object"==typeof e.params&&this._taintTrackingHandler(g,e,"params")})),this.addSub({channelName:"apm:graphql:resolve:start",tag:u},(e=>{const t=n(i.getStore()),r=e.context?.source,s=r&&c(t,r);s?.length&&this._taintTrackingHandler(s[0].iinfo.type,e.args,null,t)}));const t=["host","origin","hostname"];this.addSub({channelName:"datadog:url:parse:finish"},(({input:e,base:r,parsed:s,isURL:o})=>{const a=n(i.getStore());let u;u=c(a,r||e),u?.length&&(o?this._taintedURLs.set(s,u[0]):t.forEach((e=>{this._taintTrackingHandler(u[0].iinfo.type,s,e,a)})))})),this.addSub({channelName:"datadog:url:getter:finish"},(e=>{if(!t.includes(e.property))return;const r=this._taintedURLs.get(e.urlObject);if(!r)return;const s=n(i.getStore());s&&(e.result=a(s,e.result,r.iinfo.parameterName,r.iinfo.type))})),this.addInstrumentedSource("http",[d,h])}_taintTrackingHandler(e,t,r,s=n(i.getStore())){r?t[r]&&(t[r]=o(s,t[r],e)):o(s,t,e)}_cookiesTaintTrackingHandler(e){const t=n(i.getStore());o(t,e,l)}taintHeaders(e,t){this.execSource({handler:()=>o(t,e,d),tags:b,iastContext:t})}taintUrl(e,t){this.execSource({handler:function(){e.url=a(t,e.url,m,m)},tags:v,iastContext:t})}taintRequest(e,t){this.taintHeaders(e.headers,t),this.taintUrl(e,t)}_taintDatabaseResult(e,t,r=n(i.getStore()),s){if(!r)return e;if(0===this._rowsToTaint)return e;if(Array.isArray(e))for(let n=0;n<e.length&&n<this._rowsToTaint;n++){const i=s?`${s}.${n}`:""+n;e[n]=this._taintDatabaseResult(e[n],t,r,i)}else if(e&&"object"==typeof e)if("sequelize"===t&&e.dataValues)e.dataValues=this._taintDatabaseResult(e.dataValues,t,r,s);else for(const n in e){const i=s?`${s}.${n}`:n;e[n]=this._taintDatabaseResult(e[n],t,r,i)}else"string"==typeof e&&(e=a(r,e,s,_));return e}}},13360:(e,t,r)=>{"use strict";const s=r(81444),{storage:n}=r(96882),{getIastContext:i}=r(88283),{KAFKA_MESSAGE_KEY:o,KAFKA_MESSAGE_VALUE:a}=r(98916),{newTaintedObject:c,newTaintedString:u}=r(53827),{SourceIastPlugin:l}=r(67397);e.exports=new class extends l{onConfigure(){this.addSub({channelName:"dd-trace:kafkajs:consumer:afterStart",tag:[o,a]},(({message:e})=>this.taintKafkaMessage(e)))}getToStringWrap(e,t,r){return function(){const s=e.apply(this,arguments);return u(t,s,void 0,r)}}taintKafkaMessage(e){const t=i(n.getStore());if(t&&e){const{key:r,value:n}=e;null!==r&&"object"==typeof r&&(s.wrap(r,"toString",(e=>this.getToStringWrap(e,t,o))),c(t,r,void 0,o)),null!==n&&"object"==typeof n&&(s.wrap(n,"toString",(e=>this.getToStringWrap(e,t,a))),c(t,n,void 0,a))}}}},67157:(e,t,r)=>{"use strict";const s=r(21194),{Verbosity:n}=r(57111),{INSTRUMENTED_PROPAGATION:i}=r(86226),o={off:(e,t,r)=>r.rewrite(e,t),information(e,t,r){const s=this.off(e,t,r);return a(s.metrics),s}};function a(e){e?.instrumentedPropagation&&i.inc(void 0,e.instrumentedPropagation)}e.exports={getRewriteFunction:function(e){return s.verbosity===n.OFF?(t,r)=>o.off(t,r,e):(t,r)=>o.information(t,r,e)},incrementTelemetryIfNeeded:function(e){s.verbosity!==n.OFF&&a(e)}}},24455:(e,t,r)=>{"use strict";const s=r(73339),{pathToFileURL:n}=r(87016),{MessageChannel:i}=r(28167),o=r(81444),{isPrivateModule:a,isNotLibraryFile:c}=r(21467),{csiMethods:u}=r(36971),{getName:l}=r(57111),{getRewriteFunction:p,incrementTelemetryIfNeeded:d}=r(67157),h=r(1247),f=r(75004),{isMainThread:g}=r(28167),{LOG_MESSAGE:m,REWRITTEN_MESSAGE:_}=r(672),y=h.channel("datadog:secrets:result");let b,v,E,S,T,w=!1,x=function(e,t,r){return{path:e,line:t,column:r}};function A(e){return process.env.NODE_OPTIONS?.includes(e)||process.execArgv?.some((t=>t.includes(e)))}e.exports={enableRewriter:function(e){try{if(function(e){if(!b)try{const t=r(72539),s=t.Rewriter;v=t.getPrepareStackTrace,S=t.kSymbolPrepareStackTrace,E=t.cacheRewrittenSourceMap;const n=A("--enable-source-maps"),i=t.getOriginalPathAndLineFromSourceMap;i&&(x=function(e,t){return e?function(e,r,s){return a(e)&&c(e)?{path:e,line:r,column:s}:t(e,r,s)}:t}(n,i)),b=new s({csiMethods:u,telemetryVerbosity:l(e),chainSourceMap:n})}catch(e){f.error("[ASM] Unable to initialize TaintTracking Rewriter",e)}return b}(e)){const e=Object.getOwnPropertyDescriptor(global.Error,"prepareStackTrace");e&&!e.configurable||Object.defineProperty(global.Error,"prepareStackTrace",function(){T=Error.prepareStackTrace;let e=v(T);return{configurable:!0,get:()=>e,set(t){e=v(t),T=t}}}()),o.wrap(s.prototype,"_compile",(e=>function(e){const t=p(b);return function(r,s){try{if(a(s)&&c(s)){const n=t(r,s);if(n?.literalsResult&&y.hasSubscribers&&y.publish(n.literalsResult),n?.content)return e.apply(this,[n.content,s])}}catch(e){f.error("[ASM] Error rewriting file %s",s,e)}return e.apply(this,[r,s])}}(e)))}!function(e){if(g&&s.register&&!w&&(A("--loader")||A("--experimental-loader")||Object.keys(r.c).find((e=>e.includes("import-in-the-middle/hook.js"))))){w=!0;const{port1:t,port2:r}=new i;t.on("message",(e=>{const{type:t,data:r}=e;switch(t){case m:f[r.level]?.(...r.messages);break;case _:!function(e,t){const{literalsResult:r,metrics:s}=e;"modified"===s?.status&&(t.startsWith("file://")&&(t=t.substring(7)),E(t,e.content)),d(s),r&&y.hasSubscribers&&y.publish(r)}(r.rewritten,r.url)}})),t.unref(),r.unref();const o=A("--enable-source-maps"),a={port:r,csiMethods:u,telemetryVerbosity:e,chainSourceMap:o};try{s.register("./rewriter-esm.mjs",{parentURL:n(__filename),transferList:[r],data:a})}catch(e){f.error("[ASM] Error enabling ESM Rewriter",e),t.close(),r.close()}}}(e)}catch(e){f.error("[ASM] Error enabling TaintTracking Rewriter",e)}},disableRewriter:function(){if(o.unwrap(s.prototype,"_compile"),Error.prepareStackTrace?.[S])try{delete Error.prepareStackTrace,Error.prepareStackTrace=T}catch(e){f.warn("[ASM] Error disabling TaintTracking rewriter",e)}},getOriginalPathAndLineFromSourceMap:function({path:e,line:t,column:r}){return x(e,t,r)}}},75583:e=>{"use strict";let t=0;e.exports={getNextSecureMark:function(){return 1<<t++},reset:function(){t=0}}},98916:e=>{"use strict";e.exports={HTTP_REQUEST_BODY:"http.request.body",HTTP_REQUEST_COOKIE_VALUE:"http.request.cookie.value",HTTP_REQUEST_COOKIE_NAME:"http.request.cookie.name",HTTP_REQUEST_HEADER_NAME:"http.request.header.name",HTTP_REQUEST_HEADER_VALUE:"http.request.header",HTTP_REQUEST_PARAMETER:"http.request.parameter",HTTP_REQUEST_PATH:"http.request.path",HTTP_REQUEST_PATH_PARAM:"http.request.path.parameter",HTTP_REQUEST_URI:"http.request.uri",KAFKA_MESSAGE_KEY:"kafka.message.key",KAFKA_MESSAGE_VALUE:"kafka.message.value",SQL_ROW_VALUE:"sql.row.value"}},7990:(e,t,r)=>{"use strict";const s=r(1247),n=r(24760),{storage:i}=r(96882),o=r(88283),{EXECUTED_PROPAGATION:a}=r(86226),{isDebugAllowed:c}=r(57111),{taintObject:u}=r(17780),l=r(75004),p=s.channel("datadog:random:call"),d=s.channel("datadog:eval:call");function h(e){return e}const f={concat:h,eval:h,join:h,parse:h,plusOperator:h,random:h,replace:h,slice:h,substr:h,substring:h,stringCase:h,tplOperator:h,trim:h,trimEnd:h};function g(e){return e?.[o.IAST_TRANSACTION_ID]}function m(){const e=i.getStore();return o.getIastContext(e)}function _(){const e=m();return a.inc(e),e}function y(){return Array.prototype.some.call(arguments,(e=>"string"!=typeof e))}function b(e,t,...r){let s;if(r&&0!==r.length)if(1===r.length){const e=r[0];s=(t,r,s)=>y(t,s)||r!==e}else s=(e,t,s)=>y(e,s)||!function(e,t){return t.some((t=>e===t))}(t,r);else s=(e,t,r)=>y(e,r);return function(e,t,r){return function(s,n,i,...o){try{if(t(s,n,i))return s;const a=g(r());if(a)return e(a,s,i,...o)}catch(e){l.error("[ASM] Error invoking CSI %s",i,e)}return s}}(e,s,t)}function v(e,t,r){const s={};return e.forEach((e=>{-1===t.indexOf(e)&&(s[e]=b(((t,r,s,...i)=>n[e](t,r,s,...i)),r,String.prototype[e]))})),s}function E(e){const t=Object.keys(f),r=function(e){return{plusOperator:function(t,r,s){try{if(y(t)||y(r)&&y(s))return t;const i=g(e());if(i)return n.concat(i,t,r,s)}catch(e){l.error("[ASM] Error invoking CSI plusOperator",e)}return t},tplOperator:function(t,...r){try{const s=g(e());if(s)return n.concat(s,t,...r)}catch(e){l.error("[ASM] Error invoking CSI tplOperator",e)}return t},stringCase:b(((e,t,r)=>n.stringCase(e,t,r)),e,String.prototype.toLowerCase,String.prototype.toUpperCase),trim:b(((e,t,r)=>n.trim(e,t,r)),e,String.prototype.trim,String.prototype.trimStart),random:function(e,t){return p.hasSubscribers&&p.publish({fn:t}),e},eval:function(e,t,r,s){return d.hasSubscribers&&t===globalThis.eval&&d.publish({script:s}),e},parse:function(t,r,s,i){if(r===JSON.parse)try{const r=e(),s=g(r);if(s){const e=n.getRanges(s,i);if(e?.length>0){const s=e.find((e=>e.iinfo?.type));t=u(r,t,s?.iinfo.type||"json.value")}}}catch(e){l.error("[ASM] Error invoking CSI JSON.parse",e)}return t},join:function(t,r,s,i){if(r===Array.prototype.join)try{const r=g(e());r&&(t=n.arrayJoin(r,t,s,i))}catch(e){l.error("[ASM] Error invoking CSI join",e)}return t}}}(e);return{...v(t,Object.keys(r),e),...r}}function S(e,t=!1){return t?f:c(e)?E(_):E(m)}const T={join:n.arrayJoin,toLower:n.stringCase,toUpper:n.stringCase,trim:n.trim,trimEnd:n.trimEnd,trimStart:n.trim};e.exports={getTaintTrackingImpl:S,getTaintTrackingNoop:function(){return S(null,!0)},lodashTaintTrackingHandler:function(e){try{if(!e.result)return;const r=g(m());r&&(e.result=(t=e.operation,T[t]||((e,t)=>t))(r,e.result,...e.arguments))}catch(t){l.error("[ASM] Error invoking CSI lodash %s",e.operation,t)}var t}}},86226:(e,t,r)=>{"use strict";const{getNamespaceFromContext:s,globalNamespace:n}=r(5276),i="GLOBAL",o="REQUEST",a={VULNERABILITY_TYPE:"vulnerability_type",SOURCE_TYPE:"source_type",PROPAGATION_TYPE:"propagation_type"};function c(e,t){return e.map((e=>e?[`${t}:${e.toLowerCase()}`]:void 0))}function u(e,t){let r=n;return e===o&&(r=s(t)||n),r}class l{constructor(e,t,r){this.name=e,this.scope=t,this.tagKey=r}formatTags(...e){return c(e,this.tagKey)}inc(e,t,r=1){u(this.scope,e).count(this.name,t).inc(r)}}class p extends l{constructor(e,t){super(e,t),this.tags=[]}inc(e,t=1){u(this.scope,e).count(this.name,this.tags).inc(t)}}const d=new p("instrumented.propagation",i),h=new l("instrumented.source",i,a.SOURCE_TYPE),f=new l("instrumented.sink",i,a.VULNERABILITY_TYPE),g=new l("executed.source",o,a.SOURCE_TYPE),m=new l("executed.sink",o,a.VULNERABILITY_TYPE),_=new p("request.tainted",o),y=new p("executed.propagation",o),b=new p("executed.tainted",o);e.exports={INSTRUMENTED_PROPAGATION:d,INSTRUMENTED_SOURCE:h,INSTRUMENTED_SINK:f,EXECUTED_PROPAGATION:y,EXECUTED_SOURCE:g,EXECUTED_SINK:m,EXECUTED_TAINTED:b,REQUEST_TAINTED:_,PropagationType:{STRING:"STRING",JSON:"JSON",URL:"URL"},TagKey:a,IastMetric:l,NoTaggedIastMetric:p,getExecutedMetric:function(e){return e===a.VULNERABILITY_TYPE?m:g},getInstrumentedMetric:function(e){return e===a.VULNERABILITY_TYPE?f:h},formatTags:c}},21194:(e,t,r)=>{"use strict";const s=r(95608),{Verbosity:n,getVerbosity:i}=r(57111),{initRequestNamespace:o,finalizeRequestNamespace:a,globalNamespace:c}=r(5276);e.exports=new class{configure(e,t){const r=e?.telemetry?.enabled&&e.telemetry.metrics;this.verbosity=r?i(t):n.OFF,this.enabled=this.verbosity!==n.OFF,this.enabled&&s.manager.set("iast",c)}stop(){this.enabled=!1,s.manager.delete("iast")}isEnabled(){return this.enabled}onRequestStart(e){this.isEnabled()&&o(e)}onRequestEnd(e,t){this.isEnabled()&&a(e,t)}}},5276:(e,t,r)=>{"use strict";const s=r(75004),{Namespace:n}=r(95608),{addMetricsToSpan:i}=r(21380),{IAST_TRACE_METRIC_PREFIX:o}=r(21201),a=Symbol("_dd.iast.request.metrics.namespace");function c(e){return e?.[a]}class u extends n{constructor(e=100){super("iast"),this.maxMetricTagsSize=e,this.iastMetrics=new Map}getIastMetrics(e){let t=this.iastMetrics.get(e);return t||(t=new Map,this.iastMetrics.set(e,t)),t}getMetric(e,t,r="count"){const n=this.getIastMetrics(e);let i=n.get(t);return i||(i=super[r](e,Array.isArray(t)?[...t]:t),n.size===this.maxMetricTagsSize&&(n.clear(),s.error("[ASM] Tags cache max size reached for metric %s",e)),n.set(t,i)),i}count(e,t){return this.getMetric(e,t,"count")}clear(){this.iastMetrics.clear(),this.distributions.clear(),this.metrics.clear()}}const l=new u;e.exports={initRequestNamespace:function(e){if(!e)return;const t=new u;return e[a]=t,t},getNamespaceFromContext:c,finalizeRequestNamespace:function(e,t){try{const r=c(e);if(!r)return;i(t,[...r.metrics.values()],o),function(e){for(const[t,r]of e.iastMetrics)for(const[e,s]of r){const{type:r,points:n}=s;if(n?.length&&"count"===r){const r=l.getMetric(t,e);n.forEach((e=>r.inc(e[1])))}}}(r),r.clear()}catch(e){s.error("[ASM] Error merging request metrics",e)}finally{e&&delete e[a]}},globalNamespace:l,DD_IAST_METRICS_NAMESPACE:a,IastNamespace:u}},21380:e=>{"use strict";function t(e){return e?.filter((e=>!e.startsWith("version")))}e.exports={addMetricsToSpan:function(e,r,s){if(!e?.addTags||!r)return;const n=new Map;r.filter((e=>e?.metric)).forEach((e=>{const r=function(e){const r=e.metric,s=t(e.tags);return s?.length?`${r}.${function(e){return e.map((e=>e.includes(":")?e.split(":")[1]:e)).join("_").replace(/\./g,"_")}(s)}`:r}(e);let s=n.get(r);const i=function(e){const{points:t}=e;return t?t.map((e=>e[1])).reduce(((e,t)=>e+t),0):0}(e);s?s+=i:s=i,n.set(r,s)}));for(const[t,r]of n){const n=`${s}.${t}`;e.addTags({[n]:r})}},filterTags:t}},57111:e=>{"use strict";const t={OFF:0,MANDATORY:1,INFORMATION:2,DEBUG:3};e.exports={Verbosity:t,isDebugAllowed:function(e){return e>=t.DEBUG},isInfoAllowed:function(e){return e>=t.INFORMATION},getVerbosity:function(e){return e?(e=e.toUpperCase(),void 0!==t[e]?t[e]:t.INFORMATION):t.INFORMATION},getName:function(e){for(const r in t)if(t[r]===e)return r;return"OFF"}}},52017:e=>{"use strict";e.exports={HEADER_NAME_VALUE_SEPARATOR:": "}},73005:e=>{"use strict";function t(e,t){return!(e.start>t.start)&&e.end>=t.end}function r(e,t){return t.start<e.end&&t.end>e.start}e.exports={contains:t,intersects:r,remove:function(e,s){if(r(e,s)){if(t(s,e))return[];{const t=[];if(s.start>e.start){const r=s.start-e.start;t.push({start:e.start,end:e.start+r})}if(s.end<e.end){const r=e.end-s.end;t.push({start:s.end,end:s.end+r})}return t}}return[e]}}},73948:(e,t,r)=>{"use strict";const s=r(75004),n=new RegExp("^(?:\\s*(?:sudo|doas)\\s+)?\\b\\S+\\b\\s(.*)","gmi");e.exports=function(e){try{n.lastIndex=0;const t=n.exec(e.value);if(t&&t.length>1){const e=t.index+(t[0].length-t[1].length);return[{start:e,end:e+t[1].length}]}}catch(e){s.debug("[ASM] Error extracting sensitive ranges",e)}return[]}},81882:e=>{"use strict";e.exports=function(e,t){const{value:r}=e;return t.test(r)?[{start:0,end:r.length}]:[]}},50108:(e,t,r)=>{"use strict";const{HEADER_NAME_VALUE_SEPARATOR:s}=r(52017);e.exports=function(e,t,r){const n=e.value,i=n.split(s),o=i[0],a=i.slice(1).join(s);return t.lastIndex=0,r.lastIndex=0,t.test(o)||r.test(a)?[{start:o.length+s.length,end:n.length}]:[]}},57369:(e,t,r)=>{"use strict";const{stringifyWithRanges:s}=r(22981);e.exports=function(e){const{value:t,ranges:r,sensitiveRanges:n}=s(e.value,e.rangesToApply,!0);return e.value=t,e.ranges=r,n}},73996:(e,t,r)=>{"use strict";const s=r(75004),n=new RegExp("\\(.*?(?:~=|=|<=|>=)(?<LITERAL>[^)]+)\\)","gmi");e.exports=function(e){try{n.lastIndex=0;const t=[];let r=n.exec(e.value);for(;null!=r;){if(!r.groups.LITERAL)continue;const s=r.index+(r[0].length-r.groups.LITERAL.length-1),i=s+r.groups.LITERAL.length;t.push({start:s,end:i}),r=n.exec(e.value)}return t}catch(e){s.debug("[ASM] Error extracting sensitive ranges",e)}return[]}},73575:(e,t,r)=>{"use strict";const s=r(75004),n="'(?:''|[^'])*'",i="--.*$",o="/\\*[\\s\\S]*\\*/",a="(?:E[-+]?\\d+[fd]?)?",c=`[-+]?(?:${["x'[0-9a-f]+'|0x[0-9a-f]+","b'[0-9a-f]+'|0b[0-9a-f]+","\\d*\\.\\d+"+a,"(?<!\\w)\\d+"+a].join("|")})`,u={ANSI:new RegExp([c,n,i,o].join("|"),"gmi"),MYSQL:new RegExp([c,"\"(?:\\\\\"|[^\"])*\"|'(?:\\\\'|[^'])*'",i,o].join("|"),"gmi"),POSTGRES:new RegExp([c,"\\$([^$]*)\\$.*?\\$\\1\\$",n,i,o].join("|"),"gmi"),ORACLE:new RegExp([c,"q'<.*?>'|q'\\(.*?\\)'|q'\\{.*?\\}'|q'\\[.*?\\]'|q'(?<ESCAPE>.).*?\\k<ESCAPE>'",n,i,o].join("|"),"gmi")};u.SQLITE=u.MYSQL,u.MARIADB=u.MYSQL,e.exports=function(e){try{let t=u[e.dialect];t||(t=u.ANSI),t.lastIndex=0;const r=[];let s=t.exec(e.value);for(;null!=s;){let n=s.index,i=s.index+s[0].length;const o=e.value.charAt(n);if("'"===o||'"'===o)n++,i--;else if(i>n+1){const t=e.value.charAt(n+1);if("/"===o&&"*"===t)n+=2,i-=2;else if("-"===o&&o===t)n+=2;else if("q"===o.toLowerCase()&&"'"===t)n+=3,i-=2;else if("$"===o){const e=s[0].indexOf("$",1)+1;e>1&&(n+=e,i-=e)}}r.push({start:n,end:i}),s=t.exec(e.value)}return r}catch(e){s.debug("[ASM] Error extracting sensitive ranges",e)}return[]}},7810:e=>{"use strict";e.exports=function(e){const t=[];e.ranges[0].start>0&&t.push({start:0,end:e.ranges[0].start});for(let r=0;r<e.ranges.length;r++){const s=e.ranges[r],n=e.ranges[r+1],i=s.end,o=n?.start||e.value.length;i<o&&t.push({start:i,end:o})}return t}},11820:(e,t,r)=>{"use strict";const s=r(75004),n=new RegExp(["^(?:[^:]+:)?//([^@]+)@","[?#&]([^=&;]+)=([^?#&]+)"].join("|"),"gmi");e.exports=function(e){try{const t=[];let r=n.exec(e.value);for(;null!=r;){if("string"==typeof r[1]){const e=r.index+(r[0].length-1),s=e-r[1].length;t.push({start:s,end:e})}if("string"==typeof r[3]){const e=r.index+r[0].length,s=e-r[3].length;t.push({start:s,end:e})}r=n.exec(e.value)}return t}catch(e){s.debug("[ASM] Error extracting sensitive ranges",e)}return[]}},98333:(e,t,r)=>{"use strict";const s=r(75004),n=r(58720),{contains:i,intersects:o,remove:a}=r(73005),c=r(73948),u=r(81882),l=r(50108),p=r(57369),d=r(73996),h=r(73575),f=r(7810),g=r(11820),{DEFAULT_IAST_REDACTION_NAME_PATTERN:m,DEFAULT_IAST_REDACTION_VALUE_PATTERN:_}=r(95318),y="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";e.exports=new class{constructor(){this._namePattern=new RegExp(m,"gmi"),this._valuePattern=new RegExp(_,"gmi"),this._sensitiveAnalyzers=new Map,this._sensitiveAnalyzers.set(n.CODE_INJECTION,f),this._sensitiveAnalyzers.set(n.COMMAND_INJECTION,c),this._sensitiveAnalyzers.set(n.HARDCODED_PASSWORD,(e=>u(e,this._valuePattern))),this._sensitiveAnalyzers.set(n.HEADER_INJECTION,(e=>l(e,this._namePattern,this._valuePattern))),this._sensitiveAnalyzers.set(n.LDAP_INJECTION,d),this._sensitiveAnalyzers.set(n.NOSQL_MONGODB_INJECTION,p),this._sensitiveAnalyzers.set(n.SQL_INJECTION,h),this._sensitiveAnalyzers.set(n.SSRF,g),this._sensitiveAnalyzers.set(n.TEMPLATE_INJECTION,f),this._sensitiveAnalyzers.set(n.UNTRUSTED_DESERIALIZATION,f),this._sensitiveAnalyzers.set(n.UNVALIDATED_REDIRECT,g)}isSensibleName(e){return this._namePattern.lastIndex=0,this._namePattern.test(e)}isSensibleValue(e){return this._valuePattern.lastIndex=0,this._valuePattern.test(e)}isSensibleSource(e){return null!=e&&(this.isSensibleName(e.name)||this.isSensibleValue(e.value))}scrubEvidence(e,t,r,s){const n=this._sensitiveAnalyzers.get(e);if(n){const e=n(t);if(t.ranges||e?.length)return this.toRedactedJson(t,e,r,s)}return null}toRedactedJson(e,t,r,s){const n=[],c=[],u=[],{value:l,ranges:p}=e;let d,h=0,f=0,g=p?.shift(),m=t.shift();for(let e=0;e<l.length;e++)if(null!=g&&g.start===e){for(this.writeValuePart(n,l.substring(h,e),d),d=r[f];null!=m&&i(g,m);){const e=m.start-g.start,r=m.end-g.start;e===r?this.writeRedactedValuePart(n,0):this.redactSource(s,c,u,d,e,r),m=t.shift()}if(null!=m&&o(m,g)){const e=m.start-g.start,t=m.end-g.start;this.redactSource(s,c,u,d,e,t);const r=a(m,g);m=r.length>0?r[0]:null}if(this.isSensibleSource(s[d])&&(s[d].redacted||(c.push(d),s[d].pattern="".padEnd(s[d].value.length,y),s[d].redacted=!0)),c.indexOf(d)>-1){const t=l.substring(e,e+(g.end-g.start));this.writeRedactedValuePart(n,t.length,d,t,s[d],u[d],this.isSensibleSource(s[d])),u[d]=[]}else{const e=Math.min(g.end,l.length);this.writeValuePart(n,l.substring(g.start,e),d)}h=e+(g.end-g.start),e=h-1,g=p.shift(),f++,d=null}else if(null!=m&&m.start===e){if(this.writeValuePart(n,l.substring(h,e),d),null!=g&&o(m,g)){d=r[f];const n=m.start-g.start,i=m.end-g.start;this.redactSource(s,c,u,d,n,i);for(const r of a(m,g))r.start===e?m=r:t.unshift(r)}const i=m.end-m.start;this.writeRedactedValuePart(n,i),h=e+i,e=h-1,m=t.shift()}return h<l.length&&this.writeValuePart(n,l.substring(h)),{redactedValueParts:n,redactedSources:c}}redactSource(e,t,r,s,n,i){null!=s&&(e[s].redacted||(t.push(s),e[s].pattern="".padEnd(e[s].value.length,y),e[s].redacted=!0),r[s]||(r[s]=[]),r[s].push({start:n,end:i}))}writeValuePart(e,t,r){t.length>0&&(null!=r?e.push({value:t,source:r}):e.push({value:t}))}writeRedactedValuePart(e,t,r,s,n,i,o){if(null!=r){const a=n.value.includes(s)?n.pattern:"*".repeat(t);if(o)e.push({redacted:!0,source:r,pattern:a});else{let t=s;const o=[];i.forEach((e=>{o.some((t=>t.start===e.start&&t.end===e.end))||o.push(e)}));let c=0;o.forEach((s=>{s.start>0&&(e.push({source:r,value:t.substring(0,s.start-c)}),t=t.substring(s.start-c),c=s.start);const i=t.substring(s.start-c,s.end-c),o=n.value.indexOf(i),u=o>-1?a.substring(o,o+i.length):a.substring(s.start,s.end);e.push({redacted:!0,source:r,pattern:u}),t=t.substring(u.length),c+=u.length})),t.length&&e.push({source:r,value:t})}}else e.push({redacted:!0})}setRedactionPatterns(e,t){if(e)try{this._namePattern=new RegExp(e,"gmi")}catch(e){s.warn("[ASM] Redaction name pattern is not valid")}if(t)try{this._valuePattern=new RegExp(t,"gmi")}catch(e){s.warn("[ASM] Redaction value pattern is not valid")}}}},95318:e=>{e.exports={DEFAULT_IAST_REDACTION_NAME_PATTERN:"(?:p(?:ass)?w(?:or)?d|pass(?:_?phrase)?|secret|(?:api_?|private_?|public_?|access_?|secret_?)key(?:_?id)?|token|consumer_?(?:id|key|secret)|sign(?:ed|ature)?|auth(?:entication|orization)?|(?:sur|last)name|user(?:name)?|address|e?mail)",DEFAULT_IAST_REDACTION_VALUE_PATTERN:"(?:bearer\\s+[a-z0-9\\._\\-]+|glpat-[\\w\\-]{20}|gh[opsu]_[0-9a-zA-Z]{36}|ey[I-L][\\w=\\-]+\\.ey[I-L][\\w=\\-]+(?:\\.[\\w.+/=\\-]+)?|(?:[\\-]{5}BEGIN[a-z\\s]+PRIVATE\\sKEY[\\-]{5}[^\\-]+[\\-]{5}END[a-z\\s]+PRIVATE\\sKEY[\\-]{5}|ssh-rsa\\s*[a-z0-9/\\.+]{100,})|[\\w\\.-]+@[a-zA-Z\\d\\.-]+\\.[a-zA-Z]{2,})"}},32236:(e,t,r)=>{"use strict";const s=r(98333),{stringifyWithRanges:n}=r(22981);e.exports=new class{constructor(){this._redactVulnearbilities=!0}setRedactVulnerabilities(e,t,r){this._redactVulnearbilities=e,s.setRedactionPatterns(t,r)}extractSourcesFromVulnerability(e){return e.evidence.ranges?e.evidence.ranges.map((e=>({origin:e.iinfo.type,name:e.iinfo.parameterName,value:e.iinfo.parameterValue}))):[]}getRedactedValueParts(e,t,r,n){const i=s.scrubEvidence(e,t,r,n);if(i){const{redactedValueParts:e,redactedSources:t}=i;return t.forEach((e=>{delete n[e].value})),{valueParts:e}}return this.getUnredactedValueParts(t,r)}getUnredactedValueParts(e,t){const r=[];let s=0;if(null==e.value)return{valueParts:r};if("object"==typeof e.value&&e.rangesToApply){const{value:t,ranges:r}=n(e.value,e.rangesToApply);e.value=t,e.ranges=r}return e.ranges?(e.ranges.forEach(((n,i)=>{s<n.start&&r.push({value:e.value.substring(s,n.start)}),r.push({value:e.value.substring(n.start,n.end),source:t[i]}),s=n.end})),s<e.value.length&&r.push({value:e.value.substring(s)}),{valueParts:r}):{value:e.value}}formatEvidence(e,t,r,s){if(void 0!==t.value)return this._redactVulnearbilities?this.getRedactedValueParts(e,t,r,s):this.getUnredactedValueParts(t,r)}formatVulnerability(e,t,r){const s={type:e.type,hash:e.hash,stackId:e.stackId,evidence:this.formatEvidence(e.type,e.evidence,t,r),location:{spanId:e.location.spanId}};return e.location.path&&(s.location.path=e.location.path),e.location.line&&(s.location.line=e.location.line),s}toJson(e){const t=[],r=e.map((e=>{const r=this.extractSourcesFromVulnerability(e),s=[];return r.forEach((e=>{let r=t.findIndex((t=>t.origin===e.origin&&t.name===e.name&&t.value===e.value));-1===r&&(r=t.length,t.push(e)),s.push(r)})),this.formatVulnerability(e,s,t)}));return{sources:t,vulnerabilities:r}}}},22981:(e,t,r)=>{"use strict";const s=r(76982),{DEFAULT_IAST_REDACTION_VALUE_PATTERN:n}=r(95318),i="DD_"+s.randomBytes(20).toString("hex"),o=i+"SENSITIVE",a=o+"NOTSTRING",c=new RegExp(`(?:"(${i}_\\d+_))|(?:"(${o}_\\d+_(\\d+)_))|("${a}_\\d+_([\\s0-9.a-zA-Z]*)")`,"gm"),u=new RegExp(`"(${i}_\\d+_)`,"gm"),l=new RegExp(n,"gmi");function p(e,t,r=[],s=10,n=new Set){Object.keys(e).forEach((i=>{const o=[...r,i],a=e[i];"object"==typeof a&&n.has(a)||(n.add(a),t(a,o,e,i),null!==a&&"object"==typeof a&&s>0&&p(a,t,o,s-1,n))}))}e.exports={stringifyWithRanges:function(e,t,r=!1){let s;const n=[],d=[];if((t=t||{})||r){const h=Array.isArray(e)?[]:{};let f=0;const g={},m={};if(p(e,((e,s,n,c)=>{let u=h;for(let e=0;e<s.length-1;e++){let t=s[e];if(!u[t]){const e=m[t];u[e]&&(t=e)}u=u[t]}if(r){const e=m[c];if(e)c=e;else if(l.lastIndex=0,l.test(c)){const e=f++;c=`${o}_${e}_${c.length}_${c}`}}if("string"==typeof e){const n=t[s.join(".")];if(n){const t=f++,r=`${i}_${t}_`;g[r]=n,u[c]=`${r}${e}`}else u[c]=e;if(r){const t=f++,r=`${o}_${t}_${e.length}_`;u[c]=`${r}${u[c]}`}}else if("object"!=typeof e||null===e)if(r){const t=f++,r=`${a}_${t}_`;u[c]=r+e}else u[c]=e;else Array.isArray(e)?u[c]=[]:u[c]={}})),s=JSON.stringify(h,null,2),f>0){let e;e=r?c:u,e.lastIndex=0;let t=e.exec(s);for(;t;){const r=t.index+1;if(t[1]){const e=t[1];s=s.replace(e,"");const i=g[e].map((e=>({...e,start:e.start+r,end:e.end+r})));n.push(...i)}else if(t[2]){const e=t[2];d.push({start:r,end:r+parseInt(t[3])}),s=s.replace(e,"")}else if(t[4]){const e=t[4],r=t[5];d.push({start:t.index,end:t.index+r.length}),s=s.replace(e,r)}e.lastIndex=0,t=e.exec(s)}}}else s=JSON.stringify(e,null,2);return{value:s,ranges:n,sensitiveRanges:d}}}},58720:e=>{e.exports={COMMAND_INJECTION:"COMMAND_INJECTION",CODE_INJECTION:"CODE_INJECTION",HARDCODED_PASSWORD:"HARDCODED_PASSWORD",HARDCODED_SECRET:"HARDCODED_SECRET",HEADER_INJECTION:"HEADER_INJECTION",HSTS_HEADER_MISSING:"HSTS_HEADER_MISSING",INSECURE_COOKIE:"INSECURE_COOKIE",LDAP_INJECTION:"LDAP_INJECTION",NO_HTTPONLY_COOKIE:"NO_HTTPONLY_COOKIE",NO_SAMESITE_COOKIE:"NO_SAMESITE_COOKIE",NOSQL_MONGODB_INJECTION:"NOSQL_MONGODB_INJECTION",PATH_TRAVERSAL:"PATH_TRAVERSAL",SQL_INJECTION:"SQL_INJECTION",SSRF:"SSRF",TEMPLATE_INJECTION:"TEMPLATE_INJECTION",UNVALIDATED_REDIRECT:"UNVALIDATED_REDIRECT",UNTRUSTED_DESERIALIZATION:"UNTRUSTED_DESERIALIZATION",WEAK_CIPHER:"WEAK_CIPHER",WEAK_HASH:"WEAK_HASH",WEAK_RANDOMNESS:"WEAK_RANDOMNESS",XCONTENTTYPE_HEADER_MISSING:"XCONTENTTYPE_HEADER_MISSING"}},95748:(e,t,r)=>{"use strict";const s=r(28936),n=r(32236),{IAST_ENABLED_TAG_KEY:i,IAST_JSON_TAG_KEY:o}=r(21201),a=r(64431),{SAMPLING_MECHANISM_APPSEC:c}=r(23636),{keepTrace:u}=r(15134),{reportStackTrace:l,getCallsiteFrames:p,canReportStackTrace:d,STACK_TRACE_NAMESPACES:h}=r(57940),{getOriginalPathAndLineFromSourceMap:f}=r(24455),g="vulnerabilities",m=new s({max:1e3});let _,y,b,v,E=!0,S=!0;function T(e){return e&&e.type&&e.evidence&&e.location&&e.location.spanId}function w(e,t){if(e&&e.length&&t&&t.addTags){const r=e.filter(T),s=n.toJson(r);if(s.vulnerabilities.length>0){const e={};e[o]=JSON.stringify(s),t.addTags(e)}}return o}function x(){m.clear()}function A(e){if(e){const{path:t,line:r,column:s}=f(e);t&&(e.file=t,e.path=t),r&&(e.line=r),s&&(e.column=s)}return e}e.exports={addVulnerability:function(e,t,r){if(!function(e){if(!(e?.evidence&&e?.type&&e?.location))return!1;const t=E&&function(e){return m.get(`${e.type}${e.hash}`)}(e);return!t}(t))return;m.set(`${t.type}${t.hash}`,!0);let s=e?.rootSpan;if(!s&&_&&(s=_.startSpan("vulnerability",{type:"vulnerability"}),t.location.spanId=s.context().toSpanId(),s.addTags({[i]:1})),s){if(u(s,c),a.sample(s),S&&d(s,v,h.IAST)){const e=r.map((e=>A(e)));l(s,t.stackId,e,h.IAST)}e?.rootSpan?(e[g]=e[g]||[],e[g].push(t)):(w([t],s),s.finish())}},sendVulnerabilities:w,getVulnerabilityCallSiteFrames:function(){return p(b)},replaceCallSiteFromSourceMap:A,clearCache:x,start:function(e,t){E=e.iast.deduplicationEnabled,S=e.iast.stackTrace.enabled,b=e.appsec.stackTrace.maxDepth,v=e.appsec.stackTrace.maxStackTraces,n.setRedactVulnerabilities(e.iast.redactionEnabled,e.iast.redactionNamePattern,e.iast.redactionValuePattern),E&&(y=setInterval(x,36e5),y.unref()),_=t},stop:function(){y&&(clearInterval(y),y=null)}}},28302:(e,t,r)=>{"use strict";const s=r(75004),n=r(69538),i=r(52168),{bodyParser:o,cookieParser:a,multerParser:c,incomingHttpRequestStart:u,incomingHttpRequestEnd:l,passportVerify:p,passportUser:d,queryParser:h,nextBodyParsed:f,nextQueryParsed:g,expressProcessParams:m,responseBody:_,responseWriteHead:y,responseSetHeader:b,routerParam:v}=r(69932),E=r(41339),S=r(84250),T=r(27317),w=r(74893),x=r(4668),A=r(5593),{extractIp:I}=r(79449),{HTTP_CLIENT_IP:k}=r(74100),{isBlocked:O,block:R,setTemplates:C,getBlockingAction:N}=r(92255),P=r(96247),{storage:D}=r(96882),L=r(67143),M=r(42761),q=new WeakSet;let j,U=!1;function F({req:e,res:t,body:r,abortController:s}){if(null==r)return;if(!e){const t=D.getStore();e=t?.req}const n=A.root(e);n&&Z(E.run({persistent:{[S.HTTP_INCOMING_BODY]:r}},e),e,t,n,s)}function B({req:e,res:t,abortController:r,cookies:s}){if(!s||"object"!=typeof s)return;const n=A.root(e);n&&Z(E.run({persistent:{[S.HTTP_INCOMING_COOKIES]:s}},e),e,t,n,r)}function $({req:e,res:t,abortController:r}){const s=A.root(e);if(!s)return;const n=I(j,e);s.addTags({"_dd.appsec.enabled":1,"_dd.runtime_family":"nodejs",[k]:n});const i=Object.assign({},e.headers);delete i.cookie;const o={[S.HTTP_INCOMING_URL]:e.url,[S.HTTP_INCOMING_HEADERS]:i,[S.HTTP_INCOMING_METHOD]:e.method};n&&(o[S.HTTP_CLIENT_IP]=n),Z(E.run({persistent:o},e),e,t,s,r)}function G({req:e,res:t}){const r={};void 0!==e.body&&null!==e.body&&(r[S.HTTP_INCOMING_BODY]=e.body),null!==e.cookies&&"object"==typeof e.cookies&&(r[S.HTTP_INCOMING_COOKIES]=e.cookies);const s=e.query;null!==s&&"object"==typeof s&&(r[S.HTTP_INCOMING_QUERY]=s),x.sampleRequest(e,t,!0)&&(r[S.WAF_CONTEXT_PROCESSOR]={"extract-schema":!0}),Object.keys(r).length&&E.run({persistent:r},e),E.disposeContext(e),T.finishRequest(e,t)}function V({framework:e,login:t,user:r,success:n,abortController:i}){const o=D.getStore(),a=o?.req&&A.root(o.req);a?Z(P.trackLogin(e,t,r,n,a),o.req,o.req.res,a,i):s.warn("[ASM] No rootSpan found in onPassportVerify")}function z({user:e,abortController:t}){const r=D.getStore(),n=r?.req&&A.root(r.req);n?Z(P.trackUser(e,n),r.req,r.req.res,n,t):s.warn("[ASM] No rootSpan found in onPassportDeserializeUser")}function H({req:e,res:t,query:r,abortController:s}){if(!r||"object"!=typeof r)return;if(!e){const t=D.getStore();e=t?.req}const n=A.root(e);n&&Z(E.run({persistent:{[S.HTTP_INCOMING_QUERY]:r}},e),e,t,n,s)}function K({req:e,res:t,abortController:r,params:s}){const n=A.root(e);n&&s&&"object"==typeof s&&Object.keys(s).length&&Z(E.run({persistent:{[S.HTTP_INCOMING_PARAMS]:s}},e),e,t,n,r)}function Y({req:e,res:t,body:r}){r&&"object"==typeof r&&x.sampleRequest(e,t)&&E.run({persistent:{[S.HTTP_INCOMING_RESPONSE_BODY]:r}},e)}function Q({req:e,res:t,abortController:r,statusCode:s,responseHeaders:n}){if(O(t))return void r?.abort();if(q.has(t))return;const i=A.root(e);if(!i)return;delete(n=Object.assign({},n))["set-cookie"];const o=E.run({persistent:{[S.HTTP_INCOMING_RESPONSE_CODE]:""+s,[S.HTTP_INCOMING_RESPONSE_HEADERS]:n}},e);q.add(t),Z(o,e,t,i,r)}function W({res:e,abortController:t}){O(e)&&t?.abort()}function Z(e,t,r,s,n){if(!(e&&t&&r&&s&&n))return;const i=N(e);i&&R(t,r,s,n,i)}function J(){U=!1,j=null,n.clearAllRules(),w.disable(),L.disable(),M.disable(),i.disableWafUpdate(),x.disable(),o.hasSubscribers&&o.unsubscribe(F),c.hasSubscribers&&c.unsubscribe(F),a.hasSubscribers&&a.unsubscribe(B),u.hasSubscribers&&u.unsubscribe($),l.hasSubscribers&&l.unsubscribe(G),p.hasSubscribers&&p.unsubscribe(V),d.hasSubscribers&&d.unsubscribe(z),h.hasSubscribers&&h.unsubscribe(H),f.hasSubscribers&&f.unsubscribe(F),g.hasSubscribers&&g.unsubscribe(H),m.hasSubscribers&&m.unsubscribe(K),v.hasSubscribers&&v.unsubscribe(K),_.hasSubscribers&&_.unsubscribe(Y),y.hasSubscribers&&y.unsubscribe(Q),b.hasSubscribers&&b.unsubscribe(W)}e.exports={enable:function(e){if(!U)try{w.enable(e.telemetry),L.enable(),e.appsec.rasp.enabled&&M.enable(e),C(e),n.loadRules(e.appsec),i.enableWafUpdate(e.appsec),T.setRateLimit(e.appsec.rateLimit),x.configure(e.appsec),P.setCollectionMode(e.appsec.eventTracking.mode,!1),o.subscribe(F),c.subscribe(F),a.subscribe(B),u.subscribe($),l.subscribe(G),p.subscribe(V),d.subscribe(z),h.subscribe(H),f.subscribe(F),g.subscribe(H),m.subscribe(K),v.subscribe(K),_.subscribe(Y),y.subscribe(Q),b.subscribe(W),U=!0,j=e}catch(e){s.error("[ASM] Unable to start AppSec",e),J()}},disable:J,incomingHttpStartTranslator:$,incomingHttpEndTranslator:G}},19638:(e,t,r)=>{"use strict";const{childProcessExecutionTracingChannel:s}=r(69932),{RULE_TYPES:n,handleResult:i}=r(61124),{storage:o}=r(96882),a=r(84250),c=r(41339);let u;function l({file:e,fileArgs:t,shell:r,abortController:s}){if(!e)return;const l=o.getStore(),p=l?.req;if(!p)return;const d={},h={type:n.COMMAND_INJECTION},f=t?[e,...t]:e;if(r)d[a.SHELL_COMMAND]=f,h.variant="shell";else{const e=Array.isArray(f)?f:[f];d[a.EXEC_COMMAND]=e,h.variant="exec"}const g=c.run({persistent:d},p,h),m=l?.res;i(g,p,m,s,u)}e.exports={enable:function(e){u=e,s.subscribe({start:l})},disable:function(){s.start.hasSubscribers&&s.unsubscribe({start:l})}}},24792:(e,t,r)=>{"use strict";const s=r(12583),{storage:n}=r(96882),i=r(75004),o="rasp",a="iast",c={[o]:!1,[a]:!1};let u;function l(e,t=n.getStore()){t&&!t.fs?.opExcluded&&n.enterWith({...t,fs:{...t.fs,...e,parentStore:t}})}class p extends s{enable(){this.addSub("apm:fs:operation:start",this._onFsOperationStart),this.addSub("apm:fs:operation:finish",this._onFsOperationFinishOrRenderEnd),this.addSub("tracing:datadog:express:response:render:start",this._onResponseRenderStart),this.addSub("tracing:datadog:express:response:render:end",this._onFsOperationFinishOrRenderEnd),super.configure(!0)}disable(){super.configure(!1)}_onFsOperationStart(){const e=n.getStore();e&&l({root:void 0===e.fs?.root},e)}_onResponseRenderStart(){l({opExcluded:!0})}_onFsOperationFinishOrRenderEnd(){const e=n.getStore();e?.fs?.parentStore&&n.enterWith(e.fs.parentStore)}}e.exports={enable:function(e){!1===c[e]&&(c[e]=!0,u||(u=new p,u.enable()),i.info("[ASM] Enabled AppsecFsPlugin for %s",e))},disable:function(e){e&&c[e]&&(c[e]=!1,Object.values(c).every((e=>!1===e))&&(u?.disable(),u=void 0),i.info("[ASM] Disabled AppsecFsPlugin for %s",e))},AppsecFsPlugin:p,RASP_MODULE:o,IAST_MODULE:a}},42761:(e,t,r)=>{"use strict";const s=r(5593),{setUncaughtExceptionCaptureCallbackStart:n,expressMiddlewareError:i}=r(69932),{block:o,isBlocked:a}=r(92255),c=r(48639),u=r(18943),l=r(78084),p=r(19638),{DatadogRaspAbortError:d}=r(61124);function h(e,t=10){return e instanceof d?e:e?.cause&&t>0?h(e.cause,t-1):void 0}function f(e){if(g({error:e}))if(process.hasUncaughtExceptionCaptureCallback()){let e;const t=({currentCallback:r,abortController:s})=>{n.unsubscribe(t),r?e=r:s.abort()};n.subscribe(t),process.setUncaughtExceptionCaptureCallback(null),e&&process.setUncaughtExceptionCaptureCallback((()=>{process.setUncaughtExceptionCaptureCallback(null),process.setUncaughtExceptionCaptureCallback(e)}))}else{const e=function(e,t){const r=e.listeners(t);e.removeAllListeners(t);let s=!1;return function(){if(!0!==s){s=!0;for(let s=0;s<r.length;++s)e.on(t,r[s])}}}(process,"uncaughtException"),t=()=>{process.removeListener("uncaughtException",t)};setTimeout((()=>{process.removeListener("uncaughtException",t),e()})),process.on("uncaughtException",t)}}function g({error:e}){const t=h(e);if(!t)return!1;const{req:r,res:n,blockingAction:i}=t;return a(n)||o(r,n,s.root(r),null,i),!0}e.exports={enable:function(e){c.enable(e),u.enable(e),l.enable(e),p.enable(e),process.on("uncaughtExceptionMonitor",f),i.subscribe(g)},disable:function(){c.disable(),u.disable(),l.disable(),p.disable(),process.off("uncaughtExceptionMonitor",f),i.hasSubscribers&&i.unsubscribe(g)},handleUncaughtExceptionMonitor:f,blockOnDatadogRaspAbortError:g}},78084:(e,t,r)=>{"use strict";const{fsOperationStart:s,incomingHttpRequestStart:n}=r(69932),{storage:i}=r(96882),{enable:o,disable:a,RASP_MODULE:c}=r(24792),{FS_OPERATION_PATH:u}=r(84250),l=r(41339),{RULE_TYPES:p,handleResult:d}=r(61124),{isAbsolute:h}=r(16928);let f,g,m;function _(){process.nextTick((()=>{n.unsubscribe(_)})),o(c),m||(s.subscribe(y),m=!0)}function y(e){const t=i.getStore();if(!t)return;const{req:r,fs:s,res:n}=t;r&&s&&function(e,t){return[e.dest,e.existingPath,e.file,e.newPath,e.oldPath,e.path,e.prefix,e.src,e.target].map((e=>function(e){if(e)return"string"==typeof e||e instanceof String||e instanceof Buffer||e instanceof URL?e.toString():void 0}(e))).filter((e=>b(e,t)))}(e,s).forEach((t=>{const s={[u]:t},i={type:p.LFI},o=l.run({persistent:s},r,i);d(o,r,n,e.abortController,f)}))}function b(e,t){if(e)return!t.opExcluded&&t.root&&(h(e)||e.includes("../")||function(e,t){if(e.startsWith("file://"))return b(e.substring(7),t)}(e,t))}e.exports={enable:function(e){f=e,g||(g=!0,n.subscribe(_))},disable:function(){s.hasSubscribers&&s.unsubscribe(y),n.hasSubscribers&&n.unsubscribe(_),a(c),g=!1,m=!1}}},18943:(e,t,r)=>{"use strict";const{pgQueryStart:s,pgPoolQueryStart:n,wafRunFinished:i,mysql2OuterQueryStart:o}=r(69932),{storage:a}=r(96882),c=r(84250),u=r(41339),{RULE_TYPES:l,handleResult:p}=r(61124),d=new WeakMap;let h;function f(e){const t=e.sql;t&&m(t,"mysql",e.abortController)}function g(e){const t=e.query?.text;t&&m(t,"postgresql",e.abortController)}function m(e,t,r){const s=a.getStore();if(!s)return;const{req:n,res:i}=s;if(!n)return;let o=d.get(n);if(o?.has(e))return;o||(o=new Set,d.set(n,o)),o.add(e);const f={[c.DB_STATEMENT]:e,[c.DB_SYSTEM]:t},g={type:l.SQL_INJECTION},m=u.run({persistent:f},n,g);p(m,n,i,r,h)}function _(e){return e&&Object.keys(e).some((e=>e.startsWith("server.request")||e.startsWith("graphql.server")))}function y({payload:e}){if(!e)return;const t=a.getStore();if(!t)return;const{req:r}=t;if(!r)return;const s=d.get(r);s&&function(e){return _(e.ephemeral)||_(e.persistent)}(e)&&s.clear()}e.exports={enable:function(e){h=e,s.subscribe(g),n.subscribe(g),i.subscribe(y),o.subscribe(f)},disable:function(){s.hasSubscribers&&s.unsubscribe(g),n.hasSubscribers&&n.unsubscribe(g),i.hasSubscribers&&i.unsubscribe(y),o.hasSubscribers&&o.unsubscribe(f)}}},48639:(e,t,r)=>{"use strict";const{format:s}=r(87016),{httpClientRequestStart:n}=r(69932),{storage:i}=r(96882),o=r(84250),a=r(41339),{RULE_TYPES:c,handleResult:u}=r(61124);let l;function p(e){const t=i.getStore(),r=t?.req,n=(e.args.options?.uri&&s(e.args.options.uri))??e.args.uri;if(!r||!n)return;const p={[o.HTTP_OUTGOING_URL]:n},d={type:c.SSRF},h=a.run({persistent:p},r,d),f=t?.res;u(h,r,f,e.abortController,l)}e.exports={enable:function(e){l=e,n.subscribe(p)},disable:function(){n.hasSubscribers&&n.unsubscribe(p)}}},61124:(e,t,r)=>{"use strict";const s=r(5593),{getCallsiteFrames:n,reportStackTrace:i,canReportStackTrace:o}=r(57940),{getBlockingAction:a}=r(92255),c=r(75004),u=process.execArgv?.includes("--abort-on-uncaught-exception");u&&c.warn("[ASM] The --abort-on-uncaught-exception flag is enabled. The RASP module will not block operations.");class l extends Error{constructor(e,t,r){super("DatadogRaspAbortError"),this.name="DatadogRaspAbortError",this.req=e,this.res=t,this.blockingAction=r}}e.exports={handleResult:function(e,t,r,c,p){const d=e?.generate_stack,{enabled:h,maxDepth:f,maxStackTraces:g}=p.appsec.stackTrace,m=s.root(t);if(d&&h&&o(m,g)){const e=n(f);i(m,d.stack_id,e)}if(!c||u)return;const _=a(e);if(_){const e=s.root(t);if("express.request"===e?.context()._name){const e=new l(t,r,_);c.abort(e),c.signal.reason||(c.signal.reason=e)}}},RULE_TYPES:{COMMAND_INJECTION:"command_injection",LFI:"lfi",SQL_INJECTION:"sql_injection",SSRF:"ssrf"},DatadogRaspAbortError:l}},15265:e=>{"use strict";e.exports={UNACKNOWLEDGED:1,ACKNOWLEDGED:2,ERROR:3}},69532:e=>{"use strict";e.exports={ASM_ACTIVATION:2n,ASM_IP_BLOCKING:4n,ASM_DD_RULES:8n,ASM_EXCLUSIONS:16n,ASM_REQUEST_BLOCKING:32n,ASM_RESPONSE_BLOCKING:64n,ASM_USER_BLOCKING:128n,ASM_CUSTOM_RULES:256n,ASM_CUSTOM_BLOCKING_RESPONSE:512n,ASM_TRUSTED_IPS:1024n,ASM_API_SECURITY_SAMPLE_RATE:2048n,APM_TRACING_SAMPLE_RATE:4096n,APM_TRACING_LOGS_INJECTION:8192n,APM_TRACING_HTTP_HEADER_TAGS:16384n,APM_TRACING_CUSTOM_TAGS:32768n,APM_TRACING_ENABLED:1n<<19n,ASM_RASP_SQLI:1n<<21n,ASM_RASP_LFI:1n<<22n,ASM_RASP_SSRF:1n<<23n,ASM_RASP_SHI:1n<<24n,APM_TRACING_SAMPLE_RULES:1n<<29n,ASM_AUTO_USER_INSTRUM_MODE:1n<<31n,ASM_ENDPOINT_FINGERPRINT:1n<<32n,ASM_NETWORK_FINGERPRINT:1n<<34n,ASM_HEADER_FINGERPRINT:1n<<35n,ASM_RASP_CMDI:1n<<37n}},52168:(e,t,r)=>{"use strict";const s=r(14332),n=r(71427),i=r(69532),{setCollectionMode:o}=r(96247),a=r(75004);let c;function u(){}e.exports={enable:function(e,t){c=new n(e),c.updateCapabilities(i.APM_TRACING_CUSTOM_TAGS,!0),c.updateCapabilities(i.APM_TRACING_HTTP_HEADER_TAGS,!0),c.updateCapabilities(i.APM_TRACING_LOGS_INJECTION,!0),c.updateCapabilities(i.APM_TRACING_SAMPLE_RATE,!0),c.updateCapabilities(i.APM_TRACING_ENABLED,!0),c.updateCapabilities(i.APM_TRACING_SAMPLE_RULES,!0);const r=s.fromConfig(e);if(r!==s.DISABLED){let n;r===s.ONECLICK&&c.updateCapabilities(i.ASM_ACTIVATION,!0),c.updateCapabilities(i.ASM_AUTO_USER_INSTRUM_MODE,!0),c.setProductHandler("ASM_FEATURES",((i,c,u)=>{if(c){if("string"==typeof c.auto_user_instrum?.mode)if("apply"===i||"modify"===i){if(n&&u!==n)throw a.error("[RC] Multiple auto_user_instrum received in ASM_FEATURES. Discarding config"),"Multiple auto_user_instrum.mode received in ASM_FEATURES";o(c.auto_user_instrum.mode),n=u}else u===n&&(o(e.appsec.eventTracking.mode),n=null);r===s.ONECLICK&&function(e,t,r,s){if("boolean"==typeof t.asm?.enabled){let n;n="apply"===e||"modify"===e?t.asm.enabled:r.appsec.enabled,n?s.enable(r):s.disable()}}(i,c,e,t)}}))}return c},enableWafUpdate:function(e){if(c&&e&&!e.rules){const t=r(69538);c.updateCapabilities(i.ASM_IP_BLOCKING,!0),c.updateCapabilities(i.ASM_USER_BLOCKING,!0),c.updateCapabilities(i.ASM_DD_RULES,!0),c.updateCapabilities(i.ASM_EXCLUSIONS,!0),c.updateCapabilities(i.ASM_REQUEST_BLOCKING,!0),c.updateCapabilities(i.ASM_RESPONSE_BLOCKING,!0),c.updateCapabilities(i.ASM_CUSTOM_RULES,!0),c.updateCapabilities(i.ASM_CUSTOM_BLOCKING_RESPONSE,!0),c.updateCapabilities(i.ASM_TRUSTED_IPS,!0),c.updateCapabilities(i.ASM_ENDPOINT_FINGERPRINT,!0),c.updateCapabilities(i.ASM_NETWORK_FINGERPRINT,!0),c.updateCapabilities(i.ASM_HEADER_FINGERPRINT,!0),e.rasp?.enabled&&(c.updateCapabilities(i.ASM_RASP_SQLI,!0),c.updateCapabilities(i.ASM_RASP_SSRF,!0),c.updateCapabilities(i.ASM_RASP_LFI,!0),c.updateCapabilities(i.ASM_RASP_SHI,!0),c.updateCapabilities(i.ASM_RASP_CMDI,!0)),c.setProductHandler("ASM_DATA",u),c.setProductHandler("ASM_DD",u),c.setProductHandler("ASM",u),c.on(n.kPreUpdate,t.updateWafFromRC)}},disableWafUpdate:function(){if(c){const e=r(69538);c.updateCapabilities(i.ASM_IP_BLOCKING,!1),c.updateCapabilities(i.ASM_USER_BLOCKING,!1),c.updateCapabilities(i.ASM_DD_RULES,!1),c.updateCapabilities(i.ASM_EXCLUSIONS,!1),c.updateCapabilities(i.ASM_REQUEST_BLOCKING,!1),c.updateCapabilities(i.ASM_RESPONSE_BLOCKING,!1),c.updateCapabilities(i.ASM_CUSTOM_RULES,!1),c.updateCapabilities(i.ASM_CUSTOM_BLOCKING_RESPONSE,!1),c.updateCapabilities(i.ASM_TRUSTED_IPS,!1),c.updateCapabilities(i.ASM_ENDPOINT_FINGERPRINT,!1),c.updateCapabilities(i.ASM_NETWORK_FINGERPRINT,!1),c.updateCapabilities(i.ASM_HEADER_FINGERPRINT,!1),c.updateCapabilities(i.ASM_RASP_SQLI,!1),c.updateCapabilities(i.ASM_RASP_SSRF,!1),c.updateCapabilities(i.ASM_RASP_LFI,!1),c.updateCapabilities(i.ASM_RASP_SHI,!1),c.updateCapabilities(i.ASM_RASP_CMDI,!1),c.removeProductHandler("ASM_DATA"),c.removeProductHandler("ASM_DD"),c.removeProductHandler("ASM"),c.off(n.kPreUpdate,e.updateWafFromRC)}}}},71427:(e,t,r)=>{"use strict";const{URL:s,format:n}=r(87016),i=r(84487),{EventEmitter:o}=r(24434),a=r(8330).version,c=r(17209),u=r(75004),{getExtraServices:l}=r(47583),{UNACKNOWLEDGED:p,ACKNOWLEDGED:d,ERROR:h}=r(15265),f=r(8853),{GIT_REPOSITORY_URL:g,GIT_COMMIT_SHA:m}=r(61154),_=i(),y=Buffer.alloc(1).toString("base64"),b=Symbol("kPreUpdate"),v=Symbol("kSupportsAckCallback");class E extends o{static get kPreUpdate(){return b}constructor(e){super();const t=Math.floor(1e3*e.remoteConfig.pollInterval);this.url=e.url||new s(n({protocol:"http:",hostname:e.hostname||"localhost",port:e.port}));const r=e.repositoryUrl?{...e.tags,[g]:e.repositoryUrl,[m]:e.commitSHA}:e.tags;this._handlers=new Map;const i=this.appliedConfigs=new Map;this.scheduler=new f((e=>this.poll(e)),t),this.state={client:{state:{root_version:1,targets_version:0,get config_states(){return Array.from(i.values()).map((e=>({id:e.id,version:e.version,product:e.product,apply_state:e.apply_state,apply_error:e.apply_error})))},has_error:!1,error:"",backend_client_state:""},id:_,products:[],is_tracer:!0,client_tracer:{runtime_id:e.tags["runtime-id"],language:"node",tracer_version:a,service:e.service,env:e.env,app_version:e.version,extra_services:[],tags:Object.entries(r).map((e=>e.join(":")))},capabilities:y},cached_target_files:[]}}updateCapabilities(e,t){const r=Buffer.from(this.state.client.capabilities,"base64").toString("hex");let s=BigInt(`0x${r}`);t?s|=e:s&=~e;let n=s.toString(16);n.length%2&&(n=`0${n}`),this.state.client.capabilities=Buffer.from(n,"hex").toString("base64")}setProductHandler(e,t){this._handlers.set(e,t),this.updateProducts(),1===this.state.client.products.length&&this.scheduler.start()}removeProductHandler(e){this._handlers.delete(e),this.updateProducts(),0===this.state.client.products.length&&this.scheduler.stop()}updateProducts(){this.state.client.products=Array.from(this._handlers.keys())}getPayload(){return this.state.client.client_tracer.extra_services=l(),JSON.stringify(this.state)}poll(e){const t={url:this.url,method:"POST",path:"/v0.7/config",headers:{"Content-Type":"application/json; charset=utf-8"}};c(this.getPayload(),t,((t,r,s)=>{if(404===s)return e();if(t)return u.error("[RC] Error in request",t),e();if(this.state.client.state.has_error&&(this.state.client.state.has_error=!1,this.state.client.state.error=""),r&&"{}"!==r)try{this.parseConfig(JSON.parse(r))}catch(t){u.error("[RC] Could not parse remote config response",t),this.state.client.state.has_error=!0,this.state.client.state.error=t.toString()}e()}))}parseConfig({client_configs:e=[],targets:t,target_files:r=[]}){const s=[],n=[],i=[];for(const t of this.appliedConfigs.values())e.includes(t.path)||s.push(t);if(t=S(t)){for(const s of e){const e=t.signed.targets[s];if(!e)throw new Error(`Unable to find target for path ${s}`);const o=this.appliedConfigs.get(s),a={};if(o){if(o.hashes.sha256===e.hashes.sha256)continue;i.push(a)}else n.push(a);const c=r.find((e=>e.path===s));if(!c)throw new Error(`Unable to find file for path ${s}`);const{product:u,id:l}=w(s);Object.assign(a,{path:s,product:u,id:l,version:e.custom.v,apply_state:p,apply_error:"",length:e.length,hashes:e.hashes,file:S(c.raw)})}this.state.client.state.targets_version=t.signed.version,this.state.client.state.backend_client_state=t.signed.custom.opaque_backend_state}(s.length||n.length||i.length)&&(this.emit(E.kPreUpdate,{toUnapply:s,toApply:n,toModify:i}),this.dispatch(s,"unapply"),this.dispatch(n,"apply"),this.dispatch(i,"modify"),this.state.cached_target_files=Array.from(this.appliedConfigs.values()).map((e=>({path:e.path,length:e.length,hashes:Object.entries(e.hashes).map((e=>({algorithm:e[0],hash:e[1]})))}))))}dispatch(e,t){for(const r of e)this._callHandlerFor(t,r),"unapply"===t?this.appliedConfigs.delete(r.path):this.appliedConfigs.set(r.path,r)}_callHandlerFor(e,t){if(t.apply_state!==p&&"unapply"!==e)return;const r=this._handlers.get(t.product);if(r)try{if(function(e){if(v in e)return e[v];const t=e.length;let r=!1;if(t>=4)r=!0;else if(0!==t){const t=e.toString();r=t.slice(0,t.indexOf(")")).includes("...")}return e[v]=r,r}(r))r(e,t.file,t.id,(e=>{e?(t.apply_state=h,t.apply_error=e.toString()):t.apply_state!==h&&(t.apply_state=d)}));else{const s=r(e,t.file,t.id);s instanceof Promise?s.then((()=>{t.apply_state=d}),(e=>{t.apply_state=h,t.apply_error=e.toString()})):t.apply_state=d}}catch(e){t.apply_state=h,t.apply_error=e.toString()}}}function S(e){return e?JSON.parse(Buffer.from(e,"base64").toString()):null}const T=/^(?:datadog\/\d+|employee)\/([^/]+)\/([^/]+)\/[^/]+$/;function w(e){const t=T.exec(e);if(!t||!t[1]||!t[2])throw new Error(`Unable to parse path ${e}`);return{product:t[1],id:t[2]}}e.exports=E},8853:e=>{"use strict";e.exports=class{constructor(e,t){this._timer=null,this._callback=e,this._interval=t}start(){this._timer||this.runAfterDelay(0)}runAfterDelay(e=this._interval){this._timer=setTimeout(this._callback,e,(()=>this.runAfterDelay())),this._timer.unref&&this._timer.unref()}stop(){clearTimeout(this._timer),this._timer=null}}},27317:(e,t,r)=>{"use strict";const s=r(26748),{storage:n}=r(96882),i=r(5593),{ipHeaderList:o}=r(79449),{incrementWafInitMetric:a,updateWafRequestsMetricTags:c,updateRaspRequestsMetricTags:u,incrementWafUpdatesMetric:l,incrementWafRequestsMetric:p,getRequestMetrics:d}=r(74893),h=r(43106),f=r(64431),{SAMPLING_MECHANISM_APPSEC:g}=r(23636),{keepTrace:m}=r(15134);let _=new s(100);const y=new Map,b=["content-length","content-type","content-encoding","content-language"],v=T([...o,"x-forwarded","forwarded","via",...b,"host","accept-encoding","accept-language"],"http.request.headers."),E=T(["content-type","user-agent","accept","x-amzn-trace-id","cloudfront-viewer-ja3-fingerprint","cf-ray","x-cloud-trace-context","x-appgw-trace-id","x-sigsci-requestid","x-sigsci-tags","akamai-user-risk"],"http.request.headers."),S=T(b,"http.response.headers.");function T(e,t){return new Map(e.map((e=>[e,`${t}${x(e)}`])))}function w(e,t){const r={};if(!e)return r;for(const[s,n]of t){const t=e[s];t&&(r[n]=""+t)}return r}function x(e){return e.trim().slice(0,200).replace(/[^a-zA-Z0-9_\-:/]/g,"_").toLowerCase()}e.exports={metricsQueue:y,filterHeaders:w,formatHeaderName:x,reportWafInit:function(e,t,r={}){y.set("_dd.appsec.waf.version",e),y.set("_dd.appsec.event_rules.loaded",r.loaded?.length||0),y.set("_dd.appsec.event_rules.error_count",r.failed?.length||0),r.failed?.length&&y.set("_dd.appsec.event_rules.errors",JSON.stringify(r.errors)),a(e,t)},reportMetrics:function(e,t){const r=n.getStore(),s=r?.req&&i.root(r.req);s&&(e.rulesVersion&&s.setTag("_dd.appsec.event_rules.version",e.rulesVersion),t?u(e,r.req,t):c(e,r.req))},reportAttack:function(e){const t=n.getStore(),r=t?.req,s=i.root(r);if(!s)return;const o=s.context()._tags,a={"appsec.event":"true"};_.isAllowed()&&(m(s,g),f.sample(s)),o["_dd.origin"]||(a["_dd.origin"]="appsec");const c=o["_dd.appsec.json"];a["_dd.appsec.json"]=c?c.slice(0,-2)+","+e.slice(1)+"}":'{"triggers":'+e+"}",r.socket&&(a["network.client.ip"]=r.socket.remoteAddress),s.addTags(a)},reportWafUpdate:l,reportDerivatives:function(e){if(!e)return;const t=n.getStore()?.req,r=i.root(t);if(!r)return;const s={};for(let[t,r]of Object.entries(e))t.startsWith("_dd.appsec.fp")||(r=h.gzipSync(JSON.stringify(r)).toString("base64")),s[t]=r;r.addTags(s)},finishRequest:function(e,t){const r=i.root(e);if(!r)return;y.size&&(r.addTags(Object.fromEntries(y)),m(r,g),f.sample(r),y.clear());const s=d(e);s?.duration&&r.setTag("_dd.appsec.waf.duration",s.duration),s?.durationExt&&r.setTag("_dd.appsec.waf.duration_ext",s.durationExt),s?.raspDuration&&r.setTag("_dd.appsec.rasp.duration",s.raspDuration),s?.raspDurationExt&&r.setTag("_dd.appsec.rasp.duration_ext",s.raspDurationExt),s?.raspEvalCount&&r.setTag("_dd.appsec.rasp.rule.eval",s.raspEvalCount),p(e);const n=w(e.headers,E);r.addTags(n);const o=r.context()._tags;if(!function(e={}){if("true"===e["appsec.event"])return!0;for(const t of Object.keys(e))if(t.startsWith("appsec.events."))return!0;return!1}(o))return;const a=w(t.getHeaders(),S);Object.assign(a,w(e.headers,v)),"true"===o["appsec.event"]&&"string"==typeof e.route?.path&&(a["http.endpoint"]=e.route.path),r.addTags(a)},setRateLimit:function(e){_=new s(e)},mapHeaderAndTags:T}},69538:(e,t,r)=>{"use strict";const s=r(79896),n=r(41339),{ACKNOWLEDGED:i,ERROR:o}=r(15265),a=r(92255);let c,u,l=new Map,p=new Map,d=new Map,h=new Map,f=new Map;class g extends Map{constructor(e){super(e),this.modified=!1}set(e,t){return this.modified=!0,super.set(e,t)}delete(e){const t=super.delete(e);return t&&(this.modified=!0),t}clear(){return this.modified=!1,super.clear()}}function m(e){return Array.from(e.values()).flat()}function _(e,t){const r=e.find((e=>e.value===t.value));return r&&!("expiration"in r)||(r&&"expiration"in t&&t.expiration>r.expiration?r.expiration=t.expiration:r&&!("expiration"in t)?delete r.expiration:r||e.push({...t})),e}function y(e){const t={...e};if(t.data){const e=[];t.data.forEach((t=>{e.push({...t})})),t.data=e}return t}e.exports={loadRules:function(e){c=e.rules?JSON.parse(s.readFileSync(e.rules)):r(90542),n.init(c,e),a.setDefaultBlockingActionParameters(c?.actions)},updateWafFromRC:function({toUnapply:e,toApply:t,toModify:r}){const s=new Set,b=new g(l);let v,E;const S=new g(p),T=new g(d),w=new g(h),x=new g(f);for(const t of e){const{product:e,id:r}=t;"ASM_DATA"===e?b.delete(r):"ASM_DD"===e?u===r&&(v=c):"ASM"===e&&(S.delete(r),T.delete(r),w.delete(r),x.delete(r))}for(const e of[...t,...r]){const{product:t,id:r,file:n}=e;if("ASM_DATA"===t)n&&n.rules_data&&n.rules_data.length&&b.set(r,n.rules_data),s.add(e);else if("ASM_DD"===t)if(u&&u!==r&&v!==c)e.apply_state=o,e.apply_error="Multiple ruleset received in ASM_DD";else{if(n?.rules?.length){const{version:e,metadata:t,rules:s,processors:i,scanners:o}=n;v={version:e,metadata:t,rules:s,processors:i,scanners:o},E=r}s.add(e)}else"ASM"===t&&(n?.rules_override?.length&&S.set(r,n.rules_override),n?.exclusions?.length&&T.set(r,n.exclusions),n?.custom_rules?.length&&w.set(r,n.custom_rules),n?.actions?.length&&x.set(r,n.actions),s.add(e))}let A,I=i;if(b.modified||v||S.modified||T.modified||w.modified||x.modified){const e=v||{};b.modified&&(e.rules_data=function(e){const t=new Map;for(const[,r]of e)for(const e of r){const r=`${e.id}+${e.type}`;if(t.has(r)){const s=t.get(r);e.data.reduce(_,s.data)}else t.set(r,y(e))}return Array.from(t.values())}(b)),S.modified&&(e.rules_override=m(S)),T.modified&&(e.exclusions=m(T)),w.modified&&(e.custom_rules=m(w)),x.modified&&(e.actions=m(x));try{n.update(e),b.modified&&(l=b),v&&(u=E),S.modified&&(p=S),T.modified&&(d=T),w.modified&&(h=w),x.modified&&(f=x,a.setDefaultBlockingActionParameters(m(x)))}catch(e){I=o,A=e.toString()}}for(const e of s)e.apply_state=I,A&&(e.apply_error=A)},clearAllRules:function(){n.destroy(),c=void 0,l.clear(),u=void 0,p.clear(),d.clear(),h.clear(),f.clear(),a.setDefaultBlockingActionParameters(void 0)}}},29425:(e,t,r)=>{"use strict";const{trackUserLoginSuccessEvent:s,trackUserLoginFailureEvent:n,trackCustomEvent:i}=r(46321),{checkUserAndSetUser:o,blockRequest:a}=r(5326),{setTemplates:c}=r(92255),{setUser:u}=r(93971);e.exports=class{constructor(e,t){this._tracer=e,t&&c(t)}trackUserLoginSuccessEvent(e,t){return s(this._tracer,e,t)}trackUserLoginFailureEvent(e,t,r){return n(this._tracer,e,t,r)}trackCustomEvent(e,t){return i(this._tracer,e,t)}isUserBlocked(e){return o(this._tracer,e)}blockRequest(e,t){return a(this._tracer,e,t)}setUser(e){return u(this._tracer,e)}}},11953:e=>{"use strict";e.exports=class{trackUserLoginSuccessEvent(){}trackUserLoginFailureEvent(){}trackCustomEvent(){}isUserBlocked(){}blockRequest(){}setUser(){}}},93971:(e,t,r)=>{"use strict";const{getRootSpan:s}=r(81724),n=r(75004),i=r(41339),o=r(84250);function a(e,t){for(const r of Object.keys(e))t.setTag(`usr.${r}`,""+e[r])}e.exports={setUserTags:a,setUser:function(e,t){if(!t||!t.id)return void n.warn("[ASM] Invalid user provided to setUser");const r=s(e);r?(a(t,r),r.setTag("_dd.appsec.user.collection_mode","sdk"),i.run({persistent:{[o.USER_ID]:""+t.id}})):n.warn("[ASM] Root span not available in setUser")}}},46321:(e,t,r)=>{"use strict";const s=r(75004),{getRootSpan:n}=r(81724),{setUserTags:i}=r(93971),o=r(64431),a=r(41339),{SAMPLING_MECHANISM_APPSEC:c}=r(23636),{keepTrace:u}=r(15134),l=r(84250);function p(e,t,r,n){if(!n)return void s.warn("[ASM] Root span not available in %s",r);const i={[`appsec.events.${e}.track`]:"true",[`_dd.appsec.events.${e}.sdk`]:"true"};if(t)for(const r of Object.keys(t))i[`appsec.events.${e}.${r}`]=""+t[r];n.addTags(i),u(n,c),o.sample(n)}function d(e,t){const r={[`server.business_logic.${e}`]:null};t.id&&(r[l.USER_ID]=""+t.id),t.login&&(r[l.USER_LOGIN]=""+t.login),a.run({persistent:r})}e.exports={trackUserLoginSuccessEvent:function(e,t,r){if(!t||!t.id)return void s.warn("[ASM] Invalid user provided to trackUserLoginSuccessEvent");const o=n(e);if(!o)return void s.warn("[ASM] Root span not available in trackUserLoginSuccessEvent");i(t,o);const a=t.login??t.id;p("users.login.success",r={"usr.login":a,...r},"trackUserLoginSuccessEvent",o),d("users.login.success",{id:t.id,login:a})},trackUserLoginFailureEvent:function(e,t,r,i){t&&"string"==typeof t?(p("users.login.failure",{"usr.id":t,"usr.login":t,"usr.exists":r?"true":"false",...i},"trackUserLoginFailureEvent",n(e)),d("users.login.failure",{login:t})):s.warn("[ASM] Invalid userId provided to trackUserLoginFailureEvent")},trackCustomEvent:function(e,t,r){t&&"string"==typeof t?p(t,r,"trackCustomEvent",n(e)):s.warn("[ASM] Invalid eventName provided to trackCustomEvent")}}},5326:(e,t,r)=>{"use strict";const{USER_ID:s}=r(84250),n=r(41339),{getRootSpan:i}=r(81724),{block:o,getBlockingAction:a}=r(92255),{storage:c}=r(96882),{setUserTags:u}=r(93971),l=r(75004);e.exports={checkUserAndSetUser:function(e,t){if(!t||!t.id)return l.warn("[ASM] Invalid user provided to isUserBlocked"),!1;const r=i(e);return r?r.context()._tags["usr.id"]||(u(t,r),r.setTag("_dd.appsec.user.collection_mode","sdk")):l.warn("[ASM] Root span not available in isUserBlocked"),function(e){const t=n.run({persistent:{[s]:e.id}});return!!a(t)}(t)},blockRequest:function(e,t,r){if(!t||!r){const e=c.getStore();e&&(t=t||e.req,r=r||e.res)}if(!t||!r)return l.warn("[ASM] Requests or response object not available in blockRequest"),!1;const s=i(e);return s?(o(t,r,s),!0):(l.warn("[ASM] Root span not available in blockRequest"),!1)}}},81724:e=>{"use strict";e.exports={getRootSpan:function(e){let t=e.scope().active();if(!t)return;const r=t.context(),s=r._trace.started;let n=r._parentId;for(;n;){const e=s.find((e=>e.context()._spanId===n)),r=e?.context();if(!r)break;n=r._parentId,r._tags?._inferred_span||(t=e)}return t}}},57940:(e,t,r)=>{"use strict";const{calculateDDBasePath:s}=r(89421),n=s(__dirname),i={RASP:"exploit",IAST:"vulnerability"};function o(e=100){const t=Error.prepareStackTrace,r=Error.stackTraceLimit;let s;Error.stackTraceLimit=e+20;try{Error.prepareStackTrace=function(e,t){s=t},(new Error).stack}finally{Error.prepareStackTrace=t,Error.stackTraceLimit=r}return s}e.exports={getCallsiteFrames:function(e=32,t=o){e<1&&(e=1/0);const r=t(e).filter((e=>!e.getFileName()?.startsWith(n))),s=r.length>e?Math.round(e/2):1/0,i=[];for(let t=0;t<Math.min(r.length,e);t++){const n=t<s?t:t+r.length-e,o=r[n];i.push({id:n,file:o.getFileName(),line:o.getLineNumber(),column:o.getColumnNumber(),function:o.getFunctionName(),class_name:o.getTypeName(),isNative:o.isNative()})}return i},reportStackTrace:function(e,t,r,s=i.RASP){e&&Array.isArray(r)&&(e.meta_struct||(e.meta_struct={}),e.meta_struct["_dd.stack"]||(e.meta_struct["_dd.stack"]={}),e.meta_struct["_dd.stack"][s]||(e.meta_struct["_dd.stack"][s]=[]),e.meta_struct["_dd.stack"][s].push({id:t,language:"nodejs",frames:r}))},canReportStackTrace:function(e,t,r=i.RASP){return!!e&&(t<1||(e.meta_struct?.["_dd.stack"]?.[r]?.length??0)<t)},STACK_TRACE_NAMESPACES:i}},64431:(e,t,r)=>{"use strict";const{channel:s}=r(1247),{USER_KEEP:n,AUTO_KEEP:i,AUTO_REJECT:o}=r(1013),{MANUAL_KEEP:a}=r(74100),c=r(15134),u=r(26748),l=r(18667),{hasOwn:p}=r(89421),{APM_TRACING_ENABLED_KEY:d,APPSEC_PROPAGATION_KEY:h,SAMPLING_MECHANISM_DEFAULT:f}=r(23636),g=s("dd-trace:span:start"),m=s("dd-trace:span:inject"),_=s("dd-trace:span:extract");let y;class b extends c{constructor(e){super(e,{sampleRate:0,rateLimit:0,rules:[]}),this._limiter=new u(1,"minute")}configure(e,t){this._env=e}_getPriorityFromTags(e,t){if(p(e,a)&&!1!==e[a]&&p(t._trace.tags,h))return n}_getPriorityFromAuto(e){const t=this._getContext(e);return t._sampling.mechanism=f,p(t._trace.tags,h)?n:this._isSampledByRateLimit(t)?i:o}}function v({span:e,fields:t}){const r=e.context?.()?._tags;if(!r)return;const{parent:s}=t;s&&!s._isRemote||(r[d]=0)}function E({spanContext:e,carrier:t}){if(e?._trace?.tags&&t&&!p(e._trace.tags,h))for(const e in t){const r=e.toLowerCase();if(r.startsWith("x-datadog"))delete t[e];else if("tracestate"===r){const r=l.fromString(t[e]);r.forVendor("dd",(e=>e.clear())),t[e]=r.toString()}}}function S({spanContext:e={}}){e._trace?.tags&&e._sampling&&(p(e._trace.tags,h)?e._sampling.priority!==n&&(e._sampling.priority=n):e._sampling.priority=void 0)}e.exports={configure:function(e){if(y===e.appsec?.standalone?.enabled)return;let t;return y=e.appsec?.standalone?.enabled,y?(g.subscribe(v),m.subscribe(E),_.subscribe(S),t=new b(e.env)):(g.hasSubscribers&&g.unsubscribe(v),m.hasSubscribers&&m.unsubscribe(E),_.hasSubscribers&&_.unsubscribe(S)),t},sample:function(e){const t=e.context?.();y&&t?._trace?.tags&&(t._trace.tags[h]="1",t._sampling?.priority<i&&(t._sampling.priority=void 0))},StandAloneAsmPrioritySampler:b}},74893:(e,t,r)=>{"use strict";const s=r(95608).manager.namespace("appsec"),n=Symbol("_dd.appsec.telemetry.waf.result.tags"),i=Symbol("_dd.appsec.telemetry.request.metrics"),o="request_blocked",a="rule_triggered",c="waf_timeout",u="waf_version",l="event_rules_version",p=new WeakMap;let d=!1;function h(e){let t=p.get(e);return t||(t={[i]:{duration:0,durationExt:0,raspDuration:0,raspDurationExt:0,raspEvalCount:0}},p.set(e,t)),t}function f(e,t){return{[u]:e,[l]:t}}e.exports={enable:function(e){d=e?.enabled&&e.metrics},disable:function(){d=!1},updateWafRequestsMetricTags:function(e,t){if(!t)return;const r=h(t);if(function(e,{duration:t,durationExt:r}){e[i].duration+=t||0,e[i].durationExt+=r||0}(r,e),!d)return;const u=f(e.wafVersion,e.rulesVersion);!function(e,t){e.duration&&s.distribution("waf.duration",t).track(e.duration),e.durationExt&&s.distribution("waf.duration_ext",t).track(e.durationExt)}(e,u);const l=function(e,t){let r=e[n];return r||(r={[o]:!1,[a]:!1,[c]:!1,...t},e[n]=r),r}(r,u),{blockTriggered:p,ruleTriggered:g,wafTimeout:m}=e;return p&&(l[o]=p),g&&(l[a]=g),m&&(l[c]=m),l},updateRaspRequestsMetricTags:function(e,t,r){if(!t)return;if(function(e,{duration:t,durationExt:r}){e[i].raspDuration+=t||0,e[i].raspDurationExt+=r||0,e[i].raspEvalCount++}(h(t),e),!d)return;const n={rule_type:r.type,waf_version:e.wafVersion};r.variant&&(n.rule_variant=r.variant),s.count("rasp.rule.eval",n).inc(1),e.wafTimeout&&s.count("rasp.timeout",n).inc(1),e.ruleTriggered&&s.count("rasp.rule.match",n).inc(1)},incrementWafInitMetric:function(e,t){if(!d)return;const r=f(e,t);s.count("waf.init",r).inc()},incrementWafUpdatesMetric:function(e,t){if(!d)return;const r=f(e,t);s.count("waf.updates",r).inc()},incrementWafRequestsMetric:function(e){if(!e||!d)return;const t=h(e)[n];t&&s.count("waf.requests",t).inc(),p.delete(e)},incrementMissingUserLoginMetric:function(e,t){d&&s.count("instrum.user_auth.missing_user_login",{framework:e,event_type:t}).inc()},incrementMissingUserIdMetric:function(e,t){d&&s.count("instrum.user_auth.missing_user_id",{framework:e,event_type:t}).inc()},getRequestMetrics:function(e){if(e){const t=h(e);return t?.[i]}}}},96247:(e,t,r)=>{"use strict";const s=r(76982),n=r(75004),i=r(74893),o=r(84250),{keepTrace:a}=r(15134),{SAMPLING_MECHANISM_APPSEC:c}=r(23636),u=r(64431),l=r(41339),p=["id","_id","email","username","login","user"];let d;function h(e){return"anonymization"===d?"anon_"+s.createHash("sha256").update(e).digest().toString("hex",0,16).toLowerCase():e}function f(e){if(e)for(const t of p){let r=e[t];if(r&&"function"==typeof r.toString){if(r=r.toString(),"string"!=typeof r||r.startsWith("[object "))continue;return h(r)}}}e.exports={setCollectionMode:function(e,t=!0){if(t||!d)switch(e){case"safe":n.warn('[ASM] Using deprecated value "safe" in config.appsec.eventTracking.mode');case"anon":case"anonymization":d="anonymization";break;case"extended":n.warn('[ASM] Using deprecated value "extended" in config.appsec.eventTracking.mode');case"ident":case"identification":d="identification";break;default:d="disabled"}},trackLogin:function(e,t,r,s,p){if(!d||"disabled"===d)return;if("string"!=typeof t)return n.error("[ASM] Invalid login provided to AppSec trackLogin"),void i.incrementMissingUserLoginMetric(e,s?"login_success":"login_failure");t=h(t);const g=f(r);let m;const _={[o.USER_LOGIN]:t},y=p.context()._tags,b="true"===y[`_dd.appsec.events.users.login.${s?"success":"failure"}.sdk`];function v(e){return!(b&&y[e])}return s?(m={"appsec.events.users.login.success.track":"true","_dd.appsec.events.users.login.success.auto.mode":d,"_dd.appsec.usr.login":t},v("appsec.events.users.login.success.usr.login")&&(m["appsec.events.users.login.success.usr.login"]=t),g&&(m["_dd.appsec.usr.id"]=g,v("usr.id")&&(m["usr.id"]=g,_[o.USER_ID]=g)),_[o.LOGIN_SUCCESS]=null):(m={"appsec.events.users.login.failure.track":"true","_dd.appsec.events.users.login.failure.auto.mode":d,"_dd.appsec.usr.login":t},v("appsec.events.users.login.failure.usr.login")&&(m["appsec.events.users.login.failure.usr.login"]=t),g&&(m["_dd.appsec.usr.id"]=g,v("appsec.events.users.login.failure.usr.id")&&(m["appsec.events.users.login.failure.usr.id"]=g)),_[o.LOGIN_FAILURE]=null),a(p,c),u.sample(p),p.addTags(m),l.run({persistent:_})},trackUser:function(e,t){if(!d||"disabled"===d)return;const r=f(e);return r?(t.setTag("_dd.appsec.usr.id",r),"sdk"===t.context()._tags["_dd.appsec.user.collection_mode"]?void 0:(t.addTags({"usr.id":r,"_dd.appsec.user.collection_mode":d}),l.run({persistent:{[o.USER_ID]:r}}))):(n.error("[ASM] No valid user ID found in AppSec trackUser"),void i.incrementMissingUserIdMetric("passport","authenticated_request"))}}},41339:(e,t,r)=>{"use strict";const{storage:s}=r(96882),n=r(75004),i={wafManager:null,init:function(e,t){o();const s=r(32685);i.wafManager=new s(e,t),i.run=a,i.disposeContext=c},destroy:o,update:function(e){if(!i.wafManager)throw new Error("Cannot update disabled WAF");try{i.wafManager.update(e)}catch(e){throw n.error("[ASM] Could not apply rules from remote config"),e}},run:u,disposeContext:u};function o(){i.wafManager&&(i.wafManager.destroy(),i.wafManager=null),i.run=u,i.disposeContext=u}function a(e,t,r){if(!t){const e=s.getStore();if(!e||!e.req)return void n.warn("[ASM] Request object not available in waf.run");t=e.req}return i.wafManager.getWAFContext(t).run(e,r)}function c(e){const t=i.wafManager.getWAFContext(e);t&&!t.ddwafContext.disposed&&t.dispose()}function u(){}e.exports=i},46569:(e,t,r)=>{"use strict";const s=r(75004),n=r(27317),i=r(84250),{getBlockingAction:o}=r(92255),{wafRunFinished:a}=r(69932),c=new Set([i.HTTP_INCOMING_QUERY]);e.exports=class{constructor(e,t,r,s,n){this.ddwafContext=e,this.wafTimeout=t,this.wafVersion=r,this.rulesVersion=s,this.addressesToSkip=new Set,this.knownAddresses=n,this.cachedUserIdActions=new Map}run({persistent:e,ephemeral:t},r){if(this.ddwafContext.disposed)return void s.warn("[ASM] Calling run on a disposed context");const u=e?.[i.USER_ID]||t?.[i.USER_ID];if(u){const e=this.cachedUserIdActions.get(u);if(e)return e}const l={};let p=!1;const d=new Set(this.addressesToSkip);if(null!==e&&"object"==typeof e){const t={};for(const r of Object.keys(e))!this.addressesToSkip.has(r)&&this.knownAddresses.has(r)&&(t[r]=e[r],c.has(r)&&d.add(r));Object.keys(t).length&&(l.persistent=t,p=!0)}if(null!==t&&"object"==typeof t){const e={};for(const r of Object.keys(t))this.knownAddresses.has(r)&&(e[r]=t[r]);Object.keys(e).length&&(l.ephemeral=e,p=!0)}if(p)try{const e=process.hrtime.bigint(),t=this.ddwafContext.run(l,this.wafTimeout),s=process.hrtime.bigint();this.addressesToSkip=d;const i=!!t.events?.length,c=!!o(t.actions);return u&&i&&c&&this.setUserIdCache(u,t),n.reportMetrics({duration:t.totalRuntime/1e3,durationExt:parseInt(s-e)/1e3,rulesVersion:this.rulesVersion,ruleTriggered:i,blockTriggered:c,wafVersion:this.wafVersion,wafTimeout:t.timeout},r),i&&n.reportAttack(JSON.stringify(t.events)),n.reportDerivatives(t.derivatives),a.hasSubscribers&&a.publish({payload:l}),t.actions}catch(e){s.error("[ASM] Error while running the AppSec WAF",e)}}setUserIdCache(e,t){for(let r=0;r<t.events.length;r++){const s=t.events[r];for(let r=0;r<s?.rule_matches?.length;r++){const n=s.rule_matches[r];for(let r=0;r<n?.parameters?.length;r++){const s=n.parameters[r];if(s?.address===i.USER_ID)return void this.cachedUserIdActions.set(e,t.actions)}}}}dispose(){this.ddwafContext.dispose()}}},32685:(e,t,r)=>{"use strict";const s=r(75004),n=r(27317),i=r(46569),o=new WeakMap;e.exports=class{constructor(e,t){this.config=t,this.wafTimeout=t.wafTimeout,this.ddwaf=this._loadDDWAF(e),this.ddwafVersion=this.ddwaf.constructor.version(),this.rulesVersion=this.ddwaf.diagnostics.ruleset_version,n.reportWafInit(this.ddwafVersion,this.rulesVersion,this.ddwaf.diagnostics.rules)}_loadDDWAF(e){try{const{DDWAF:t}=r(63690),{obfuscatorKeyRegex:s,obfuscatorValueRegex:n}=this.config;return new t(e,{obfuscatorKeyRegex:s,obfuscatorValueRegex:n})}catch(e){throw s.error("[ASM] AppSec could not load native package. In-app WAF features will not be available."),e}}getWAFContext(e){let t=o.get(e);return t||(t=new i(this.ddwaf.createContext(),this.wafTimeout,this.ddwafVersion,this.rulesVersion,this.ddwaf.knownAddresses),o.set(e,t)),t}update(e){this.ddwaf.update(e),this.ddwaf.diagnostics.ruleset_version&&(this.rulesVersion=this.ddwaf.diagnostics.ruleset_version),n.reportWafUpdate(this.ddwafVersion,this.rulesVersion)}destroy(){this.ddwaf&&this.ddwaf.dispose()}}},27756:(e,t,r)=>{"use strict";const s=r(70857),{getIsAzureFunction:n}=r(3283);function i(e,t,r){if(void 0!==e&&void 0!==t&&void 0!==r)return`/subscriptions/${e}/resourcegroups/${r}/providers/microsoft.web/sites/${t}`.toLowerCase()}function o(e){return Object.entries(e).filter((([e,t])=>void 0===t)).forEach((([t,r])=>{delete e[t]})),e}function a(){const{COMPUTERNAME:e,DD_AAS_DOTNET_EXTENSION_VERSION:t,FUNCTIONS_EXTENSION_VERSION:r,FUNCTIONS_WORKER_RUNTIME:a,FUNCTIONS_WORKER_RUNTIME_VERSION:c,WEBSITE_INSTANCE_ID:u,WEBSITE_OWNER_NAME:l,WEBSITE_OS:p,WEBSITE_RESOURCE_GROUP:d,WEBSITE_SITE_NAME:h}=process.env,f=function(e){if(void 0!==e){const t=e.split("+")[0].trim();if(t.length>0)return t}}(l),g=h,[m,_]=n()?["functionapp","function"]:["app","app"],y=d??(b=l,/.+\+(.+)-.+webspace(-Linux)?/.exec(b)?.[1]);var b;return o({extensionVersion:t,functionRuntimeVersion:r,instanceID:u,instanceName:e,operatingSystem:p??s.platform(),resourceGroup:y,resourceID:i(f,g,y),runtime:a,runtimeVersion:c,siteKind:m,siteName:g,siteType:_,subscriptionID:f})}e.exports={getAzureAppMetadata:function(){return void 0!==process.env.DD_AZURE_APP_SERVICES?a():void 0},getAzureFunctionMetadata:function(){return n()?a():void 0},getAzureTagsFromMetadata:function(e){return void 0===e?{}:o({"aas.environment.extension_version":e.extensionVersion,"aas.environment.function_runtime":e.functionRuntimeVersion,"aas.environment.instance_id":e.instanceID,"aas.environment.instance_name":e.instanceName,"aas.environment.os":e.operatingSystem,"aas.environment.runtime":e.runtime,"aas.environment.runtime_version":e.runtimeVersion,"aas.resource.group":e.resourceGroup,"aas.resource.id":e.resourceID,"aas.site.kind":e.siteKind,"aas.site.name":e.siteName,"aas.site.type":e.siteType,"aas.subscription.id":e.subscriptionID})}}},14944:(e,t,r)=>{"use strict";const{join:s}=r(16928),{Worker:n,threadId:i}=r(28167),{randomUUID:o}=r(76982),a=r(75004),c=new Map,u=new Map;e.exports=new class{constructor(){this.worker=null,this._readyPromise=new Promise((e=>{this._onReady=e})),this.breakpointSetChannel=new MessageChannel,this.breakpointHitChannel=new MessageChannel,this.breakpointRemoveChannel=new MessageChannel,this.onHitBreakpointByProbeId=new Map}removeProbe(e){return new Promise((t=>{this.breakpointRemoveChannel.port2.postMessage(e),u.set(e,t)}))}addLineProbe({file:e,line:t},r){const s=o();return this.breakpointSetChannel.port2.postMessage({id:s,file:e,line:t}),this.onHitBreakpointByProbeId.set(s,r),[s,new Promise((e=>{c.set(s,e)}))]}isReady(){return this._readyPromise}start(e){if(this.worker)return;a.debug("Starting Test Visibility - Dynamic Instrumentation client...");const t=new MessageChannel,r=new MessageChannel;this.worker=new n(s(__dirname,"worker","index.js"),{execArgv:[],env:{...process.env,DD_TRACE_ENABLED:0,DD_TEST_DYNAMIC_INSTRUMENTATION_ENABLED:0},workerData:{config:e.serialize(),parentThreadId:i,rcPort:t.port1,configPort:r.port1,breakpointSetChannel:this.breakpointSetChannel.port1,breakpointHitChannel:this.breakpointHitChannel.port1,breakpointRemoveChannel:this.breakpointRemoveChannel.port1},transferList:[t.port1,r.port1,this.breakpointSetChannel.port1,this.breakpointHitChannel.port1,this.breakpointRemoveChannel.port1]}),this.worker.on("online",(()=>{a.debug("Test Visibility - Dynamic Instrumentation client is ready"),this._onReady()})),this.worker.on("error",(e=>{a.error("Test Visibility - Dynamic Instrumentation worker error",e)})),this.worker.on("messageerror",(e=>{a.error("Test Visibility - Dynamic Instrumentation worker messageerror",e)})),this.worker.unref(),this.breakpointSetChannel.port2.on("message",(e=>{const t=c.get(e);t&&(t(),c.delete(e))})).unref(),this.breakpointHitChannel.port2.on("message",(({snapshot:e})=>{const{probe:{id:t}}=e,r=this.onHitBreakpointByProbeId.get(t);r?r({snapshot:e}):a.warn("Received a breakpoint hit for an unknown probe")})).unref(),this.breakpointRemoveChannel.port2.on("message",(e=>{const t=u.get(e);t&&(t(),u.delete(e))})).unref()}}},75613:(e,t,r)=>{const s=r(17209),n=r(94248),i=r(75004),{incrementCountMetric:o,distributionMetric:a,TELEMETRY_KNOWN_TESTS:c,TELEMETRY_KNOWN_TESTS_MS:u,TELEMETRY_KNOWN_TESTS_ERRORS:l,TELEMETRY_KNOWN_TESTS_RESPONSE_TESTS:p,TELEMETRY_KNOWN_TESTS_RESPONSE_BYTES:d}=r(60806),{getNumFromKnownTests:h}=r(97507);e.exports={getKnownTests:function({url:e,isEvpProxy:t,evpProxyPrefix:r,isGzipCompatible:f,env:g,service:m,repositoryUrl:_,sha:y,osVersion:b,osPlatform:v,osArchitecture:E,runtimeName:S,runtimeVersion:T,custom:w},x){const A={path:"/api/v2/ci/libraries/tests",method:"POST",headers:{"Content-Type":"application/json"},timeout:2e4,url:e};if(f&&(A.headers["accept-encoding"]="gzip"),t)A.path=`${r}/api/v2/ci/libraries/tests`,A.headers["X-Datadog-EVP-Subdomain"]="api";else{const e=process.env.DATADOG_API_KEY||process.env.DD_API_KEY;if(!e)return x(new Error("Known tests were not fetched because Datadog API key is not defined."));A.headers["dd-api-key"]=e}const I=JSON.stringify({data:{id:n().toString(10),type:"ci_app_libraries_tests_request",attributes:{configurations:{"os.platform":v,"os.version":b,"os.architecture":E,"runtime.name":S,"runtime.version":T,custom:w},service:m,env:g,repository_url:_,sha:y}}});o(c);const k=Date.now();s(I,A,((e,t,r)=>{if(a(u,{},Date.now()-k),e)o(l,{statusCode:r}),x(e);else try{const{data:{attributes:{tests:e}}}=JSON.parse(t),r=h(e);o(p,{},r),a(d,{},t.length),i.debug((()=>`Number of received known tests: ${r}`)),x(null,e)}catch(e){x(e)}}))}}},23765:e=>{"use strict";e.exports={JSONEncoder:class{constructor(){this.payloads=[]}encode(e){this.payloads.push(e)}count(){return this.payloads.length}reset(){this.payloads=[]}makePayload(){const e=JSON.stringify(this.payloads);return this.reset(),e}}}},39107:(e,t,r)=>{"use strict";const s=r(39091),n=r(43092),i=r(93285),o=r(4753),a="/evp_proxy/v",c=/\/evp_proxy\/v(\d+)\/?/;e.exports=class extends o{constructor(e){super(e);const{tags:t,prioritySampler:o,lookup:u,protocolVersion:l,headers:p,isTestDynamicInstrumentationEnabled:d}=e;this.getAgentInfo(((e,h)=>{this._isInitialized=!0;let f=function(e,t){return e?0:t.endpoints.reduce(((e,t)=>{if(t.includes(a)){const r=Number(t.replace(c,"$1"));return isNaN(r)?e:r>e?r:e}return e}),0)}(e,h);const g=f>=2,m=f>=4;3===f&&(f=2);const _=`${a}${f}`;if(g){if(this._isUsingEvpProxy=!0,this.evpProxyPrefix=_,this._writer=new n({url:this._url,tags:t,evpProxyPrefix:_}),this._coverageWriter=new i({url:this._url,evpProxyPrefix:_}),d){const s=function(e,t){return!e&&t.endpoints.some((e=>"/debugger/v1/input"===e))}(e,h);if(s){const e=r(78820);this._logsWriter=new e({url:this._url,tags:t,isAgentProxy:!0}),this._canForwardLogs=!0}}}else this._writer=new s({url:this._url,prioritySampler:o,lookup:u,protocolVersion:l,headers:p}),this._coverageBuffer=[];this._resolveCanUseCiVisProtocol(g),this.exportUncodedTraces(),this.exportUncodedCoverages(),this._isGzipCompatible=m}))}setUrl(e,t){this._setUrl(e,t)}}},93285:(e,t,r)=>{"use strict";const s=r(17209),n=r(75004),{safeJSONStringify:i}=r(92086),{CoverageCIVisibilityEncoder:o}=r(66406),a=r(10097),{incrementCountMetric:c,distributionMetric:u,TELEMETRY_ENDPOINT_PAYLOAD_REQUESTS:l,TELEMETRY_ENDPOINT_PAYLOAD_BYTES:p,TELEMETRY_ENDPOINT_PAYLOAD_REQUESTS_MS:d,TELEMETRY_ENDPOINT_PAYLOAD_REQUESTS_ERRORS:h,TELEMETRY_ENDPOINT_PAYLOAD_DROPPED:f}=r(60806);e.exports=class extends a{constructor({url:e,evpProxyPrefix:t=""}){super(...arguments),this._url=e,this._encoder=new o(this),this._evpProxyPrefix=t}_sendPayload(e,t,r){const o={path:"/api/v2/citestcov",method:"POST",headers:{"dd-api-key":process.env.DATADOG_API_KEY||process.env.DD_API_KEY,...e.getHeaders()},timeout:15e3,url:this._url};this._evpProxyPrefix&&(o.path=`${this._evpProxyPrefix}/api/v2/citestcov`,delete o.headers["dd-api-key"],o.headers["X-Datadog-EVP-Subdomain"]="citestcov-intake"),n.debug((()=>`Request to the intake: ${i(o)}`));const a=Date.now();c(l,{endpoint:"code_coverage"}),u(p,{endpoint:"code_coverage"},e.size()),s(e,o,((e,t,s)=>{if(u(d,{endpoint:"code_coverage"},Date.now()-a),e)return c(h,{endpoint:"code_coverage",statusCode:s}),c(f,{endpoint:"code_coverage"}),n.error("Error sending CI coverage payload",e),void r();n.debug(`Response from the intake: ${t}`),r()}))}}},78820:(e,t,r)=>{"use strict";const s=r(17209),n=r(75004),{safeJSONStringify:i}=r(92086),{JSONEncoder:o}=r(23765),a=r(10097);e.exports=class extends a{constructor({url:e,timeout:t,isAgentProxy:r=!1}){super(...arguments),this._url=e,this._encoder=new o,this._isAgentProxy=r,this.timeout=t}_sendPayload(e,t,r){const o={path:"/api/v2/logs",method:"POST",headers:{"dd-api-key":process.env.DATADOG_API_KEY||process.env.DD_API_KEY,"Content-Type":"application/json"},timeout:this.timeout||15e3,url:this._url};this._isAgentProxy&&(delete o.headers["dd-api-key"],o.path="/debugger/v1/input"),n.debug((()=>`Request to the logs intake: ${i(o)}`)),s(e,o,((e,t)=>{if(e)return n.error("Error sending DI logs payload",e),void r();n.debug(`Response from the logs intake: ${t}`),r()}))}}},31355:(e,t,r)=>{"use strict";const s=r(87016).URL,n=r(43092),i=r(93285),o=r(4753),a=r(75004);e.exports=class extends o{constructor(e){super(e);const{tags:t,site:o,url:a,isTestDynamicInstrumentationEnabled:c}=e;if(this._isInitialized=!0,this._resolveCanUseCiVisProtocol(!0),this._canForwardLogs=!0,this._url=a||new s(`https://citestcycle-intake.${o}`),this._writer=new n({url:this._url,tags:t}),this._coverageUrl=a||new s(`https://citestcov-intake.${o}`),this._coverageWriter=new i({url:this._coverageUrl}),c){const e=r(78820);this._logsUrl=a||new s(`https://http-intake.logs.${o}`),this._logsWriter=new e({url:this._logsUrl,tags:t})}this._apiUrl=a||new s(`https://api.${o}`),this._isGzipCompatible=!0}setUrl(e,t=e,r=e){this._setUrl(e,t);try{r=new s(r),this._apiUrl=r}catch(e){a.error("Error setting CI exporter api url",e)}}_getApiUrl(){return this._apiUrl}}},43092:(e,t,r)=>{"use strict";const s=r(17209),{safeJSONStringify:n}=r(92086),i=r(75004),{AgentlessCiVisibilityEncoder:o}=r(46906),a=r(10097),{incrementCountMetric:c,distributionMetric:u,TELEMETRY_ENDPOINT_PAYLOAD_REQUESTS:l,TELEMETRY_ENDPOINT_PAYLOAD_BYTES:p,TELEMETRY_ENDPOINT_PAYLOAD_REQUESTS_MS:d,TELEMETRY_ENDPOINT_PAYLOAD_REQUESTS_ERRORS:h,TELEMETRY_ENDPOINT_PAYLOAD_DROPPED:f}=r(60806);e.exports=class extends a{constructor({url:e,tags:t,evpProxyPrefix:r=""}){super(...arguments);const{"runtime-id":s,env:n,service:i}=t;this._url=e,this._encoder=new o(this,{runtimeId:s,env:n,service:i}),this._evpProxyPrefix=r}_sendPayload(e,t,r){const o={path:"/api/v2/citestcycle",method:"POST",headers:{"dd-api-key":process.env.DATADOG_API_KEY||process.env.DD_API_KEY,"Content-Type":"application/msgpack"},timeout:15e3,url:this._url};this._evpProxyPrefix&&(o.path=`${this._evpProxyPrefix}/api/v2/citestcycle`,delete o.headers["dd-api-key"],o.headers["X-Datadog-EVP-Subdomain"]="citestcycle-intake"),i.debug((()=>`Request to the intake: ${n(o)}`));const a=Date.now();c(l,{endpoint:"test_cycle"}),u(p,{endpoint:"test_cycle"},e.length),s(e,o,((e,t,s)=>{if(u(d,{endpoint:"test_cycle"},Date.now()-a),e)return c(h,{endpoint:"test_cycle",statusCode:s}),c(f,{endpoint:"test_cycle"}),i.error("Error sending CI agentless payload",e),void r();i.debug(`Response from the intake: ${t}`),r()}))}setMetadataTags(e){this._encoder.setMetadataTags(e)}}},4753:(e,t,r)=>{"use strict";const s=r(87016).URL,{sendGitMetadata:n}=r(37187),{getLibraryConfiguration:i}=r(2761),{getSkippableSuites:o}=r(54005),{getKnownTests:a}=r(75613),c=r(75004),u=r(72114),{GIT_REPOSITORY_URL:l,GIT_COMMIT_SHA:p}=r(61154);e.exports=class extends u{constructor(e){super(e),this._timer=void 0,this._coverageTimer=void 0,this._logsTimer=void 0,this._coverageBuffer=[],this._canUseCiVisProtocol=!1;const t=setTimeout((()=>{this._resolveGit(new Error("Timeout while uploading git metadata"))}),6e4).unref(),r=setTimeout((()=>{this._resolveCanUseCiVisProtocol(!1)}),6e4).unref();this._gitUploadPromise=new Promise((e=>{this._resolveGit=r=>{clearTimeout(t),e(r)}})),this._canUseCiVisProtocolPromise=new Promise((e=>{this._resolveCanUseCiVisProtocol=t=>{clearTimeout(r),this._canUseCiVisProtocol=t,e(t)}})),process.once("beforeExit",(()=>{this._writer&&this._writer.flush(),this._coverageWriter&&this._coverageWriter.flush(),this._logsWriter&&this._logsWriter.flush()}))}shouldRequestSkippableSuites(){return!!(this._config.isIntelligentTestRunnerEnabled&&this._canUseCiVisProtocol&&this._libraryConfig?.isSuitesSkippingEnabled)}shouldRequestKnownTests(){return!(!this._canUseCiVisProtocol||!this._libraryConfig?.isKnownTestsEnabled)}shouldRequestLibraryConfiguration(){return this._config.isIntelligentTestRunnerEnabled}canReportSessionTraces(){return this._canUseCiVisProtocol}canReportCodeCoverage(){return this._canUseCiVisProtocol}getRequestConfiguration(e){return{url:this._getApiUrl(),env:this._config.env,service:this._config.service,isEvpProxy:!!this._isUsingEvpProxy,isGzipCompatible:this._isGzipCompatible,evpProxyPrefix:this.evpProxyPrefix,custom:(t=this._config.tags,t?Object.keys(t).reduce(((e,r)=>{if(r.startsWith("test.configuration.")){const[,s]=r.split("test.configuration.");e[s]=t[r]}return e}),{}):{}),...e};var t}getSkippableSuites(e,t){if(!this.shouldRequestSkippableSuites())return t(null,[]);this._gitUploadPromise.then((r=>{if(r)return t(r,[]);o(this.getRequestConfiguration(e),t)}))}getKnownTests(e,t){if(!this.shouldRequestKnownTests())return t(null);a(this.getRequestConfiguration(e),t)}getLibraryConfiguration(e,t){const{repositoryUrl:r}=e;if(this.sendGitMetadata(r),!this.shouldRequestLibraryConfiguration())return t(null,{});this._canUseCiVisProtocolPromise.then((r=>{if(!r)return t(null,{});const s=this.getRequestConfiguration(e);i(s,((e,r)=>{this._libraryConfig=this.filterConfiguration(r),e?t(e,{}):r?.requireGit?this._gitUploadPromise.then((e=>{if(e)return t(e,{});i(s,((e,r)=>{this._libraryConfig=this.filterConfiguration(r),t(e,this._libraryConfig)}))})):t(null,this._libraryConfig)}))}))}filterConfiguration(e){if(!e)return{};const{isCodeCoverageEnabled:t,isSuitesSkippingEnabled:r,isItrEnabled:s,requireGit:n,isEarlyFlakeDetectionEnabled:i,earlyFlakeDetectionNumRetries:o,earlyFlakeDetectionFaultyThreshold:a,isFlakyTestRetriesEnabled:c,isDiEnabled:u,isKnownTestsEnabled:l}=e;return{isCodeCoverageEnabled:t,isSuitesSkippingEnabled:r,isItrEnabled:s,requireGit:n,isEarlyFlakeDetectionEnabled:i&&this._config.isEarlyFlakeDetectionEnabled,earlyFlakeDetectionNumRetries:o,earlyFlakeDetectionFaultyThreshold:a,isFlakyTestRetriesEnabled:c&&this._config.isFlakyTestRetriesEnabled,flakyTestRetriesCount:this._config.flakyTestRetriesCount,isDiEnabled:u&&this._config.isTestDynamicInstrumentationEnabled,isKnownTestsEnabled:l}}sendGitMetadata(e){this._config.isGitUploadEnabled&&this._canUseCiVisProtocolPromise.then((t=>{t&&n(this._getApiUrl(),{isEvpProxy:!!this._isUsingEvpProxy,evpProxyPrefix:this.evpProxyPrefix},e,(e=>{e?c.error("Error uploading git metadata: %s",e.message):c.debug("Successfully uploaded git metadata"),this._resolveGit(e)}))}))}export(e){this._isInitialized?!this.canReportSessionTraces()&&function(e){return e.some((e=>"test_session_end"===e.type||"test_suite_end"===e.type||"test_module_end"===e.type))}(e)||this._export(e):this._traceBuffer.push(e)}exportCoverage(e){this._isInitialized?this.canReportCodeCoverage()&&this._export(e,this._coverageWriter,"_coverageTimer"):this._coverageBuffer.push(e)}formatLogMessage(e,t){const{[l]:r,[p]:s}=e,{service:n,env:i,version:o}=this._config;return{ddtags:[...t.ddtags||[],`${l}:${r}`,`${p}:${s}`].join(","),level:"error",service:n,dd:{...t.dd||[],service:n,env:i,version:o},ddsource:"dd_debugger",...t}}exportDiLogs(e,t){this._config.isTestDynamicInstrumentationEnabled&&this._isInitialized&&this._canForwardLogs&&this._export(this.formatLogMessage(e,t),this._logsWriter,"_logsTimer")}flush(e=()=>{}){if(!this._isInitialized)return e();const t=[this._writer,this._coverageWriter,this._logsWriter].filter((e=>e));let r=t.length;if(0===r)return e();const s=()=>{r-=1,0===r&&e()};t.forEach((e=>e.flush(s)))}exportUncodedCoverages(){this._coverageBuffer.forEach((e=>{this.exportCoverage(e)})),this._coverageBuffer=[]}_setUrl(e,t=e){try{e=new s(e),t=new s(t),this._url=e,this._coverageUrl=t,this._writer.setUrl(e),this._coverageWriter.setUrl(t)}catch(e){c.error("Error setting CI exporter url",e)}}_getApiUrl(){return this._url}setMetadataTags(e){this._writer?.setMetadataTags?this._writer.setMetadataTags(e):this._canUseCiVisProtocolPromise.then((()=>{this._writer?.setMetadataTags&&this._writer.setMetadataTags(e)}))}}},37187:(e,t,r)=>{const s=r(79896),n=r(16928),i=r(43357),o=r(17209),a=r(75004),{getLatestCommits:c,getRepositoryUrl:u,generatePackFilesForCommits:l,getCommitsRevList:p,isShallowRepository:d,unshallowRepository:h,isGitAvailable:f}=r(82919),{incrementCountMetric:g,distributionMetric:m,TELEMETRY_GIT_REQUESTS_SEARCH_COMMITS:_,TELEMETRY_GIT_REQUESTS_SEARCH_COMMITS_MS:y,TELEMETRY_GIT_REQUESTS_SEARCH_COMMITS_ERRORS:b,TELEMETRY_GIT_REQUESTS_OBJECT_PACKFILES_NUM:v,TELEMETRY_GIT_REQUESTS_OBJECT_PACKFILES:E,TELEMETRY_GIT_REQUESTS_OBJECT_PACKFILES_MS:S,TELEMETRY_GIT_REQUESTS_OBJECT_PACKFILES_ERRORS:T,TELEMETRY_GIT_REQUESTS_OBJECT_PACKFILES_BYTES:w}=r(60806);function x(e){return{method:"POST",headers:{"dd-api-key":process.env.DATADOG_API_KEY||process.env.DD_API_KEY},timeout:15e3,url:e}}function A({url:e,repositoryUrl:t,latestCommits:r,isEvpProxy:s,evpProxyPrefix:n},i){const c=x(e),u={...c,headers:{...c.headers,"Content-Type":"application/json"},path:"/api/v2/git/repository/search_commits"};s&&(u.path=`${n}/api/v2/git/repository/search_commits`,u.headers["X-Datadog-EVP-Subdomain"]="api",delete u.headers["dd-api-key"]);const l=JSON.stringify({meta:{repository_url:t},data:r.map((e=>({id:e,type:"commit"})))});g(_);const d=Date.now();o(l,u,((e,t,s)=>{if(m(y,{},Date.now()-d),e){g(b,{statusCode:s});const t=new Error(`Error fetching commits to exclude: ${e.message}`);return i(t)}let n;try{o=JSON.parse(t).data,n=o.map((({id:e,type:t})=>{if("commit"!==t)throw new Error("Invalid commit type response");if(/^[0-9a-f]{40}$/.test(e)||/^[0-9a-f]{64}$/.test(e))return e.replace(/[^0-9a-f]+/g,"");throw new Error("Invalid commit format")}))}catch(e){return g(b,{errorType:"network"}),i(new Error(`Can't parse commits to exclude response: ${e.message}`))}var o;a.debug(`There are ${n.length} commits to exclude.`);const c=r.filter((e=>!n.includes(e)));if(a.debug(`There are ${c.length} commits to include.`),!c.length)return i(null,[]);const u=p(n,c);if(null===u)return i(new Error("git rev-list failed"));i(null,u)}))}function I({url:e,isEvpProxy:t,evpProxyPrefix:r,packFileToUpload:a,repositoryUrl:c,headCommit:u},l){const p=new i,d=JSON.stringify({data:{id:u,type:"commit"},meta:{repository_url:c}});p.append("pushedSha",d,{contentType:"application/json"});try{const e=s.readFileSync(a),[,t]=n.basename(a).split("-");p.append("packfile",e,{filename:t,contentType:"application/octet-stream"})}catch(e){return void l(new Error(`Could not read "${a}"`))}const h=x(e),f={...h,path:"/api/v2/git/repository/packfile",headers:{...h.headers,...p.getHeaders()}};t&&(f.path=`${r}/api/v2/git/repository/packfile`,f.headers["X-Datadog-EVP-Subdomain"]="api",delete f.headers["dd-api-key"]),g(E);const _=p.size(),y=Date.now();o(p,f,((e,t,r)=>{if(m(S,{},Date.now()-y),e){g(T,{statusCode:r});const t=new Error(`Could not upload packfiles: status code ${r}: ${e.message}`);return l(t,_)}l(null,_)}))}e.exports={sendGitMetadata:function(e,{isEvpProxy:t,evpProxyPrefix:r},s,n){if(!f())return n(new Error("Git is not available"));let i=s;if(i||(i=u()),a.debug(`Uploading git history for repository ${i}`),!i)return n(new Error("Repository URL is empty"));let o=c();a.debug(`There were ${o.length} commits since last month.`);const p=s=>(u,f)=>{if(u)return n(u);if(!f.length)return a.debug("No commits to upload"),n(null);if(s||!d()){const[s]=o;return function({url:e,isEvpProxy:t,evpProxyPrefix:r,commitsToUpload:s,repositoryUrl:n,headCommit:i},o){a.debug(`There are ${s.length} commits to upload`);const c=l(s);if(a.debug(`Uploading ${c.length} packfiles.`),!c.length)return o(new Error("Failed to generate packfiles"));m(v,{},c.length);let u=0,p=0;const d=(s,a)=>(p+=a,s||u===c.length?(m(w,{},p),o(s)):I({packFileToUpload:c[u++],url:e,isEvpProxy:t,evpProxyPrefix:r,repositoryUrl:n,headCommit:i},d));I({packFileToUpload:c[u++],url:e,isEvpProxy:t,evpProxyPrefix:r,repositoryUrl:n,headCommit:i},d)}({url:e,isEvpProxy:t,evpProxyPrefix:r,commitsToUpload:f,repositoryUrl:i,headCommit:s},n)}a.debug("It is shallow clone, unshallowing..."),h(),o=c(),A({url:e,repositoryUrl:i,latestCommits:o,isEvpProxy:t,evpProxyPrefix:r},p(!0))};A({url:e,repositoryUrl:i,latestCommits:o,isEvpProxy:t,evpProxyPrefix:r},p(!1))}}},62794:(e,t,r)=>{"use strict";const s=r(1747),{JEST_WORKER_COVERAGE_PAYLOAD_CODE:n,JEST_WORKER_TRACE_PAYLOAD_CODE:i,CUCUMBER_WORKER_TRACE_PAYLOAD_CODE:o,MOCHA_WORKER_TRACE_PAYLOAD_CODE:a,JEST_WORKER_LOGS_PAYLOAD_CODE:c}=r(97507);e.exports=class{constructor(){const e=process.env.JEST_WORKER_ID?i:process.env.CUCUMBER_WORKER_ID?o:process.env.MOCHA_WORKER_ID?a:null,t=process.env.JEST_WORKER_ID?n:null,r=process.env.JEST_WORKER_ID?c:null;this._writer=new s(e),this._coverageWriter=new s(t),this._logsWriter=new s(r)}export(e){this._writer.append(e)}exportCoverage(e){this._coverageWriter.append(e)}exportDiLogs(e,t){this._logsWriter.append({testConfiguration:e,logMessage:t})}flush(){this._writer.flush(),this._coverageWriter.flush(),this._logsWriter.flush()}}},1747:(e,t,r)=>{"use strict";const{JSONEncoder:s}=r(23765);e.exports=class{constructor(e){this._encoder=new s,this._interprocessCode=e}flush(){if(this._encoder.count()>0){const e=this._encoder.makePayload();this._sendPayload(e)}}append(e){this._encoder.encode(e)}_sendPayload(e){process.send&&process.send([this._interprocessCode,e])}}},54005:(e,t,r)=>{const s=r(17209),n=r(75004),{incrementCountMetric:i,distributionMetric:o,TELEMETRY_ITR_SKIPPABLE_TESTS:a,TELEMETRY_ITR_SKIPPABLE_TESTS_MS:c,TELEMETRY_ITR_SKIPPABLE_TESTS_ERRORS:u,TELEMETRY_ITR_SKIPPABLE_TESTS_RESPONSE_SUITES:l,TELEMETRY_ITR_SKIPPABLE_TESTS_RESPONSE_TESTS:p,TELEMETRY_ITR_SKIPPABLE_TESTS_RESPONSE_BYTES:d}=r(60806);e.exports={getSkippableSuites:function({url:e,isEvpProxy:t,evpProxyPrefix:r,isGzipCompatible:h,env:f,service:g,repositoryUrl:m,sha:_,osVersion:y,osPlatform:b,osArchitecture:v,runtimeName:E,runtimeVersion:S,custom:T,testLevel:w="suite"},x){const A={path:"/api/v2/ci/tests/skippable",method:"POST",headers:{"Content-Type":"application/json"},timeout:2e4,url:e};if(h&&(A.headers["accept-encoding"]="gzip"),t)A.path=`${r}/api/v2/ci/tests/skippable`,A.headers["X-Datadog-EVP-Subdomain"]="api";else{const e=process.env.DATADOG_API_KEY||process.env.DD_API_KEY;if(!e)return x(new Error("Skippable suites were not fetched because Datadog API key is not defined."));A.headers["dd-api-key"]=e}const I=JSON.stringify({data:{type:"test_params",attributes:{test_level:w,configurations:{"os.platform":b,"os.version":y,"os.architecture":v,"runtime.name":E,"runtime.version":S,custom:T},service:g,env:f,repository_url:m,sha:_}}});i(a);const k=Date.now();s(I,A,((e,t,r)=>{if(o(c,{},Date.now()-k),e)i(u,{statusCode:r}),x(e);else{let r=[];try{const e=JSON.parse(t);r=e.data.filter((({type:e})=>e===w)).map((({attributes:{suite:e,name:t}})=>"suite"===w?e:{suite:e,name:t}));const{meta:{correlation_id:s}}=e;i("test"===w?p:l,{},r.length),o(d,{},t.length),n.debug((()=>`Number of received skippable ${w}s: ${r.length}`)),x(null,r,s)}catch(e){x(e)}}}))}}},2964:(e,t,r)=>{const s=r(12583),n=r(75004);e.exports=class extends s{static get id(){return"log-submission"}constructor(...e){super(...e),this.addSub("ci:log-submission:winston:configure",(e=>{this.HttpClass=e})),this.addSub("ci:log-submission:winston:add-transport",(e=>{e.add(new this.HttpClass(function(e){const{site:t,service:r}=e,s={host:`http-intake.logs.${t}`,path:`/api/v2/logs?ddsource=winston&service=${r}`,ssl:!0,headers:{"DD-API-KEY":process.env.DD_API_KEY}};if(!process.env.DD_AGENTLESS_LOG_SUBMISSION_URL)return s;try{const e=new URL(process.env.DD_AGENTLESS_LOG_SUBMISSION_URL);return{host:e.hostname,port:e.port,ssl:"https:"===e.protocol,path:s.path,headers:s.headers}}catch(e){return n.error("Could not parse DD_AGENTLESS_LOG_SUBMISSION_URL"),s}}(this.config)))}))}}},2761:(e,t,r)=>{const s=r(17209),n=r(94248),i=r(75004),{incrementCountMetric:o,distributionMetric:a,TELEMETRY_GIT_REQUESTS_SETTINGS:c,TELEMETRY_GIT_REQUESTS_SETTINGS_MS:u,TELEMETRY_GIT_REQUESTS_SETTINGS_ERRORS:l,TELEMETRY_GIT_REQUESTS_SETTINGS_RESPONSE:p}=r(60806);e.exports={getLibraryConfiguration:function({url:e,isEvpProxy:t,evpProxyPrefix:r,env:d,service:h,repositoryUrl:f,sha:g,osVersion:m,osPlatform:_,osArchitecture:y,runtimeName:b,runtimeVersion:v,branch:E,testLevel:S="suite",custom:T},w){const x={path:"/api/v2/libraries/tests/services/setting",method:"POST",headers:{"Content-Type":"application/json"},url:e,timeout:2e4};if(t)x.path=`${r}/api/v2/libraries/tests/services/setting`,x.headers["X-Datadog-EVP-Subdomain"]="api";else{const e=process.env.DATADOG_API_KEY||process.env.DD_API_KEY;if(!e)return w(new Error("Request to settings endpoint was not done because Datadog API key is not defined."));x.headers["dd-api-key"]=e}const A=JSON.stringify({data:{id:n().toString(10),type:"ci_app_test_service_libraries_settings",attributes:{test_level:S,configurations:{"os.platform":_,"os.version":m,"os.architecture":y,"runtime.name":b,"runtime.version":v,custom:T},service:h,env:d,repository_url:f,sha:g,branch:E}}});o(c);const I=Date.now();s(A,x,((e,t,r)=>{if(a(u,{},Date.now()-I),e)o(l,{statusCode:r}),w(e);else try{const{data:{attributes:{code_coverage:e,tests_skipping:r,itr_enabled:s,require_git:n,early_flake_detection:a,flaky_test_retries_enabled:c,di_enabled:u,known_tests_enabled:l}}}=JSON.parse(t),d={isCodeCoverageEnabled:e,isSuitesSkippingEnabled:r,isItrEnabled:s,requireGit:n,isEarlyFlakeDetectionEnabled:l&&(a?.enabled??!1),earlyFlakeDetectionNumRetries:a?.slow_test_retries?.["5s"]||2,earlyFlakeDetectionFaultyThreshold:a?.faulty_session_threshold??30,isFlakyTestRetriesEnabled:c,isDiEnabled:u&&c,isKnownTestsEnabled:l};i.debug((()=>`Remote settings: ${JSON.stringify(d)}`)),process.env.DD_CIVISIBILITY_DANGEROUSLY_FORCE_COVERAGE&&(d.isCodeCoverageEnabled=!0,i.debug((()=>"Dangerously set code coverage to true"))),process.env.DD_CIVISIBILITY_DANGEROUSLY_FORCE_TEST_SKIPPING&&(d.isSuitesSkippingEnabled=!0,i.debug((()=>"Dangerously set test skipping to true"))),o(p,d),w(null,d)}catch(e){w(e)}}))}}},60806:(e,t,r)=>{const s=r(95608).manager.namespace("civisibility"),n={testLevel:"event_type",testFramework:"test_framework",errorType:"error_type",exitCode:"exit_code",isCodeCoverageEnabled:"coverage_enabled",isSuitesSkippingEnabled:"itrskip_enabled",hasCodeOwners:"has_code_owners",isUnsupportedCIProvider:"is_unsupported_ci",isNew:"is_new",isRum:"is_rum",browserDriver:"browser_driver"};function i(e){return Object.keys(e).reduce(((t,r)=>{if("statusCode"===r){const s=e[r];return function(e){return e>=400&&e<500}(s)&&t.push(`status_code:${s}`),t.push(`error_type:${function(e){return e>=400&&e<500?"status_code_4xx_response":e>=500?"status_code_5xx_response":"network"}(s)}`),t}const s=n[r]||r;return!0===e[r]?t.push(s):void 0!==e[r]&&null!==e[r]&&t.push(`${s}:${e[r]}`),t}),[])}e.exports={incrementCountMetric:function(e,t={},r=1){s.count(e,i(t)).inc(r)},distributionMetric:function(e,t,r){s.distribution(e,i(t)).track(r)},TELEMETRY_TEST_SESSION:"test_session",TELEMETRY_EVENT_CREATED:"event_created",TELEMETRY_EVENT_FINISHED:"event_finished",TELEMETRY_CODE_COVERAGE_STARTED:"code_coverage_started",TELEMETRY_CODE_COVERAGE_FINISHED:"code_coverage_finished",TELEMETRY_ITR_SKIPPED:"itr_skipped",TELEMETRY_ITR_UNSKIPPABLE:"itr_unskippable",TELEMETRY_ITR_FORCED_TO_RUN:"itr_forced_run",TELEMETRY_CODE_COVERAGE_EMPTY:"code_coverage.is_empty",TELEMETRY_CODE_COVERAGE_NUM_FILES:"code_coverage.files",TELEMETRY_EVENTS_ENQUEUED_FOR_SERIALIZATION:"events_enqueued_for_serialization",TELEMETRY_ENDPOINT_PAYLOAD_SERIALIZATION_MS:"endpoint_payload.events_serialization_ms",TELEMETRY_ENDPOINT_PAYLOAD_REQUESTS:"endpoint_payload.requests",TELEMETRY_ENDPOINT_PAYLOAD_BYTES:"endpoint_payload.bytes",TELEMETRY_ENDPOINT_PAYLOAD_EVENTS_COUNT:"endpoint_payload.events_count",TELEMETRY_ENDPOINT_PAYLOAD_REQUESTS_MS:"endpoint_payload.requests_ms",TELEMETRY_ENDPOINT_PAYLOAD_REQUESTS_ERRORS:"endpoint_payload.requests_errors",TELEMETRY_ENDPOINT_PAYLOAD_DROPPED:"endpoint_payload.dropped",TELEMETRY_GIT_COMMAND:"git.command",TELEMETRY_GIT_COMMAND_MS:"git.command_ms",TELEMETRY_GIT_COMMAND_ERRORS:"git.command_errors",TELEMETRY_GIT_REQUESTS_SEARCH_COMMITS:"git_requests.search_commits",TELEMETRY_GIT_REQUESTS_SEARCH_COMMITS_MS:"git_requests.search_commits_ms",TELEMETRY_GIT_REQUESTS_SEARCH_COMMITS_ERRORS:"git_requests.search_commits_errors",TELEMETRY_GIT_REQUESTS_OBJECT_PACKFILES_NUM:"git_requests.objects_pack_files",TELEMETRY_GIT_REQUESTS_OBJECT_PACKFILES_BYTES:"git_requests.objects_pack_bytes",TELEMETRY_GIT_REQUESTS_OBJECT_PACKFILES:"git_requests.objects_pack",TELEMETRY_GIT_REQUESTS_OBJECT_PACKFILES_MS:"git_requests.objects_pack_ms",TELEMETRY_GIT_REQUESTS_OBJECT_PACKFILES_ERRORS:"git_requests.objects_pack_errors",TELEMETRY_GIT_REQUESTS_SETTINGS:"git_requests.settings",TELEMETRY_GIT_REQUESTS_SETTINGS_MS:"git_requests.settings_ms",TELEMETRY_GIT_REQUESTS_SETTINGS_ERRORS:"git_requests.settings_errors",TELEMETRY_GIT_REQUESTS_SETTINGS_RESPONSE:"git_requests.settings_response",TELEMETRY_ITR_SKIPPABLE_TESTS:"itr_skippable_tests.request",TELEMETRY_ITR_SKIPPABLE_TESTS_MS:"itr_skippable_tests.request_ms",TELEMETRY_ITR_SKIPPABLE_TESTS_ERRORS:"itr_skippable_tests.request_errors",TELEMETRY_ITR_SKIPPABLE_TESTS_RESPONSE_SUITES:"itr_skippable_tests.response_suites",TELEMETRY_ITR_SKIPPABLE_TESTS_RESPONSE_TESTS:"itr_skippable_tests.response_tests",TELEMETRY_ITR_SKIPPABLE_TESTS_RESPONSE_BYTES:"itr_skippable_tests.response_bytes",TELEMETRY_KNOWN_TESTS:"early_flake_detection.request",TELEMETRY_KNOWN_TESTS_MS:"early_flake_detection.request_ms",TELEMETRY_KNOWN_TESTS_ERRORS:"early_flake_detection.request_errors",TELEMETRY_KNOWN_TESTS_RESPONSE_TESTS:"early_flake_detection.response_tests",TELEMETRY_KNOWN_TESTS_RESPONSE_BYTES:"early_flake_detection.response_bytes"}},26584:(e,t,r)=>{const s=r(32028),{TEST_STATUS:n,finishAllTraceSpans:i,getTestSuitePath:o}=r(97507),{storage:a}=r(96882);e.exports=class extends s{static get id(){return"test-api-manual"}constructor(...e){super(...e),this._isEnvDataCalcualted=!1,this.sourceRoot=process.cwd(),this.unconfiguredAddSub("dd-trace:ci:manual:test:start",(({testName:e,testSuite:t})=>{const r=a.getStore(),s=o(t,this.sourceRoot),n=this.startTestSpan(e,s);this.enter(n,r)})),this.unconfiguredAddSub("dd-trace:ci:manual:test:finish",(({status:e,error:t})=>{const r=a.getStore(),s=r&&r.span;s&&(s.setTag(n,e),t&&s.setTag("error",t),s.finish(),i(s))})),this.unconfiguredAddSub("dd-trace:ci:manual:test:addTags",(e=>{const t=a.getStore(),r=t&&t.span;r&&r.addTags(e)}))}unconfiguredAddSub(e,t){this.addSub(e,((...e)=>(this._isEnvDataCalcualted||(this._isEnvDataCalcualted=!0,this.configure(this._config,!0)),t(...e))))}configure(e,t){this._config=e,super.configure(e,t)}}},90447:(e,t,r)=>{"use strict";const s=r(79896),n=r(70857),i=r(84487),{URL:o}=r(87016),a=r(75004),c=r(8523),u=r(96538),l=r(95487),p=r(98496),d=r(4612),h=r(15204),{isTrue:f,isFalse:g}=r(89421),{GIT_REPOSITORY_URL:m,GIT_COMMIT_SHA:_}=r(61154),{getGitMetadataFromGitProperties:y,removeUserSensitiveInfo:b}=r(66213),{updateConfig:v}=r(33837),E=r(95608),{getIsGCPFunction:S,getIsAzureFunction:T}=r(3283),{ORIGIN_KEY:w,GRPC_CLIENT_ERROR_STATUSES:x,GRPC_SERVER_ERROR_STATUSES:A}=r(23636),{appendRules:I}=r(16569),k=E.manager.namespace("tracers"),O={"otel.env.hiding":{},"otel.env.invalid":{}};function R(e,t,r){const s=O[e],n=[];t&&(t="config_datadog:"+t.toLowerCase(),n.push(t)),r&&(r="config_opentelemetry:"+r.toLowerCase(),n.push(r)),r in s||(s[r]={});const i=k.count(e,n);return s[r][t]=i,i}const C={OTEL_LOG_LEVEL:"DD_TRACE_LOG_LEVEL",OTEL_PROPAGATORS:"DD_TRACE_PROPAGATION_STYLE",OTEL_SERVICE_NAME:"DD_SERVICE",OTEL_TRACES_SAMPLER:"DD_TRACE_SAMPLE_RATE",OTEL_TRACES_SAMPLER_ARG:"DD_TRACE_SAMPLE_RATE",OTEL_TRACES_EXPORTER:"DD_TRACE_ENABLED",OTEL_METRICS_EXPORTER:"DD_RUNTIME_METRICS_ENABLED",OTEL_RESOURCE_ATTRIBUTES:"DD_TAGS",OTEL_SDK_DISABLED:"DD_TRACE_OTEL_ENABLED",OTEL_LOGS_EXPORTER:void 0},N=new Set(["datadog","tracecontext","b3","b3 single header","none"]),P=new Set(["debug","info","warn","error"]);function D(e,t){return{always_on:"1.0",always_off:"0.0",traceidratio:t,parentbased_always_on:"1.0",parentbased_always_off:"0.0",parentbased_traceidratio:t}[e]}function L(e){const t=process.env[e];switch(e){case"OTEL_LOG_LEVEL":return P.has(t);case"OTEL_PROPAGATORS":case"OTEL_RESOURCE_ATTRIBUTES":case"OTEL_SERVICE_NAME":return"string"==typeof t;case"OTEL_TRACES_SAMPLER":return void 0!==D(t,process.env.OTEL_TRACES_SAMPLER_ARG);case"OTEL_TRACES_SAMPLER_ARG":return!isNaN(parseFloat(t));case"OTEL_SDK_DISABLED":return"true"===t.toLowerCase()||"false"===t.toLowerCase();case"OTEL_TRACES_EXPORTER":case"OTEL_METRICS_EXPORTER":case"OTEL_LOGS_EXPORTER":return"none"===t.toLowerCase();default:return!1}}const M=Object.fromEntries||(e=>e.reduce(((e,[t,r])=>Object.assign(e,{[t]:r})),{})),q=i();function j(e){if(e)try{return s.readFileSync(e,"utf8")}catch(t){return void a.error("Error reading file %s",e,t)}}function U(e){try{return JSON.parse(e)}catch(e){return}}const F=["v0","v1"],B="v0";function $(e){return e?F.includes(e)?e:(a.warn(`Unexpected input for config.spanAttributeSchema, picked default ${B}`),B):B}function G(e){return e?Array.isArray(e)?e:"all"===e?[]:e.split(","):null}function V(e,t){if(!e)return;const r={};for(const[s,n]of Object.entries(e))r[s in t?t[s]:s]=n;return r}function z(e,t){if(null===t||"object"!=typeof t||Array.isArray(t)||(t=t[e]),Array.isArray(t))return t.map((e=>e.toLowerCase()));void 0!==t&&a.warn("Unexpected input for config.tracePropagationStyle");const r=`DD_TRACE_PROPAGATION_STYLE_${e.toUpperCase()}`,s=u(process.env[r],process.env.DD_TRACE_PROPAGATION_STYLE,process.env.OTEL_PROPAGATORS);return void 0!==s?s.split(",").filter((e=>""!==e)).map((e=>e.trim().toLowerCase())):void 0}function H(e){return e?e.map((e=>V(e,{sample_rate:"sampleRate",max_per_second:"maxPerSecond"}))):e}function K(e){const t=parseInt(e);return isNaN(t)?void 0:t}function Y(e){const t=parseFloat(e);return isNaN(t)?void 0:t}function Q(e,t){return e?new o(e):"Windows_NT"!==n.type()?t.hostname||t.port||process.env.DD_AGENT_HOST||process.env.DD_TRACE_AGENT_HOSTNAME||process.env.DD_TRACE_AGENT_PORT||!s.existsSync("/var/run/datadog/apm.socket")?void 0:new o("unix:///var/run/datadog/apm.socket"):void 0}function W(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!1,writable:!0}),e[t]}e.exports=class{constructor(e={}){e={...e,appsec:null!=e.appsec?e.appsec:e.experimental?.appsec,iast:null!=e.iast?e.iast:e.experimental?.iast};const t=a.getConfig();this.debug=t.enabled,this.logger=u(e.logger,t.logger),this.logLevel=u(e.logLevel,t.logLevel),a.use(this.logger),a.toggle(this.debug,this.logLevel),function(){for(const[e,t]of Object.entries(C))t&&process.env[t]&&process.env[e]&&(a.warn(`both ${t} and ${e} environment variables are set`),R("otel.env.hiding",t,e).inc()),process.env[e]&&!L(e)&&(a.warn(`unexpected value for ${e} environment variable`),R("otel.env.invalid",t,e).inc())}();const r=u(process.env.DATADOG_API_KEY,process.env.DD_API_KEY);process.env.DD_TRACE_PROPAGATION_STYLE&&(process.env.DD_TRACE_PROPAGATION_STYLE_INJECT||process.env.DD_TRACE_PROPAGATION_STYLE_EXTRACT)&&a.warn("Use either the DD_TRACE_PROPAGATION_STYLE environment variable or separate DD_TRACE_PROPAGATION_STYLE_INJECT and DD_TRACE_PROPAGATION_STYLE_EXTRACT environment variables"),function(e){if(!process.env.PROPAGATION_STYLE_EXTRACT&&!process.env.PROPAGATION_STYLE_INJECT&&!process.env.DD_TRACE_PROPAGATION_STYLE&&process.env.OTEL_PROPAGATORS)for(const t in e)N.has(t)||(a.warn("unexpected value for OTEL_PROPAGATORS environment variable"),R("otel.env.invalid","DD_TRACE_PROPAGATION_STYLE","OTEL_PROPAGATORS").inc())}(z("inject",e.tracePropagationStyle,this._getDefaultPropagationStyle(e))),"boolean"==typeof e.appsec?e.appsec={enabled:e.appsec}:null==e.appsec&&(e.appsec={});const n=u(process.env.DD_INSTRUMENTATION_INSTALL_ID,null),i=u(process.env.DD_INSTRUMENTATION_INSTALL_TIME,null),o=u(process.env.DD_INSTRUMENTATION_INSTALL_TYPE,null),c=G(u(process.env.DD_TRACE_CLOUD_REQUEST_PAYLOAD_TAGGING,e.cloudPayloadTagging?.request,"")),p=G(u(process.env.DD_TRACE_CLOUD_RESPONSE_PAYLOAD_TAGGING,e.cloudPayloadTagging?.response,"")),d=u(process.env.DD_TRACE_CLOUD_PAYLOAD_TAGGING_MAX_DEPTH,e.cloudPayloadTagging?.maxDepth,10);if(this.apiKey=r,this.installSignature={id:n,time:i,type:o},this.cloudPayloadTagging={requestsEnabled:!!c,responsesEnabled:!!p,maxDepth:d,rules:I(c,p)},this._applyDefaults(),this._applyEnvironment(),this._applyOptions(e),this._applyCalculated(),this._applyRemote({}),this._merge(),l.add(this.tags,{service:this.service,env:this.env,version:this.version,"runtime-id":q}),this.isCiVisibility&&l.add(this.tags,{[w]:"ciapp-test"}),this.gitMetadataEnabled&&(this.repositoryUrl=b(u(process.env.DD_GIT_REPOSITORY_URL,this.tags[m])),this.commitSHA=u(process.env.DD_GIT_COMMIT_SHA,this.tags[_]),!this.repositoryUrl||!this.commitSHA)){const e=u(process.env.DD_GIT_PROPERTIES_FILE,`${process.cwd()}/git.properties`);let t;try{t=s.readFileSync(e,"utf8")}catch(t){process.env.DD_GIT_PROPERTIES_FILE&&a.error("Error reading DD_GIT_PROPERTIES_FILE: %s",e,t)}if(t){const{commitSHA:e,repositoryUrl:r}=y(t);this.commitSHA=this.commitSHA||e,this.repositoryUrl=this.repositoryUrl||r}}}configure(e,t){t?this._applyRemote(e):this._applyOptions(e),this._applyCalculated(),this._merge()}_getDefaultPropagationStyle(e){const t=u(e.experimental&&e.experimental.b3,process.env.DD_TRACE_EXPERIMENTAL_B3_ENABLED,!1),r=["datadog","tracecontext"];return f(t)&&(r.push("b3"),r.push("b3 single header")),r}_isInServerlessEnvironment(){const e=void 0!==process.env.AWS_LAMBDA_FUNCTION_NAME,t=S(),r=T();return e||t||r}_applyDefaults(){const{AWS_LAMBDA_FUNCTION_NAME:e,FUNCTION_NAME:t,K_SERVICE:r,WEBSITE_SITE_NAME:s}=process.env,n=e||t||r||s||c.name||"node",i=W(this,"_defaults",{});this._setValue(i,"appsec.apiSecurity.enabled",!0),this._setValue(i,"appsec.apiSecurity.sampleDelay",30),this._setValue(i,"appsec.blockedTemplateGraphql",void 0),this._setValue(i,"appsec.blockedTemplateHtml",void 0),this._setValue(i,"appsec.blockedTemplateJson",void 0),this._setValue(i,"appsec.enabled",void 0),this._setValue(i,"appsec.eventTracking.mode","identification"),this._setValue(i,"appsec.obfuscatorKeyRegex","(?i)pass|pw(?:or)?d|secret|(?:api|private|public|access)[_-]?key|token|consumer[_-]?(?:id|key|secret)|sign(?:ed|ature)|bearer|authorization|jsessionid|phpsessid|asp\\.net[_-]sessionid|sid|jwt"),this._setValue(i,"appsec.obfuscatorValueRegex",'(?i)(?:p(?:ass)?w(?:or)?d|pass(?:[_-]?phrase)?|secret(?:[_-]?key)?|(?:(?:api|private|public|access)[_-]?)key(?:[_-]?id)?|(?:(?:auth|access|id|refresh)[_-]?)?token|consumer[_-]?(?:id|key|secret)|sign(?:ed|ature)?|auth(?:entication|orization)?|jsessionid|phpsessid|asp\\.net(?:[_-]|-)sessionid|sid|jwt)(?:\\s*=[^;]|"\\s*:\\s*"[^"]+")|bearer\\s+[a-z0-9\\._\\-]+|token:[a-z0-9]{13}|gh[opsu]_[0-9a-zA-Z]{36}|ey[I-L][\\w=-]+\\.ey[I-L][\\w=-]+(?:\\.[\\w.+\\/=-]+)?|[\\-]{5}BEGIN[a-z\\s]+PRIVATE\\sKEY[\\-]{5}[^\\-]+[\\-]{5}END[a-z\\s]+PRIVATE\\sKEY|ssh-rsa\\s*[a-z0-9\\/\\.+]{100,}'),this._setValue(i,"appsec.rasp.enabled",!0),this._setValue(i,"appsec.rateLimit",100),this._setValue(i,"appsec.rules",void 0),this._setValue(i,"appsec.sca.enabled",null),this._setValue(i,"appsec.standalone.enabled",void 0),this._setValue(i,"appsec.stackTrace.enabled",!0),this._setValue(i,"appsec.stackTrace.maxDepth",32),this._setValue(i,"appsec.stackTrace.maxStackTraces",2),this._setValue(i,"appsec.wafTimeout",5e3),this._setValue(i,"baggageMaxBytes",8192),this._setValue(i,"baggageMaxItems",64),this._setValue(i,"ciVisibilityTestSessionName",""),this._setValue(i,"clientIpEnabled",!1),this._setValue(i,"clientIpHeader",null),this._setValue(i,"crashtracking.enabled",!0),this._setValue(i,"codeOriginForSpans.enabled",!1),this._setValue(i,"dbmPropagationMode","disabled"),this._setValue(i,"dogstatsd.hostname","127.0.0.1"),this._setValue(i,"dogstatsd.port","8125"),this._setValue(i,"dsmEnabled",!1),this._setValue(i,"dynamicInstrumentation.enabled",!1),this._setValue(i,"dynamicInstrumentation.redactedIdentifiers",[]),this._setValue(i,"dynamicInstrumentation.redactionExcludedIdentifiers",[]),this._setValue(i,"env",void 0),this._setValue(i,"experimental.enableGetRumData",!1),this._setValue(i,"experimental.exporter",void 0),this._setValue(i,"experimental.runtimeId",!1),this._setValue(i,"flushInterval",2e3),this._setValue(i,"flushMinSpans",1e3),this._setValue(i,"gitMetadataEnabled",!0),this._setValue(i,"graphqlErrorExtensions",[]),this._setValue(i,"grpc.client.error.statuses",x),this._setValue(i,"grpc.server.error.statuses",A),this._setValue(i,"headerTags",[]),this._setValue(i,"hostname","127.0.0.1"),this._setValue(i,"iast.cookieFilterPattern",".{32,}"),this._setValue(i,"iast.dbRowsToTaint",1),this._setValue(i,"iast.deduplicationEnabled",!0),this._setValue(i,"iast.enabled",!1),this._setValue(i,"iast.maxConcurrentRequests",2),this._setValue(i,"iast.maxContextOperations",2),this._setValue(i,"iast.redactionEnabled",!0),this._setValue(i,"iast.redactionNamePattern",null),this._setValue(i,"iast.redactionValuePattern",null),this._setValue(i,"iast.requestSampling",30),this._setValue(i,"iast.telemetryVerbosity","INFORMATION"),this._setValue(i,"iast.stackTrace.enabled",!0),this._setValue(i,"injectionEnabled",[]),this._setValue(i,"isAzureFunction",!1),this._setValue(i,"isCiVisibility",!1),this._setValue(i,"isEarlyFlakeDetectionEnabled",!1),this._setValue(i,"isFlakyTestRetriesEnabled",!1),this._setValue(i,"flakyTestRetriesCount",5),this._setValue(i,"isGCPFunction",!1),this._setValue(i,"isGitUploadEnabled",!1),this._setValue(i,"isIntelligentTestRunnerEnabled",!1),this._setValue(i,"isManualApiEnabled",!1),this._setValue(i,"langchain.spanCharLimit",128),this._setValue(i,"langchain.spanPromptCompletionSampleRate",1),this._setValue(i,"llmobs.agentlessEnabled",!1),this._setValue(i,"llmobs.enabled",!1),this._setValue(i,"llmobs.mlApp",void 0),this._setValue(i,"ciVisibilityTestSessionName",""),this._setValue(i,"ciVisAgentlessLogSubmissionEnabled",!1),this._setValue(i,"legacyBaggageEnabled",!0),this._setValue(i,"isTestDynamicInstrumentationEnabled",!1),this._setValue(i,"logInjection",!1),this._setValue(i,"lookup",void 0),this._setValue(i,"inferredProxyServicesEnabled",!1),this._setValue(i,"memcachedCommandEnabled",!1),this._setValue(i,"middlewareTracingEnabled",!0),this._setValue(i,"openAiLogsEnabled",!1),this._setValue(i,"openai.spanCharLimit",128),this._setValue(i,"peerServiceMapping",{}),this._setValue(i,"plugins",!0),this._setValue(i,"port","8126"),this._setValue(i,"profiling.enabled",void 0),this._setValue(i,"profiling.exporters","agent"),this._setValue(i,"profiling.sourceMap",!0),this._setValue(i,"profiling.longLivedThreshold",void 0),this._setValue(i,"protocolVersion","0.4"),this._setValue(i,"queryStringObfuscation",'(?:p(?:ass)?w(?:or)?d|pass(?:_?phrase)?|secret|(?:api_?|private_?|public_?|access_?|secret_?)key(?:_?id)?|token|consumer_?(?:id|key|secret)|sign(?:ed|ature)?|auth(?:entication|orization)?)(?:(?:\\s|%20)*(?:=|%3D)[^&]+|(?:"|%22)(?:\\s|%20)*(?::|%3A)(?:\\s|%20)*(?:"|%22)(?:%2[^2]|%[^2]|[^"%])+(?:"|%22))|bearer(?:\\s|%20)+[a-z0-9\\._\\-]+|token(?::|%3A)[a-z0-9]{13}|gh[opsu]_[0-9a-zA-Z]{36}|ey[I-L](?:[\\w=-]|%3D)+\\.ey[I-L](?:[\\w=-]|%3D)+(?:\\.(?:[\\w.+\\/=-]|%3D|%2F|%2B)+)?|[\\-]{5}BEGIN(?:[a-z\\s]|%20)+PRIVATE(?:\\s|%20)KEY[\\-]{5}[^\\-]+[\\-]{5}END(?:[a-z\\s]|%20)+PRIVATE(?:\\s|%20)KEY|ssh-rsa(?:\\s|%20)*(?:[a-z0-9\\/\\.+]|%2F|%5C|%2B){100,}'),this._setValue(i,"remoteConfig.enabled",!0),this._setValue(i,"remoteConfig.pollInterval",5),this._setValue(i,"reportHostname",!1),this._setValue(i,"runtimeMetrics",!1),this._setValue(i,"sampleRate",void 0),this._setValue(i,"sampler.rateLimit",100),this._setValue(i,"sampler.rules",[]),this._setValue(i,"sampler.spanSamplingRules",[]),this._setValue(i,"scope",void 0),this._setValue(i,"service",n),this._setValue(i,"serviceMapping",{}),this._setValue(i,"site","datadoghq.com"),this._setValue(i,"spanAttributeSchema","v0"),this._setValue(i,"spanComputePeerService",!1),this._setValue(i,"spanLeakDebug",0),this._setValue(i,"spanRemoveIntegrationFromService",!1),this._setValue(i,"startupLogs",!1),this._setValue(i,"stats.enabled",!1),this._setValue(i,"tags",{}),this._setValue(i,"tagsHeaderMaxLength",512),this._setValue(i,"telemetry.debug",!1),this._setValue(i,"telemetry.dependencyCollection",!0),this._setValue(i,"telemetry.enabled",!0),this._setValue(i,"telemetry.heartbeatInterval",6e4),this._setValue(i,"telemetry.logCollection",!0),this._setValue(i,"telemetry.metrics",!0),this._setValue(i,"traceEnabled",!0),this._setValue(i,"traceId128BitGenerationEnabled",!0),this._setValue(i,"traceId128BitLoggingEnabled",!1),this._setValue(i,"tracePropagationExtractFirst",!1),this._setValue(i,"tracePropagationStyle.inject",["datadog","tracecontext","baggage"]),this._setValue(i,"tracePropagationStyle.extract",["datadog","tracecontext","baggage"]),this._setValue(i,"tracePropagationStyle.otelPropagators",!1),this._setValue(i,"tracing",!0),this._setValue(i,"url",void 0),this._setValue(i,"version",c.version),this._setValue(i,"instrumentation_config_id",void 0),this._setValue(i,"aws.dynamoDb.tablePrimaryKeys",void 0)}_applyEnvironment(){const{AWS_LAMBDA_FUNCTION_NAME:e,DD_AGENT_HOST:t,DD_API_SECURITY_ENABLED:r,DD_API_SECURITY_SAMPLE_DELAY:s,DD_APPSEC_AUTO_USER_INSTRUMENTATION_MODE:n,DD_APPSEC_AUTOMATED_USER_EVENTS_TRACKING:i,DD_APPSEC_ENABLED:o,DD_APPSEC_GRAPHQL_BLOCKED_TEMPLATE_JSON:a,DD_APPSEC_HTTP_BLOCKED_TEMPLATE_HTML:c,DD_APPSEC_HTTP_BLOCKED_TEMPLATE_JSON:p,DD_APPSEC_MAX_STACK_TRACES:d,DD_APPSEC_MAX_STACK_TRACE_DEPTH:h,DD_APPSEC_OBFUSCATION_PARAMETER_KEY_REGEXP:m,DD_APPSEC_OBFUSCATION_PARAMETER_VALUE_REGEXP:_,DD_APPSEC_RULES:y,DD_APPSEC_SCA_ENABLED:b,DD_APPSEC_STACK_TRACE_ENABLED:v,DD_APPSEC_RASP_ENABLED:E,DD_APPSEC_TRACE_RATE_LIMIT:w,DD_APPSEC_WAF_TIMEOUT:x,DD_AWS_SDK_DYNAMODB_TABLE_PRIMARY_KEYS:A,DD_CRASHTRACKING_ENABLED:I,DD_CODE_ORIGIN_FOR_SPANS_ENABLED:k,DD_DATA_STREAMS_ENABLED:O,DD_DBM_PROPAGATION_MODE:R,DD_DOGSTATSD_HOSTNAME:C,DD_DOGSTATSD_HOST:N,DD_DOGSTATSD_PORT:P,DD_DYNAMIC_INSTRUMENTATION_ENABLED:L,DD_DYNAMIC_INSTRUMENTATION_REDACTED_IDENTIFIERS:q,DD_DYNAMIC_INSTRUMENTATION_REDACTION_EXCLUDED_IDENTIFIERS:F,DD_ENV:B,DD_EXPERIMENTAL_API_SECURITY_ENABLED:G,DD_EXPERIMENTAL_APPSEC_STANDALONE_ENABLED:V,DD_EXPERIMENTAL_PROFILING_ENABLED:z,DD_GRPC_CLIENT_ERROR_STATUSES:Q,DD_GRPC_SERVER_ERROR_STATUSES:Z,JEST_WORKER_ID:J,DD_IAST_COOKIE_FILTER_PATTERN:X,DD_IAST_DB_ROWS_TO_TAINT:ee,DD_IAST_DEDUPLICATION_ENABLED:te,DD_IAST_ENABLED:re,DD_IAST_MAX_CONCURRENT_REQUESTS:se,DD_IAST_MAX_CONTEXT_OPERATIONS:ne,DD_IAST_REDACTION_ENABLED:ie,DD_IAST_REDACTION_NAME_PATTERN:oe,DD_IAST_REDACTION_VALUE_PATTERN:ae,DD_IAST_REQUEST_SAMPLING:ce,DD_IAST_TELEMETRY_VERBOSITY:ue,DD_IAST_STACK_TRACE_ENABLED:le,DD_INJECTION_ENABLED:pe,DD_INSTRUMENTATION_TELEMETRY_ENABLED:de,DD_INSTRUMENTATION_CONFIG_ID:he,DD_LOGS_INJECTION:fe,DD_LANGCHAIN_SPAN_CHAR_LIMIT:ge,DD_LANGCHAIN_SPAN_PROMPT_COMPLETION_SAMPLE_RATE:me,DD_LLMOBS_AGENTLESS_ENABLED:_e,DD_LLMOBS_ENABLED:ye,DD_LLMOBS_ML_APP:be,DD_OPENAI_LOGS_ENABLED:ve,DD_OPENAI_SPAN_CHAR_LIMIT:Ee,DD_PROFILING_ENABLED:Se,DD_PROFILING_EXPORTERS:Te,DD_PROFILING_SOURCE_MAP:we,DD_INTERNAL_PROFILING_LONG_LIVED_THRESHOLD:xe,DD_REMOTE_CONFIGURATION_ENABLED:Ae,DD_REMOTE_CONFIG_POLL_INTERVAL_SECONDS:Ie,DD_RUNTIME_METRICS_ENABLED:ke,DD_SERVICE:Oe,DD_SERVICE_MAPPING:Re,DD_SERVICE_NAME:Ce,DD_SITE:Ne,DD_SPAN_SAMPLING_RULES:Pe,DD_SPAN_SAMPLING_RULES_FILE:De,DD_TAGS:Le,DD_TELEMETRY_DEBUG:Me,DD_TELEMETRY_DEPENDENCY_COLLECTION_ENABLED:qe,DD_TELEMETRY_HEARTBEAT_INTERVAL:je,DD_TELEMETRY_LOG_COLLECTION_ENABLED:Ue,DD_TELEMETRY_METRICS_ENABLED:Fe,DD_TRACE_128_BIT_TRACEID_GENERATION_ENABLED:Be,DD_TRACE_128_BIT_TRACEID_LOGGING_ENABLED:$e,DD_TRACE_AGENT_HOSTNAME:Ge,DD_TRACE_AGENT_PORT:Ve,DD_TRACE_AGENT_PROTOCOL_VERSION:ze,DD_TRACE_BAGGAGE_MAX_BYTES:He,DD_TRACE_BAGGAGE_MAX_ITEMS:Ke,DD_TRACE_CLIENT_IP_ENABLED:Ye,DD_TRACE_CLIENT_IP_HEADER:Qe,DD_TRACE_ENABLED:We,DD_TRACE_EXPERIMENTAL_EXPORTER:Ze,DD_TRACE_EXPERIMENTAL_GET_RUM_DATA_ENABLED:Je,DD_TRACE_EXPERIMENTAL_RUNTIME_ID_ENABLED:Xe,DD_TRACE_GIT_METADATA_ENABLED:et,DD_TRACE_GLOBAL_TAGS:tt,DD_TRACE_GRAPHQL_ERROR_EXTENSIONS:rt,DD_TRACE_HEADER_TAGS:st,DD_TRACE_LEGACY_BAGGAGE_ENABLED:nt,DD_TRACE_MEMCACHED_COMMAND_ENABLED:it,DD_TRACE_MIDDLEWARE_TRACING_ENABLED:ot,DD_TRACE_OBFUSCATION_QUERY_STRING_REGEXP:at,DD_TRACE_PARTIAL_FLUSH_MIN_SPANS:ct,DD_TRACE_PEER_SERVICE_MAPPING:ut,DD_TRACE_PROPAGATION_EXTRACT_FIRST:lt,DD_TRACE_PROPAGATION_STYLE:pt,DD_TRACE_PROPAGATION_STYLE_INJECT:dt,DD_TRACE_PROPAGATION_STYLE_EXTRACT:ht,DD_TRACE_RATE_LIMIT:ft,DD_TRACE_REMOVE_INTEGRATION_SERVICE_NAMES_ENABLED:gt,DD_TRACE_REPORT_HOSTNAME:mt,DD_TRACE_SAMPLE_RATE:_t,DD_TRACE_SAMPLING_RULES:yt,DD_TRACE_SCOPE:bt,DD_TRACE_SPAN_ATTRIBUTE_SCHEMA:vt,DD_TRACE_SPAN_LEAK_DEBUG:Et,DD_TRACE_STARTUP_LOGS:St,DD_TRACE_TAGS:Tt,DD_TRACE_TELEMETRY_ENABLED:wt,DD_TRACE_X_DATADOG_TAGS_MAX_LENGTH:xt,DD_TRACING_ENABLED:At,DD_VERSION:It,DD_TRACE_INFERRED_PROXY_SERVICES_ENABLED:kt,OTEL_METRICS_EXPORTER:Ot,OTEL_PROPAGATORS:Rt,OTEL_RESOURCE_ATTRIBUTES:Ct,OTEL_SERVICE_NAME:Nt,OTEL_TRACES_SAMPLER:Pt,OTEL_TRACES_SAMPLER_ARG:Dt}=process.env,Lt={},Mt=W(this,"_env",{});W(this,"_envUnprocessed",{}),l.add(Lt,Ct,!0),l.add(Lt,Le),l.add(Lt,Tt),l.add(Lt,tt),this._setBoolean(Mt,"appsec.apiSecurity.enabled",u(r&&f(r),G&&f(G))),this._setValue(Mt,"appsec.apiSecurity.sampleDelay",Y(s)),this._setValue(Mt,"appsec.blockedTemplateGraphql",j(a)),this._setValue(Mt,"appsec.blockedTemplateHtml",j(c)),this._envUnprocessed["appsec.blockedTemplateHtml"]=c,this._setValue(Mt,"appsec.blockedTemplateJson",j(p)),this._envUnprocessed["appsec.blockedTemplateJson"]=p,this._setBoolean(Mt,"appsec.enabled",o),this._setString(Mt,"appsec.eventTracking.mode",u(n,i)),this._setString(Mt,"appsec.obfuscatorKeyRegex",m),this._setString(Mt,"appsec.obfuscatorValueRegex",_),this._setBoolean(Mt,"appsec.rasp.enabled",E),this._setValue(Mt,"appsec.rateLimit",K(w)),this._envUnprocessed["appsec.rateLimit"]=w,this._setString(Mt,"appsec.rules",y),this._setBoolean(Mt,"appsec.sca.enabled",b),this._setBoolean(Mt,"appsec.standalone.enabled",V),this._setBoolean(Mt,"appsec.stackTrace.enabled",v),this._setValue(Mt,"appsec.stackTrace.maxDepth",K(h)),this._envUnprocessed["appsec.stackTrace.maxDepth"]=h,this._setValue(Mt,"appsec.stackTrace.maxStackTraces",K(d)),this._envUnprocessed["appsec.stackTrace.maxStackTraces"]=d,this._setValue(Mt,"appsec.wafTimeout",K(x)),this._envUnprocessed["appsec.wafTimeout"]=x,this._setValue(Mt,"baggageMaxBytes",He),this._setValue(Mt,"baggageMaxItems",Ke),this._setBoolean(Mt,"clientIpEnabled",Ye),this._setString(Mt,"clientIpHeader",Qe),this._setBoolean(Mt,"crashtracking.enabled",I),this._setBoolean(Mt,"codeOriginForSpans.enabled",k),this._setString(Mt,"dbmPropagationMode",R),this._setString(Mt,"dogstatsd.hostname",N||C),this._setString(Mt,"dogstatsd.port",P),this._setBoolean(Mt,"dsmEnabled",O),this._setBoolean(Mt,"dynamicInstrumentation.enabled",L),this._setArray(Mt,"dynamicInstrumentation.redactedIdentifiers",q),this._setArray(Mt,"dynamicInstrumentation.redactionExcludedIdentifiers",F),this._setString(Mt,"env",B||Lt.env),this._setBoolean(Mt,"traceEnabled",We),this._setBoolean(Mt,"experimental.enableGetRumData",Je),this._setString(Mt,"experimental.exporter",Ze),this._setBoolean(Mt,"experimental.runtimeId",Xe),e&&this._setValue(Mt,"flushInterval",0),this._setValue(Mt,"flushMinSpans",K(ct)),this._envUnprocessed.flushMinSpans=ct,this._setBoolean(Mt,"gitMetadataEnabled",et),this._setIntegerRangeSet(Mt,"grpc.client.error.statuses",Q),this._setIntegerRangeSet(Mt,"grpc.server.error.statuses",Z),this._setArray(Mt,"headerTags",st),this._setString(Mt,"hostname",u(t,Ge)),this._setString(Mt,"iast.cookieFilterPattern",X),this._setValue(Mt,"iast.dbRowsToTaint",K(ee)),this._setBoolean(Mt,"iast.deduplicationEnabled",te),this._setBoolean(Mt,"iast.enabled",re),this._setValue(Mt,"iast.maxConcurrentRequests",K(se)),this._envUnprocessed["iast.maxConcurrentRequests"]=se,this._setValue(Mt,"iast.maxContextOperations",K(ne)),this._envUnprocessed["iast.maxContextOperations"]=ne,this._setBoolean(Mt,"iast.redactionEnabled",ie&&!g(ie)),this._setString(Mt,"iast.redactionNamePattern",oe),this._setString(Mt,"iast.redactionValuePattern",ae);const qt=K(ce);qt>-1&&qt<101&&this._setValue(Mt,"iast.requestSampling",qt),this._envUnprocessed["iast.requestSampling"]=ce,this._setString(Mt,"iast.telemetryVerbosity",ue),this._setBoolean(Mt,"iast.stackTrace.enabled",le),this._setArray(Mt,"injectionEnabled",pe),this._setBoolean(Mt,"isAzureFunction",T()),this._setBoolean(Mt,"isGCPFunction",S()),this._setValue(Mt,"langchain.spanCharLimit",K(ge)),this._setValue(Mt,"langchain.spanPromptCompletionSampleRate",Y(me)),this._setBoolean(Mt,"legacyBaggageEnabled",nt),this._setBoolean(Mt,"llmobs.agentlessEnabled",_e),this._setBoolean(Mt,"llmobs.enabled",ye),this._setString(Mt,"llmobs.mlApp",be),this._setBoolean(Mt,"logInjection",fe),this._setBoolean(Mt,"memcachedCommandEnabled",it),this._setBoolean(Mt,"middlewareTracingEnabled",ot),this._setBoolean(Mt,"openAiLogsEnabled",ve),this._setValue(Mt,"openai.spanCharLimit",K(Ee)),this._envUnprocessed.openaiSpanCharLimit=Ee,ut&&(this._setValue(Mt,"peerServiceMapping",M(ut.split(",").map((e=>e.trim().split(":"))))),this._envUnprocessed.peerServiceMapping=ut),this._setString(Mt,"port",Ve);const jt=u(z,Se),Ut=f(jt)?"true":g(jt)?"false":"auto"===jt?"auto":void 0;this._setString(Mt,"profiling.enabled",Ut),this._setString(Mt,"profiling.exporters",Te),this._setBoolean(Mt,"profiling.sourceMap",we&&!g(we)),xe&&this._setValue(Mt,"profiling.longLivedThreshold",Number(xe)),this._setString(Mt,"protocolVersion",ze),this._setString(Mt,"queryStringObfuscation",at),this._setBoolean(Mt,"remoteConfig.enabled",u(Ae,!this._isInServerlessEnvironment())),this._setValue(Mt,"remoteConfig.pollInterval",Y(Ie)),this._envUnprocessed["remoteConfig.pollInterval"]=Ie,this._setBoolean(Mt,"reportHostname",mt);const Ft="none"!==String(Ot).toLowerCase()&&void 0;this._setBoolean(Mt,"runtimeMetrics",ke||Ft),this._setArray(Mt,"sampler.spanSamplingRules",H(u(U(j(De)),U(Pe)))),this._setUnit(Mt,"sampleRate",_t||D(Pt,Dt)),this._setValue(Mt,"sampler.rateLimit",ft),this._setSamplingRule(Mt,"sampler.rules",U(yt)),this._envUnprocessed["sampler.rules"]=yt,this._setString(Mt,"scope",bt),this._setString(Mt,"service",Oe||Ce||Lt.service||Nt),Re&&this._setValue(Mt,"serviceMapping",M(process.env.DD_SERVICE_MAPPING.split(",").map((e=>e.trim().split(":"))))),this._setString(Mt,"site",Ne),vt&&(this._setString(Mt,"spanAttributeSchema",$(vt)),this._envUnprocessed.spanAttributeSchema=vt),this._setValue(Mt,"spanLeakDebug",K(Et)),this._setBoolean(Mt,"spanRemoveIntegrationFromService",gt),this._setBoolean(Mt,"startupLogs",St),this._setTags(Mt,"tags",Lt),this._setValue(Mt,"tagsHeaderMaxLength",xt),this._setBoolean(Mt,"telemetry.enabled",u(wt,de,!(this._isInServerlessEnvironment()||J))),this._setString(Mt,"instrumentation_config_id",he),this._setBoolean(Mt,"telemetry.debug",Me),this._setBoolean(Mt,"telemetry.dependencyCollection",qe),this._setValue(Mt,"telemetry.heartbeatInterval",K(Math.floor(1e3*je))),this._envUnprocessed["telemetry.heartbeatInterval"]=1e3*je,this._setBoolean(Mt,"telemetry.logCollection",Ue),this._setBoolean(Mt,"telemetry.metrics",Fe),this._setBoolean(Mt,"traceId128BitGenerationEnabled",Be),this._setBoolean(Mt,"traceId128BitLoggingEnabled",$e),this._setBoolean(Mt,"tracePropagationExtractFirst",lt),this._setBoolean(Mt,"tracePropagationStyle.otelPropagators",!(pt||dt||ht||!Rt)),this._setBoolean(Mt,"tracing",At),this._setString(Mt,"version",It||Lt.version),this._setBoolean(Mt,"inferredProxyServicesEnabled",kt),this._setString(Mt,"aws.dynamoDb.tablePrimaryKeys",A),this._setArray(Mt,"graphqlErrorExtensions",rt)}_applyOptions(e){const t=W(this,"_options",this._options||{}),r={};W(this,"_optsUnprocessed",{}),e=W(this,"_optionsArg",Object.assign({ingestion:{}},e,t)),l.add(r,e.tags),this._setBoolean(t,"appsec.apiSecurity.enabled",e.appsec.apiSecurity?.enabled),this._setValue(t,"appsec.blockedTemplateGraphql",j(e.appsec.blockedTemplateGraphql)),this._setValue(t,"appsec.blockedTemplateHtml",j(e.appsec.blockedTemplateHtml)),this._optsUnprocessed["appsec.blockedTemplateHtml"]=e.appsec.blockedTemplateHtml,this._setValue(t,"appsec.blockedTemplateJson",j(e.appsec.blockedTemplateJson)),this._optsUnprocessed["appsec.blockedTemplateJson"]=e.appsec.blockedTemplateJson,this._setBoolean(t,"appsec.enabled",e.appsec.enabled),this._setString(t,"appsec.eventTracking.mode",e.appsec.eventTracking?.mode),this._setString(t,"appsec.obfuscatorKeyRegex",e.appsec.obfuscatorKeyRegex),this._setString(t,"appsec.obfuscatorValueRegex",e.appsec.obfuscatorValueRegex),this._setBoolean(t,"appsec.rasp.enabled",e.appsec.rasp?.enabled),this._setValue(t,"appsec.rateLimit",K(e.appsec.rateLimit)),this._optsUnprocessed["appsec.rateLimit"]=e.appsec.rateLimit,this._setString(t,"appsec.rules",e.appsec.rules),this._setBoolean(t,"appsec.standalone.enabled",e.experimental?.appsec?.standalone?.enabled),this._setBoolean(t,"appsec.stackTrace.enabled",e.appsec.stackTrace?.enabled),this._setValue(t,"appsec.stackTrace.maxDepth",K(e.appsec.stackTrace?.maxDepth)),this._optsUnprocessed["appsec.stackTrace.maxDepth"]=e.appsec.stackTrace?.maxDepth,this._setValue(t,"appsec.stackTrace.maxStackTraces",K(e.appsec.stackTrace?.maxStackTraces)),this._optsUnprocessed["appsec.stackTrace.maxStackTraces"]=e.appsec.stackTrace?.maxStackTraces,this._setValue(t,"appsec.wafTimeout",K(e.appsec.wafTimeout)),this._optsUnprocessed["appsec.wafTimeout"]=e.appsec.wafTimeout,this._setBoolean(t,"clientIpEnabled",e.clientIpEnabled),this._setString(t,"clientIpHeader",e.clientIpHeader),this._setValue(t,"baggageMaxBytes",e.baggageMaxBytes),this._setValue(t,"baggageMaxItems",e.baggageMaxItems),this._setBoolean(t,"codeOriginForSpans.enabled",e.codeOriginForSpans?.enabled),this._setString(t,"dbmPropagationMode",e.dbmPropagationMode),e.dogstatsd&&(this._setString(t,"dogstatsd.hostname",e.dogstatsd.hostname),this._setString(t,"dogstatsd.port",e.dogstatsd.port)),this._setBoolean(t,"dsmEnabled",e.dsmEnabled),this._setBoolean(t,"dynamicInstrumentation.enabled",e.dynamicInstrumentation?.enabled),this._setArray(t,"dynamicInstrumentation.redactedIdentifiers",e.dynamicInstrumentation?.redactedIdentifiers),this._setArray(t,"dynamicInstrumentation.redactionExcludedIdentifiers",e.dynamicInstrumentation?.redactionExcludedIdentifiers),this._setString(t,"env",e.env||r.env),this._setBoolean(t,"experimental.enableGetRumData",e.experimental?.enableGetRumData),this._setString(t,"experimental.exporter",e.experimental?.exporter),this._setBoolean(t,"experimental.runtimeId",e.experimental?.runtimeId),this._setValue(t,"flushInterval",K(e.flushInterval)),this._optsUnprocessed.flushInterval=e.flushInterval,this._setValue(t,"flushMinSpans",K(e.flushMinSpans)),this._optsUnprocessed.flushMinSpans=e.flushMinSpans,this._setArray(t,"headerTags",e.headerTags),this._setString(t,"hostname",e.hostname),this._setString(t,"iast.cookieFilterPattern",e.iast?.cookieFilterPattern),this._setValue(t,"iast.dbRowsToTaint",K(e.iast?.dbRowsToTaint)),this._setBoolean(t,"iast.deduplicationEnabled",e.iast&&e.iast.deduplicationEnabled),this._setBoolean(t,"iast.enabled",e.iast&&(!0===e.iast||!0===e.iast.enabled)),this._setValue(t,"iast.maxConcurrentRequests",K(e.iast?.maxConcurrentRequests)),this._optsUnprocessed["iast.maxConcurrentRequests"]=e.iast?.maxConcurrentRequests,this._setValue(t,"iast.maxContextOperations",K(e.iast?.maxContextOperations)),this._optsUnprocessed["iast.maxContextOperations"]=e.iast?.maxContextOperations,this._setBoolean(t,"iast.redactionEnabled",e.iast?.redactionEnabled),this._setString(t,"iast.redactionNamePattern",e.iast?.redactionNamePattern),this._setString(t,"iast.redactionValuePattern",e.iast?.redactionValuePattern);const s=K(e.iast?.requestSampling);s>-1&&s<101&&(this._setValue(t,"iast.requestSampling",s),this._optsUnprocessed["iast.requestSampling"]=e.iast?.requestSampling),this._setString(t,"iast.telemetryVerbosity",e.iast&&e.iast.telemetryVerbosity),this._setBoolean(t,"iast.stackTrace.enabled",e.iast?.stackTrace?.enabled),this._setBoolean(t,"isCiVisibility",e.isCiVisibility),this._setBoolean(t,"legacyBaggageEnabled",e.legacyBaggageEnabled),this._setBoolean(t,"llmobs.agentlessEnabled",e.llmobs?.agentlessEnabled),this._setString(t,"llmobs.mlApp",e.llmobs?.mlApp),this._setBoolean(t,"logInjection",e.logInjection),this._setString(t,"lookup",e.lookup),this._setBoolean(t,"middlewareTracingEnabled",e.middlewareTracingEnabled),this._setBoolean(t,"openAiLogsEnabled",e.openAiLogsEnabled),this._setValue(t,"peerServiceMapping",e.peerServiceMapping),this._setBoolean(t,"plugins",e.plugins),this._setString(t,"port",e.port);const n=String(e.profiling);["true","false","auto"].includes(n)&&this._setString(t,"profiling.enabled",n),this._setString(t,"protocolVersion",e.protocolVersion),e.remoteConfig&&(this._setValue(t,"remoteConfig.pollInterval",Y(e.remoteConfig.pollInterval)),this._optsUnprocessed["remoteConfig.pollInterval"]=e.remoteConfig.pollInterval),this._setBoolean(t,"reportHostname",e.reportHostname),this._setBoolean(t,"runtimeMetrics",e.runtimeMetrics),this._setArray(t,"sampler.spanSamplingRules",H(e.spanSamplingRules)),this._setUnit(t,"sampleRate",u(e.sampleRate,e.ingestion.sampleRate));const i=e.ingestion||{};this._setValue(t,"sampler.rateLimit",u(e.rateLimit,i.rateLimit)),this._setSamplingRule(t,"sampler.rules",e.samplingRules),this._setString(t,"service",e.service||r.service),this._setValue(t,"serviceMapping",e.serviceMapping),this._setString(t,"site",e.site),e.spanAttributeSchema&&(this._setString(t,"spanAttributeSchema",$(e.spanAttributeSchema)),this._optsUnprocessed.spanAttributeSchema=e.spanAttributeSchema),this._setBoolean(t,"spanRemoveIntegrationFromService",e.spanRemoveIntegrationFromService),this._setBoolean(t,"startupLogs",e.startupLogs),this._setTags(t,"tags",r),this._setBoolean(t,"traceId128BitGenerationEnabled",e.traceId128BitGenerationEnabled),this._setBoolean(t,"traceId128BitLoggingEnabled",e.traceId128BitLoggingEnabled),this._setString(t,"version",e.version||r.version),this._setBoolean(t,"inferredProxyServicesEnabled",e.inferredProxyServicesEnabled),this._setBoolean(t,"graphqlErrorExtensions",e.graphqlErrorExtensions),null==this._env["llmobs.enabled"]&&e.llmobs&&this._setBoolean(t,"llmobs.enabled",!!e.llmobs)}_isCiVisibility(){return u(this._optionsArg.isCiVisibility,this._defaults.isCiVisibility)}_isCiVisibilityItrEnabled(){return u(process.env.DD_CIVISIBILITY_ITR_ENABLED,!0)}_getHostname(){const e=process.env.DD_CIVISIBILITY_AGENTLESS_URL,t=e?new o(e):Q(this._getTraceAgentUrl(),this._optionsArg);return u(this._optionsArg.hostname,process.env.DD_AGENT_HOST,process.env.DD_TRACE_AGENT_HOSTNAME,"127.0.0.1")||t&&t.hostname}_getSpanComputePeerService(){const e=$(u(this._optionsArg.spanAttributeSchema,process.env.DD_TRACE_SPAN_ATTRIBUTE_SCHEMA)),t=this._optionsArg.hasOwnProperty("spanComputePeerService")||process.env.hasOwnProperty("DD_TRACE_PEER_SERVICE_DEFAULTS_ENABLED"),r=u(this._optionsArg.spanComputePeerService,process.env.DD_TRACE_PEER_SERVICE_DEFAULTS_ENABLED);return"v0"===e?t&&f(r):!t||!g(r)}_isCiVisibilityGitUploadEnabled(){return u(process.env.DD_CIVISIBILITY_GIT_UPLOAD_ENABLED,!0)}_isCiVisibilityManualApiEnabled(){return u(process.env.DD_CIVISIBILITY_MANUAL_API_ENABLED,!0)}_isTraceStatsComputationEnabled(){return u(this._optionsArg.stats,process.env.DD_TRACE_STATS_COMPUTATION_ENABLED,S()||T())}_getTraceAgentUrl(){return u(this._optionsArg.url,process.env.DD_TRACE_AGENT_URL,process.env.DD_TRACE_URL,null)}_applyCalculated(){const e=W(this,"_calculated",{}),{DD_CIVISIBILITY_AGENTLESS_URL:t,DD_CIVISIBILITY_EARLY_FLAKE_DETECTION_ENABLED:r,DD_CIVISIBILITY_FLAKY_RETRY_ENABLED:s,DD_CIVISIBILITY_FLAKY_RETRY_COUNT:n,DD_TEST_SESSION_NAME:i,DD_AGENTLESS_LOG_SUBMISSION_ENABLED:a,DD_TEST_DYNAMIC_INSTRUMENTATION_ENABLED:c}=process.env;t?this._setValue(e,"url",new o(t)):this._setValue(e,"url",Q(this._getTraceAgentUrl(),this._optionsArg)),this._isCiVisibility()&&(this._setBoolean(e,"isEarlyFlakeDetectionEnabled",u(r,!0)),this._setBoolean(e,"isFlakyTestRetriesEnabled",u(s,!0)),this._setValue(e,"flakyTestRetriesCount",u(K(n),5)),this._setBoolean(e,"isIntelligentTestRunnerEnabled",f(this._isCiVisibilityItrEnabled())),this._setBoolean(e,"isManualApiEnabled",!g(this._isCiVisibilityManualApiEnabled())),this._setString(e,"ciVisibilityTestSessionName",i),this._setBoolean(e,"ciVisAgentlessLogSubmissionEnabled",f(a)),this._setBoolean(e,"isTestDynamicInstrumentationEnabled",f(c))),this._setString(e,"dogstatsd.hostname",this._getHostname()),this._setBoolean(e,"isGitUploadEnabled",e.isIntelligentTestRunnerEnabled&&!g(this._isCiVisibilityGitUploadEnabled())),this._setBoolean(e,"spanComputePeerService",this._getSpanComputePeerService()),this._setBoolean(e,"stats.enabled",this._isTraceStatsComputationEnabled());const l=this._getDefaultPropagationStyle(this._optionsArg);this._setValue(e,"tracePropagationStyle.inject",z("inject",this._optionsArg.tracePropagationStyle)),this._setValue(e,"tracePropagationStyle.extract",z("extract",this._optionsArg.tracePropagationStyle)),l.length>2&&(e["tracePropagationStyle.inject"]=e["tracePropagationStyle.inject"]||l,e["tracePropagationStyle.extract"]=e["tracePropagationStyle.extract"]||l)}_applyRemote(e){const t=W(this,"_remote",this._remote||{});W(this,"_remoteUnprocessed",{});const r={},s=e.tracing_header_tags?e.tracing_header_tags.map((e=>e.tag_name?`${e.header}:${e.tag_name}`:e.header)):void 0;l.add(r,e.tracing_tags),Object.keys(r).length&&(r["runtime-id"]=q),this._setUnit(t,"sampleRate",e.tracing_sampling_rate),this._setBoolean(t,"logInjection",e.log_injection_enabled),this._setArray(t,"headerTags",s),this._setTags(t,"tags",r),this._setBoolean(t,"tracing",e.tracing_enabled),this._remoteUnprocessed["sampler.rules"]=e.tracing_sampling_rules,this._setSamplingRule(t,"sampler.rules",this._reformatTags(e.tracing_sampling_rules))}_reformatTags(e){for(const t of e||[]){const e={};if(t.tags){for(const r of t.tags||{})e[r.key]=r.value_glob;t.tags=e}}return e}_setBoolean(e,t,r){null==r?this._setValue(e,t,r):f(r)?this._setValue(e,t,!0):g(r)&&this._setValue(e,t,!1)}_setUnit(e,t,r){if(null==r)return this._setValue(e,t,r);r=parseFloat(r),isNaN(r)||this._setValue(e,t,Math.min(Math.max(r,0),1))}_setArray(e,t,r){if(null==r)return this._setValue(e,t,null);"string"==typeof r&&(r=r.split(",").map((e=>{const[t,r]=e.split(":").map((e=>e.trim()));return void 0!==r?`${t}:${r}`:t}))),Array.isArray(r)&&this._setValue(e,t,r)}_setIntegerRangeSet(e,t,r){if(null==r)return this._setValue(e,t,null);r=r.split(",");const s=[];r.forEach((e=>{if(e.includes("-")){const[t,r]=e.split("-").map(Number);for(let e=t;e<=r;e++)s.push(e)}else s.push(Number(e))})),this._setValue(e,t,s)}_setSamplingRule(e,t,r){if(null==r)return this._setValue(e,t,null);"string"==typeof r&&(r=r.split(",")),Array.isArray(r)&&(r=r.map((e=>V(e,{sample_rate:"sampleRate"}))),this._setValue(e,t,r))}_setString(e,t,r){e[t]=r?String(r):void 0}_setTags(e,t,r){if(!r||0===Object.keys(r).length)return this._setValue(e,t,null);this._setValue(e,t,r)}_setValue(e,t,r){e[t]=r}_merge(){const e=[this._remote,this._options,this._env,this._calculated,this._defaults],t=["remote_config","code","env_var","calculated","default"],r=[this._remoteUnprocessed,this._optsUnprocessed,this._envUnprocessed,{},{}],s=[];for(const n in this._defaults)for(let i=0;i<e.length;i++){const o=e[i],a=o[n];if(null!=a||o===this._defaults){if(p(this,n)===a&&d(this,n))break;h(this,n,a),s.push({name:n,value:r[i][n]||a,origin:t[i]});break}}this.sampler.sampleRate=this.sampleRate,v(s,this)}serialize(){if(this.url instanceof o){const e={...this};return e.url=this.url.toString(),e}return this}}},23636:e=>{"use strict";e.exports={SAMPLING_PRIORITY_KEY:"_sampling_priority_v1",ANALYTICS_KEY:"_dd1.sr.eausr",ORIGIN_KEY:"_dd.origin",HOSTNAME_KEY:"_dd.hostname",TOP_LEVEL_KEY:"_dd.top_level",SAMPLING_RULE_DECISION:"_dd.rule_psr",SAMPLING_LIMIT_DECISION:"_dd.limit_psr",SAMPLING_AGENT_DECISION:"_dd.agent_psr",SAMPLING_MECHANISM_DEFAULT:0,SAMPLING_MECHANISM_AGENT:1,SAMPLING_MECHANISM_RULE:3,SAMPLING_MECHANISM_MANUAL:4,SAMPLING_MECHANISM_APPSEC:5,SAMPLING_MECHANISM_SPAN:8,SAMPLING_MECHANISM_REMOTE_USER:11,SAMPLING_MECHANISM_REMOTE_DYNAMIC:12,SPAN_SAMPLING_MECHANISM:"_dd.span_sampling.mechanism",SPAN_SAMPLING_RULE_RATE:"_dd.span_sampling.rule_rate",SPAN_SAMPLING_MAX_PER_SECOND:"_dd.span_sampling.max_per_second",DATADOG_LAMBDA_EXTENSION_PATH:"/opt/extensions/datadog-agent",DECISION_MAKER_KEY:"_dd.p.dm",PROCESS_ID:"process_id",ERROR_TYPE:"error.type",ERROR_MESSAGE:"error.message",ERROR_STACK:"error.stack",COMPONENT:"component",CLIENT_PORT_KEY:"network.destination.port",PEER_SERVICE_KEY:"peer.service",PEER_SERVICE_SOURCE_KEY:"_dd.peer.service.source",PEER_SERVICE_REMAP_KEY:"_dd.peer.service.remapped_from",SCI_REPOSITORY_URL:"_dd.git.repository_url",SCI_COMMIT_SHA:"_dd.git.commit.sha",APM_TRACING_ENABLED_KEY:"_dd.apm.enabled",APPSEC_PROPAGATION_KEY:"_dd.p.appsec",PAYLOAD_TAG_REQUEST_PREFIX:"aws.request.body",PAYLOAD_TAG_RESPONSE_PREFIX:"aws.response.body",PAYLOAD_TAGGING_MAX_TAGS:758,SCHEMA_DEFINITION:"schema.definition",SCHEMA_WEIGHT:"schema.weight",SCHEMA_TYPE:"schema.type",SCHEMA_ID:"schema.id",SCHEMA_TOPIC:"schema.topic",SCHEMA_OPERATION:"schema.operation",SCHEMA_NAME:"schema.name",GRPC_CLIENT_ERROR_STATUSES:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],GRPC_SERVER_ERROR_STATUSES:[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],DYNAMODB_PTR_KIND:"aws.dynamodb.item",S3_PTR_KIND:"aws.s3.object",SPAN_POINTER_DIRECTION:Object.freeze({UPSTREAM:"u",DOWNSTREAM:"d"})}},65459:(e,t,r)=>{"use strict";const s=r(3971),n=s.load("crashtracker"),i=r(75004),{URL:o}=r(87016),a=r(8330);e.exports=new class{constructor(){this._started=!1}configure(e){if(this._started)try{n.updateConfig(this._getConfig(e)),n.updateMetadata(this._getMetadata(e))}catch(e){i.error("Error configuring crashtracker",e)}}start(e){if(this._started)return this.configure(e);this._started=!0;try{n.init(this._getConfig(e),this._getReceiverConfig(e),this._getMetadata(e))}catch(e){i.error("Error initialising crashtracker",e)}}withProfilerSerializing(e){n.beginProfilerSerializing();try{return e()}finally{n.endProfilerSerializing()}}_getConfig(e){const{hostname:t="127.0.0.1",port:r=8126}=e,s=e.url||new o(`http://${t}:${r}`);return{additional_files:[],create_alt_stack:!0,use_alt_stack:!0,endpoint:{url:{scheme:s.protocol.slice(0,-1),authority:"unix:"===s.protocol?Buffer.from(s.pathname).toString("hex"):s.host,path_and_query:""},timeout_ms:3e3},timeout_ms:5e3,resolve_frames:"EnabledWithInprocessSymbols"}}_getMetadata(e){const t=Object.keys(e.tags).map((t=>`${t}:${e.tags[t]}`));return{library_name:a.name,library_version:a.version,family:"nodejs",tags:[...t,"is_crash:true","language:javascript",`library_version:${a.version}`,"runtime:nodejs",`runtime_version:${process.versions.node}`,"severity:crash"]}}_getReceiverConfig(){return{args:[],env:[],path_to_receiver_binary:s.find("crashtracker-receiver",!0),stderr_filename:null,stdout_filename:null}}}},53928:(e,t,r)=>{"use strict";const{isMainThread:s}=r(28167),n=r(75004);if(s)try{e.exports=r(65459)}catch(t){n.warn(t.message),e.exports=r(70798)}else e.exports=r(70798)},70798:e=>{"use strict";e.exports=new class{configure(){}start(){}withProfilerSerializing(e){return e()}}},15135:(e,t,r)=>{const s=r(61931);e.exports={DataStreamsCheckpointer:class{constructor(e){this.tracer=e,this.config=e._config,this.dsmProcessor=e._dataStreamsProcessor}setProduceCheckpoint(e,t,r){if(!this.config.dsmEnabled)return;const n=this.dsmProcessor.setCheckpoint(["type:"+e,"topic:"+t,"direction:out","manual_checkpoint:true"],null,s.getDataStreamsContext(),null);s.setDataStreamsContext(n),this.tracer.inject(n,"text_map_dsm",r)}setConsumeCheckpoint(e,t,r){if(!this.config.dsmEnabled)return;const n=this.tracer.extract("text_map_dsm",r);s.setDataStreamsContext(n);const i=this.dsmProcessor.setCheckpoint(["type:"+e,"topic:"+t,"direction:in","manual_checkpoint:true"],null,n,null);return s.setDataStreamsContext(i),i}}}},61931:(e,t,r)=>{const{storage:s}=r(96882),n=r(75004);e.exports={getDataStreamsContext:function(){const e=s.getStore();return e&&e.dataStreamsContext||null},setDataStreamsContext:function(e){n.debug((()=>`Setting new DSM Context: ${JSON.stringify(e)}.`)),e&&s.enterWith({...s.getStore(),dataStreamsContext:e})}}},58046:e=>{e.exports={encodeVarint:function(e){const t=e>=0?0:1,r=2*Math.abs(e);if(!(r>Number.MAX_SAFE_INTEGER))return function(e,t){const r=new Uint8Array(9);let s=0;for(;(0!==t||e<0||e>128)&&s<8;)r[s]=127&e|128,e>>>=7,e|=(127&t)<<25,t>>>=7,s++;return r[s]=127&e,r.slice(0,s+1)}(4294967295&r|t,Math.floor(r/4294967296))},decodeVarint:function(e){const[t,r,s]=function(e){let t=0,r=0,s=0;for(let n=0;;n++){if(e.length<=n)return[void 0,void 0,e.slice(e.length)];const i=e[n];if(i<128||8===n)return s<32&&(t|=i<<s),s>0&&(r|=s-32>0?i<<s-32:i>>32-s),[t,r,e=e.slice(n+1)];s<32&&(t|=(127&i)<<s),s>0&&(r|=s-32>0?(127&i)<<s-32:(127&i)>>32-s),s+=7}}(e);if(void 0===t||void 0===r)return[void 0,s];const n=(t>>>1)+2147483648*r;return[1&t?-n:n,s]}}},77697:e=>{const t=BigInt("0x100000001B3"),r=BigInt("0xCBF29CE484222325");e.exports={fnv64:function(e){return Buffer.isBuffer(e)||(e=Buffer.from(e,"utf-8")),function(e,t,r,s){let n=t;for(const t of e)n=n*r%s,n^=BigInt(t);return n}(new Uint8Array(e),r,t,2n**64n)}}},71793:(e,t,r)=>{const s=r(76982),{encodeVarint:n,decodeVarint:i}=r(58046),o=r(28936),a=r(75004),c=r(62963),u=new o({max:500}),l="dd-pathway-ctx",p="dd-pathway-ctx-base64",d=[l,p];function h(e){const t=s.createHash("md5").update(e).digest("hex").slice(0,16);return Buffer.from(t,"hex")}function f(e){return Buffer.concat([e.hash,Buffer.from(n(Math.round(e.pathwayStartNs/1e6))),Buffer.from(n(Math.round(e.edgeStartNs/1e6)))],20)}function g(e){return f(e).toString("base64")}function m(e){if(null==e||e.length<8)return null;const t=e.subarray(0,8),r=e.subarray(8),[s,n]=i(r);if(void 0===s)return null;const[o]=i(n);return void 0===o?null:{hash:t,pathwayStartNs:1e6*s,edgeStartNs:1e6*o}}function _(e){if(!(null==e||e.length<8))return Buffer.isBuffer(e)&&(e=e.toString()),m(Buffer.from(e,"base64"))}e.exports={computePathwayHash:function(e,t,r,s){r.sort();const n=r.filter((e=>"manual_checkpoint:true"!==e)),i=`${e}${t}`+n.join("")+s.toString();if(u.get(i))return u.get(i);const o=h(`${e}${t}`+n.join("")),a=h(Buffer.concat([o,s],16).toString());return u.set(i,a),a},encodePathwayContext:f,decodePathwayContext:m,encodePathwayContextBase64:g,decodePathwayContextBase64:_,DsmPathwayCodec:class{static encode(e,t){e&&e.hash&&(t[p]=g(e),a.debug((()=>`Injected into DSM carrier: ${JSON.stringify(c(t,d))}.`)))}static decode(e){if(a.debug((()=>`Attempting extract from DSM carrier: ${JSON.stringify(c(e,d))}.`)),null==e)return;let t;if(p in e)t=_(e[p]);else if(l in e){try{t=m(e[l])}catch{}!t&&l in e&&(t=_(e[l]))}return t}}}},63011:(e,t,r)=>{const s=r(70857),n=r(8330),{LogCollapsingLowestDenseDDSketch:i}=r(4685),{DsmPathwayCodec:o}=r(71793),{DataStreamsWriter:a}=r(99340),{computePathwayHash:c}=r(71793),{types:u}=r(39023),{PATHWAY_HASH:l}=r(74100),{SchemaBuilder:p}=r(62957),{SchemaSampler:d}=r(3178),h=r(75004),f=Buffer.from("0000000000000000","hex"),g=.0075;class m{constructor(e,t,r){this.hash=e.readBigUInt64BE(),this.parentHash=t.readBigUInt64BE(),this.edgeTags=r,this.edgeLatency=new i(g),this.pathwayLatency=new i(g),this.payloadSize=new i(g)}addLatencies(e){const t=e.edgeLatencyNs/1e9,r=e.pathwayLatencyNs/1e9;this.edgeLatency.accept(t),this.pathwayLatency.accept(r),this.payloadSize.accept(e.payloadSize)}encode(){return{Hash:this.hash,ParentHash:this.parentHash,EdgeTags:this.edgeTags,EdgeLatency:this.edgeLatency.toProto(),PathwayLatency:this.pathwayLatency.toProto(),PayloadSize:this.payloadSize.toProto()}}}class _{constructor({offset:e,...t}){this._tags=Object.keys(t).sort().map((e=>`${e}:${t[e]}`)),this._hash=this._tags.join(","),this._offset=e}get hash(){return this._hash}get offset(){return this._offset}get tags(){return this._tags}encode(){return{Tags:this.tags,Value:this.offset}}}class y{constructor(){this._checkpoints=new Map,this._backlogs=new Map}get checkpoints(){return this._checkpoints}get backlogs(){return this._backlogs}forCheckpoint(e){const t=e.hash;return this._checkpoints.has(t)||this._checkpoints.set(t,new m(e.hash,e.parentHash,e.edgeTags)),this._checkpoints.get(t)}forBacklog(e){const t=new _(e),r=this._backlogs.get(t.hash);return void 0!==r&&r.offset>t.offset?r:(this._backlogs.set(t.hash,t),t)}}function b(e){if("string"==typeof e)return Buffer.from(e,"utf-8").length;if(u.isArrayBuffer(e))return e.byteLength;if(Buffer.isBuffer(e))return e.length;if(Array.isArray(e)&&e.length>0){if("number"==typeof e[0])return Buffer.from(e).length;let t=0;return e.forEach((e=>{t+=b(e)})),t}if(null!==e&&"object"==typeof e)try{return v(e)}catch{}return 0}function v(e){return void 0===e?0:Object.entries(e).reduce(((e,[t,r])=>b(t)+b(r)+e),0)}class E extends Map{forTime(e){return this.has(e)||this.set(e,new y),this.get(e)}}e.exports={DataStreamsProcessor:class{constructor({dsmEnabled:e,hostname:t,port:r,url:n,env:i,tags:o,version:c,service:u,flushInterval:l}={}){this.writer=new a({hostname:t,port:r,url:n}),this.bucketSizeNs=1e10,this.buckets=new E,this.hostname=s.hostname(),this.enabled=e,this.env=i,this.tags=o||{},this.service=u||"unnamed-nodejs-service",this.version=c||"",this.sequence=0,this.flushInterval=l,this._schemaSamplers={},this.enabled&&(this.timer=setInterval(this.onInterval.bind(this),l),this.timer.unref()),process.once("beforeExit",(()=>this.onInterval()))}onInterval(){const{Stats:e}=this._serializeBuckets();if(0===e.length)return;const t={Env:this.env,Service:this.service,Stats:e,TracerVersion:n.version,Version:this.version,Lang:"javascript",Tags:Object.entries(this.tags).map((([e,t])=>`${e}:${t}`))};this.writer.flush(t)}bucketFromTimestamp(e){const t=Math.round(e-e%this.bucketSizeNs);return this.buckets.forTime(t)}recordCheckpoint(e,t=null){this.enabled&&(this.bucketFromTimestamp(e.currentTimestamp).forCheckpoint(e).addLatencies(e),t&&t.setTag(l,e.hash.readBigUInt64BE(0).toString()))}setCheckpoint(e,t,r=null,s=0){if(!this.enabled)return null;const n=1e6*Date.now(),i=e.find((e=>e.startsWith("direction:")));let a=n,u=n,l=f,p=f,d=n;null!=r?(a=r.pathwayStartNs,u=r.edgeStartNs,l=r.hash,p=r.closestOppositeDirectionHash||f,d=r.closestOppositeDirectionEdgeStart||n,i===r.previousDirection?(l=r.closestOppositeDirectionHash,l===f?(u=n,a=n):u=r.closestOppositeDirectionEdgeStart):(p=l,d=u),h.debug((()=>`Setting DSM Checkpoint from extracted parent context with hash: ${l} and edge tags: ${e}`))):h.debug((()=>"Setting DSM Checkpoint with empty parent context."));const g=c(this.service,this.env,e,l),m=n-u,_=n-a,y={hash:g,edgeStartNs:u,pathwayStartNs:a,previousDirection:i,closestOppositeDirectionHash:p,closestOppositeDirectionEdgeStart:d};if("direction:out"===i){const e={};o.encode(y,e),s+=b(JSON.stringify(e))-1}const v={currentTimestamp:n,parentHash:l,hash:g,edgeTags:e,edgeLatencyNs:m,pathwayLatencyNs:_,payloadSize:s};return this.recordCheckpoint(v,t),y}recordOffset({timestamp:e,...t}){if(this.enabled)return this.bucketFromTimestamp(e).forBacklog(t)}setOffset(e){if(!this.enabled)return;const t={...e,timestamp:1e6*Date.now()};this.recordOffset(t)}_serializeBuckets(){const e=[];for(const[t,r]of this.buckets.entries()){const s=[];for(const e of r._checkpoints.values())s.push(e.encode());const n=[];for(const e of r._backlogs.values())n.push(e.encode());e.push({Start:BigInt(t),Duration:BigInt(this.bucketSizeNs),Stats:s,Backlogs:n})}return this.buckets.clear(),{Stats:e}}setUrl(e){this.writer.setUrl(e)}trySampleSchema(e){const t=Date.now();return this._schemaSamplers[e]||(this._schemaSamplers[e]=new d),this._schemaSamplers[e].trySample(t)}canSampleSchema(e){const t=Date.now();return this._schemaSamplers[e]||(this._schemaSamplers[e]=new d),this._schemaSamplers[e].canSample(t)}getSchema(e,t){return p.getSchema(e,t)}},StatsPoint:m,StatsBucket:y,Backlog:_,TimeBuckets:E,getMessageSize:function(e){const{key:t,value:r,headers:s}=e;return b(t)+b(r)+v(s)},getHeadersSize:v,getSizeOrZero:b,getAmqpMessageSize:function(e){const{headers:t,content:r}=e;return b(r)+v(t)},ENTRY_PARENT_HASH:f}},20185:e=>{e.exports={Schema:class{constructor(e,t){this.definition=e,this.id=t}}}},62957:(e,t,r)=>{const s=r(28936),{fnv64:n}=r(77697),{Schema:i}=r(20185),o=new s({max:256});class a{constructor(e){this.schema=new c,this.iterator=e,this.properties=0}static getCache(){return o}static getSchemaDefinition(e){const t=function(e,t=2){return JSON.stringify(e,((e,t)=>t),t).replace(/^ +/gm," ").replace(/\n/g,"").replace(/{ /g,"{").replace(/ }/g,"}").replace(/\[ /g,"[").replace(/ \]/g,"]")}(l(e)),r=n(Buffer.from(t,"utf-8")).toString();return new i(t,r)}static getSchema(e,t,r){return o.has(e)||o.set(e,(r??new a(t)).build()),o.get(e)}build(){return this.iterator.iterateOverSchema(this),this.schema}addProperty(e,t,r,s,n,i,o,a){if(this.properties>=1e3)return!1;this.properties+=1;let u=new c.PROPERTY(s,n,i,o,a,null);return r&&(u=new c.PROPERTY("array",null,null,null,null,u)),this.schema.components.schemas[e].properties[t]=u,!0}shouldExtractSchema(e,t){return!(t>10||e in this.schema.components.schemas||(this.schema.components.schemas[e]=new c.SCHEMA,0))}}class c{constructor(){this.openapi="3.0.0",this.components=new u}}c.SCHEMA=class{constructor(){this.type="object",this.properties={}}},c.PROPERTY=class{constructor(e,t=null,r=null,s=null,n=null,i=null){this.type=e,this.description=t,this.$ref=r,this.format=s,this.enum=n,this.items=i}};class u{constructor(){this.schemas={}}}function l(e){if(Array.isArray(e))return e.filter((e=>null!==e)).map((e=>l(e)));if(e&&"object"==typeof e){const t={};for(const[r,s]of Object.entries(e))null!==s&&(t[r]=l(s));return t}return e}e.exports={SchemaBuilder:a,OpenApiSchema:c,convertToJsonCompatible:l,convertKey:function(e){return"enumValues"===e?"enum":e}}},3178:e=>{const t=3e4;e.exports={SchemaSampler:class{constructor(){this.weight=0,this.lastSampleMs=0}trySample(e){if(e>=this.lastSampleMs+t&&e>=this.lastSampleMs+t){this.lastSampleMs=e;const t=this.weight;return this.weight=0,t}return 0}canSample(e){return this.weight+=1,e>=this.lastSampleMs+t}}}},99340:(e,t,r)=>{const s=r(8330),n=r(75004),i=r(17209),{URL:o,format:a}=r(87016),{MsgpackEncoder:c}=r(69978),u=r(43106),l=new c;e.exports={DataStreamsWriter:class{constructor(e){const{hostname:t="127.0.0.1",port:r=8126,url:s}=e;this._url=s||new o(a({protocol:"http:",hostname:t||"localhost",port:r}))}flush(e){if(!i.writable)return void n.debug((()=>`Maximum number of active requests reached. Payload discarded: ${JSON.stringify(e)}`));const t=l.encode(e);u.gzip(t,{level:1},((e,t)=>{e?n.error("Error zipping datastream",e):function(e,t){const r={path:"/v0.1/pipeline_stats",method:"POST",headers:{"Datadog-Meta-Lang":"javascript","Datadog-Meta-Tracer-Version":s.version,"Content-Type":"application/msgpack","Content-Encoding":"gzip"},url:t};n.debug((()=>`Request to the intake: ${JSON.stringify(r)}`)),i(e,r,((e,t)=>{((e,t)=>{n.debug(`Response from the agent: ${t}`),e&&n.error("Error sending datastream",e)})(e,t)}))}(t,this._url)}))}setUrl(e){try{e=new o(e),this._url=e}catch(e){n.warn(e.stack)}}}}},48661:(e,t,r)=>{"use strict";const{join:s}=r(16928),{Worker:n,MessageChannel:i,threadId:o}=r(28167),a=r(75004);let c=null,u=null,l=0;const{NODE_OPTIONS:p,...d}=process.env;e.exports={start:function(e,t){if(null!==c)return;a.debug("[debugger] Starting Dynamic Instrumentation client...");const r=new Map,p=new i;u=new i,t.setProductHandler("LIVE_DEBUGGING",((e,t,s,n)=>{r.set(++l,n),p.port2.postMessage({action:e,conf:t,ackId:l})})),p.port2.on("message",(({ackId:e,error:t})=>{const s=r.get(e);if(void 0===s)return a.error("[debugger] Received an unknown ackId: %s",e),void(t&&a.error("[debugger] Error starting Dynamic Instrumentation client",t));s(t),r.delete(e)})),p.port2.on("messageerror",(e=>a.error('[debugger] received "messageerror" on RC port',e))),c=new n(s(__dirname,"devtools_client","index.js"),{execArgv:[],env:d,workerData:{config:e.serialize(),parentThreadId:o,rcPort:p.port1,configPort:u.port1},transferList:[p.port1,u.port1]}),c.on("online",(()=>{a.debug("[debugger] Dynamic Instrumentation worker thread started successfully (thread id: %d)",c.threadId)})),c.on("error",(e=>a.error("[debugger] worker thread error",e))),c.on("messageerror",(e=>a.error('[debugger] received "messageerror" from worker',e))),c.on("exit",(e=>{const s=new Error(`Dynamic Instrumentation worker thread exited unexpectedly with code ${e}`);a.error("[debugger] worker thread exited unexpectedly",s),t.removeProductHandler("LIVE_DEBUGGING"),c.removeAllListeners(),u=null;for(const e of r.keys())r.get(e)(s),r.delete(e)})),c.unref(),p.port1.unref(),p.port2.unref(),u.port1.unref(),u.port2.unref()},configure:function(e){null!==u&&u.port2.postMessage(e.serialize())}}},2770:(e,t,r)=>{"use strict";const s=r(72250).lookup,n=r(17209),i=r(7194),o=r(69278).isIP,a=r(75004),{URL:c,format:u}=r(87016);class l{constructor(e={}){e.metricsProxyUrl&&(this._httpOptions={url:e.metricsProxyUrl.toString(),path:"/dogstatsd/v2/proxy"}),this._host=e.host||"localhost",this._family=o(this._host),this._port=e.port||8125,this._prefix=e.prefix||"",this._tags=e.tags||[],this._queue=[],this._buffer="",this._offset=0,this._udp4=this._socket("udp4"),this._udp6=this._socket("udp6")}increment(e,t,r){this._add(e,t,"c",r)}gauge(e,t,r){this._add(e,t,"g",r)}distribution(e,t,r){this._add(e,t,"d",r)}histogram(e,t,r){this._add(e,t,"h",r)}flush(){const e=this._enqueue();a.debug(`Flushing ${e.length} metrics via ${this._httpOptions?"HTTP":"UDP"}`),0!==this._queue.length&&(this._queue=[],this._httpOptions?this._sendHttp(e):this._sendUdp(e))}_sendHttp(e){const t=Buffer.concat(e);n(t,this._httpOptions,(t=>{t&&(a.error("DogStatsDClient: HTTP error from agent: %s",t.message,t),404===t.status&&(this._httpOptions=null),this._sendUdp(e))}))}_sendUdp(e){0!==this._family?this._sendUdpFromQueue(e,this._host,this._family):s(this._host,((t,r,s)=>{if(t)return a.error("DogStatsDClient: Host not found",t);this._sendUdpFromQueue(e,r,s)}))}_sendUdpFromQueue(e,t,r){const s=6===r?this._udp6:this._udp4;e.forEach((e=>{a.debug(`Sending to DogStatsD: ${e}`),s.send(e,0,e.length,this._port,t)}))}_add(e,t,r,s){const n=`${this._prefix+e}:${t}|${r}`;(s=s?this._tags.concat(s):this._tags).length>0?this._write(`${n}|#${s.join(",")}\n`):this._write(`${n}\n`)}_write(e){const t=Buffer.byteLength(e);this._offset+t>1024&&this._enqueue(),this._offset+=t,this._buffer+=e}_enqueue(){return this._offset>0&&(this._queue.push(Buffer.from(this._buffer)),this._buffer="",this._offset=0),this._queue}_socket(e){const t=i.createSocket(e);return t.on("error",(()=>{})),t.unref(),t}static generateClientConfig(e={}){const t=[];e.tags&&Object.keys(e.tags).filter((t=>"string"==typeof e.tags[t])).filter((t=>"runtime-id"!==t||e.experimental&&e.experimental.runtimeId)).forEach((r=>{const s=e.tags[r].replace(/[^a-z0-9_:./-]/gi,"_");t.push(`${r}:${s}`)}));const r={host:e.dogstatsd.hostname,port:e.dogstatsd.port,tags:t};return e.url?r.metricsProxyUrl=e.url:e.port&&(r.metricsProxyUrl=new c(u({protocol:"http:",hostname:e.hostname||"localhost",port:e.port}))),r}}class p{constructor(e){const t=l.generateClientConfig(e);this.dogstatsd=new l(t)}increment(e,t=1,r){return this.dogstatsd.increment(e,t,p.tagTranslator(r))}decrement(e,t=1,r){return this.dogstatsd.increment(e,-1*t,p.tagTranslator(r))}gauge(e,t,r){return this.dogstatsd.gauge(e,t,p.tagTranslator(r))}distribution(e,t,r){return this.dogstatsd.distribution(e,t,p.tagTranslator(r))}histogram(e,t,r){return this.dogstatsd.histogram(e,t,p.tagTranslator(r))}flush(){return this.dogstatsd.flush()}static tagTranslator(e){const t=[];if(!e)return t;for(const[r,s]of Object.entries(e))t.push(`${r}:${s}`);return t}}e.exports={DogStatsDClient:l,CustomMetrics:p}},76882:(e,t,r)=>{"use strict";const{truncateSpan:s,normalizeSpan:n}=r(1557),{Chunk:i,MsgpackEncoder:o}=r(69978),a=r(75004),{isTrue:c}=r(89421),u=r(96538);function l(e){return n(s(e,!1))}e.exports={AgentEncoder:class{constructor(e,t=8388608){this._msgpack=new o,this._limit=t,this._traceBytes=new i,this._stringBytes=new i,this._writer=e,this._reset(),this._debugEncoding=c(u(process.env.DD_TRACE_ENCODING_DEBUG,!1))}count(){return this._traceCount}encode(e){const t=this._traceBytes,r=t.length;this._traceCount++,this._encode(t,e);const s=t.length;this._debugEncoding&&a.debug((()=>`Adding encoded trace to buffer: ${t.buffer.subarray(r,s).toString("hex").match(/../g).join(" ")}`)),(this._traceBytes.length>this._limit||this._stringBytes.length>this._limit)&&(a.debug("Buffer went over soft limit, flushing"),this._writer.flush())}makePayload(){const e=this._traceBytes.length+5,t=Buffer.allocUnsafe(e);return this._writeTraces(t),this._reset(),t}reset(){this._reset()}_encode(e,t){this._encodeArrayPrefix(e,t);for(let r of t)r=l(r),e.reserve(1),r.type&&r.meta_struct?e.buffer[e.length-1]=141:r.type||r.meta_struct?e.buffer[e.length-1]=140:e.buffer[e.length-1]=139,r.type&&(this._encodeString(e,"type"),this._encodeString(e,r.type)),this._encodeString(e,"trace_id"),this._encodeId(e,r.trace_id),this._encodeString(e,"span_id"),this._encodeId(e,r.span_id),this._encodeString(e,"parent_id"),this._encodeId(e,r.parent_id),this._encodeString(e,"name"),this._encodeString(e,r.name),this._encodeString(e,"resource"),this._encodeString(e,r.resource),this._encodeString(e,"service"),this._encodeString(e,r.service),this._encodeString(e,"error"),this._encodeInteger(e,r.error),this._encodeString(e,"start"),this._encodeLong(e,r.start),this._encodeString(e,"duration"),this._encodeLong(e,r.duration),this._encodeString(e,"meta"),this._encodeMap(e,r.meta),this._encodeString(e,"metrics"),this._encodeMap(e,r.metrics),r.meta_struct&&(this._encodeString(e,"meta_struct"),this._encodeMetaStruct(e,r.meta_struct))}_reset(){this._traceCount=0,this._traceBytes.length=0,this._stringCount=0,this._stringBytes.length=0,this._stringMap={},this._cacheString("")}_encodeBuffer(e,t){this._msgpack.encodeBin(e,t)}_encodeBool(e,t){this._msgpack.encodeBoolean(e,t)}_encodeArrayPrefix(e,t){this._msgpack.encodeArrayPrefix(e,t)}_encodeMapPrefix(e,t){this._msgpack.encodeMapPrefix(e,t)}_encodeByte(e,t){this._msgpack.encodeByte(e,t)}_encodeId(e,t){const r=e.length;e.reserve(9),t=t.toArray(),e.buffer[r]=207,e.buffer[r+1]=t[0],e.buffer[r+2]=t[1],e.buffer[r+3]=t[2],e.buffer[r+4]=t[3],e.buffer[r+5]=t[4],e.buffer[r+6]=t[5],e.buffer[r+7]=t[6],e.buffer[r+8]=t[7]}_encodeNumber(e,t){this._msgpack.encodeNumber(e,t)}_encodeInteger(e,t){this._msgpack.encodeInteger(e,t)}_encodeLong(e,t){this._msgpack.encodeLong(e,t)}_encodeMap(e,t){const r=Object.keys(t).filter((e=>"string"==typeof t[e]||"number"==typeof t[e]));this._encodeMapPrefix(e,r.length);for(const s of r)this._encodeString(e,s),this._encodeValue(e,t[s])}_encodeValue(e,t){switch(typeof t){case"string":this._encodeString(e,t);break;case"number":this._encodeFloat(e,t)}}_encodeString(e,t=""){this._cacheString(t);const{start:r,end:s}=this._stringMap[t];this._stringBytes.copy(e,r,s)}_encodeFloat(e,t){this._msgpack.encodeFloat(e,t)}_encodeMetaStruct(e,t){const r=(Array.isArray(t)?[]:Object.keys(t)).filter((e=>{const r=t[e];return"string"==typeof r||"number"==typeof r||null!==r&&"object"==typeof r}));this._encodeMapPrefix(e,r.length);for(const s of r){const r=t[s];this._encodeString(e,s),this._encodeObjectAsByteArray(e,r)}}_encodeObjectAsByteArray(e,t){const r=e.length;e.reserve(5),this._encodeObject(e,t);const s=e.length-r-5;e.buffer[r]=198,e.buffer[r+1]=s>>24,e.buffer[r+2]=s>>16,e.buffer[r+3]=s>>8,e.buffer[r+4]=s}_encodeObject(e,t,r=new Set){r.add(t),Array.isArray(t)?this._encodeObjectAsArray(e,t,r):null!==t&&"object"==typeof t?this._encodeObjectAsMap(e,t,r):"string"!=typeof t&&"number"!=typeof t||this._encodeValue(e,t)}_encodeObjectAsMap(e,t,r){const s=Object.keys(t).filter((e=>{const s=t[e];return"string"==typeof s||"number"==typeof s||null!==s&&"object"==typeof s&&!r.has(s)}));this._encodeMapPrefix(e,s.length);for(const n of s){const s=t[n];this._encodeString(e,n),this._encodeObject(e,s,r)}}_encodeObjectAsArray(e,t,r){const s=t.filter((e=>"string"==typeof e||"number"==typeof e||null!==e&&"object"==typeof e&&!r.has(e)));this._encodeArrayPrefix(e,s);for(const t of s)this._encodeObject(e,t,r)}_cacheString(e){e in this._stringMap||(this._stringCount++,this._stringMap[e]={start:this._stringBytes.length,end:this._stringBytes.length+this._stringBytes.write(e)})}_writeArrayPrefix(e,t,r){return e[t++]=221,e.writeUInt32BE(r,t),t+4}_writeTraces(e,t=0){return(t=this._writeArrayPrefix(e,t,this._traceCount))+this._traceBytes.buffer.copy(e,t,0,this._traceBytes.length)}}}},44513:(e,t,r)=>{"use strict";const{truncateSpan:s,normalizeSpan:n}=r(1557),{AgentEncoder:i}=r(76882);function o(e){return n(s(e,!1))}e.exports={AgentEncoder:class extends i{makePayload(){const e=this._stringBytes.length+5,t=this._traceBytes.length+5,r=Buffer.allocUnsafe(1+e+t);let s=0;return r[s++]=146,s=this._writeStrings(r,s),s=this._writeTraces(r,s),this._reset(),r}_encode(e,t){this._encodeArrayPrefix(e,t);for(let r of t)r=o(r),this._encodeByte(e,156),this._encodeString(e,r.service),this._encodeString(e,r.name),this._encodeString(e,r.resource),this._encodeId(e,r.trace_id),this._encodeId(e,r.span_id),this._encodeId(e,r.parent_id),this._encodeLong(e,r.start||0),this._encodeLong(e,r.duration||0),this._encodeInteger(e,r.error),this._encodeMap(e,r.meta||{}),this._encodeMap(e,r.metrics||{}),this._encodeString(e,r.type)}_encodeString(e,t=""){this._cacheString(t),this._encodeInteger(e,this._stringMap[t])}_cacheString(e){e in this._stringMap||(this._stringMap[e]=this._stringCount++,this._stringBytes.write(e))}_writeStrings(e,t){return(t=this._writeArrayPrefix(e,t,this._stringCount))+this._stringBytes.buffer.copy(e,t,0,this._stringBytes.length)}}}},46906:(e,t,r)=>{"use strict";const{truncateSpan:s,normalizeSpan:n}=r(1557),{AgentEncoder:i}=r(76882),{version:o}=r(8330),{ITR_CORRELATION_ID:a}=r(97507),c=r(94248),{distributionMetric:u,TELEMETRY_ENDPOINT_PAYLOAD_SERIALIZATION_MS:l,TELEMETRY_ENDPOINT_PAYLOAD_EVENTS_COUNT:p}=r(60806),d=["test_session_end","test_module_end","test_suite_end","test"];function h(e){let t=1;return"test"===e.type&&e.meta&&e.meta.test_session_id&&(t=2),{type:d.includes(e.type)?e.type:"span",version:t,content:n(s(e))}}e.exports={AgentlessCiVisibilityEncoder:class extends i{constructor(e,{runtimeId:t,service:r,env:s}){super(e,2097152),this.runtimeId=t,this.service=r,this.env=s,this._eventCount=0,this.metadataTags={},this.reset()}setMetadataTags(e){this.metadataTags=e}_encodeTestSuite(e,t){let r=12;const s=t.meta[a];s&&r++,this._encodeMapPrefix(e,r),this._encodeString(e,"type"),this._encodeString(e,t.type),this._encodeString(e,"test_session_id"),this._encodeId(e,t.trace_id),this._encodeString(e,"test_module_id"),this._encodeId(e,t.parent_id),this._encodeString(e,"test_suite_id"),this._encodeId(e,t.span_id),s&&(this._encodeString(e,a),this._encodeString(e,s),delete t.meta[a]),this._encodeString(e,"error"),this._encodeNumber(e,t.error),this._encodeString(e,"name"),this._encodeString(e,t.name),this._encodeString(e,"service"),this._encodeString(e,t.service),this._encodeString(e,"resource"),this._encodeString(e,t.resource),this._encodeString(e,"start"),this._encodeNumber(e,t.start),this._encodeString(e,"duration"),this._encodeNumber(e,t.duration),this._encodeString(e,"meta"),this._encodeMap(e,t.meta),this._encodeString(e,"metrics"),this._encodeMap(e,t.metrics)}_encodeTestModule(e,t){this._encodeMapPrefix(e,11),this._encodeString(e,"type"),this._encodeString(e,t.type),this._encodeString(e,"test_session_id"),this._encodeId(e,t.trace_id),this._encodeString(e,"test_module_id"),this._encodeId(e,t.span_id),this._encodeString(e,"error"),this._encodeNumber(e,t.error),this._encodeString(e,"name"),this._encodeString(e,t.name),this._encodeString(e,"service"),this._encodeString(e,t.service),this._encodeString(e,"resource"),this._encodeString(e,t.resource),this._encodeString(e,"start"),this._encodeNumber(e,t.start),this._encodeString(e,"duration"),this._encodeNumber(e,t.duration),this._encodeString(e,"meta"),this._encodeMap(e,t.meta),this._encodeString(e,"metrics"),this._encodeMap(e,t.metrics)}_encodeTestSession(e,t){this._encodeMapPrefix(e,10),this._encodeString(e,"type"),this._encodeString(e,t.type),this._encodeString(e,"test_session_id"),this._encodeId(e,t.trace_id),this._encodeString(e,"error"),this._encodeNumber(e,t.error),this._encodeString(e,"name"),this._encodeString(e,t.name),this._encodeString(e,"service"),this._encodeString(e,t.service),this._encodeString(e,"resource"),this._encodeString(e,t.resource),this._encodeString(e,"start"),this._encodeNumber(e,t.start),this._encodeString(e,"duration"),this._encodeNumber(e,t.duration),this._encodeString(e,"meta"),this._encodeMap(e,t.meta),this._encodeString(e,"metrics"),this._encodeMap(e,t.metrics)}_encodeEventContent(e,t){let r=11;t.meta.test_session_id&&(r+=1),t.meta.test_module_id&&(r+=1),t.meta.test_suite_id&&(r+=1);const s=t.meta[a];s&&(r+=1),t.type&&(r+=1),this._encodeMapPrefix(e,r),t.type&&(this._encodeString(e,"type"),this._encodeString(e,t.type)),this._encodeString(e,"trace_id"),this._encodeId(e,t.trace_id),this._encodeString(e,"span_id"),this._encodeId(e,t.span_id),this._encodeString(e,"parent_id"),this._encodeId(e,t.parent_id),this._encodeString(e,"name"),this._encodeString(e,t.name),this._encodeString(e,"resource"),this._encodeString(e,t.resource),this._encodeString(e,"service"),this._encodeString(e,t.service),this._encodeString(e,"error"),this._encodeNumber(e,t.error),this._encodeString(e,"start"),this._encodeNumber(e,t.start),this._encodeString(e,"duration"),this._encodeNumber(e,t.duration),t.meta.test_session_id&&(this._encodeString(e,"test_session_id"),this._encodeId(e,c(t.meta.test_session_id,10)),delete t.meta.test_session_id),t.meta.test_module_id&&(this._encodeString(e,"test_module_id"),this._encodeId(e,c(t.meta.test_module_id,10)),delete t.meta.test_module_id),t.meta.test_suite_id&&(this._encodeString(e,"test_suite_id"),this._encodeId(e,c(t.meta.test_suite_id,10)),delete t.meta.test_suite_id),s&&(this._encodeString(e,a),this._encodeString(e,s),delete t.meta[a]),this._encodeString(e,"meta"),this._encodeMap(e,t.meta),this._encodeString(e,"metrics"),this._encodeMap(e,t.metrics)}_encodeEvent(e,t){this._encodeMapPrefix(e,Object.keys(t).length),this._encodeString(e,"type"),this._encodeString(e,t.type),this._encodeString(e,"version"),this._encodeNumber(e,t.version),this._encodeString(e,"content"),"span"===t.type||"test"===t.type?this._encodeEventContent(e,t.content):"test_suite_end"===t.type?this._encodeTestSuite(e,t.content):"test_module_end"===t.type?this._encodeTestModule(e,t.content):"test_session_end"===t.type&&this._encodeTestSession(e,t.content)}_encode(e,t){this._isReset&&(this._encodePayloadStart(e),this._isReset=!1);const r=Date.now(),s=t.map(h),n=s.filter((e=>"test_session_end"===e.type||"test_suite_end"===e.type||"test_module_end"===e.type)),i=n.length?n:s;this._eventCount+=i.length;for(const t of i)this._encodeEvent(e,t);u(l,{endpoint:"test_cycle"},Date.now()-r)}makePayload(){u(p,{endpoint:"test_cycle"},this._eventCount);const e=this._traceBytes,t=this._eventsOffset,r=this._eventCount;e.buffer[t]=221,e.buffer[t+1]=r>>24,e.buffer[t+2]=r>>16,e.buffer[t+3]=r>>8,e.buffer[t+4]=r;const s=e.length,n=Buffer.allocUnsafe(s);return e.buffer.copy(n,0,0,s),this.reset(),n}_encodePayloadStart(e){const t={version:1,metadata:{"*":{language:"javascript",library_version:o},...this.metadataTags},events:[]};this.env&&(t.metadata["*"].env=this.env),this.runtimeId&&(t.metadata["*"]["runtime-id"]=this.runtimeId),this._encodeMapPrefix(e,Object.keys(t).length),this._encodeString(e,"version"),this._encodeNumber(e,t.version),this._encodeString(e,"metadata"),this._encodeMapPrefix(e,Object.keys(t.metadata).length),this._encodeString(e,"*"),this._encodeMap(e,t.metadata["*"]),t.metadata.test&&(this._encodeString(e,"test"),this._encodeMap(e,t.metadata.test)),t.metadata.test_suite_end&&(this._encodeString(e,"test_suite_end"),this._encodeMap(e,t.metadata.test_suite_end)),t.metadata.test_module_end&&(this._encodeString(e,"test_module_end"),this._encodeMap(e,t.metadata.test_module_end)),t.metadata.test_session_end&&(this._encodeString(e,"test_session_end"),this._encodeMap(e,t.metadata.test_session_end)),this._encodeString(e,"events"),this._eventsOffset=e.length,e.reserve(5)}reset(){this._reset(),this._eventCount=0,this._isReset=!0}}}},66406:(e,t,r)=>{"use strict";const{AgentEncoder:s}=r(76882),{Chunk:n}=r(69978),{distributionMetric:i,TELEMETRY_ENDPOINT_PAYLOAD_SERIALIZATION_MS:o,TELEMETRY_ENDPOINT_PAYLOAD_EVENTS_COUNT:a}=r(60806),c=r(43357);e.exports={CoverageCIVisibilityEncoder:class extends s{constructor(){super(...arguments),this._coverageBytes=new n,this.form=new c,this._coveragesCount=0,this.reset()}count(){return this._coveragesCount}encode(e){const t=Date.now();this._coveragesCount++,this.encodeCodeCoverage(this._coverageBytes,e),i(o,{endpoint:"code_coverage"},Date.now()-t)}encodeCodeCoverage(e,t){t.testId?this._encodeMapPrefix(e,4):this._encodeMapPrefix(e,3),this._encodeString(e,"test_session_id"),this._encodeId(e,t.sessionId),this._encodeString(e,"test_suite_id"),this._encodeId(e,t.suiteId),t.testId&&(this._encodeString(e,"span_id"),this._encodeId(e,t.testId)),this._encodeString(e,"files"),this._encodeArrayPrefix(e,t.files);for(const r of t.files)this._encodeMapPrefix(e,1),this._encodeString(e,"filename"),this._encodeString(e,r)}reset(){this._reset(),this._coverageBytes&&(this._coverageBytes.length=0),this._coveragesCount=0,this._encodePayloadStart(this._coverageBytes)}_encodePayloadStart(e){this._encodeMapPrefix(e,2),this._encodeString(e,"version"),this._encodeInteger(e,2),this._encodeString(e,"coverages"),this._coveragesOffset=e.length,e.reserve(5)}makePayload(){i(a,{endpoint:"code_coverage"},this._coveragesCount);const e=this._coverageBytes,t=this._coveragesOffset,r=this._coveragesCount;e.buffer[t]=221,e.buffer[t+1]=r>>24,e.buffer[t+2]=r>>16,e.buffer[t+3]=r>>8,e.buffer[t+4]=r;const s=e.length,n=Buffer.allocUnsafe(s);e.buffer.copy(n,0,0,e.length),this.form.append("coverage1",n,{filename:"coverage1.msgpack",contentType:"application/msgpack"}),this.form.append("event",JSON.stringify({dummy:!0}),{filename:"event.json",contentType:"application/json"});const o=this.form;return this.form=new c,this.reset(),o}}}},2424:(e,t,r)=>{"use strict";const{AgentEncoder:s}=r(76882),{MAX_NAME_LENGTH:n,MAX_SERVICE_LENGTH:i,MAX_RESOURCE_NAME_LENGTH:o,MAX_TYPE_LENGTH:a,DEFAULT_SPAN_NAME:c,DEFAULT_SERVICE_NAME:u}=r(1557);function l(e,t,r=""){return e&&e.length>t?`${e.slice(0,t)}${r}`:e}e.exports={SpanStatsEncoder:class extends s{makePayload(){const e=this._traceBytes.length,t=Buffer.allocUnsafe(e);return this._traceBytes.copy(t,0,e),this._reset(),t}_encodeStat(e,t){this._encodeMapPrefix(e,12),this._encodeString(e,"Service");const r=t.Service||u;this._encodeString(e,l(r,i)),this._encodeString(e,"Name");const s=t.Name||c;this._encodeString(e,l(s,n)),this._encodeString(e,"Resource"),this._encodeString(e,l(t.Resource,o,"...")),this._encodeString(e,"HTTPStatusCode"),this._encodeInteger(e,t.HTTPStatusCode),this._encodeString(e,"Type"),this._encodeString(e,l(t.Type,a)),this._encodeString(e,"Hits"),this._encodeLong(e,t.Hits),this._encodeString(e,"Errors"),this._encodeLong(e,t.Errors),this._encodeString(e,"Duration"),this._encodeLong(e,t.Duration),this._encodeString(e,"OkSummary"),this._encodeBuffer(e,t.OkSummary),this._encodeString(e,"ErrorSummary"),this._encodeBuffer(e,t.ErrorSummary),this._encodeString(e,"Synthetics"),this._encodeBool(e,t.Synthetics),this._encodeString(e,"TopLevelHits"),this._encodeLong(e,t.TopLevelHits)}_encodeBucket(e,t){this._encodeMapPrefix(e,3),this._encodeString(e,"Start"),this._encodeLong(e,t.Start),this._encodeString(e,"Duration"),this._encodeLong(e,t.Duration),this._encodeString(e,"Stats"),this._encodeArrayPrefix(e,t.Stats);for(const r of t.Stats)this._encodeStat(e,r)}_encode(e,t){this._encodeMapPrefix(e,8),this._encodeString(e,"Hostname"),this._encodeString(e,t.Hostname),this._encodeString(e,"Env"),this._encodeString(e,t.Env),this._encodeString(e,"Version"),this._encodeString(e,t.Version),this._encodeString(e,"Stats"),this._encodeArrayPrefix(e,t.Stats);for(const r of t.Stats)this._encodeBucket(e,r);this._encodeString(e,"Lang"),this._encodeString(e,t.Lang),this._encodeString(e,"TracerVersion"),this._encodeString(e,t.TracerVersion),this._encodeString(e,"RuntimeID"),this._encodeString(e,t.RuntimeID),this._encodeString(e,"Sequence"),this._encodeLong(e,t.Sequence)}}}},1557:e=>{const t=5e3,r=200,s=25e3,n=r,i="unnamed_operation",o="unnamed-service";e.exports={truncateSpan:function(e,i=!0){i&&e.resource&&e.resource.length>t&&(e.resource=`${e.resource.slice(0,t)}...`);for(let t in e.meta){const n=e.meta[t];t.length>r&&(delete e.meta[t],t=`${t.slice(0,r)}...`,e.metrics[t]=n),n&&n.length>s&&(e.meta[t]=`${n.slice(0,s)}...`)}for(let t in e.metrics){const r=e.metrics[t];t.length>n&&(delete e.metrics[t],t=`${t.slice(0,n)}...`,e.metrics[t]=r)}return e},normalizeSpan:function(e){return e.service=e.service||o,e.service.length>100&&(e.service=e.service.slice(0,100)),e.name=e.name||i,e.name.length>100&&(e.name=e.name.slice(0,100)),e.resource||(e.resource=e.name),e.type&&e.type.length>100&&(e.type=e.type.slice(0,100)),e},MAX_META_KEY_LENGTH:r,MAX_META_VALUE_LENGTH:s,MAX_METRIC_KEY_LENGTH:n,MAX_NAME_LENGTH:100,MAX_SERVICE_LENGTH:100,MAX_TYPE_LENGTH:100,MAX_RESOURCE_NAME_LENGTH:t,DEFAULT_SPAN_NAME:i,DEFAULT_SERVICE_NAME:o}},79312:(e,t,r)=>{"use strict";const s=r(10775),n=r(79896),i=r(23636);e.exports=e=>{const t=void 0!==process.env.AWS_LAMBDA_FUNCTION_NAME,o=t&&n.existsSync(i.DATADOG_LAMBDA_EXTENSION_PATH);switch(e){case s.LOG:return r(70913);case s.AGENT:return r(52170);case s.DATADOG:return r(31355);case s.AGENT_PROXY:return r(39107);case s.JEST_WORKER:case s.CUCUMBER_WORKER:case s.MOCHA_WORKER:return r(62794);default:return r(t&&!o?70913:52170)}}},52170:(e,t,r)=>{"use strict";const{URL:s,format:n}=r(87016),i=r(75004),o=r(39091);e.exports=class{constructor(e,t){this._config=e;const{url:r,hostname:i,port:a,lookup:c,protocolVersion:u,stats:l={},appsec:p}=e;this._url=r||new s(n({protocol:"http:",hostname:i||"localhost",port:a}));const d={};(l.enabled||p?.standalone?.enabled)&&(d["Datadog-Client-Computed-Stats"]="yes"),this._writer=new o({url:this._url,prioritySampler:t,lookup:c,protocolVersion:u,headers:d}),this._timer=void 0,process.once("beforeExit",(()=>this._writer.flush()))}setUrl(e){try{e=new s(e),this._url=e,this._writer.setUrl(e)}catch(e){i.warn(e.stack)}}export(e){this._writer.append(e);const{flushInterval:t}=this._config;0===t?this._writer.flush():t>0&&!this._timer&&(this._timer=setTimeout((()=>{this._writer.flush(),this._timer=clearTimeout(this._timer)}),t).unref())}flush(e=()=>{}){this._writer.flush(e)}}},39091:(e,t,r)=>{"use strict";const s=r(17209),{startupLog:n}=r(42471),i=r(40091),o=r(75004),a=r(8330).version,c=r(10097),u="datadog.tracer.node.exporter.agent";function l(e,t,r){r&&(e[t]=r)}e.exports=class extends c{constructor({prioritySampler:e,lookup:t,protocolVersion:s,headers:n}){super(...arguments);const i=function(e){return"0.5"===e?r(44513).AgentEncoder:r(76882).AgentEncoder}(s);this._prioritySampler=e,this._lookup=t,this._protocolVersion=s,this._encoder=new i(this),this._headers=n}_sendPayload(e,t,r){i.increment(`${u}.requests`,!0);const{_headers:c,_lookup:p,_protocolVersion:d,_url:h}=this;!function(e,t,r,i,c,u,p,d){const h={path:`/v${e}/traces`,method:"PUT",headers:{...c,"Content-Type":"application/msgpack","Datadog-Meta-Tracer-Version":a,"X-Datadog-Trace-Count":String(r)},lookup:u,url:i};l(h.headers,"Datadog-Meta-Lang","nodejs"),l(h.headers,"Datadog-Meta-Lang-Version",process.version),l(h.headers,"Datadog-Meta-Lang-Interpreter",process.jsEngine||"v8"),o.debug((()=>`Request to the agent: ${JSON.stringify(h)}`)),s(t,h,((e,t,r)=>{n({agentError:404!==r&&200!==r?e:void 0}),d(e,t,r)}))}(d,e,t,h,c,p,0,((e,t,s)=>{if(s?(i.increment(`${u}.responses`,!0),i.increment(`${u}.responses.by.status`,`status:${s}`,!0)):e&&(i.increment(`${u}.errors`,!0),i.increment(`${u}.errors.by.name`,`name:${e.name}`,!0),e.code&&i.increment(`${u}.errors.by.code`,`code:${e.code}`,!0)),n({agentError:e}),e)return o.error("Error sending payload to the agent (status code: %s)",e.status,e),void r();o.debug("Response from the agent: %s",t);try{this._prioritySampler.update(JSON.parse(t).rate_by_service)}catch(e){o.error("Error updating prioritySampler rates",e),i.increment(`${u}.errors`,!0),i.increment(`${u}.errors.by.name`,`name:${e.name}`,!0)}r()}))}}},72114:(e,t,r)=>{const{URL:s,format:n}=r(87016),i=r(17209),{incrementCountMetric:o,TELEMETRY_EVENTS_ENQUEUED_FOR_SERIALIZATION:a}=r(60806);e.exports=class{constructor(e){this._config=e;const{url:t,hostname:r,port:i}=this._config;this._url=t||new s(n({protocol:"http:",hostname:r||"localhost",port:i})),this._traceBuffer=[],this._isInitialized=!1}getAgentInfo(e){var t,r;t=this._url,r=e,i("",{path:"/info",url:t},((e,t)=>{if(e)return r(e);try{const e=JSON.parse(t);return r(null,e)}catch(e){return r(e)}}))}export(e){this._isInitialized?this._export(e):this._traceBuffer.push(e)}_export(e,t=this._writer,r="_timer"){this._config.isCiVisibility&&o(a,{},e.length),t.append(e);const{flushInterval:s}=this._config;0===s?t.flush():s>0&&!this[r]&&(this[r]=setTimeout((()=>{t.flush(),this[r]=clearTimeout(this[r])}),s).unref())}getUncodedTraces(){return this._traceBuffer}exportUncodedTraces(){this.getUncodedTraces().forEach((e=>{this.export(e)})),this.resetUncodedTraces()}resetUncodedTraces(){this._traceBuffer=[]}}},59056:(e,t,r)=>{"use strict";const s=r(58611),n=r(65692),{storage:i}=r(96882);function o(e){return class extends e{constructor(){super({keepAlive:!0,maxSockets:1})}createConnection(...e){return this._noop((()=>super.createConnection(...e)))}keepSocketAlive(...e){return this._noop((()=>super.keepSocketAlive(...e)))}reuseSocket(...e){return this._noop((()=>super.reuseSocket(...e)))}_noop(e){return i.run({noop:!0},e)}}}const a=o(s.Agent),c=o(n.Agent);e.exports={httpAgent:new a,HttpsAgent:new c}},69698:(e,t,r)=>{"use strict";const s=r(79896),n=new RegExp(".*([0-9a-f]{8}[-_][0-9a-f]{4}[-_][0-9a-f]{4}[-_][0-9a-f]{4}[-_][0-9a-f]{12}|[0-9a-f]{8}(?:-[0-9a-f]{4}){4}$|[0-9a-f]{64}|[0-9a-f]{32}-\\d+)(?:\\.scope)?$","m"),i=((function(){try{return s.readFileSync("/proc/self/cgroup").toString()}catch(e){}}()||"").trim().match(n)||[])[1];e.exports={id:()=>i}},43357:(e,t,r)=>{"use strict";const{Readable:s}=r(2203),n=r(94248);e.exports=class extends s{constructor(){super(),this._boundary=n().toString(),this._data=[]}append(e,t,r={}){this._appendBoundary(),r.filename?this._appendFile(e,t,r):this._appendMetadata(e,t,r)}size(){return this._data.reduce(((e,t)=>e+t.length),0)}getHeaders(){return{"Content-Type":"multipart/form-data; boundary="+this._boundary}}_appendBoundary(){this._data.push(`--${this._boundary}\r\n`)}_appendMetadata(e,t){this._data.push(`Content-Disposition: form-data; name="${e}"\r\n\r\n${t}\r\n`)}_appendFile(e,t,{filename:r,contentType:s="application/octet-stream"}){this._data.push(`Content-Disposition: form-data; name="${e}"; filename="${r}"\r\n`),this._data.push(`Content-Type: ${s}\r\n\r\n`),this._data.push(t),this._data.push("\r\n")}_read(){this.push(this._data.shift()),0===this._data.length&&(this.push(`--${this._boundary}--\r\n`),this.push(null))}}},17209:(e,t,r)=>{"use strict";const{Readable:s}=r(2203),n=r(58611),i=r(65692),o=r(43106),{urlToHttpOptions:a}=r(26139),c=r(69698),{httpAgent:u,httpsAgent:l}=r(59056),{storage:p}=r(96882),d=r(75004),h=c.id();let f=0;function g(e,t,r){if(t.headers||(t.headers={}),t.url){const e=function(e){if("object"==typeof e)return a(e);const t=a(new URL(e));if("unix:"===t.protocol&&"."===t.hostname){const r=e.slice(5);t.path=r,t.pathname=r}return t}(t.url);"unix:"===e.protocol?t.socketPath=e.pathname:(t.path||(t.path=e.path),t.protocol=e.protocol,t.hostname=e.hostname,t.port=e.port)}const c=e instanceof s,m=t.timeout||2e3,_="https:"===t.protocol,y=_?i:n,b=[].concat(e);c||(t.headers["Content-Length"]=function(e){return e.length>0?e.reduce(((e,t)=>e+Buffer.byteLength(t,"utf8")),0):0}(b)),h&&(t.headers["Datadog-Container-ID"]=h),t.agent=_?l:u;const v=e=>{const s=[];e.setTimeout(m),e.on("data",(e=>{s.push(e)})),e.on("end",(()=>{f--;const i=Buffer.concat(s);if(e.statusCode>=200&&e.statusCode<=299)"gzip"===e.headers["content-encoding"]?o.gunzip(i,((t,s)=>{t?(d.error("Could not gunzip response: %s",t.message),r(null,"",e.statusCode)):r(null,s.toString(),e.statusCode)})):r(null,i.toString(),e.statusCode);else{let s="";try{s=`Error from ${new URL(t.path,t.url||t.hostname||`http://localhost:${t.port}`).href}: ${e.statusCode} ${n.STATUS_CODES[e.statusCode]}.`}catch(e){}const o=i.toString();o&&(s+=` Response from the endpoint: "${o}"`);const a=new Error(s);a.status=e.statusCode,r(a,null,e.statusCode)}}))},E=s=>{if(!g.writable)return d.debug("Maximum number of active requests reached: payload is discarded."),r(null);f++;const n=p.getStore();p.enterWith({noop:!0});const i=y.request(t,v);i.once("error",(e=>{f--,s(e)})),i.setTimeout(m,i.abort),c?e.pipe(i):(b.forEach((e=>i.write(e))),i.end()),p.enterWith(n)};E((()=>setTimeout((()=>E(r)))))}Object.defineProperty(g,"writable",{get:()=>f<8}),e.exports=g},26139:(e,t,r)=>{"use strict";const{urlToHttpOptions:s}=r(87016);e.exports={urlToHttpOptions:s??function(e){const{hostname:t,pathname:r,port:s,username:n,password:i,search:o}=e,a={__proto__:null,...e,protocol:e.protocol,hostname:"string"==typeof t&&t.startsWith("[")?t.slice(1,-1):t,hash:e.hash,search:o,pathname:r,path:`${r||""}${o||""}`,href:e.href};return""!==s&&(a.port=Number(s)),(n||i)&&(a.auth=`${decodeURIComponent(n)}:${decodeURIComponent(i)}`),a}}},92086:e=>{e.exports={safeJSONStringify:function(e){return JSON.stringify(e,((e,t)=>"dd-api-key"!==e?t:void 0),process.env.DD_TRACE_BEAUTIFUL_LOGS?2:void 0)}}},10097:(e,t,r)=>{"use strict";const s=r(17209),n=r(75004),{safeJSONStringify:i}=r(92086);e.exports=class{constructor({url:e}){this._url=e}flush(e=()=>{}){const t=this._encoder.count();if(s.writable)if(t>0){const r=this._encoder.makePayload();this._sendPayload(r,t,e)}else e();else this._encoder.reset(),e()}append(e){s.writable?(n.debug((()=>`Encoding payload: ${i(e)}`)),this._encode(e)):n.debug((()=>`Maximum number of active requests reached. Payload discarded: ${i(e)}`))}_encode(e){this._encoder.encode(e)}setUrl(e){this._url=e}}},70913:(e,t,r)=>{"use strict";const s=r(75004);e.exports=class{export(e){s.debug((()=>`Adding trace to queue: ${JSON.stringify(e)}`));let t=16,r=[];for(const n of e){const e=JSON.stringify(n);e.length+16>65536?s.debug("Span too large to send to logs, dropping"):(e.length+t>65536&&(this._printSpans(r),r=[],t=16),t+=e.length+1,r.push(e))}r.length>0&&this._printSpans(r)}_printSpans(e){let t='{"traces":[[',r=!0;for(const s of e)r?(r=!1,t+=s):t+=","+s;t+="]]}\n",process.stdout.write(t)}}},81787:(e,t,r)=>{const{URL:s,format:n}=r(87016),{Writer:i}=r(71604);e.exports={SpanStatsExporter:class{constructor(e){const{hostname:t="127.0.0.1",port:r=8126,tags:o,url:a}=e;this._url=a||new s(n({protocol:"http:",hostname:t||"localhost",port:r})),this._writer=new i({url:this._url,tags:o})}export(e){this._writer.append(e),this._writer.flush()}}}},71604:(e,t,r)=>{const{SpanStatsEncoder:s}=r(2424),n=r(8330),i=r(10097),o=r(17209),a=r(75004);e.exports={Writer:class extends i{constructor({url:e}){super(...arguments),this._url=e,this._encoder=new s(this)}_sendPayload(e,t,r){!function(e,t){const s={path:"/v0.6/stats",method:"PUT",headers:{"Datadog-Meta-Lang":"javascript","Datadog-Meta-Tracer-Version":n.version,"Content-Type":"application/msgpack"}};s.protocol=t.protocol,s.hostname=t.hostname,s.port=t.port,a.debug((()=>`Request to the intake: ${JSON.stringify(s)}`)),o(e,s,((e,t)=>{((e,t)=>{if(e)return a.error("Error sending span stats",e),void r();a.debug(`Response from the intake: ${t}`),r()})(e,t)}))}(e,this._url)}}}},47885:(e,t,r)=>{const s=r(75004),n=r(65692);class i{constructor({ddsource:e,hostname:t,service:r,apiKey:n,site:i="datadoghq.com",interval:o=1e4,timeout:a=2e3,limit:c=1e3}){this.enabled=!!n,this.ddsource=e,this.hostname=t,this.service=r,this.interval=o,this.timeout=a,this.queue=[],this.limit=c,this.endpoint="/api/v2/logs",this.site=i,this.intake=`http-intake.logs.${this.site}`,this.headers={"DD-API-KEY":n,"Content-Type":"application/json"},this.timer=setInterval((()=>{this.flush()}),this.interval).unref(),s.debug(`started log writer to https://${this.intake}${this.endpoint}`)}static tagString(e){const t=[];for(const r in e)t.push(r+":"+e[r]);return t.join(",")}log(e,t,r){if(!this.enabled)return;const s=i.tagString(r);t&&(e["dd.trace_id"]=String(t.trace_id),e["dd.span_id"]=String(t.span_id));const n={...e,timestamp:Date.now(),hostname:e.hostname||this.hostname,ddsource:e.ddsource||this.ddsource,service:e.service||this.service,ddtags:s||void 0};this.enqueue(n)}enqueue(e){this.queue.length>=this.limit&&this.flush(),this.queue.push(e)}shutdown(){clearInterval(this.timer),this.flush()}flush(e=()=>{}){let t,r,i;if(!this.queue.length)return void setImmediate((()=>e()));try{t=this.queue,this.queue=[],r=t.length,i=JSON.stringify(t)}catch(t){return s.error(`failed to encode ${r} logs`),void setImmediate((()=>e(t)))}const o={hostname:this.intake,port:443,path:this.endpoint,method:"POST",headers:this.headers,timeout:this.timeout},a=n.request(o,(e=>{s.info(`statusCode: ${e.statusCode}`)}));a.once("error",(t=>{s.error(`failed to send ${r} log(s), with error ${t.message}`),e(t)})),a.write(i),a.end(),a.once("response",(t=>{if(t.statusCode>=400){const n=new Error(`failed to send ${r} logs, received response code ${t.statusCode}`);return s.error(n.message),void e(n)}e()}))}}e.exports.ExternalLogger=i,e.exports.NoopExternalLogger=class{log(){}enqueue(){}shutdown(){}flush(){}}},87262:(e,t,r)=>{"use strict";const{Writable:s}=r(2203);e.exports=class extends s{constructor(){super(),this.length=0,this._buffer=Buffer.alloc(65536)}get data(){return this._buffer.subarray(0,this.length)}_write(e,t,r){const s=Buffer.byteLength(e);this._reserve(s),Buffer.isBuffer(e)?this.length+=e.copy(this._buffer,this.length):this.length+=this._buffer.write(e,t),r()}_reserve(e){for(;this.length+e>this._buffer.length;){const e=Buffer.alloc(2*this.length);this._buffer.copy(e),this._buffer=e}}}},85274:(e,t,r)=>{"use strict";const s=r(75004),n=r(42471),i=r(87262),{LogChannel:o}=r(96402),a=r(17209),c=r(43357);let u,l=null,p=null,d=null;const h={debug:e=>g(e),info:e=>g(e),warn:e=>g(e),error:e=>g(e.stack)},f={enable(e){d=e},disable(){d=null,f.cleanup()},prepare(e){d&&(l?.unsubscribe(h),l=new o(e),l.subscribe(h),p=p||new i,u=u||setTimeout(f.cleanup,12e5))},send(e){if(!d)return;const t=new i;t.write(JSON.stringify(n.tracerInfo(),null,2)),f._sendFile(e,t,"tracer_info.txt"),f._sendFile(e,p,"tracer_logs.txt"),f.cleanup()},cleanup(){l?.unsubscribe(h),u=clearTimeout(u),l=null,p=null},_sendFile(e,t,r){if(!t)return;const n=new c;n.append("case_id",e.case_id),n.append("hostname",e.hostname),n.append("email",e.user_handle),n.append("source","tracer_nodejs"),n.append("flare_file",t.data,{filename:r}),a(n,{url:d.url,hostname:d.hostname,port:d.port,method:"POST",path:"/tracer_flare/v1",headers:n.getHeaders()},(e=>{e&&s.error("Error sending flare payload",e)}))}};function g(e){p.length>12582912||p.write(`${e}\n`)}e.exports=f},99446:(e,t,r)=>{"use strict";const s=r(23636),n=r(74100),i=r(94248),{isError:o}=r(89421),{registerExtraService:a}=r(47583),c=s.SAMPLING_PRIORITY_KEY,u=s.SAMPLING_RULE_DECISION,l=s.SAMPLING_LIMIT_DECISION,p=s.SAMPLING_AGENT_DECISION,d=s.SPAN_SAMPLING_MECHANISM,h=s.SPAN_SAMPLING_RULE_RATE,f=s.SPAN_SAMPLING_MAX_PER_SECOND,g=s.SAMPLING_MECHANISM_SPAN,{MEASURED:m,BASE_SERVICE:_,ANALYTICS:y}=n,b=s.ORIGIN_KEY,v=s.HOSTNAME_KEY,E=s.TOP_LEVEL_KEY,S=s.PROCESS_ID,T=s.ERROR_MESSAGE,w=s.ERROR_STACK,x=s.ERROR_TYPE,A={"operation.name":"name","service.name":"service","span.type":"type","resource.name":"resource"};function I(e,t){t&&(e.error=1,o(t)&&(k(e.meta,e.metrics,T,t.message||t.code),k(e.meta,e.metrics,x,t.name),k(e.meta,e.metrics,w,t.stack)))}function k(e,t,r,s,n){switch(typeof s){case"string":if(!s)break;e[r]=s;break;case"number":if(isNaN(s))break;t[r]=s;break;case"boolean":t[r]=s?1:0;break;case"undefined":break;case"object":if(null===s)break;if((i=s).constructor&&"Buffer"===i.constructor.name&&"function"==typeof i.readInt8&&"function"==typeof i.toString||function(e){return e.constructor&&"URL"===e.constructor.name&&"string"==typeof e.href&&"function"==typeof e.toString}(s))t[r]=s.toString();else if(!Array.isArray(s)&&!n)for(const n in s)O(s,n)&&k(e,t,`${r}.${n}`,s[n],!0)}var i}function O(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e){const t=function(e){const t=e.context();return{trace_id:t._traceId,span_id:t._spanId,parent_id:t._parentId||i("0"),name:String(t._name),resource:String(t._name),error:0,meta:{},meta_struct:e.meta_struct,metrics:{},start:Math.round(1e6*e._startTime),duration:Math.round(1e6*e._duration),links:[]}}(e);return function(e,t){const r=[];if(t._links)for(const e of t._links){const{context:t,attributes:s}=e,n={};n.trace_id=t.toTraceId(!0),n.span_id=t.toSpanId(!0),s&&Object.keys(s).length>0&&(n.attributes=s),t?._sampling?.priority>=0&&(n.flags=t._sampling.priority>0?1:0),t?._tracestate&&(n.tracestate=t._tracestate.toString()),r.push(n)}r.length>0&&(e.meta["_dd.span_links"]=JSON.stringify(r))}(t,e),function(e,t){const r=[];if(t._events)for(const e of t._events){const t={name:e.name,time_unix_nano:Math.round(1e6*e.startTime),attributes:e.attributes&&Object.keys(e.attributes).length>0?e.attributes:void 0};r.push(t)}r.length>0&&(e.meta.events=JSON.stringify(r))}(t,e),function(e,t){const r=t.context(),s=t===r._trace.started[0],n=r._parentId;!s||n&&"0"!==n.toString(10)||(k({},e.metrics,u,r._trace[u]),k({},e.metrics,l,r._trace[l]),k({},e.metrics,p,r._trace[p]),k({},e.metrics,E,1))}(t,e),function(e,t){const r=t.context();if(t===r._trace.started[0])for(const t in r._trace.tags)k(e.meta,e.metrics,t,r._trace.tags[t])}(t,e),function(e,t){const r=t.context(),s=r._trace.origin,n=r._tags,i=r._hostname,o=r._sampling.priority;n["span.kind"]&&"internal"!==n["span.kind"]&&k({},e.metrics,m,1);const u=t.tracer()._service.toLowerCase();n["service.name"]?.toLowerCase()!==u&&(t.setTag(_,u),a(n["service.name"]));for(const t in n)switch(t){case"service.name":case"span.type":case"resource.name":k(e,{},A[t],n[t]);break;case"http.status_code":k(e.meta,{},t,n[t]&&String(n[t]));break;case"analytics.event":k({},e.metrics,y,void 0===n[t]||n[t]?1:0);break;case v:case m:k({},e.metrics,t,void 0===n[t]||n[t]?1:0);break;case"error":"fs.operation"!==r._name&&I(e,n[t]);break;case x:case T:case w:if("fs.operation"===r._name)break;n.setTraceError&&(e.error=1);default:k(e.meta,e.metrics,t,n[t])}(function(e,t){t&&(k({},e.metrics,d,g),k({},e.metrics,h,t.sampleRate),k({},e.metrics,f,t.maxPerSecond))})(e,r._spanSampling),k(e.meta,e.metrics,"language","javascript"),k(e.meta,e.metrics,S,process.pid),k(e.meta,e.metrics,c,o),k(e.meta,e.metrics,b,s),k(e.meta,e.metrics,v,i)}(t,e),t}},33014:(e,t,r)=>{const{SCI_COMMIT_SHA:s,SCI_REPOSITORY_URL:n}=r(23636);e.exports=class{constructor(e){this._config=e}tagGitMetadata(e){this._config.gitMetadataEnabled&&(e._trace.tags[s]=this._config.commitSHA,e._trace.tags[n]=this._config.repositoryUrl)}}},66213:e=>{const t=/git\.commit\.sha=([a-f\d]{40})/,r=/git\.repository_url=([\w\d:@/.-]+)/;function s(e){try{const t=new URL(e);return t.username||t.password?`${t.origin}${t.pathname}`:e}catch(t){return e}}e.exports={getGitMetadataFromGitProperties:function(e){if(!e)return{};const n=e.match(t),i=e.match(r),o=i?i[1]:void 0;return{commitSHA:n?n[1]:void 0,repositoryUrl:s(o)}},removeUserSensitiveInfo:s}},63174:(e,t,r)=>{"use strict";var s=r(6110).isTrue,n=process.env.DD_TRACE_DEBUG,i=process.env.DD_TRACE_LOG_LEVEL,o=s(n)?Number(i)||20:100,a={debug:o<=20?console.debug.bind(console):function(){},info:o<=30?console.info.bind(console):function(){},warn:o<=40?console.warn.bind(console):function(){},error:o<=50?console.error.bind(console):function(){}};e.exports=a},32427:(e,t,r)=>{"use strict";var s=r(79896),n=r(35317).spawn,i=r(8330).version,o=r(63174);e.exports=function(e,t){var r=e;"string"==typeof e&&(r=[{name:e,tags:t||[]}]),-1!==["1","true","True"].indexOf(process.env.DD_INJECT_FORCE)&&(r=r.filter((function(e){return["error","complete"].includes(e.name)}))),r=r.filter((function(e){return!function(e){if("abort"===e.name)return c.includes("abort");if("abort.integration"===e.name){var t=e.name+e.tags.join("");return c.includes(t)}return!1}(e)}));for(var s=0;s<r.length;s++)r[s].name="library_entrypoint."+r[s].name;if(0!==r.length){var i=n(process.env.DD_TELEMETRY_FORWARDER_PATH,["library_entrypoint"],{stdio:"pipe"});i.on("error",(function(){o.error("Failed to spawn telemetry forwarder")})),i.on("exit",(function(e){0!==e&&o.error("Telemetry forwarder exited with code "+e)})),i.stdin.on("error",(function(){o.error("Failed to write telemetry data to telemetry forwarder")})),i.stdin.end(JSON.stringify({metadata:a,points:r}))}},process.env.DD_INJECTION_ENABLED||(e.exports=function(){}),process.env.DD_TELEMETRY_FORWARDER_PATH||(e.exports=function(){}),s.existsSync(process.env.DD_TELEMETRY_FORWARDER_PATH)||(e.exports=function(){});var a={language_name:"nodejs",language_version:process.versions.node,runtime_name:"nodejs",runtime_version:process.versions.node,tracer_version:i,pid:process.pid},c=[]},6110:e=>{"use strict";e.exports={isTrue:function(e){return"true"===(e=String(e).toLowerCase())||"1"===e}}},71155:(e,t,r)=>{"use strict";const{DDSketch:s}=r(4685);e.exports=class{constructor(){this.reset()}get min(){return this._min}get max(){return this._max}get avg(){return 0===this._count?0:this._sum/this._count}get sum(){return this._sum}get count(){return this._count}get median(){return this.percentile(50)}get p95(){return this.percentile(95)}percentile(e){return this._histogram.getValueAtQuantile(e/100)||0}record(e){0===this._count?this._min=this._max=e:(this._min=Math.min(this._min,e),this._max=Math.max(this._max,e)),this._count++,this._sum+=e,this._histogram.accept(e)}reset(){this._min=0,this._max=0,this._sum=0,this._count=0,this._histogram=new s}}},94248:(e,t,r)=>{"use strict";const{randomFillSync:s}=r(76982),n=4294967296,i=new Uint8Array(65536),o=new Uint8Array(8),a=Array.prototype.map,c=e=>`${e<16?"0":""}${e.toString(16)}`;let u=0;class l{constructor(e,t=16){this._buffer=16===t?function(e){if("0"===e)return o;if(!e)return function(){0===u&&s(i),u=(u+1)%8192;const e=8*u;return[127&i[e],i[e+1],i[e+2],i[e+3],i[e+4],i[e+5],i[e+6],i[e+7]]}();const t=16*Math.ceil(e.length/16),r=t/2,n=new Array(r);e=e.padStart(t,"0");for(let t=0;t<r;t++)n[t]=parseInt(e.substring(2*t,2*t+2),16);return n}(e):function(e,t){const r=new Array(8),s=e.length;let i=0,o=0,a=0;"-"===e[0]&&i++;const c=i;for(;i<s;){const r=parseInt(e[i++],t);if(!(r>=0))break;a=a*t+r,o=o*t+Math.floor(a/n),a%=n}return c&&(o=~o,a?a=n-a:o++),d(r,o,0),d(r,a,4),r}(e,t)}toString(e=16){return 16===e?(t=this._buffer,a.call(t,c).join("")):function(e,t){let r=p(e,e.length-8),s=p(e,e.length-4),i="";for(t=t||10;;){const e=r%t*n+s;if(r=Math.floor(r/t),s=Math.floor(e/t),i=(e%t).toString(t)+i,!r&&!s)break}return i}(this._buffer,e);var t}toBuffer(){return this._buffer}toArray(){return 8===this._buffer.length?this._buffer:this._buffer.slice(-8)}toJSON(){return this.toString()}equals(e){for(let t=this._buffer.length,r=e._buffer.length;t>=0&&r>=0;t--,r--)if(this._buffer[t]!==e._buffer[r])return!1;return!0}}function p(e,t){return 16777216*e[t+0]+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3]}function d(e,t,r){e[3+r]=255&t,t>>=8,e[2+r]=255&t,t>>=8,e[1+r]=255&t,t>>=8,e[0+r]=255&t}e.exports=(e,t)=>new l(e,t)},23212:(e,t,r)=>{"use strict";const s=r(99589),n=r(75004),{addHook:i}=r(30616),o=r(1247);if(s.satisfies(process.versions.node,">=14.13.1")){const t=o.channel("dd-trace:moduleLoadStart");i(((e,r)=>{t.hasSubscribers&&t.publish({filename:e,module:r})})),e.exports=r(30616)}else n.warn("ESM is not fully supported by this version of Node.js, so dd-trace will not intercept ESM loading."),e.exports=()=>({unhook:()=>{}}),e.exports.addHook=()=>{},e.exports.removeHook=()=>{}},97853:(e,t,r)=>{"use strict";const{isFalse:s}=r(89421),n="undefined"!=typeof jest,i=process.env.DD_TRACE_ENABLED?s(process.env.DD_TRACE_ENABLED):"none"===String(process.env.OTEL_TRACES_EXPORTER).toLowerCase();e.exports=r(i||n?68698:44741)},41785:(e,t,r)=>{"use strict";const s=r(75004),{channel:n}=r(95092),{ERROR_MESSAGE:i,ERROR_TYPE:o}=r(23636),{ImpendingTimeout:a}=r(69591),c=global._ddtrace._tracer,u=n("apm:aws:lambda:timeout");let l;u.subscribe((e=>{!function(){const e=c.scope().active();if(null!==e){const t=new a("Datadog detected an impending timeout");e.addTags({[i]:t.message,[o]:t.name})}else s.debug("An impending timeout was reached, but no root span was found. No error will be tagged.");c._processor.killAll(),null!==e&&e.finish()}()})),t.datadog=function(e){return(...t)=>{const r=function(e){let t=e.length>1?e[1]:void 0;if((void 0===t||void 0===t.getRemainingTimeInMillis)&&(t=e.length>2?e[2]:void 0,void 0===t||void 0===t.getRemainingTimeInMillis))throw Error("Could not extract context");return t}(t);!function(e){const t=e.getRemainingTimeInMillis();let r=parseInt(process.env.DD_APM_FLUSH_DEADLINE_MILLISECONDS)||100;r=r<0?100:r,l=setTimeout((()=>{u.publish(void 0)}),t-r)}(r);const s=e.apply(this,t);return s&&"function"==typeof s.then?s.then((e=>(clearTimeout(l),e))):(clearTimeout(l),s)}}},74669:(e,t,r)=>{"use strict";const{registerLambdaHook:s}=r(66690),n=process.env.DD_TRACE_DISABLED_INSTRUMENTATIONS||"";new Set(n?n.split(","):[]).has("lambda")||s()},69591:e=>{"use strict";class t extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}}class r extends t{}r.prototype.name="Impending Timeout",e.exports={ImpendingTimeout:r}},96084:(e,t,r)=>{"use strict";const s=r(16928),{_extractModuleNameAndHandlerPath:n,_extractModuleRootAndHandler:i,_getLambdaFilePath:o}=r(66690),{datadog:a}=r(41785),{addHook:c}=r(95092),u=r(81444);function l(e){return t=>e(a(t))}function p(e){return a(e)}const d=process.env.LAMBDA_TASK_ROOT,h=process.env.DD_LAMBDA_HANDLER;if(void 0!==h){const[e,t]=i(h),[r,a]=n(t);c({name:o(s.resolve(d,e,r))},(e=>t=>(u.wrap(t,e,p),t))(a))}else c({name:"datadog-lambda-js"},(e=>(u.wrap(e,"datadog",l),e)))},66690:(e,t,r)=>{"use strict";const s=r(79896),n=r(16928),i=r(75004),o=r(21042),a=r(10502),{filename:c,pathSepExpr:u}=r(948);function l(e){const t=n.basename(e);return[e.substring(0,e.indexOf(t)),t]}function p(e){const t=e.match(/^([^.]*)\.(.*)$/);if(t&&3===t.length)return[t[1],t[2]]}function d(e){let t=e;return s.existsSync(e+".js")?t+=".js":s.existsSync(e+".mjs")?t+=".mjs":s.existsSync(e+".cjs")&&(t+=".cjs"),t}e.exports={_extractModuleRootAndHandler:l,_extractModuleNameAndHandlerPath:p,_getLambdaFilePath:d,registerLambdaHook:()=>{const e=process.env.LAMBDA_TASK_ROOT,t=process.env.DD_LAMBDA_HANDLER;if(void 0!==t&&void 0!==e){const[s,c]=l(t),[u]=p(c),h=d(n.resolve(e,s,u));o([h],(e=>{r(96084);for(const{hook:t}of a[h])try{e=t(e)}catch(e){i.error("Error executing lambda hook",e)}return e}))}else{const e="datadog-lambda-js";o([e],((t,s,n)=>{s=s.replace(u,"/"),r(96084);for(const{name:r,file:n,hook:o}of a[e])if(s===c(r,n))try{t=o(t)}catch(e){i.error("Error executing lambda hook for datadog-lambda-js",e)}return t}))}}}},24550:e=>{"use strict";e.exports={SPAN_KINDS:["llm","agent","workflow","task","tool","embedding","retrieval"],SPAN_KIND:"_ml_obs.meta.span.kind",SESSION_ID:"_ml_obs.session_id",METADATA:"_ml_obs.meta.metadata",METRICS:"_ml_obs.metrics",ML_APP:"_ml_obs.meta.ml_app",PROPAGATED_PARENT_ID_KEY:"_dd.p.llmobs_parent_id",PARENT_ID_KEY:"_ml_obs.llmobs_parent_id",TAGS:"_ml_obs.tags",NAME:"_ml_obs.name",TRACE_ID:"_ml_obs.trace_id",PROPAGATED_TRACE_ID_KEY:"_dd.p.llmobs_trace_id",ROOT_PARENT_ID:"undefined",MODEL_NAME:"_ml_obs.meta.model_name",MODEL_PROVIDER:"_ml_obs.meta.model_provider",INPUT_DOCUMENTS:"_ml_obs.meta.input.documents",INPUT_MESSAGES:"_ml_obs.meta.input.messages",INPUT_VALUE:"_ml_obs.meta.input.value",OUTPUT_DOCUMENTS:"_ml_obs.meta.output.documents",OUTPUT_MESSAGES:"_ml_obs.meta.output.messages",OUTPUT_VALUE:"_ml_obs.meta.output.value",INPUT_TOKENS_METRIC_KEY:"input_tokens",OUTPUT_TOKENS_METRIC_KEY:"output_tokens",TOTAL_TOKENS_METRIC_KEY:"total_tokens",DROPPED_IO_COLLECTION_ERROR:"dropped_io"}},63496:e=>{"use strict";e.exports={DROPPED_VALUE_TEXT:"[This value has been dropped because this span's size exceeds the 1MB size limit.]",UNSERIALIZABLE_VALUE_TEXT:"Unserializable value"}},47079:e=>{"use strict";e.exports={EVP_PROXY_AGENT_BASE_PATH:"evp_proxy/v2",EVP_PROXY_AGENT_ENDPOINT:"evp_proxy/v2/api/v2/llmobs",EVP_SUBDOMAIN_HEADER_NAME:"X-Datadog-EVP-Subdomain",EVP_SUBDOMAIN_HEADER_VALUE:"llmobs-intake",AGENTLESS_SPANS_ENDPOINT:"/api/v2/llmobs",AGENTLESS_EVALULATIONS_ENDPOINT:"/api/intake/llm-obs/v1/eval-metric",EVP_PAYLOAD_SIZE_LIMIT:5<<20,EVP_EVENT_SIZE_LIMIT:1047552}},91817:(e,t,r)=>{"use strict";const s=r(75004),{PROPAGATED_PARENT_ID_KEY:n}=r(24550),{storage:i}=r(84900),o=r(76690),{channel:a}=r(1247),c=a("dd-trace:span:process"),u=a("llmobs:eval-metric:append"),l=a("llmobs:writers:flush"),p=a("dd-trace:span:inject"),d=r(38620),h=r(94370),f=r(32069);let g,m,_;function y({carrier:e}){const t=i.getStore()?.span;if(!t)return;const r=t?.context().toSpanId();e["x-datadog-tags"]+=`,${n}=${r}`}function b(){try{m.flush(),_.flush()}catch(e){s.warn(`Failed to flush LLMObs spans and evaluation metrics: ${e.message}`)}}function v(e){g.process(e)}function E(e){try{_.append(e)}catch(e){s.warn(`\n      Failed to append evaluation metric to LLM Observability writer, likely due to an unserializable property.\n      Evaluation metrics won't be sent to LLM Observability: ${e.message}\n    `)}}e.exports={enable:function(e){_=new f(e),m=function(e){return new(e.llmobs.agentlessEnabled?d:h)(e)}(e),u.subscribe(E),l.subscribe(b),g=new o(e),g.setWriter(m),c.subscribe(v),p.subscribe(y)},disable:function(){u.hasSubscribers&&u.unsubscribe(E),l.hasSubscribers&&l.unsubscribe(b),c.hasSubscribers&&c.unsubscribe(v),p.hasSubscribers&&p.unsubscribe(y),m?.destroy(),_?.destroy(),g?.setWriter(null),m=null,_=null}}},91897:e=>{"use strict";e.exports=class{constructor(e){this._tracer=e}get enabled(){return!1}enable(e){}disable(){}trace(e={},t){"function"==typeof e&&(t=e,e={});const r=e.name||e.kind||t.name;return this._tracer.trace(r,e,t)}wrap(e={},t){"function"==typeof e&&(t=e,e={});const r=e.name||e.kind||t.name;return this._tracer.wrap(r,e,t)}decorate(e={}){const t=this;return function(r,s,n){if(!s)return r;if("object"==typeof s){const n=s;return"method"!==n.kind?r:t.wrap({name:n.name,...e},r)}{const i=s;if(n){if("function"!=typeof n.value)return n;const r=n.value;return n.value=t.wrap({name:i,...e},r),n}{if("function"!=typeof r[i])return r[i];const s=r[i];return Object.defineProperty(r,i,{...Object.getOwnPropertyDescriptor(r,i),value:t.wrap({name:i,...e},s)}),r}}}}annotate(e,t){}exportSpan(e){return{}}submitEvaluation(e,t){}flush(){}}},65869:(e,t,r)=>{"use strict";const s=r(75004),{storage:n}=r(84900),i=r(5288),o=r(72043);e.exports=class extends i{constructor(...e){super(...e),this._tagger=new o(this._tracerConfig,!0)}setLLMObsTags(e){throw new Error("setLLMObsTags must be implemented by the subclass")}getLLMObsSpanRegisterOptions(e){throw new Error("getLLMObsSPanRegisterOptions must be implemented by the subclass")}start(e){if(!this._tracerConfig.llmobs.enabled)return;const t=this.getLLMObsParent(e),r=e.currentStore,s=r?.span,i=this.getLLMObsSpanRegisterOptions(e);i&&(e.llmobs={},n.enterWith({span:s}),e.llmobs.parent=t,this._tagger.registerLLMObsSpan(s,{parent:t,...i}))}end(e){if(!this._tracerConfig.llmobs.enabled)return;const t=e.currentStore,r=t?.span;if(!o.tagMap.has(r))return;const s=e.llmobs.parent;n.enterWith({span:s})}asyncEnd(e){if(!this._tracerConfig.llmobs.enabled)return;const t=e.currentStore,r=t?.span;r?this.setLLMObsTags(e):s.debug(`Tried to start an LLMObs span for ${this.constructor.name} without an active APM span.\n        Not starting LLMObs span.`)}configure(e){!1===this._tracerConfig.llmobs.enabled&&(e="boolean"!=typeof e&&{...e,enabled:!1}),super.configure(e)}getLLMObsParent(){const e=n.getStore();return e?.span}}},37290:(e,t,r)=>{const s=r(65869),{storage:n}=r(96882),i=n("llmobs"),{extractRequestParams:o,extractTextAndResponseReason:a,parseModelId:c}=r(14003),u=["invokeModel"],l={};e.exports=class extends s{constructor(){super(...arguments),this.addSub("apm:aws:request:complete:bedrockruntime",(({response:e})=>{const t=e.request,r=t.operation;if(!u.includes(r))return;const{modelProvider:s,modelName:i}=c(t.params.modelId);if(i.includes("embed"))return;const o=n.getStore()?.span;this.setLLMObsTags({request:t,span:o,response:e,modelProvider:s,modelName:i})})),this.addSub("apm:aws:response:deserialize:bedrockruntime",(({headers:e})=>{const t=e["x-amzn-requestid"],r=e["x-amzn-bedrock-input-token-count"],s=e["x-amzn-bedrock-output-token-count"];l[t]={inputTokensFromHeaders:r&&parseInt(r),outputTokensFromHeaders:s&&parseInt(s)}}))}setLLMObsTags({request:e,span:t,response:r,modelProvider:s,modelName:n}){const c=i.getStore()?.span;this._tagger.registerLLMObsSpan(t,{parent:c,modelName:n.toLowerCase(),modelProvider:s.toLowerCase(),kind:"llm",name:"bedrock-runtime.command"});const u=o(e.params,s),p=a(r,s,n);this._tagger.tagMetadata(t,{temperature:parseFloat(u.temperature)||0,max_tokens:parseInt(u.maxTokens)||0}),this._tagger.tagLLMIO(t,u.prompt,[{content:p.message,role:p.role}]);const{inputTokens:d,outputTokens:h,totalTokens:f}=function({requestId:e,usage:t}){const{inputTokensFromHeaders:r,outputTokensFromHeaders:s}=l[e]||{};delete l[e];const n=t.inputTokens||r||0,i=t.outputTokens||s||0;return{inputTokens:n,outputTokens:i,totalTokens:n+i}}({requestId:r.$metadata.requestId,usage:p.usage});this._tagger.tagMetrics(t,{inputTokens:d,outputTokens:h,totalTokens:f})}}},33141:(e,t,r)=>{"use strict";const s=r(88980),{spanHasError:n}=r(19409);e.exports=class extends s{setMetaTags({span:e,inputs:t,results:r}){let s,i;t&&(s=this.formatIO(t)),i=!r||n(e)?"":this.formatIO(r),this._tagger.tagTextIO(e,s,i)}}},32614:(e,t,r)=>{"use strict";const s=r(88980),n=r(72043),{spanHasError:i}=r(19409);e.exports=class extends s{setMetaTags({span:e,inputs:t,results:r,options:s,integrationName:o}){"openai"===o&&s?.response_format&&this._tagger.changeKind(e,"llm");const a="workflow"===n.getSpanKind(e),c=[];Array.isArray(t)||(t=[t]);for(const e of t)for(const t of e){const e=t.content||"",r=this.getRole(t);c.push({content:e,role:r})}if(i(e))return void(a?this._tagger.tagTextIO(e,c,[{content:""}]):this._tagger.tagLLMIO(e,c,[{content:""}]));const u=[];let l=0,p=0,d=0,h=!1;const f={};if(!a){const e=this.checkTokenUsageChatOrLLMResult(r);l=e.inputTokens,p=e.outputTokens,d=e.totalTokens,h=d>0}for(const e of r.generations)for(const t of e){const e=t.message,r=this.getRole(e),s=e.text||"",n=this.extractToolCalls(e);if(u.push({content:s,role:r,toolCalls:n}),!a&&!h){const{tokens:t,runId:r}=this.checkTokenUsageFromAIMessage(e);f[r]?(f[r].inputTokens+=t.inputTokens,f[r].outputTokens+=t.outputTokens,f[r].totalTokens+=t.totalTokens):f[r]=t}}a||h||(l=Object.values(f).reduce(((e,t)=>e+t.inputTokens),0),p=Object.values(f).reduce(((e,t)=>e+t.outputTokens),0),d=Object.values(f).reduce(((e,t)=>e+t.totalTokens),0)),a?this._tagger.tagTextIO(e,c,u):(this._tagger.tagLLMIO(e,c,u),this._tagger.tagMetrics(e,{inputTokens:l,outputTokens:p,totalTokens:d}))}extractToolCalls(e){let t=e.tool_calls;if(!t)return[];const r=[];Array.isArray(t)||(t=[t]);for(const e of t)r.push({name:e.name||"",arguments:e.args||{},tool_id:e.id||""});return r}}},47113:(e,t,r)=>{"use strict";const s=r(88980),n=r(72043),{spanHasError:i}=r(19409);e.exports=class extends s{setMetaTags({span:e,inputs:t,results:r}){const s="workflow"===n.getSpanKind(e);let o,a;if(o=s?this.formatIO(t):(Array.isArray(t)?t:[t]).map((e=>({text:e}))),i(e)||!r)a="";else{let e,t;"number"==typeof r[0]?(t=1,e=r.length):(t=r.length,e=r[0].length),a=`[${t} embedding(s) returned with size ${e}]`}s?this._tagger.tagTextIO(e,o,a):this._tagger.tagEmbeddingIO(e,o,a)}}},88980:e=>{"use strict";const t={human:"user",ai:"assistant",system:"system"};e.exports=class{constructor(e){this._tagger=e}setMetaTags(){}formatIO(e){if("Object"===e.constructor.name){const t={};for(const[r,s]of Object.entries(e))t[r]=this.formatIO(s);return t}return Array.isArray(e)?e.map((e=>this.formatIO(e))):this.getContentFromMessage(e)}getContentFromMessage(e){if("string"==typeof e)return e;try{const t={};t.content=e.content||"";const r=this.getRole(e);return r&&(t.role=r),t}catch{return JSON.stringify(e)}}checkTokenUsageChatOrLLMResult(e){const t=e.llmOutput,r={inputTokens:0,outputTokens:0,totalTokens:0};if(!t)return r;const s=t.tokenUsage||t.usageMetadata||t.usage||{};return s?(r.inputTokens=s.promptTokens||s.inputTokens||0,r.outputTokens=s.completionTokens||s.outputTokens||0,r.totalTokens=s.totalTokens||r.inputTokens+r.outputTokens,r):r}checkTokenUsageFromAIMessage(e){let t=e.usage_metadata||e.additional_kwargs?.usage;const r=e.run_id||e.id||"",s=r?r.split("-").slice(0,-1).join("-"):"",n=e.response_metadata||{};t=t||n.usage||n.tokenUsage||{};const i=t.promptTokens||t.inputTokens||t.prompt_tokens||t.input_tokens||0,o=t.completionTokens||t.outputTokens||t.completion_tokens||t.output_tokens||0;return{tokens:{inputTokens:i,outputTokens:o,totalTokens:t.totalTokens||i+o},runId:s}}getRole(e){if(e.role)return t[e.role]||e.role;const r="function"==typeof e.getType&&e.getType()||"function"==typeof e._getType&&e._getType();return t[r]||r}}},16219:(e,t,r)=>{"use strict";const s=r(88980),n=r(72043),{spanHasError:i}=r(19409);e.exports=class extends s{setMetaTags({span:e,inputs:t,results:r}){const s="workflow"===n.getSpanKind(e),o=Array.isArray(t)?t:[t];let a;if(i(e))a=[{content:""}];else if(a=r.generations.map((e=>({content:e[0].text}))),!s){const t=this.checkTokenUsageChatOrLLMResult(r);this._tagger.tagMetrics(e,t)}s?this._tagger.tagTextIO(e,o,a):this._tagger.tagLLMIO(e,o,a)}}},40796:(e,t,r)=>{"use strict";const s=r(75004),n=r(65869),i=r(35237)._pluginManager,o=["openai"],a=["llm","chat_model","embedding"],c=r(33141),u=r(32614),l=r(16219),p=r(47113);e.exports=class extends n{static get prefix(){return"tracing:apm:langchain:invoke"}constructor(){super(...arguments),this._handlers={chain:new c(this._tagger),chat_model:new u(this._tagger),llm:new l(this._tagger),embedding:new p(this._tagger)}}getLLMObsSpanRegisterOptions(e){const t=e.currentStore?.span,r=t?.context()._tags||{},s=r["langchain.request.provider"];return{modelProvider:s,modelName:r["langchain.request.model"],kind:this.getKind(e.type,s),name:r["resource.name"]}}setLLMObsTags(e){const t=e.currentStore?.span,r=e.type;if(!Object.keys(this._handlers).includes(r))return void s.warn(`Unsupported LangChain operation type: ${r}`);const n=t?.context()._tags["langchain.request.provider"],i=this.getIntegrationName(r,n);this.setMetadata(t,n);const o=e.args?.[0],a=e.args?.[1],c=e.result;this._handlers[r].setMetaTags({span:t,inputs:o,results:c,options:a,integrationName:i})}setMetadata(e,t){if(!t)return;const r={},s=e?.context()._tags[`langchain.request.${t}.parameters.temperature`]||e?.context()._tags[`langchain.request.${t}.parameters.model_kwargs.temperature`],n=e?.context()._tags[`langchain.request.${t}.parameters.max_tokens`]||e?.context()._tags[`langchain.request.${t}.parameters.maxTokens`]||e?.context()._tags[`langchain.request.${t}.parameters.model_kwargs.max_tokens`];s&&(r.temperature=parseFloat(s)),n&&(r.maxTokens=parseInt(n)),this._tagger.tagMetadata(e,r)}getKind(e,t){if(a.includes(e)){const r=this.getIntegrationName(e,t);if(!this.isLLMIntegrationEnabled(r))return"embedding"===e?"embedding":"llm"}return"workflow"}getIntegrationName(e,t="custom"){return t.startsWith("amazon_bedrock")?"bedrock":t.startsWith("openai")?"openai":"chat_model"===e&&t.startsWith("anthropic")?"anthropic":t}isLLMIntegrationEnabled(e){return o.includes(e)&&i?._pluginsByName[e]?.llmobs?._enabled}}},10902:(e,t,r)=>{"use strict";const s=r(65869);function n(e){switch(e){case"completions.create":return"createCompletion";case"chat.completions.create":return"createChatCompletion";case"embeddings.create":return"createEmbedding";default:return e}}function i(e){return["createCompletion","createChatCompletion","createEmbedding"].includes(e)?e:void 0}function o(e){switch(e){case"createCompletion":return"completion";case"createChatCompletion":return"chat";case"createEmbedding":return"embedding";default:return"unknown"}}e.exports=class extends s{static get prefix(){return"tracing:apm:openai:request"}getLLMObsSpanRegisterOptions(e){const t=i(n(e.methodName));if(!t)return;const r=e.args[0],s="embedding"===o(t)?"embedding":"llm",a=`openai.${t}`;return{modelProvider:"openai",modelName:r.model,kind:s,name:a}}setLLMObsTags(e){const t=e.currentStore?.span,r=i(n(e.methodName));if(!r)return;const s=e.args[0],a=e.result?.data,c=!!t.context()._tags.error,u=o(r);if("completion"===u?this._tagCompletion(t,s,a,c):"chat"===u?this._tagChatCompletion(t,s,a,c):"embedding"===u&&this._tagEmbedding(t,s,a,c),!c){const e=this._extractMetrics(a);this._tagger.tagMetrics(t,e)}}_extractMetrics(e){const t={},r=e.usage;if(r){const e=r.prompt_tokens;e&&(t.inputTokens=e);const s=r.completion_tokens;s&&(t.outputTokens=s);const n=r.total_toksn||e+s;n&&(t.totalTokens=n)}return t}_tagEmbedding(e,t,r,s){const{model:n,...i}=t,o={encoding_format:i.encoding_format||"float"};t.dimensions&&(o.dimensions=t.dimensions),this._tagger.tagMetadata(e,o);let a=t.input;Array.isArray(a)||(a=[a]);const c=a.map((e=>({text:e})));if(s)return void this._tagger.tagEmbeddingIO(e,c,void 0);let u;if(Array.isArray(r.data[0].embedding)){const e=r.data[0].embedding.length;u=`[${r.data.length} embedding(s) returned with size ${e}]`}else u=`[${r.data.length} embedding(s) returned]`;this._tagger.tagEmbeddingIO(e,c,u)}_tagCompletion(e,t,r,s){let{prompt:n,model:i,...o}=t;Array.isArray(n)||(n=[n]);const a=n.map((e=>({content:e}))),c=s?[{content:""}]:r.choices.map((e=>({content:e.text})));this._tagger.tagLLMIO(e,a,c),this._tagger.tagMetadata(e,o)}_tagChatCompletion(e,t,r,s){const{messages:n,model:i,...o}=t;if(s)return void this._tagger.tagLLMIO(e,n,[{content:""}]);const a=[],{choices:c}=r;for(const e of c){const t=e.message||e.delta,r=t.content||"",s=t.role;if(t.function_call){const e={name:t.function_call.name,arguments:JSON.parse(t.function_call.arguments)};a.push({content:r,role:s,toolCalls:[e]})}else if(t.tool_calls){const e=[];for(const r of t.tool_calls){const t={arguments:JSON.parse(r.function.arguments),name:r.function.name,toolId:r.id,type:r.type};e.push(t)}a.push({content:r,role:s,toolCalls:e})}else a.push({content:r,role:s})}this._tagger.tagLLMIO(e,n,a);const u=Object.entries(o).reduce(((e,[t,r])=>(["tools","functions"].includes(t)||(e[t]=r),e)),{});this._tagger.tagMetadata(e,u)}}},46613:(e,t,r)=>{"use strict";const{SPAN_KIND:s,OUTPUT_VALUE:n,INPUT_VALUE:i}=r(24550),{getFunctionArguments:o,validateKind:a}=r(19409),{isTrue:c,isError:u}=r(89421),{storage:l}=r(84900),p=r(41182),d=r(8330).version,h=r(75004),f=r(72043),{channel:g}=r(1247),m=g("llmobs:eval-metric:append"),_=g("llmobs:writers:flush"),y=r(91897);e.exports=class extends y{constructor(e,t,r){super(e),this._config=r,this._llmobsModule=t,this._tagger=new f(r)}get enabled(){return this._config.llmobs.enabled}enable(e={}){if(this.enabled)return void h.debug("LLMObs is already enabled.");h.debug("Enabling LLMObs");const{mlApp:t,agentlessEnabled:r}=e,{DD_LLMOBS_ENABLED:s}=process.env,n={mlApp:t,agentlessEnabled:r};null==s||c(s)?(this._config.llmobs.enabled=!0,this._config.configure({...this._config,llmobs:n}),this._llmobsModule.enable(this._config)):h.debug("LLMObs.enable() called when DD_LLMOBS_ENABLED is false. No action taken.")}disable(){this.enabled?(h.debug("Disabling LLMObs"),this._config.llmobs.enabled=!1,this._llmobsModule.disable()):h.debug("LLMObs is already disabled.")}trace(e={},t){"function"==typeof e&&(t=e,e={});const r=a(e.kind),s=e.name||r;if(!s)throw new Error("No span name provided for `trace`.");const{spanOptions:n,...i}=this._extractOptions(e);return t.length>1?this._tracer.trace(s,n,((e,s)=>this._activate(e,{kind:r,options:i},(()=>t(e,s))))):this._tracer.trace(s,n,(e=>this._activate(e,{kind:r,options:i},(()=>t(e)))))}wrap(e={},t){"function"==typeof e&&(t=e,e={});const r=a(e.kind);let s=e.name||(t?.name?t.name:void 0)||r;s||(h.warn('No span name provided for `wrap`. Defaulting to "unnamed-anonymous-function".'),s="unnamed-anonymous-function");const{spanOptions:n,...i}=this._extractOptions(e),c=this;return this._tracer.wrap(s,n,(function(){const e=c._tracer.scope().active(),s=arguments,n=s.length-1,a=s[n],l="function"==typeof a;if(l){const i=c._bind(a);s[n]=function(){const n=arguments[0],a=arguments[1];return c._autoAnnotate(e,r,o(t,s),u(n)||null==n?a:n),i.apply(this,arguments)}}try{const n=c._activate(e,{kind:r,options:i},(()=>t.apply(this,s)));return n&&"function"==typeof n.then?n.then((n=>(l||c._autoAnnotate(e,r,o(t,s),n),n)),(n=>{throw c._autoAnnotate(e,r,o(t,s)),n})):(l||c._autoAnnotate(e,r,o(t,s),n),n)}catch(n){throw c._autoAnnotate(e,r,o(t,s)),n}}))}annotate(e,t){if(!this.enabled)return;if(e||(e=this._active()),!e||t||e instanceof p||(t=e,e=this._active()),!e)throw new Error("No span provided and no active LLMObs-generated span found");if(!t)throw new Error("No options provided for annotation.");if(!f.tagMap.has(e))throw new Error("Span must be an LLMObs-generated span");if(void 0!==e._duration)throw new Error("Cannot annotate a finished span");const r=f.tagMap.get(e)[s];if(!r)throw new Error("LLMObs span must have a span kind specified");const{inputData:n,outputData:i,metadata:o,metrics:a,tags:c}=t;(n||i)&&("llm"===r?this._tagger.tagLLMIO(e,n,i):"embedding"===r?this._tagger.tagEmbeddingIO(e,n,i):"retrieval"===r?this._tagger.tagRetrievalIO(e,n,i):this._tagger.tagTextIO(e,n,i)),o&&this._tagger.tagMetadata(e,o),a&&this._tagger.tagMetrics(e,a),c&&this._tagger.tagSpanTags(e,c)}exportSpan(e){if(!(e=e||this._active()))throw new Error("No span provided and no active LLMObs-generated span found");if(!(e instanceof p))throw new Error("Span must be a valid Span object.");if(!f.tagMap.has(e))throw new Error("Span must be an LLMObs-generated span");try{return{traceId:e.context().toTraceId(!0),spanId:e.context().toSpanId()}}catch{h.warn("Faild to export span. Span must be a valid Span object.")}}submitEvaluation(e,t={}){if(!this.enabled)return;if(!this._config.apiKey)throw new Error("DD_API_KEY is required for sending evaluation metrics. Evaluation metric data will not be sent.\nEnsure this configuration is set before running your application.");const{traceId:r,spanId:s}=e;if(!r||!s)throw new Error("spanId and traceId must both be specified for the given evaluation metric to be submitted.");const n=t.mlApp||this._config.llmobs.mlApp;if(!n)throw new Error("ML App name is required for sending evaluation metrics. Evaluation metric data will not be sent.");const i=t.timestampMs||Date.now();if("number"!=typeof i||i<0)throw new Error("timestampMs must be a non-negative integer. Evaluation metric data will not be sent");const{label:o,value:a,tags:c}=t,u=t.metricType?.toLowerCase();if(!o)throw new Error("label must be the specified name of the evaluation metric");if(!u||!["categorical","score"].includes(u))throw new Error('metricType must be one of "categorical" or "score"');if("categorical"===u&&"string"!=typeof a)throw new Error("value must be a string for a categorical metric.");if("score"===u&&"number"!=typeof a)throw new Error("value must be a number for a score metric.");const l={"ddtrace.version":d,ml_app:n};if(c)for(const e in c){const t=c[e];if("string"==typeof t)l[e]=t;else if("function"==typeof t.toString)l[e]=t.toString();else{if(null!=t)throw new Error("Failed to parse tags. Tags for evaluation metrics must be strings");l[e]=Object.prototype.toString.call(t)}}const p={span_id:s,trace_id:r,label:o,metric_type:u,ml_app:n,[`${u}_value`]:a,timestamp_ms:i,tags:Object.entries(l).map((([e,t])=>`${e}:${t}`))};m.publish(p)}flush(){this.enabled&&_.publish()}_autoAnnotate(e,t,r,s){const o={};!r||["llm","embedding"].includes(t)||f.tagMap.get(e)?.[i]||(o.inputData=r),!s||["llm","retrieval"].includes(t)||f.tagMap.get(e)?.[n]||(o.outputData=s),this.annotate(e,o)}_active(){const e=l.getStore();return e?.span}_activate(e,t,r){const s=this._active();this.enabled&&l.enterWith({span:e}),t&&this._tagger.registerLLMObsSpan(e,{...t,parent:s});try{return r()}finally{this.enabled&&l.enterWith({span:s})}}_bind(e){if("function"!=typeof e)return e;const t=this,r=t._active();return function(){return t._activate(r,null,(()=>e.apply(this,arguments)))}}_extractOptions(e){const{modelName:t,modelProvider:r,sessionId:s,mlApp:n,...i}=e;return{mlApp:n,modelName:t,modelProvider:r,sessionId:s,spanOptions:i}}}},76690:(e,t,r)=>{"use strict";const{SPAN_KIND:s,MODEL_NAME:n,MODEL_PROVIDER:i,METADATA:o,INPUT_MESSAGES:a,INPUT_VALUE:c,OUTPUT_MESSAGES:u,INPUT_DOCUMENTS:l,OUTPUT_DOCUMENTS:p,OUTPUT_VALUE:d,METRICS:h,ML_APP:f,TAGS:g,PARENT_ID_KEY:m,SESSION_ID:_,NAME:y}=r(24550),{UNSERIALIZABLE_VALUE_TEXT:b}=r(63496),{ERROR_MESSAGE:v,ERROR_TYPE:E,ERROR_STACK:S}=r(23636),T=r(72043),w=r(8330).version,x=r(75004);e.exports=class{constructor(e){this._config=e}setWriter(e){this._writer=e}process({span:e}){if(this._config.llmobs.enabled&&T.tagMap.has(e))try{const t=this.format(e);this._writer.append(t)}catch(e){x.warn(`\n        Failed to append span to LLM Observability writer, likely due to an unserializable property.\n        Span won't be sent to LLM Observability: ${e.message}\n      `)}}format(e){const t=e.context()._tags,r=T.tagMap.get(e),g=r[s],b={"span.kind":g,input:{},output:{}},w={},x={};["llm","embedding"].includes(g)&&(b.model_name=r[n]||"custom",b.model_provider=(r[i]||"custom").toLowerCase()),r[o]&&this._addObject(r[o],b.metadata={}),"llm"===g&&r[a]&&(w.messages=r[a]),r[c]&&(w.value=r[c]),"llm"===g&&r[u]&&(x.messages=r[u]),"embedding"===g&&r[l]&&(w.documents=r[l]),r[d]&&(x.value=r[d]),"retrieval"===g&&r[p]&&(x.documents=r[p]);const A=t.error||t[E];A&&(b[v]=t[v]||A.message||A.code,b[E]=t[E]||A.name,b[S]=t[S]||A.stack),w&&(b.input=w),x&&(b.output=x);const I=r[h]||{},k=r[f],O=r[_],R=r[m],C=r[y]||e._name,N={trace_id:e.context().toTraceId(!0),span_id:e.context().toSpanId(),parent_id:R,name:C,tags:this._processTags(e,k,O,A),start_ns:Math.round(1e6*e._startTime),duration:Math.round(1e6*e._duration),status:A?"error":"ok",meta:b,metrics:I,_dd:{span_id:e.context().toSpanId(),trace_id:e.context().toTraceId(!0)}};return O&&(N.session_id=O),N}_addObject(e,t){const r=new WeakSet;r.add(e);const s=e=>!("object"!=typeof e||!r.has(e)&&(r.add(e),1)),n=(e,t)=>{for(const r in e){const i=e[r];Object.prototype.hasOwnProperty.call(e,r)&&("bigint"==typeof i||s(i)?(x.warn(`Unserializable property found in metadata: ${r}`),t[r]=b):"object"==typeof i?n(i,t[r]={}):t[r]=i)}};n(e,t)}_processTags(e,t,r,s){let n={version:this._config.version,env:this._config.env,service:this._config.service,source:"integration",ml_app:t,"ddtrace.version":w,error:Number(!!s)||0,language:"javascript"};const i=e.context()._tags[E]||s?.name;i&&(n.error_type=i),r&&(n.session_id=r);const o=T.tagMap.get(e)?.[g]||{};return o&&(n={...n,...o}),Object.entries(n).map((([e,t])=>`${e}:${t??""}`))}}},84900:(e,t,r)=>{"use strict";const{storage:s}=r(96882),n=s("llmobs");e.exports={storage:n}},72043:(e,t,r)=>{"use strict";const s=r(75004),{MODEL_NAME:n,MODEL_PROVIDER:i,SESSION_ID:o,ML_APP:a,SPAN_KIND:c,INPUT_VALUE:u,OUTPUT_DOCUMENTS:l,INPUT_DOCUMENTS:p,OUTPUT_VALUE:d,METADATA:h,METRICS:f,PARENT_ID_KEY:g,INPUT_MESSAGES:m,OUTPUT_MESSAGES:_,TAGS:y,NAME:b,PROPAGATED_PARENT_ID_KEY:v,ROOT_PARENT_ID:E,INPUT_TOKENS_METRIC_KEY:S,OUTPUT_TOKENS_METRIC_KEY:T,TOTAL_TOKENS_METRIC_KEY:w}=r(24550),x=new WeakMap;e.exports=class{constructor(e,t=!1){this._config=e,this.softFail=t}static get tagMap(){return x}static getSpanKind(e){return x.get(e)?.[c]}registerLLMObsSpan(e,{modelName:t,modelProvider:r,sessionId:s,mlApp:u,parent:l,kind:p,name:d}={}){if(!this._config.llmobs.enabled)return;if(!p)return;this._register(e),d&&this._setTag(e,b,d),this._setTag(e,c,p),t&&this._setTag(e,n,t),r&&this._setTag(e,i,r),(s=s||x.get(l)?.[o])&&this._setTag(e,o,s),u||(u=x.get(l)?.[a]||this._config.llmobs.mlApp),this._setTag(e,a,u);const h=l?.context().toSpanId()||e.context()._trace.tags[v]||E;this._setTag(e,g,h)}tagLLMIO(e,t,r){this._tagMessages(e,t,m),this._tagMessages(e,r,_)}tagEmbeddingIO(e,t,r){this._tagDocuments(e,t,p),this._tagText(e,r,d)}tagRetrievalIO(e,t,r){this._tagText(e,t,u),this._tagDocuments(e,r,l)}tagTextIO(e,t,r){this._tagText(e,t,u),this._tagText(e,r,d)}tagMetadata(e,t){this._setTag(e,h,t)}tagMetrics(e,t){const r={};for(const[e,s]of Object.entries(t)){let t=e;switch(e){case"inputTokens":t=S;break;case"outputTokens":t=T;break;case"totalTokens":t=w}"number"==typeof s?r[t]=s:this._handleFailure(`Value for metric '${e}' must be a number, instead got ${s}`)}this._setTag(e,f,r)}tagSpanTags(e,t){const r=x.get(e)?.[y];r&&Object.assign(t,r),this._setTag(e,y,t)}changeKind(e,t){this._setTag(e,c,t)}_tagText(e,t,r){if(t)if("string"==typeof t)this._setTag(e,r,t);else try{this._setTag(e,r,JSON.stringify(t))}catch{const e=r===u?"input":"output";this._handleFailure(`Failed to parse ${e} value, must be JSON serializable.`)}}_tagDocuments(e,t,r){if(t){Array.isArray(t)||(t=[t]);const s=t.map((e=>{if("string"==typeof e)return{text:e};if(null==e||"object"!=typeof e)return void this._handleFailure("Documents must be a string, object, or list of objects.");const{text:t,name:r,id:s,score:n}=e;let i=!0;"string"!=typeof t&&(this._handleFailure("Document text must be a string."),i=!1);const o={text:t};return i=this._tagConditionalString(r,"Document name",o,"name")&&i,i=this._tagConditionalString(s,"Document ID",o,"id")&&i,i=this._tagConditionalNumber(n,"Document score",o,"score")&&i,i?o:void 0})).filter((e=>!!e));s.length&&this._setTag(e,r,s)}}_tagMessages(e,t,r){if(t){Array.isArray(t)||(t=[t]);const s=t.map((e=>{if("string"==typeof e)return{content:e};if(null==e||"object"!=typeof e)return void this._handleFailure("Messages must be a string, object, or list of objects");let t=!0;const{content:r="",role:s}=e;let n=e.toolCalls;const i={content:r};if("string"!=typeof r&&(this._handleFailure("Message content must be a string."),t=!1),t=this._tagConditionalString(s,"Message role",i,"role")&&t,n){Array.isArray(n)||(n=[n]);const e=n.map((e=>{if("object"!=typeof e)return void this._handleFailure("Tool call must be an object.");let t=!0;const{name:r,arguments:s,toolId:n,type:i}=e,o={};return t=this._tagConditionalString(r,"Tool name",o,"name")&&t,t=this._tagConditionalObject(s,"Tool arguments",o,"arguments")&&t,t=this._tagConditionalString(n,"Tool ID",o,"tool_id")&&t,t=this._tagConditionalString(i,"Tool type",o,"type")&&t,t?o:void 0})).filter((e=>!!e));e.length&&(i.tool_calls=e)}return t?i:void 0})).filter((e=>!!e));s.length&&this._setTag(e,r,s)}}_tagConditionalString(e,t,r,s){return!e||("string"!=typeof e?(this._handleFailure(`"${t}" must be a string.`),!1):(r[s]=e,!0))}_tagConditionalNumber(e,t,r,s){return!e||("number"!=typeof e?(this._handleFailure(`"${t}" must be a number.`),!1):(r[s]=e,!0))}_tagConditionalObject(e,t,r,s){return!e||("object"!=typeof e?(this._handleFailure(`"${t}" must be an object.`),!1):(r[s]=e,!0))}_handleFailure(e){if(!this.softFail)throw new Error(e);s.warn(e)}_register(e){this._config.llmobs.enabled&&(x.has(e)?this._handleFailure(`LLMObs Span "${e._name}" already registered.`):x.set(e,{}))}_setTag(e,t,r){if(!this._config.llmobs.enabled)return;if(!x.has(e))return void this._handleFailure(`Span "${e._name}" must be an LLMObs generated span.`);const s=x.get(e);Object.assign(s,{[t]:r})}}},19409:(e,t,r)=>{"use strict";const{SPAN_KINDS:s}=r(24550),n=new WeakMap;e.exports={encodeUnicode:function(e){return e?e.split("").map((e=>{const t=e.charCodeAt(0);return t>127?`\\u${t.toString(16).padStart(4,"0")}`:e})).join(""):e},validateKind:function(e){if(!s.includes(e))throw new Error(`\n      Invalid span kind specified: "${e}"\n      Must be one of: ${s.join(", ")}\n    `);return e},getFunctionArguments:function(e,t=[]){if(e&&t.length){if(1===t.length)return t[0];try{let r;if(n.has(e))r=n.get(e);else{const t=e.toString(),{start:s,end:i}=function(e){let t=-1,r=-1,s=0;for(let n=0;n<e.length;n++){const i=e[n];if("("===i)0===s&&(t=n),s++;else if(")"===i&&(s--,0===s)){r=n;break}}return{start:t,end:r}}(t);r=function(e){const t=[];let r="",s=0,n=!0,i=!1,o=!1;for(let a=0;a<e.length;a++){const c=e[a],u=e[a+1];if(o||"/"!==c||"/"!==u)if(i||"/"!==c||"*"!==u){if(i&&"\n"===c)i=!1;else if(o&&"*"===c&&"/"===u)o=!1,a++;else if(!i&&!o){if(["{","[","("].includes(c))s++;else if(["}","]",")"].includes(c))s--;else{if("="===c&&">"!==u&&0===s){n=!1,t.push(r.trim()),r="";continue}if(","===c&&0===s){n&&(t.push(r.trim()),r=""),n=!0;continue}}n&&(r+=c)}}else o=!0,a++;else i=!0,a++}return r&&n&&t.push(r.trim()),t}(t.slice(s+1,i)),n.set(e,r)}const s={};for(const e in t){const n=r[e],i=t[e],o=n?.startsWith("...");if(o){s[n.slice(3)]=t.slice(e);break}s[n]=i}return s}catch{return t}}},spanHasError:function(e){const t=e.context()._tags;return!(!t.error&&!t["error.type"])}}},20997:(e,t,r)=>{"use strict";const s=r(17209),{URL:n,format:i}=r(87016),o=r(75004),{encodeUnicode:a}=r(19409),c=r(75004);e.exports=class{constructor({interval:e,timeout:t,endpoint:r,intake:s,eventType:a,protocol:c,port:u}){this._interval=e||1e3,this._timeout=t||5e3,this._eventType=a,this._buffer=[],this._bufferLimit=1e3,this._bufferSize=0,this._url=new n(i({protocol:c||"https:",hostname:s,port:u||443,pathname:r})),this._headers={"Content-Type":"application/json"},this._periodic=setInterval((()=>{this.flush()}),this._interval).unref(),process.once("beforeExit",(()=>{this.destroy()})),this._destroyed=!1,o.debug(`Started ${this.constructor.name} to ${this._url}`)}append(e,t){this._buffer.length>=this._bufferLimit?o.warn(`${this.constructor.name} event buffer full (limit is ${this._bufferLimit}), dropping event`):(this._bufferSize+=t||Buffer.from(JSON.stringify(e)).byteLength,this._buffer.push(e))}flush(){if(0===this._buffer.length)return;const e=this._buffer;this._buffer=[],this._bufferSize=0;const t=this._encode(this.makePayload(e)),r={headers:this._headers,method:"POST",url:this._url,timeout:this._timeout};c.debug(`Encoded LLMObs payload: ${t}`),s(t,r,((t,r,s)=>{t?o.error("Error sending %d LLMObs %s events to %s: %s",e.length,this._eventType,this._url,t.message,t):s>=300?o.error("Error sending %d LLMObs %s events to %s: %s",e.length,this._eventType,this._url,s):o.debug(`Sent ${e.length} LLMObs ${this._eventType} events to ${this._url}`)}))}makePayload(e){}destroy(){this._destroyed||(o.debug(`Stopping ${this.constructor.name}`),clearInterval(this._periodic),process.removeListener("beforeExit",this.destroy),this.flush(),this._destroyed=!0)}_encode(e){return JSON.stringify(e,((e,t)=>"string"==typeof t?a(t):t)).replace(/\\\\u/g,"\\u")}}},32069:(e,t,r)=>{"use strict";const{AGENTLESS_EVALULATIONS_ENDPOINT:s}=r(47079),n=r(20997);e.exports=class extends n{constructor(e){super({endpoint:s,intake:`api.${e.site}`,eventType:"evaluation_metric"}),this._headers["DD-API-KEY"]=e.apiKey}makePayload(e){return{data:{type:this._eventType,attributes:{metrics:e}}}}}},94370:(e,t,r)=>{"use strict";const{EVP_SUBDOMAIN_HEADER_NAME:s,EVP_SUBDOMAIN_HEADER_VALUE:n,EVP_PROXY_AGENT_ENDPOINT:i}=r(47079),o=r(13383);e.exports=class extends o{constructor(e){super({intake:e.url?.hostname||e.hostname||"localhost",protocol:e.url?.protocol||"http:",endpoint:i,port:e.url?.port||e.port}),this._headers[s]=n}}},38620:(e,t,r)=>{"use strict";const{AGENTLESS_SPANS_ENDPOINT:s}=r(47079),n=r(13383);e.exports=class extends n{constructor(e){super({intake:`llmobs-intake.${e.site}`,endpoint:s}),this._headers["DD-API-KEY"]=e.apiKey}}},13383:(e,t,r)=>{"use strict";const{EVP_EVENT_SIZE_LIMIT:s,EVP_PAYLOAD_SIZE_LIMIT:n}=r(47079),{DROPPED_VALUE_TEXT:i}=r(63496),{DROPPED_IO_COLLECTION_ERROR:o}=r(24550),a=r(20997),c=r(75004),u=r(8330).version;e.exports=class extends a{constructor(e){super({...e,eventType:"span"})}append(e){const t=Buffer.from(JSON.stringify(e)).byteLength;t>s&&(c.warn(`Dropping event input/output because its size (${t}) exceeds the 1MB event size limit`),e=this._truncateSpanEvent(e)),this._bufferSize+t>n&&(c.debug("Flusing queue because queing next event will exceed EvP payload limit"),this.flush()),super.append(e,t)}makePayload(e){return{"_dd.stage":"raw","_dd.tracer_version":u,event_type:this._eventType,spans:e}}_truncateSpanEvent(e){return e.meta.input={value:i},e.meta.output={value:i},e.collection_errors=[o],e}}},96402:(e,t,r)=>{"use strict";const{channel:s}=r(1247),n={trace:10,debug:20,info:30,warn:40,error:50,critical:50,off:100},i=s("datadog:log:trace"),o=s("datadog:log:debug"),a=s("datadog:log:info"),c=s("datadog:log:warn"),u=s("datadog:log:error"),l=n.debug;e.exports={LogChannel:class{constructor(e){this._level=function(e){return e&&"string"==typeof e&&n[e.toLowerCase().trim()]||l}(e)}subscribe(e){n.trace>=this._level&&i.subscribe(e.trace),n.debug>=this._level&&o.subscribe(e.debug),n.info>=this._level&&a.subscribe(e.info),n.warn>=this._level&&c.subscribe(e.warn),n.error>=this._level&&u.subscribe(e.error)}unsubscribe(e){i.hasSubscribers&&i.unsubscribe(e.trace),o.hasSubscribers&&o.unsubscribe(e.debug),a.hasSubscribers&&a.unsubscribe(e.info),c.hasSubscribers&&c.unsubscribe(e.warn),u.hasSubscribers&&u.unsubscribe(e.error)}},traceChannel:i,debugChannel:o,infoChannel:a,warnChannel:c,errorChannel:u}},75004:(e,t,r)=>{"use strict";const s=r(96538),{inspect:n}=r(39023),{isTrue:i}=r(89421),{traceChannel:o,debugChannel:a,infoChannel:c,warnChannel:u,errorChannel:l}=r(96402),p=r(37513),{Log:d}=r(10726),h=e=>{const t={};return function(r){return t[r]||(t[r]=e.apply(this,arguments)),t[r]}},f={enabled:!1,logger:void 0,logLevel:"debug"},g={getConfig:()=>({...f}),use(e){return f.logger=e,p.use(e),this},toggle(e,t){return f.enabled=e,f.logLevel=t,p.toggle(e,t),this},reset(){return p.reset(),this._deprecate=h(((e,t)=>(l.publish(d.parse(t)),!0))),this},trace(...e){if(o.hasSubscribers){const t={};Error.captureStackTrace(t,this.trace);const r=t.stack.split("\n"),s=r[1].replace(/^\s+at ([^\s]+) .+/,"$1"),i={depth:2,breakLength:1/0,compact:!0,maxArrayLength:1/0},a=e.map((e=>n(e,i))).join(", ");r[0]=`Trace: ${s}(${a})`,o.publish(d.parse(r.join("\n")))}return this},debug(...e){return a.hasSubscribers&&a.publish(d.parse(...e)),this},info(...e){return c.hasSubscribers&&c.publish(d.parse(...e)),this},warn(...e){return u.hasSubscribers&&u.publish(d.parse(...e)),this},error(...e){return l.hasSubscribers&&l.publish(d.parse(...e)),this},deprecate(e,t){return this._deprecate(e,t)}};g.reset();const m=i(s(process.env.DD_TRACE_DEBUG,"debug"===process.env.OTEL_LOG_LEVEL,f.enabled)),_=s(process.env.DD_TRACE_LOG_LEVEL,process.env.OTEL_LOG_LEVEL,f.logLevel);g.toggle(m,_),e.exports=g},10726:(e,t,r)=>{"use strict";const{format:s}=r(39023);class n{constructor(e,t,r,s){this.message=e,this.args=t,this.cause=r,this.delegate=s}get formatted(){const{message:e,args:t}=this;let r=e;return e&&t&&t.length&&(r=s(e,...t)),r}static parse(...e){let t,r,s;const i=e[e.length-1];i&&"object"==typeof i&&i.stack&&(r=e.pop());const o=e.shift();return o?"string"==typeof o?t=o:"object"==typeof o?t=String(o.message||o):"function"==typeof o?s=o:t=String(o):r||(t=String(o)),new n(t,e,r,s)}}e.exports={Log:n}},37513:(e,t,r)=>{"use strict";const{storage:s}=r(96882),{LogChannel:n}=r(96402),{Log:i}=r(10726),o={debug:e=>console.debug(e),info:e=>console.info(e),warn:e=>console.warn(e),error:e=>console.error(e)};let a=!1,c=o,u=new n;function l(e){const t=s.getStore();s.enterWith({noop:!0}),e(),s.enterWith(t)}function p(e,t){u.unsubscribe({trace:_,debug:m,info:g,warn:f,error:h}),e&&(u=new n(t),u.subscribe({trace:_,debug:m,info:g,warn:f,error:h}))}function d(e){if(e&&"function"==typeof e.delegate){const t=e.delegate();return Array.isArray(t)?i.parse(...t):i.parse(t)}return e}function h(e){const{formatted:t,cause:r}=d(e);t&&l((()=>c.error(new Error(t)))),r&&l((()=>c.error(r)))}function f(e){const{formatted:t,cause:r}=d(e);t&&l((()=>c.warn(t))),r&&l((()=>c.warn(r)))}function g(e){const{formatted:t,cause:r}=d(e);t&&l((()=>c.info(t))),r&&l((()=>c.info(r)))}function m(e){const{formatted:t,cause:r}=d(e);t&&l((()=>c.debug(t))),r&&l((()=>c.debug(r)))}function _(e){const{formatted:t,cause:r}=d(e);t&&l((()=>c.debug(t))),r&&l((()=>c.debug(r)))}e.exports={use:function(e){e&&e.debug instanceof Function&&e.error instanceof Function&&(c=e)},toggle:function(e,t){a=e,p(a,t)},reset:function(){c=o,a=!1,p(!1)},error:function(...e){h(i.parse(...e))},warn:function(...e){const t=i.parse(...e);if(!c.warn)return m(t);f(t)},info:function(...e){const t=i.parse(...e);if(!c.info)return m(t);g(t)},debug:function(...e){m(i.parse(...e))},trace:function(...e){_(i.parse(...e))}}},14751:e=>{"use strict";e.exports=class{constructor(e=2097152){this.buffer=Buffer.allocUnsafe(e),this.view=new DataView(this.buffer.buffer),this.length=0,this._minSize=e}write(e){const t=Buffer.byteLength(e),r=this.length;return t<32?(this.reserve(t+1),this.buffer[r]=160|t):t<4294967296&&(this.reserve(t+5),this.buffer[r]=219,this.buffer[r+1]=t>>24,this.buffer[r+2]=t>>16,this.buffer[r+3]=t>>8,this.buffer[r+4]=t),this.buffer.utf8Write(e,this.length-t,t),this.length-r}copy(e,t,r){e.set(new Uint8Array(this.buffer.buffer,t,r-t))}set(e){const t=this.length;this.reserve(e.length),this.buffer.set(e,t)}reserve(e){this.length+e>this.buffer.length&&this._resize(this._minSize*Math.ceil((this.length+e)/this._minSize)),this.length+=e}_resize(e){const t=this.buffer;this.buffer=Buffer.allocUnsafe(e),this.view=new DataView(this.buffer.buffer),t.copy(this.buffer,0,0,this.length)}}},17482:(e,t,r)=>{"use strict";const s=r(14751);e.exports={MsgpackEncoder:class{encode(e){const t=new s;return this.encodeValue(t,e),t.buffer.subarray(0,t.length)}encodeValue(e,t){switch(typeof t){case"bigint":this.encodeBigInt(e,t);break;case"boolean":this.encodeBoolean(e,t);break;case"number":this.encodeNumber(e,t);break;case"object":null===t?this.encodeNull(e,t):Array.isArray(t)?this.encodeArray(e,t):Buffer.isBuffer(t)||ArrayBuffer.isView(t)?this.encodeBin(e,t):this.encodeMap(e,t);break;case"string":this.encodeString(e,t);break;case"symbol":this.encodeString(e,t.toString());break;default:this.encodeNull(e,t)}}encodeNull(e){const t=e.length;e.reserve(1),e.buffer[t]=192}encodeBoolean(e,t){const r=e.length;e.reserve(1),e.buffer[r]=t?195:194}encodeString(e,t){e.write(t)}encodeFixArray(e,t=0){const r=e.length;e.reserve(1),e.buffer[r]=144+t}encodeArrayPrefix(e,t){const r=t.length,s=e.length;e.reserve(5),e.buffer[s]=221,e.buffer[s+1]=r>>24,e.buffer[s+2]=r>>16,e.buffer[s+3]=r>>8,e.buffer[s+4]=r}encodeArray(e,t){t.length<16?this.encodeFixArray(e,t.length):this.encodeArrayPrefix(e,t);for(const r of t)this.encodeValue(e,r)}encodeFixMap(e,t=0){const r=e.length;e.reserve(1),e.buffer[r]=128+t}encodeMapPrefix(e,t){const r=e.length;e.reserve(5),e.buffer[r]=223,e.buffer[r+1]=t>>24,e.buffer[r+2]=t>>16,e.buffer[r+3]=t>>8,e.buffer[r+4]=t}encodeByte(e,t){e.reserve(1),e.buffer[e.length-1]=t}encodeBin(e,t){const r=e.length;t.byteLength<256?(e.reserve(2),e.buffer[r]=196,e.buffer[r+1]=t.byteLength):t.byteLength<65536?(e.reserve(3),e.buffer[r]=197,e.buffer[r+1]=t.byteLength>>8,e.buffer[r+2]=t.byteLength):(e.reserve(5),e.buffer[r]=198,e.buffer[r+1]=t.byteLength>>24,e.buffer[r+2]=t.byteLength>>16,e.buffer[r+3]=t.byteLength>>8,e.buffer[r+4]=t.byteLength),e.set(t)}encodeInteger(e,t){const r=e.length;e.reserve(5),e.buffer[r]=206,e.buffer[r+1]=t>>24,e.buffer[r+2]=t>>16,e.buffer[r+3]=t>>8,e.buffer[r+4]=t}encodeShort(e,t){const r=e.length;e.reserve(3),e.buffer[r]=205,e.buffer[r+1]=t>>8,e.buffer[r+2]=t}encodeLong(e,t){const r=e.length,s=t/Math.pow(2,32)|0,n=t>>>0;e.reserve(9),e.buffer[r]=207,e.buffer[r+1]=s>>24,e.buffer[r+2]=s>>16,e.buffer[r+3]=s>>8,e.buffer[r+4]=s,e.buffer[r+5]=n>>24,e.buffer[r+6]=n>>16,e.buffer[r+7]=n>>8,e.buffer[r+8]=n}encodeNumber(e,t){Number.isNaN(t)&&(t=0),Number.isInteger(t)?t>=0?this.encodeUnsigned(e,t):this.encodeSigned(e,t):this.encodeFloat(e,t)}encodeSigned(e,t){const r=e.length;if(t>=-32)e.reserve(1),e.buffer[r]=t;else if(t>=-128)e.reserve(2),e.buffer[r]=208,e.buffer[r+1]=t;else if(t>=-32768)e.reserve(3),e.buffer[r]=209,e.buffer[r+1]=t>>8,e.buffer[r+2]=t;else if(t>=-2147483648)e.reserve(5),e.buffer[r]=210,e.buffer[r+1]=t>>24,e.buffer[r+2]=t>>16,e.buffer[r+3]=t>>8,e.buffer[r+4]=t;else{const s=Math.floor(t/Math.pow(2,32)),n=t>>>0;e.reserve(9),e.buffer[r]=211,e.buffer[r+1]=s>>24,e.buffer[r+2]=s>>16,e.buffer[r+3]=s>>8,e.buffer[r+4]=s,e.buffer[r+5]=n>>24,e.buffer[r+6]=n>>16,e.buffer[r+7]=n>>8,e.buffer[r+8]=n}}encodeUnsigned(e,t){const r=e.length;if(t<=127)e.reserve(1),e.buffer[r]=t;else if(t<=255)e.reserve(2),e.buffer[r]=204,e.buffer[r+1]=t;else if(t<=65535)e.reserve(3),e.buffer[r]=205,e.buffer[r+1]=t>>8,e.buffer[r+2]=t;else if(t<=4294967295)e.reserve(5),e.buffer[r]=206,e.buffer[r+1]=t>>24,e.buffer[r+2]=t>>16,e.buffer[r+3]=t>>8,e.buffer[r+4]=t;else{const s=t/Math.pow(2,32)|0,n=t>>>0;e.reserve(9),e.buffer[r]=207,e.buffer[r+1]=s>>24,e.buffer[r+2]=s>>16,e.buffer[r+3]=s>>8,e.buffer[r+4]=s,e.buffer[r+5]=n>>24,e.buffer[r+6]=n>>16,e.buffer[r+7]=n>>8,e.buffer[r+8]=n}}encodeBigInt(e,t){const r=e.length;e.reserve(9),t>=0n?(e.buffer[r]=207,e.view.setBigUint64(r+1,t)):(e.buffer[r]=211,e.view.setBigInt64(r+1,t))}encodeMap(e,t){const r=Object.keys(t);this.encodeMapPrefix(e,r.length);for(const s of r)this.encodeValue(e,s),this.encodeValue(e,t[s])}encodeFloat(e,t){const r=e.length;e.reserve(9),e.buffer[r]=203,e.view.setFloat64(r+1,t)}}}},69978:(e,t,r)=>{"use strict";const s=r(14751),{MsgpackEncoder:n}=r(17482);e.exports={Chunk:s,MsgpackEncoder:n}},60589:e=>{e.exports=class{increment(){}gauge(){}distribution(){}histogram(){}flush(){}}},68698:(e,t,r)=>{"use strict";const s=r(1301),n=r(11953),i=r(60589),o=r(91897),a=new s,c=new n,u=new i,l=new o(a);e.exports=class{constructor(){this._tracer=a,this.appsec=c,this.dogstatsd=u,this.llmobs=l}init(){return this}use(){return this}profilerStarted(){return Promise.resolve(!1)}trace(e,t,r){if(r||(r=t,t={}),"function"==typeof r)return t=t||{},this._tracer.trace(e,t,r)}wrap(e,t,r){return r||(r=t,t={}),"function"!=typeof r?r:(t=t||{},this._tracer.wrap(e,t,r))}setUrl(){return this._tracer.setUrl.apply(this._tracer,arguments),this}startSpan(){return this._tracer.startSpan.apply(this._tracer,arguments)}inject(){return this._tracer.inject.apply(this._tracer,arguments)}extract(){return this._tracer.extract.apply(this._tracer,arguments)}scope(){return this._tracer.scope.apply(this._tracer,arguments)}getRumData(){return this._tracer.getRumData.apply(this._tracer,arguments)}setUser(e){return this.appsec.setUser(e),this}get TracerProvider(){return r(43434)}}},14702:e=>{"use strict";e.exports=class{active(){return null}activate(e,t){return"function"!=typeof t?t:t()}bind(e,t){return e}}},68800:(e,t,r)=>{"use strict";const s=r(9164),n=r(94248),{storage:i}=r(96882);e.exports=class{constructor(e,t){this._store=i.getHandle(),this._noopTracer=e,this._noopContext=this._createContext(t)}context(){return this._noopContext}tracer(){return this._noopTracer}setOperationName(e){return this}setBaggageItem(e,t){return this}getBaggageItem(e){}getAllBaggageItems(){}removeBaggageItem(e){return this}removeAllBaggageItems(){return this}setTag(e,t){return this}addTags(e){return this}addLink(e){return this}addSpanPointer(e,t,r){return this}log(){return this}logEvent(){}finish(e){}_createContext(e){const t=n();return new s(e?{noop:this,traceId:e._traceId,spanId:t,parentId:e._spanId,baggageItems:Object.assign({},e._baggageItems)}:{noop:this,traceId:t,spanId:t})}}},9164:(e,t,r)=>{"use strict";const s=r(14506),n=r(1013).USER_REJECT;e.exports=class extends s{constructor(e){super(e),this._sampling.priority=n}}},1301:(e,t,r)=>{"use strict";const s=r(14702),n=r(68800);e.exports=class{constructor(e){this._scope=new s,this._span=new n(this)}configure(e){}trace(e,t,r){return r(this._span,(()=>{}))}wrap(e,t,r){return r}scope(){return this._scope}getRumData(){return""}setUrl(){}startSpan(e,t){return this._span}inject(e,t,r){}extract(e,t){return this._span.context()}setUser(){return this}}},23098:(e,t,r)=>{"use strict";const{storage:s}=r(96882),{trace:n,ROOT_CONTEXT:i,propagation:o}=r(20350),a=r(14506),c=r(44317),u=r(14508);e.exports=class{constructor(){this._store=s("opentelemetry")}active(){const e=u.scope().active(),t=this._store.getStore(),r=e&&e.context()||t||i;if(!(r instanceof a)){const e=n.getSpan(r);if(e&&e._spanContext&&e._spanContext._ddContext&&e._spanContext._ddContext._baggageItems){const t=e._spanContext._ddContext._baggageItems,s={};for(const[e,r]of Object.entries(t))s[e]={value:r};const n=o.createBaggage(s);return o.setBaggage(r,n)}return r}const s=JSON.parse(e.getAllBaggageItems()),l={};for(const[e,t]of Object.entries(s))l[e]={value:t};const p=o.createBaggage(l);if(!r._otelSpanContext){const e=new c(r);r._otelSpanContext=e}if(t&&n.getSpanContext(t)===r._otelSpanContext)return p?o.setBaggage(t,p):t;const d=n.setSpanContext(t||i,r._otelSpanContext);return p?o.setBaggage(d,p):d}with(e,t,r,...s){const i=n.getSpan(e),a=u.scope(),c=()=>{const n=null==r?t:t.bind(r);return this._store.run(e,n,...s)},l=o.getBaggage(e);let p=[];if(l&&(p=l.getAllEntries()),i&&i._ddSpan){i._ddSpan.removeAllBaggageItems();for(const e of p)i._ddSpan.setBaggageItem(e[0],e[1].value);return a.activate(i._ddSpan,c)}if(i&&i._spanContext&&i._spanContext._ddContext&&i._spanContext._ddContext._baggageItems){i._spanContext._ddContext._baggageItems={};for(const e of p)i._spanContext._ddContext._baggageItems[e[0]]=e[1].value}return c()}bind(e,t){const r=this;return function(...s){return r.with(e,t,this,...s)}}enable(){}disable(){}}},82573:e=>{"use strict";e.exports=class{shouldSample(e,t,r,s,n,i){return{decision:2}}toString(){return"DatadogSampler"}}},37641:(e,t,r)=>{"use strict";const s=r(20350),{performance:n}=r(82987),{timeOrigin:i}=n,{timeInputToHrTime:o}=r(46372),a=r(14508),c=r(41182),{ERROR_MESSAGE:u,ERROR_TYPE:l,ERROR_STACK:p}=r(23636),{SERVICE_NAME:d,RESOURCE_NAME:h}=r(74100),f=r(79386),g=r(44317),m=r(94248);function _(e){return 1e3*e[0]+e[1]/1e6}const y={[s.SpanKind.INTERNAL]:f.INTERNAL,[s.SpanKind.SERVER]:f.SERVER,[s.SpanKind.CLIENT]:f.CLIENT,[s.SpanKind.PRODUCER]:f.PRODUCER,[s.SpanKind.CONSUMER]:f.CONSUMER};function b(e,t,r){if(e)return e;const n=r["operation.name"];if(n)return n;const{INTERNAL:i,SERVER:o,CLIENT:a}=s.SpanKind;for(const e of["http.method","http.request.method"])if(e in r){if(t===o)return"http.server.request";if(t===a)return"http.client.request"}const c=r["db.system"];if(c&&t===a)return`${c}.query`;const u=r["messaging.system"],l=r["messaging.operation"];if(u&&l&&t!==i)return`${u}.${l}`;const p=r["rpc.system"];if(p){if(t===a)return"aws-api"===p?`aws.${r["rpc.service"]||"client"}.request`:`${p}.client.request`;if(t===o)return`${p}.server.request`}const d=r["faas.invoked_provider"],h=r["faas.invoked_name"],f=r["faas.trigger"];if(t===a&&d&&h)return`${d}.${h}.invoke`;if(t===o&&f)return`${f}.invoke`;if("graphql.operation.type"in r)return"graphql.server.request";const g=r["network.protocol.name"],m=g?`${g}.`:"";return t===o?`${m}server.request`:t===a?`${m}client.request`:y[t]}e.exports=class{constructor(e,t,r,s,u,l=[],p,f){const{_tracer:g}=a,m=o(p||n.now()+i),y=_(m);this._ddSpan=new c(g,g._processor,g._prioritySampler,{operationName:b(r,u,f),context:s._ddContext,startTime:y,hostname:g._hostname,integrationName:e?._isOtelLibrary?"otel.library":"otel",tags:{[d]:g._service,[h]:r},links:l},g._debug),f&&this.setAttributes(f),this._parentTracer=e,this._context=t,this._hasStatus=!1,this.startTime=m,this.kind=u,this._spanProcessor.onStart(this,t)}get parentSpanId(){const{_parentId:e}=this._ddSpan.context();return e&&e.toString(16)}get resource(){return this._parentTracer.resource}get instrumentationLibrary(){return this._parentTracer.instrumentationLibrary}get _spanProcessor(){return this._parentTracer.getActiveSpanProcessor()}get name(){return this._ddSpan.context()._name}spanContext(){return new g(this._ddSpan.context())}setAttribute(e,t){return"http.response.status_code"===e&&this._ddSpan.setTag("http.status_code",t.toString()),this._ddSpan.setTag(e,t),this}setAttributes(e){return"http.response.status_code"in e&&(e["http.status_code"]=e["http.response.status_code"].toString()),this._ddSpan.addTags(e),this}addLink(e,t){const r=e._ddContext;return this._ddSpan.addLink(r,t),this}addSpanPointer(e,t,r){const s=new g({traceId:m("0"),spanId:m("0")}),n={"ptr.kind":e,"ptr.dir":t,"ptr.hash":r,"link.kind":"span-pointer"};return this.addLink(s,n)}setStatus({code:e,message:t}){return this.ended||this._hasStatus||!e||(this._hasStatus=!0,2===e&&this._ddSpan.addTags({[u]:t})),this}updateName(e){return this.ended||this._ddSpan.setOperationName(e),this}end(e){if(this.ended)return void s.diag.error("You can only call end() on a span once.");const t=_(o(e||n.now()+i));this._ddSpan.finish(t),this._spanProcessor.onEnd(this)}isRecording(){return!1===this.ended}addEvent(e,t,r){return r=t&&function(e){return"number"==typeof e||e instanceof Date||!(!Array.isArray(e)||2!==e.length||"number"!=typeof e[0]||"number"!=typeof e[1])}(t)?t:r,r=_(o(r||n.now()+i)),this._ddSpan.addEvent(e,t,r),this}recordException(e,t){this._ddSpan.addTags({[l]:e.name,[u]:e.message,[p]:e.stack,doNotSetTraceError:!0});const r={};e.message&&(r["exception.message"]=e.message),e.type&&(r["exception.type"]=e.type),e.escaped&&(r["exception.escaped"]=e.escaped),e.stack&&(r["exception.stacktrace"]=e.stack),this.addEvent(e.name,r,t)}get duration(){return this._ddSpan._duration}get ended(){return void 0!==this.duration}}},44317:(e,t,r)=>{"use strict";const s=r(20350),{AUTO_KEEP:n}=r(1013),i=r(14506),o=r(94248);e.exports=class{constructor(e){e instanceof i||(e=e?new i(e):function(){const e=o();return new i({traceId:e,spanId:e})}()),this._ddContext=e}get traceId(){return this._ddContext.toTraceId(!0)}get spanId(){return this._ddContext.toSpanId(!0)}get traceFlags(){return this._ddContext._sampling.priority>=n?1:0}get traceState(){const e=this._ddContext._tracestate;return s.createTraceState(e?e.toString():"")}}},59702:e=>{"use strict";class t{forceFlush(){return Promise.resolve()}onStart(e,t){}onEnd(e){}shutdown(){return Promise.resolve()}}e.exports={MultiSpanProcessor:class extends t{constructor(e){super(),this._processors=e}forceFlush(){return Promise.all(this._processors.map((e=>e.forceFlush())))}onStart(e,t){for(const r of this._processors)r.onStart(e,t)}onEnd(e){for(const t of this._processors)t.onEnd(e)}shutdown(){return Promise.all(this._processors.map((e=>e.shutdown())))}},NoopSpanProcessor:t}},2056:(e,t,r)=>{"use strict";const s=r(20350),{sanitizeAttributes:n}=r(46372),i=r(82573),o=r(37641),a=r(94248),c=r(44317),u=r(15711);e.exports=class{constructor(e,t,r){this._sampler=new i,this._config=t,this._tracerProvider=r,this.instrumentationLibrary=e,this._isOtelLibrary=e?.name?.startsWith("@opentelemetry/instrumentation-"),this._spanLimits={}}get resource(){return this._tracerProvider.resource}_createSpanContextFromParent(e){return new c({traceId:e._traceId,spanId:a(),parentId:e._spanId,sampling:e._sampling,baggageItems:Object.assign({},e._baggageItems),trace:e._trace,tracestate:e._tracestate})}_createSpanContextForNewSpan(e){const{traceId:t,spanId:r,traceFlags:s,traceState:n}=e;return u._convertOtelContextToDatadog(t,r,s,n)}startSpan(e,t={},r=s.context.active()){t.root&&(r=s.trace.deleteSpan(r));const i=s.trace.getSpan(r),a=i&&i.spanContext();let u;u=a&&s.trace.isSpanContextValid(a)?a._ddContext?this._createSpanContextFromParent(a._ddContext):this._createSpanContextForNewSpan(a):new c;const l=t.kind||s.SpanKind.INTERNAL,p=(t.links||[]).map((e=>({context:e.context,attributes:n(e.attributes)}))),d=n(t.attributes);return new o(this,r,e,u,l,p,t.startTime,n(d))}startActiveSpan(e,t,r,n){if(2===arguments.length)n=t,r=void 0,t=void 0;else if(3===arguments.length)n=r,r=void 0;else if(4!==arguments.length)return;const i=r||s.context.active(),o=this.startSpan(e,t,i),a=s.trace.setSpan(i,o);return s.context.with(a,n,void 0,o)}getActiveSpanProcessor(){return this._tracerProvider.getActiveSpanProcessor()}getSpanLimits(){return this._spanLimits}}},43434:(e,t,r)=>{"use strict";const{trace:s,context:n,propagation:i}=r(20350),{W3CTraceContextPropagator:o}=r(46372),a=r(14508),c=r(23098),{MultiSpanProcessor:u,NoopSpanProcessor:l}=r(59702),p=r(2056);e.exports=class{constructor(e={}){this.config=e,this.resource=e.resource,this._processors=[],this._tracers=new Map,this._activeProcessor=new l,this._contextManager=new c}getTracer(e="opentelemetry",t="0.0.0",r){const s=`${e}@${t}`;return this._tracers.has(s)||this._tracers.set(s,new p({...r,name:e,version:t},this.config,this)),this._tracers.get(s)}addSpanProcessor(e){this._processors.length||this._activeProcessor.shutdown(),this._processors.push(e),this._activeProcessor=new u(this._processors)}getActiveSpanProcessor(){return this._activeProcessor}register(e={}){n.setGlobalContextManager(this._contextManager),s.setGlobalTracerProvider(this)||s.getTracerProvider().setDelegate(this),e.propagator?i.setGlobalPropagator(e.propagator):i.setGlobalPropagator(new o)}forceFlush(){const e=a._tracer._exporter;return e?(e._writer.flush(),this._activeProcessor.forceFlush()):Promise.reject(new Error("Not started"))}shutdown(){return this._activeProcessor.shutdown()}}},33716:e=>{"use strict";e.exports=class{inject(e,t){}extract(e){return null}}},2937:(e,t,r)=>{"use strict";const s=r(15711);e.exports=class extends s{}},74019:(e,t,r)=>{"use strict";const s=r(94248),n=r(14506);e.exports=class{constructor(e){this._config=e}inject(e,t){t&&(t.dd={},e&&(this._config.traceId128BitLoggingEnabled&&e._trace.tags["_dd.p.tid"]?t.dd.trace_id=e.toTraceId(!0):t.dd.trace_id=e.toTraceId(),t.dd.span_id=e.toSpanId()),this._config.service&&(t.dd.service=this._config.service),this._config.version&&(t.dd.version=this._config.version),this._config.env&&(t.dd.env=this._config.env))}extract(e){if(!(e&&e.dd&&e.dd.trace_id&&e.dd.span_id))return null;if(32===e.dd.trace_id.length){const t=e.dd.trace_id.substring(0,16),r=e.dd.trace_id.substring(16,32),i=new n({traceId:s(r,16),spanId:s(e.dd.span_id,10)});return i._trace.tags["_dd.p.tid"]=t,i}return new n({traceId:s(e.dd.trace_id,10),spanId:s(e.dd.span_id,10)})}}},15711:(e,t,r)=>{"use strict";const s=r(62963),n=r(94248),i=r(14506),o=r(44317),a=r(75004),c=r(18667),u=r(74100),{channel:l}=r(1247),{AUTO_KEEP:p,AUTO_REJECT:d,USER_KEEP:h}=r(1013),f=l("dd-trace:span:inject"),g=l("dd-trace:span:extract"),m="x-datadog-trace-id",_="x-datadog-parent-id",y="x-datadog-origin",b="x-datadog-sampling-priority",v="x-datadog-tags",E="ot-baggage-",S="x-b3-traceid",T=/^([0-9a-f]{16}){1,2}$/i,w="x-b3-spanid",x=/^[0-9a-f]{16}$/i,A="x-b3-parentspanid",I="x-b3-sampled",k="x-b3-flags",O="b3",R=/^(([0-9a-f]{16}){1,2}-[0-9a-f]{16}(-[01d](-[0-9a-f]{16})?)?|[01d])$/i,C=new RegExp(`^${E}(.+)$`),N=/^_dd\.p\.[\x21-\x2b\x2d-\x7e]+$/,P=/^[\x20-\x2b\x2d-\x7e]*$/,D=[m,_,b,y].concat([S,w,A,I,k,O]),L=/^([a-f0-9]{2})-([a-f0-9]{32})-([a-f0-9]{16})-([a-f0-9]{2})(-.*)?$/i,M="traceparent",q=/[^\x20-\x2b\x2d-\x3a\x3c-\x7d]/g,j=/[^\x21-\x2b\x2d-\x3c\x3e-\x7e]/g,U=/[^\x20-\x2b\x2d-\x3a\x3c-\x7d]/g,F=/^0+$/;class B{constructor(e){this._config=e}inject(e,t){e&&t&&(this._injectBaggageItems(e,t),this._injectDatadog(e,t),this._injectB3MultipleHeaders(e,t),this._injectB3SingleHeader(e,t),this._injectTraceparent(e,t),f.hasSubscribers&&f.publish({spanContext:e,carrier:t}),a.debug((()=>`Inject into carrier: ${JSON.stringify(s(t,D))}.`)))}extract(e){const t=this._extractSpanContext(e);return t?(g.hasSubscribers&&g.publish({spanContext:t,carrier:e}),a.debug((()=>`Extract from carrier: ${JSON.stringify(s(e,D))}.`)),t):t}_injectDatadog(e,t){this._hasPropagationStyle("inject","datadog")&&(t[m]=e.toTraceId(),t[_]=e.toSpanId(),this._injectOrigin(e,t),this._injectSamplingPriority(e,t),this._injectTags(e,t))}_injectOrigin(e,t){const r=e._trace.origin;r&&(t[y]=r)}_injectSamplingPriority(e,t){const r=e._sampling.priority;Number.isInteger(r)&&(t[b]=r.toString())}_encodeOtelBaggageKey(e){let t=encodeURIComponent(e);return t=t.replaceAll("(","%28"),t=t.replaceAll(")","%29"),t}_injectBaggageItems(e,t){if(this._config.legacyBaggageEnabled&&e._baggageItems&&Object.keys(e._baggageItems).forEach((r=>{t[E+r]=String(e._baggageItems[r])})),this._hasPropagationStyle("inject","baggage")){let r="",s=0,n=0;for(const[t,i]of Object.entries(e._baggageItems)){const e=`${this._encodeOtelBaggageKey(String(t).trim())}=${encodeURIComponent(String(i).trim())},`;if(s+=1,n+=e.length,s>this._config.baggageMaxItems||n>this._config.baggageMaxBytes)break;r+=e}r=r.slice(0,r.length-1),r&&(t.baggage=r)}}_injectTags(e,t){const r=e._trace;if(0===this._config.tagsHeaderMaxLength)return void a.debug("Trace tag propagation is disabled, skipping injection.");const s=[];for(const e in r.tags)if(r.tags[e]&&e.startsWith("_dd.p.")){if(!this._validateTagKey(e)||!this._validateTagValue(r.tags[e]))return void a.error("Trace tags from span are invalid, skipping injection.");s.push(`${e}=${r.tags[e]}`)}const n=s.join(",");n.length>this._config.tagsHeaderMaxLength?a.error("Trace tags from span are too large, skipping injection."):n&&(t[v]=n)}_injectB3MultipleHeaders(e,t){const r=this._hasPropagationStyle("inject","b3"),s=this._hasPropagationStyle("inject","b3multi");(r||s)&&(t[S]=this._getB3TraceId(e),t[w]=e._spanId.toString(16),t[I]=e._sampling.priority>=p?"1":"0",e._sampling.priority>p&&(t[k]="1"),e._parentId&&(t[A]=e._parentId.toString(16)))}_injectB3SingleHeader(e,t){if(!this._hasPropagationStyle("inject","b3 single header"))return null;const r=this._getB3TraceId(e),s=e._spanId.toString(16),n=e._sampling.priority>=p?"1":"0";t[O]=`${r}-${s}-${n}`,e._parentId&&(t[O]+="-"+e._parentId.toString(16))}_injectTraceparent(e,t){if(!this._hasPropagationStyle("inject","tracecontext"))return;const{_sampling:{priority:r,mechanism:s},_tracestate:n=new c,_trace:{origin:i,tags:o}}=e;t[M]=e.toTraceparent(),n.forVendor("dd",(t=>{if(e._isRemote?e._trace.tags[o.DD_PARENT_ID]&&t.set("p",e._trace.tags[o.DD_PARENT_ID]):t.set("p",e._spanId),t.set("s",r),s&&t.set("t.dm",`-${s}`),"string"==typeof i){const e=i.replace(q,"_").replace(/[\x3d]/g,"~");t.set("o",e)}for(const e in o){if(!o[e]||!e.startsWith("_dd.p."))continue;const r="t."+e.slice(6).replace(j,"_"),s=o[e].toString().replace(U,"_").replace(/[\x3d]/g,"~");t.set(r,s)}})),t.tracestate=n.toString()}_hasPropagationStyle(e,t){return this._config.tracePropagationStyle[e].includes(t)}_hasTraceIdConflict(e,t){return null!==e&&t.toTraceId(!0)===e.toTraceId(!0)&&t.toSpanId()!==e.toSpanId()}_hasParentIdInTags(e){return u.DD_PARENT_ID in e._trace.tags}_updateParentIdFromDdHeaders(e,t){const r=this._extractDatadogContext(e);null!==r&&(t._trace.tags[u.DD_PARENT_ID]=r._spanId.toString().padStart(16,"0"))}_resolveTraceContextConflicts(e,t,r){return this._hasTraceIdConflict(e,t)?(this._hasParentIdInTags(e)?t._trace.tags[u.DD_PARENT_ID]=e._trace.tags[u.DD_PARENT_ID]:this._updateParentIdFromDdHeaders(r,t),t._spanId=e._spanId,t):t}_extractSpanContext(e){let t=null;for(const r of this._config.tracePropagationStyle.extract){let s=null;switch(r){case"datadog":s=this._extractDatadogContext(e);break;case"tracecontext":s=this._extractTraceparentContext(e);break;case"b3 single header":s=this._extractB3SingleContext(e);break;case"b3":s=this._config.tracePropagationStyle.otelPropagators?this._extractB3SingleContext(e):this._extractB3MultiContext(e);break;case"b3multi":s=this._extractB3MultiContext(e);break;default:"baggage"!==r&&a.warn(`Unknown propagation style: ${r}`)}if(null!==s)if(null===t){if(t=s,this._config.tracePropagationExtractFirst)return t}else if("tracecontext"===r&&(t=this._resolveTraceContextConflicts(this._extractTraceparentContext(e),t,e)),s._traceId&&s._spanId&&s.toTraceId(!0)!==t.toTraceId(!0)){const e={context:s,attributes:{reason:"terminated_context",context_headers:r}};t._links.push(e)}}return this._hasPropagationStyle("extract","baggage")&&e.baggage&&(t=t||new i,this._extractBaggageItems(e,t)),t||this._extractSqsdContext(e)}_extractDatadogContext(e){const t=this._extractGenericContext(e,m,_,10);if(!t)return t;if(this._extractOrigin(e,t),this._extractLegacyBaggageItems(e,t),this._extractSamplingPriority(e,t),this._extractTags(e,t),this._config.tracePropagationExtractFirst)return t;const r=this._extractTraceparentContext(e);return r&&t._traceId.equals(r._traceId)&&(t._traceparent=r._traceparent,t._tracestate=r._tracestate),t}_extractB3MultiContext(e){const t=this._extractB3MultipleHeaders(e);return t?this._extractB3Context(t):null}_extractB3SingleContext(e){if(!R.test(e[O]))return null;const t=this._extractB3SingleHeader(e);return t?this._extractB3Context(t):null}_extractB3Context(e){const t="1"===e[k],r=this._getPriority(e[I],t),s=this._extractGenericContext(e,S,w,16);if(void 0!==r){if(!s)return new i({traceId:n(),spanId:null,sampling:{priority:r},isRemote:!0});s._sampling.priority=r}return this._extract128BitTraceId(e[S],s),s}_extractSqsdContext(e){const t=e["x-aws-sqsd-attr-_datadog"];if(!t)return null;let r;try{r=JSON.parse(t)}catch(e){return null}return this._extractDatadogContext(r)}_extractTraceparentContext(e){const t=e[M];if(!t)return null;const r=t.trim().match(L);if(r?.length){const[t,s,o,a,l]=r.slice(1),p={version:t},d=c.fromString(e.tracestate);if(F.test(s))return null;if(F.test(o))return null;if("ff"===t)return null;if(l&&"00"===t)return null;const h=new i({traceId:n(s,16),spanId:n(o,16),isRemote:!0,sampling:{priority:1&parseInt(a,10)?1:0},traceparent:p,tracestate:d});return this._extract128BitTraceId(s,h),d.forVendor("dd",(e=>{for(const[t,r]of e.entries())switch(t){case"p":h._trace.tags[u.DD_PARENT_ID]=r;break;case"s":{const e=parseInt(r,10);if(!Number.isInteger(e))continue;(1===h._sampling.priority&&e>0||0===h._sampling.priority&&e<0)&&(h._sampling.priority=e);break}case"o":h._trace.origin=r;break;case"t.dm":{const e=Math.abs(parseInt(r,10));Number.isInteger(e)&&(h._sampling.mechanism=e,h._trace.tags["_dd.p.dm"]=`-${e}`);break}default:if(!t.startsWith("t."))continue;h._trace.tags[`_dd.p.${t.slice(2)}`]=r.replace(/[\x7e]/gm,"=")}})),this._extractLegacyBaggageItems(e,h),h}return null}_extractGenericContext(e,t,r,s){return e&&e[t]&&e[r]?F.test(e[t])?null:new i({traceId:n(e[t],s),spanId:n(e[r],s),isRemote:!0}):null}_extractB3MultipleHeaders(e){let t=!0;const r={};return T.test(e[S])&&x.test(e[w])&&(r[S]=e[S],r[w]=e[w],t=!1),e[I]&&(r[I]=e[I],t=!1),e[k]&&(r[k]=e[k],t=!1),t?null:r}_extractB3SingleHeader(e){const t=e[O];if(!t)return null;const r=t.split("-");if("d"===r[0])return{[I]:"1",[k]:"1"};if(1===r.length)return{[I]:r[0]};{const e={[S]:r[0],[w]:r[1]};return r[2]&&(e[I]="0"!==r[2]?"1":"0","d"===r[2]&&(e[k]="1")),e}}_extractOrigin(e,t){const r=e[y];"string"==typeof e[y]&&(t._trace.origin=r)}_decodeOtelBaggageKey(e){let t=decodeURIComponent(e);return t=t.replaceAll("%28","("),t=t.replaceAll("%29",")"),t}_extractLegacyBaggageItems(e,t){this._config.legacyBaggageEnabled&&Object.keys(e).forEach((r=>{const s=r.match(C);s&&(t._baggageItems[s[1]]=e[r])}))}_extractBaggageItems(e,t){const r=e.baggage.split(",");for(const e of r){if(!e.includes("="))return void(t._baggageItems={});let[r,s]=e.split("=");if(r=this._decodeOtelBaggageKey(r.trim()),s=decodeURIComponent(s.trim()),!r||!s)return void(t._baggageItems={});if(r in t._baggageItems)return;t._baggageItems[r]=s}}_extractSamplingPriority(e,t){const r=parseInt(e[b],10);Number.isInteger(r)&&(t._sampling.priority=r)}_extractTags(e,t){if(!e[v])return;const r=t._trace;if(0===this._config.tagsHeaderMaxLength)a.debug("Trace tag propagation is disabled, skipping extraction.");else if(e[v].length>this._config.tagsHeaderMaxLength)a.error("Trace tags from carrier are too large, skipping extraction.");else{const t=e[v].split(","),s={};for(const e of t){const[t,...r]=e.split("="),n=r.join("=");if(!this._validateTagKey(t)||!this._validateTagValue(n))return void a.error("Trace tags from carrier are invalid, skipping extraction.");s[t]=n}Object.assign(r.tags,s)}}_extract128BitTraceId(e,t){if(!t)return;if(16!==t._traceId.toBuffer().length)return;const r=e.substring(0,16);"0000000000000000"!==r&&(t._trace.tags["_dd.p.tid"]=r)}_validateTagKey(e){return N.test(e)}_validateTagValue(e){return P.test(e)}_getPriority(e,t){return t?h:"1"===e?p:"0"===e?d:void 0}_getB3TraceId(e){return e._traceId.toBuffer().length<=8&&e._trace.tags["_dd.p.tid"]?e._trace.tags["_dd.p.tid"]+e._traceId.toString(16):e._traceId.toString(16)}static _convertOtelContextToDatadog(e,t,r,s,i={}){let u=r;if(s=s?.traceparent||null){const e=c.fromString(s);let t=null;if(e.forVendor("dd",(e=>(t=e,e))),t){const e=t.get("s"),s=t.get("o"),n=Object.fromEntries(t.entries());Object.assign(i,n),u=B._getSamplingPriority(r,parseInt(e,10),s)}else a.debug(`no dd list member in tracestate from incoming request: ${s}`)}const l=new o({traceId:n(e,16),spanId:n(),tags:i,parentId:n(t,16)});return l._sampling={priority:u},l._trace={origin:null},l}static _getSamplingPriority(e,t,r=null){const s=!t&&"rum"===r;let n;return n=s||0!==e||t&&!(t>=0)?s||1!==e||t&&!(t<0)?t:1:0,n}}e.exports=B},88308:(e,t,r)=>{const s=r(62963),n=r(75004),{DsmPathwayCodec:i}=r(71793),o=["dd-pathway-ctx-base64"];e.exports=class{constructor(e){this.config=e}inject(e,t){this.config.dsmEnabled&&(this._injectDatadogDSMContext(e,t),n.debug((()=>`Inject into carrier (DSM): ${JSON.stringify(s(t,o))}.`)))}extract(e){if(!this.config.dsmEnabled)return;const t=this._extractDatadogDSMContext(e);return t?(n.debug((()=>`Extract from carrier (DSM): ${JSON.stringify(s(e,o))}.`)),t):t}_injectDatadogDSMContext(e,t){i.encode(e,t)}_extractDatadogDSMContext(e){return i.decode(e)}}},18667:e=>{"use strict";const t=/[ \t]*([^=]+)=([ \t]*[^, \t]+)[ \t]*(,|$)/gim,r=/([^:]+):([^;]+)(;|$)/gim;function s(e,t,r){if("string"!=typeof r||!r.length)return new e;const s=[];for(const e of r.matchAll(t))s.unshift(e.slice(1,3));return new e(s)}function n(e,t,r){return Array.from(e.entries()).reverse().map((e=>e.join(t))).join(r)}class i extends Map{constructor(...e){super(...e),this.changed=!1}set(...e){if(!this.has(e[0])||this.get(e[0])!==e[1])return this.changed=!0,super.set(...e)}delete(...e){return this.changed=!0,super.delete(...e)}clear(...e){return this.changed=!0,super.clear(...e)}static fromString(e){return s(i,r,e)}toString(){return n(this,":",";")}}class o extends Map{set(e,t){return this.has(e)&&this.delete(e),super.set(e,t)}forVendor(e,t){const r=super.get(e),s=i.fromString(r),n=t(s);return s.changed&&(s.toString()?this.set(e,s.toString()):this.delete(e)),n}static fromString(e){return s(o,t,e)}toString(){return n(this,"=",",")}}e.exports=o},41182:(e,t,r)=>{"use strict";const{performance:s}=r(82987),n=s.now.bind(s),i=Date.now,o=r(99589),a=r(14506),c=r(94248),u=r(95487),l=r(40091),p=r(75004),{storage:d}=r(96882),h=r(95608),{channel:f}=r(1247),g=r(47466),m=r(39023),_=h.manager.namespace("tracers"),{DD_TRACE_EXPERIMENTAL_STATE_TRACKING:y,DD_TRACE_EXPERIMENTAL_SPAN_COUNTS:b}=process.env,v=O("unfinished"),E=O("finished"),S=!!process.env.DD_TRACE_OTEL_ENABLED,T=["string","number","boolean"],w={spans_created:{},spans_finished:{}},x=f("dd-trace:span:start"),A=f("dd-trace:span:finish");function I(e,t){const r=w[e];if(t in r)return r[t];const s=_.count(e,[`integration_name:${t.toLowerCase()}`,`otel_enabled:${S}`]);return w[e][t]=s,s}class k{constructor(e,t,r,s,n){const i=s.operationName,o=s.parent||null,a=Object.assign({},s.tags),c=s.hostname;this._parentTracer=e,this._debug=n,this._processor=t,this._prioritySampler=r,this._store=d.getHandle(),this._duration=void 0,this._events=[],this._name=i,this._integrationName=s.integrationName||"opentracing",I("spans_created",this._integrationName).inc(),this._spanContext=this._createContext(o,s),this._spanContext._name=i,this._spanContext._tags=a,this._spanContext._hostname=c,this._spanContext._trace.started.push(this),this._startTime=s.startTime||this._getTime(),this._links=[],s.links&&s.links.forEach((e=>this.addLink(e.context,e.attributes))),b&&E&&(l.increment("runtime.node.spans.unfinished"),l.increment("runtime.node.spans.unfinished.by.name",`span_name:${i}`),l.increment("runtime.node.spans.open"),l.increment("runtime.node.spans.open.by.name",`span_name:${i}`),v.register(this,i,this)),g.addSpan(this,i),x.hasSubscribers&&x.publish({span:this,fields:s})}[m.inspect.custom](){return{...this,_parentTracer:`[${this._parentTracer.constructor.name}]`,_prioritySampler:`[${this._prioritySampler.constructor.name}]`,_processor:`[${this._processor.constructor.name}]`}}toString(){const e=this.context(),t=e._tags["resource.name"]||"",r=t.length>100?`${t.substring(0,97)}...`:t;return`Span${JSON.stringify({traceId:e._traceId,spanId:e._spanId,parentId:e._parentId,service:e._tags["service.name"],name:e._name,resource:r})}`}context(){return this._spanContext}tracer(){return this._parentTracer}setOperationName(e){return this._spanContext._name=e,this}setBaggageItem(e,t){return this._spanContext._baggageItems[e]=t,this}getBaggageItem(e){return this._spanContext._baggageItems[e]}getAllBaggageItems(){return JSON.stringify(this._spanContext._baggageItems)}removeBaggageItem(e){delete this._spanContext._baggageItems[e]}removeAllBaggageItems(){this._spanContext._baggageItems={}}setTag(e,t){return this._addTags({[e]:t}),this}addTags(e){return this._addTags(e),this}log(){return this}logEvent(){}addLink(e,t){this._links.push({context:e._ddContext?e._ddContext:e,attributes:this._sanitizeAttributes(t)})}addSpanPointer(e,t,r){const s=new a({traceId:c("0"),spanId:c("0")}),n={"ptr.kind":e,"ptr.dir":t,"ptr.hash":r,"link.kind":"span-pointer"};this.addLink(s,n)}addEvent(e,t,r){const s={name:e};t&&("object"==typeof t?s.attributes=this._sanitizeEventAttributes(t):r=t),s.startTime=r||this._getTime(),this._events.push(s)}finish(e){void 0===this._duration&&("true"===y&&(this._spanContext._tags["service.name"]||p.error("Finishing invalid span: %s",this)),I("spans_finished",this._integrationName).inc(),b&&E&&(l.decrement("runtime.node.spans.unfinished"),l.decrement("runtime.node.spans.unfinished.by.name",`span_name:${this._name}`),l.increment("runtime.node.spans.finished"),l.increment("runtime.node.spans.finished.by.name",`span_name:${this._name}`),l.decrement("runtime.node.spans.open"),l.decrement("runtime.node.spans.open.by.name",`span_name:${this._name}`),v.unregister(this),E.register(this,this._name)),e=parseFloat(e)||this._getTime(),this._duration=e-this._startTime,this._spanContext._trace.finished.push(this),this._spanContext._isFinished=!0,A.publish(this),this._processor.process(this))}_sanitizeAttributes(e={}){const t={},r=(e,s)=>{if(Array.isArray(s))for(const t in s)r(`${e}.${t}`,s[t]);else{const r=s;T.includes(typeof r)?t[e]="string"==typeof r?r:String(r):p.warn("Dropping span link attribute. It is not of an allowed type")}};return Object.entries(e).forEach((e=>{const[t,s]=e;r(t,s)})),t}_sanitizeEventAttributes(e={}){const t={};for(const r in e){const s=e[r];if(Array.isArray(s)){const e=[];for(const t in s)T.includes(typeof s[t])?e.push(s[t]):p.warn("Dropping span event attribute. It is not of an allowed type");t[r]=e}else T.includes(typeof s)?t[r]=s:p.warn("Dropping span event attribute. It is not of an allowed type")}return t}_createContext(e,t){let r,s;if(t.context)r=t.context,r._trace.startTime||(s=i());else if(e)r=new a({traceId:e._traceId,spanId:c(),parentId:e._spanId,sampling:e._sampling,baggageItems:Object.assign({},e._baggageItems),trace:e._trace,tracestate:e._tracestate}),r._trace.startTime||(s=i());else{const e=c();s=i(),r=new a({traceId:e,spanId:e}),r._trace.startTime=s,t.traceId128BitGenerationEnabled&&(r._trace.tags["_dd.p.tid"]=Math.floor(s/1e3).toString(16).padStart(8,"0").padEnd(16,"0"))}return r._trace.ticks=r._trace.ticks||n(),s&&(r._trace.startTime=s),r._isRemote=!1,r}_getTime(){const{startTime:e,ticks:t}=this._spanContext._trace;return e+n()-t}_addTags(e){u.add(this._spanContext._tags,e),this._prioritySampler.sample(this,!1)}}function O(e){if(o.satisfies(process.version,">=14.6"))return new global.FinalizationRegistry((t=>{l.decrement(`runtime.node.spans.${e}`),l.decrement(`runtime.node.spans.${e}.by.name`,[`span_name:${t}`])}))}e.exports=k},14506:(e,t,r)=>{"use strict";const s=r(39023),{AUTO_KEEP:n}=r(1013),i="_dd.p.tid";class o{constructor(e){e=e||{},this._traceId=e.traceId,this._spanId=e.spanId,this._isRemote=e.isRemote??!0,this._parentId=e.parentId||null,this._name=e.name,this._isFinished=e.isFinished||!1,this._tags=e.tags||{},this._sampling=e.sampling||{},this._spanSampling=void 0,this._links=e.links||[],this._baggageItems=e.baggageItems||{},this._traceparent=e.traceparent,this._tracestate=e.tracestate,this._noop=e.noop||null,this._trace=e.trace||{started:[],finished:[],tags:{}},this._otelSpanContext=void 0}[s.inspect.custom](){return{...this,_trace:{...this._trace,started:"[Array]",finished:"[Array]"}}}toTraceId(e=!1){return e?this._traceId.toBuffer().length<=8&&this._trace.tags[i]?this._trace.tags[i]+this._traceId.toString(16).padStart(16,"0"):this._traceId.toString(16).padStart(32,"0"):this._traceId.toString(10)}toSpanId(e=!1){return e?this._spanId.toString(16).padStart(16,"0"):this._spanId.toString(10)}toTraceparent(){const e=this._sampling.priority>=n?"01":"00",t=this.toTraceId(!0),r=this.toSpanId(!0);return`${this._traceparent&&this._traceparent.version||"00"}-${t}-${r}-${e}`}}e.exports=o},16527:(e,t,r)=>{"use strict";const s=r(70857),n=r(41182),i=r(5214),o=r(15134),a=r(15711),c=r(88308),u=r(2937),l=r(33716),p=r(74019),d=r(59429),h=r(75004),f=r(40091),g=r(79312),m=r(14506);e.exports=class{constructor(e,t){const r=g(e.experimental.exporter);this._config=e,this._service=e.service,this._version=e.version,this._env=e.env,this._logInjection=e.logInjection,this._debug=e.debug,this._prioritySampler=t??new o(e.env,e.sampler),this._exporter=new r(e,this._prioritySampler),this._processor=new i(this._exporter,this._prioritySampler,e),this._url=this._exporter._url,this._enableGetRumData=e.experimental.enableGetRumData,this._traceId128BitGenerationEnabled=e.traceId128BitGenerationEnabled,this._propagators={[d.TEXT_MAP]:new a(e),[d.HTTP_HEADERS]:new u(e),[d.BINARY]:new l(e),[d.LOG]:new p(e),[d.TEXT_MAP_DSM]:new c(e)},e.reportHostname&&(this._hostname=s.hostname())}startSpan(e,t={}){const r=t.childOf?((i=t.childOf)instanceof n&&(i=i.context()),i instanceof m||(i=null),i):function(e=[]){let t=null;for(let r=0;r<e.length;r++){const s=e[r],n=s.type();if("child_of"===n){t=s.referencedContext();break}"follows_from"===n&&(t||(t=s.referencedContext()))}return t}(t.references),s={"service.name":t?.tags?.service?String(t.tags.service):this._service};var i;t?.tags?.service&&t.tags.service!==this._service&&(t.tags.version=void 0);const o=new n(this,this._processor,this._prioritySampler,{operationName:t.operationName||e,parent:r,tags:s,startTime:t.startTime,hostname:this._hostname,traceId128BitGenerationEnabled:this._traceId128BitGenerationEnabled,integrationName:t.integrationName,links:t.links},this._debug);return o.addTags(this._config.tags),o.addTags(t.tags),o}inject(e,t,r){e instanceof n&&(e=e.context());try{"text_map_dsm"!==t&&this._prioritySampler.sample(e),this._propagators[t].inject(e,r)}catch(e){h.error("Error injecting trace",e),f.increment("datadog.tracer.node.inject.errors",!0)}}extract(e,t){try{return this._propagators[e].extract(t)}catch(e){return h.error("Error extracting trace",e),f.increment("datadog.tracer.node.extract.errors",!0),null}}}},16569:(e,t,r)=>{const s={aws:r(88123)};function n(e,t,r){return Object.fromEntries(Object.entries(e).map((([e,s])=>[e,{request:s.request.concat(t||[]),response:s.response.concat(r||[]),expand:s.expand||[]}])))}e.exports={appendRules:function(e,t){return Object.fromEntries(Object.entries(s).map((([r,s])=>[r,n(s,e,t)])))}}},85458:(e,t,r)=>{const s=r(89844)({proto:!1,circles:!1}),{PAYLOAD_TAG_REQUEST_PREFIX:n,PAYLOAD_TAG_RESPONSE_PREFIX:i}=r(23636),o=r(73742).E,{tagsFromObject:a}=r(69321);function c(e){if("string"!=typeof e||"{"!==e[0])return e;try{return JSON.parse(e)}catch(t){return e}}function u(e,t,r){const i=s(t),u=r.prefix===n?e.request:e.response;return function(e,t){for(const r of t)o(r,e,((e,t,r)=>{r.parent[r.parentProperty]=c(e)}))}(i,e.expand),function(e,t){for(const r of t)o(r,e,((e,t,r)=>{r.parent[r.parentProperty]="redacted"}))}(i,u),a(i,r)}e.exports={computeTags:u,tagsFromRequest:function(e,t,r){return u(e,t,{...r,prefix:n})},tagsFromResponse:function(e,t,r){return u(e,t,{...r,prefix:i})}}},73742:(e,t,r)=>{"use strict";const s=Object.hasOwn||((e,t)=>Object.prototype.hasOwnProperty.call(e,t));var n=r(69154);class i{static get version(){return"1.3.9"}static toString(){return"JavaScript Expression Parser (JSEP) v"+i.version}static addUnaryOp(e){return i.max_unop_len=Math.max(e.length,i.max_unop_len),i.unary_ops[e]=1,i}static addBinaryOp(e,t,r){return i.max_binop_len=Math.max(e.length,i.max_binop_len),i.binary_ops[e]=t,r?i.right_associative.add(e):i.right_associative.delete(e),i}static addIdentifierChar(e){return i.additional_identifier_chars.add(e),i}static addLiteral(e,t){return i.literals[e]=t,i}static removeUnaryOp(e){return delete i.unary_ops[e],e.length===i.max_unop_len&&(i.max_unop_len=i.getMaxKeyLen(i.unary_ops)),i}static removeAllUnaryOps(){return i.unary_ops={},i.max_unop_len=0,i}static removeIdentifierChar(e){return i.additional_identifier_chars.delete(e),i}static removeBinaryOp(e){return delete i.binary_ops[e],e.length===i.max_binop_len&&(i.max_binop_len=i.getMaxKeyLen(i.binary_ops)),i.right_associative.delete(e),i}static removeAllBinaryOps(){return i.binary_ops={},i.max_binop_len=0,i}static removeLiteral(e){return delete i.literals[e],i}static removeAllLiterals(){return i.literals={},i}get char(){return this.expr.charAt(this.index)}get code(){return this.expr.charCodeAt(this.index)}constructor(e){this.expr=e,this.index=0}static parse(e){return new i(e).parse()}static getMaxKeyLen(e){return Math.max(0,...Object.keys(e).map((e=>e.length)))}static isDecimalDigit(e){return e>=48&&e<=57}static binaryPrecedence(e){return i.binary_ops[e]||0}static isIdentifierStart(e){return e>=65&&e<=90||e>=97&&e<=122||e>=128&&!i.binary_ops[String.fromCharCode(e)]||i.additional_identifier_chars.has(String.fromCharCode(e))}static isIdentifierPart(e){return i.isIdentifierStart(e)||i.isDecimalDigit(e)}throwError(e){const t=new Error(e+" at character "+this.index);throw t.index=this.index,t.description=e,t}runHook(e,t){if(i.hooks[e]){const r={context:this,node:t};return i.hooks.run(e,r),r.node}return t}searchHook(e){if(i.hooks[e]){const t={context:this};return i.hooks[e].find((function(e){return e.call(t.context,t),t.node})),t.node}}gobbleSpaces(){let e=this.code;for(;e===i.SPACE_CODE||e===i.TAB_CODE||e===i.LF_CODE||e===i.CR_CODE;)e=this.expr.charCodeAt(++this.index);this.runHook("gobble-spaces")}parse(){this.runHook("before-all");const e=this.gobbleExpressions(),t=1===e.length?e[0]:{type:i.COMPOUND,body:e};return this.runHook("after-all",t)}gobbleExpressions(e){let t,r,s=[];for(;this.index<this.expr.length;)if(t=this.code,t===i.SEMCOL_CODE||t===i.COMMA_CODE)this.index++;else if(r=this.gobbleExpression())s.push(r);else if(this.index<this.expr.length){if(t===e)break;this.throwError('Unexpected "'+this.char+'"')}return s}gobbleExpression(){const e=this.searchHook("gobble-expression")||this.gobbleBinaryExpression();return this.gobbleSpaces(),this.runHook("after-expression",e)}gobbleBinaryOp(){this.gobbleSpaces();let e=this.expr.substr(this.index,i.max_binop_len),t=e.length;for(;t>0;){if(i.binary_ops.hasOwnProperty(e)&&(!i.isIdentifierStart(this.code)||this.index+e.length<this.expr.length&&!i.isIdentifierPart(this.expr.charCodeAt(this.index+e.length))))return this.index+=t,e;e=e.substr(0,--t)}return!1}gobbleBinaryExpression(){let e,t,r,s,n,o,a,c,u;if(o=this.gobbleToken(),!o)return o;if(t=this.gobbleBinaryOp(),!t)return o;for(n={value:t,prec:i.binaryPrecedence(t),right_a:i.right_associative.has(t)},a=this.gobbleToken(),a||this.throwError("Expected expression after "+t),s=[o,n,a];t=this.gobbleBinaryOp();){if(r=i.binaryPrecedence(t),0===r){this.index-=t.length;break}n={value:t,prec:r,right_a:i.right_associative.has(t)},u=t;const c=e=>n.right_a&&e.right_a?r>e.prec:r<=e.prec;for(;s.length>2&&c(s[s.length-2]);)a=s.pop(),t=s.pop().value,o=s.pop(),e={type:i.BINARY_EXP,operator:t,left:o,right:a},s.push(e);e=this.gobbleToken(),e||this.throwError("Expected expression after "+u),s.push(n,e)}for(c=s.length-1,e=s[c];c>1;)e={type:i.BINARY_EXP,operator:s[c-1].value,left:s[c-2],right:e},c-=2;return e}gobbleToken(){let e,t,r,s;if(this.gobbleSpaces(),s=this.searchHook("gobble-token"),s)return this.runHook("after-token",s);if(e=this.code,i.isDecimalDigit(e)||e===i.PERIOD_CODE)return this.gobbleNumericLiteral();if(e===i.SQUOTE_CODE||e===i.DQUOTE_CODE)s=this.gobbleStringLiteral();else if(e===i.OBRACK_CODE)s=this.gobbleArray();else{for(t=this.expr.substr(this.index,i.max_unop_len),r=t.length;r>0;){if(i.unary_ops.hasOwnProperty(t)&&(!i.isIdentifierStart(this.code)||this.index+t.length<this.expr.length&&!i.isIdentifierPart(this.expr.charCodeAt(this.index+t.length)))){this.index+=r;const e=this.gobbleToken();return e||this.throwError("missing unaryOp argument"),this.runHook("after-token",{type:i.UNARY_EXP,operator:t,argument:e,prefix:!0})}t=t.substr(0,--r)}i.isIdentifierStart(e)?(s=this.gobbleIdentifier(),i.literals.hasOwnProperty(s.name)?s={type:i.LITERAL,value:i.literals[s.name],raw:s.name}:s.name===i.this_str&&(s={type:i.THIS_EXP})):e===i.OPAREN_CODE&&(s=this.gobbleGroup())}return s?(s=this.gobbleTokenProperty(s),this.runHook("after-token",s)):this.runHook("after-token",!1)}gobbleTokenProperty(e){this.gobbleSpaces();let t=this.code;for(;t===i.PERIOD_CODE||t===i.OBRACK_CODE||t===i.OPAREN_CODE||t===i.QUMARK_CODE;){let r;if(t===i.QUMARK_CODE){if(this.expr.charCodeAt(this.index+1)!==i.PERIOD_CODE)break;r=!0,this.index+=2,this.gobbleSpaces(),t=this.code}this.index++,t===i.OBRACK_CODE?((e={type:i.MEMBER_EXP,computed:!0,object:e,property:this.gobbleExpression()}).property||this.throwError('Unexpected "'+this.char+'"'),this.gobbleSpaces(),t=this.code,t!==i.CBRACK_CODE&&this.throwError("Unclosed ["),this.index++):t===i.OPAREN_CODE?e={type:i.CALL_EXP,arguments:this.gobbleArguments(i.CPAREN_CODE),callee:e}:(t===i.PERIOD_CODE||r)&&(r&&this.index--,this.gobbleSpaces(),e={type:i.MEMBER_EXP,computed:!1,object:e,property:this.gobbleIdentifier()}),r&&(e.optional=!0),this.gobbleSpaces(),t=this.code}return e}gobbleNumericLiteral(){let e,t,r="";for(;i.isDecimalDigit(this.code);)r+=this.expr.charAt(this.index++);if(this.code===i.PERIOD_CODE)for(r+=this.expr.charAt(this.index++);i.isDecimalDigit(this.code);)r+=this.expr.charAt(this.index++);if(e=this.char,"e"===e||"E"===e){for(r+=this.expr.charAt(this.index++),e=this.char,"+"!==e&&"-"!==e||(r+=this.expr.charAt(this.index++));i.isDecimalDigit(this.code);)r+=this.expr.charAt(this.index++);i.isDecimalDigit(this.expr.charCodeAt(this.index-1))||this.throwError("Expected exponent ("+r+this.char+")")}return t=this.code,i.isIdentifierStart(t)?this.throwError("Variable names cannot start with a number ("+r+this.char+")"):(t===i.PERIOD_CODE||1===r.length&&r.charCodeAt(0)===i.PERIOD_CODE)&&this.throwError("Unexpected period"),{type:i.LITERAL,value:parseFloat(r),raw:r}}gobbleStringLiteral(){let e="";const t=this.index,r=this.expr.charAt(this.index++);let s=!1;for(;this.index<this.expr.length;){let t=this.expr.charAt(this.index++);if(t===r){s=!0;break}if("\\"===t)switch(t=this.expr.charAt(this.index++),t){case"n":e+="\n";break;case"r":e+="\r";break;case"t":e+="\t";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:e+=t}else e+=t}return s||this.throwError('Unclosed quote after "'+e+'"'),{type:i.LITERAL,value:e,raw:this.expr.substring(t,this.index)}}gobbleIdentifier(){let e=this.code,t=this.index;for(i.isIdentifierStart(e)?this.index++:this.throwError("Unexpected "+this.char);this.index<this.expr.length&&(e=this.code,i.isIdentifierPart(e));)this.index++;return{type:i.IDENTIFIER,name:this.expr.slice(t,this.index)}}gobbleArguments(e){const t=[];let r=!1,s=0;for(;this.index<this.expr.length;){this.gobbleSpaces();let n=this.code;if(n===e){r=!0,this.index++,e===i.CPAREN_CODE&&s&&s>=t.length&&this.throwError("Unexpected token "+String.fromCharCode(e));break}if(n===i.COMMA_CODE){if(this.index++,s++,s!==t.length)if(e===i.CPAREN_CODE)this.throwError("Unexpected token ,");else if(e===i.CBRACK_CODE)for(let e=t.length;e<s;e++)t.push(null)}else if(t.length!==s&&0!==s)this.throwError("Expected comma");else{const e=this.gobbleExpression();e&&e.type!==i.COMPOUND||this.throwError("Expected comma"),t.push(e)}}return r||this.throwError("Expected "+String.fromCharCode(e)),t}gobbleGroup(){this.index++;let e=this.gobbleExpressions(i.CPAREN_CODE);if(this.code===i.CPAREN_CODE)return this.index++,1===e.length?e[0]:!!e.length&&{type:i.SEQUENCE_EXP,expressions:e};this.throwError("Unclosed (")}gobbleArray(){return this.index++,{type:i.ARRAY_EXP,elements:this.gobbleArguments(i.CBRACK_CODE)}}}const o=new class{add(e,t,r){if("string"!=typeof arguments[0])for(let e in arguments[0])this.add(e,arguments[0][e],arguments[1]);else(Array.isArray(e)?e:[e]).forEach((function(e){this[e]=this[e]||[],t&&this[e][r?"unshift":"push"](t)}),this)}run(e,t){this[e]=this[e]||[],this[e].forEach((function(e){e.call(t&&t.context?t.context:t,t)}))}};Object.assign(i,{hooks:o,plugins:new class{constructor(e){this.jsep=e,this.registered={}}register(...e){e.forEach((e=>{if("object"!=typeof e||!e.name||!e.init)throw new Error("Invalid JSEP plugin format");this.registered[e.name]||(e.init(this.jsep),this.registered[e.name]=e)}))}}(i),COMPOUND:"Compound",SEQUENCE_EXP:"SequenceExpression",IDENTIFIER:"Identifier",MEMBER_EXP:"MemberExpression",LITERAL:"Literal",THIS_EXP:"ThisExpression",CALL_EXP:"CallExpression",UNARY_EXP:"UnaryExpression",BINARY_EXP:"BinaryExpression",ARRAY_EXP:"ArrayExpression",TAB_CODE:9,LF_CODE:10,CR_CODE:13,SPACE_CODE:32,PERIOD_CODE:46,COMMA_CODE:44,SQUOTE_CODE:39,DQUOTE_CODE:34,OPAREN_CODE:40,CPAREN_CODE:41,OBRACK_CODE:91,CBRACK_CODE:93,QUMARK_CODE:63,SEMCOL_CODE:59,COLON_CODE:58,unary_ops:{"-":1,"!":1,"~":1,"+":1},binary_ops:{"||":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":10,"/":10,"%":10},right_associative:new Set,additional_identifier_chars:new Set(["$","_"]),literals:{true:!0,false:!1,null:null},this_str:"this"}),i.max_unop_len=i.getMaxKeyLen(i.unary_ops),i.max_binop_len=i.getMaxKeyLen(i.binary_ops);const a=e=>new i(e).parse(),c=Object.getOwnPropertyNames(class{});Object.getOwnPropertyNames(i).filter((e=>!c.includes(e)&&void 0===a[e])).forEach((e=>{a[e]=i[e]})),a.Jsep=i;var u={name:"ternary",init(e){e.hooks.add("after-expression",(function(t){if(t.node&&this.code===e.QUMARK_CODE){this.index++;const r=t.node,s=this.gobbleExpression();if(s||this.throwError("Expected expression"),this.gobbleSpaces(),this.code===e.COLON_CODE){this.index++;const n=this.gobbleExpression();if(n||this.throwError("Expected expression"),t.node={type:"ConditionalExpression",test:r,consequent:s,alternate:n},r.operator&&e.binary_ops[r.operator]<=.9){let s=r;for(;s.right.operator&&e.binary_ops[s.right.operator]<=.9;)s=s.right;t.node.test=s.right,s.right=t.node,t.node=r}}else this.throwError("Expected :")}}))}};a.plugins.register(u);var l={name:"regex",init(e){e.hooks.add("gobble-token",(function(t){if(47===this.code){const r=++this.index;let s=!1;for(;this.index<this.expr.length;){if(47===this.code&&!s){const s=this.expr.slice(r,this.index);let n,i="";for(;++this.index<this.expr.length;){const e=this.code;if(!(e>=97&&e<=122||e>=65&&e<=90||e>=48&&e<=57))break;i+=this.char}try{n=new RegExp(s,i)}catch(e){this.throwError(e.message)}return t.node={type:e.LITERAL,value:n,raw:this.expr.slice(r-1,this.index)},t.node=this.gobbleTokenProperty(t.node),t.node}this.code===e.OBRACK_CODE?s=!0:s&&this.code===e.CBRACK_CODE&&(s=!1),this.index+=92===this.code?2:1}this.throwError("Unclosed Regex")}}))}};const p={name:"assignment",assignmentOperators:new Set(["=","*=","**=","/=","%=","+=","-=","<<=",">>=",">>>=","&=","^=","|="]),updateOperators:[43,45],assignmentPrecedence:.9,init(e){const t=[e.IDENTIFIER,e.MEMBER_EXP];function r(e){p.assignmentOperators.has(e.operator)?(e.type="AssignmentExpression",r(e.left),r(e.right)):e.operator||Object.values(e).forEach((e=>{e&&"object"==typeof e&&r(e)}))}p.assignmentOperators.forEach((t=>e.addBinaryOp(t,p.assignmentPrecedence,!0))),e.hooks.add("gobble-token",(function(e){const r=this.code;p.updateOperators.some((e=>e===r&&e===this.expr.charCodeAt(this.index+1)))&&(this.index+=2,e.node={type:"UpdateExpression",operator:43===r?"++":"--",argument:this.gobbleTokenProperty(this.gobbleIdentifier()),prefix:!0},e.node.argument&&t.includes(e.node.argument.type)||this.throwError(`Unexpected ${e.node.operator}`))})),e.hooks.add("after-token",(function(e){if(e.node){const r=this.code;p.updateOperators.some((e=>e===r&&e===this.expr.charCodeAt(this.index+1)))&&(t.includes(e.node.type)||this.throwError(`Unexpected ${e.node.operator}`),this.index+=2,e.node={type:"UpdateExpression",operator:43===r?"++":"--",argument:e.node,prefix:!1})}})),e.hooks.add("after-expression",(function(e){e.node&&r(e.node)}))}};a.plugins.register(l,p);const d={evalAst(e,t){switch(e.type){case"BinaryExpression":case"LogicalExpression":return d.evalBinaryExpression(e,t);case"Compound":return d.evalCompound(e,t);case"ConditionalExpression":return d.evalConditionalExpression(e,t);case"Identifier":return d.evalIdentifier(e,t);case"Literal":return d.evalLiteral(e,t);case"MemberExpression":return d.evalMemberExpression(e,t);case"UnaryExpression":return d.evalUnaryExpression(e,t);case"ArrayExpression":return d.evalArrayExpression(e,t);case"CallExpression":return d.evalCallExpression(e,t);case"AssignmentExpression":return d.evalAssignmentExpression(e,t);default:throw SyntaxError("Unexpected expression",e)}},evalBinaryExpression:(e,t)=>({"||":(e,t)=>e||t(),"&&":(e,t)=>e&&t(),"|":(e,t)=>e|t(),"^":(e,t)=>e^t(),"&":(e,t)=>e&t(),"==":(e,t)=>e==t(),"!=":(e,t)=>e!=t(),"===":(e,t)=>e===t(),"!==":(e,t)=>e!==t(),"<":(e,t)=>e<t(),">":(e,t)=>e>t(),"<=":(e,t)=>e<=t(),">=":(e,t)=>e>=t(),"<<":(e,t)=>e<<t(),">>":(e,t)=>e>>t(),">>>":(e,t)=>e>>>t(),"+":(e,t)=>e+t(),"-":(e,t)=>e-t(),"*":(e,t)=>e*t(),"/":(e,t)=>e/t(),"%":(e,t)=>e%t()}[e.operator](d.evalAst(e.left,t),(()=>d.evalAst(e.right,t)))),evalCompound(e,t){let r;for(let s=0;s<e.body.length;s++){"Identifier"===e.body[s].type&&["var","let","const"].includes(e.body[s].name)&&e.body[s+1]&&"AssignmentExpression"===e.body[s+1].type&&(s+=1);const n=e.body[s];r=d.evalAst(n,t)}return r},evalConditionalExpression:(e,t)=>d.evalAst(e.test,t)?d.evalAst(e.consequent,t):d.evalAst(e.alternate,t),evalIdentifier(e,t){if(e.name in t)return t[e.name];throw ReferenceError(`${e.name} is not defined`)},evalLiteral:e=>e.value,evalMemberExpression(e,t){const r=e.computed?d.evalAst(e.property):e.property.name,s=d.evalAst(e.object,t),n=s[r];return"function"==typeof n?n.bind(s):n},evalUnaryExpression:(e,t)=>({"-":e=>-d.evalAst(e,t),"!":e=>!d.evalAst(e,t),"~":e=>~d.evalAst(e,t),"+":e=>+d.evalAst(e,t)}[e.operator](e.argument)),evalArrayExpression:(e,t)=>e.elements.map((e=>d.evalAst(e,t))),evalCallExpression(e,t){const r=e.arguments.map((e=>d.evalAst(e,t)));return d.evalAst(e.callee,t)(...r)},evalAssignmentExpression(e,t){if("Identifier"!==e.left.type)throw SyntaxError("Invalid left-hand side in assignment");const r=e.left.name,s=d.evalAst(e.right,t);return t[r]=s,t[r]}};function h(e,t){return(e=e.slice()).push(t),e}function f(e,t){return(t=t.slice()).unshift(e),t}class g extends Error{constructor(e){super('JSONPath should not be called with "new" (it prevents return of (unwrapped) scalar values)'),this.avoidNew=!0,this.value=e,this.name="NewError"}}function m(e,t,r,n,i){if(!(this instanceof m))try{return new m(e,t,r,n,i)}catch(e){if(!e.avoidNew)throw e;return e.value}"string"==typeof e&&(i=n,n=r,r=t,t=e,e=null);const o=e&&"object"==typeof e;if(e=e||{},this.json=e.json||r,this.path=e.path||t,this.resultType=e.resultType||"value",this.flatten=e.flatten||!1,this.wrap=!s(e,"wrap")||e.wrap,this.sandbox=e.sandbox||{},this.eval=void 0===e.eval?"safe":e.eval,this.ignoreEvalErrors=void 0!==e.ignoreEvalErrors&&e.ignoreEvalErrors,this.parent=e.parent||null,this.parentProperty=e.parentProperty||null,this.callback=e.callback||n||null,this.otherTypeCallback=e.otherTypeCallback||i||function(){throw new TypeError("You must supply an otherTypeCallback callback option with the @other() operator.")},!1!==e.autostart){const s={path:o?e.path:t};o?"json"in e&&(s.json=e.json):s.json=r;const n=this.evaluate(s);if(!n||"object"!=typeof n)throw new g(n);return n}}m.prototype.evaluate=function(e,t,r,n){let i=this.parent,o=this.parentProperty,{flatten:a,wrap:c}=this;if(this.currResultType=this.resultType,this.currEval=this.eval,this.currSandbox=this.sandbox,r=r||this.callback,this.currOtherTypeCallback=n||this.otherTypeCallback,t=t||this.json,(e=e||this.path)&&"object"==typeof e&&!Array.isArray(e)){if(!e.path&&""!==e.path)throw new TypeError('You must supply a "path" property when providing an object argument to JSONPath.evaluate().');if(!s(e,"json"))throw new TypeError('You must supply a "json" property when providing an object argument to JSONPath.evaluate().');({json:t}=e),a=s(e,"flatten")?e.flatten:a,this.currResultType=s(e,"resultType")?e.resultType:this.currResultType,this.currSandbox=s(e,"sandbox")?e.sandbox:this.currSandbox,c=s(e,"wrap")?e.wrap:c,this.currEval=s(e,"eval")?e.eval:this.currEval,r=s(e,"callback")?e.callback:r,this.currOtherTypeCallback=s(e,"otherTypeCallback")?e.otherTypeCallback:this.currOtherTypeCallback,i=s(e,"parent")?e.parent:i,o=s(e,"parentProperty")?e.parentProperty:o,e=e.path}if(i=i||null,o=o||null,Array.isArray(e)&&(e=m.toPathString(e)),!e&&""!==e||!t)return;const u=m.toPathArray(e);"$"===u[0]&&u.length>1&&u.shift(),this._hasParentSelector=null;const l=this._trace(u,t,["$"],i,o,r).filter((function(e){return e&&!e.isParentSelector}));return l.length?c||1!==l.length||l[0].hasArrExpr?l.reduce(((e,t)=>{const r=this._getPreferredOutput(t);return a&&Array.isArray(r)?e=e.concat(r):e.push(r),e}),[]):this._getPreferredOutput(l[0]):c?[]:void 0},m.prototype._getPreferredOutput=function(e){const t=this.currResultType;switch(t){case"all":{const t=Array.isArray(e.path)?e.path:m.toPathArray(e.path);return e.pointer=m.toPointer(t),e.path="string"==typeof e.path?e.path:m.toPathString(e.path),e}case"value":case"parent":case"parentProperty":return e[t];case"path":return m.toPathString(e[t]);case"pointer":return m.toPointer(e.path);default:throw new TypeError("Unknown result type")}},m.prototype._handleCallback=function(e,t,r){if(t){const s=this._getPreferredOutput(e);e.path="string"==typeof e.path?e.path:m.toPathString(e.path),t(s,r,e)}},m.prototype._trace=function(e,t,r,n,i,o,a,c){let u;if(!e.length)return u={path:r,value:t,parent:n,parentProperty:i,hasArrExpr:a},this._handleCallback(u,o,"value"),u;const l=e[0],p=e.slice(1),d=[];function g(e){Array.isArray(e)?e.forEach((e=>{d.push(e)})):d.push(e)}if(("string"!=typeof l||c)&&t&&s(t,l))g(this._trace(p,t[l],h(r,l),t,l,o,a));else if("*"===l)this._walk(t,(e=>{g(this._trace(p,t[e],h(r,e),t,e,o,!0,!0))}));else if(".."===l)g(this._trace(p,t,r,n,i,o,a)),this._walk(t,(s=>{"object"==typeof t[s]&&g(this._trace(e.slice(),t[s],h(r,s),t,s,o,!0))}));else{if("^"===l)return this._hasParentSelector=!0,{path:r.slice(0,-1),expr:p,isParentSelector:!0};if("~"===l)return u={path:h(r,l),value:i,parent:n,parentProperty:null},this._handleCallback(u,o,"property"),u;if("$"===l)g(this._trace(p,t,r,null,null,o,a));else if(/^(-?\d*):(-?\d*):?(\d*)$/u.test(l))g(this._slice(l,p,t,r,n,i,o));else if(0===l.indexOf("?(")){if(!1===this.currEval)throw new Error("Eval [?(expr)] prevented in JSONPath expression.");const e=l.replace(/^\?\((.*?)\)$/u,"$1"),s=/@.?([^?]*)[['](\??\(.*?\))(?!.\)\])[\]']/gu.exec(e);s?this._walk(t,(e=>{const a=[s[2]],c=s[1]?t[e][s[1]]:t[e];this._trace(a,c,r,n,i,o,!0).length>0&&g(this._trace(p,t[e],h(r,e),t,e,o,!0))})):this._walk(t,(s=>{this._eval(e,t[s],s,r,n,i)&&g(this._trace(p,t[s],h(r,s),t,s,o,!0))}))}else if("("===l[0]){if(!1===this.currEval)throw new Error("Eval [(expr)] prevented in JSONPath expression.");g(this._trace(f(this._eval(l,t,r[r.length-1],r.slice(0,-1),n,i),p),t,r,n,i,o,a))}else if("@"===l[0]){let e=!1;const s=l.slice(1,-2);switch(s){case"scalar":t&&["object","function"].includes(typeof t)||(e=!0);break;case"boolean":case"string":case"undefined":case"function":typeof t===s&&(e=!0);break;case"integer":!Number.isFinite(t)||t%1||(e=!0);break;case"number":Number.isFinite(t)&&(e=!0);break;case"nonFinite":"number"!=typeof t||Number.isFinite(t)||(e=!0);break;case"object":t&&typeof t===s&&(e=!0);break;case"array":Array.isArray(t)&&(e=!0);break;case"other":e=this.currOtherTypeCallback(t,r,n,i);break;case"null":null===t&&(e=!0);break;default:throw new TypeError("Unknown value type "+s)}if(e)return u={path:r,value:t,parent:n,parentProperty:i},this._handleCallback(u,o,"value"),u}else if("`"===l[0]&&t&&s(t,l.slice(1))){const e=l.slice(1);g(this._trace(p,t[e],h(r,e),t,e,o,a,!0))}else if(l.includes(",")){const e=l.split(",");for(const s of e)g(this._trace(f(s,p),t,r,n,i,o,!0))}else!c&&t&&s(t,l)&&g(this._trace(p,t[l],h(r,l),t,l,o,a,!0))}if(this._hasParentSelector)for(let e=0;e<d.length;e++){const r=d[e];if(r&&r.isParentSelector){const s=this._trace(r.expr,t,r.path,n,i,o,a);if(Array.isArray(s)){d[e]=s[0];const t=s.length;for(let r=1;r<t;r++)e++,d.splice(e,0,s[r])}else d[e]=s}}return d},m.prototype._walk=function(e,t){if(Array.isArray(e)){const r=e.length;for(let e=0;e<r;e++)t(e)}else e&&"object"==typeof e&&Object.keys(e).forEach((e=>{t(e)}))},m.prototype._slice=function(e,t,r,s,n,i,o){if(!Array.isArray(r))return;const a=r.length,c=e.split(":"),u=c[2]&&Number.parseInt(c[2])||1;let l=c[0]&&Number.parseInt(c[0])||0,p=c[1]&&Number.parseInt(c[1])||a;l=l<0?Math.max(0,l+a):Math.min(a,l),p=p<0?Math.max(0,p+a):Math.min(a,p);const d=[];for(let e=l;e<p;e+=u)this._trace(f(e,t),r,s,n,i,o,!0).forEach((e=>{d.push(e)}));return d},m.prototype._eval=function(e,t,r,n,i,o){this.currSandbox._$_parentProperty=o,this.currSandbox._$_parent=i,this.currSandbox._$_property=r,this.currSandbox._$_root=this.json,this.currSandbox._$_v=t;const a=e.includes("@path");a&&(this.currSandbox._$_path=m.toPathString(n.concat([r])));const c=this.currEval+"Script:"+e;if(!m.cache[c]){let t=e.replace(/@parentProperty/gu,"_$_parentProperty").replace(/@parent/gu,"_$_parent").replace(/@property/gu,"_$_property").replace(/@root/gu,"_$_root").replace(/@([.\s)[])/gu,"_$_v$1");if(a&&(t=t.replace(/@path/gu,"_$_path")),"safe"===this.currEval||!0===this.currEval||void 0===this.currEval)m.cache[c]=new this.safeVm.Script(t);else if("native"===this.currEval)m.cache[c]=new this.vm.Script(t);else if("function"==typeof this.currEval&&this.currEval.prototype&&s(this.currEval.prototype,"runInNewContext")){const e=this.currEval;m.cache[c]=new e(t)}else{if("function"!=typeof this.currEval)throw new TypeError(`Unknown "eval" property "${this.currEval}"`);m.cache[c]={runInNewContext:e=>this.currEval(t,e)}}}try{return m.cache[c].runInNewContext(this.currSandbox)}catch(t){if(this.ignoreEvalErrors)return!1;throw new Error("jsonPath: "+t.message+": "+e)}},m.cache={},m.toPathString=function(e){const t=e,r=t.length;let s="$";for(let e=1;e<r;e++)/^(~|\^|@.*?\(\))$/u.test(t[e])||(s+=/^[0-9*]+$/u.test(t[e])?"["+t[e]+"]":"['"+t[e]+"']");return s},m.toPointer=function(e){const t=e,r=t.length;let s="";for(let e=1;e<r;e++)/^(~|\^|@.*?\(\))$/u.test(t[e])||(s+="/"+t[e].toString().replace(/~/gu,"~0").replace(/\//gu,"~1"));return s},m.toPathArray=function(e){const{cache:t}=m;if(t[e])return t[e].concat();const r=[],s=e.replace(/@(?:null|boolean|number|string|integer|undefined|nonFinite|scalar|array|object|function|other)\(\)/gu,";$&;").replace(/[['](\??\(.*?\))[\]'](?!.\])/gu,(function(e,t){return"[#"+(r.push(t)-1)+"]"})).replace(/\[['"]([^'\]]*)['"]\]/gu,(function(e,t){return"['"+t.replace(/\./gu,"%@%").replace(/~/gu,"%%@@%%")+"']"})).replace(/~/gu,";~;").replace(/['"]?\.['"]?(?![^[]*\])|\[['"]?/gu,";").replace(/%@%/gu,".").replace(/%%@@%%/gu,"~").replace(/(?:;)?(\^+)(?:;)?/gu,(function(e,t){return";"+t.split("").join(";")+";"})).replace(/;;;|;;/gu,";..;").replace(/;$|'?\]|'$/gu,"").split(";").map((function(e){const t=e.match(/#(\d+)/u);return t&&t[1]?r[t[1]]:e}));return t[e]=s,t[e].concat()},m.prototype.safeVm={Script:class{constructor(e){this.code=e,this.ast=a(this.code)}runInNewContext(e){const t={...e};return d.evalAst(this.ast,t)}}},m.prototype.vm=n,t.E=m},69321:(e,t,r)=>{const{PAYLOAD_TAGGING_MAX_TAGS:s}=r(23636),n=["authorization","x-authorization","password","token"];function i(e){return e.replaceAll(".","\\.")}e.exports={tagsFromObject:function(e,t){const{maxDepth:r,prefix:o}=t;let a=0,c=!1;const u={};return function e(t,o,l=0){if(!c){if(a>=s-1)return c=!0,void(u["_dd.payload_tags_incomplete"]=!0);if(l>=r&&"object"==typeof o)return a+=1,void(u[t]="truncated");if(void 0===o)return a+=1,void(u[t]="undefined");if(null===o)return a+=1,void(u[t]="null");if(["number","boolean"].includes(typeof o)||Buffer.isBuffer(o))return a+=1,void(u[t]=o.toString().substring(0,5e3));if("string"==typeof o&&(a+=1,u[t]=o.substring(0,5e3)),"object"==typeof o)for(const[r,s]of Object.entries(o))n.includes(r.toLowerCase())?(a+=1,u[`${t}.${i(r)}`]="redacted"):e(`${t}.${i(r)}`,s,l+1)}}(o,e),u}}},8523:(e,t,r)=>{"use strict";const s=r(79896),n=r(16928);function i(){return r.c[r.s]&&r.c[r.s].filename?n.dirname(r.c[r.s].filename):process.cwd()}function o(e,t,r){for(;;){const i=n.resolve(r,e);if(s.existsSync(i))return i;if(r===t)return;r=n.dirname(r)}}e.exports=Object.assign(function(){const e=i(),t=n.resolve(e),r=n.parse(t);if(!r)return{};const{root:a}=r,c=o("package.json",a,t);try{return JSON.parse(s.readFileSync(c,"utf8"))}catch(e){return{}}}(),{findRoot:i,findUp:o})},16994:(e,t,r)=>{"use strict";const{channel:s}=r(1247),{isFalse:n}=r(89421),i=r(42050),o=r(75004),a=s("dd-trace:instrumentation:load");r(96406),void 0!==process.env.AWS_LAMBDA_FUNCTION_NAME&&r(74669);const{DD_TRACE_DISABLED_PLUGINS:c}=process.env,u=new Set(c&&c.split(",").map((e=>e.trim()))),l={};function p(e){if(e&&"function"==typeof e&&!l[e.id]){const t=`DD_TRACE_${e.id.toUpperCase()}_ENABLED`,r=process.env[t.replace(/[^a-z0-9_]/gi,"_")];n(r)||u.has(e.id)?(o.debug(`Plugin "${e.id}" was disabled via configuration option.`),l[e.id]=null):l[e.id]=e}}a.subscribe((({name:e})=>{p(i[e])})),p(r(87222)),p(r(40653)),e.exports=class{constructor(e){this._tracer=e,this._tracerConfig=null,this._pluginsByName={},this._configsByName={},this._loadedSubscriber=({name:e})=>{const t=i[e];t&&"function"==typeof t&&this.loadPlugin(t.id)},a.subscribe(this._loadedSubscriber)}loadPlugin(e){const t=l[e];if(!t)return;if(!this._tracerConfig)return;this._pluginsByName[e]||(this._pluginsByName[e]=new t(this._tracer,this._tracerConfig));const r=this._configsByName[e]||{enabled:!1!==this._tracerConfig.plugins};this._pluginsByName[e].configure({...this._getSharedConfig(e),...r})}configurePlugin(e,t){const r=this._isEnabled(t);this._configsByName[e]={...t,enabled:r},this.loadPlugin(e)}configure(e={}){this._tracerConfig=e,this._tracer._nomenclature.configure(e);for(const e in l)this.loadPlugin(e)}destroy(){for(const e in this._pluginsByName)this._pluginsByName[e].configure({enabled:!1});a.unsubscribe(this._loadedSubscriber)}_isEnabled(e){return"boolean"==typeof e?e:!e||!1!==e.enabled}_getSharedConfig(e){const{logInjection:t,serviceMapping:r,queryStringObfuscation:s,site:n,url:i,headerTags:o,dbmPropagationMode:a,dsmEnabled:c,clientIpEnabled:u,memcachedCommandEnabled:l,ciVisibilityTestSessionName:p,ciVisAgentlessLogSubmissionEnabled:d,isTestDynamicInstrumentationEnabled:h,middlewareTracingEnabled:f}=this._tracerConfig,g={dbmPropagationMode:a,dsmEnabled:c,memcachedCommandEnabled:l,site:n,url:i,headers:o||[],ciVisibilityTestSessionName:p,ciVisAgentlessLogSubmissionEnabled:d,isTestDynamicInstrumentationEnabled:h};return void 0!==t&&(g.logInjection=t),void 0!==s&&(g.queryStringObfuscation=s),r&&r[e]&&(g.service=r[e]),void 0!==u&&(g.clientIpEnabled=u),void 0!==f&&(g.middleware=f),g}}},54311:(e,t,r)=>{const s=r(5288),{storage:n}=r(96882);e.exports=class extends s{static get id(){return"apollo.gateway"}static get type(){return"web"}static get kind(){return"server"}bindStart(e){const t=n.getStore(),r=t?t.span:null,s=this.startSpan(this.getOperationName(),{childOf:r,service:this.getServiceName(),type:this.constructor.type,kind:this.constructor.kind,meta:{}},!1);return e.parentStore=t,e.currentStore={...t,span:s},e.currentStore}end(e){(e.hasOwnProperty("result")||e.hasOwnProperty("error"))&&e?.currentStore?.span?.finish()}asyncStart(e){return e?.currentStore?.span.finish(),e.parentStore}getServiceName(){return this.serviceName({id:`${this.constructor.id}.${this.constructor.operation}`,pluginConfig:this.config})}getOperationName(){return this.operationName({id:`${this.constructor.id}.${this.constructor.operation}`})}}},58500:(e,t,r)=>{"use strict";const s=r(58423);e.exports=class extends s{static get operation(){return"command"}startSpan(e){return e.kind||(e.kind=this.constructor.kind),super.startSpan(this.operationName(),e)}}},32028:(e,t,r)=>{const{getTestEnvironmentMetadata:s,getTestSessionName:n,getCodeOwnersFileEntries:i,getTestParentSpan:o,getTestCommonTags:a,getCodeOwnersForFilename:c,TEST_CODE_OWNERS:u,CI_APP_ORIGIN:l,getTestSessionCommonTags:p,getTestModuleCommonTags:d,TEST_SUITE_ID:h,TEST_MODULE_ID:f,TEST_SESSION_ID:g,TEST_COMMAND:m,TEST_MODULE:_,TEST_SESSION_NAME:y,getTestSuiteCommonTags:b,TEST_STATUS:v,TEST_SKIPPED_BY_ITR:E,ITR_CORRELATION_ID:S,TEST_SOURCE_FILE:T,TEST_LEVEL_EVENT_TYPES:w,TEST_SUITE:x,getFileAndLineNumberFromError:A,DI_ERROR_DEBUG_INFO_CAPTURED:I,DI_DEBUG_ERROR_PREFIX:k,DI_DEBUG_ERROR_SNAPSHOT_ID_SUFFIX:O,DI_DEBUG_ERROR_FILE_SUFFIX:R,DI_DEBUG_ERROR_LINE_SUFFIX:C}=r(97507),N=r(12583),{COMPONENT:P}=r(23636),D=r(75004),{incrementCountMetric:L,distributionMetric:M,TELEMETRY_EVENT_CREATED:q,TELEMETRY_ITR_SKIPPED:j}=r(60806),{CI_PROVIDER_NAME:U,GIT_REPOSITORY_URL:F,GIT_COMMIT_SHA:B,GIT_BRANCH:$,CI_WORKSPACE_PATH:G}=r(61154),{OS_VERSION:V,OS_PLATFORM:z,OS_ARCHITECTURE:H,RUNTIME_NAME:K,RUNTIME_VERSION:Y}=r(59052);e.exports=class extends N{constructor(...e){super(...e),this.fileLineToProbeId=new Map,this.rootDir=process.cwd(),this.addSub(`ci:${this.constructor.id}:library-configuration`,(({onDone:e})=>{if(!this.tracer._exporter||!this.tracer._exporter.getLibraryConfiguration)return e({err:new Error("CI Visibility was not initialized correctly")});this.tracer._exporter.getLibraryConfiguration(this.testConfiguration,((t,r)=>{t?D.error("Library configuration could not be fetched. %s",t.message):this.libraryConfig=r,e({err:t,libraryConfig:r})}))})),this.addSub(`ci:${this.constructor.id}:test-suite:skippable`,(({onDone:e})=>{if(!this.tracer._exporter?.getSkippableSuites)return e({err:new Error("CI Visibility was not initialized correctly")});this.tracer._exporter.getSkippableSuites(this.testConfiguration,((t,r,s)=>{t?D.error("Skippable suites could not be fetched. %s",t.message):this.itrCorrelationId=s,e({err:t,skippableSuites:r,itrCorrelationId:s})}))})),this.addSub(`ci:${this.constructor.id}:session:start`,(({command:e,frameworkVersion:t,rootDir:r})=>{const s=o(this.tracer),i=p(e,t,this.constructor.id),a=d(e,t,this.constructor.id);this.command=e,this.frameworkVersion=t,this.rootDir=r;const c=n(this.config,this.command,this.testEnvironmentMetadata),u={};for(const e of w)u[e]={[y]:c};this.tracer._exporter.setMetadataTags&&this.tracer._exporter.setMetadataTags(u),this.testSessionSpan=this.tracer.startSpan(`${this.constructor.id}.test_session`,{childOf:s,tags:{[P]:this.constructor.id,...this.testEnvironmentMetadata,...i}}),this.telemetry.ciVisEvent(q,"session"),this.testModuleSpan=this.tracer.startSpan(`${this.constructor.id}.test_module`,{childOf:this.testSessionSpan,tags:{[P]:this.constructor.id,...this.testEnvironmentMetadata,...a}}),"vitest"===this.constructor.id&&(process.env.DD_CIVISIBILITY_TEST_SESSION_ID=this.testSessionSpan.context().toTraceId(),process.env.DD_CIVISIBILITY_TEST_MODULE_ID=this.testModuleSpan.context().toSpanId(),process.env.DD_CIVISIBILITY_TEST_COMMAND=this.command),this.telemetry.ciVisEvent(q,"module")})),this.addSub(`ci:${this.constructor.id}:itr:skipped-suites`,(({skippedSuites:e,frameworkVersion:t})=>{const r=this.testSessionSpan.context()._tags[m];e.forEach((e=>{const s=b(r,t,e,this.constructor.id);this.itrCorrelationId&&(s[S]=this.itrCorrelationId),this.tracer.startSpan(`${this.constructor.id}.test_suite`,{childOf:this.testModuleSpan,tags:{[P]:this.constructor.id,...this.testEnvironmentMetadata,...s,[v]:"skip",[E]:"true"}}).finish()})),this.telemetry.count(j,{testLevel:"suite"},e.length)})),this.addSub(`ci:${this.constructor.id}:known-tests`,(({onDone:e})=>{if(!this.tracer._exporter?.getKnownTests)return e({err:new Error("CI Visibility was not initialized correctly")});this.tracer._exporter.getKnownTests(this.testConfiguration,((t,r)=>{t&&(D.error("Known tests could not be fetched. %s",t.message),this.libraryConfig.isEarlyFlakeDetectionEnabled=!1,this.libraryConfig.isKnownTestsEnabled=!1),e({err:t,knownTests:r})}))}))}get telemetry(){const e=this.constructor.id;return{ciVisEvent:function(t,r,s={}){L(t,{testLevel:r,testFramework:e,isUnsupportedCIProvider:!this.ciProviderName,...s})},count:function(e,t,r=1){L(e,t,r)},distribution:function(e,t,r){M(e,t,r)}}}configure(e,t=!0){if(super.configure(e),e.isTestDynamicInstrumentationEnabled&&!this.di){const e=r(14944);this.di=e}if(!t)return;this.testEnvironmentMetadata=s(this.constructor.id,this.config);const{[F]:n,[B]:o,[V]:a,[z]:c,[H]:u,[K]:l,[Y]:p,[$]:d,[U]:h,[G]:f}=this.testEnvironmentMetadata;this.repositoryRoot=f||process.cwd(),this.codeOwnersEntries=i(f),this.ciProviderName=h,this.testConfiguration={repositoryUrl:n,sha:o,osVersion:a,osPlatform:c,osArchitecture:u,runtimeName:l,runtimeVersion:p,branch:d,testLevel:"suite"}}getCodeOwners(e){const{[T]:t,[x]:r}=e;let s=c(t,this.codeOwnersEntries);return s||(s=c(r,this.codeOwnersEntries)),s}startTestSpan(e,t,r,s={}){const n=o(this.tracer);let i={...a(e,t,this.frameworkVersion,this.constructor.id),[P]:this.constructor.id,...s};const c=this.getCodeOwners(i);if(c&&(i[u]=c),r){n._trace.startTime=r.context()._trace.startTime,n._trace.ticks=r.context()._trace.ticks;const e={[h]:r.context().toSpanId(),[g]:r.context().toTraceId(),[m]:r.context()._tags[m],[_]:this.constructor.id};r.context()._parentId&&(e[f]=r.context()._parentId.toString(10)),i={...i,...e}}this.telemetry.ciVisEvent(q,"test",{hasCodeOwners:!!c});const p=this.tracer.startSpan(`${this.constructor.id}.test`,{childOf:n,tags:{...this.testEnvironmentMetadata,...i}});return p.context()._trace.origin=l,p}onDiBreakpointHit({snapshot:e}){if(!this.activeTestSpan||this.activeTestSpan.context()._isFinished)return void D.warn("Breakpoint snapshot could not be attached to the active test span");const t=this.testErrorStackIndex;this.activeTestSpan.setTag(I,"true"),this.activeTestSpan.setTag(`${k}.${t}.${O}`,e.id),this.activeTestSpan.setTag(`${k}.${t}.${R}`,e.probe.location.file),this.activeTestSpan.setTag(`${k}.${t}.${C}`,Number(e.probe.location.lines[0]));const r=this.activeTestSpan.context();this.tracer._exporter.exportDiLogs(this.testEnvironmentMetadata,{debugger:{snapshot:e},dd:{trace_id:r.toTraceId(),span_id:r.toSpanId()}})}removeAllDiProbes(){return 0===this.fileLineToProbeId.size?Promise.resolve():(D.debug("Removing all Dynamic Instrumentation probes"),Promise.all(Array.from(this.fileLineToProbeId.keys()).map((e=>{const[t,r]=e.split(":");return this.removeDiProbe({file:t,line:r})}))))}removeDiProbe({file:e,line:t}){const r=this.fileLineToProbeId.get(`${e}:${t}`);return D.warn(`Removing probe from ${e}:${t}, with id: ${r}`),this.fileLineToProbeId.delete(r),this.di.removeProbe(r)}addDiProbe(e){const[t,r,s]=A(e,this.repositoryRoot);if(!t||!Number.isInteger(r))return void D.warn("Could not add breakpoint for dynamic instrumentation");D.debug("Adding breakpoint for Dynamic Instrumentation"),this.testErrorStackIndex=s;const n=`${t}:${r}`;if(this.fileLineToProbeId.has(n))return D.warn("Probe already set for this line"),{probeId:this.fileLineToProbeId.get(n),setProbePromise:Promise.resolve(),stackIndex:s,file:t,line:r};const[i,o]=this.di.addLineProbe({file:t,line:r},this.onDiBreakpointHit.bind(this));return this.fileLineToProbeId.set(n,i),{probeId:i,setProbePromise:o,stackIndex:s,file:t,line:r}}}},77723:(e,t,r)=>{"use strict";const s=r(19176);e.exports=class extends s{static get operation(){return"request"}static get kind(){return"client"}static get type(){return"web"}}},42257:(e,t,r)=>{"use strict";const s=r(12583);e.exports=class extends s{constructor(...e){super(...e);for(const[t,r]of Object.entries(this.constructor.plugins))this[t]=new r(...e)}configure(e){super.configure(e);for(const t in this.constructor.plugins){const r=!1!==e[t]&&{...e,...e[t]};this[t].configure(r)}}}},57232:(e,t,r)=>{"use strict";const s=r(5927);e.exports=class extends s{static get operation(){return"receive"}static get kind(){return"consumer"}static get type(){return"messaging"}startSpan(e){return e.service||(e.service=this.config.service||this.serviceName()),e.kind||(e.kind=this.constructor.kind),super.startSpan(this.operationName(),e)}}},42537:(e,t,r)=>{"use strict";const s=r(58423),{PEER_SERVICE_KEY:n,PEER_SERVICE_SOURCE_KEY:i}=r(23636);e.exports=class extends s{static get operation(){return"query"}static get peerServicePrecursors(){return["db.name"]}constructor(...e){super(...e),this.serviceTags={dddbs:"",encodedDddbs:"",dde:"",encodedDde:"",ddps:"",encodedDdps:"",ddpv:"",encodedDdpv:""}}encodingServiceTags(e,t,r){e!==r&&(this.serviceTags[e]=r,this.serviceTags[t]=encodeURIComponent(r))}createDBMPropagationCommentService(e,t){this.encodingServiceTags("dddbs","encodedDddbs",e),this.encodingServiceTags("dde","encodedDde",this.tracer._env),this.encodingServiceTags("ddps","encodedDdps",this.tracer._service),this.encodingServiceTags("ddpv","encodedDdpv",this.tracer._version),t.context()._tags["out.host"]&&this.encodingServiceTags("ddh","encodedDdh",t._spanContext._tags["out.host"]),t.context()._tags["db.name"]&&this.encodingServiceTags("dddb","encodedDddb",t._spanContext._tags["db.name"]);const{encodedDddb:r,encodedDddbs:s,encodedDde:o,encodedDdh:a,encodedDdps:c,encodedDdpv:u}=this.serviceTags;let l=`dddb='${r}',dddbs='${s}',dde='${o}',ddh='${a}',ddps='${c}',ddpv='${u}'`;const p=this.getPeerService(t.context()._tags);if(void 0!==p&&p[i]===n){this.encodingServiceTags("ddprs","encodedDdprs",p[n]);const{encodedDdprs:e}=this.serviceTags;l+=`,ddprs='${e}'`}return l}getDbmServiceName(e,t){if(this._tracerConfig.spanComputePeerService){const r=this.getPeerService(e.context()._tags);return this.getPeerServiceRemap(r)[n]||t}return t}injectDbmQuery(e,t,r,s=!1){const n=this.config.dbmPropagationMode,i=this.getDbmServiceName(e,r);if("disabled"===n)return t;const o=this.createDBMPropagationCommentService(i,e);return s||"service"===n?`/*${o}*/ ${t}`:"full"===n?(e.setTag("_dd.dbm_trace_injected","true"),`/*${o},traceparent='${e._spanContext.toTraceparent()}'*/ ${t}`):void 0}maybeTruncate(e){const t="number"==typeof this.config.truncate?this.config.truncate:5e3;return this.config.truncate&&e&&e.length>t&&(e=`${e.slice(0,t-3)}...`),e}}},5927:(e,t,r)=>{"use strict";const s=r(5288);e.exports=class extends s{}},42050:(e,t,r)=>{"use strict";e.exports={get"@apollo/gateway"(){return r(32855)},get"@aws-sdk/smithy-client"(){return r(17914)},get"@azure/functions"(){return r(93693)},get"@cucumber/cucumber"(){return r(88240)},get"@playwright/test"(){return r(15635)},get"@elastic/elasticsearch"(){return r(45613)},get"@elastic/transport"(){return r(45613)},get"@google-cloud/pubsub"(){return r(1219)},get"@grpc/grpc-js"(){return r(93940)},get"@hapi/hapi"(){return r(68292)},get"@jest/core"(){return r(31954)},get"@jest/test-sequencer"(){return r(31954)},get"@jest/transform"(){return r(31954)},get"@koa/router"(){return r(5943)},get"@langchain/core"(){return r(85771)},get"@langchain/openai"(){return r(85771)},get"@node-redis/client"(){return r(83197)},get"@opensearch-project/opensearch"(){return r(43196)},get"@redis/client"(){return r(83197)},get"@smithy/smithy-client"(){return r(17914)},get"@vitest/runner"(){return r(4853)},get aerospike(){return r(61471)},get amqp10(){return r(70358)},get amqplib(){return r(20912)},get avsc(){return r(41637)},get"aws-sdk"(){return r(17914)},get bunyan(){return r(27671)},get"cassandra-driver"(){return r(18595)},get child_process(){return r(25182)},get connect(){return r(37232)},get couchbase(){return r(35753)},get cypress(){return r(74257)},get dns(){return r(13653)},get"dd-trace-api"(){return r(40653)},get elasticsearch(){return r(45613)},get express(){return r(51450)},get fastify(){return r(85202)},get"find-my-way"(){return r(29160)},get graphql(){return r(20655)},get grpc(){return r(93940)},get hapi(){return r(68292)},get http(){return r(81068)},get http2(){return r(98436)},get https(){return r(81068)},get ioredis(){return r(93881)},get"jest-circus"(){return r(31954)},get"jest-config"(){return r(31954)},get"jest-environment-node"(){return r(31954)},get"jest-environment-jsdom"(){return r(31954)},get"jest-runtime"(){return r(31954)},get"jest-worker"(){return r(31954)},get koa(){return r(5943)},get"koa-router"(){return r(5943)},get kafkajs(){return r(6531)},get langchain(){return r(85771)},get mariadb(){return r(60526)},get memcached(){return r(39465)},get"microgateway-core"(){return r(12076)},get mocha(){return r(30364)},get"mocha-each"(){return r(30364)},get vitest(){return r(4853)},get workerpool(){return r(30364)},get moleculer(){return r(39900)},get mongodb(){return r(40030)},get"mongodb-core"(){return r(40030)},get mysql(){return r(63324)},get mysql2(){return r(39668)},get net(){return r(27209)},get next(){return r(83857)},get"node:dns"(){return r(13653)},get"node:http"(){return r(81068)},get"node:http2"(){return r(98436)},get"node:https"(){return r(81068)},get"node:net"(){return r(27209)},get nyc(){return r(95688)},get oracledb(){return r(18824)},get openai(){return r(4126)},get paperplane(){return r(4896)},get pg(){return r(52369)},get pino(){return r(56952)},get"pino-pretty"(){return r(56952)},get playwright(){return r(15635)},get protobufjs(){return r(35812)},get redis(){return r(83197)},get restify(){return r(91370)},get rhea(){return r(16452)},get router(){return r(78693)},get"selenium-webdriver"(){return r(96112)},get sharedb(){return r(96887)},get tedious(){return r(87703)},get undici(){return r(91268)},get winston(){return r(68506)}}},15700:(e,t,r)=>{"use strict";const{LOG:s}=r(59429),n=r(12583),{storage:i}=r(96882);function o(e,t){return"dd"===t&&!Reflect.has(e,t)&&Reflect.isExtensible(e)}e.exports=class extends n{constructor(...e){super(...e),this.addSub(`apm:${this.constructor.id}:log`,(e=>{const t=i.getStore(),r=t&&t.span,n={};this.tracer.inject(r,s,n),e.message=function(e,t){return new Proxy(e,{get:(e,r,s)=>r===Symbol.toStringTag?Object.prototype.toString.call(e).slice(8,-1):o(e,r)?t.dd:Reflect.get(e,r,s),ownKeys(e){const t=Reflect.ownKeys(e);return r=e,Object.prototype.hasOwnProperty.call(r,"dd")||!Reflect.isExtensible(e)?t:["dd",...t];var r},getOwnPropertyDescriptor:(e,r)=>Reflect.getOwnPropertyDescriptor(o(e,r)?t:e,r)})}(e.message,n)}))}configure(e){return super.configure({...e,enabled:e.enabled&&(e.logInjection||e.ciVisAgentlessLogSubmissionEnabled)})}}},19176:(e,t,r)=>{"use strict";const{CLIENT_PORT_KEY:s,PEER_SERVICE_KEY:n,PEER_SERVICE_SOURCE_KEY:i,PEER_SERVICE_REMAP_KEY:o}=r(23636),a=r(5288),{exitTags:c}=r(8437),u=["net.peer.name","out.host"];e.exports=class extends a{static get peerServicePrecursors(){return[]}constructor(...e){super(...e),this.addTraceSub("connect",(e=>{this.connect(e)}))}startSpan(...e){const t=super.startSpan(...e);return this._tracerConfig.codeOriginForSpans.enabled&&t.addTags(c(this.startSpan)),t}getPeerService(e){if(void 0!==e[n])return{[n]:e[n],[i]:n};const t=[...this.constructor.peerServicePrecursors,...u];for(const r of t)if(e[r])return{[n]:e[r],[i]:r}}getPeerServiceRemap(e){const t=e[n],r=this._tracerConfig.peerServiceMapping?.[t];return t&&r?{...e,[n]:r,[o]:t}:e}finish(){this.tagPeerService(this.activeSpan),super.finish(...arguments)}tagPeerService(e){if(this._tracerConfig.spanComputePeerService){const t=this.getPeerService(e.context()._tags);void 0!==t&&e.addTags(this.getPeerServiceRemap(t))}}connect(e){this.addHost(e.hostname,e.port)}addHost(e,t){const r=this.activeSpan;r&&r.addTags({"out.host":e,[s]:t})}}},12583:(e,t,r)=>{"use strict";const s=r(1247),n=r(75004),{storage:i}=r(96882);class o{constructor(e,t){this._channel=s.channel(e),this._handler=(e,r)=>{const s=i.getStore();s&&s.noop||t(e,r)}}enable(){this._channel.subscribe(this._handler)}disable(){this._channel.unsubscribe(this._handler)}}class a{constructor(e,t){this._channel=s.channel(e),this._transform=e=>{const r=i.getStore();return r&&r.noop?r:t(e)}}enable(){this._channel.bindStore(i,this._transform)}disable(){this._channel.unbindStore(i,this._transform)}}e.exports=class{constructor(e,t){this._subscriptions=[],this._bindings=[],this._enabled=!1,this._tracer=e,this.config={},this._tracerConfig=t}get tracer(){return this._tracer._tracer}enter(e,t){t=t||i.getStore(),i.enterWith({...t,span:e})}skip(){i.enterWith({noop:!0})}addSub(e,t){const r=this;this._subscriptions.push(new o(e,(function(){try{return t.apply(this,arguments)}catch(e){n.error("Error in plugin handler:",e),n.info("Disabling plugin: %s",r.id),r.configure(!1)}})))}addBind(e,t){this._bindings.push(new a(e,t))}addError(e){const t=i.getStore();t&&t.span&&(t.span._spanContext._tags.error||t.span.setTag("error",e||1))}configure(e){"boolean"==typeof e&&(e={enabled:e}),this.config=e,e.enabled&&!this._enabled?(this._enabled=!0,this._subscriptions.forEach((e=>e.enable())),this._bindings.forEach((e=>e.enable()))):!e.enabled&&this._enabled&&(this._enabled=!1,this._subscriptions.forEach((e=>e.disable())),this._bindings.forEach((e=>e.disable())))}}},36878:(e,t,r)=>{"use strict";const s=r(19176);e.exports=class extends s{static get operation(){return"publish"}static get kind(){return"producer"}static get type(){return"messaging"}startSpan(e){const t={kind:this.constructor.kind};return e.service||(e.service=this.config.service||this.serviceName()),Object.keys(t).forEach((r=>{e[r]||(e[r]=t[r])})),super.startSpan(this.operationName(),e)}}},56875:(e,t,r)=>{"use strict";const s=r(12583);e.exports=class extends s{constructor(...e){super(...e),this.addSub(`apm:${this.constructor.id}:serialize-start`,this.handleSerializeStart.bind(this)),this.addSub(`apm:${this.constructor.id}:deserialize-end`,this.handleDeserializeFinish.bind(this))}handleSerializeStart(e){const t=this.tracer.scope().active();t&&this.config.dsmEnabled&&this.constructor.schemaExtractor.attachSchemaOnSpan(e,t,"serialization",this.tracer)}handleDeserializeFinish(e){const t=this.tracer.scope().active();t&&this.config.dsmEnabled&&this.constructor.schemaExtractor.attachSchemaOnSpan(e,t,"deserialization",this.tracer)}}},38103:(e,t,r)=>{"use strict";const s=r(5927);e.exports=class extends s{static get operation(){return"request"}static get kind(){return"server"}static get type(){return"web"}}},58423:(e,t,r)=>{"use strict";const s=r(77723);e.exports=class extends s{static get type(){return"storage"}constructor(...e){super(...e),this.system=this.constructor.system||this.component}startSpan(e,t){return!t.service&&this.system&&(t.service=`${this.tracer._service}-${this.system}`),super.startSpan(e,t)}}},5288:(e,t,r)=>{"use strict";const s=r(12583),{storage:n}=r(96882),i=r(88378),{COMPONENT:o}=r(23636);e.exports=class extends s{constructor(...e){super(...e),this.component=this.constructor.component||this.constructor.id,this.operation=this.constructor.operation,this.addTraceSubs()}get activeSpan(){const e=n.getStore();return e&&e.span}serviceName(e={}){const{type:t=this.constructor.type,id:r=this.constructor.id,kind:s=this.constructor.kind}=e;return this._tracer._nomenclature.serviceName(t,s,r,e)}operationName(e={}){const{type:t=this.constructor.type,id:r=this.constructor.id,kind:s=this.constructor.kind}=e;return this._tracer._nomenclature.opName(t,s,r,e)}configure(e){return super.configure({...e,hooks:{[this.operation]:()=>{},...e.hooks}})}start(){}finish(){this.activeSpan?.finish()}error(e){e?.currentStore?e.currentStore?.span.setTag("error",e?.error):this.addError(e)}addTraceSubs(){const e=["start","end","asyncStart","asyncEnd","error","finish"];for(const t of e){const e=`bind${t.charAt(0).toUpperCase()}${t.slice(1)}`;this[t]&&this.addTraceSub(t,(e=>{this[t](e)})),this[e]&&this.addTraceBind(t,(t=>this[e](t)))}}addTraceSub(e,t){const r=this.constructor.prefix||`apm:${this.component}:${this.operation}`;this.addSub(`${r}:${e}`,t)}addTraceBind(e,t){const r=this.constructor.prefix||`apm:${this.component}:${this.operation}`;this.addBind(`${r}:${e}`,t)}addError(e,t=this.activeSpan){t&&!t._spanContext._tags.error&&(e=e&&e.error||e,t.setTag("error",e||1))}startSpan(e,{childOf:t,kind:r,meta:s,metrics:a,service:c,resource:u,type:l}={},p=!0){const d=n.getStore();d&&void 0===t&&(t=d.span);const h=this.tracer.startSpan(e,{childOf:t,tags:{[o]:this.component,"service.name":c||this.tracer._service,"resource.name":u,"span.kind":r,"span.type":l,...s,...a},integrationName:l,links:t?._links});return i.sample(h,this.config.measured),p&&n.enterWith({...d,span:h}),h}}},65711:(e,t,r)=>{const{readFileSync:s}=r(79896),{GIT_BRANCH:n,GIT_COMMIT_SHA:i,GIT_TAG:o,GIT_COMMIT_AUTHOR_EMAIL:a,GIT_COMMIT_AUTHOR_NAME:c,GIT_COMMIT_MESSAGE:u,GIT_COMMIT_AUTHOR_DATE:l,GIT_COMMIT_HEAD_SHA:p,GIT_PULL_REQUEST_BASE_BRANCH_SHA:d,GIT_PULL_REQUEST_BASE_BRANCH:h,GIT_REPOSITORY_URL:f,CI_PIPELINE_ID:g,CI_PIPELINE_NAME:m,CI_PIPELINE_NUMBER:_,CI_PIPELINE_URL:y,CI_PROVIDER_NAME:b,CI_WORKSPACE_PATH:v,CI_JOB_URL:E,CI_JOB_NAME:S,CI_STAGE_NAME:T,CI_ENV_VARS:w,GIT_COMMIT_COMMITTER_NAME:x,GIT_COMMIT_COMMITTER_EMAIL:A,CI_NODE_LABELS:I,CI_NODE_NAME:k}=r(61154),{filterSensitiveInfoFromRepository:O}=r(6866);function R(e,t,r){e[t]&&(e[t]=r(e[t]))}function C(e){return e?e.replace(/origin\/|refs\/heads\/|tags\//gm,""):e}function N(e){return e&&"string"==typeof e?"~"!==e[0]||"/"!==e[1]&&1!==e.length?e:e.replace("~",process.env.HOME):""}e.exports={normalizeRef:C,getCIMetadata(){const{env:e}=process;let t={};if(e.JENKINS_URL){const{WORKSPACE:r,BUILD_TAG:s,JOB_NAME:a,BUILD_NUMBER:c,BUILD_URL:u,GIT_BRANCH:l,GIT_COMMIT:p,GIT_URL:d,GIT_URL_1:h,DD_CUSTOM_TRACE_ID:E,NODE_NAME:S,NODE_LABELS:T}=e;if(t={[g]:s,[_]:c,[y]:u,[b]:"jenkins",[i]:p,[f]:d||h,[v]:r,[w]:JSON.stringify({DD_CUSTOM_TRACE_ID:E}),[k]:S},T){let e;try{e=JSON.stringify(T.split(" ")),t[I]=e}catch(e){}}const x=l&&l.includes("tags/")?o:n,A=C(l);t[x]=A;let O="";if(a){const e=a.split("/");O=e.length>1&&e[1].includes("=")?e[0]:a.replace(`/${A}`,""),t[m]=O}}if(e.GITLAB_CI){const{CI_PIPELINE_ID:r,CI_PROJECT_PATH:s,CI_PIPELINE_IID:p,CI_PIPELINE_URL:d,CI_PROJECT_DIR:h,CI_COMMIT_REF_NAME:x,CI_COMMIT_TAG:A,CI_COMMIT_SHA:O,CI_REPOSITORY_URL:R,CI_JOB_URL:C,CI_JOB_STAGE:N,CI_JOB_NAME:P,CI_COMMIT_MESSAGE:D,CI_COMMIT_TIMESTAMP:L,CI_COMMIT_AUTHOR:M,CI_PROJECT_URL:q,CI_JOB_ID:j,CI_RUNNER_ID:U,CI_RUNNER_TAGS:F}=e,{name:B,email:$}=function(e){if(!e)return{name:"",email:""};let t="",r="";const s=e.match(/(?:"?([^"]*)"?\s)?(?:<?(.+@[^>]+)>?)/);return s&&(t=s[1],r=s[2]),{name:t,email:r}}(M);t={[g]:r,[m]:s,[_]:p,[b]:"gitlab",[i]:O,[f]:R,[E]:C,[o]:A,[n]:x,[v]:h,[y]:d,[T]:N,[S]:P,[u]:D,[c]:B,[a]:$,[l]:L,[w]:JSON.stringify({CI_PROJECT_URL:q,CI_PIPELINE_ID:r,CI_JOB_ID:j}),[I]:F,[k]:U}}if(e.CIRCLECI){const{CIRCLE_WORKFLOW_ID:r,CIRCLE_PROJECT_REPONAME:s,CIRCLE_BUILD_URL:a,CIRCLE_WORKING_DIRECTORY:c,CIRCLE_BRANCH:u,CIRCLE_TAG:l,CIRCLE_SHA1:p,CIRCLE_REPOSITORY_URL:d,CIRCLE_JOB:h,CIRCLE_BUILD_NUM:_}=e,T=`https://app.circleci.com/pipelines/workflows/${r}`;t={[g]:r,[m]:s,[y]:T,[S]:h,[b]:"circleci",[i]:p,[f]:d,[E]:a,[v]:c,[o]:l,[n]:u,[w]:JSON.stringify({CIRCLE_WORKFLOW_ID:r,CIRCLE_BUILD_NUM:_})}}if(e.GITHUB_ACTIONS||e.GITHUB_ACTION){const{GITHUB_RUN_ID:r,GITHUB_WORKFLOW:a,GITHUB_RUN_NUMBER:c,GITHUB_WORKSPACE:u,GITHUB_HEAD_REF:l,GITHUB_REF:T,GITHUB_SHA:x,GITHUB_REPOSITORY:A,GITHUB_SERVER_URL:I,GITHUB_RUN_ATTEMPT:k,GITHUB_JOB:R,GITHUB_BASE_REF:C}=e,N=`${I}/${A}.git`;let P=`${I}/${A}/actions/runs/${r}`;k&&(P=`${P}/attempts/${k}`);const D=`${I}/${A}/commit/${x}/checks`,L=l||T||"",M=L.includes("tags/")?o:n;if(t={[g]:r,[m]:a,[_]:c,[y]:O(P),[b]:"github",[i]:x,[f]:N,[E]:O(D),[S]:R,[v]:u,[M]:L,[w]:JSON.stringify({GITHUB_SERVER_URL:O(I),GITHUB_REPOSITORY:A,GITHUB_RUN_ID:r,GITHUB_RUN_ATTEMPT:k})},C){t[h]=C;try{const e=function(){if(process.env.GITHUB_EVENT_PATH)return JSON.parse(s(process.env.GITHUB_EVENT_PATH,"utf8"))}();t[d]=e.pull_request.base.sha,t[p]=e.pull_request.head.sha}catch(e){}}}if(e.APPVEYOR){const{APPVEYOR_REPO_NAME:r,APPVEYOR_REPO_PROVIDER:s,APPVEYOR_BUILD_FOLDER:l,APPVEYOR_BUILD_ID:p,APPVEYOR_BUILD_NUMBER:d,APPVEYOR_REPO_COMMIT:h,APPVEYOR_PULL_REQUEST_HEAD_REPO_BRANCH:S,APPVEYOR_REPO_BRANCH:T,APPVEYOR_REPO_TAG_NAME:w,APPVEYOR_REPO_COMMIT_AUTHOR:x,APPVEYOR_REPO_COMMIT_AUTHOR_EMAIL:A,APPVEYOR_REPO_COMMIT_MESSAGE:I,APPVEYOR_REPO_COMMIT_MESSAGE_EXTENDED:k}=e,O=`https://ci.appveyor.com/project/${r}/builds/${p}`;t={[b]:"appveyor",[y]:O,[g]:p,[m]:r,[_]:d,[E]:O,[v]:l,[c]:x,[a]:A,[u]:I+"\n"+k},"github"===s&&(t={...t,[f]:`https://github.com/${r}.git`,[i]:h,[o]:w,[n]:S||T})}if(e.TF_BUILD){const{BUILD_SOURCESDIRECTORY:r,BUILD_BUILDID:s,BUILD_DEFINITIONNAME:l,SYSTEM_TEAMFOUNDATIONSERVERURI:p,SYSTEM_TEAMPROJECTID:d,SYSTEM_JOBID:h,SYSTEM_TASKINSTANCEID:x,SYSTEM_PULLREQUEST_SOURCEBRANCH:A,BUILD_SOURCEBRANCH:I,BUILD_SOURCEBRANCHNAME:k,SYSTEM_PULLREQUEST_SOURCECOMMITID:O,SYSTEM_PULLREQUEST_SOURCEREPOSITORYURI:R,BUILD_REPOSITORY_URI:C,BUILD_SOURCEVERSION:N,BUILD_REQUESTEDFORID:P,BUILD_REQUESTEDFOREMAIL:D,BUILD_SOURCEVERSIONMESSAGE:L,SYSTEM_STAGEDISPLAYNAME:M,SYSTEM_JOBDISPLAYNAME:q}=e,j=A||I||k,U=(j||"").includes("tags/")?o:n;if(t={[b]:"azurepipelines",[g]:s,[m]:l,[_]:s,[i]:O||N,[v]:r,[f]:R||C,[U]:j,[c]:P,[a]:D,[u]:L,[T]:M,[S]:q,[w]:JSON.stringify({SYSTEM_TEAMPROJECTID:d,BUILD_BUILDID:s,SYSTEM_JOBID:h})},p&&d&&s){const e=`${p}${d}/_build/results?buildId=${s}`,r=e,n=`${e}&view=logs&j=${h}&t=${x}`;t={...t,[y]:r,[E]:n}}}if(e.BITBUCKET_COMMIT){const{BITBUCKET_REPO_FULL_NAME:r,BITBUCKET_BUILD_NUMBER:s,BITBUCKET_BRANCH:a,BITBUCKET_COMMIT:c,BITBUCKET_GIT_SSH_ORIGIN:u,BITBUCKET_GIT_HTTP_ORIGIN:l,BITBUCKET_TAG:p,BITBUCKET_PIPELINE_UUID:d,BITBUCKET_CLONE_DIR:h}=e,S=`https://bitbucket.org/${r}/addon/pipelines/home#!/results/${s}`;t={[b]:"bitbucket",[i]:c,[_]:s,[m]:r,[E]:S,[y]:S,[n]:a,[o]:p,[f]:u||l,[v]:h,[g]:d&&d.replace(/{|}/gm,"")}}if(e.BITRISE_BUILD_SLUG){const{BITRISE_GIT_COMMIT:r,GIT_CLONE_COMMIT_HASH:s,BITRISEIO_GIT_BRANCH_DEST:a,BITRISE_GIT_BRANCH:c,BITRISE_BUILD_SLUG:l,BITRISE_TRIGGERED_WORKFLOW_ID:p,BITRISE_BUILD_NUMBER:d,BITRISE_BUILD_URL:h,BITRISE_SOURCE_DIR:E,GIT_REPOSITORY_URL:S,BITRISE_GIT_TAG:T,BITRISE_GIT_MESSAGE:w}=e;t={[b]:"bitrise",[g]:l,[m]:p,[_]:d,[y]:h,[i]:r||s,[f]:S,[v]:E,[o]:T,[n]:a||c,[u]:w}}if(e.BUILDKITE){const{BUILDKITE_BRANCH:r,BUILDKITE_COMMIT:s,BUILDKITE_REPO:l,BUILDKITE_TAG:p,BUILDKITE_BUILD_ID:d,BUILDKITE_PIPELINE_SLUG:h,BUILDKITE_BUILD_NUMBER:S,BUILDKITE_BUILD_URL:T,BUILDKITE_JOB_ID:x,BUILDKITE_BUILD_CHECKOUT_PATH:A,BUILDKITE_BUILD_AUTHOR:O,BUILDKITE_BUILD_AUTHOR_EMAIL:R,BUILDKITE_MESSAGE:C,BUILDKITE_AGENT_ID:N}=e,P=Object.keys(e).filter((e=>e.startsWith("BUILDKITE_AGENT_META_DATA_"))).map((t=>`${t.replace("BUILDKITE_AGENT_META_DATA_","").toLowerCase()}:${e[t]}`));t={[b]:"buildkite",[g]:d,[m]:h,[_]:S,[y]:T,[E]:`${T}#${x}`,[i]:s,[v]:A,[f]:l,[o]:p,[n]:r,[c]:O,[a]:R,[u]:C,[w]:JSON.stringify({BUILDKITE_BUILD_ID:d,BUILDKITE_JOB_ID:x}),[k]:N,[I]:JSON.stringify(P)}}if(e.TRAVIS){const{TRAVIS_PULL_REQUEST_BRANCH:r,TRAVIS_BRANCH:s,TRAVIS_COMMIT:a,TRAVIS_REPO_SLUG:c,TRAVIS_TAG:l,TRAVIS_JOB_WEB_URL:p,TRAVIS_BUILD_ID:d,TRAVIS_BUILD_NUMBER:h,TRAVIS_BUILD_WEB_URL:S,TRAVIS_BUILD_DIR:T,TRAVIS_COMMIT_MESSAGE:w}=e;t={[b]:"travisci",[E]:p,[g]:d,[m]:c,[_]:h,[y]:S,[i]:a,[f]:`https://github.com/${c}.git`,[v]:T,[o]:l,[n]:r||s,[u]:w}}if(e.BUDDY){const{BUDDY_EXECUTION_BRANCH:r,BUDDY_EXECUTION_ID:s,BUDDY_EXECUTION_REVISION:a,BUDDY_EXECUTION_REVISION_COMMITTER_EMAIL:c,BUDDY_EXECUTION_REVISION_COMMITTER_NAME:l,BUDDY_EXECUTION_REVISION_MESSAGE:p,BUDDY_EXECUTION_TAG:d,BUDDY_EXECUTION_URL:h,BUDDY_PIPELINE_ID:v,BUDDY_PIPELINE_NAME:E,BUDDY_SCM_URL:S}=e;t={[b]:"buddy",[g]:`${v}/${s}`,[m]:E,[_]:s,[y]:h,[i]:a,[f]:S,[n]:r,[o]:d,[u]:p,[x]:l,[A]:c}}if(e.TEAMCITY_VERSION){const{BUILD_URL:r,TEAMCITY_BUILDCONF_NAME:s,DATADOG_BUILD_ID:n}=e;t={[b]:"teamcity",[E]:r,[S]:s,[w]:JSON.stringify({DATADOG_BUILD_ID:n})}}if(e.CF_BUILD_ID){const{CF_BUILD_ID:r,CF_PIPELINE_NAME:s,CF_BUILD_URL:i,CF_STEP_NAME:a,CF_BRANCH:c}=e;t={[b]:"codefresh",[g]:r,[m]:s,[y]:i,[S]:a,[w]:JSON.stringify({CF_BUILD_ID:r})};const u=c&&c.includes("tags/")?o:n,l=C(c);t[u]=l}if(e.CODEBUILD_INITIATOR?.startsWith("codepipeline/")){const{CODEBUILD_BUILD_ARN:r,DD_ACTION_EXECUTION_ID:s,DD_PIPELINE_EXECUTION_ID:n}=e;t={[b]:"awscodepipeline",[g]:n,[w]:JSON.stringify({CODEBUILD_BUILD_ARN:r,DD_PIPELINE_EXECUTION_ID:n,DD_ACTION_EXECUTION_ID:s})}}return R(t,v,N),R(t,f,O),R(t,n,C),R(t,o,C),function(e){return Object.keys(e).reduce(((t,r)=>e[r]?{...t,[r]:e[r]}:t),{})}(t)}}},59052:(e,t,r)=>{const s=r(70857),n="os.platform",i="os.version",o="os.architecture",a="runtime.name",c="runtime.version",u="_dd.host.vcpu_count";e.exports={getRuntimeAndOSMetadata:function(){return{[c]:process.version,[o]:process.arch,[n]:process.platform,[a]:"node",[i]:s.release(),[u]:s.cpus().length}},OS_PLATFORM:n,OS_VERSION:i,OS_ARCHITECTURE:o,RUNTIME_NAME:a,RUNTIME_VERSION:c,DD_HOST_CPU_COUNT:u}},82919:(e,t,r)=>{const s=r(35317),n=r(70857),i=r(16928),o=r(79896),a=r(75004),{GIT_COMMIT_SHA:c,GIT_BRANCH:u,GIT_REPOSITORY_URL:l,GIT_TAG:p,GIT_COMMIT_MESSAGE:d,GIT_COMMIT_COMMITTER_DATE:h,GIT_COMMIT_COMMITTER_EMAIL:f,GIT_COMMIT_COMMITTER_NAME:g,GIT_COMMIT_AUTHOR_DATE:m,GIT_COMMIT_AUTHOR_EMAIL:_,GIT_COMMIT_AUTHOR_NAME:y,CI_WORKSPACE_PATH:b}=r(61154),{incrementCountMetric:v,distributionMetric:E,TELEMETRY_GIT_COMMAND:S,TELEMETRY_GIT_COMMAND_MS:T,TELEMETRY_GIT_COMMAND_ERRORS:w}=r(60806),{filterSensitiveInfoFromRepository:x}=r(6866),{storage:A}=r(96882),I=12582912;function k(e,t,r,n,i){const o=A.getStore();let c;A.enterWith({noop:!0}),r&&v(r.name,r.tags),n&&(c=Date.now());try{const r=s.execFileSync(e,t,{stdio:"pipe"}).toString().replace(/(\r\n|\n|\r)/gm,"");return n&&E(n.name,n.tags,Date.now()-c),r}catch(e){return i&&v(i.name,{...i.tags,errorType:e.code,exitCode:e.status||e.errno}),a.error("Git plugin error executing command",e),""}finally{A.enterWith(o)}}e.exports={getGitMetadata:function(e){const{commitSHA:t,branch:r,repositoryUrl:s,tag:n,commitMessage:i,authorName:o,authorEmail:a,ciWorkspacePath:v}=e,[E,S,T,w,A,I]=k("git",["show","-s","--format=%an,%ae,%aI,%cn,%ce,%cI"]).split(",");return{[l]:x(s||k("git",["ls-remote","--get-url"])),[d]:i||k("git",["show","-s","--format=%s"]),[m]:T,[y]:o||E,[_]:a||S,[h]:I,[g]:w,[f]:A,[u]:r||k("git",["rev-parse","--abbrev-ref","HEAD"]),[c]:t||k("git",["rev-parse","HEAD"]),[p]:n,[b]:v||k("git",["rev-parse","--show-toplevel"])}},getLatestCommits:function(){v(S,{command:"get_local_commits"});const e=Date.now();try{const t=s.execFileSync("git",["log","--format=%H","-n 1000",'--since="1 month ago"'],{stdio:"pipe"}).toString().split("\n").filter((e=>e));return E(T,{command:"get_local_commits"},Date.now()-e),t}catch(e){return a.error("Get latest commits failed: %s",e.message),v(w,{command:"get_local_commits",errorType:e.status}),[]}},getRepositoryUrl:function(){return k("git",["config","--get","remote.origin.url"],{name:S,tags:{command:"get_repository"}},{name:T,tags:{command:"get_repository"}},{name:w,tags:{command:"get_repository"}})},generatePackFilesForCommits:function(e){let t=[];const r=n.tmpdir();if(!function(e){try{return o.statSync(e).isDirectory()}catch(e){return!1}}(r))return a.error(new Error("Provided path to generate packfiles is not a directory")),[];const c=String(Math.floor(1e4*Math.random())),u=i.join(r,c),l=i.join(process.cwd(),c);v(S,{command:"pack_objects"});const p=Date.now();function d(t){return s.execFileSync("git",["pack-objects","--compression=9","--max-pack-size=3m",t],{stdio:"pipe",input:e.join("\n")}).toString().split("\n").filter((e=>e)).map((e=>`${t}-${e}.pack`))}try{t=d(u)}catch(e){a.error("Git plugin error executing git pack-objects command",e),v(w,{command:"pack_objects",exitCode:e.status||e.errno,errorType:e.code});try{t=d(l)}catch(e){a.error("Git plugin error executing fallback git pack-objects command",e),v(w,{command:"pack_objects",exitCode:e.status||e.errno,errorType:e.code})}}return E(T,{command:"pack_objects"},Date.now()-p),t},getCommitsRevList:function(e,t){let r=null;const n=e.map((e=>`^${e}`));v(S,{command:"get_objects"});const i=Date.now();try{r=s.execFileSync("git",["rev-list","--objects","--no-object-names","--filter=blob:none",'--since="1 month ago"',...n,...t],{stdio:"pipe",maxBuffer:I}).toString().split("\n").filter((e=>e))}catch(e){a.error("Get commits to upload failed: %s",e.message),v(w,{command:"get_objects",errorType:e.code,exitCode:e.status||e.errno})}return E(T,{command:"get_objects"},Date.now()-i),r},GIT_REV_LIST_MAX_BUFFER:I,isShallowRepository:function(){return"true"===k("git",["rev-parse","--is-shallow-repository"],{name:S,tags:{command:"check_shallow"}},{name:T,tags:{command:"check_shallow"}},{name:w,tags:{command:"check_shallow"}})},unshallowRepository:function(){const e=function(){const e=k("git",["version"]).match(/git version (\d+)\.(\d+)\.(\d+)/);try{return{major:parseInt(e[1]),minor:parseInt(e[2]),patch:parseInt(e[3])}}catch(e){return null}}();if(!e)return void a.warn("Git version could not be extracted, so git unshallow will not proceed");if(e.major<2||2===e.major&&e.minor<27)return void a.warn("Git version is <2.27, so git unshallow will not proceed");const t=k("git",["config","--default","origin","--get","clone.defaultRemoteName"]),r=k("git",["rev-parse","HEAD"]),n=["fetch",'--shallow-since="1 month ago"',"--update-shallow","--filter=blob:none","--recurse-submodules=no",t];v(S,{command:"unshallow"});const i=Date.now();try{s.execFileSync("git",[...n,r],{stdio:"pipe"})}catch(e){a.error("Git plugin error executing git command",e),v(w,{command:"unshallow",errorType:e.code,exitCode:e.status||e.errno});const t=k("git",["rev-parse","--abbrev-ref","--symbolic-full-name","@{upstream}"]);try{s.execFileSync("git",[...n,t],{stdio:"pipe"})}catch(e){a.error("Git plugin error executing fallback git command",e),v(w,{command:"unshallow",errorType:e.code,exitCode:e.status||e.errno}),k("git",n,null,null,{name:w,tags:{command:"unshallow"}})}}E(T,{command:"unshallow"},Date.now()-i)},isGitAvailable:function(){const e="win32"===n.platform()?"where":"which";try{return s.execFileSync(e,["git"],{stdio:"pipe"}),!0}catch(e){return v(w,{command:"check_git",exitCode:"missing"}),!1}}}},45975:(e,t,r)=>{const s=r(75004),n=r(74100),i=n.RESOURCE_NAME,o=n.SPAN_KIND,a=n.SPAN_TYPE,c=n.HTTP_URL,u=n.HTTP_METHOD,l="x-dd-proxy",p="x-dd-proxy-request-time-ms",d={"aws-apigateway":{spanName:"aws.apigateway",component:"aws-apigateway"}};e.exports={createInferredProxySpan:function(e,t,r,n){if(!e)return null;if(!r._config?.inferredProxyServicesEnabled)return null;const h=function(e){return p in e?l in e&&e[l]in d?{requestTime:e[p]?parseInt(e[p],10):null,method:e["x-dd-proxy-httpmethod"],path:e["x-dd-proxy-path"],stage:e["x-dd-proxy-stage"],domainName:e["x-dd-proxy-domain-name"],proxySystemName:e[l]}:(s.debug(`Received headers to create inferred proxy span but headers include an unsupported proxy type ${e}`),null):null}(e);if(!h)return null;const f=d[h.proxySystemName];s.debug(`Successfully extracted inferred span info ${h} for proxy: ${h.proxySystemName}`);const g=r.startSpan(f.spanName,{childOf:t,type:"web",startTime:h.requestTime,tags:{service:h.domainName||r._config.service,component:f.component,[o]:"internal",[a]:"web",[u]:h.method,[c]:h.domainName+h.path,stage:h.stage}});return r.scope().activate(g),n.inferredProxySpan=g,t=g,s.debug("Successfully created inferred proxy span."),function(e,t){e.setTag(i,`${t.method} ${t.path}`),e.setTag("_dd.inferred_span","1")}(g,h),t},finishInferredProxySpan:function(e){const{req:t}=e;e.inferredProxySpan&&(e.inferredProxySpanFinished&&!t.stream||e.inferredProxySpan&&(e.inferredProxySpan.finish(),e.inferredProxySpanFinished=!0))}}},79449:(e,t,r)=>{"use strict";const{BlockList:s}=r(69278),n=r(69278),i=["x-forwarded-for","x-real-ip","true-client-ip","x-client-ip","forwarded-for","x-cluster-client-ip","fastly-client-ip","cf-connecting-ip","cf-connecting-ipv6"],o=["127.0.0.0/8","10.0.0.0/8","172.16.0.0/12","192.168.0.0/16","169.254.0.0/16","::1/128","fec0::/10","fe80::/10","fc00::/7","fd00::/8"],a=new s;for(const e of o){const[t,r]=e.split("/");a.addSubnet(t,parseInt(r),n.isIPv6(t)?"ipv6":"ipv4")}function c(e){const t={};if(!e)return t;const r=e.split(",");for(const e of r){const r=e.trim(),s=n.isIP(r);if(s){if(!a.check(r,6===s?"ipv6":"ipv4")){t.public=r;break}t.private||(t.private=r)}}return t}e.exports={extractIp:function(e,t){const r=t.headers;if(e.clientIpHeader){if(!r)return;const t=c(r[e.clientIpHeader]);return t.public||t.private}let s;if(r)for(const e of i){const t=c(r[e]);if(t.public)return t.public;!s&&t.private&&(s=t.private)}return s||t.socket?.remoteAddress},ipHeaderList:i}},89612:(e,t,r)=>{const s=r(99429),n=/\n/g,i=/\t/g;e.exports=function(e,t){const r=t[e]||{},{spanCharLimit:o,spanPromptCompletionSampleRate:a}=r,c=new s(a??1);return{normalize:e=>function(e,t=128){if(e&&"string"==typeof e&&e&&("string"!=typeof e||0!==e.length))return(e=e.replace(n,"\\n").replace(i,"\\t")).length>t?e.substring(0,t)+"...":e}(e,o),isPromptCompletionSampled:()=>function(e){return e.isSampled()}(c)}}},67121:(e,t,r)=>{const s=r(70780),n={...r(5593)};n.TYPE=s.SERVERLESS,e.exports=n},78834:(e,t,r)=>{"use strict";const{relative:s,sep:n,isAbsolute:i}=r(16928),o=process.cwd();function a(e){const t=Error.stackTraceLimit;Error.stackTraceLimit=1/0;const r={},s=Error.prepareStackTrace;Error.prepareStackTrace=function(e,t){return t},Error.captureStackTrace(r,e);const n=r.stack;return Error.prepareStackTrace=s,Error.stackTraceLimit=t,n}e.exports={getCallSites:a,getUserLandFrames:function(e,t=1/0){const r=a(e),c=[];for(const e of r){if(e.isNative())continue;const r=e.getFileName();if(null===r)continue;const a=r.startsWith("file:");if(!1===a&&!1===i(r))continue;const u=s(o,a?r.substring(7):r);if(u.startsWith("node_modules"+n)||u.includes(n+"node_modules"+n))continue;const l=e.getFunctionName(),p=e.getTypeName();if(c.push({file:r,line:e.getLineNumber(),column:e.getColumnNumber(),method:l??void 0,type:p??void 0}),c.length===t)break}return c}}},61154:e=>{e.exports={GIT_COMMIT_SHA:"git.commit.sha",GIT_BRANCH:"git.branch",GIT_REPOSITORY_URL:"git.repository_url",GIT_TAG:"git.tag",GIT_COMMIT_MESSAGE:"git.commit.message",GIT_COMMIT_COMMITTER_DATE:"git.commit.committer.date",GIT_COMMIT_COMMITTER_EMAIL:"git.commit.committer.email",GIT_COMMIT_COMMITTER_NAME:"git.commit.committer.name",GIT_COMMIT_AUTHOR_DATE:"git.commit.author.date",GIT_COMMIT_AUTHOR_EMAIL:"git.commit.author.email",GIT_COMMIT_AUTHOR_NAME:"git.commit.author.name",GIT_COMMIT_HEAD_SHA:"git.commit.head_sha",GIT_PULL_REQUEST_BASE_BRANCH_SHA:"git.pull_request.base_branch_sha",GIT_PULL_REQUEST_BASE_BRANCH:"git.pull_request.base_branch",CI_PIPELINE_ID:"ci.pipeline.id",CI_PIPELINE_NAME:"ci.pipeline.name",CI_PIPELINE_NUMBER:"ci.pipeline.number",CI_PIPELINE_URL:"ci.pipeline.url",CI_PROVIDER_NAME:"ci.provider.name",CI_WORKSPACE_PATH:"ci.workspace_path",CI_JOB_URL:"ci.job.url",CI_JOB_NAME:"ci.job.name",CI_STAGE_NAME:"ci.stage.name",CI_ENV_VARS:"_dd.ci.env_vars",CI_NODE_NAME:"ci.node.name",CI_NODE_LABELS:"ci.node.labels"}},97507:(e,t,r)=>{const s=r(16928),n=r(79896),{URL:i}=r(87016),o=r(75004),a=r(51958),c=r(82535),{getGitMetadata:u}=r(82919),{getUserProviderGitMetadata:l,validateGitRepositoryUrl:p,validateGitCommitSha:d}=r(38755),{getCIMetadata:h}=r(65711),{getRuntimeAndOSMetadata:f}=r(59052),{GIT_BRANCH:g,GIT_COMMIT_SHA:m,GIT_REPOSITORY_URL:_,GIT_TAG:y,GIT_COMMIT_AUTHOR_EMAIL:b,GIT_COMMIT_AUTHOR_NAME:v,GIT_COMMIT_MESSAGE:E,CI_WORKSPACE_PATH:S,CI_PIPELINE_URL:T,CI_JOB_NAME:w}=r(61154),x=r(94248),{SPAN_TYPE:A,RESOURCE_NAME:I,SAMPLING_PRIORITY:k}=r(74100),{SAMPLING_RULE_DECISION:O}=r(23636),{AUTO_KEEP:R}=r(1013),{version:C}=r(8330),N="test.framework",P="test.framework_version",D="test.type",L="test.name",M="test.suite",q="library_version",j="test.command",U="test.module",F="test.toolchain",B="_dd.ci.itr.tests_skipped",$="test.itr.tests_skipping.enabled",G="test.itr.tests_skipping.type",V="test.itr.tests_skipping.count",z="test.code_coverage.enabled",H="test.itr.unskippable",K="test.itr.forced_run",Y="test.code_coverage.lines_pct",Q="Retried by Datadog's Early Flake Detection",W=new RegExp(Q+" \\(#\\d+\\): ","g");function Z(){try{return process.env.npm_config_user_agent.split(" ")[0].replace("/","-")}catch(e){return""}}function J(e){return Object.keys(e).reduce(((t,r)=>r!==_||p(e[_])?r!==m||d(e[m])?r!==T||function(e){try{const t=new i(e);return"https:"===t.protocol||"http:"===t.protocol}catch(e){return!1}}(e[T])?(t[r]=e[r],t):t:(o.error("Git commit SHA must be a full-length git SHA: %s.",e[m]),t):(o.error("Repository URL is not a valid repository URL: %s.",e[_]),t)),{})}function X(e){return"playwright"===e||"cypress"===e?"browser":"test"}e.exports={TEST_CODE_OWNERS:"test.codeowners",TEST_SESSION_NAME:"test_session.name",TEST_FRAMEWORK:N,TEST_FRAMEWORK_VERSION:P,JEST_TEST_RUNNER:"test.jest.test_runner",JEST_DISPLAY_NAME:"test.jest.display_name",CUCUMBER_IS_PARALLEL:"test.cucumber.is_parallel",MOCHA_IS_PARALLEL:"test.mocha.is_parallel",TEST_TYPE:D,TEST_NAME:L,TEST_SUITE:M,TEST_STATUS:"test.status",TEST_PARAMETERS:"test.parameters",TEST_SKIP_REASON:"test.skip_reason",TEST_IS_RUM_ACTIVE:"test.is_rum_active",TEST_SOURCE_FILE:"test.source.file",CI_APP_ORIGIN:"ciapp-test",LIBRARY_VERSION:q,JEST_WORKER_TRACE_PAYLOAD_CODE:60,JEST_WORKER_COVERAGE_PAYLOAD_CODE:61,JEST_WORKER_LOGS_PAYLOAD_CODE:62,CUCUMBER_WORKER_TRACE_PAYLOAD_CODE:70,MOCHA_WORKER_TRACE_PAYLOAD_CODE:80,TEST_SOURCE_START:"test.source.start",TEST_SKIPPED_BY_ITR:"test.skipped_by_itr",TEST_CONFIGURATION_BROWSER_NAME:"test.configuration.browser_name",TEST_IS_NEW:"test.is_new",TEST_IS_RETRY:"test.is_retry",TEST_EARLY_FLAKE_ENABLED:"test.early_flake.enabled",TEST_EARLY_FLAKE_ABORT_REASON:"test.early_flake.abort_reason",TEST_RETRY_REASON:"test.retry_reason",getTestEnvironmentMetadata:function(e,t){const r=h(),{[m]:s,[g]:n,[_]:i,[y]:o,[v]:a,[b]:c,[E]:p,[S]:d}=r,T=u({commitSHA:s,branch:n,repositoryUrl:i,tag:o,authorName:a,authorEmail:c,commitMessage:p,ciWorkspacePath:d}),w=l(),x=f(),A={[N]:e,...T,...r,...w,...x};return t&&t.service&&(A["service.name"]=t.service),J(A)},getTestParametersString:function(e,t){if(!e[t])return"";try{const r=e[t].shift();return JSON.stringify({arguments:r,metadata:{}})}catch(e){return""}},finishAllTraceSpans:function(e){e.context()._trace.started.forEach((t=>{t!==e&&t.finish()}))},getTestParentSpan:function(e){return e.extract("text_map",{"x-datadog-trace-id":x().toString(10),"x-datadog-parent-id":"0000000000000000"})},getTestSuitePath:function(e,t){return e?(e===t?e:s.relative(t,e)).replace(s.sep,"/"):t},getCodeOwnersFileEntries:function(e){let t,r=e,s=!1;const n=process.cwd();if(r&&r!==n||(r=n,s=!0),t=te(r),t||s||(t=te(n)),!t)return null;const i=[],o=t.split("\n");for(const e of o){const[t]=e.split("#"),r=t.trim();if(""===r)continue;const[s,...n]=r.split(/\s+/);i.push({pattern:s,owners:n})}return i.reverse()},getCodeOwnersForFilename:function(e,t){if(!t)return null;for(const r of t)try{if(c().add(r.pattern).ignores(e))return JSON.stringify(r.owners)}catch(e){return null}return null},getTestCommonTags:function(e,t,r,s){return{[A]:"test",[D]:X(s),[O]:1,[k]:R,[L]:e,[M]:t,[I]:`${t}.${e}`,[P]:r,[q]:C}},getTestSessionCommonTags:function(e,t,r){return{[A]:"test_session_end",[I]:`test_session.${e}`,[U]:r,[F]:Z(),...re(e,t,r)}},getTestModuleCommonTags:function(e,t,r){return{[A]:"test_module_end",[I]:`test_module.${e}`,[U]:r,...re(e,t,r)}},getTestSuiteCommonTags:function(e,t,r,s){return{[A]:"test_suite_end",[I]:`test_suite.${r}`,[U]:s,[M]:r,...re(e,t,s)}},TEST_COMMAND:j,TEST_TOOLCHAIN:F,TEST_SESSION_ID:"test_session_id",TEST_MODULE_ID:"test_module_id",TEST_SUITE_ID:"test_suite_id",TEST_ITR_TESTS_SKIPPED:B,TEST_MODULE:U,TEST_ITR_SKIPPING_ENABLED:$,TEST_ITR_SKIPPING_TYPE:G,TEST_ITR_SKIPPING_COUNT:V,TEST_CODE_COVERAGE_ENABLED:z,TEST_CODE_COVERAGE_LINES_PCT:Y,TEST_ITR_UNSKIPPABLE:H,TEST_ITR_FORCED_RUN:K,ITR_CORRELATION_ID:"itr_correlation_id",addIntelligentTestRunnerSpanTags:function(e,t,{isSuitesSkipped:r,isSuitesSkippingEnabled:s,isCodeCoverageEnabled:n,testCodeCoverageLinesTotal:i,skippingCount:o,skippingType:a="suite",hasUnskippableSuites:c,hasForcedToRunSuites:u}){e.setTag(B,r?"true":"false"),e.setTag($,s?"true":"false"),e.setTag(G,a),e.setTag(V,o),e.setTag(z,n?"true":"false"),t.setTag(B,r?"true":"false"),t.setTag($,s?"true":"false"),t.setTag(G,a),t.setTag(V,o),t.setTag(z,n?"true":"false"),c&&(e.setTag(H,"true"),t.setTag(H,"true")),u&&(e.setTag(K,"true"),t.setTag(K,"true")),void 0!==i&&(e.setTag(Y,i),t.setTag(Y,i))},getCoveredFilenamesFromCoverage:function(e){const t=a.createCoverageMap(e);return t.files().filter((e=>{const r=t.fileCoverageFor(e).getLineCoverage();return Object.entries(r).some((([,e])=>!!e))}))},resetCoverage:function(e){const t=a.createCoverageMap(e);return t.files().forEach((e=>{t.fileCoverageFor(e).resetHits()}))},mergeCoverage:function(e,t){const r=a.createCoverageMap(e);return r.files().forEach((e=>{const s=r.fileCoverageFor(e);t.data[e]||t.addFileCoverage(a.createFileCoverage(e)),t.addFileCoverage(s);const n=t.fileCoverageFor(e);Object.entries(n.data.b).forEach((([e,t])=>{n.data.b[e]=[...t]}))}))},fromCoverageMapToCoverage:function(e){return Object.entries(e.data).reduce(((e,[t,r])=>(e[t]=r.data,e)),{})},getTestLineStart:function(e,t){if(!e.stack)return null;const r=e.stack.split("\n").find((e=>e.includes(t)));try{const e=r.match(/at (?:(.+?)\s+\()?(?:(.+?):(\d+)(?::(\d+))?|([^)]+))\)?/);return parseInt(e[3],10)||null}catch(e){return null}},removeInvalidMetadata:J,parseAnnotations:function(e){return e.reduce(((e,t)=>{if(!t?.type)return e;const{type:r,description:s}=t;if(r.startsWith("DD_TAGS")){const t=/\[(.*?)\]/.exec(r);let n="";t&&(n=t[1]),n&&(e[n]=s)}return e}),{})},EFD_STRING:Q,EFD_TEST_NAME_REGEX:W,removeEfdStringFromTestName:function(e){return e.replace(W,"")},addEfdStringToTestName:function(e,t){return`${Q} (#${t}): ${e}`},getIsFaultyEarlyFlakeDetection:function(e,t,r){let s=0;for(const r of e)t[r]||s++;const n=s/e.length*100;return s>r&&n>r},TEST_BROWSER_DRIVER:"test.browser.driver",TEST_BROWSER_DRIVER_VERSION:"test.browser.driver_version",TEST_BROWSER_NAME:"test.browser.name",TEST_BROWSER_VERSION:"test.browser.version",getTestSessionName:function(e,t,r){return e.ciVisibilityTestSessionName?e.ciVisibilityTestSessionName:r[w]?`${r[w]}-${t}`:t},TEST_LEVEL_EVENT_TYPES:["test","test_suite_end","test_module_end","test_session_end"],getNumFromKnownTests:function(e){if(!e)return 0;let t=0;for(const r of Object.values(e))for(const e of Object.values(r))t+=e.length;return t},getFileAndLineNumberFromError:function(e,t){const r=e.stack.split("\n").filter((e=>e.includes("at ")&&e.includes(t))),s=r.findIndex((e=>e.includes(t)&&!se.some((t=>e.includes(t)))));if(-1===s)return[];const n=r[s].match(/\s*at\s+(?:.*\()?(.+):(\d+):(\d+)\)?/);return n?[n[1],Number(n[2]),s]:[]},DI_ERROR_DEBUG_INFO_CAPTURED:"error.debug_info_captured",DI_DEBUG_ERROR_PREFIX:"_dd.debug.error",DI_DEBUG_ERROR_SNAPSHOT_ID_SUFFIX:"snapshot_id",DI_DEBUG_ERROR_FILE_SUFFIX:"file",DI_DEBUG_ERROR_LINE_SUFFIX:"line",getFormattedError:function(e,t){const r=new Error(e.message);return e.stack&&(r.stack=e.stack.split("\n").filter((e=>e.includes(t))).join("\n")),r.name=e.name,r}};const ee=["CODEOWNERS",".github/CODEOWNERS","docs/CODEOWNERS",".gitlab/CODEOWNERS"];function te(e){for(const t of ee)try{return n.readFileSync(s.join(e,t)).toString()}catch(e){}return""}function re(e,t,r){return{[P]:t,[q]:C,[j]:e,[D]:X(r)}}const se=["node_modules","node:",".pnpm",".yarn",".pnp"]},6866:(e,t,r)=>{const{URL:s}=r(87016);e.exports={filterSensitiveInfoFromRepository:function(e){if(!e)return"";if(e.startsWith("git@"))return e;if(e.startsWith("ssh://")){const t=/^(ssh:\/\/)[^@/]*@/;return e.replace(t,"$1")}try{const{protocol:t,host:r,pathname:n}=new s(e);return`${t}//${r}${"/"===n?"":n}`}catch(e){return""}}}},70240:(e,t,r)=>{"use strict";const s=r(75004),n={getFilter(e){if("function"==typeof e.filter)return e.filter;e.hasOwnProperty("filter")&&s.error("Expected `filter` to be a function. Overriding filter property to default.");const t=e.allowlist||e.whitelist||/.*/,r=e.blocklist||e.blacklist||[];return e=>{const s=n(t,e),i=n(r,e);return s&&!i};function n(e,t){return"function"==typeof e?e(t):e instanceof RegExp?e.test(t):e instanceof Array?e.some((e=>n(e,t))):e===t}}};e.exports=n},38755:(e,t,r)=>{const{GIT_COMMIT_SHA:s,GIT_BRANCH:n,GIT_REPOSITORY_URL:i,GIT_TAG:o,GIT_COMMIT_MESSAGE:a,GIT_COMMIT_COMMITTER_DATE:c,GIT_COMMIT_COMMITTER_EMAIL:u,GIT_COMMIT_COMMITTER_NAME:l,GIT_COMMIT_AUTHOR_DATE:p,GIT_COMMIT_AUTHOR_EMAIL:d,GIT_COMMIT_AUTHOR_NAME:h}=r(61154),{normalizeRef:f}=r(65711),{filterSensitiveInfoFromRepository:g}=r(6866);e.exports={getUserProviderGitMetadata:function(){const{DD_GIT_COMMIT_SHA:e,DD_GIT_BRANCH:t,DD_GIT_REPOSITORY_URL:r,DD_GIT_TAG:m,DD_GIT_COMMIT_MESSAGE:_,DD_GIT_COMMIT_COMMITTER_NAME:y,DD_GIT_COMMIT_COMMITTER_EMAIL:b,DD_GIT_COMMIT_COMMITTER_DATE:v,DD_GIT_COMMIT_AUTHOR_NAME:E,DD_GIT_COMMIT_AUTHOR_EMAIL:S,DD_GIT_COMMIT_AUTHOR_DATE:T}=process.env,w=f(t);let x=f(m);return((t||"").includes("origin/tags")||(t||"").includes("refs/heads/tags"))&&(x=f(t)),A={[s]:e,[n]:w,[i]:g(r),[o]:x,[a]:_,[l]:y,[c]:v,[u]:b,[h]:E,[d]:S,[p]:T},Object.keys(A).reduce(((e,t)=>A[t]?{...e,[t]:A[t]}:e),{});var A},validateGitRepositoryUrl:function(e){return/(?:git|ssh|https?|git@[-\w.]+):(\/\/)?(.*?)(\/?|#[-\d\w._]+?)$/.test(e)},validateGitCommitSha:function(e){const t=/^[0-9a-f]{40}$/.test(e),r=/^[0-9a-f]{64}$/.test(e);return t||r}}},5593:(e,t,r)=>{"use strict";const s=r(39587),n=r(88378),i=r(75004),o=r(74100),a=r(70780),c=r(79386),u=r(70240),{extractIp:l}=r(79449),{ERROR_MESSAGE:p,ERROR_TYPE:d,ERROR_STACK:h}=r(23636),{createInferredProxySpan:f,finishInferredProxySpan:g}=r(45975),m=a.WEB,_=c.SERVER,y=o.RESOURCE_NAME,b=o.SERVICE_NAME,v=o.SPAN_TYPE,E=o.SPAN_KIND,S=o.ERROR,T=o.HTTP_METHOD,w=o.HTTP_URL,x=o.HTTP_STATUS_CODE,A=o.HTTP_ROUTE,I=o.HTTP_REQUEST_HEADERS,k=o.HTTP_RESPONSE_HEADERS,O=o.HTTP_USERAGENT,R=o.HTTP_CLIENT_IP,C=o.MANUAL_DROP,N=new WeakMap,P=new WeakMap,D={TYPE:m,normalizeConfig(e){const t=function(e){if(Array.isArray(e.headers))try{return e.headers.map((e=>e.split(":"))).map((([e,t])=>[e.toLowerCase(),t]))}catch(e){i.error("Web plugin error getting headers",e)}else e.hasOwnProperty("headers")&&i.error("Expected `headers` to be an array of strings.");return[]}(e),r=function(e){return"function"==typeof e.validateStatus?e.validateStatus:(e.hasOwnProperty("validateStatus")&&i.error("Expected `validateStatus` to be a function."),e=>e<500)}(e),s=function(e){return{request:e.hooks&&e.hooks.request||(()=>{})}}(e),n=u.getFilter(e),o=function(e){return e&&"boolean"==typeof e.middleware?e.middleware:(e&&e.hasOwnProperty("middleware")&&i.error("Expected `middleware` to be a boolean."),!0)}(e),a=function(e){const t=e.queryStringObfuscation;if("boolean"==typeof t)return t;if("string"==typeof t){if(""===t)return!1;if(".*"===t)return!0;try{return new RegExp(t,"gi")}catch(e){i.error("Web plugin error getting qs obfuscator",e)}}return e.hasOwnProperty("queryStringObfuscation")&&i.error("Expected `queryStringObfuscation` to be a regex string or boolean."),!0}(e);return{...e,headers:t,validateStatus:r,hooks:s,filter:n,middleware:o,queryStringObfuscation:a}},setFramework(e,t,r){const s=this.patch(e).span;s&&(s.context()._name=`${t}.request`,s.context()._tags.component=t,D.setConfig(e,r))},setConfig(e,t){const r=N.get(e),s=r.span;r.config=t,t.filter(e.url)||(s.setTag(C,!0),s.context()._trace.isRecording=!1),t.service&&s.setTag(b,t.service),n.sample(s,t.measured,!0)},startSpan(e,t,r,s,n){const i=this.patch(r);let o;return i.span?(i.span.context()._name=n,o=i.span):o=D.startChildSpan(e,n,r),i.tracer=e,i.span=o,i.res=s,this.setConfig(r,t),M(i,this.TYPE),o},wrap(e){const t=N.get(e);t.instrumented||(this.wrapEnd(t),t.instrumented=!0)},instrument(e,t,r,s,n,i){const o=this.startSpan(e,t,r,s,n);return this.wrap(r),i&&e.scope().activate(o,(()=>i(o)))},reactivate:(e,t)=>function(e,t){const r=N.get(e);return r?r.tracer.scope().activate(r.span,t):t()}(e,t),enterRoute(e,t){"string"==typeof t&&N.get(e).paths.push(t)},setRoute(e,t){const r=N.get(e);r&&(r.paths=[t])},exitRoute(e){N.get(e).paths.pop()},wrapMiddleware(e,t,r,s){if(!this.active(e))return s();const i=N.get(e),o=i.tracer,a=this.active(e),c=i.config;if(!1===c.middleware)return this.bindAndWrapMiddlewareErrors(s,e,o,a);const u=o.startSpan(r,{childOf:a});return n.sample(u,c.measured),u.addTags({[y]:t._name||t.name||"<anonymous>"}),i.middleware.push(u),o.scope().activate(u,s)},bindAndWrapMiddlewareErrors(e,t,r,s){try{return r.scope().bind(e,s).apply(this,arguments)}catch(e){throw D.addError(t,e),e}},finish(e,t){if(!this.active(e))return;const r=N.get(e).middleware.pop();r&&(t&&r.addTags({[d]:t.name,[p]:t.message,[h]:t.stack}),r.finish())},beforeEnd(e,t){N.get(e).beforeEnd.push(t)},patch(e){let t=N.get(e);return t||(t=e.stream&&N.get(e.stream),t?(N.set(e,t),t):(t={req:e,span:null,paths:[],middleware:[],beforeEnd:[],config:{}},N.set(e,t),t))},root(e){const t=N.get(e);return t?t.span:null},active(e){const t=N.get(e);return t?0===t.middleware.length?t.span||null:t.middleware.slice(-1)[0]:null},startChildSpan(e,t,r){const s=r.headers,n=N.get(r);let i=e.extract("http_headers",s);if(e._config?.inferredProxyServicesEnabled){const t=f(s,i,e,n);t&&(i=t)}return e.startSpan(t,{childOf:i,links:i?._links})},addStatusError(e,t){const r=N.get(e),{span:s,inferredProxySpan:n,error:i}=r,o=s.context()._tags.error||s.context()._tags[p],a=n?.context(),c=a?._tags.error||a?._tags[p],u=r.config.validateStatus(t);o||u||s.setTag(S,i||!0),!n||c||u||n.setTag(S,i||!0)},addError(e,t){if(t instanceof Error){const r=N.get(e);r&&(r.error=t)}},finishMiddleware(e){if(e.finished)return;let t;for(;t=e.middleware.pop();)t.finish()},finishSpan(e){const{req:t,res:r}=e;e.finished&&!t.stream||(M(e,this.TYPE),function(e){const{req:t,res:r,paths:s,span:n,inferredProxySpan:i}=e;s.length>0&&n.setTag(A,s.join("")),n.addTags({[x]:r.statusCode}),i?.addTags({[x]:r.statusCode}),D.addStatusError(t,r.statusCode)}(e),e.config.hooks.request(e.span,t,r),function(e){const{req:t,span:r}=e,s=r.context()._tags;if(s["resource.name"])return;const n=[t.method,s[A]].filter((e=>e)).join(" ");r.setTag(y,n)}(e),e.span.finish(),e.finished=!0)},finishAll(e){for(const t of e.beforeEnd)t();D.finishMiddleware(e),D.finishSpan(e),g(e)},obfuscateQs(e,t){const{queryStringObfuscation:r}=e;if(!1===r)return t;const s=t.indexOf("?");if(-1===s)return t;const n=t.slice(0,s);if(!0===r)return n;let i=t.slice(s+1);return i=i.replace(r,"<redacted>"),`${n}?${i}`},wrapWriteHead(e){const{req:t,res:r}=e,n=r.writeHead;return function(e,i,o){return o="string"==typeof i?o:i,o=Object.assign(r.getHeaders(),o),"options"===t.method.toLowerCase()&&function(e,t){const r=e.headers.origin,s=t["access-control-allow-origin"];return r&&("*"===s||s===r)}(t,o)&&function(e,t,r){const n=L(r["access-control-allow-headers"]),i=L(e.headers["access-control-request-headers"]),o=["x-datadog-origin","x-datadog-parent-id","x-datadog-sampled","x-datadog-sampling-priority","x-datadog-trace-id","x-datadog-tags"];for(const e of o)~i.indexOf(e)&&n.push(e);n.length>0&&t.setHeader("access-control-allow-headers",s(n).join(","))}(t,r,o),n.apply(this,arguments)}},getContext:e=>N.get(e),wrapRes:(e,t,r,s)=>function(){return D.finishAll(e),s.apply(r,arguments)},wrapEnd(e){const t=e.tracer.scope(),r=e.req,s=e.res,n=s.end;s.writeHead=D.wrapWriteHead(e),P.set(s,this.wrapRes(e,r,s,n)),Object.defineProperty(s,"end",{configurable:!0,get(){return P.get(this)},set(r){P.set(this,t.bind(r,e.span))}})}};function L(e){return"string"==typeof e?e.split(/\s*,\s*/):[]}function M(e,t){const{req:r,span:s,inferredProxySpan:n,config:i}=e,o=function(e){const t=e.headers;if(e.stream)return`${t[":scheme"]}://${t[":authority"]}${t[":path"]}`;{const t=function(e){return e.socket&&e.socket.encrypted||e.connection&&e.connection.encrypted?"https":"http"}(e);return`${t}://${e.headers.host}${e.originalUrl||e.url}`}}(r);if(s.addTags({[w]:D.obfuscateQs(i,o),[T]:r.method,[E]:_,[v]:t,[O]:r.headers["user-agent"]}),i.clientIpEnabled&&!s.context()._tags.hasOwnProperty(R)){const e=l(i,r);e&&(s.setTag(R,e),n?.setTag(R,e))}!function(e){const{req:t,res:r,config:s,span:n,inferredProxySpan:i}=e;s.headers.forEach((([e,s])=>{const o=t.headers[e],a=r.getHeader(e);o&&(n.setTag(s||`${I}.${e}`,o),i?.setTag(s||`${I}.${e}`,o)),a&&(n.setTag(s||`${k}.${e}`,a),i?.setTag(s||`${k}.${e}`,a))}))}(e)}e.exports=D},15134:(e,t,r)=>{"use strict";const s=r(75004),n=r(26748),i=r(99429),{setSamplingRules:o}=r(42471),a=r(57913),{hasOwn:c}=r(89421),{SAMPLING_MECHANISM_DEFAULT:u,SAMPLING_MECHANISM_AGENT:l,SAMPLING_MECHANISM_RULE:p,SAMPLING_MECHANISM_MANUAL:d,SAMPLING_MECHANISM_REMOTE_USER:h,SAMPLING_MECHANISM_REMOTE_DYNAMIC:f,SAMPLING_RULE_DECISION:g,SAMPLING_LIMIT_DECISION:m,SAMPLING_AGENT_DECISION:_,DECISION_MAKER_KEY:y}=r(23636),{tags:{MANUAL_KEEP:b,MANUAL_DROP:v,SAMPLING_PRIORITY:E,SERVICE_NAME:S},priority:{AUTO_REJECT:T,AUTO_KEEP:w,USER_REJECT:x,USER_KEEP:A}}=r(13973),I="service:,env:",k=new i(w);e.exports=class{constructor(e,t){this.configure(e,t),this.update({})}configure(e,t={}){const{sampleRate:r,provenance:i,rateLimit:a=100,rules:c=[]}=t;this._env=e,this._rules=this._normalizeRules(c,r,a,i),this._limiter=new n(a),s.trace(e,t),o(this._rules)}isSampled(e){const t=this._getPriorityFromAuto(e);return s.trace(e),t===A||t===w}sample(e,t=!0){if(!e)return;const r=this._getContext(e),n=r._trace.started[0];if(void 0!==r._sampling.priority)return;if(!n)return;s.trace(e,t);const i=this._getPriorityFromTags(r._tags,r);if(this.validate(i))r._sampling.priority=i,r._sampling.mechanism=d;else{if(!t)return;r._sampling.priority=this._getPriorityFromAuto(n)}this._addDecisionMaker(n)}update(e){const t={};for(const r in e){const s=e[r],n=new i(s);t[r]=n}t[I]=t[I]||k,this._samplers=t,s.trace(e)}validate(e){switch(e){case x:case A:case T:case w:return!0;default:return!1}}setPriority(e,t,r=d){if(!e||!this.validate(t))return;const n=this._getContext(e),i=n._trace.started[0];i?(n._sampling.priority=t,n._sampling.mechanism=r,s.trace(e,t,r),this._addDecisionMaker(i)):s.error("Skipping the setPriority on noop span")}_getContext(e){return"function"==typeof e.context?e.context():e}_getPriorityFromAuto(e){const t=this._getContext(e),r=this._findRule(e);return r?this._getPriorityByRule(t,r):this._getPriorityByAgent(t)}_getPriorityFromTags(e){if(c(e,b)&&!1!==e[b])return A;if(c(e,v)&&!1!==e[v])return x;{const t=parseInt(e[E],10);if(1===t||2===t)return A;if(0===t||-1===t)return x}}_getPriorityByRule(e,t){return e._trace[g]=t.sampleRate,e._sampling.mechanism=p,"customer"===t.provenance&&(e._sampling.mechanism=h),"dynamic"===t.provenance&&(e._sampling.mechanism=f),t.sample()&&this._isSampledByRateLimit(e)?A:x}_isSampledByRateLimit(e){const t=this._limiter.isAllowed();return e._trace[m]=this._limiter.effectiveRate(),t}_getPriorityByAgent(e){const t=`service:${e._tags[S]},env:${this._env}`,r=this._samplers[t]||this._samplers[I];return e._trace[_]=r.rate(),e._sampling.mechanism=r===k?u:l,r.isSampled(e)?w:T}_addDecisionMaker(e){const t=e.context(),r=t._trace,s=t._sampling.priority,n=t._sampling.mechanism;s>=w?r.tags[y]||(r.tags[y]=`-${n}`):delete r.tags[y]}_normalizeRules(e,t,r,s){return(e=[].concat(e||[])).concat({sampleRate:t,maxPerSecond:r,provenance:s}).map((e=>({...e,sampleRate:parseFloat(e.sampleRate)}))).filter((e=>!isNaN(e.sampleRate))).map(a.from)}_findRule(e){for(const t of this._rules)if(t.match(e))return t}static keepTrace(e,t){e?._prioritySampler?.setPriority(e,A,t)}}},18e3:(e,t,r)=>{"use strict";const s=r(75004),{profiler:n}=r(56764);process.once("beforeExit",(()=>{n.stop()})),e.exports={start:e=>{const{service:t,version:r,env:i,url:o,hostname:a,port:c,tags:u,repositoryUrl:l,commitSHA:p,injectionEnabled:d}=e,{enabled:h,sourceMap:f,exporters:g}=e.profiling,m={debug:e=>s.debug(e),info:e=>s.info(e),warn:e=>s.warn(e),error:e=>s.error(e)},_=d.length>0;let y;return"auto"===h?y="auto":"true"===h?y="manual":d.includes("profiler")&&(y="injection"),n.start({service:t,version:r,env:i,logger:m,sourceMap:f,exporters:g,url:o,hostname:a,port:c,tags:u,repositoryUrl:l,commitSHA:p,libraryInjected:_,activation:y})},stop:()=>{n.stop()}}},56160:(e,t,r)=>{"use strict";const s=r(96538),n=r(70857),i=r(16928),{URL:o,format:a,pathToFileURL:c}=r(87016),{AgentExporter:u}=r(37552),{FileExporter:l}=r(12231),{ConsoleLogger:p}=r(17663),d=r(94677),h=r(35379),f=r(92780),{oomExportStrategies:g,snapshotKinds:m}=r(12673),{GIT_REPOSITORY_URL:_,GIT_COMMIT_SHA:y}=r(61154),{tagger:b}=r(860),{isFalse:v,isTrue:E}=r(89421),{getAzureTagsFromMetadata:S,getAzureAppMetadata:T}=r(27756);function w(e,t){const r=Object.values(g).find((t=>t===e));return void 0===r&&t.logger.error(`Unknown oom export strategy "${e}"`),r}function x(e,t){switch(e){case"agent":return new u(t);case"file":return new l(t)}}function A(e,t){switch(e){case"cpu":case"wall":return new d(t);case"space":return new h(t);default:t.logger.error(`Unknown profiler "${e}"`)}}e.exports={Config:class{constructor(e={}){const{DD_AGENT_HOST:t,DD_ENV:r,DD_INTERNAL_PROFILING_TIMELINE_SAMPLING_ENABLED:h,DD_PROFILING_CODEHOTSPOTS_ENABLED:I,DD_PROFILING_CPU_ENABLED:k,DD_PROFILING_DEBUG_SOURCE_MAPS:O,DD_PROFILING_ENDPOINT_COLLECTION_ENABLED:R,DD_PROFILING_EXPERIMENTAL_CODEHOTSPOTS_ENABLED:C,DD_PROFILING_EXPERIMENTAL_CPU_ENABLED:N,DD_PROFILING_EXPERIMENTAL_ENDPOINT_COLLECTION_ENABLED:P,DD_PROFILING_EXPERIMENTAL_OOM_EXPORT_STRATEGIES:D,DD_PROFILING_EXPERIMENTAL_OOM_HEAP_LIMIT_EXTENSION_SIZE:L,DD_PROFILING_EXPERIMENTAL_OOM_MAX_HEAP_EXTENSION_COUNT:M,DD_PROFILING_EXPERIMENTAL_OOM_MONITORING_ENABLED:q,DD_PROFILING_EXPERIMENTAL_TIMELINE_ENABLED:j,DD_PROFILING_HEAP_ENABLED:U,DD_PROFILING_PPROF_PREFIX:F,DD_PROFILING_PROFILERS:B,DD_PROFILING_SOURCE_MAP:$,DD_PROFILING_TIMELINE_ENABLED:G,DD_PROFILING_UPLOAD_PERIOD:V,DD_PROFILING_UPLOAD_TIMEOUT:z,DD_PROFILING_V8_PROFILER_BUG_WORKAROUND:H,DD_PROFILING_WALLTIME_ENABLED:K,DD_SERVICE:Y,DD_TAGS:Q,DD_TRACE_AGENT_PORT:W,DD_TRACE_AGENT_URL:Z,DD_VERSION:J}=process.env,X=s(e.env,r),ee=e.service||Y||"node",te=n.hostname(),re=s(e.version,J),se=process.env.AWS_LAMBDA_FUNCTION_NAME,ne=s(e.interval,1e3*Number(V),65e3),ie=s(e.uploadTimeout,Number(z),6e4),oe=s(e.sourceMap,$,!0),ae=s(e.pprofPrefix,F,"");this.service=ee,this.env=X,this.host=te,this.functionname=se,this.version=re,this.tags=Object.assign(b.parse(Q),b.parse(e.tags),b.parse({env:X,host:te,service:ee,version:re,functionname:se}),S(T())),e.repositoryUrl&&e.commitSHA&&(this.tags[_]=e.repositoryUrl,this.tags[y]=e.commitSHA),this.logger=function(e){return"object"!=typeof e||"function"!=typeof e.debug||"function"!=typeof e.info||"function"!=typeof e.warn||"function"!=typeof e.error?new p:e}(e.logger);const ce=this.logger;function ue(e){const t=`DD_PROFILING_EXPERIMENTAL_${e}`,r=process.env[t];null!=r&&r==r&&ce.warn(`${t} is deprecated. Use DD_PROFILING_${e} instead.`)}const le="win32"!==process.platform;function pe(e,t,r){if(e&&!r)throw new Error(`${t} not supported on ${process.platform}.`)}function de(e,t){pe(e,t,le)}this.flushInterval=ne,this.uploadTimeout=ie,this.sourceMap=oe,this.debugSourceMaps=E(s(e.debugSourceMaps,O,!1)),this.endpointCollectionEnabled=E(s(e.endpointCollection,R,P,le)),ue("ENDPOINT_COLLECTION_ENABLED"),de(this.endpointCollectionEnabled,"Endpoint collection"),this.pprofPrefix=ae,this.v8ProfilerBugWorkaroundEnabled=E(s(e.v8ProfilerBugWorkaround,H,!0));const he=s(e.hostname,t)||"localhost",fe=s(e.port,W)||8126;this.url=new o(s(e.url,Z,a({protocol:"http:",hostname:he,port:fe}))),this.libraryInjected=e.libraryInjected,this.activation=e.activation,this.exporters=function(e,t){"string"==typeof e&&(e=e.split(","));for(let r=0;r<e.length;r++){const s=e[r];"string"==typeof s&&(e[r]=x(s,t))}return e}(e.exporters||[new u(this)],this);const ge="win32"!==process.platform,me=E(s(e.oomMonitoring,q,ge));pe(me,"OOM monitoring",ge);const _e=s(e.oomHeapLimitExtensionSize,Number(L),0),ye=s(e.oomMaxHeapExtensionCount,Number(M),0),be=me?function(e,t){if(!e)return[];"string"==typeof e&&(e=e.split(","));for(let r=0;r<e.length;r++){const s=e[r];"string"==typeof s&&(e[r]=w(s,t))}return[...new Set(e)]}(s(e.oomExportStrategies,D,[g.PROCESS]),this):[],ve=me?function(e){const t=[...Object.entries(e.tags),["snapshot",m.ON_OUT_OF_MEMORY]].map((([e,t])=>`${e}:${t}`)).join(","),r=[];for(const t of e.exporters)t instanceof u?r.push(e.url.toString()):t instanceof l&&r.push(c(e.pprofPrefix).toString());return[process.execPath,i.join(__dirname,"exporter_cli.js"),r.join(","),t,"space"]}(this):void 0;this.oomMonitoring={enabled:me,heapLimitExtensionSize:_e,maxHeapExtensionCount:ye,exportStrategies:be,exportCommand:ve};const Ee=e.profilers?e.profilers:function({DD_PROFILING_HEAP_ENABLED:e,DD_PROFILING_WALLTIME_ENABLED:t,DD_PROFILING_PROFILERS:r}){const n=new Set(s(r,"wall,space").split(","));return null!=t&&(E(t)?n.add("wall"):v(t)&&n.delete("wall")),null!=e&&(E(e)?n.add("space"):v(e)&&n.delete("space")),[...n]}({DD_PROFILING_HEAP_ENABLED:U,DD_PROFILING_WALLTIME_ENABLED:K,DD_PROFILING_PROFILERS:B});this.timelineEnabled=E(s(e.timelineEnabled,G,j,le)),ue("TIMELINE_ENABLED"),de(this.timelineEnabled,"Timeline view"),this.timelineSamplingEnabled=E(s(e.timelineSamplingEnabled,h,!0)),this.codeHotspotsEnabled=E(s(e.codeHotspotsEnabled,I,C,le)),ue("CODEHOTSPOTS_ENABLED"),de(this.codeHotspotsEnabled,"Code hotspots"),this.cpuProfilingEnabled=E(s(e.cpuProfilingEnabled,k,N,le)),ue("CPU_ENABLED"),de(this.cpuProfilingEnabled,"CPU profiling"),this.profilers=function(e,t){"string"==typeof e&&(e=e.split(","));for(let r=0;r<e.length;r++){const s=e[r];"string"==typeof s&&(e[r]=A(s,t))}return t.timelineEnabled&&e.some((e=>e instanceof d))&&e.push(new f(t)),e.filter((e=>e))}(Ee,this)}}}},12673:e=>{"use strict";const t=Object.freeze({PERIODIC:"periodic",ON_SHUTDOWN:"on_shutdown",ON_OUT_OF_MEMORY:"on_oom"}),r=Object.freeze({PROCESS:"process",ASYNC_CALLBACK:"async",LOGS:"logs"});e.exports={snapshotKinds:t,oomExportStrategies:r}},37552:(e,t,r)=>{"use strict";const s=r(75617),{request:n}=r(58611),{request:i}=r(65692),{EventSerializer:o}=r(61968),a=r(69698),c=r(43357),{storage:u}=r(96882),l=r(8330).version,{urlToHttpOptions:p}=r(87016),d=r(82987).performance,h=r(95608).manager.namespace("profilers"),f=a.id(),g=[],m=h.count("profile_api.requests",[]),_=h.distribution("profile_api.bytes",[]),y=h.distribution("profile_api.ms",[]),b=h.count("profile_api.errors",["type:status_code"]),v=h.count("profile_api.errors",["type:network"]);function E(e){let t=0;for(;t<2||e>1e3;)t++,e/=2;return[t,Math.floor(e)]}e.exports={AgentExporter:class extends o{constructor(e={}){super(e);const{url:t,logger:r,uploadTimeout:s}=e;this._url=t,this._logger=r;const[n,i]=E(s);this._backoffTime=i,this._backoffTries=n}export(e){const{profiles:t}=e,r=[],o=this.getEventJSON(e);r.push(["event",o,{filename:"event.json",contentType:"application/json"}]),this._logger.debug((()=>`Building agent export report:\n${o}`));for(const[e,s]of Object.entries(t)){this._logger.debug((()=>{const t=s.toString("hex").match(/../g).join(" ");return`Adding ${e} profile to agent export: `+t}));const t=this.typeToFile(e);r.push([t,s,{filename:t,contentType:"application/octet-stream"}])}return new Promise(((e,t)=>{const o=s.operation({randomize:!0,minTimeout:this._backoffTime,retries:this._backoffTries,unref:!0});o.attempt((s=>{const a=new c;for(const[e,t,s]of r)a.append(e,t,s);const E={method:"POST",path:"/profiling/v1/input",headers:{"DD-EVP-ORIGIN":"dd-trace-js","DD-EVP-ORIGIN-VERSION":l,...a.getHeaders()},timeout:this._backoffTime*Math.pow(2,s)};if(f&&(E.headers["Datadog-Container-ID"]=f),"unix:"===this._url.protocol)E.socketPath=this._url.pathname;else{const e=p(this._url);E.protocol=e.protocol,E.hostname=e.hostname,E.port=e.port}this._logger.debug((()=>`Submitting profiler agent report attempt #${s} to: ${JSON.stringify(E)}`)),function(e,t,r){const s="https:"===e.protocol?i:n,o=u.getStore();u.enterWith({noop:!0}),m.inc();const a=d.now(),c=s(e,(e=>{if(y.track(d.now()-a),function(e){let t=g[e];void 0===t&&(t=g[e]=h.count("profile_api.responses",[`status_code:${e}`])),t.inc()}(e.statusCode),e.statusCode>=400){b.inc();const t=new Error(`HTTP Error ${e.statusCode}`);t.status=e.statusCode,r(t)}else r(null,e)}));c.on("error",(e=>{v.inc(),r(e)})),t&&(_.track(t.size()),t.pipe(c)),u.enterWith(o)}(E,a,((r,s)=>{if(r){const{status:e}=r;("number"!=typeof e||e>=500||429===e)&&o.retry(r)?this._logger.warn(`Error from the agent: ${r.message}`):t(r)}else!function(e,t){const r=[];e.on("error",(e=>{v.inc(),t(e)})),e.on("data",(e=>r.push(e))),e.on("end",(()=>{t(null,Buffer.concat(r))}))}(s,((e,t)=>{e?this._logger.warn(`Error reading agent response: ${e.message}`):this._logger.debug((()=>`Agent export response: ${(t.toString("hex").match(/../g)||[]).join(" ")}`))})),e()}))}))}))}},computeRetries:E}},61968:(e,t,r)=>{const s=r(70857),n=r(82987).performance,i=r(8330).version,o=(()=>{const e=process.env.UV_THREADPOOL_SIZE;if(void 0===e)return;const t=parseInt(e);return isNaN(t)?0:t})();e.exports={EventSerializer:class{constructor({env:e,host:t,service:r,version:s,libraryInjected:n,activation:i}={}){this._env=e,this._host=t,this._service=r,this._appVersion=s,this._libraryInjected=!!n,this._activation=i||"unknown"}typeToFile(e){return`${e}.pprof`}getEventJSON({profiles:e,start:t,end:r,tags:a={},endpointCounts:c}){return JSON.stringify({attachments:Object.keys(e).map((e=>this.typeToFile(e))),start:t.toISOString(),end:r.toISOString(),family:"node",version:"4",tags_profiler:["language:javascript","runtime:nodejs",`runtime_arch:${process.arch}`,`runtime_os:${process.platform}`,`runtime_version:${process.version}`,`process_id:${process.pid}`,`profiler_version:${i}`,"format:pprof",...Object.entries(a).map((([e,t])=>`${e}:${t}`))].join(","),endpoint_counts:c,info:{application:{env:this._env,service:this._service,start_time:new Date(n.nodeTiming.nodeStart+n.timeOrigin).toISOString(),version:this._appVersion},platform:{hostname:this._host,kernel_name:s.type(),kernel_release:s.release(),kernel_version:s.version()},profiler:{activation:this._activation,ssi:{mechanism:this._libraryInjected?"injected_agent":"none"},version:i},runtime:{available_processors:"function"==typeof s.availableParallelism?s.availableParallelism():s.cpus().length,engine:"nodejs",libuv_threadpool_size:o,version:process.version.substring(1)}}})}}}},12231:(e,t,r)=>{"use strict";const s=r(79896),{promisify:n}=r(39023),{threadId:i}=r(28167),o=n(s.writeFile),{EventSerializer:a}=r(61968);e.exports={FileExporter:class extends a{constructor(e={}){super(e);const{pprofPrefix:t}=e;this._pprofPrefix=t||""}export(e){const{profiles:t,end:r}=e,s=Object.keys(t),n=function(e){const t=e=>String(e).padStart(2,"0");return`${e.getUTCFullYear()}${t(e.getUTCMonth()+1)}${t(e.getUTCDate())}T${t(e.getUTCHours())}${t(e.getUTCMinutes())}${t(e.getUTCSeconds())}Z`}(r),a=s.map((e=>o(`${this._pprofPrefix}${e}_worker_${i}_${n}.pprof`,t[e])));return a.push(o(`event_worker_${i}_${n}.json`,this.getEventJSON(e))),Promise.all(a)}}}},56764:(e,t,r)=>{"use strict";const{Profiler:s,ServerlessProfiler:n}=r(67479),i=r(94677),o=r(35379),{AgentExporter:a}=r(37552),{FileExporter:c}=r(12231),{ConsoleLogger:u}=r(17663),l=process.env.AWS_LAMBDA_FUNCTION_NAME?new n:new s;e.exports={profiler:l,AgentExporter:a,FileExporter:c,WallProfiler:i,SpaceProfiler:o,ConsoleLogger:u}},17663:e=>{"use strict";const t={error:3,warn:4,info:6,debug:7};e.exports={ConsoleLogger:class{constructor(e={}){this._level=t[e.level]||t.error}debug(e){this._log("debug",e)}info(e){this._log("info",e)}warn(e){this._log("warn",e)}error(e){this._log("error",e)}_log(e,r){t[e]>this._level||console[e](r)}}}},67479:(e,t,r)=>{"use strict";const{EventEmitter:s}=r(24434),{Config:n}=r(56160),{snapshotKinds:i}=r(12673),{threadNamePrefix:o}=r(91364),{isWebServerSpan:a,endpointNameFromTags:c,getStartedSpans:u}=r(87890),l=r(1247),p=r(53928),d=l.channel("datadog:profiling:profile-submitted"),h=l.channel("dd-trace:span:finish");function f(e,t){e&&e.error(t)}class g extends s{constructor(){super(),this._enabled=!1,this._logger=void 0,this._config=void 0,this._timer=void 0,this._lastStart=void 0,this._timeoutInterval=void 0,this.endpointCounts=new Map}start(e){return this._start(e).catch((t=>(f(e.logger,t),!1)))}_logError(e){f(this._logger,e)}async _start(e){if(this._enabled)return!0;const t=this._config=new n(e);let s;this._logger=t.logger,this._enabled=!0,this._setInterval();try{const{setLogger:e,SourceMapper:n}=r(50581);e(t.logger),s=await function(e,t,r){if(e)return t.create([process.cwd()],r)}(t.sourceMap,n,t.debugSourceMaps),t.sourceMap&&t.debugSourceMaps&&this._logger.debug((()=>0===s.infoMap.size?"Found no source maps":`Found source maps for following files: [${Array.from(s.infoMap.keys()).join(", ")}]`))}catch(e){this._logError(e)}try{const e=new Date;for(const e of t.profilers)e.start({mapper:s,nearOOMCallback:this._nearOOMExport.bind(this)}),this._logger.debug(`Started ${e.type} profiler in ${o} thread`);return t.endpointCollectionEnabled&&(this._spanFinishListener=this._onSpanFinish.bind(this),h.subscribe(this._spanFinishListener)),this._capture(this._timeoutInterval,e),!0}catch(e){return this._logError(e),this._stop(),!1}}_nearOOMExport(e,t){const r=this._lastStart,s=new Date;this._submit({[e]:t},r,s,i.ON_OUT_OF_MEMORY)}_setInterval(){this._timeoutInterval=this._config.flushInterval}async stop(){this._enabled&&(this._collect(i.ON_SHUTDOWN,!1),this._stop())}_stop(){if(this._enabled){this._enabled=!1,void 0!==this._spanFinishListener&&(h.unsubscribe(this._spanFinishListener),this._spanFinishListener=void 0);for(const e of this._config.profilers)e.stop(),this._logger.debug(`Stopped ${e.type} profiler in ${o} thread`);clearTimeout(this._timer),this._timer=void 0}}_capture(e,t){this._enabled&&(this._lastStart=t,this._timer&&e===this._timeoutInterval?this._timer.refresh():(this._timer=setTimeout((()=>this._collect(i.PERIODIC)),e),this._timer.unref()))}_onSpanFinish(e){const t=e.context(),r=t._tags;if(!a(r))return;const s=c(r);if(!s)return;if(function(e,t){for(let r=e.length;--r>=0;){const s=e[r].context();if(s._spanId===t){if(a(s._tags))return!0;t=s._parentId}}return!1}(u(t),t._parentId))return;let n=this.endpointCounts.get(s);void 0===n?(n={count:1},this.endpointCounts.set(s,n)):n.count++}async _collect(e,t=!0){if(!this._enabled)return;const r=this._lastStart,s=new Date,n=[],i={};try{if(0===Object.keys(this._config.profilers).length)throw new Error("No profile types configured.");p.withProfilerSerializing((()=>{for(const e of this._config.profilers){const i=e.profile(t,r,s);t||this._logger.debug(`Stopped ${e.type} profiler in ${o} thread`),i&&n.push({profiler:e,profile:i})}})),t&&this._capture(this._timeoutInterval,s);for(const{profiler:e,profile:t}of n)try{i[e.type]=await e.encode(t),this._logger.debug((()=>{const r=JSON.stringify(t,((e,t)=>"bigint"==typeof t?t.toString():t));return`Collected ${e.type} profile: `+r}))}catch(e){this._logError(e)}Object.keys(i).length>0&&(await this._submit(i,r,s,e),d.publish(),this._logger.debug("Submitted profiles"))}catch(e){this._logError(e),this._stop()}}_submit(e,t,r,s){const{tags:n}=this._config,i={};for(const[e,{count:t}]of this.endpointCounts)i[e]=t;this.endpointCounts.clear(),n.snapshot=s;const o={profiles:e,start:t,end:r,tags:n,endpointCounts:i},a=this._config.exporters.map((e=>e.export(o).catch((e=>{this._logger&&this._logger.warn(e)}))));return Promise.all(a)}}e.exports={Profiler:g,ServerlessProfiler:class extends g{constructor(){super(),this._profiledIntervals=0,this._interval=1,this._flushAfterIntervals=void 0}_setInterval(){this._timeoutInterval=1e3*this._interval,this._flushAfterIntervals=this._config.flushInterval/1e3}async _collect(e,t=!0){this._profiledIntervals>=this._flushAfterIntervals||!t?(this._profiledIntervals=0,await super._collect(e,t)):(this._profiledIntervals+=1,this._capture(this._timeoutInterval,new Date))}}}},31006:(e,t,r)=>{const s=r(97609);e.exports=class extends s{static get id(){return"dns"}static get entryType(){return"dns"}}},22823:(e,t,r)=>{const s=r(31006);e.exports=class extends s{static get operation(){return"lookup"}extendEvent(e,t){return e.name="lookup",e.detail={hostname:t[0]},e}}},45616:(e,t,r)=>{const s=r(31006);e.exports=class extends s{static get operation(){return"lookup_service"}extendEvent(e,t){return e.name="lookupService",e.detail={host:t[0],port:t[1]},e}}},31905:(e,t,r)=>{const s=r(31006),n=new Map;e.exports=class extends s{static get operation(){return"resolve"}extendEvent(e,t){const r=t[1];let s=n.get(r);return s||(s=`query${r}`,n.set(r,s)),e.name=s,e.detail={host:t[0]},e}}},13311:(e,t,r)=>{const s=r(31006);e.exports=class extends s{static get operation(){return"reverse"}extendEvent(e,t){return e.name="getHostByAddr",e.detail={host:t[0]},e}}},97609:(e,t,r)=>{const{storage:s}=r(96882),n=r(5288),{performance:i}=r(82987);e.exports=class extends n{constructor(e,t){super(),this.eventHandler=e,this.eventFilter=t,this.store=s("profiling"),this.entryType=this.constructor.entryType}start(e){this.store.enterWith({startEvent:e,startTime:i.now()})}error(){const e=this.store.getStore();e&&(e.error=!0)}finish(){const e=this.store.getStore();if(!e)return;const{startEvent:t,startTime:r,error:s}=e;if(s||this.ignoreEvent(t))return;const n=i.now()-r,o={entryType:this.entryType,startTime:r,duration:n};if(!this.eventFilter(o))return;const a=this.activeSpan?.context();o._ddSpanId=a?.toSpanId(),o._ddRootSpanId=a?._trace.started[0]?.context().toSpanId()||o._ddSpanId,this.eventHandler(this.extendEvent(o,t))}ignoreEvent(){return!1}}},97462:(e,t,r)=>{const s=r(97609),n=new Set(["atime","dest","existingPath","fd","file","flag","gid","len","length","mode","mtime","newPath","offset","oldPath","operation","options","path","position","prefix","src","target","type","uid"]);e.exports=class extends s{static get id(){return"fs"}static get operation(){return"operation"}static get entryType(){return"fs"}ignoreEvent(e){return e.operation?.endsWith("Sync")}extendEvent(e,t){const r={...t};return Object.entries(r).forEach((([e,t])=>{(!n.has(e)||"string"!=typeof t&&"number"!=typeof t)&&delete r[e]})),e.detail=r,e}}},40118:(e,t,r)=>{const s=r(97609);e.exports=class extends s{static get id(){return"net"}static get operation(){return"tcp"}static get entryType(){return"net"}extendEvent(e,{options:t}){return e.name="connect",e.detail=t,e}}},67889:(e,t,r)=>{var s={"./dns":31006,"./dns.js":31006,"./dns_lookup":22823,"./dns_lookup.js":22823,"./dns_lookupservice":45616,"./dns_lookupservice.js":45616,"./dns_resolve":31905,"./dns_resolve.js":31905,"./dns_reverse":13311,"./dns_reverse.js":13311,"./event":97609,"./event.js":97609,"./fs":97462,"./fs.js":97462,"./net":40118,"./net.js":40118};function n(e){var t=i(e);return r(t)}function i(e){if(!r.o(s,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return s[e]}n.keys=function(){return Object.keys(s)},n.resolve=i,e.exports=n,n.id=67889},92780:(e,t,r)=>{const{performance:s,constants:n,PerformanceObserver:i}=r(82987),{END_TIMESTAMP_LABEL:o,SPAN_ID_LABEL:a,LOCAL_ROOT_SPAN_ID_LABEL:c}=r(91364),{Function:u,Label:l,Line:p,Location:d,Profile:h,Sample:f,StringTable:g,ValueType:m}=r(54028),_=r(50581),y=1e6,b=BigInt(Math.round(s.timeOrigin*y));function v(e,t,r){return new l({key:t,str:e.dedup(E(r))})}function E(e){switch(typeof e){case"string":return e;case"object":return"[object]";case"function":return"[function]";default:return String(e)}}function S(e,t,r){return v(e,e.dedup(t),r)}const T={fs:class{constructor(e){this.stringTable=e}decorateSample(e,t){const r=e.label,s=this.stringTable;Object.entries(t.detail).forEach((([e,t])=>{switch(typeof t){case"string":r.push(S(s,e,t));break;case"number":r.push(new l({key:s.dedup(e),num:t}))}}))}},dns:class{constructor(e){this.stringTable=e,this.operationNameLabelKey=e.dedup("operation"),this.hostLabelKey=e.dedup("host"),this.addressLabelKey=e.dedup("address"),this.portLabelKey=e.dedup("port")}decorateSample(e,t){const r=e.label,s=this.stringTable;function n(e,t){r.push(v(s,e,t))}const i=t.name;n(this.operationNameLabelKey,t.name);const o=t.detail;switch(i){case"lookup":n(this.hostLabelKey,o.hostname);break;case"lookupService":n(this.addressLabelKey,o.host),r.push(new l({key:this.portLabelKey,num:o.port}));break;case"getHostByAddr":n(this.addressLabelKey,o.host);break;default:i.startsWith("query")&&n(this.hostLabelKey,o.host)}}},gc:class{constructor(e){this.stringTable=e,this.reasonLabelKey=e.dedup("gc reason"),this.kindLabels=[],this.reasonLabels=[],this.flagObj={};const t=e.dedup("gc type");for(const[r,s]of Object.entries(n))if(r.startsWith("NODE_PERFORMANCE_GC_FLAGS_"))this.flagObj[r.substring(26).toLowerCase()]=s;else if(r.startsWith("NODE_PERFORMANCE_GC_")){const n=r.substring(20).toLowerCase();this.kindLabels[s]=v(e,t,n)}}decorateSample(e,t){const{kind:r,flags:s}=t.detail;e.label.push(this.kindLabels[r]);const n=this.getReasonLabel(s);n&&e.label.push(n)}getReasonLabel(e){if(0===e)return null;let t=this.reasonLabels[e];if(!t){const r=[];for(const[t,s]of Object.entries(this.flagObj))s&e&&r.push(t);const s=r.join(",");t=v(this.stringTable,this.reasonLabelKey,s),this.reasonLabels[e]=t}return t}},net:class{constructor(e){this.stringTable=e,this.operationNameLabelKey=e.dedup("operation"),this.hostLabelKey=e.dedup("host"),this.portLabelKey=e.dedup("port")}decorateSample(e,t){const r=e.label,s=this.stringTable;function n(e,t){r.push(v(s,e,t))}const i=t.name;if(n(this.operationNameLabelKey,i),"connect"===i){const e=t.detail;n(this.hostLabelKey,e.host),r.push(new l({key:this.portLabelKey,num:e.port}))}}}};class w{constructor(){this.stringTable=new g,this.samples=[],this.locations=[],this.functions=[],this.decorators={};const e=new u({id:this.functions.length+1,name:this.stringTable.dedup("")});this.functions.push(e);const t=new p({functionId:e.id}),r=new d({id:this.locations.length+1,line:[t]});this.locations.push(r),this.locationId=[r.id],this.timestampLabelKey=this.stringTable.dedup(o),this.spanIdKey=this.stringTable.dedup(a),this.rootSpanIdKey=this.stringTable.dedup(c)}addEvent(e){const{entryType:t,startTime:r,duration:s,_ddSpanId:n,_ddRootSpanId:i}=e;let o=this.decorators[t];if(!o){const e=T[t];if(!e)return;o=new e(this.stringTable),o.eventTypeLabel=S(this.stringTable,"event",t),this.decorators[t]=o}const a=r+s,c=[o.eventTypeLabel,new l({key:this.timestampLabelKey,num:b+BigInt(Math.round(a*y))})];n&&c.push(v(this.stringTable,this.spanIdKey,n)),i&&c.push(v(this.stringTable,this.rootSpanIdKey,i));const u={value:[Math.round(s*y)],locationId:this.locationId,label:c};o.decorateSample(u,e),this.samples.push(new f(u))}createProfile(e,t){const r=new m({type:this.stringTable.dedup("timeline"),unit:this.stringTable.dedup("nanoseconds")});return new h({sampleType:[r],timeNanos:t.getTime()*y,periodType:r,period:1,durationNanos:(t.getTime()-e.getTime())*y,sample:this.samples,location:this.locations,function:this.functions,stringTable:this.stringTable})}}class x{constructor(e,t){this.eventHandler=e,this.observer=void 0,this.entryTypes=t||Object.keys(T)}start(){this.observer||(this.observer=new i(function(e){for(const t of e.getEntries())this.eventHandler(t)}.bind(this)),this.observer.observe({entryTypes:this.entryTypes}))}stop(){this.observer&&(this.observer.disconnect(),this.observer=void 0)}}class A{constructor(e,t){this.plugins=["dns_lookup","dns_lookupservice","dns_resolve","dns_reverse","fs","net"].map((s=>new(r(67889)(`./${s}`))(e,t))),this.started=!1}start(){this.started||(this.plugins.forEach((e=>e.configure({enabled:!0}))),this.started=!0)}stop(){this.started&&(this.plugins.forEach((e=>e.configure({enabled:!1}))),this.started=!1)}}class I{constructor(e){this.sources=e}start(){this.sources.forEach((e=>e.start()))}stop(){this.sources.forEach((e=>e.stop()))}}e.exports=class{constructor(e={}){this.type="events",this.eventSerializer=new w;const t=e=>this.eventSerializer.addEvent(e),r=e.timelineSamplingEnabled?function(e){let t=s.now(),r=0;return n(),e=>{const s=e.startTime+e.duration;for(;s>=t;)n();return e.startTime<r};function n(){r=t,t-=Math.log(1-Math.random())*e}}((e.samplingInterval??1e6/99)/1e3):e=>!0,n=e=>{r(e)&&t(e)};e.codeHotspotsEnabled?this.eventSource=new I([new A(t,r),new x(n,["gc"])]):this.eventSource=new x(n)}start(){this.eventSource.start()}stop(){this.eventSource.stop()}profile(e,t,r){e||this.stop();const s=this.eventSerializer;return this.eventSerializer=new w,()=>s.createProfile(t,r)}encode(e){return _.encode(e())}}},91364:(e,t,r)=>{"use strict";const{isMainThread:s,threadId:n}=r(28167),i="thread name",o="os thread id",a="thread id",c=s?"Main":`Worker #${n}`,u=`${c} Event Loop`;e.exports={END_TIMESTAMP_LABEL:"end_timestamp_ns",THREAD_NAME_LABEL:i,THREAD_ID_LABEL:a,OS_THREAD_ID_LABEL:o,SPAN_ID_LABEL:"span id",LOCAL_ROOT_SPAN_ID_LABEL:"local root span id",threadNamePrefix:c,eventLoopThreadName:u,getNonJSThreadsLabels:function(){return{[i]:"Non-JS threads",[a]:"NA",[o]:"NA"}},getThreadLabels:function(){let e;return()=>(e||(e=function(){const e=r(50581).getNativeThreadId();return{[i]:u,[a]:`${n}`,[o]:`${e}`}}()),e)}()}},35379:(e,t,r)=>{"use strict";const{oomExportStrategies:s}=r(12673),{getThreadLabels:n}=r(91364);e.exports=class{constructor(e={}){this.type="space",this._samplingInterval=e.samplingInterval||524288,this._stackDepth=e.stackDepth||64,this._pprof=void 0,this._oomMonitoring=e.oomMonitoring||{},this._started=!1}start({mapper:e,nearOOMCallback:t}={}){if(!this._started){if(this._mapper=e,this._pprof=r(50581),this._pprof.heap.start(this._samplingInterval,this._stackDepth),this._oomMonitoring.enabled){const e=this._oomMonitoring.exportStrategies;this._pprof.heap.monitorOutOfMemory(this._oomMonitoring.heapLimitExtensionSize,this._oomMonitoring.maxHeapExtensionCount,e.includes(s.LOGS),e.includes(s.PROCESS)?this._oomMonitoring.exportCommand:[],(e=>t(this.type,this._pprof.encodeSync(e))),function(e,t){return e.includes(s.ASYNC_CALLBACK)?t.Async:0}(e,this._pprof.heap.CallbackMode))}this._started=!0}}profile(e){const t=this._pprof.heap.profile(void 0,this._mapper,n);return e||this.stop(),t}encode(e){return this._pprof.encode(e)}stop(){this._started&&(this._pprof.heap.stop(),this._started=!1)}isStarted(){return this._started}}},94677:(e,t,r)=>{"use strict";const{storage:s}=r(96882),n=r(1247),i=r(40091),o=r(95608),{END_TIMESTAMP_LABEL:a,SPAN_ID_LABEL:c,LOCAL_ROOT_SPAN_ID_LABEL:u,getNonJSThreadsLabels:l,getThreadLabels:p}=r(91364),{isWebServerSpan:d,endpointNameFromTags:h,getStartedSpans:f}=r(87890),g=n.channel("dd-trace:storage:before"),m=n.channel("dd-trace:storage:enter"),_=n.channel("dd-trace:span:finish"),y=o.manager.namespace("profilers"),b=Symbol("NativeWallProfiler.ProfilingContext");let v,E=!1;e.exports=class{constructor(e={}){this.type="wall",this._samplingIntervalMicros=e.samplingInterval||1e6/99,this._flushIntervalMillis=e.flushInterval||6e4,this._codeHotspotsEnabled=!!e.codeHotspotsEnabled,this._endpointCollectionEnabled=!!e.endpointCollectionEnabled,this._timelineEnabled=!!e.timelineEnabled,this._cpuProfilingEnabled=!!e.cpuProfilingEnabled,this._captureSpanData=this._codeHotspotsEnabled||this._endpointCollectionEnabled,this._withContexts=this._captureSpanData||this._timelineEnabled||this._cpuProfilingEnabled,this._v8ProfilerBugWorkaroundEnabled=!!e.v8ProfilerBugWorkaroundEnabled,this._mapper=void 0,this._pprof=void 0,this._withContexts&&this._captureSpanData&&(this._enter=this._enter.bind(this),this._spanFinished=this._spanFinished.bind(this)),this._generateLabels=this._generateLabels.bind(this),this._logger=e.logger,this._started=!1}codeHotspotsEnabled(){return this._codeHotspotsEnabled}endpointCollectionEnabled(){return this._endpointCollectionEnabled}start({mapper:e}={}){this._started||(function(){if(E)return;const{AsyncLocalStorage:e,createHook:t}=r(90290),s=r(81444);t({before:()=>g.publish()}).enable();let n=!1;s.wrap(e.prototype,"enterWith",(function(e){return function(...t){const r=e.apply(this,t);return n||m.publish(),r}})),s.wrap(e.prototype,"run",(function(e){return function(t,r,...i){const o=s.wrapFunction(r,(e=>function(...t){n=!1,m.publish();const r=e.apply(this,t);return n=!0,r}));n=!0;const a=e.call(this,t,o,...i);return m.publish(),n=!1,a}})),E=!0}(),this._mapper=e,this._pprof=r(50581),v=this._pprof.time.constants.kSampleCount,process._startProfilerIdleNotifier||(process._startProfilerIdleNotifier=()=>{}),process._stopProfilerIdleNotifier||(process._stopProfilerIdleNotifier=()=>{}),this._pprof.time.start({intervalMicros:this._samplingIntervalMicros,durationMillis:this._flushIntervalMillis,sourceMapper:this._mapper,withContexts:this._withContexts,lineNumbers:!1,workaroundV8Bug:this._v8ProfilerBugWorkaroundEnabled,collectCpuTime:this._cpuProfilingEnabled}),this._withContexts&&(this._setNewContext(),this._captureSpanData&&(this._profilerState=this._pprof.time.getState(),this._lastSampleCount=0,g.subscribe(this._enter),m.subscribe(this._enter),_.subscribe(this._spanFinished))),this._started=!0)}_enter(){if(!this._started)return;const e=this._profilerState[v];if(e!==this._lastSampleCount){this._lastSampleCount=e;const t=this._currentContext.ref;this._setNewContext(),this._updateContext(t)}const t=function(){const e=s.getStore();return e&&e.span}();this._currentContext.ref=t?this._getProfilingContext(t):{}}_getProfilingContext(e){let t=e[b];if(void 0===t){const r=e.context(),s=f(r);let n,i,o;if(this._codeHotspotsEnabled&&(n=r._spanId,i=s.length?s[0].context()._spanId:r._spanId),this._endpointCollectionEnabled){const e=r._tags;if(d(e))o=e;else{const e=r._parentId;for(let t=s.length;--t>=0;){const r=s[t];if(r.context()._spanId===e){o=this._getProfilingContext(r).webTags;break}}}}t={spanId:n,rootSpanId:i,webTags:o},e[b]=t}return t}_setNewContext(){this._pprof.time.setContext(this._currentContext={ref:{}})}_updateContext(e){"object"==typeof e.spanId&&(e.spanId=e.spanId.toString(10)),"object"==typeof e.rootSpanId&&(e.rootSpanId=e.rootSpanId.toString(10)),void 0!==e.webTags&&void 0===e.endpoint&&(e.endpoint=h(e.webTags))}_spanFinished(e){void 0!==e[b]&&(e[b]=void 0)}_reportV8bug(e){const t=`v8_profiler_bug_workaround_enabled:${this._v8ProfilerBugWorkaroundEnabled}`,r=`v8_cpu_profiler${e?"_maybe":""}_stuck_event_loop`;this._logger?.warn(`Wall profiler: ${e?"possible ":""}v8 profiler stuck event loop detected.`),i.increment(`runtime.node.profiler.${r}`,t,!0),y.count(r,[t]).inc()}_stop(e){if(!this._started)return;this._captureSpanData&&(this._enter(),this._lastSampleCount=0);const t=this._pprof.time.stop(e,this._generateLabels);if(e){const e=this._pprof.time.v8ProfilerStuckEventLoopDetected();0!==e&&this._reportV8bug(1===e)}else this._captureSpanData&&(g.unsubscribe(this._enter),m.unsubscribe(this._enter),_.unsubscribe(this._spanFinished),this._profilerState=void 0),this._started=!1;return t}_generateLabels({node:e,context:t}){if(e.name===this._pprof.time.constants.NON_JS_THREADS_FUNCTION_NAME)return l();if(null==t)return p();const r={...p()},{context:{ref:s},timestamp:n}=t,{spanId:i,rootSpanId:o,webTags:d,endpoint:f}=s??{};return this._timelineEnabled&&(r[a]=1000n*n),void 0!==i&&(r[c]=i),void 0!==o&&(r[u]=o),void 0!==d&&0!==Object.keys(d).length?r["trace endpoint"]=h(d):f&&(r["trace endpoint"]=f),r}profile(e){return this._stop(e)}encode(e){return this._pprof.encode(e)}stop(){this._stop(!1)}isStarted(){return this._started}}},99375:(e,t,r)=>{"use strict";const s=r(95608).manager.namespace("profilers"),n=r(1247),i=r(75004);e.exports={SSIHeuristics:class{constructor(e){const t=e.injectionEnabled.includes("profiler");this._heuristicsActive=t||"auto"===e.profiling.enabled,this._emitsTelemetry=e.injectionEnabled.length>0&&"false"!==e.profiling.enabled,this._emitsTelemetry&&("true"===e.profiling.enabled?this.enablementChoice="manually_enabled":t?this.enablementChoice="ssi_enabled":"auto"===e.profiling.enabled?this.enablementChoice="auto_enabled":this.enablementChoice="ssi_not_enabled");const r=e.profiling.longLivedThreshold||3e4;"number"!=typeof r||r<=0?(this.longLivedThreshold=3e4,i.warn(`Invalid SSIHeuristics.longLivedThreshold value: ${e.profiling.longLivedThreshold}. Using default value: 30000`)):this.longLivedThreshold=r,this.hasSentProfiles=!1,this.noSpan=!0,this.shortLived=!0}get emitsTelemetry(){return this._emitsTelemetry}get heuristicsActive(){return this._heuristicsActive}start(){(this.heuristicsActive||this.emitsTelemetry)&&(setTimeout((()=>{this.shortLived=!1,this._maybeTriggered()}),this.longLivedThreshold).unref(),this._onSpanCreated=this._onSpanCreated.bind(this),n.subscribe("dd-trace:span:start",this._onSpanCreated),this.emitsTelemetry&&(this._onProfileSubmitted=this._onProfileSubmitted.bind(this),this._onMockProfileSubmitted=this._onMockProfileSubmitted.bind(this),n.subscribe("datadog:profiling:profile-submitted",this._onProfileSubmitted),n.subscribe("datadog:profiling:mock-profile-submitted",this._onMockProfileSubmitted)),this._onAppClosing=this._onAppClosing.bind(this),n.subscribe("datadog:telemetry:app-closing",this._onAppClosing))}onTriggered(e){switch(typeof e){case"undefined":case"function":this.triggeredCallback=e,process.nextTick((()=>{this._maybeTriggered()}));break;default:throw new TypeError("callback must be a function or undefined")}}_maybeTriggered(){this.shortLived||this.noSpan||"function"==typeof this.triggeredCallback&&this.triggeredCallback.call(null)}_onSpanCreated(){this.noSpan=!1,this._maybeTriggered(),n.unsubscribe("dd-trace:span:start",this._onSpanCreated)}_onProfileSubmitted(){this.hasSentProfiles=!0,this._incProfileCount()}_onMockProfileSubmitted(){this._incProfileCount()}_incProfileCount(){this._ensureProfileMetrics(),this._profileCount.inc()}_ensureProfileMetrics(){const e=[];this.noSpan&&e.push("no_span"),this.shortLived&&e.push("short_lived"),0===e.length&&e.push("triggered");const t=["installation:ssi",`enablement_choice:${this.enablementChoice}`,`has_sent_profiles:${this.hasSentProfiles}`,`heuristic_hypothetical_decision:${e.join("_")}`];this._profileCount=s.count("ssi_heuristic.number_of_profiles",t),this._runtimeIdCount=s.count("ssi_heuristic.number_of_runtime_id",t),this._emittedRuntimeId||"triggered"!==e[0]||this.heuristicsActive&&!this.hasSentProfiles||(this._emittedRuntimeId=!0,this._runtimeIdCount.inc())}_onAppClosing(){this.emitsTelemetry&&(this._ensureProfileMetrics(),this._emittedRuntimeId||(this._emittedRuntimeId=!0,this._runtimeIdCount.inc()),this._profileCount.inc(0),n.unsubscribe("datadog:profiling:profile-submitted",this._onProfileSubmitted),n.unsubscribe("datadog:profiling:mock-profile-submitted",this._onMockProfileSubmitted)),n.unsubscribe("datadog:telemetry:app-closing",this._onAppClosing),this.noSpan&&n.unsubscribe("dd-trace:span:start",this._onSpanCreated)}}}},97562:(e,t,r)=>{"use strict";const s=r(1247),n=r(96538),i=s.channel("datadog:profiling:mock-profile-submitted"),{DD_PROFILING_UPLOAD_PERIOD:o}=process.env;let a;e.exports={start:e=>{const t=n(e.interval,1e3*Number(o),65e3);a=setTimeout((()=>{i.publish(),a.refresh()}),t),a.unref()},stop:()=>{void 0!==a&&(clearTimeout(a),a=void 0)}}},860:e=>{"use strict";const t={parse(e){if(!e)return{};switch(typeof e){case"object":return Array.isArray(e)?e.reduce(((e,t)=>{const r=t.split(":"),s=r.shift().trim(),n=r.join(":").trim();return s&&n?Object.assign(e,{[s]:n}):e}),{}):t.parse(Object.keys(e).filter((t=>void 0!==e[t]&&null!==e[t])).map((t=>`${t}:${e[t]}`)));case"string":return t.parse(e.split(","));default:return{}}}};e.exports={tagger:t}},87890:(e,t,r)=>{const{HTTP_METHOD:s,HTTP_ROUTE:n,RESOURCE_NAME:i,SPAN_TYPE:o}=r(74100),{WEB:a}=r(70780);e.exports={isWebServerSpan:function(e){return e[o]===a},endpointNameFromTags:function(e){return e[i]||[e[s],e[n]].filter((e=>e)).join(" ")},getStartedSpans:function(e){return e._trace.started}}},44741:(e,t,r)=>{"use strict";const s=r(68698),n=r(89168),i=r(90447),o=r(40091),a=r(75004),{setStartupLogPluginManager:c}=r(42471),u=r(48661),l=r(33837),p=r(83044),d=r(16994),h=r(52168),f=r(29425),g=r(2770),m=r(60589),_=r(47466),{SSIHeuristics:y}=r(99375),b=r(64431),v=r(46613);class E{constructor(e){this.provider=e}enable(...e){this.module=this.provider(),this.module.enable(...e)}disable(){this.module?.disable()}}e.exports=class extends s{constructor(){super(),this._initialized=!1,this._nomenclature=p,this._pluginManager=new d(this),this.dogstatsd=new m,this._tracingInitialized=!1,this._flare=new E((()=>r(85274))),this._modules={appsec:new E((()=>r(28302))),iast:new E((()=>r(31938))),llmobs:new E((()=>r(91817)))}}init(e){if(this._initialized)return this;this._initialized=!0;try{const t=new i(e);if(t.crashtracking.enabled&&r(53928).start(t),l.start(t,this._pluginManager),t.dogstatsd&&(this.dogstatsd=new g.CustomMetrics(t),setInterval((()=>{this.dogstatsd.flush()}),1e4).unref(),process.once("beforeExit",(()=>{this.dogstatsd.flush()}))),t.spanLeakDebug>0&&(t.spanLeakDebug===_.MODES.LOG?_.enableLogging():t.spanLeakDebug===_.MODES.GC_AND_LOG&&_.enableGarbageCollection(),_.startScrubber()),t.remoteConfig.enabled&&!t.isCiVisibility){const e=h.enable(t,this._modules.appsec);e.setProductHandler("APM_TRACING",((e,r)=>{"unapply"===e?t.configure({},!0):t.configure(r.lib_config,!0),this._enableOrDisableTracing(t)})),e.setProductHandler("AGENT_CONFIG",((e,r)=>{r?.name?.startsWith("flare-log-level.")&&("unapply"===e?this._flare.disable():r.config?.log_level&&(this._flare.enable(t),this._flare.module.prepare(r.config.log_level)))})),e.setProductHandler("AGENT_TASK",((e,r)=>{"unapply"!==e&&r&&"tracer_flare"===r.task_type&&r.args&&(this._flare.enable(t),this._flare.module.send(r.args))})),t.dynamicInstrumentation.enabled&&u.start(t,e)}if((t.isGCPFunction||t.isAzureFunction)&&r(3283).maybeStartServerlessMiniAgent(t),"false"!==t.profiling.enabled){const e=new y(t);e.start();let s=null;"true"===t.profiling.enabled?this._profilerStarted=this._startProfiler(t):e.emitsTelemetry&&(s=r(97562),s.start(t)),e.heuristicsActive&&e.onTriggered((()=>{s&&s.stop(),this._startProfiler(t),e.onTriggered()})),this._profilerStarted||(this._profilerStarted=Promise.resolve(!1))}if(t.runtimeMetrics&&o.start(t),this._enableOrDisableTracing(t),t.tracing&&t.isManualApiEnabled){const e=r(26584);this._testApiManualPlugin=new e(this),this._testApiManualPlugin.configure({...t,enabled:!0},!1)}if(t.ciVisAgentlessLogSubmissionEnabled)if(process.env.DD_API_KEY){new(r(2964))(this).configure({...t,enabled:!0})}else a.warn("DD_AGENTLESS_LOG_SUBMISSION_ENABLED is set, but DD_API_KEY is undefined, so no automatic log submission will be performed.");t.isTestDynamicInstrumentationEnabled&&r(14944).start(t)}catch(e){a.error("Error initialising tracer",e)}return this}_startProfiler(e){try{return r(18e3).start(e)}catch(e){a.error("Error starting profiler",e)}}_enableOrDisableTracing(e){if(!1!==e.tracing){if(e.appsec.enabled&&this._modules.appsec.enable(e),e.llmobs.enabled&&this._modules.llmobs.enable(e),!this._tracingInitialized){const t=b.configure(e);this._tracer=new n(e,t),this.dataStreamsCheckpointer=this._tracer.dataStreamsCheckpointer,this.appsec=new f(this._tracer,e),this.llmobs=new v(this._tracer,this._modules.llmobs,e),this._tracingInitialized=!0}e.iast.enabled&&this._modules.iast.enable(e,this._tracer)}else this._tracingInitialized&&(this._modules.appsec.disable(),this._modules.iast.disable(),this._modules.llmobs.disable());this._tracingInitialized&&(this._tracer.configure(e),this._pluginManager.configure(e),u.configure(e),c(this._pluginManager))}profilerStarted(){if(!this._profilerStarted)throw new Error("profilerStarted() must be called after init()");return this._profilerStarted}use(){return this._pluginManager.configurePlugin(...arguments),this}get TracerProvider(){return r(43434)}}},26748:(e,t,r)=>{"use strict";const s=r(19439);e.exports=class{constructor(e,t="second"){this._rateLimit=parseInt(e),this._limiter=new s.RateLimiter(this._rateLimit,t),this._tokensRequested=0,this._prevIntervalTokens=0,this._prevTokensRequested=0}isAllowed(){const e=this._limiter.curIntervalStart,t=this._limiter.tokensThisInterval,r=this._isAllowed();return e!==this._limiter.curIntervalStart?(this._prevIntervalTokens=t,this._prevTokensRequested=this._tokensRequested,this._tokensRequested=1):this._tokensRequested++,r}effectiveRate(){return this._rateLimit<0?1:0===this._rateLimit?0:0===this._tokensRequested?1:(this._prevIntervalTokens+this._limiter.tokensThisInterval)/(this._prevTokensRequested+this._tokensRequested)}_isAllowed(){return this._rateLimit<0||0!==this._rateLimit&&this._limiter.tryRemoveTokens(1)}_currentWindowRate(){return this._rateLimit<0?1:0===this._rateLimit?0:0===this._tokensRequested?1:this._limiter.tokensThisInterval/this._tokensRequested}}},98114:(e,t,r)=>{"use strict";const s=r(16928),n=r(79896);e.exports=function(e,t){if(s.isAbsolute(e)){const t=s.join(e,"package.json");return JSON.parse(n.readFileSync(t,"utf8"))}for(const r of t.paths){const t=s.join(r,e,"package.json");try{return JSON.parse(n.readFileSync(t,"utf8"))}catch(e){continue}}throw new Error(`could not find ${e}/package.json`)}},39995:(e,t,r)=>{"use strict";const s=r(16928),n=r(73339),i=r(55335),o=r(1247),a=n.prototype.require;e.exports=f;let c=Object.create(null),u=Object.create(null),l=Object.create(null),p=null;const d=o.channel("dd-trace:moduleLoadStart"),h=o.channel("dd-trace:moduleLoadEnd");function f(e,t,o){if(!(this instanceof f))return new f(e,t,o);if("function"==typeof e?(o=e,e=null,t={}):"function"==typeof t&&(o=t,t={}),e=e||[],t=t||{},this.modules=e,this.options=t,this.onrequire=o,Array.isArray(e))for(const t of e){const e=c[t];e?e.push(o):c[t]=[o]}if(p)return;const g=n.prototype.require;p=n.prototype.require=function(e){let t;try{t=n._resolveFilename(e,this)}catch(e){return g.apply(this,arguments)}const o=-1===t.indexOf(s.sep);let p,f,m;if(u[t])return r.c[t]&&r.c[t].exports!==u[t].original?r.c[t].exports:u[t].exports;if(l[t])return a.apply(this,arguments);l[t]=!0;const _={filename:t,request:e};d.hasSubscribers&&d.publish(_);const y=a.apply(this,arguments);if(_.module=y,h.hasSubscribers&&h.publish(_),delete l[t],o){if(m=c[t],!m)return y;p=t}else{const e=void 0!==process.env.AWS_LAMBDA_FUNCTION_NAME,r=void 0!==process.env.DD_LAMBDA_HANDLER,o=-1!==t.split(s.sep).lastIndexOf("node_modules"),a=e&&r&&!o?{name:t}:i(t);if(!a)return y;if(p=a.name,f=a.basedir,m=c[p],!m)return y;const u=n._resolveLookupPaths(p,this,!0);if(!u)return y;let l;try{l=n._findPath(p,[f,...u])}catch(e){}l&&l===t||(p=p+s.sep+s.relative(f,t))}u[t]={exports:y},u[t].original=y;for(const e of m)u[t].exports=e(u[t].exports,p,f);return u[t].exports}}f.reset=function(){n.prototype.require=a,p=null,l=Object.create(null),u=Object.create(null),c=Object.create(null)},f.prototype.unhook=function(){for(const e of this.modules){const t=(c[e]||[]).filter((e=>e!==this.onrequire));t.length>0?c[e]=t:delete c[e]}0===Object.keys(c).length&&f.reset()}},40091:(e,t,r)=>{"use strict";const s=r(11493),n=r(70857),{DogStatsDClient:i}=r(2770),o=r(75004),a=r(71155),{performance:c,PerformanceObserver:u}=r(82987),{NODE_MAJOR:l,NODE_MINOR:p}=r(63837),d=l>=18||16===l&&p>=7,h=l>=20||18===l&&p>=15;let f,g,m,_,y,b,v,E,S=null,T=null,w=null;A();const x=e.exports={start(e){const t=i.generateClientConfig(e);try{S=r(89475),d?S.start("loop"):S.start()}catch(e){o.error("Error starting native metrics",e),S=null}g=new i(t),m=process.hrtime(),T||h||!d||(T=new u((e=>{for(const t of e.getEntries()){const e=R(t.detail?.kind||t.kind);x.histogram("runtime.node.gc.pause.by.type",t.duration,`gc_type:${e}`),x.histogram("runtime.node.gc.pause",t.duration)}})),T.observe({type:"gc"})),!w&&h&&(w=new s.GCProfiler,w.start()),S?f=setInterval((()=>{k(),function(){const e=S.stats(),t=e.heap.spaces,r=process.hrtime(m);m=process.hrtime();const s=1e6*r[0]+r[1]/1e3,n=100*e.cpu.user/s,i=100*e.cpu.system/s,o=n+i;g.gauge("runtime.node.cpu.system",i.toFixed(2)),g.gauge("runtime.node.cpu.user",n.toFixed(2)),g.gauge("runtime.node.cpu.total",o.toFixed(2)),O("runtime.node.event_loop.delay",e.eventLoop),Object.keys(e.gc).forEach((t=>{"all"===t?O("runtime.node.gc.pause",e.gc[t]):O("runtime.node.gc.pause.by.type",e.gc[t],[`gc_type:${t}`])}));for(let e=0,r=t.length;e<r;e++){const r=[`heap_space:${t[e].space_name}`];g.gauge("runtime.node.heap.size.by.space",t[e].space_size,r),g.gauge("runtime.node.heap.used_size.by.space",t[e].space_used_size,r),g.gauge("runtime.node.heap.available_size.by.space",t[e].space_available_size,r),g.gauge("runtime.node.heap.physical_size.by.space",t[e].physical_space_size,r)}}(),g.flush()}),1e4):(_=process.cpuUsage(),f=setInterval((()=>{k(),function(){if(!process.cpuUsage)return;const e=process.hrtime(m),t=process.cpuUsage(_);m=process.hrtime(),_=process.cpuUsage();const r=1e3*e[0]+e[1]/1e6,s=100*t.user/1e3/r,n=100*t.system/1e3/r,i=s+n;g.gauge("runtime.node.cpu.system",n.toFixed(2)),g.gauge("runtime.node.cpu.user",s.toFixed(2)),g.gauge("runtime.node.cpu.total",i.toFixed(2))}(),function(){if(!s.getHeapSpaceStatistics)return;const e=s.getHeapSpaceStatistics();for(let t=0,r=e.length;t<r;t++){const r=[`space:${e[t].space_name}`];g.gauge("runtime.node.heap.size.by.space",e[t].space_size,r),g.gauge("runtime.node.heap.used_size.by.space",e[t].space_used_size,r),g.gauge("runtime.node.heap.available_size.by.space",e[t].space_available_size,r),g.gauge("runtime.node.heap.physical_size.by.space",e[t].physical_space_size,r)}}(),g.flush()}),1e4)),f.unref()},stop(){S&&S.stop(),clearInterval(f),A()},track(e){if(S){const t=S.track(e);return{finish:()=>S.finish(t)}}return{finish:()=>{}}},boolean(e,t,r){this.gauge(e,t?1:0,r)},histogram(e,t,r){g&&(v[e]=v[e]||new Map,v[e].has(r)||v[e].set(r,new a),v[e].get(r).record(t))},count(e,t,r,s=!1){if(!g)return;"boolean"==typeof r&&(s=r,r=void 0);const n=s?b:y;n[e]=n[e]||new Map;const i=n[e].get(r)||0;n[e].set(r,i+t)},gauge(e,t,r){g&&(y[e]=y[e]||new Map,y[e].set(r,t))},increment(e,t,r){this.count(e,1,t,r)},decrement(e,t){this.count(e,-1,t)}};function A(){f=null,g=null,m=null,_=null,y={},b={},v={},S=null,T&&T.disconnect(),T=null,w&&w.stop(),w=null}let I=()=>{};function k(){!function(){const e=process.memoryUsage();g.gauge("runtime.node.mem.heap_total",e.heapTotal),g.gauge("runtime.node.mem.heap_used",e.heapUsed),g.gauge("runtime.node.mem.rss",e.rss),g.gauge("runtime.node.mem.total",n.totalmem()),g.gauge("runtime.node.mem.free",n.freemem()),e.external&&g.gauge("runtime.node.mem.external",e.external)}(),g.gauge("runtime.node.process.uptime",Math.round(process.uptime())),function(){const e=s.getHeapStatistics();g.gauge("runtime.node.heap.total_heap_size",e.total_heap_size),g.gauge("runtime.node.heap.total_heap_size_executable",e.total_heap_size_executable),g.gauge("runtime.node.heap.total_physical_size",e.total_physical_size),g.gauge("runtime.node.heap.total_available_size",e.total_available_size),g.gauge("runtime.node.heap.heap_size_limit",e.heap_size_limit),e.malloced_memory&&g.gauge("runtime.node.heap.malloced_memory",e.malloced_memory),e.peak_malloced_memory&&g.gauge("runtime.node.heap.peak_malloced_memory",e.peak_malloced_memory)}(),Object.keys(y).forEach((e=>{y[e].forEach(((t,r)=>{g.gauge(e,t,r&&[r])}))})),Object.keys(b).forEach((e=>{b[e].forEach(((t,r)=>{g.increment(e,t,r&&[r])}))})),b={},Object.keys(v).forEach((e=>{v[e].forEach(((t,r)=>{O(e,t,r&&[r]),t.reset()}))})),I(),function(){if(!w)return;const e=w.stop(),t=new a,r={};for(const s of e.statistics){const e=s.gcType.replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();r[e]=r[e]||new a,r[e].record(s.cost),t.record(s.cost)}O("runtime.node.gc.pause",t);for(const e in r)O("runtime.node.gc.pause.by.type",r[e],[`gc_type:${e}`]);w.start()}()}function O(e,t,r){r=[].concat(r),0===t.count&&(t={max:0,min:0,sum:0,avg:0,median:0,p95:0,count:0}),g.gauge(`${e}.min`,t.min,r),g.gauge(`${e}.max`,t.max,r),g.increment(`${e}.sum`,t.sum,r),g.increment(`${e}.total`,t.sum,r),g.gauge(`${e}.avg`,t.avg,r),g.increment(`${e}.count`,t.count,r),g.gauge(`${e}.median`,t.median,r),g.gauge(`${e}.95percentile`,t.p95,r)}function R(e){if(l>=22)switch(e){case 1:return"scavenge";case 2:return"minor_mark_sweep";case 4:return"mark_sweep_compact";case 8:return"incremental_marking";case 16:return"process_weak_callbacks";case 31:return"all"}else if(l>=18)switch(e){case 1:return"scavenge";case 2:return"minor_mark_compact";case 4:return"mark_sweep_compact";case 8:return"incremental_marking";case 16:return"process_weak_callbacks";case 31:return"all"}else switch(e){case 1:return"scavenge";case 2:return"mark_sweep_compact";case 4:return"incremental_marking";case 8:return"process_weak_callbacks";case 15:return"all"}return"unknown"}"eventLoopUtilization"in c&&(I=()=>{E=c.eventLoopUtilization(E),g.gauge("runtime.node.event_loop.utilization",E.utilization)})},99429:e=>{"use strict";e.exports=class{constructor(e){this._rate=e}rate(){return this._rate}isSampled(){return 1===this._rate||Math.random()<this._rate}}},57913:(e,t,r)=>{"use strict";const{globMatch:s}=r(89421),n=r(26748),i=r(99429);class o{match(){return!0}}class a{constructor(e,t){this.pattern=e,this.locator=t}match(e){const t=this.locator(e);return!!t&&s(this.pattern,t)}}class c{constructor(e,t){this.pattern=e,this.locator=t}match(e){const t=this.locator(e);return!!t&&this.pattern.test(t)}}function u(e,t){return e instanceof RegExp?new c(e,t):"string"==typeof e&&"*"!==e?new a(e,t):new o}function l(e){return t=>t.context()._tags[e]}function p(e){return e.context()._name}function d(e){const{_tags:t}=e.context();return t.service||t["service.name"]||e.tracer()._service}class h{constructor({name:e,service:t,resource:r,tags:s,sampleRate:o=1,provenance:a,maxPerSecond:c}={}){this.matchers=[],e&&this.matchers.push(u(e,p)),t&&this.matchers.push(u(t,d)),r&&this.matchers.push(u(r,l("resource.name")));for(const[e,t]of Object.entries(s||{}))this.matchers.push(u(t,l(e)));this._sampler=new i(o),this._limiter=void 0,this.provenance=a,Number.isFinite(c)&&(this._limiter=new n(c))}static from(e){return new h(e)}get sampleRate(){return this._sampler.rate()}get effectiveRate(){return this._limiter&&this._limiter.effectiveRate()}get maxPerSecond(){return this._limiter&&this._limiter._rateLimit}match(e){for(const t of this.matchers)if(!t.match(e))return!1;return!0}sample(){return!!this._sampler.isSampled()&&(!this._limiter||this._limiter.isAllowed())}}e.exports=h},51997:(e,t,r)=>{"use strict";const{storage:s}=r(96882),n=new WeakMap;e.exports=class{active(){const e=s.getStore();return e&&e.span||null}activate(e,t){if("function"!=typeof t)return t;const r=s.getStore(),n=e?s.getStore(e._store):r;s.enterWith({...n,span:e});try{return t()}catch(t){throw e&&"function"==typeof e.setTag&&e.setTag("error",t),t}finally{s.enterWith(r)}}bind(e,t){if("function"!=typeof e)return e;const r=this,s=this._spanOrActive(t),i=function(){return r.activate(s,(()=>e.apply(this,arguments)))};return n.set(i,e),i}_spanOrActive(e){return void 0!==e?e:this.active()}_isPromise(e){return e&&"function"==typeof e.then}}},3283:(e,t,r)=>{"use strict";const s=r(75004);function n(e){return void 0!==process.env.DD_MINI_AGENT_PATH?process.env.DD_MINI_AGENT_PATH:`${e.isGCPFunction?"/workspace":"/home/site/wwwroot"}/node_modules/@datadog/sma/${"win32"===process.platform?"datadog-serverless-agent-windows-amd64":"datadog-serverless-agent-linux-amd64"}/datadog-serverless-trace-mini-agent${"win32"===process.platform?".exe":""}`}e.exports={maybeStartServerlessMiniAgent:function(e){if("win32"!==process.platform&&"linux"!==process.platform)return void s.error("Serverless Mini Agent is only supported on Windows and Linux.");const t=n(e),i=r(79896);if(s.debug(`Trying to spawn the Serverless Mini Agent at path: ${t}`),i.existsSync(t))try{r(35317).spawn(t,{stdio:"inherit"})}catch(e){s.error("Error spawning mini agent process: %s",e.message)}else s.error("Serverless Mini Agent did not start. Could not find mini agent binary.")},getIsGCPFunction:function(){const e=void 0!==process.env.FUNCTION_NAME&&void 0!==process.env.GCP_PROJECT,t=void 0!==process.env.K_SERVICE&&void 0!==process.env.FUNCTION_TARGET;return e||t},getIsAzureFunction:function(){return void 0!==process.env.FUNCTIONS_EXTENSION_VERSION&&void 0!==process.env.FUNCTIONS_WORKER_RUNTIME},getRustBinaryPath:n}},47583:e=>{"use strict";const t=new Set;e.exports={registerExtraService:function(e){e&&t.size<64&&t.add(e)},getExtraServices:function(){return[...t]},clear:function(){t.clear()}}},83044:(e,t,r)=>{const{schemaDefinitions:s}=r(36135);e.exports=new class{constructor(){this.schemas=s,this.config={spanAttributeSchema:"v0",spanRemoveIntegrationFromService:!1}}get schema(){return this.schemas[this.version]}get version(){return this.config.spanAttributeSchema}get shouldUseConsistentServiceNaming(){return this.config.spanRemoveIntegrationFromService&&"v0"===this.version}opName(e,t,r,s){return this.schema.getOpName(e,t,r,s)}serviceName(e,t,r,s){return(this.shouldUseConsistentServiceNaming?this.schemas.v1:this.schema).getServiceName(e,t,r,{...s,tracerService:this.config.service})}configure(e={}){this.config=e}}},36734:e=>{e.exports=class{constructor(e){this.schema=e}getSchemaItem(e,t,r){const s=this.schema;if(s&&s[e]&&s[e][t]&&s[e][t][r])return s[e][t][r]}getOpName(e,t,r,s){return this.getSchemaItem(e,t,r).opName(s)}getServiceName(e,t,r,s){return this.getSchemaItem(e,t,r).serviceName(s)}}},36135:(e,t,r)=>{const s=r(93422),n=r(71989);e.exports={schemaDefinitions:{v0:s,v1:n}}},82311:e=>{e.exports={identityService:function({tracerService:e}){return e},httpPluginClientService:function({tracerService:e,pluginConfig:t,sessionDetails:r}){return t.splitByDomain?function({host:e,port:t}){return[e,t].filter((e=>e)).join(":")}(r):t.service?t.service:e},awsServiceV0:function({tracerService:e,awsService:t}){return`${e}-aws-${t}`}}},9639:(e,t,r)=>{const{identityService:s}=r(82311),n={server:{graphql:{opName:()=>"graphql.execute",serviceName:s}}};e.exports=n},93422:(e,t,r)=>{const s=r(36734),n=r(74538),i=r(3771),o=r(9639),a=r(97292),c=r(52574);e.exports=new s({messaging:n,storage:i,web:a,graphql:o,serverless:c})},74538:(e,t,r)=>{const{identityService:s,awsServiceV0:n}=r(82311);function i({tracerService:e}){return`${e}-amqp`}const o={producer:{amqplib:{opName:()=>"amqp.command",serviceName:i},amqp10:{opName:()=>"amqp.send",serviceName:i},"google-cloud-pubsub":{opName:()=>"pubsub.request",serviceName:({tracerService:e})=>`${e}-pubsub`},kafkajs:{opName:()=>"kafka.produce",serviceName:({tracerService:e})=>`${e}-kafka`},rhea:{opName:()=>"amqp.send",serviceName:({tracerService:e})=>`${e}-amqp-producer`},sqs:{opName:()=>"aws.request",serviceName:n},sns:{opName:()=>"aws.request",serviceName:n}},consumer:{amqplib:{opName:()=>"amqp.command",serviceName:i},amqp10:{opName:()=>"amqp.receive",serviceName:i},"google-cloud-pubsub":{opName:()=>"pubsub.receive",serviceName:s},kafkajs:{opName:()=>"kafka.consume",serviceName:({tracerService:e})=>`${e}-kafka`},rhea:{opName:()=>"amqp.receive",serviceName:s},sqs:{opName:()=>"aws.request",serviceName:n}},client:{amqplib:{opName:()=>"amqp.command",serviceName:i},"google-cloud-pubsub":{opName:()=>"pubsub.request",serviceName:({tracerService:e})=>`${e}-pubsub`}}};e.exports=o},52574:(e,t,r)=>{const{identityService:s}=r(82311),n={server:{"azure-functions":{opName:()=>"azure.functions.invoke",serviceName:s}}};e.exports=n},3771:e=>{function t(e,t){return t?`${e}-${t}`:void 0}function r({tracerService:e,pluginConfig:r,dbConfig:s,system:n}){return"function"==typeof r.service?r.service(s):r.service||t(e,n)}function s(e){return({tracerService:t,pluginConfig:r,params:s})=>"function"==typeof r.service?r.service(s):r.service||`${t}-${e}`}const n={opName:()=>"redis.command",serviceName:({tracerService:e,pluginConfig:r,system:s,connectionName:n})=>function(e,t){return e.splitByInstance&&t?e.service?`${e.service}-${t}`:t:e.service}(r,n)||t(e,s)},i={client:{aerospike:{opName:()=>"aerospike.command",serviceName:({tracerService:e,pluginConfig:t})=>t.service||`${e}-aerospike`},"cassandra-driver":{opName:()=>"cassandra.query",serviceName:({tracerService:e,pluginConfig:r,system:s})=>r.service||t(e,s)},couchbase:{opName:({operation:e})=>`couchbase.${e}`,serviceName:({tracerService:e,pluginConfig:t})=>t.service||`${e}-couchbase`},elasticsearch:{opName:()=>"elasticsearch.query",serviceName:({tracerService:e,pluginConfig:t})=>t.service||`${e}-elasticsearch`},ioredis:n,mariadb:{opName:()=>"mariadb.query",serviceName:r},memcached:{opName:()=>"memcached.command",serviceName:({tracerService:e,pluginConfig:r,system:s})=>r.service||t(e,s)},"mongodb-core":{opName:()=>"mongodb.query",serviceName:({tracerService:e,pluginConfig:t})=>t.service||`${e}-mongodb`},mysql:{opName:()=>"mysql.query",serviceName:r},mysql2:{opName:()=>"mysql.query",serviceName:r},opensearch:{opName:()=>"opensearch.query",serviceName:({tracerService:e,pluginConfig:t})=>t.service||`${e}-opensearch`},oracledb:{opName:()=>"oracle.query",serviceName:s("oracle")},pg:{opName:()=>"pg.query",serviceName:s("postgres")},redis:n,tedious:{opName:()=>"tedious.request",serviceName:({tracerService:e,pluginConfig:r,system:s})=>r.service||t(e,s)}}};e.exports=i},97292:(e,t,r)=>{const{identityService:s,httpPluginClientService:n,awsServiceV0:i}=r(82311),{DD_MAJOR:o}=r(63837),a={client:{grpc:{opName:()=>o<=2?"grpc.request":"grpc.client",serviceName:s},moleculer:{opName:()=>"moleculer.call",serviceName:s},http:{opName:()=>"http.request",serviceName:n},fetch:{opName:()=>"http.request",serviceName:n},http2:{opName:()=>"http.request",serviceName:n},aws:{opName:()=>"aws.request",serviceName:i},lambda:{opName:()=>"aws.request",serviceName:i},undici:{opName:()=>"undici.request",serviceName:n}},server:{"apollo.gateway.request":{opName:()=>"apollo.gateway.request",serviceName:({pluginConfig:e,tracerService:t})=>e.service||t},"apollo.gateway.plan":{opName:()=>"apollo.gateway.plan",serviceName:({pluginConfig:e,tracerService:t})=>e.service||t},"apollo.gateway.validate":{opName:()=>"apollo.gateway.validate",serviceName:({pluginConfig:e,tracerService:t})=>e.service||t},"apollo.gateway.execute":{opName:()=>"apollo.gateway.execute",serviceName:({pluginConfig:e,tracerService:t})=>e.service||t},"apollo.gateway.fetch":{opName:()=>"apollo.gateway.fetch",serviceName:({pluginConfig:e,tracerService:t})=>e.service||t},"apollo.gateway.postprocessing":{opName:()=>"apollo.gateway.postprocessing",serviceName:({pluginConfig:e,tracerService:t})=>e.service||t},grpc:{opName:()=>o<=2?"grpc.request":"grpc.server",serviceName:s},moleculer:{opName:()=>"moleculer.action",serviceName:s},http:{opName:()=>"web.request",serviceName:s},http2:{opName:()=>"web.request",serviceName:s},next:{opName:()=>"next.request",serviceName:s}}};e.exports=a},16648:(e,t,r)=>{const{identityService:s}=r(82311),n={server:{graphql:{opName:()=>"graphql.server.request",serviceName:s}}};e.exports=n},71989:(e,t,r)=>{const s=r(36734),n=r(71249),i=r(59128),o=r(16648),a=r(67807),c=r(97627);e.exports=new s({messaging:n,storage:i,web:a,graphql:o,serverless:c})},71249:(e,t,r)=>{const{identityService:s}=r(82311),n={opName:()=>"amqp.process",serviceName:s},i={opName:()=>"amqp.send",serviceName:s},o={producer:{amqplib:i,amqp10:i,"google-cloud-pubsub":{opName:()=>"gcp.pubsub.send",serviceName:s},kafkajs:{opName:()=>"kafka.send",serviceName:s},rhea:i,sqs:{opName:()=>"aws.sqs.send",serviceName:s},sns:{opName:()=>"aws.sns.send",serviceName:s}},consumer:{amqplib:n,amqp10:n,"google-cloud-pubsub":{opName:()=>"gcp.pubsub.process",serviceName:s},kafkajs:{opName:()=>"kafka.process",serviceName:s},rhea:n,sqs:{opName:()=>"aws.sqs.process",serviceName:s}},client:{amqplib:{opName:()=>"amqp.command",serviceName:s},"google-cloud-pubsub":{opName:()=>"gcp.pubsub.request",serviceName:s}}};e.exports=o},97627:(e,t,r)=>{const{identityService:s}=r(82311),n={server:{"azure-functions":{opName:()=>"azure.functions.invoke",serviceName:s}}};e.exports=n},59128:e=>{function t({tracerService:e,pluginConfig:t}){return t.service||e}const r={opName:()=>"redis.command",serviceName:t},s={opName:()=>"mysql.query",serviceName:n};function n({tracerService:e,pluginConfig:r,params:s}){return"function"==typeof r.service?r.service(s):t({tracerService:e,pluginConfig:r})}const i={client:{aerospike:{opName:()=>"aerospike.command",serviceName:t},"cassandra-driver":{opName:()=>"cassandra.query",serviceName:t},couchbase:{opName:()=>"couchbase.query",serviceName:t},elasticsearch:{opName:()=>"elasticsearch.query",serviceName:t},ioredis:r,mariadb:{opName:()=>"mariadb.query",serviceName:n},memcached:{opName:()=>"memcached.command",serviceName:t},"mongodb-core":{opName:()=>"mongodb.query",serviceName:t},mysql:s,mysql2:s,opensearch:{opName:()=>"opensearch.query",serviceName:t},oracledb:{opName:()=>"oracle.query",serviceName:n},pg:{opName:()=>"postgresql.query",serviceName:n},redis:r,tedious:{opName:()=>"mssql.query",serviceName:t}}};e.exports=i},67807:(e,t,r)=>{const{identityService:s,httpPluginClientService:n}=r(82311),i={client:{grpc:{opName:()=>"grpc.client.request",serviceName:s},moleculer:{opName:()=>"moleculer.client.request",serviceName:s},http:{opName:()=>"http.client.request",serviceName:n},fetch:{opName:()=>"http.client.request",serviceName:n},http2:{opName:()=>"http.client.request",serviceName:n},aws:{opName:({awsService:e})=>`aws.${e}.request`,serviceName:s},lambda:{opName:()=>"aws.lambda.invoke",serviceName:s},undici:{opName:()=>"undici.request",serviceName:n}},server:{"apollo.gateway.request":{opName:()=>"apollo.gateway.request",serviceName:({pluginConfig:e,tracerService:t})=>e.service||t},"apollo.gateway.plan":{opName:()=>"apollo.gateway.plan",serviceName:({pluginConfig:e,tracerService:t})=>e.service||t},"apollo.gateway.validate":{opName:()=>"apollo.gateway.validate",serviceName:({pluginConfig:e,tracerService:t})=>e.service||t},"apollo.gateway.execute":{opName:()=>"apollo.gateway.execute",serviceName:({pluginConfig:e,tracerService:t})=>e.service||t},"apollo.gateway.fetch":{opName:()=>"apollo.gateway.fetch",serviceName:({pluginConfig:e,tracerService:t})=>e.service||t},"apollo.gateway.postprocessing":{opName:()=>"apollo.gateway.postprocessing",serviceName:({pluginConfig:e,tracerService:t})=>e.service||t},grpc:{opName:()=>"grpc.server.request",serviceName:s},moleculer:{opName:()=>"moleculer.server.request",serviceName:s},http:{opName:()=>"http.server.request",serviceName:s},http2:{opName:()=>"http.server.request",serviceName:s},next:{opName:()=>"http.server.request",serviceName:s}}};e.exports=i},5214:(e,t,r)=>{"use strict";const s=r(75004),n=r(99446),i=r(21058),o=r(33014),{SpanStatsProcessor:a}=r(68489),c=new WeakSet,u=new WeakSet,{channel:l}=r(1247),p=l("dd-trace:span:process");e.exports=class{constructor(e,t,r){this._exporter=e,this._prioritySampler=t,this._config=r,this._killAll=!1,this._stats=new a(r),this._spanSampler=new i(r.sampler),this._gitMetadataTagger=new o(r)}process(e){const t=e.context(),r=[],s=[],i=t._trace,{flushMinSpans:o,tracing:a}=this._config,{started:c,finished:u}=i;if(!1!==i.record)if(!1!==a){if(c.length===u.length||u.length>=o){this._prioritySampler.sample(t),this._spanSampler.sample(t),this._gitMetadataTagger.tagGitMetadata(t);for(const e of c)if(void 0!==e._duration){const t=n(e);this._stats.onSpanFinished(t),s.push(t),p.publish({span:e})}else r.push(e);0!==s.length&&!1!==i.isRecording&&this._exporter.export(s),this._erase(i,r)}if(this._killAll)for(const e of c)e._finished||e.finish()}else this._erase(i,r)}killAll(){this._killAll=!0}_erase(e,t){if("true"===process.env.DD_TRACE_EXPERIMENTAL_STATE_TRACKING){const t=new Set,r=new Set,n=new Set,i=new Set;for(const t of e.finished){const r=t.context(),o=r.toSpanId();n.has(t)?s.error("Span was already finished in the same trace: %s",t):(n.add(t),i.has(o)?s.error("Another span with the same ID was already finished in the same trace: %s",t):i.add(o),r._trace!==e&&s.error("A span was finished in the wrong trace: %s",t),u.has(t)?s.error("Span was already finished in a different trace: %s",t):u.add(t))}for(const i of e.started){const o=i.context(),a=o.toSpanId();t.has(i)?s.error("Span was already started in the same trace: %s",i):(t.add(i),r.has(a)?s.error("Another span with the same ID was already started in the same trace: %s",i):r.add(a),o._trace!==e&&s.error("A span was started in the wrong trace: %s",i),c.has(i)?s.error("Span was already started in a different trace: %s",i):c.add(i)),n.has(i)||s.error("Span started in one trace but was finished in another trace: %s",i)}for(const r of e.finished)t.has(r)||s.error("Span finished in one trace but was started in another trace: %s",r)}for(const t of e.finished)t.context()._tags={};e.started=t,e.finished=[]}}},21058:(e,t,r)=>{"use strict";const{USER_KEEP:s,AUTO_KEEP:n}=r(13973).priority,i=r(57913);e.exports=class{constructor({spanSamplingRules:e=[]}={}){this._rules=e.map(i.from)}findRule(e){for(const t of this._rules)if(t.match(e))return t}sample(e){const t=e._sampling.priority;if(t===s||t===n)return;const{started:r}=e._trace;for(const e of r){const t=this.findRule(e);t&&t.sample()&&(e.context()._spanSampling={sampleRate:t.sampleRate,maxPerSecond:t.maxPerSecond})}}}},68489:(e,t,r)=>{const s=r(70857),{version:n}=r(8523),i=r(8330),{LogCollapsingLowestDenseDDSketch:o}=r(4685),{ORIGIN_KEY:a,TOP_LEVEL_KEY:c}=r(23636),{MEASURED:u,HTTP_STATUS_CODE:l}=r(74100),{SpanStatsExporter:p}=r(81787),{DEFAULT_SPAN_NAME:d,DEFAULT_SERVICE_NAME:h}=r(1557);class f{constructor(e){this.aggKey=e,this.hits=0,this.topLevelHits=0,this.errors=0,this.duration=0,this.okDistribution=new o(.00775),this.errorDistribution=new o(.00775)}record(e){const t=e.duration;this.hits++,this.duration+=t,e.metrics[c]&&this.topLevelHits++,e.error?(this.errors++,this.errorDistribution.accept(t)):this.okDistribution.accept(t)}toJSON(){const{name:e,service:t,resource:r,type:s,statusCode:n,synthetics:i}=this.aggKey;return{Name:e,Service:t,Resource:r,Type:s,HTTPStatusCode:n,Synthetics:i,Hits:this.hits,TopLevelHits:this.topLevelHits,Errors:this.errors,Duration:this.duration,OkSummary:this.okDistribution.toProto(),ErrorSummary:this.errorDistribution.toProto()}}}class g{constructor(e){this.name=e.name||d,this.service=e.service||h,this.resource=e.resource||"",this.type=e.type||"",this.statusCode=e.meta[l]||0,this.synthetics="synthetics"===e.meta[a]}toString(){return[this.name,this.service,this.resource,this.type,this.statusCode,this.synthetics].join(",")}}class m extends Map{forSpan(e){const t=new g(e),r=t.toString();return this.has(r)||this.set(r,new f(t)),this.get(r)}}class _ extends Map{forTime(e){return this.has(e)||this.set(e,new m),this.get(e)}}e.exports={SpanAggStats:f,SpanAggKey:g,SpanBuckets:m,TimeBuckets:_,SpanStatsProcessor:class{constructor({stats:{enabled:e=!1,interval:t=10},hostname:r,port:n,url:i,env:o,tags:a,appsec:c,version:u}={}){this.exporter=new p({hostname:r,port:n,tags:a,url:i}),this.interval=t,this.bucketSizeNs=1e9*t,this.buckets=new _,this.hostname=s.hostname(),this.enabled=e&&!c?.standalone?.enabled,this.env=o,this.tags=a||{},this.sequence=0,this.version=u,this.enabled&&(this.timer=setInterval(this.onInterval.bind(this),1e3*t),this.timer.unref())}onInterval(){const e=this._serializeBuckets();e&&this.exporter.export({Hostname:this.hostname,Env:this.env,Version:this.version||n,Stats:e,Lang:"javascript",TracerVersion:i.version,RuntimeID:this.tags["runtime-id"],Sequence:++this.sequence})}onSpanFinished(e){if(!this.enabled)return;if(!e.metrics[c]&&!e.metrics[u])return;const t=e.startTime+e.duration,r=t-t%this.bucketSizeNs;this.buckets.forTime(r).forSpan(e).record(e)}_serializeBuckets(){const{bucketSizeNs:e}=this,t=[];for(const[r,s]of this.buckets.entries()){const n=[];for(const e of s.values())n.push(e.toJSON());t.push({Start:r,Duration:e,Stats:n})}return this.buckets.clear(),t}}}},47466:(e,t,r)=>{"use strict";const s=r(70234),n={DISABLED:0,LOG:1,GC_AND_LOG:2};e.exports.MODES=n;const i=new s;let o,a=n.DISABLED;function c(){return a>n.DISABLED}e.exports.disable=function(){a=n.DISABLED},e.exports.enableLogging=function(){a=n.LOG},e.exports.enableGarbageCollection=function(){a=n.GC_AND_LOG},e.exports.startScrubber=function(){c()&&(o=setInterval((()=>{const e=Date.now(),t=i.rangeByScore(0,e);if(!t.length)return;const r=a>=n.GC_AND_LOG,s=Object.create(null);for(const e of t){i.del(e);const t=e.deref();t&&(s[t._name]||(s[t._name]=0),s[t._name]++,r&&(t.context()._tags=Object.create(null)))}console.log("expired spans:"+Object.keys(s).reduce(((e,t)=>`${e} ${t}: ${s[t]}`),""))}),1e3))},e.exports.stopScrubber=function(){clearInterval(o)},e.exports.addSpan=function(e){if(!c())return;const t=Date.now()+6e4,r=new WeakRef(e);i.add(r,t)}},42471:(e,t,r)=>{"use strict";const{info:s,warn:n}=r(37513),i=r(70857),{inspect:o}=r(39023),a=r(8330).version,c={};let u,l,p=[],d=!1;function h(){const e=u.url||`http://${u.hostname||"localhost"}:${u.port}`,t={[o.custom](){return String(this)},toString(){return JSON.stringify(this)}};return t.date=(new Date).toISOString(),t.os_name=i.type(),t.os_version=i.release(),t.architecture=i.arch(),t.version=a,t.lang="nodejs",t.lang_version=process.versions.node,t.env=u.env,t.enabled=u.enabled,t.service=u.service,t.agent_url=e,t.debug=!!u.debug,t.sample_rate=u.sampler.sampleRate,t.sampling_rules=p,t.tags=u.tags,u.tags&&u.tags.version&&(t.dd_version=u.tags.version),t.log_injection_enabled=!!u.logInjection,t.runtime_metrics_enabled=!!u.runtimeMetrics,t.profiling_enabled=!!(u.profiling||{}).enabled,Object.assign(t,function(){const e=new Set,t={};for(const t in l._pluginsByName)e.add(t);return t.integrations_loaded=Array.from(e),t}()),t.appsec_enabled=!!u.appsec.enabled,t}e.exports={startupLog:function({agentError:e}={}){if(!u||!l)return;if(d)return;if(d=!0,!u.startupLogs)return;const t=h();e&&(t.agent_error=e.message),s("DATADOG TRACER CONFIGURATION - "+t),e&&(n("DATADOG TRACER DIAGNOSTIC - Agent Error: "+e.message),c.agentError={code:e.code?e.code:"",message:`Agent Error:${e.message}`})},setStartupLogConfig:function(e){u=e},setStartupLogPluginManager:function(e){l=e},setSamplingRules:function(e){p=e},tracerInfo:h,errors:c}},95487:(e,t,r)=>{"use strict";const s=r(23636),n=r(75004),i=s.ERROR_MESSAGE,o=s.ERROR_STACK,a=s.ERROR_TYPE,c={"deployment.environment":"env","service.name":"service","service.version":"version"};e.exports={add:function e(t,r,s=!1){if(t&&r){if(Array.isArray(r))return r.forEach((r=>e(t,r)));try{if("string"==typeof r){const e=r.split(",");for(const r of e){const e=s?r.indexOf("="):r.indexOf(":");if(-1===e)continue;let n=r.slice(0,e);const i=r.slice(e+1);s&&n in c&&(n=c[n]),t[n.trim()]=i.trim()}}else(i in r||o in r||a in r)&&("doNotSetTraceError"in r||(t.setTraceError=!0)),Object.assign(t,r)}catch(e){n.error("Error adding tags",e)}}}}},16248:(e,t,r)=>{"use strict";e=r.nmd(e);const s=r(16928),n=r(55335),i=r(98114),{sendData:o}=r(67480),a=r(1247),{fileURLToPath:c}=r(87016),{isTrue:u}=r(89421),l=new Set,p=new Set,d=new Set,h=a.channel("dd-trace:moduleLoadStart");let f,g,m,_,y,b,v,E=!0;function S(e,t,r){f||(f=setImmediate((()=>{if(f=null,l.size>0){const s=Array.from(l.values()).filter((t=>{const r=u(t.split(" ")[2])||e.telemetry?.dependencyCollection;return r||l.delete(t),r})).splice(0,2e3).map((e=>{l.delete(e);const[t,r]=e.split(" ");return{name:t,version:r}}));let n;const i=b();if(i)n={reqType:"app-dependencies-loaded",payload:{dependencies:s}};else{if(!s.length)return;n={dependencies:s}}const a=i?function(e){return e.map((e=>({request_type:e.reqType,payload:e.payload})))}([n,i]):n;o(e,t,r,i?"message-batch":"app-dependencies-loaded",a,v),l.size>0&&S(e,t,r)}})),f.unref())}function T(t){if(E&&(E=!1,r.c&&Object.keys(r.c).forEach((e=>{T({filename:e})}))),t){let r=t.filename;if(r&&r.startsWith("file://"))try{r=c(r)}catch(e){}const o=r&&n(r),a=t.request||o&&o.name,u=o&&o.basedir?o.basedir:a;if(r&&a&&function(e,t){const r=w(0,t,"/");return r&&"win32"===process.platform?w(0,t,s.sep):r}(0,a)&&!p.has(u)&&(p.add(u),o)){const{name:t,basedir:r}=o;if(r)try{const{version:s}=i(r,e),n=`${t} ${s}`;d.has(n)||(l.add(`${n} ${y}`),d.add(n),S(g,m,_))}catch(e){}}}}function w(e,t,r){return 0!==t.indexOf(`..${r}`)&&0!==t.indexOf(`.${r}`)&&0!==t.indexOf(r)&&1!==t.indexOf(`:${r}`)}e.exports={start:function(e={},t,r,s,n){g=e,m=t,_=r,y=!0,b=s,v=n,h.subscribe(T),queueMicrotask((()=>{y=!1}))},stop:function(){g=null,m=null,_=null,p.clear(),l.clear(),d.clear(),h.hasSubscribers&&h.unsubscribe(T)}}},33837:(e,t,r)=>{"use strict";const s=r(8330).version,n=r(1247),i=r(70857),o=r(16248),{sendData:a}=r(67480),{errors:c}=r(42471),{manager:u}=r(95608),l=r(25045),p=r(75004),d=n.channel("datadog:telemetry:start"),h=n.channel("datadog:telemetry:stop"),f=n.channel("datadog:telemetry:app-closing");let g,m,_,y,b,v,E,S,T=[],w=null;const x={},A=new Set;function I(){return w}function k(e,t){if(e)if("message-batch"===t.reqType){const e=t.payload[0].payload,r=t.payload[0].request_type;w={payload:e,reqType:r};const s=t.payload[1].payload,n=t.payload[1].request_type;"app-integrations-change"===n&&(x.integrations?x.integrations.push(s):x.integrations=[s]),"app-dependencies-loaded"===n&&(x.dependencies?x.dependencies.push(s):x.dependencies=[s])}else w=t;else w=null}function O(){const e=[];for(const t in m._pluginsByName)A.has(t)||(e.push({name:t,enabled:m._pluginsByName[t]._enabled,auto_enabled:!0}),A.add(t));return e}function R(e){const t={appsec:{enabled:e.appsec.enabled},profiler:{version:s,enabled:(r=e.profiling.enabled,"boolean"==typeof r?r:!!["auto","true"].includes(r)||"false"!==r&&void 0)}};var r;return c.profilingError&&(t.profiler.error=c.profilingError,c.profilingError={}),t}function C(e){const t={products:R(e),configuration:T},r=function(e){const{installSignature:t}=e;if(t&&(t.id||t.time||t.type))return{install_id:t.id,install_time:t.time,install_type:t.type}}(e);return r&&(t.install_signature=r),t}function N(){if(!g?.telemetry?.enabled)return;f.publish();const{reqType:e,payload:t}=q("app-closing");a(g,_,y,e,t),u.send(g,_,y),l.send(g,_,y)}function P(){process.removeListener("beforeExit",P),N()}function D(e){return{service_name:e.service,env:e.env,service_version:e.version,tracer_version:s,language_name:"nodejs",language_version:process.versions.node}}function L(){const e=i.type();return"Linux"===e||"Darwin"===e?{hostname:i.hostname(),os:e,architecture:i.arch(),kernel_version:i.version(),kernel_release:i.release(),kernel_name:e}:"Windows_NT"===e?{hostname:i.hostname(),os:e,architecture:i.arch(),os_version:i.version()}:{hostname:i.hostname(),os:e}}function M(){return{config:g,application:_,host:y,heartbeatInterval:v}}function q(e,t={}){if(I()){return{reqType:"message-batch",payload:[{reqType:e,payload:t},w].map((e=>({request_type:e.reqType,payload:e.payload})))}}return{reqType:e,payload:t}}function j(e,t,r){return b=setTimeout((()=>{u.send(e,t,r),l.send(e,t,r);const{reqType:s,payload:n}=q("app-heartbeat");a(e,t,r,s,n,k),j(e,t,r)}),v).unref(),b}e.exports={start:function(e,t){e.telemetry.enabled?(g=e,m=t,_=D(g),y=L(),v=g.telemetry.heartbeatInterval,S=O(),o.start(g,_,y,I,k),l.start(g),a(g,_,y,"app-started",C(g)),S.length>0&&a(g,_,y,"app-integrations-change",{integrations:S},k),j(g,_,y),function(e){E=setInterval((()=>{const t={...C(e),...x};a(e,_,y,"app-extended-heartbeat",t),Object.keys(x).forEach((e=>delete x[e]))}),864e5).unref()}(g),process.on("beforeExit",P),d.publish(M())):e.sca?.enabled&&p.warn("DD_APPSEC_SCA_ENABLED requires enabling telemetry to work.")},stop:function(){g&&(clearInterval(E),clearTimeout(b),process.removeListener("beforeExit",P),h.publish(M()),g=void 0)},updateIntegrations:function(){if(!g||!g.telemetry.enabled)return;const e=O();if(0===e.length)return;const{reqType:t,payload:r}=q("app-integrations-change",{integrations:e});a(g,_,y,t,r,k)},updateConfig:function(e,t){if(!t.telemetry.enabled)return;if(0===e.length)return;p.trace(e);const r=D(t),s=L(),n={sampleRate:"DD_TRACE_SAMPLE_RATE",logInjection:"DD_LOG_INJECTION",headerTags:"DD_TRACE_HEADER_TAGS",tags:"DD_TAGS","sampler.rules":"DD_TRACE_SAMPLING_RULES",traceEnabled:"DD_TRACE_ENABLED",url:"DD_TRACE_AGENT_URL","sampler.rateLimit":"DD_TRACE_RATE_LIMIT",queryStringObfuscation:"DD_TRACE_OBFUSCATION_QUERY_STRING_REGEXP",version:"DD_VERSION",env:"DD_ENV",service:"DD_SERVICE",clientIpHeader:"DD_TRACE_CLIENT_IP_HEADER","grpc.client.error.statuses":"DD_GRPC_CLIENT_ERROR_STATUSES","grpc.server.error.statuses":"DD_GRPC_SERVER_ERROR_STATUSES"},i=new Set(["DD_TAGS","peerServiceMapping","serviceMapping"]),o=[],c=[];for(const t of e){const e=n[t.name]||t.name;c.push(e);const{origin:r,value:s}=t,a={name:e,value:s,origin:r};i.has(a.name)?a.value=(u=a.value)?Object.entries(u).map((([e,t])=>`${e}:${t}`)).join(","):"":"url"===a.name?a.value&&(a.value=a.value.toString()):"DD_TRACE_SAMPLING_RULES"===a.name?a.value=JSON.stringify(a.value):Array.isArray(a.value)&&(a.value=s.join(",")),o.push(a)}var u;if(T.length){T=T.filter((function(e){return!c.includes(e.name)})),T=T.concat(o);const{reqType:e,payload:n}=q("app-client-configuration-change",{configuration:o});a(t,r,s,e,n,k)}else T=o},appClosing:N}},25045:(e,t,r)=>{"use strict";const s=r(1247),n=r(35633),{sendData:i}=r(67480),o=s.channel("datadog:telemetry:log"),a=s.channel("datadog:log:error");let c=!1;function u(e){var t;t=e?.level?.toUpperCase(),function(e){switch(e){case"ERROR":case"WARN":return!0;default:return!1}}(t)&&n.add(e)}function l(e){const{message:t,cause:r}=e;if(!t&&!r)return;const s={level:"ERROR",count:1,message:t??"Generic Error"};r&&(s.stack_trace=r.stack,s.errorType=r.constructor.name),u(s)}e.exports={start:function(e){e.telemetry.logCollection&&!c&&(c=!0,o.subscribe(u),a.subscribe(l))},stop:function(){c=!1,o.hasSubscribers&&o.unsubscribe(u),a.unsubscribe(l)},send:function(e,t,r){if(!c)return;const s=n.drain();s&&i(e,t,r,"logs",{logs:s})}}},35633:(e,t,r)=>{"use strict";const s=r(75004),{calculateDDBasePath:n}=r(89421),i=new Map;let o=1e4,a=0;function c(e){let t=0;const r=e.length;for(let s=0;s<r;s++)t=(31*t|0)+e.charCodeAt(s)|0;return t}function u(e){let t=e.level?c(e.level):0;return t=(31*t|0)+(e.message?c(e.message):0)|0,t=(31*t|0)+(e.stack_trace?c(e.stack_trace):0)|0,t}const l=n(__dirname),p=/^\s*at\s/gm,d={add(e){try{if(!function(e){return e?.level&&e.message}(e))return!1;if(i.size>=o)return a++,!1;if(!(e=function(e){const t=e.stack_trace;if(!t)return e;let r=t.split("\n");const s=r.findIndex((e=>e.match(p))),n=s>-1&&r[s].includes(l);return r=r.filter(((e,t)=>n&&t<s||e.includes(l))).map((e=>e.replace(l,""))),!n&&e.errorType&&r.length&&(r=[`${e.errorType}: redacted`,...r]),delete e.errorType,e.stack_trace=r.join("\n"),""!==e.stack_trace||e.message&&"Generic Error"!==e.message?e:null}(e)))return!1;const t=u(e);if(!i.has(t))return i.set(t,e),!0;i.get(t).count++}catch(e){s.error("Unable to add log to logCollector: %s",e.message)}return!1},hasEntry:e=>i.has(u(e)),drain(){if(0===i.size)return;const e=[...i.values()];return a>0&&e.push({message:`Omitted ${a} entries due to overflowing`,level:"ERROR"}),this.reset(),e},reset(e){i.clear(),a=0,e&&(o=e)}};d.reset(),e.exports=d},95608:(e,t,r)=>{"use strict";const{sendData:s}=r(67480);function n(e={}){if(Array.isArray(e))return e;const t=[];for(const[r,s]of Object.entries(e))t.push(`${r}:${s}`.toLowerCase());return t}function i(){return Date.now()/1e3}function o(e){return Array.from(e.values()).map((e=>e.toJSON()))}function a(e){return e.points.length>0}let c;class u{constructor(e,t,r,s){this.namespace=e.toString(),this.metric=r?t:`nodejs.${t}`,this.tags=n(s),r&&(void 0===c&&(c=`version:${process.version}`),this.tags.push(c)),this.common=r,this.points=[]}toString(){const{namespace:e,metric:t}=this;return`${e}.${t}`}reset(){this.points=[]}track(){throw new Error("not implemented")}toJSON(){const{metric:e,points:t,interval:r,type:s,tags:n,common:i}=this;return{metric:e,points:t,interval:r,type:s,tags:n,common:i}}}class l extends u{get type(){return"count"}inc(e){return this.track(e)}dec(e=1){return this.track(-e)}track(e=1){this.points.length?this.points[0][1]+=e:this.points.push([i(),e])}}class p extends u{get type(){return"distribution"}track(e=1){this.points.push(e)}toJSON(){const{metric:e,points:t,tags:r,common:s}=this;return{metric:e,points:t,common:s,tags:r}}}class d extends u{get type(){return"gauge"}mark(e){return this.track(e)}track(e=1){this.points.push([i(),e])}}class h extends u{constructor(e,t,r,s,n){super(e,t,r,s),this.interval=n,this.rate=0}get type(){return"rate"}reset(){super.reset(),this.rate=0}track(e=1){this.rate+=e;const t=this.interval?this.rate/this.interval:0;this.points=[[i(),t]]}}const f={count:l,distribution:p,gauge:d,rate:h};class g extends Map{constructor(e){super(),this.namespace=e}reset(){for(const e of this.values())e.reset()}toString(){return this.namespace}toJSON(){if(!this.size)return;const e=o(this).filter(a);if(!e.length)return;const{namespace:t}=this;return{namespace:t,series:e}}}function m(e,t,r,s,i){const o=function(e,t,r,s){return`${e}:${t}.${r}:${n(s).sort().join(",")}`}(t,e,r,s);let a=e.get(o);if(a)return a;const c=f[t];if(!c)throw new Error(`Unknown metric type ${t}`);return a=new c(e,r,!0,s,i),e.set(o,a),a}class _{constructor(e){this.distributions=new g(e),this.metrics=new g(e)}reset(){this.metrics.reset(),this.distributions.reset()}count(e,t){return m(this.metrics,"count",e,t)}gauge(e,t){return m(this.metrics,"gauge",e,t)}rate(e,t,r){return m(this.metrics,"rate",e,r,t)}distribution(e,t){return m(this.distributions,"distribution",e,t)}toJSON(){const{distributions:e,metrics:t}=this;return{distributions:e.toJSON(),metrics:t.toJSON()}}}class y extends Map{namespace(e){let t=this.get(e);return t||(t=new _(e),this.set(e,t),t)}toJSON(){return o(this)}send(e,t,r){for(const n of this.values()){const{metrics:i,distributions:o}=n.toJSON();i&&s(e,t,r,"generate-metrics",i),o&&s(e,t,r,"distributions",o),n.reset()}}}const b=new y;e.exports={CountMetric:l,DistributionMetric:p,GaugeMetric:d,RateMetric:h,MetricsCollection:g,Namespace:_,NamespaceManager:y,manager:b}},67480:(e,t,r)=>{const s=r(17209),n=r(75004),{isTrue:i}=r(89421);let o=!0;function a(e,t,r){const s={"content-type":"application/json","dd-telemetry-api-version":"v2","dd-telemetry-request-type":r,"dd-client-library-language":t.language_name,"dd-client-library-version":t.tracer_version};return e.telemetry&&e.telemetry.debug&&(s["dd-telemetry-debug-enabled"]="true"),e.apiKey&&(s["dd-api-key"]=e.apiKey),s}function c(e){return"datad0g.com"===e?"https://all-http-intake.logs.datad0g.com":`https://instrumentation-telemetry-intake.${e}`}let u=0;function l(e){if(Array.isArray(e))return e;{const{logger:t,tags:r,serviceMapping:s,...n}=e;return n}}e.exports={sendData:function(e,t,r,p,d={},h=()=>{}){const{hostname:f,port:g,isCiVisibility:m}=e;let _=e.url;const y=m&&i(process.env.DD_CIVISIBILITY_AGENTLESS_ENABLED);if(y)try{_=_||new URL(c(e.site))}catch(e){return n.error("Telemetry endpoint url is invalid",e),h(e,{payload:d,reqType:p})}const b={url:_,hostname:f,port:g,method:"POST",path:y?"/api/v2/apmtelemetry":"/telemetry/proxy/api/v2/apmtelemetry",headers:a(e,t,p)},v=JSON.stringify({api_version:"v2",naming_schema_version:e.spanAttributeSchema?e.spanAttributeSchema:"",request_type:p,tracer_time:Math.floor(Date.now()/1e3),runtime_id:e.tags["runtime-id"],seq_id:++u,payload:l(d),application:t,host:r});s(v,b,(t=>{if(t&&process.env.DD_API_KEY&&e.site){o&&(n.warn("Agent telemetry failed, started agentless telemetry"),o=!1);const t=c(e.site),r={...b.headers,"DD-API-KEY":process.env.DD_API_KEY},i={...b,url:t,headers:r,path:"/api/v2/apmtelemetry"};t?s(v,i,(e=>{n.error("Error sending telemetry data",e)})):n.error("Invalid Telemetry URL")}t||o||(o=!0,n.info("Started agent telemetry")),h(t,{payload:d,reqType:p})}))}}},89168:(e,t,r)=>{"use strict";const s=r(16527),n=r(74100),i=r(51997),{isError:o}=r(89421),{setStartupLogConfig:a}=r(42471),{ERROR_MESSAGE:c,ERROR_TYPE:u,ERROR_STACK:l}=r(23636),{DataStreamsProcessor:p}=r(63011),{DsmPathwayCodec:d}=r(71793),h=r(61931),{DataStreamsCheckpointer:f}=r(15135),{flushStartupLogs:g}=r(51006),m=r(37513),_=n.SPAN_TYPE,y=n.RESOURCE_NAME,b=n.SERVICE_NAME,v=n.MEASURED;function E(e,t){o(t)&&e.addTags({[u]:t.name,[c]:t.message,[l]:t.stack})}e.exports=class extends s{constructor(e,t){super(e,t),this._dataStreamsProcessor=new p(e),this.dataStreamsCheckpointer=new f(this),this._scope=new i,a(e),g(m)}configure({env:e,sampler:t}){this._prioritySampler.configure(e,t)}setCheckpoint(e,t,r=0){const s=this._dataStreamsProcessor.setCheckpoint(e,t,h.getDataStreamsContext(),r);return h.setDataStreamsContext(s),s}decodeDataStreamsContext(e){const t=d.decode(e);return h.setDataStreamsContext(t),t}setOffset(e){return this._dataStreamsProcessor.setOffset(e)}trace(e,t,r){t=Object.assign({childOf:this.scope().active()},t);const s=this.startSpan(e,t);!function(e,t){const r={};t.type&&(r[_]=t.type),t.service&&(r[b]=t.service),t.resource&&(r[y]=t.resource),r[v]=t.measured,e.addTags(r)}(s,t);try{if(r.length>1)return this.scope().activate(s,(()=>r(s,(e=>{E(s,e),s.finish()}))));const e=this.scope().activate(s,(()=>r(s)));return e&&"function"==typeof e.then?e.then((e=>(s.finish(),e)),(e=>{throw E(s,e),s.finish(),e})):(s.finish(),e)}catch(e){throw E(s,e),s.finish(),e}}wrap(e,t,r){const s=this;return function(){let n=t;"function"==typeof n&&"function"==typeof r&&(n=n.apply(this,arguments));const i=arguments.length-1,o=arguments[i];if("function"==typeof o){const t=s.scope().bind(o);return s.trace(e,n,((e,s)=>(arguments[i]=function(e){return s(e),t.apply(this,arguments)},r.apply(this,arguments))))}return s.trace(e,n,(()=>r.apply(this,arguments)))}}setUrl(e){this._exporter.setUrl(e),this._dataStreamsProcessor.setUrl(e)}scope(){return this._scope}getRumData(){return this._enableGetRumData?`<meta name="dd-trace-id" content="${this.scope().active().context().toTraceId()}" /><meta name="dd-trace-time" content="${Date.now()}" />`:""}}},89421:(e,t,r)=>{"use strict";const s=r(16928);e.exports={isTrue:function(e){return"true"===(e=String(e).toLowerCase())||"1"===e},isFalse:function(e){return"false"===(e=String(e).toLowerCase())||"0"===e},isError:function(e){return e instanceof Error||!(!e||!e.message)},globMatch:function(e,t){"string"==typeof e&&(e=e.toLowerCase()),"string"==typeof t&&(t=t.toLowerCase());let r=0,s=0,n=0,i=0;for(;r<e.length||s<t.length;){if(r<e.length){const o=e[r];switch(o){case"?":if(s<t.length){r++,s++;continue}break;case"*":n=r,i=s+1,r++;continue;default:if(s<t.length&&t[s]===o){r++,s++;continue}}}if(!(i>0&&i<=t.length))return!1;r=n,s=i}return!0},calculateDDBasePath:function(e){const t=e.split(s.sep),r=t.lastIndexOf("packages");return t.slice(0,r+1).join(s.sep)+s.sep},hasOwn:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}},63837:(e,t,r)=>{"use strict";var s=r(8330).version.match(/^(\d+)\.(\d+)\.(\d+)/),n=process.versions.node.match(/^(\d+)\.(\d+)\.(\d+)/);e.exports={DD_MAJOR:parseInt(s[1]),DD_MINOR:parseInt(s[2]),DD_PATCH:parseInt(s[3]),NODE_MAJOR:parseInt(n[1]),NODE_MINOR:parseInt(n[2]),NODE_PATCH:parseInt(n[3])}},42613:e=>{"use strict";e.exports=require("assert")},90290:e=>{"use strict";e.exports=require("async_hooks")},35317:e=>{"use strict";e.exports=require("child_process")},76982:e=>{"use strict";e.exports=require("crypto")},7194:e=>{"use strict";e.exports=require("dgram")},31637:e=>{"use strict";e.exports=require("diagnostics_channel")},72250:e=>{"use strict";e.exports=require("dns")},24434:e=>{"use strict";e.exports=require("events")},79896:e=>{"use strict";e.exports=require("fs")},58611:e=>{"use strict";e.exports=require("http")},65692:e=>{"use strict";e.exports=require("https")},73339:e=>{"use strict";e.exports=require("module")},69278:e=>{"use strict";e.exports=require("net")},40610:e=>{"use strict";e.exports=require("node:dns")},70857:e=>{"use strict";e.exports=require("os")},16928:e=>{"use strict";e.exports=require("path")},82987:e=>{"use strict";e.exports=require("perf_hooks")},932:e=>{"use strict";e.exports=require("process")},2203:e=>{"use strict";e.exports=require("stream")},87016:e=>{"use strict";e.exports=require("url")},39023:e=>{"use strict";e.exports=require("util")},11493:e=>{"use strict";e.exports=require("v8")},69154:e=>{"use strict";e.exports=require("vm")},28167:e=>{"use strict";e.exports=require("worker_threads")},43106:e=>{"use strict";e.exports=require("zlib")},28936:e=>{const t="object"==typeof performance&&performance&&"function"==typeof performance.now?performance:Date,r="function"==typeof AbortController?AbortController:class{constructor(){this.signal=new i}abort(e=new Error("This operation was aborted")){this.signal.reason=this.signal.reason||e,this.signal.aborted=!0,this.signal.dispatchEvent({type:"abort",target:this.signal})}},s="function"==typeof AbortSignal,n="function"==typeof r.AbortSignal,i=s?AbortSignal:n?r.AbortController:class{constructor(){this.reason=void 0,this.aborted=!1,this._listeners=[]}dispatchEvent(e){"abort"===e.type&&(this.aborted=!0,this.onabort(e),this._listeners.forEach((t=>t(e)),this))}onabort(){}addEventListener(e,t){"abort"===e&&this._listeners.push(t)}removeEventListener(e,t){"abort"===e&&(this._listeners=this._listeners.filter((e=>e!==t)))}},o=new Set,a=(e,t)=>{const r=`LRU_CACHE_OPTION_${e}`;l(r)&&p(r,`${e} option`,`options.${t}`,m)},c=(e,t)=>{const r=`LRU_CACHE_METHOD_${e}`;if(l(r)){const{prototype:s}=m,{get:n}=Object.getOwnPropertyDescriptor(s,e);p(r,`${e} method`,`cache.${t}()`,n)}},u=(...e)=>{"object"==typeof process&&process&&"function"==typeof process.emitWarning?process.emitWarning(...e):console.error(...e)},l=e=>!o.has(e),p=(e,t,r,s)=>{o.add(e),u(`The ${t} is deprecated. Please use ${r} instead.`,"DeprecationWarning",e,s)},d=e=>e&&e===Math.floor(e)&&e>0&&isFinite(e),h=e=>d(e)?e<=Math.pow(2,8)?Uint8Array:e<=Math.pow(2,16)?Uint16Array:e<=Math.pow(2,32)?Uint32Array:e<=Number.MAX_SAFE_INTEGER?f:null:null;class f extends Array{constructor(e){super(e),this.fill(0)}}class g{constructor(e){if(0===e)return[];const t=h(e);this.heap=new t(e),this.length=0}push(e){this.heap[this.length++]=e}pop(){return this.heap[--this.length]}}class m{constructor(e={}){const{max:t=0,ttl:r,ttlResolution:s=1,ttlAutopurge:n,updateAgeOnGet:i,updateAgeOnHas:c,allowStale:p,dispose:f,disposeAfter:_,noDisposeOnSet:y,noUpdateTTL:b,maxSize:v=0,maxEntrySize:E=0,sizeCalculation:S,fetchMethod:T,fetchContext:w,noDeleteOnFetchRejection:x,noDeleteOnStaleGet:A,allowStaleOnFetchRejection:I,allowStaleOnFetchAbort:k,ignoreFetchAbort:O}=e,{length:R,maxAge:C,stale:N}=e instanceof m?{}:e;if(0!==t&&!d(t))throw new TypeError("max option must be a nonnegative integer");const P=t?h(t):Array;if(!P)throw new Error("invalid max value: "+t);if(this.max=t,this.maxSize=v,this.maxEntrySize=E||this.maxSize,this.sizeCalculation=S||R,this.sizeCalculation){if(!this.maxSize&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if("function"!=typeof this.sizeCalculation)throw new TypeError("sizeCalculation set to non-function")}if(this.fetchMethod=T||null,this.fetchMethod&&"function"!=typeof this.fetchMethod)throw new TypeError("fetchMethod must be a function if specified");if(this.fetchContext=w,!this.fetchMethod&&void 0!==w)throw new TypeError("cannot set fetchContext without fetchMethod");if(this.keyMap=new Map,this.keyList=new Array(t).fill(null),this.valList=new Array(t).fill(null),this.next=new P(t),this.prev=new P(t),this.head=0,this.tail=0,this.free=new g(t),this.initialFill=1,this.size=0,"function"==typeof f&&(this.dispose=f),"function"==typeof _?(this.disposeAfter=_,this.disposed=[]):(this.disposeAfter=null,this.disposed=null),this.noDisposeOnSet=!!y,this.noUpdateTTL=!!b,this.noDeleteOnFetchRejection=!!x,this.allowStaleOnFetchRejection=!!I,this.allowStaleOnFetchAbort=!!k,this.ignoreFetchAbort=!!O,0!==this.maxEntrySize){if(0!==this.maxSize&&!d(this.maxSize))throw new TypeError("maxSize must be a positive integer if specified");if(!d(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");this.initializeSizeTracking()}if(this.allowStale=!!p||!!N,this.noDeleteOnStaleGet=!!A,this.updateAgeOnGet=!!i,this.updateAgeOnHas=!!c,this.ttlResolution=d(s)||0===s?s:1,this.ttlAutopurge=!!n,this.ttl=r||C||0,this.ttl){if(!d(this.ttl))throw new TypeError("ttl must be a positive integer if specified");this.initializeTTLTracking()}if(0===this.max&&0===this.ttl&&0===this.maxSize)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.max&&!this.maxSize){const e="LRU_CACHE_UNBOUNDED";l(e)&&(o.add(e),u("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",e,m))}N&&a("stale","allowStale"),C&&a("maxAge","ttl"),R&&a("length","sizeCalculation")}getRemainingTTL(e){return this.has(e,{updateAgeOnHas:!1})?1/0:0}initializeTTLTracking(){this.ttls=new f(this.max),this.starts=new f(this.max),this.setItemTTL=(e,r,s=t.now())=>{if(this.starts[e]=0!==r?s:0,this.ttls[e]=r,0!==r&&this.ttlAutopurge){const t=setTimeout((()=>{this.isStale(e)&&this.delete(this.keyList[e])}),r+1);t.unref&&t.unref()}},this.updateItemAge=e=>{this.starts[e]=0!==this.ttls[e]?t.now():0},this.statusTTL=(t,s)=>{t&&(t.ttl=this.ttls[s],t.start=this.starts[s],t.now=e||r(),t.remainingTTL=t.now+t.ttl-t.start)};let e=0;const r=()=>{const r=t.now();if(this.ttlResolution>0){e=r;const t=setTimeout((()=>e=0),this.ttlResolution);t.unref&&t.unref()}return r};this.getRemainingTTL=t=>{const s=this.keyMap.get(t);return void 0===s?0:0===this.ttls[s]||0===this.starts[s]?1/0:this.starts[s]+this.ttls[s]-(e||r())},this.isStale=t=>0!==this.ttls[t]&&0!==this.starts[t]&&(e||r())-this.starts[t]>this.ttls[t]}updateItemAge(e){}statusTTL(e,t){}setItemTTL(e,t,r){}isStale(e){return!1}initializeSizeTracking(){this.calculatedSize=0,this.sizes=new f(this.max),this.removeItemSize=e=>{this.calculatedSize-=this.sizes[e],this.sizes[e]=0},this.requireSize=(e,t,r,s)=>{if(this.isBackgroundFetch(t))return 0;if(!d(r)){if(!s)throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");if("function"!=typeof s)throw new TypeError("sizeCalculation must be a function");if(r=s(t,e),!d(r))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}return r},this.addItemSize=(e,t,r)=>{if(this.sizes[e]=t,this.maxSize){const t=this.maxSize-this.sizes[e];for(;this.calculatedSize>t;)this.evict(!0)}this.calculatedSize+=this.sizes[e],r&&(r.entrySize=t,r.totalCalculatedSize=this.calculatedSize)}}removeItemSize(e){}addItemSize(e,t){}requireSize(e,t,r,s){if(r||s)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache")}*indexes({allowStale:e=this.allowStale}={}){if(this.size)for(let t=this.tail;this.isValidIndex(t)&&(!e&&this.isStale(t)||(yield t),t!==this.head);)t=this.prev[t]}*rindexes({allowStale:e=this.allowStale}={}){if(this.size)for(let t=this.head;this.isValidIndex(t)&&(!e&&this.isStale(t)||(yield t),t!==this.tail);)t=this.next[t]}isValidIndex(e){return void 0!==e&&this.keyMap.get(this.keyList[e])===e}*entries(){for(const e of this.indexes())void 0===this.valList[e]||void 0===this.keyList[e]||this.isBackgroundFetch(this.valList[e])||(yield[this.keyList[e],this.valList[e]])}*rentries(){for(const e of this.rindexes())void 0===this.valList[e]||void 0===this.keyList[e]||this.isBackgroundFetch(this.valList[e])||(yield[this.keyList[e],this.valList[e]])}*keys(){for(const e of this.indexes())void 0===this.keyList[e]||this.isBackgroundFetch(this.valList[e])||(yield this.keyList[e])}*rkeys(){for(const e of this.rindexes())void 0===this.keyList[e]||this.isBackgroundFetch(this.valList[e])||(yield this.keyList[e])}*values(){for(const e of this.indexes())void 0===this.valList[e]||this.isBackgroundFetch(this.valList[e])||(yield this.valList[e])}*rvalues(){for(const e of this.rindexes())void 0===this.valList[e]||this.isBackgroundFetch(this.valList[e])||(yield this.valList[e])}[Symbol.iterator](){return this.entries()}find(e,t){for(const r of this.indexes()){const s=this.valList[r],n=this.isBackgroundFetch(s)?s.__staleWhileFetching:s;if(void 0!==n&&e(n,this.keyList[r],this))return this.get(this.keyList[r],t)}}forEach(e,t=this){for(const r of this.indexes()){const s=this.valList[r],n=this.isBackgroundFetch(s)?s.__staleWhileFetching:s;void 0!==n&&e.call(t,n,this.keyList[r],this)}}rforEach(e,t=this){for(const r of this.rindexes()){const s=this.valList[r],n=this.isBackgroundFetch(s)?s.__staleWhileFetching:s;void 0!==n&&e.call(t,n,this.keyList[r],this)}}get prune(){return c("prune","purgeStale"),this.purgeStale}purgeStale(){let e=!1;for(const t of this.rindexes({allowStale:!0}))this.isStale(t)&&(this.delete(this.keyList[t]),e=!0);return e}dump(){const e=[];for(const r of this.indexes({allowStale:!0})){const s=this.keyList[r],n=this.valList[r],i=this.isBackgroundFetch(n)?n.__staleWhileFetching:n;if(void 0===i)continue;const o={value:i};if(this.ttls){o.ttl=this.ttls[r];const e=t.now()-this.starts[r];o.start=Math.floor(Date.now()-e)}this.sizes&&(o.size=this.sizes[r]),e.unshift([s,o])}return e}load(e){this.clear();for(const[r,s]of e){if(s.start){const e=Date.now()-s.start;s.start=t.now()-e}this.set(r,s.value,s)}}dispose(e,t,r){}set(e,t,{ttl:r=this.ttl,start:s,noDisposeOnSet:n=this.noDisposeOnSet,size:i=0,sizeCalculation:o=this.sizeCalculation,noUpdateTTL:a=this.noUpdateTTL,status:c}={}){if(i=this.requireSize(e,t,i,o),this.maxEntrySize&&i>this.maxEntrySize)return c&&(c.set="miss",c.maxEntrySizeExceeded=!0),this.delete(e),this;let u=0===this.size?void 0:this.keyMap.get(e);if(void 0===u)u=this.newIndex(),this.keyList[u]=e,this.valList[u]=t,this.keyMap.set(e,u),this.next[this.tail]=u,this.prev[u]=this.tail,this.tail=u,this.size++,this.addItemSize(u,i,c),c&&(c.set="add"),a=!1;else{this.moveToTail(u);const r=this.valList[u];if(t!==r){if(this.isBackgroundFetch(r)?r.__abortController.abort(new Error("replaced")):n||(this.dispose(r,e,"set"),this.disposeAfter&&this.disposed.push([r,e,"set"])),this.removeItemSize(u),this.valList[u]=t,this.addItemSize(u,i,c),c){c.set="replace";const e=r&&this.isBackgroundFetch(r)?r.__staleWhileFetching:r;void 0!==e&&(c.oldValue=e)}}else c&&(c.set="update")}if(0===r||0!==this.ttl||this.ttls||this.initializeTTLTracking(),a||this.setItemTTL(u,r,s),this.statusTTL(c,u),this.disposeAfter)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift());return this}newIndex(){return 0===this.size?this.tail:this.size===this.max&&0!==this.max?this.evict(!1):0!==this.free.length?this.free.pop():this.initialFill++}pop(){if(this.size){const e=this.valList[this.head];return this.evict(!0),e}}evict(e){const t=this.head,r=this.keyList[t],s=this.valList[t];return this.isBackgroundFetch(s)?s.__abortController.abort(new Error("evicted")):(this.dispose(s,r,"evict"),this.disposeAfter&&this.disposed.push([s,r,"evict"])),this.removeItemSize(t),e&&(this.keyList[t]=null,this.valList[t]=null,this.free.push(t)),this.head=this.next[t],this.keyMap.delete(r),this.size--,t}has(e,{updateAgeOnHas:t=this.updateAgeOnHas,status:r}={}){const s=this.keyMap.get(e);if(void 0!==s){if(!this.isStale(s))return t&&this.updateItemAge(s),r&&(r.has="hit"),this.statusTTL(r,s),!0;r&&(r.has="stale",this.statusTTL(r,s))}else r&&(r.has="miss");return!1}peek(e,{allowStale:t=this.allowStale}={}){const r=this.keyMap.get(e);if(void 0!==r&&(t||!this.isStale(r))){const e=this.valList[r];return this.isBackgroundFetch(e)?e.__staleWhileFetching:e}}backgroundFetch(e,t,s,n){const i=void 0===t?void 0:this.valList[t];if(this.isBackgroundFetch(i))return i;const o=new r;s.signal&&s.signal.addEventListener("abort",(()=>o.abort(s.signal.reason)));const a={signal:o.signal,options:s,context:n},c=(r,n=!1)=>{const{aborted:i}=o.signal,c=s.ignoreFetchAbort&&void 0!==r;return s.status&&(i&&!n?(s.status.fetchAborted=!0,s.status.fetchError=o.signal.reason,c&&(s.status.fetchAbortIgnored=!0)):s.status.fetchResolved=!0),!i||c||n?(this.valList[t]===l&&(void 0===r?l.__staleWhileFetching?this.valList[t]=l.__staleWhileFetching:this.delete(e):(s.status&&(s.status.fetchUpdated=!0),this.set(e,r,a.options))),r):u(o.signal.reason)},u=r=>{const{aborted:n}=o.signal,i=n&&s.allowStaleOnFetchAbort,a=i||s.allowStaleOnFetchRejection,c=a||s.noDeleteOnFetchRejection;if(this.valList[t]===l&&(c&&void 0!==l.__staleWhileFetching?i||(this.valList[t]=l.__staleWhileFetching):this.delete(e)),a)return s.status&&void 0!==l.__staleWhileFetching&&(s.status.returnedStale=!0),l.__staleWhileFetching;if(l.__returned===l)throw r};s.status&&(s.status.fetchDispatched=!0);const l=new Promise(((t,r)=>{this.fetchMethod(e,i,a).then((e=>t(e)),r),o.signal.addEventListener("abort",(()=>{s.ignoreFetchAbort&&!s.allowStaleOnFetchAbort||(t(),s.allowStaleOnFetchAbort&&(t=e=>c(e,!0)))}))})).then(c,(e=>(s.status&&(s.status.fetchRejected=!0,s.status.fetchError=e),u(e))));return l.__abortController=o,l.__staleWhileFetching=i,l.__returned=null,void 0===t?(this.set(e,l,{...a.options,status:void 0}),t=this.keyMap.get(e)):this.valList[t]=l,l}isBackgroundFetch(e){return e&&"object"==typeof e&&"function"==typeof e.then&&Object.prototype.hasOwnProperty.call(e,"__staleWhileFetching")&&Object.prototype.hasOwnProperty.call(e,"__returned")&&(e.__returned===e||null===e.__returned)}async fetch(e,{allowStale:t=this.allowStale,updateAgeOnGet:r=this.updateAgeOnGet,noDeleteOnStaleGet:s=this.noDeleteOnStaleGet,ttl:n=this.ttl,noDisposeOnSet:i=this.noDisposeOnSet,size:o=0,sizeCalculation:a=this.sizeCalculation,noUpdateTTL:c=this.noUpdateTTL,noDeleteOnFetchRejection:u=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:l=this.allowStaleOnFetchRejection,ignoreFetchAbort:p=this.ignoreFetchAbort,allowStaleOnFetchAbort:d=this.allowStaleOnFetchAbort,fetchContext:h=this.fetchContext,forceRefresh:f=!1,status:g,signal:m}={}){if(!this.fetchMethod)return g&&(g.fetch="get"),this.get(e,{allowStale:t,updateAgeOnGet:r,noDeleteOnStaleGet:s,status:g});const _={allowStale:t,updateAgeOnGet:r,noDeleteOnStaleGet:s,ttl:n,noDisposeOnSet:i,size:o,sizeCalculation:a,noUpdateTTL:c,noDeleteOnFetchRejection:u,allowStaleOnFetchRejection:l,allowStaleOnFetchAbort:d,ignoreFetchAbort:p,status:g,signal:m};let y=this.keyMap.get(e);if(void 0===y){g&&(g.fetch="miss");const t=this.backgroundFetch(e,y,_,h);return t.__returned=t}{const s=this.valList[y];if(this.isBackgroundFetch(s)){const e=t&&void 0!==s.__staleWhileFetching;return g&&(g.fetch="inflight",e&&(g.returnedStale=!0)),e?s.__staleWhileFetching:s.__returned=s}const n=this.isStale(y);if(!f&&!n)return g&&(g.fetch="hit"),this.moveToTail(y),r&&this.updateItemAge(y),this.statusTTL(g,y),s;const i=this.backgroundFetch(e,y,_,h),o=void 0!==i.__staleWhileFetching,a=o&&t;return g&&(g.fetch=o&&n?"stale":"refresh",a&&n&&(g.returnedStale=!0)),a?i.__staleWhileFetching:i.__returned=i}}get(e,{allowStale:t=this.allowStale,updateAgeOnGet:r=this.updateAgeOnGet,noDeleteOnStaleGet:s=this.noDeleteOnStaleGet,status:n}={}){const i=this.keyMap.get(e);if(void 0!==i){const o=this.valList[i],a=this.isBackgroundFetch(o);return this.statusTTL(n,i),this.isStale(i)?(n&&(n.get="stale"),a?(n&&(n.returnedStale=t&&void 0!==o.__staleWhileFetching),t?o.__staleWhileFetching:void 0):(s||this.delete(e),n&&(n.returnedStale=t),t?o:void 0)):(n&&(n.get="hit"),a?o.__staleWhileFetching:(this.moveToTail(i),r&&this.updateItemAge(i),o))}n&&(n.get="miss")}connect(e,t){this.prev[t]=e,this.next[e]=t}moveToTail(e){e!==this.tail&&(e===this.head?this.head=this.next[e]:this.connect(this.prev[e],this.next[e]),this.connect(this.tail,e),this.tail=e)}get del(){return c("del","delete"),this.delete}delete(e){let t=!1;if(0!==this.size){const r=this.keyMap.get(e);if(void 0!==r)if(t=!0,1===this.size)this.clear();else{this.removeItemSize(r);const t=this.valList[r];this.isBackgroundFetch(t)?t.__abortController.abort(new Error("deleted")):(this.dispose(t,e,"delete"),this.disposeAfter&&this.disposed.push([t,e,"delete"])),this.keyMap.delete(e),this.keyList[r]=null,this.valList[r]=null,r===this.tail?this.tail=this.prev[r]:r===this.head?this.head=this.next[r]:(this.next[this.prev[r]]=this.next[r],this.prev[this.next[r]]=this.prev[r]),this.size--,this.free.push(r)}}if(this.disposed)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift());return t}clear(){for(const e of this.rindexes({allowStale:!0})){const t=this.valList[e];if(this.isBackgroundFetch(t))t.__abortController.abort(new Error("deleted"));else{const r=this.keyList[e];this.dispose(t,r,"delete"),this.disposeAfter&&this.disposed.push([t,r,"delete"])}}if(this.keyMap.clear(),this.valList.fill(null),this.keyList.fill(null),this.ttls&&(this.ttls.fill(0),this.starts.fill(0)),this.sizes&&this.sizes.fill(0),this.head=0,this.tail=0,this.initialFill=1,this.free.length=0,this.calculatedSize=0,this.size=0,this.disposed)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift())}get reset(){return c("reset","clear"),this.clear}get length(){return(e=>{const t=`LRU_CACHE_PROPERTY_${e}`;if(l(t)){const{prototype:r}=m,{get:s}=Object.getOwnPropertyDescriptor(r,e);p(t,`${e} property`,"cache.size",s)}})("length"),this.size}static get AbortController(){return r}static get AbortSignal(){return i}}e.exports=m},54028:function(e,t){"use strict";var r,s,n=this&&this.__classPrivateFieldGet||function(e,t,r,s){if("a"===r&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?s:"a"===r?s.call(e):s?s.value:t.get(e)};Object.defineProperty(t,"__esModule",{value:!0}),t.Profile=t.Function=t.Location=t.Line=t.Mapping=t.Sample=t.Label=t.ValueType=t.StringTable=t.emptyTableToken=void 0;const i=2n**32n-1n,o=2**32-1,a=o+1,c="undefined"==typeof Buffer?e=>(new TextEncoder).encode(e):e=>Buffer.from(e,"utf8");function u(e){if(!e.length)return 0;let t=0;for(;t<e.length&&e[t++]>=128;);return t}function l(e,t=0){return{value:e,offset:t}}function p(e,t){switch(e){case h:for(let e=0;e<t.length;e++)if(!(128&t[e]))return l(t.slice(0,e+1));return l(t);case f:{const e=u(t),r=g(t);return l(t.slice(e,Number(r)+e),e)}default:throw new Error(`Unrecognized value type: ${e}`)}}function d(e){const t=e<0;t&&(e=-e);let r=function(e){return"bigint"!=typeof e?(e>>>0)%a:Number(e&i)}(e),s=function(e){return"bigint"!=typeof e?e/a>>>0:Number(e>>32n&i)}(e);return t&&(s=~s>>>0,r=~r>>>0,++r>o&&(r=0,++s>o&&(s=0))),[s,r]}const h=0,f=2;function g(e){if(u(e)>4)return function(e){if(!e.length)return BigInt(0);let t=BigInt(127&e[0]),r=0;for(;e[r++]>=128;)t|=BigInt(127&e[r])<<BigInt(7*r);return t}(e);if(!e.length)return 0;let t=127&e[0],r=0;for(;e[r++]>=128;)t|=(127&e[r])<<7*r;return t}function m(e){const t=[];let r=0;for(let s=0;s<e.length;s++)128&e[s]||(t.push(g(e.slice(r,s+1))),r=s+1);return t}function _(e,t){return null==t?[e]:(t.push(e),t)}function y(e){if(0===e||0n===e)return 0;const[t,r]=d(e),s=(r>>>28|t<<4)>>>0,n=t>>>24;return 0!==n?n<128?9:10:0!==s?s<16384?s<128?5:6:s<2097152?7:8:r<16384?r<128?1:2:r<2097152?3:4}function b(e){return void 0===e?0:"number"==typeof e||"bigint"==typeof e?y(e)||1:e.length}function v(e){let t=0;for(const r of e)t+=b(r);return t}function E(e){const t=y(e);return t?1+t:0}function S(e){let t=0;for(const r of e)t+=y(r)||1;return t?1+y(t)+t:0}function T(e){const t=b(e);return t?1+y(t)+t:0}function w(e){let t=0;for(const r of e)t+=T(r);return t}function x(e,t,r){if(0===r||0n===r)return e[t++]=0,t;let[s,n]=d(r);for(;s;)e[t++]=127&n|128,n=(n>>>7|s<<25)>>>0,s>>>=7;for(;n>127;)e[t++]=127&n|128,n>>>=7;return e[t++]=n,t}t.emptyTableToken=Symbol();class A{constructor(e){this.strings=new Array,r.set(this,new Array),s.set(this,new Map),e!==t.emptyTableToken&&this.dedup("")}get encodedLength(){let e=0;for(const t of n(this,r,"f"))e+=t.length;return e}_encodeToBuffer(e,t){for(const s of n(this,r,"f"))e.set(s,t),t+=s.length;return t}encode(e=new Uint8Array(this.encodedLength)){return this._encodeToBuffer(e,0),e}static _encodeStringFromUtf8(e){const t=new Uint8Array(1+e.length+(y(e.length)||1));let r=0;return t[r++]=50,r=x(t,r,e.length),e.length>0&&t.set(e,r++),t}static _encodeString(e){return A._encodeStringFromUtf8(c(e))}dedup(e){if("number"==typeof e)return e;if(!n(this,s,"f").has(e)){const t=this.strings.push(e)-1;n(this,s,"f").set(e,t),n(this,r,"f").push(A._encodeString(e))}return n(this,s,"f").get(e)}_decodeString(e){const t=(new TextDecoder).decode(e);n(this,s,"f").set(t,this.strings.push(t)-1),n(this,r,"f").push(A._encodeStringFromUtf8(e))}}function I(e,t){const r={};let s=0;for(;s<e.length;){const n=e[s]>>3,i=7&e[s];s++;const{offset:o,value:a}=p(i,e.slice(s));s+=a.length+o,t(r,n,a)}return r}t.StringTable=A,r=new WeakMap,s=new WeakMap;class k{constructor(e){this.type=e.type||0,this.unit=e.unit||0}get length(){let e=0;return e+=E(this.type),e+=E(this.unit),e}_encodeToBuffer(e,t=0){return this.type&&(e[t++]=8,t=x(e,t,this.type)),this.unit&&(e[t++]=16,t=x(e,t,this.unit)),t}encode(e=new Uint8Array(this.length)){return this._encodeToBuffer(e,0),e}static decodeValue(e,t,r){switch(t){case 1:e.type=g(r);break;case 2:e.unit=g(r)}}static decode(e){return new this(I(e,this.decodeValue))}}t.ValueType=k;class O{constructor(e){this.key=e.key||0,this.str=e.str||0,this.num=e.num||0,this.numUnit=e.numUnit||0}get length(){let e=0;return e+=E(this.key),e+=E(this.str),e+=E(this.num),e+=E(this.numUnit),e}_encodeToBuffer(e,t=0){return this.key&&(e[t++]=8,t=x(e,t,this.key)),this.str&&(e[t++]=16,t=x(e,t,this.str)),this.num&&(e[t++]=24,t=x(e,t,this.num)),this.numUnit&&(e[t++]=32,t=x(e,t,this.numUnit)),t}encode(e=new Uint8Array(this.length)){return this._encodeToBuffer(e,0),e}static decodeValue(e,t,r){switch(t){case 1:e.key=g(r);break;case 2:e.str=g(r);break;case 3:e.num=g(r);break;case 4:e.numUnit=g(r)}}static decode(e){return new this(I(e,this.decodeValue))}}t.Label=O;class R{constructor(e){this.locationId=e.locationId||[],this.value=e.value||[],this.label=(e.label||[]).map((e=>new O(e)))}get length(){let e=0;return e+=S(this.locationId),e+=S(this.value),e+=w(this.label),e}_encodeToBuffer(e,t=0){if(this.locationId.length){e[t++]=10,t=x(e,t,v(this.locationId));for(const r of this.locationId)t=x(e,t,r)}if(this.value.length){e[t++]=18,t=x(e,t,v(this.value));for(const r of this.value)t=x(e,t,r)}for(const r of this.label)e[t++]=26,t=x(e,t,r.length),t=r._encodeToBuffer(e,t);return t}encode(e=new Uint8Array(this.length)){return this._encodeToBuffer(e,0),e}static decodeValue(e,t,r){switch(t){case 1:e.locationId=m(r);break;case 2:e.value=m(r);break;case 3:e.label=_(O.decode(r),e.label)}}static decode(e){return new this(I(e,this.decodeValue))}}t.Sample=R;class C{constructor(e){this.id=e.id||0,this.memoryStart=e.memoryStart||0,this.memoryLimit=e.memoryLimit||0,this.fileOffset=e.fileOffset||0,this.filename=e.filename||0,this.buildId=e.buildId||0,this.hasFunctions=!!e.hasFunctions,this.hasFilenames=!!e.hasFilenames,this.hasLineNumbers=!!e.hasLineNumbers,this.hasInlineFrames=!!e.hasInlineFrames}get length(){let e=0;return e+=E(this.id),e+=E(this.memoryStart),e+=E(this.memoryLimit),e+=E(this.fileOffset),e+=E(this.filename),e+=E(this.buildId),e+=E(this.hasFunctions?1:0),e+=E(this.hasFilenames?1:0),e+=E(this.hasLineNumbers?1:0),e+=E(this.hasInlineFrames?1:0),e}_encodeToBuffer(e,t=0){return this.id&&(e[t++]=8,t=x(e,t,this.id)),this.memoryStart&&(e[t++]=16,t=x(e,t,this.memoryStart)),this.memoryLimit&&(e[t++]=24,t=x(e,t,this.memoryLimit)),this.fileOffset&&(e[t++]=32,t=x(e,t,this.fileOffset)),this.filename&&(e[t++]=40,t=x(e,t,this.filename)),this.buildId&&(e[t++]=48,t=x(e,t,this.buildId)),this.hasFunctions&&(e[t++]=56,t=x(e,t,1)),this.hasFilenames&&(e[t++]=64,t=x(e,t,1)),this.hasLineNumbers&&(e[t++]=72,t=x(e,t,1)),this.hasInlineFrames&&(e[t++]=80,t=x(e,t,1)),t}encode(e=new Uint8Array(this.length)){return this._encodeToBuffer(e,0),e}static decodeValue(e,t,r){switch(t){case 1:e.id=g(r);break;case 2:e.memoryStart=g(r);break;case 3:e.memoryLimit=g(r);break;case 4:e.fileOffset=g(r);break;case 5:e.filename=g(r);break;case 6:e.buildId=g(r);break;case 7:e.hasFunctions=!!g(r);break;case 8:e.hasFilenames=!!g(r);break;case 9:e.hasLineNumbers=!!g(r);break;case 10:e.hasInlineFrames=!!g(r)}}static decode(e){return new this(I(e,this.decodeValue))}}t.Mapping=C;class N{constructor(e){this.functionId=e.functionId||0,this.line=e.line||0}get length(){let e=0;return e+=E(this.functionId),e+=E(this.line),e}_encodeToBuffer(e,t=0){return this.functionId&&(e[t++]=8,t=x(e,t,this.functionId)),this.line&&(e[t++]=16,t=x(e,t,this.line)),t}encode(e=new Uint8Array(this.length)){return this._encodeToBuffer(e,0),e}static decodeValue(e,t,r){switch(t){case 1:e.functionId=g(r);break;case 2:e.line=g(r)}}static decode(e){return new this(I(e,this.decodeValue))}}t.Line=N;class P{constructor(e){this.id=e.id||0,this.mappingId=e.mappingId||0,this.address=e.address||0,this.line=(e.line||[]).map((e=>new N(e))),this.isFolded=!!e.isFolded}get length(){let e=0;return e+=E(this.id),e+=E(this.mappingId),e+=E(this.address),e+=w(this.line),e+=E(this.isFolded?1:0),e}_encodeToBuffer(e,t=0){this.id&&(e[t++]=8,t=x(e,t,this.id)),this.mappingId&&(e[t++]=16,t=x(e,t,this.mappingId)),this.address&&(e[t++]=24,t=x(e,t,this.address));for(const r of this.line)e[t++]=34,t=x(e,t,r.length),t=r._encodeToBuffer(e,t);return this.isFolded&&(e[t++]=40,t=x(e,t,1)),t}encode(e=new Uint8Array(this.length)){return this._encodeToBuffer(e,0),e}static decodeValue(e,t,r){switch(t){case 1:e.id=g(r);break;case 2:e.mappingId=g(r);break;case 3:e.address=g(r);break;case 4:e.line=_(N.decode(r),e.line);break;case 5:e.isFolded=!!g(r)}}static decode(e){return new this(I(e,this.decodeValue))}}t.Location=P;class D{constructor(e){this.id=e.id||0,this.name=e.name||0,this.systemName=e.systemName||0,this.filename=e.filename||0,this.startLine=e.startLine||0}get length(){let e=0;return e+=E(this.id),e+=E(this.name),e+=E(this.systemName),e+=E(this.filename),e+=E(this.startLine),e}_encodeToBuffer(e,t=0){return this.id&&(e[t++]=8,t=x(e,t,this.id)),this.name&&(e[t++]=16,t=x(e,t,this.name)),this.systemName&&(e[t++]=24,t=x(e,t,this.systemName)),this.filename&&(e[t++]=32,t=x(e,t,this.filename)),this.startLine&&(e[t++]=40,t=x(e,t,this.startLine)),t}encode(e=new Uint8Array(this.length)){return this._encodeToBuffer(e,0),e}static decodeValue(e,t,r){switch(t){case 1:e.id=g(r);break;case 2:e.name=g(r);break;case 3:e.systemName=g(r);break;case 4:e.filename=g(r);break;case 5:e.startLine=g(r)}}static decode(e){return new this(I(e,this.decodeValue))}}t.Function=D,t.Profile=class{constructor(e={}){this.sampleType=(e.sampleType||[]).map((e=>new k(e))),this.sample=(e.sample||[]).map((e=>new R(e))),this.mapping=(e.mapping||[]).map((e=>new C(e))),this.location=(e.location||[]).map((e=>new P(e))),this.function=(e.function||[]).map((e=>new D(e))),this.stringTable=e.stringTable||new A,this.dropFrames=e.dropFrames||0,this.keepFrames=e.keepFrames||0,this.timeNanos=e.timeNanos||0,this.durationNanos=e.durationNanos||0,this.periodType=e.periodType?new k(e.periodType):void 0,this.period=e.period||0,this.comment=e.comment||[],this.defaultSampleType=e.defaultSampleType||0}get length(){let e=0;return e+=w(this.sampleType),e+=w(this.sample),e+=w(this.mapping),e+=w(this.location),e+=w(this.function),e+=this.stringTable.encodedLength,e+=E(this.dropFrames),e+=E(this.keepFrames),e+=E(this.timeNanos),e+=E(this.durationNanos),e+=T(this.periodType),e+=E(this.period),e+=S(this.comment),e+=E(this.defaultSampleType),e}_encodeSampleTypesToBuffer(e,t=0){for(const r of this.sampleType)e[t++]=10,t=x(e,t,r.length),t=r._encodeToBuffer(e,t);return t}_encodeSamplesToBuffer(e,t=0){for(const r of this.sample)e[t++]=18,t=x(e,t,r.length),t=r._encodeToBuffer(e,t);return t}_encodeMappingsToBuffer(e,t=0){for(const r of this.mapping)e[t++]=26,t=x(e,t,r.length),t=r._encodeToBuffer(e,t);return t}_encodeLocationsToBuffer(e,t=0){for(const r of this.location)e[t++]=34,t=x(e,t,r.length),t=r._encodeToBuffer(e,t);return t}_encodeFunctionsToBuffer(e,t=0){for(const r of this.function)e[t++]=42,t=x(e,t,r.length),t=r._encodeToBuffer(e,t);return t}_encodeBasicValuesToBuffer(e,t=0){if(this.dropFrames&&(e[t++]=56,t=x(e,t,this.dropFrames)),this.keepFrames&&(e[t++]=64,t=x(e,t,this.keepFrames)),this.timeNanos&&(e[t++]=72,t=x(e,t,this.timeNanos)),this.durationNanos&&(e[t++]=80,t=x(e,t,this.durationNanos)),void 0!==this.periodType&&(e[t++]=90,t=x(e,t,this.periodType.length),t=this.periodType._encodeToBuffer(e,t)),this.period&&(e[t++]=96,t=x(e,t,this.period)),this.comment.length){e[t++]=106,t=x(e,t,v(this.comment));for(const r of this.comment)t=x(e,t,r)}return this.defaultSampleType&&(e[t++]=112,t=x(e,t,this.defaultSampleType)),t}_encodeToBuffer(e,t=0){return t=this._encodeSampleTypesToBuffer(e,t),t=this._encodeSamplesToBuffer(e,t),t=this._encodeMappingsToBuffer(e,t),t=this._encodeLocationsToBuffer(e,t),t=this._encodeFunctionsToBuffer(e,t),t=this.stringTable._encodeToBuffer(e,t),this._encodeBasicValuesToBuffer(e,t)}async _encodeToBufferAsync(e,t=0){return t=this._encodeSampleTypesToBuffer(e,t),await new Promise(setImmediate),t=this._encodeSamplesToBuffer(e,t),await new Promise(setImmediate),t=this._encodeMappingsToBuffer(e,t),await new Promise(setImmediate),t=this._encodeLocationsToBuffer(e,t),await new Promise(setImmediate),t=this._encodeFunctionsToBuffer(e,t),await new Promise(setImmediate),t=this.stringTable._encodeToBuffer(e,t),await new Promise(setImmediate),this._encodeBasicValuesToBuffer(e,t)}encode(e=new Uint8Array(this.length)){return this._encodeToBuffer(e,0),e}async encodeAsync(e=new Uint8Array(this.length)){return await this._encodeToBufferAsync(e,0),e}static decodeValue(e,r,s){switch(r){case 1:e.sampleType=_(k.decode(s),e.sampleType);break;case 2:e.sample=_(R.decode(s),e.sample);break;case 3:e.mapping=_(C.decode(s),e.mapping);break;case 4:e.location=_(P.decode(s),e.location);break;case 5:e.function=_(D.decode(s),e.function);break;case 6:void 0===e.stringTable&&(e.stringTable=new A(t.emptyTableToken)),e.stringTable._decodeString(s);break;case 7:e.dropFrames=g(s);break;case 8:e.keepFrames=g(s);break;case 9:e.timeNanos=g(s);break;case 10:e.durationNanos=g(s);break;case 11:e.periodType=k.decode(s);break;case 12:e.period=g(s);break;case 13:e.comment=m(s);break;case 14:e.defaultSampleType=g(s)}}static decode(e){return new this(I(e,this.decodeValue))}}},48652:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$asyncIterator:()=>g,$$iterator:()=>i,createAsyncIterator:()=>b,createIterator:()=>p,forAwaitEach:()=>S,forEach:()=>h,getAsyncIterator:()=>_,getAsyncIteratorMethod:()=>y,getIterator:()=>u,getIteratorMethod:()=>l,isArrayLike:()=>a,isAsyncIterable:()=>m,isCollection:()=>c,isIterable:()=>o});var s="function"==typeof Symbol?Symbol:void 0,n=s&&s.iterator,i=n||"@@iterator";function o(e){return!!l(e)}function a(e){var t=null!=e&&e.length;return"number"==typeof t&&t>=0&&t%1==0}function c(e){return Object(e)===e&&(a(e)||o(e))}function u(e){var t=l(e);if(t)return t.call(e)}function l(e){if(null!=e){var t=n&&e[n]||e["@@iterator"];if("function"==typeof t)return t}}function p(e){if(null!=e){var t=u(e);if(t)return t;if(a(e))return new d(e)}}function d(e){this._o=e,this._i=0}function h(e,t,r){if(null!=e){if("function"==typeof e.forEach)return e.forEach(t,r);var s=0,n=u(e);if(n){for(var i;!(i=n.next()).done;)if(t.call(r,i.value,s++,e),s>9999999)throw new TypeError("Near-infinite iteration.")}else if(a(e))for(;s<e.length;s++)e.hasOwnProperty(s)&&t.call(r,e[s],s,e)}}d.prototype[i]=function(){return this},d.prototype.next=function(){return void 0===this._o||this._i>=this._o.length?(this._o=void 0,{value:void 0,done:!0}):{value:this._o[this._i++],done:!1}};var f=s&&s.asyncIterator,g=f||"@@asyncIterator";function m(e){return!!y(e)}function _(e){var t=y(e);if(t)return t.call(e)}function y(e){if(null!=e){var t=f&&e[f]||e["@@asyncIterator"];if("function"==typeof t)return t}}function b(e){if(null!=e){var t=_(e);if(t)return t;var r=p(e);if(r)return new v(r)}}function v(e){this._i=e}function E(e,t,r){var s;return new Promise((function(n){n((s=e[t](r)).value)})).then((function(e){return{value:e,done:s.done}}))}function S(e,t,r){var s=b(e);if(s){var n=0;return new Promise((function(i,o){!function a(){return s.next().then((function(s){return s.done?i():Promise.resolve(t.call(r,s.value,n++,e)).then(a).catch(o),null})).catch(o),null}()}))}}v.prototype[g]=function(){return this},v.prototype.next=function(e){return E(this._i,"next",e)},v.prototype.return=function(e){return this._i.return?E(this._i,"return",e):Promise.resolve({value:e,done:!0})},v.prototype.throw=function(e){return this._i.throw?E(this._i,"throw",e):Promise.reject(e)}},8330:e=>{"use strict";e.exports=JSON.parse('{"name":"dd-trace","version":"6.0.0-pre","description":"Datadog APM tracing client for JavaScript","main":"dist/dd-trace.bundle.js","typings":"index.d.ts","scripts":{"env":"bash ./plugin-env","preinstall":"node scripts/preinstall.js","bench":"node benchmark","bench:e2e":"SERVICES=mongo yarn services && cd benchmark/e2e && node benchmark-run.js --duration=30","bench:e2e:ci-visibility":"node benchmark/e2e-ci/benchmark-run.js","type:doc":"cd docs && yarn && yarn build","type:test":"cd docs && yarn && yarn test","lint":"node scripts/check_licenses.js && eslint . && yarn audit","lint-fix":"node scripts/check_licenses.js && eslint . --fix && yarn audit","release:proposal":"node scripts/release/proposal","services":"node ./scripts/install_plugin_modules && node packages/dd-trace/test/setup/services","test":"SERVICES=* yarn services && mocha --expose-gc \'packages/dd-trace/test/setup/node.js\' \'packages/*/test/**/*.spec.js\'","test:appsec":"mocha -r \\"packages/dd-trace/test/setup/mocha.js\\" --exclude \\"packages/dd-trace/test/appsec/**/*.plugin.spec.js\\" \\"packages/dd-trace/test/appsec/**/*.spec.js\\"","test:appsec:ci":"nyc --no-clean --include \\"packages/dd-trace/src/appsec/**/*.js\\" --exclude \\"packages/dd-trace/test/appsec/**/*.plugin.spec.js\\" -- npm run test:appsec","test:appsec:plugins":"mocha -r \\"packages/dd-trace/test/setup/mocha.js\\" \\"packages/dd-trace/test/appsec/**/*.@($(echo $PLUGINS)).plugin.spec.js\\"","test:appsec:plugins:ci":"yarn services && nyc --no-clean --include \\"packages/dd-trace/src/appsec/**/*.js\\" -- npm run test:appsec:plugins","test:debugger":"mocha -r \'packages/dd-trace/test/setup/mocha.js\' \'packages/dd-trace/test/debugger/**/*.spec.js\'","test:debugger:ci":"nyc --no-clean --include \'packages/dd-trace/src/debugger/**/*.js\' -- npm run test:debugger","test:trace:core":"tap packages/dd-trace/test/*.spec.js \\"packages/dd-trace/test/{ci-visibility,datastreams,encode,exporters,opentelemetry,opentracing,plugins,service-naming,telemetry}/**/*.spec.js\\"","test:trace:core:ci":"npm run test:trace:core -- --coverage --nyc-arg=--include=\\"packages/dd-trace/src/**/*.js\\"","test:instrumentations":"mocha -r \'packages/dd-trace/test/setup/mocha.js\' \'packages/datadog-instrumentations/test/**/*.spec.js\'","test:instrumentations:ci":"nyc --no-clean --include \'packages/datadog-instrumentations/src/**/*.js\' -- npm run test:instrumentations","test:core":"tap \\"packages/datadog-core/test/**/*.spec.js\\"","test:core:ci":"npm run test:core -- --coverage --nyc-arg=--include=\\"packages/datadog-core/src/**/*.js\\"","test:lambda":"mocha -r \\"packages/dd-trace/test/setup/mocha.js\\" \\"packages/dd-trace/test/lambda/**/*.spec.js\\"","test:lambda:ci":"nyc --no-clean --include \\"packages/dd-trace/src/lambda/**/*.js\\" -- npm run test:lambda","test:llmobs:sdk":"mocha -r \\"packages/dd-trace/test/setup/mocha.js\\" --exclude \\"packages/dd-trace/test/llmobs/plugins/**/*.spec.js\\" \\"packages/dd-trace/test/llmobs/**/*.spec.js\\" ","test:llmobs:sdk:ci":"nyc --no-clean --include \\"packages/dd-trace/src/llmobs/**/*.js\\" -- npm run test:llmobs:sdk","test:llmobs:plugins":"mocha -r \\"packages/dd-trace/test/setup/mocha.js\\" \\"packages/dd-trace/test/llmobs/plugins/@($(echo $PLUGINS))/*.spec.js\\"","test:llmobs:plugins:ci":"yarn services && nyc --no-clean --include \\"packages/dd-trace/src/llmobs/**/*.js\\" -- npm run test:llmobs:plugins","test:plugins":"mocha -r \\"packages/dd-trace/test/setup/mocha.js\\" \\"packages/datadog-instrumentations/test/@($(echo $PLUGINS)).spec.js\\" \\"packages/datadog-plugin-@($(echo $PLUGINS))/test/**/*.spec.js\\"","test:plugins:ci":"yarn services && nyc --no-clean --include \\"packages/datadog-instrumentations/src/@($(echo $PLUGINS)).js\\" --include \\"packages/datadog-instrumentations/src/@($(echo $PLUGINS))/**/*.js\\" --include \\"packages/datadog-plugin-@($(echo $PLUGINS))/src/**/*.js\\" -- npm run test:plugins","test:plugins:upstream":"node ./packages/dd-trace/test/plugins/suite.js","test:profiler":"tap \\"packages/dd-trace/test/profiling/**/*.spec.js\\"","test:profiler:ci":"npm run test:profiler -- --coverage --nyc-arg=--include=\\"packages/dd-trace/src/profiling/**/*.js\\"","test:integration":"mocha --timeout 60000 -r \\"packages/dd-trace/test/setup/core.js\\" \\"integration-tests/*.spec.js\\"","test:integration:appsec":"mocha --timeout 60000 -r \\"packages/dd-trace/test/setup/core.js\\" \\"integration-tests/appsec/*.spec.js\\"","test:integration:cucumber":"mocha --timeout 60000 -r \\"packages/dd-trace/test/setup/core.js\\" \\"integration-tests/cucumber/*.spec.js\\"","test:integration:cypress":"mocha --timeout 60000 -r \\"packages/dd-trace/test/setup/core.js\\" \\"integration-tests/cypress/*.spec.js\\"","test:integration:debugger":"mocha --timeout 60000 -r \\"packages/dd-trace/test/setup/core.js\\" \\"integration-tests/debugger/*.spec.js\\"","test:integration:jest":"mocha --timeout 60000 -r \\"packages/dd-trace/test/setup/core.js\\" \\"integration-tests/jest/*.spec.js\\"","test:integration:mocha":"mocha --timeout 60000 -r \\"packages/dd-trace/test/setup/core.js\\" \\"integration-tests/mocha/*.spec.js\\"","test:integration:playwright":"mocha --timeout 60000 -r \\"packages/dd-trace/test/setup/core.js\\" \\"integration-tests/playwright/*.spec.js\\"","test:integration:selenium":"mocha --timeout 60000 -r \\"packages/dd-trace/test/setup/core.js\\" \\"integration-tests/selenium/*.spec.js\\"","test:integration:vitest":"mocha --timeout 60000 -r \\"packages/dd-trace/test/setup/core.js\\" \\"integration-tests/vitest/*.spec.js\\"","test:integration:profiler":"mocha --timeout 180000 -r \\"packages/dd-trace/test/setup/core.js\\" \\"integration-tests/profiler/*.spec.js\\"","test:integration:serverless":"mocha --timeout 60000 -r \\"packages/dd-trace/test/setup/core.js\\" \\"integration-tests/serverless/*.spec.js\\"","test:integration:plugins":"mocha -r \\"packages/dd-trace/test/setup/mocha.js\\" \\"packages/datadog-plugin-@($(echo $PLUGINS))/test/integration-test/**/*.spec.js\\"","test:unit:plugins":"mocha -r \\"packages/dd-trace/test/setup/mocha.js\\" \\"packages/datadog-instrumentations/test/@($(echo $PLUGINS)).spec.js\\" \\"packages/datadog-plugin-@($(echo $PLUGINS))/test/**/*.spec.js\\" --exclude \\"packages/datadog-plugin-@($(echo $PLUGINS))/test/integration-test/**/*.spec.js\\"","test:shimmer":"mocha \'packages/datadog-shimmer/test/**/*.spec.js\'","test:shimmer:ci":"nyc --no-clean --include \'packages/datadog-shimmer/src/**/*.js\' -- npm run test:shimmer"},"repository":{"type":"git","url":"git+https://github.com/DataDog/dd-trace-js.git"},"keywords":["datadog","trace","tracing","profile","profiler","profiling","opentracing","apm"],"author":"Datadog Inc. <info@datadoghq.com>","license":"(Apache-2.0 OR BSD-3-Clause)","bugs":{"url":"https://github.com/DataDog/dd-trace-js/issues"},"homepage":"https://github.com/DataDog/dd-trace-js#readme","engines":{"node":">=18"},"dependencies":{"@datadog/libdatadog":"^0.4.0","@datadog/native-appsec":"8.4.0","@datadog/native-iast-rewriter":"2.8.0","@datadog/native-iast-taint-tracking":"3.2.0","@datadog/native-metrics":"^3.1.0","@datadog/pprof":"5.5.1","@datadog/sketches-js":"^2.1.0","@isaacs/ttlcache":"^1.4.1","@opentelemetry/api":">=1.0.0 <1.9.0","@opentelemetry/core":"^1.14.0","crypto-randomuuid":"^1.0.0","dc-polyfill":"^0.1.4","ignore":"^5.2.4","import-in-the-middle":"1.11.2","istanbul-lib-coverage":"3.2.0","jest-docblock":"^29.7.0","koalas":"^1.0.2","limiter":"1.1.5","lodash.sortby":"^4.7.0","lru-cache":"^7.14.0","module-details-from-path":"^1.0.3","opentracing":">=0.12.1","path-to-regexp":"^0.1.12","pprof-format":"^2.1.0","protobufjs":"^7.2.5","retry":"^0.13.1","rfdc":"^1.3.1","semver":"^7.5.4","shell-quote":"^1.8.1","source-map":"^0.7.4","tlhunter-sorted-set":"^0.1.0","ttl-set":"^1.0.0"},"devDependencies":{"@apollo/server":"^4.11.0","@eslint/eslintrc":"^3.1.0","@eslint/js":"^9.11.1","@msgpack/msgpack":"^3.0.0-beta3","@stylistic/eslint-plugin-js":"^2.8.0","@types/node":"^16.0.0","autocannon":"^4.5.2","aws-sdk":"^2.1446.0","axios":"^1.7.4","benchmark":"^2.1.4","body-parser":"^1.20.3","chai":"^4.3.7","chalk":"^5.3.0","checksum":"^1.0.0","cli-table3":"^0.6.3","dotenv":"16.3.1","esbuild":"0.16.12","eslint":"^8.57.0","eslint-config-standard":"^17.1.0","eslint-plugin-import":"^2.29.1","eslint-plugin-mocha":"^10.4.3","eslint-plugin-n":"^16.6.2","eslint-plugin-promise":"^6.4.0","express":"^4.21.2","get-port":"^3.2.0","glob":"^7.1.6","globals":"^15.10.0","graphql":"0.13.2","jszip":"^3.5.0","knex":"^2.4.2","mkdirp":"^3.0.1","mocha":"^10","multer":"^1.4.5-lts.1","nock":"^11.3.3","nyc":"^15.1.0","proxyquire":"^1.8.0","rimraf":"^3.0.0","sinon":"^16.1.3","sinon-chai":"^3.7.0","tap":"^16.3.7","tiktoken":"^1.0.15","webpack":"^5.97.1","yaml":"^2.5.0"}}')},90542:e=>{"use strict";e.exports=JSON.parse('{"version":"2.2","metadata":{"rules_version":"1.13.3"},"rules":[{"id":"blk-001-001","name":"Block IP Addresses","tags":{"type":"block_ip","category":"security_response","module":"network-acl"},"conditions":[{"parameters":{"inputs":[{"address":"http.client_ip"}],"data":"blocked_ips"},"operator":"ip_match"}],"transformers":[],"on_match":["block"]},{"id":"blk-001-002","name":"Block User Addresses","tags":{"type":"block_user","category":"security_response","module":"authentication-acl"},"conditions":[{"parameters":{"inputs":[{"address":"usr.id"}],"data":"blocked_users"},"operator":"exact_match"}],"transformers":[],"on_match":["block"]},{"id":"crs-913-110","name":"Acunetix","tags":{"type":"commercial_scanner","crs_id":"913110","category":"attack_attempt","tool_name":"Acunetix","cwe":"200","capec":"1000/118/169","confidence":"0","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies"}],"list":["acunetix-product","(acunetix web vulnerability scanner","acunetix-scanning-agreement","acunetix-user-agreement","md5(acunetix_wvs_security_test)"]},"operator":"phrase_match"}],"transformers":["lowercase"]},{"id":"crs-913-120","name":"Known security scanner filename/argument","tags":{"type":"security_scanner","crs_id":"913120","category":"attack_attempt","cwe":"200","capec":"1000/118/169","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"list":["/.adsensepostnottherenonobook","/<invalid>hello.html","/actsensepostnottherenonotive","/acunetix-wvs-test-for-some-inexistent-file","/antidisestablishmentarianism","/appscan_fingerprint/mac_address","/arachni-","/cybercop","/nessus_is_probing_you_","/nessustest","/netsparker-","/rfiinc.txt","/thereisnowaythat-you-canbethere","/w3af/remotefileinclude.html","appscan_fingerprint","w00tw00t.at.isc.sans.dfind","w00tw00t.at.blackhats.romanian.anti-sec"],"options":{"enforce_word_boundary":true}},"operator":"phrase_match"}],"transformers":["lowercase"]},{"id":"crs-920-260","name":"Unicode Full/Half Width Abuse Attack Attempt","tags":{"type":"http_protocol_violation","crs_id":"920260","category":"attack_attempt","cwe":"176","capec":"1000/255/153/267/71","confidence":"0","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.uri.raw"}],"regex":"\\\\%u[fF]{2}[0-9a-fA-F]{2}","options":{"case_sensitive":true,"min_length":6}},"operator":"match_regex"}],"transformers":[]},{"id":"crs-921-110","name":"HTTP Request Smuggling Attack","tags":{"type":"http_protocol_violation","crs_id":"921110","category":"attack_attempt","cwe":"444","capec":"1000/210/272/220/33","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"}],"regex":"(?:get|post|head|options|connect|put|delete|trace|track|patch|propfind|propatch|mkcol|copy|move|lock|unlock)\\\\s+[^\\\\s]+\\\\s+http/\\\\d","options":{"case_sensitive":true,"min_length":12}},"operator":"match_regex"}],"transformers":["lowercase"]},{"id":"crs-921-160","name":"HTTP Header Injection Attack via payload (CR/LF and header-name detected)","tags":{"type":"http_protocol_violation","crs_id":"921160","category":"attack_attempt","cwe":"113","capec":"1000/210/272/220/105","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.path_params"}],"regex":"[\\\\n\\\\r]+(?:refresh|(?:set-)?cookie|(?:x-)?(?:forwarded-(?:for|host|server)|via|remote-ip|remote-addr|originating-IP))\\\\s*:","options":{"case_sensitive":true,"min_length":3}},"operator":"match_regex"}],"transformers":["lowercase"]},{"id":"crs-930-100","name":"Obfuscated Path Traversal Attack (/../)","tags":{"type":"lfi","crs_id":"930100","category":"attack_attempt","cwe":"22","capec":"1000/255/153/126","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.uri.raw"},{"address":"server.request.headers.no_cookies"}],"regex":"(?:%(?:c(?:0%(?:[2aq]f|5c|9v)|1%(?:[19p]c|8s|af))|2(?:5(?:c(?:0%25af|1%259c)|2f|5c)|%46|f)|(?:(?:f(?:8%8)?0%8|e)0%80%a|bg%q)f|%3(?:2(?:%(?:%6|4)6|F)|5%%63)|u(?:221[56]|002f|EFC8|F025)|1u|5c)|0x(?:2f|5c)|\\\\/|\\\\x5c)(?:%(?:(?:f(?:(?:c%80|8)%8)?0%8|e)0%80%ae|2(?:(?:5(?:c0%25a|2))?e|%45)|u(?:(?:002|ff0)e|2024)|%32(?:%(?:%6|4)5|E)|c0(?:%[256aef]e|\\\\.))|\\\\.(?:%0[01])?|0x2e){2,3}(?:%(?:c(?:0%(?:[2aq]f|5c|9v)|1%(?:[19p]c|8s|af))|2(?:5(?:c(?:0%25af|1%259c)|2f|5c)|%46|f)|(?:(?:f(?:8%8)?0%8|e)0%80%a|bg%q)f|%3(?:2(?:%(?:%6|4)6|F)|5%%63)|u(?:221[56]|002f|EFC8|F025)|1u|5c)|0x(?:2f|5c)|\\\\/|\\\\x5c)","options":{"min_length":4}},"operator":"match_regex"}],"transformers":["normalizePath"]},{"id":"crs-930-110","name":"Simple Path Traversal Attack (/../)","tags":{"type":"lfi","crs_id":"930110","category":"attack_attempt","cwe":"22","capec":"1000/255/153/126","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.uri.raw"},{"address":"server.request.headers.no_cookies"}],"regex":"(?:(?:^|[\\\\x5c/])\\\\.{2,3}[\\\\x5c/]|[\\\\x5c/]\\\\.{2,3}(?:[\\\\x5c/]|$))","options":{"case_sensitive":true,"min_length":3}},"operator":"match_regex"}],"transformers":["removeNulls"]},{"id":"crs-930-120","name":"OS File Access Attempt","tags":{"type":"lfi","crs_id":"930120","category":"attack_attempt","cwe":"22","capec":"1000/255/153/126","confidence":"1"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"list":["/.htaccess","/.htdigest","/.htpasswd","/.addressbook","/.aptitude/config",".aws/config",".aws/credentials","/.bash_config","/.bash_history","/.bash_logout","/.bash_profile","/.bashrc",".cache/notify-osd.log",".config/odesk/odesk team.conf","/.cshrc","/.dockerignore",".drush/","/.eslintignore","/.fbcindex","/.forward","/.git",".git/","/.gitattributes","/.gitconfig",".gnupg/",".hplip/hplip.conf","/.ksh_history","/.lesshst",".lftp/","/.lhistory","/.lldb-history",".local/share/mc/","/.lynx_cookies","/.my.cnf","/.mysql_history","/.nano_history","/.node_repl_history","/.pearrc","/.pgpass","/.php_history","/.pinerc",".pki/","/.proclog","/.procmailrc","/.psql_history","/.python_history","/.rediscli_history","/.rhistory","/.rhosts","/.sh_history","/.sqlite_history",".ssh/authorized_keys",".ssh/config",".ssh/id_dsa",".ssh/id_dsa.pub",".ssh/id_rsa",".ssh/id_rsa.pub",".ssh/identity",".ssh/identity.pub",".ssh/id_ecdsa",".ssh/id_ecdsa.pub",".ssh/known_hosts",".subversion/auth",".subversion/config",".subversion/servers",".tconn/tconn.conf","/.tcshrc",".vidalia/vidalia.conf","/.viminfo","/.vimrc","/.www_acl","/.wwwacl","/.xauthority","/.zhistory","/.zshrc","/.zsh_history","/.nsconfig","data/elasticsearch","data/kafka","etc/ansible","etc/bind","etc/centos-release","etc/centos-release-upstream","etc/clam.d","etc/elasticsearch","etc/freshclam.conf","etc/gshadow","etc/gshadow-","etc/httpd","etc/kafka","etc/kibana","etc/logstash","etc/lvm","etc/mongod.conf","etc/my.cnf","etc/nuxeo.conf","etc/pki","etc/postfix","etc/scw-release","etc/subgid","etc/subgid-","etc/sudoers.d","etc/sysconfig","etc/system-release-cpe","opt/nuxeo","opt/tomcat","tmp/kafka-logs","usr/lib/rpm/rpm.log","var/data/elasticsearch","var/lib/elasticsearch","etc/.java","etc/acpi","etc/alsa","etc/alternatives","etc/apache2","etc/apm","etc/apparmor","etc/apparmor.d","etc/apport","etc/apt","etc/asciidoc","etc/avahi","etc/bash_completion.d","etc/binfmt.d","etc/bluetooth","etc/bonobo-activation","etc/brltty","etc/ca-certificates","etc/calendar","etc/chatscripts","etc/chromium-browser","etc/clamav","etc/cni","etc/console-setup","etc/coraza-waf","etc/cracklib","etc/cron.d","etc/cron.daily","etc/cron.hourly","etc/cron.monthly","etc/cron.weekly","etc/cups","etc/cups.save","etc/cupshelpers","etc/dbus-1","etc/dconf","etc/default","etc/depmod.d","etc/dhcp","etc/dictionaries-common","etc/dkms","etc/dnsmasq.d","etc/dockeretc/dpkg","etc/emacs","etc/environment.d","etc/fail2ban","etc/firebird","etc/firefox","etc/fonts","etc/fwupd","etc/gconf","etc/gdb","etc/gdm3","etc/geoclue","etc/ghostscript","etc/gimp","etc/glvnd","etc/gnome","etc/gnome-vfs-2.0","etc/gnucash","etc/gnustep","etc/groff","etc/grub.d","etc/gss","etc/gtk-2.0","etc/gtk-3.0","etc/hp","etc/ifplugd","etc/imagemagick-6","etc/init","etc/init.d","etc/initramfs-tools","etc/insserv.conf.d","etc/iproute2","etc/iptables","etc/java","etc/java-11-openjdk","etc/java-17-oracle","etc/java-8-openjdk","etc/kernel","etc/ld.so.conf.d","etc/ldap","etc/libblockdev","etc/libibverbs.d","etc/libnl-3","etc/libpaper.d","etc/libreoffice","etc/lighttpd","etc/logcheck","etc/logrotate.d","etc/lynx","etc/mail","etc/mc","etc/menu","etc/menu-methods","etc/modprobe.d","etc/modsecurity","etc/modules-load.d","etc/monit","etc/mono","etc/mplayer","etc/mpv","etc/muttrc.d","etc/mysql","etc/netplan","etc/network","etc/networkd-dispatcher","etc/networkmanager","etc/newt","etc/nghttpx","etc/nikto","etc/odbcdatasources","etc/openal","etc/openmpi","etc/opt","etc/osync","etc/packagekit","etc/pam.d","etc/pcmcia","etc/perl","etc/php","etc/pki","etc/pm","etc/polkit-1","etc/postfix","etc/ppp","etc/profile.d","etc/proftpd","etc/pulse","etc/python","etc/rc0.d","etc/rc1.d","etc/rc2.d","etc/rc3.d","etc/rc4.d","etc/rc5.d","etc/rc6.d","etc/rcs.d","etc/resolvconf","etc/rsyslog.d","etc/samba","etc/sane.d","etc/security","etc/selinux","etc/sensors.d","etc/sgml","etc/signon-ui","etc/skel","etc/snmp","etc/sound","etc/spamassassin","etc/speech-dispatcher","etc/ssh","etc/ssl","etc/sudoers.d","etc/sysctl.d","etc/sysstat","etc/systemd","etc/terminfo","etc/texmf","etc/thermald","etc/thnuclnt","etc/thunderbird","etc/timidity","etc/tmpfiles.d","etc/ubuntu-advantage","etc/udev","etc/udisks2","etc/ufw","etc/update-manager","etc/update-motd.d","etc/update-notifier","etc/upower","etc/urlview","etc/usb_modeswitch.d","etc/vim","etc/vmware","etc/vmware-installer","etc/vmware-vix","etc/vulkan","etc/w3m","etc/wireshark","etc/wpa_supplicant","etc/x11","etc/xdg","etc/xml","etc/redis.conf","etc/redis-sentinel.conf","etc/php.ini","bin/php.ini","etc/httpd/php.ini","usr/lib/php.ini","usr/lib/php/php.ini","usr/local/etc/php.ini","usr/local/lib/php.ini","usr/local/php/lib/php.ini","usr/local/php4/lib/php.ini","usr/local/php5/lib/php.ini","usr/local/apache/conf/php.ini","etc/php4.4/fcgi/php.ini","etc/php4/apache/php.ini","etc/php4/apache2/php.ini","etc/php5/apache/php.ini","etc/php5/apache2/php.ini","etc/php/php.ini","etc/php/php4/php.ini","etc/php/apache/php.ini","etc/php/apache2/php.ini","web/conf/php.ini","usr/local/zend/etc/php.ini","opt/xampp/etc/php.ini","var/local/www/conf/php.ini","etc/php/cgi/php.ini","etc/php4/cgi/php.ini","etc/php5/cgi/php.ini","home2/bin/stable/apache/php.ini","home/bin/stable/apache/php.ini","etc/httpd/conf.d/php.conf","php5/php.ini","php4/php.ini","php/php.ini","windows/php.ini","winnt/php.ini","apache/php/php.ini","xampp/apache/bin/php.ini","netserver/bin/stable/apache/php.ini","volumes/macintosh_hd1/usr/local/php/lib/php.ini","etc/mono/1.0/machine.config","etc/mono/2.0/machine.config","etc/mono/2.0/web.config","etc/mono/config","usr/local/cpanel/logs/stats_log","usr/local/cpanel/logs/access_log","usr/local/cpanel/logs/error_log","usr/local/cpanel/logs/license_log","usr/local/cpanel/logs/login_log","var/cpanel/cpanel.config","usr/local/psa/admin/logs/httpsd_access_log","usr/local/psa/admin/logs/panel.log","usr/local/psa/admin/conf/php.ini","etc/sw-cp-server/applications.d/plesk.conf","usr/local/psa/admin/conf/site_isolation_settings.ini","usr/local/sb/config","etc/sw-cp-server/applications.d/00-sso-cpserver.conf","etc/sso/sso_config.ini","etc/mysql/conf.d/old_passwords.cnf","var/mysql.log","var/mysql-bin.index","var/data/mysql-bin.index","program files/mysql/mysql server 5.0/data/{host}.err","program files/mysql/mysql server 5.0/data/mysql.log","program files/mysql/mysql server 5.0/data/mysql.err","program files/mysql/mysql server 5.0/data/mysql-bin.log","program files/mysql/mysql server 5.0/data/mysql-bin.index","program files/mysql/data/{host}.err","program files/mysql/data/mysql.log","program files/mysql/data/mysql.err","program files/mysql/data/mysql-bin.log","program files/mysql/data/mysql-bin.index","mysql/data/{host}.err","mysql/data/mysql.log","mysql/data/mysql.err","mysql/data/mysql-bin.log","mysql/data/mysql-bin.index","usr/local/mysql/data/mysql.log","usr/local/mysql/data/mysql.err","usr/local/mysql/data/mysql-bin.log","usr/local/mysql/data/mysql-slow.log","usr/local/mysql/data/mysqlderror.log","usr/local/mysql/data/{host}.err","usr/local/mysql/data/mysql-bin.index","var/lib/mysql/my.cnf","etc/mysql/my.cnf","etc/my.cnf","program files/mysql/mysql server 5.0/my.ini","program files/mysql/mysql server 5.0/my.cnf","program files/mysql/my.ini","program files/mysql/my.cnf","mysql/my.ini","mysql/my.cnf","mysql/bin/my.ini","var/postgresql/log/postgresql.log","usr/internet/pgsql/data/postmaster.log","usr/local/pgsql/data/postgresql.log","usr/local/pgsql/data/pg_log","postgresql/log/pgadmin.log","var/lib/pgsql/data/postgresql.conf","var/postgresql/db/postgresql.conf","var/nm2/postgresql.conf","usr/local/pgsql/data/postgresql.conf","usr/local/pgsql/data/pg_hba.conf","usr/internet/pgsql/data/pg_hba.conf","usr/local/pgsql/data/passwd","usr/local/pgsql/bin/pg_passwd","etc/postgresql/postgresql.conf","etc/postgresql/pg_hba.conf","home/postgres/data/postgresql.conf","home/postgres/data/pg_version","home/postgres/data/pg_ident.conf","home/postgres/data/pg_hba.conf","program files/postgresql/8.3/data/pg_hba.conf","program files/postgresql/8.3/data/pg_ident.conf","program files/postgresql/8.3/data/postgresql.conf","program files/postgresql/8.4/data/pg_hba.conf","program files/postgresql/8.4/data/pg_ident.conf","program files/postgresql/8.4/data/postgresql.conf","program files/postgresql/9.0/data/pg_hba.conf","program files/postgresql/9.0/data/pg_ident.conf","program files/postgresql/9.0/data/postgresql.conf","program files/postgresql/9.1/data/pg_hba.conf","program files/postgresql/9.1/data/pg_ident.conf","program files/postgresql/9.1/data/postgresql.conf","wamp/logs/access.log","wamp/logs/apache_error.log","wamp/logs/genquery.log","wamp/logs/mysql.log","wamp/logs/slowquery.log","wamp/bin/apache/apache2.2.22/logs/access.log","wamp/bin/apache/apache2.2.22/logs/error.log","wamp/bin/apache/apache2.2.21/logs/access.log","wamp/bin/apache/apache2.2.21/logs/error.log","wamp/bin/mysql/mysql5.5.24/data/mysql-bin.index","wamp/bin/mysql/mysql5.5.16/data/mysql-bin.index","wamp/bin/apache/apache2.2.21/conf/httpd.conf","wamp/bin/apache/apache2.2.22/conf/httpd.conf","wamp/bin/apache/apache2.2.21/wampserver.conf","wamp/bin/apache/apache2.2.22/wampserver.conf","wamp/bin/apache/apache2.2.22/conf/wampserver.conf","wamp/bin/mysql/mysql5.5.24/my.ini","wamp/bin/mysql/mysql5.5.24/wampserver.conf","wamp/bin/mysql/mysql5.5.16/my.ini","wamp/bin/mysql/mysql5.5.16/wampserver.conf","wamp/bin/php/php5.3.8/php.ini","wamp/bin/php/php5.4.3/php.ini","xampp/apache/logs/access.log","xampp/apache/logs/error.log","xampp/mysql/data/mysql-bin.index","xampp/mysql/data/mysql.err","xampp/mysql/data/{host}.err","xampp/sendmail/sendmail.log","xampp/apache/conf/httpd.conf","xampp/filezillaftp/filezilla server.xml","xampp/mercurymail/mercury.ini","xampp/php/php.ini","xampp/phpmyadmin/config.inc.php","xampp/sendmail/sendmail.ini","xampp/webalizer/webalizer.conf","opt/lampp/etc/httpd.conf","xampp/htdocs/aca.txt","xampp/htdocs/admin.php","xampp/htdocs/leer.txt","usr/local/apache/logs/audit_log","usr/local/apache2/logs/audit_log","logs/security_debug_log","logs/security_log","usr/local/apache/conf/modsec.conf","usr/local/apache2/conf/modsec.conf","winnt/system32/logfiles/msftpsvc","winnt/system32/logfiles/msftpsvc1","winnt/system32/logfiles/msftpsvc2","windows/system32/logfiles/msftpsvc","windows/system32/logfiles/msftpsvc1","windows/system32/logfiles/msftpsvc2","etc/logrotate.d/proftpd","www/logs/proftpd.system.log","etc/pam.d/proftpd","etc/proftp.conf","etc/protpd/proftpd.conf","etc/vhcs2/proftpd/proftpd.conf","etc/proftpd/modules.conf","etc/vsftpd.chroot_list","etc/logrotate.d/vsftpd.log","etc/vsftpd/vsftpd.conf","etc/vsftpd.conf","etc/chrootusers","var/adm/log/xferlog","etc/wu-ftpd/ftpaccess","etc/wu-ftpd/ftphosts","etc/wu-ftpd/ftpusers","logs/pure-ftpd.log","usr/sbin/pure-config.pl","usr/etc/pure-ftpd.conf","etc/pure-ftpd/pure-ftpd.conf","usr/local/etc/pure-ftpd.conf","usr/local/etc/pureftpd.pdb","usr/local/pureftpd/etc/pureftpd.pdb","usr/local/pureftpd/sbin/pure-config.pl","usr/local/pureftpd/etc/pure-ftpd.conf","etc/pure-ftpd.conf","etc/pure-ftpd/pure-ftpd.pdb","etc/pureftpd.pdb","etc/pureftpd.passwd","etc/pure-ftpd/pureftpd.pdb","usr/ports/ftp/pure-ftpd/pure-ftpd.conf","usr/ports/ftp/pure-ftpd/pureftpd.pdb","usr/ports/ftp/pure-ftpd/pureftpd.passwd","usr/ports/net/pure-ftpd/pure-ftpd.conf","usr/ports/net/pure-ftpd/pureftpd.pdb","usr/ports/net/pure-ftpd/pureftpd.passwd","usr/pkgsrc/net/pureftpd/pure-ftpd.conf","usr/pkgsrc/net/pureftpd/pureftpd.pdb","usr/pkgsrc/net/pureftpd/pureftpd.passwd","usr/ports/contrib/pure-ftpd/pure-ftpd.conf","usr/ports/contrib/pure-ftpd/pureftpd.pdb","usr/ports/contrib/pure-ftpd/pureftpd.passwd","usr/sbin/mudlogd","etc/muddleftpd/mudlog","etc/muddleftpd.com","etc/muddleftpd/mudlogd.conf","etc/muddleftpd/muddleftpd.conf","usr/sbin/mudpasswd","etc/muddleftpd/muddleftpd.passwd","etc/muddleftpd/passwd","etc/logrotate.d/ftp","etc/ftpchroot","etc/ftphosts","etc/ftpusers","winnt/system32/logfiles/smtpsvc","winnt/system32/logfiles/smtpsvc1","winnt/system32/logfiles/smtpsvc2","winnt/system32/logfiles/smtpsvc3","winnt/system32/logfiles/smtpsvc4","winnt/system32/logfiles/smtpsvc5","windows/system32/logfiles/smtpsvc","windows/system32/logfiles/smtpsvc1","windows/system32/logfiles/smtpsvc2","windows/system32/logfiles/smtpsvc3","windows/system32/logfiles/smtpsvc4","windows/system32/logfiles/smtpsvc5","etc/osxhttpd/osxhttpd.conf","system/library/webobjects/adaptors/apache2.2/apache.conf","etc/apache2/sites-available/default","etc/apache2/sites-available/default-ssl","etc/apache2/sites-enabled/000-default","etc/apache2/sites-enabled/default","etc/apache2/apache2.conf","etc/apache2/ports.conf","usr/local/etc/apache/httpd.conf","usr/pkg/etc/httpd/httpd.conf","usr/pkg/etc/httpd/httpd-default.conf","usr/pkg/etc/httpd/httpd-vhosts.conf","etc/httpd/mod_php.conf","etc/httpd/extra/httpd-ssl.conf","etc/rc.d/rc.httpd","usr/local/apache/conf/httpd.conf.default","usr/local/apache/conf/access.conf","usr/local/apache22/conf/httpd.conf","usr/local/apache22/httpd.conf","usr/local/etc/apache22/conf/httpd.conf","usr/local/apps/apache22/conf/httpd.conf","etc/apache22/conf/httpd.conf","etc/apache22/httpd.conf","opt/apache22/conf/httpd.conf","usr/local/etc/apache2/vhosts.conf","usr/local/apache/conf/vhosts.conf","usr/local/apache2/conf/vhosts.conf","usr/local/apache/conf/vhosts-custom.conf","usr/local/apache2/conf/vhosts-custom.conf","etc/apache/default-server.conf","etc/apache2/default-server.conf","usr/local/apache2/conf/extra/httpd-ssl.conf","usr/local/apache2/conf/ssl.conf","etc/httpd/conf.d","usr/local/etc/apache22/httpd.conf","usr/local/etc/apache2/httpd.conf","etc/apache2/httpd2.conf","etc/apache2/ssl-global.conf","etc/apache2/vhosts.d/00_default_vhost.conf","apache/conf/httpd.conf","etc/apache/httpd.conf","etc/httpd/conf","http/httpd.conf","usr/local/apache1.3/conf/httpd.conf","usr/local/etc/httpd/conf","var/apache/conf/httpd.conf","var/www/conf","www/apache/conf/httpd.conf","www/conf/httpd.conf","etc/init.d","etc/apache/access.conf","etc/rc.conf","www/logs/freebsddiary-error.log","www/logs/freebsddiary-access_log","library/webserver/documents/index.html","library/webserver/documents/index.htm","library/webserver/documents/default.html","library/webserver/documents/default.htm","library/webserver/documents/index.php","library/webserver/documents/default.php","usr/local/etc/webmin/miniserv.conf","etc/webmin/miniserv.conf","usr/local/etc/webmin/miniserv.users","etc/webmin/miniserv.users","winnt/system32/logfiles/w3svc/inetsvn1.log","winnt/system32/logfiles/w3svc1/inetsvn1.log","winnt/system32/logfiles/w3svc2/inetsvn1.log","winnt/system32/logfiles/w3svc3/inetsvn1.log","windows/system32/logfiles/w3svc/inetsvn1.log","windows/system32/logfiles/w3svc1/inetsvn1.log","windows/system32/logfiles/w3svc2/inetsvn1.log","windows/system32/logfiles/w3svc3/inetsvn1.log","apache/logs/error.log","apache/logs/access.log","apache2/logs/error.log","apache2/logs/access.log","logs/error.log","logs/access.log","etc/httpd/logs/access_log","etc/httpd/logs/access.log","etc/httpd/logs/error_log","etc/httpd/logs/error.log","usr/local/apache/logs/access_log","usr/local/apache/logs/access.log","usr/local/apache/logs/error_log","usr/local/apache/logs/error.log","usr/local/apache2/logs/access_log","usr/local/apache2/logs/access.log","usr/local/apache2/logs/error_log","usr/local/apache2/logs/error.log","var/www/logs/access_log","var/www/logs/access.log","var/www/logs/error_log","var/www/logs/error.log","opt/lampp/logs/access_log","opt/lampp/logs/error_log","opt/xampp/logs/access_log","opt/xampp/logs/error_log","opt/lampp/logs/access.log","opt/lampp/logs/error.log","opt/xampp/logs/access.log","opt/xampp/logs/error.log","program files/apache group/apache/logs/access.log","program files/apache group/apache/logs/error.log","program files/apache software foundation/apache2.2/logs/error.log","program files/apache software foundation/apache2.2/logs/access.log","opt/apache/apache.conf","opt/apache/conf/apache.conf","opt/apache2/apache.conf","opt/apache2/conf/apache.conf","opt/httpd/apache.conf","opt/httpd/conf/apache.conf","etc/httpd/apache.conf","etc/apache2/apache.conf","etc/httpd/conf/apache.conf","usr/local/apache/apache.conf","usr/local/apache/conf/apache.conf","usr/local/apache2/apache.conf","usr/local/apache2/conf/apache.conf","usr/local/php/apache.conf.php","usr/local/php4/apache.conf.php","usr/local/php5/apache.conf.php","usr/local/php/apache.conf","usr/local/php4/apache.conf","usr/local/php5/apache.conf","private/etc/httpd/apache.conf","opt/apache/apache2.conf","opt/apache/conf/apache2.conf","opt/apache2/apache2.conf","opt/apache2/conf/apache2.conf","opt/httpd/apache2.conf","opt/httpd/conf/apache2.conf","etc/httpd/apache2.conf","etc/httpd/conf/apache2.conf","usr/local/apache/apache2.conf","usr/local/apache/conf/apache2.conf","usr/local/apache2/apache2.conf","usr/local/apache2/conf/apache2.conf","usr/local/php/apache2.conf.php","usr/local/php4/apache2.conf.php","usr/local/php5/apache2.conf.php","usr/local/php/apache2.conf","usr/local/php4/apache2.conf","usr/local/php5/apache2.conf","private/etc/httpd/apache2.conf","usr/local/apache/conf/httpd.conf","usr/local/apache2/conf/httpd.conf","etc/httpd/conf/httpd.conf","etc/apache/apache.conf","etc/apache/conf/httpd.conf","etc/apache2/httpd.conf","usr/apache2/conf/httpd.conf","usr/apache/conf/httpd.conf","usr/local/etc/apache/conf/httpd.conf","usr/local/apache/httpd.conf","usr/local/apache2/httpd.conf","usr/local/httpd/conf/httpd.conf","usr/local/etc/apache2/conf/httpd.conf","usr/local/etc/httpd/conf/httpd.conf","usr/local/apps/apache2/conf/httpd.conf","usr/local/apps/apache/conf/httpd.conf","usr/local/php/httpd.conf.php","usr/local/php4/httpd.conf.php","usr/local/php5/httpd.conf.php","usr/local/php/httpd.conf","usr/local/php4/httpd.conf","usr/local/php5/httpd.conf","etc/apache2/conf/httpd.conf","etc/http/conf/httpd.conf","etc/httpd/httpd.conf","etc/http/httpd.conf","etc/httpd.conf","opt/apache/conf/httpd.conf","opt/apache2/conf/httpd.conf","var/www/conf/httpd.conf","private/etc/httpd/httpd.conf","private/etc/httpd/httpd.conf.default","etc/apache2/vhosts.d/default_vhost.include","etc/apache2/conf.d/charset","etc/apache2/conf.d/security","etc/apache2/envvars","etc/apache2/mods-available/autoindex.conf","etc/apache2/mods-available/deflate.conf","etc/apache2/mods-available/dir.conf","etc/apache2/mods-available/mem_cache.conf","etc/apache2/mods-available/mime.conf","etc/apache2/mods-available/proxy.conf","etc/apache2/mods-available/setenvif.conf","etc/apache2/mods-available/ssl.conf","etc/apache2/mods-enabled/alias.conf","etc/apache2/mods-enabled/deflate.conf","etc/apache2/mods-enabled/dir.conf","etc/apache2/mods-enabled/mime.conf","etc/apache2/mods-enabled/negotiation.conf","etc/apache2/mods-enabled/php5.conf","etc/apache2/mods-enabled/status.conf","program files/apache group/apache/conf/httpd.conf","program files/apache group/apache2/conf/httpd.conf","program files/xampp/apache/conf/apache.conf","program files/xampp/apache/conf/apache2.conf","program files/xampp/apache/conf/httpd.conf","program files/apache group/apache/apache.conf","program files/apache group/apache/conf/apache.conf","program files/apache group/apache2/conf/apache.conf","program files/apache group/apache/apache2.conf","program files/apache group/apache/conf/apache2.conf","program files/apache group/apache2/conf/apache2.conf","program files/apache software foundation/apache2.2/conf/httpd.conf","volumes/macintosh_hd1/opt/httpd/conf/httpd.conf","volumes/macintosh_hd1/opt/apache/conf/httpd.conf","volumes/macintosh_hd1/opt/apache2/conf/httpd.conf","volumes/macintosh_hd1/usr/local/php/httpd.conf.php","volumes/macintosh_hd1/usr/local/php4/httpd.conf.php","volumes/macintosh_hd1/usr/local/php5/httpd.conf.php","volumes/webbackup/opt/apache2/conf/httpd.conf","volumes/webbackup/private/etc/httpd/httpd.conf","volumes/webbackup/private/etc/httpd/httpd.conf.default","usr/local/etc/apache/vhosts.conf","usr/local/jakarta/tomcat/conf/jakarta.conf","usr/local/jakarta/tomcat/conf/server.xml","usr/local/jakarta/tomcat/conf/context.xml","usr/local/jakarta/tomcat/conf/workers.properties","usr/local/jakarta/tomcat/conf/logging.properties","usr/local/jakarta/dist/tomcat/conf/jakarta.conf","usr/local/jakarta/dist/tomcat/conf/server.xml","usr/local/jakarta/dist/tomcat/conf/context.xml","usr/local/jakarta/dist/tomcat/conf/workers.properties","usr/local/jakarta/dist/tomcat/conf/logging.properties","usr/share/tomcat6/conf/server.xml","usr/share/tomcat6/conf/context.xml","usr/share/tomcat6/conf/workers.properties","usr/share/tomcat6/conf/logging.properties","var/cpanel/tomcat.options","usr/local/jakarta/tomcat/logs/catalina.out","usr/local/jakarta/tomcat/logs/catalina.err","opt/tomcat/logs/catalina.out","opt/tomcat/logs/catalina.err","usr/share/logs/catalina.out","usr/share/logs/catalina.err","usr/share/tomcat/logs/catalina.out","usr/share/tomcat/logs/catalina.err","usr/share/tomcat6/logs/catalina.out","usr/share/tomcat6/logs/catalina.err","usr/local/apache/logs/mod_jk.log","usr/local/jakarta/tomcat/logs/mod_jk.log","usr/local/jakarta/dist/tomcat/logs/mod_jk.log","opt/[jboss]/server/default/conf/jboss-minimal.xml","opt/[jboss]/server/default/conf/jboss-service.xml","opt/[jboss]/server/default/conf/jndi.properties","opt/[jboss]/server/default/conf/log4j.xml","opt/[jboss]/server/default/conf/login-config.xml","opt/[jboss]/server/default/conf/standardjaws.xml","opt/[jboss]/server/default/conf/standardjboss.xml","opt/[jboss]/server/default/conf/server.log.properties","opt/[jboss]/server/default/deploy/jboss-logging.xml","usr/local/[jboss]/server/default/conf/jboss-minimal.xml","usr/local/[jboss]/server/default/conf/jboss-service.xml","usr/local/[jboss]/server/default/conf/jndi.properties","usr/local/[jboss]/server/default/conf/log4j.xml","usr/local/[jboss]/server/default/conf/login-config.xml","usr/local/[jboss]/server/default/conf/standardjaws.xml","usr/local/[jboss]/server/default/conf/standardjboss.xml","usr/local/[jboss]/server/default/conf/server.log.properties","usr/local/[jboss]/server/default/deploy/jboss-logging.xml","private/tmp/[jboss]/server/default/conf/jboss-minimal.xml","private/tmp/[jboss]/server/default/conf/jboss-service.xml","private/tmp/[jboss]/server/default/conf/jndi.properties","private/tmp/[jboss]/server/default/conf/log4j.xml","private/tmp/[jboss]/server/default/conf/login-config.xml","private/tmp/[jboss]/server/default/conf/standardjaws.xml","private/tmp/[jboss]/server/default/conf/standardjboss.xml","private/tmp/[jboss]/server/default/conf/server.log.properties","private/tmp/[jboss]/server/default/deploy/jboss-logging.xml","tmp/[jboss]/server/default/conf/jboss-minimal.xml","tmp/[jboss]/server/default/conf/jboss-service.xml","tmp/[jboss]/server/default/conf/jndi.properties","tmp/[jboss]/server/default/conf/log4j.xml","tmp/[jboss]/server/default/conf/login-config.xml","tmp/[jboss]/server/default/conf/standardjaws.xml","tmp/[jboss]/server/default/conf/standardjboss.xml","tmp/[jboss]/server/default/conf/server.log.properties","tmp/[jboss]/server/default/deploy/jboss-logging.xml","program files/[jboss]/server/default/conf/jboss-minimal.xml","program files/[jboss]/server/default/conf/jboss-service.xml","program files/[jboss]/server/default/conf/jndi.properties","program files/[jboss]/server/default/conf/log4j.xml","program files/[jboss]/server/default/conf/login-config.xml","program files/[jboss]/server/default/conf/standardjaws.xml","program files/[jboss]/server/default/conf/standardjboss.xml","program files/[jboss]/server/default/conf/server.log.properties","program files/[jboss]/server/default/deploy/jboss-logging.xml","[jboss]/server/default/conf/jboss-minimal.xml","[jboss]/server/default/conf/jboss-service.xml","[jboss]/server/default/conf/jndi.properties","[jboss]/server/default/conf/log4j.xml","[jboss]/server/default/conf/login-config.xml","[jboss]/server/default/conf/standardjaws.xml","[jboss]/server/default/conf/standardjboss.xml","[jboss]/server/default/conf/server.log.properties","[jboss]/server/default/deploy/jboss-logging.xml","opt/[jboss]/server/default/log/server.log","opt/[jboss]/server/default/log/boot.log","usr/local/[jboss]/server/default/log/server.log","usr/local/[jboss]/server/default/log/boot.log","private/tmp/[jboss]/server/default/log/server.log","private/tmp/[jboss]/server/default/log/boot.log","tmp/[jboss]/server/default/log/server.log","tmp/[jboss]/server/default/log/boot.log","program files/[jboss]/server/default/log/server.log","program files/[jboss]/server/default/log/boot.log","[jboss]/server/default/log/server.log","[jboss]/server/default/log/boot.log","var/lighttpd.log","var/logs/access.log","usr/local/apache2/logs/lighttpd.error.log","usr/local/apache2/logs/lighttpd.log","usr/local/apache/logs/lighttpd.error.log","usr/local/apache/logs/lighttpd.log","usr/local/lighttpd/log/lighttpd.error.log","usr/local/lighttpd/log/access.log","usr/home/user/var/log/lighttpd.error.log","usr/home/user/var/log/apache.log","home/user/lighttpd/lighttpd.conf","usr/home/user/lighttpd/lighttpd.conf","etc/lighttpd/lighthttpd.conf","usr/local/etc/lighttpd.conf","usr/local/lighttpd/conf/lighttpd.conf","usr/local/etc/lighttpd.conf.new","var/www/.lighttpdpassword","logs/access_log","logs/error_log","etc/nginx/nginx.conf","usr/local/etc/nginx/nginx.conf","usr/local/nginx/conf/nginx.conf","usr/local/zeus/web/global.cfg","usr/local/zeus/web/log/errors","opt/lsws/conf/httpd_conf.xml","usr/local/lsws/conf/httpd_conf.xml","opt/lsws/logs/error.log","opt/lsws/logs/access.log","usr/local/lsws/logs/error.log","usr/local/logs/access.log","usr/local/samba/lib/log.user","usr/local/logs/samba.log","etc/samba/netlogon","etc/smbpasswd","etc/smb.conf","etc/samba/dhcp.conf","etc/samba/smb.conf","etc/samba/samba.conf","etc/samba/smb.conf.user","etc/samba/smbpasswd","etc/samba/smbusers","etc/samba/private/smbpasswd","usr/local/etc/smb.conf","usr/local/samba/lib/smb.conf.user","etc/dhcp3/dhclient.conf","etc/dhcp3/dhcpd.conf","etc/dhcp/dhclient.conf","program files/vidalia bundle/polipo/polipo.conf","etc/tor/tor-tsocks.conf","etc/stunnel/stunnel.conf","etc/tsocks.conf","etc/tinyproxy/tinyproxy.conf","etc/miredo-server.conf","etc/miredo.conf","etc/miredo/miredo-server.conf","etc/miredo/miredo.conf","etc/wicd/dhclient.conf.template.default","etc/wicd/manager-settings.conf","etc/wicd/wired-settings.conf","etc/wicd/wireless-settings.conf","etc/ipfw.rules","etc/ipfw.conf","etc/firewall.rules","winnt/system32/logfiles/firewall/pfirewall.log","winnt/system32/logfiles/firewall/pfirewall.log.old","windows/system32/logfiles/firewall/pfirewall.log","windows/system32/logfiles/firewall/pfirewall.log.old","etc/clamav/clamd.conf","etc/clamav/freshclam.conf","etc/x11/xorg.conf","etc/x11/xorg.conf-vesa","etc/x11/xorg.conf-vmware","etc/x11/xorg.conf.beforevmwaretoolsinstall","etc/x11/xorg.conf.orig","etc/bluetooth/input.conf","etc/bluetooth/main.conf","etc/bluetooth/network.conf","etc/bluetooth/rfcomm.conf","etc/bash_completion.d/debconf","root/.bash_logout","root/.bash_history","root/.bash_config","root/.bashrc","etc/bash.bashrc","var/adm/syslog","var/adm/sulog","var/adm/utmp","var/adm/utmpx","var/adm/wtmp","var/adm/wtmpx","var/adm/lastlog/username","usr/spool/lp/log","var/adm/lp/lpd-errs","usr/lib/cron/log","var/adm/loginlog","var/adm/pacct","var/adm/dtmp","var/adm/acct/sum/loginlog","var/adm/x0msgs","var/adm/crash/vmcore","var/adm/crash/unix","etc/newsyslog.conf","var/adm/qacct","var/adm/ras/errlog","var/adm/ras/bootlog","var/adm/cron/log","etc/utmp","etc/security/lastlog","etc/security/failedlogin","usr/spool/mqueue/syslog","var/adm/messages","var/adm/aculogs","var/adm/aculog","var/adm/vold.log","var/adm/log/asppp.log","var/lp/logs/lpsched","var/lp/logs/lpnet","var/lp/logs/requests","var/cron/log","var/saf/_log","var/saf/port/log","tmp/access.log","etc/sensors.conf","etc/sensors3.conf","etc/host.conf","etc/pam.conf","etc/resolv.conf","etc/apt/apt.conf","etc/inetd.conf","etc/syslog.conf","etc/sysctl.conf","etc/sysctl.d/10-console-messages.conf","etc/sysctl.d/10-network-security.conf","etc/sysctl.d/10-process-security.conf","etc/sysctl.d/wine.sysctl.conf","etc/security/access.conf","etc/security/group.conf","etc/security/limits.conf","etc/security/namespace.conf","etc/security/pam_env.conf","etc/security/sepermit.conf","etc/security/time.conf","etc/ssh/sshd_config","etc/adduser.conf","etc/deluser.conf","etc/avahi/avahi-daemon.conf","etc/ca-certificates.conf","etc/ca-certificates.conf.dpkg-old","etc/casper.conf","etc/chkrootkit.conf","etc/debconf.conf","etc/dns2tcpd.conf","etc/e2fsck.conf","etc/esound/esd.conf","etc/etter.conf","etc/fuse.conf","etc/foremost.conf","etc/hdparm.conf","etc/kernel-img.conf","etc/kernel-pkg.conf","etc/ld.so.conf","etc/ltrace.conf","etc/mail/sendmail.conf","etc/manpath.config","etc/kbd/config","etc/ldap/ldap.conf","etc/logrotate.conf","etc/mtools.conf","etc/smi.conf","etc/updatedb.conf","etc/pulse/client.conf","usr/share/adduser/adduser.conf","etc/hostname","etc/networks","etc/timezone","etc/modules","etc/passwd","etc/shadow","etc/fstab","etc/motd","etc/hosts","etc/group","etc/alias","etc/crontab","etc/crypttab","etc/exports","etc/mtab","etc/hosts.allow","etc/hosts.deny","etc/os-release","etc/password.master","etc/profile","etc/default/grub","etc/resolvconf/update-libc.d/sendmail","etc/inittab","etc/issue","etc/issue.net","etc/login.defs","etc/sudoers","etc/sysconfig/network-scripts/ifcfg-eth0","etc/redhat-release","etc/scw-release","etc/system-release-cpe","etc/debian_version","etc/fedora-release","etc/mandrake-release","etc/slackware-release","etc/suse-release","etc/security/group","etc/security/passwd","etc/security/user","etc/security/environ","etc/security/limits","etc/security/opasswd","boot/grub/grub.cfg","boot/grub/menu.lst","root/.ksh_history","root/.xauthority","usr/lib/security/mkuser.default","var/lib/squirrelmail/prefs/squirrelmail.log","etc/squirrelmail/apache.conf","etc/squirrelmail/config_local.php","etc/squirrelmail/default_pref","etc/squirrelmail/index.php","etc/squirrelmail/config_default.php","etc/squirrelmail/config.php","etc/squirrelmail/filters_setup.php","etc/squirrelmail/sqspell_config.php","etc/squirrelmail/config/config.php","etc/httpd/conf.d/squirrelmail.conf","usr/share/squirrelmail/config/config.php","private/etc/squirrelmail/config/config.php","srv/www/htdos/squirrelmail/config/config.php","var/www/squirrelmail/config/config.php","var/www/html/squirrelmail/config/config.php","var/www/html/squirrelmail-1.2.9/config/config.php","usr/share/squirrelmail/plugins/squirrel_logger/setup.php","usr/local/squirrelmail/www/readme","windows/system32/drivers/etc/hosts","windows/system32/drivers/etc/lmhosts.sam","windows/system32/drivers/etc/networks","windows/system32/drivers/etc/protocol","windows/system32/drivers/etc/services","/boot.ini","windows/debug/netsetup.log","windows/comsetup.log","windows/repair/setup.log","windows/setupact.log","windows/setupapi.log","windows/setuperr.log","windows/updspapi.log","windows/wmsetup.log","windows/windowsupdate.log","windows/odbc.ini","usr/local/psa/admin/htdocs/domains/databases/phpmyadmin/libraries/config.default.php","etc/apache2/conf.d/phpmyadmin.conf","etc/phpmyadmin/config.inc.php","etc/openldap/ldap.conf","etc/cups/acroread.conf","etc/cups/cupsd.conf","etc/cups/cupsd.conf.default","etc/cups/pdftops.conf","etc/cups/printers.conf","windows/system32/macromed/flash/flashinstall.log","windows/system32/macromed/flash/install.log","etc/cvs-cron.conf","etc/cvs-pserver.conf","etc/subversion/config","etc/modprobe.d/vmware-tools.conf","etc/updatedb.conf.beforevmwaretoolsinstall","etc/vmware-tools/config","etc/vmware-tools/tpvmlp.conf","etc/vmware-tools/vmware-tools-libraries.conf","var/log","var/log/sw-cp-server/error_log","var/log/sso/sso.log","var/log/dpkg.log","var/log/btmp","var/log/utmp","var/log/wtmp","var/log/mysql/mysql-bin.log","var/log/mysql/mysql-bin.index","var/log/mysql/data/mysql-bin.index","var/log/mysql.log","var/log/mysql.err","var/log/mysqlderror.log","var/log/mysql/mysql.log","var/log/mysql/mysql-slow.log","var/log/mysql-bin.index","var/log/data/mysql-bin.index","var/log/postgresql/postgresql.log","var/log/postgres/pg_backup.log","var/log/postgres/postgres.log","var/log/postgresql.log","var/log/pgsql/pgsql.log","var/log/postgresql/postgresql-8.1-main.log","var/log/postgresql/postgresql-8.3-main.log","var/log/postgresql/postgresql-8.4-main.log","var/log/postgresql/postgresql-9.0-main.log","var/log/postgresql/postgresql-9.1-main.log","var/log/pgsql8.log","var/log/postgresql/postgres.log","var/log/pgsql_log","var/log/postgresql/main.log","var/log/cron","var/log/postgres.log","var/log/proftpd","var/log/proftpd/xferlog.legacy","var/log/proftpd.access_log","var/log/proftpd.xferlog","var/log/vsftpd.log","var/log/xferlog","var/log/pure-ftpd/pure-ftpd.log","var/log/pureftpd.log","var/log/muddleftpd","var/log/muddleftpd.conf","var/log/ftp-proxy/ftp-proxy.log","var/log/ftp-proxy","var/log/ftplog","var/log/exim_mainlog","var/log/exim/mainlog","var/log/maillog","var/log/exim_paniclog","var/log/exim/paniclog","var/log/exim/rejectlog","var/log/exim_rejectlog","var/log/webmin/miniserv.log","var/log/httpd/access_log","var/log/httpd/error_log","var/log/httpd/access.log","var/log/httpd/error.log","var/log/apache/access_log","var/log/apache/access.log","var/log/apache/error_log","var/log/apache/error.log","var/log/apache2/access_log","var/log/apache2/access.log","var/log/apache2/error_log","var/log/apache2/error.log","var/log/access_log","var/log/access.log","var/log/error_log","var/log/error.log","var/log/tomcat6/catalina.out","var/log/lighttpd.error.log","var/log/lighttpd.access.log","var/logs/access.log","var/log/lighttpd/","var/log/lighttpd/error.log","var/log/lighttpd/access.www.log","var/log/lighttpd/error.www.log","var/log/lighttpd/access.log","var/log/lighttpd/{domain}/access.log","var/log/lighttpd/{domain}/error.log","var/log/nginx/access_log","var/log/nginx/error_log","var/log/nginx/access.log","var/log/nginx/error.log","var/log/nginx.access_log","var/log/nginx.error_log","var/log/samba/log.smbd","var/log/samba/log.nmbd","var/log/samba.log","var/log/samba.log1","var/log/samba.log2","var/log/log.smb","var/log/ipfw.log","var/log/ipfw","var/log/ipfw/ipfw.log","var/log/ipfw.today","var/log/poplog","var/log/authlog","var/log/news.all","var/log/news/news.all","var/log/news/news.crit","var/log/news/news.err","var/log/news/news.notice","var/log/news/suck.err","var/log/news/suck.notice","var/log/messages","var/log/messages.1","var/log/user.log","var/log/user.log.1","var/log/auth.log","var/log/pm-powersave.log","var/log/xorg.0.log","var/log/daemon.log","var/log/daemon.log.1","var/log/kern.log","var/log/kern.log.1","var/log/mail.err","var/log/mail.info","var/log/mail.warn","var/log/ufw.log","var/log/boot.log","var/log/syslog","var/log/syslog.1","var/log/squirrelmail.log","var/log/apache2/squirrelmail.log","var/log/apache2/squirrelmail.err.log","var/log/mail.log","var/log/vmware/hostd.log","var/log/vmware/hostd-1.log","/wp-config.php","/wp-config.bak","/wp-config.old","/wp-config.temp","/wp-config.tmp","/wp-config.txt","/config.yml","/config_dev.yml","/config_prod.yml","/config_test.yml","/parameters.yml","/routing.yml","/security.yml","/services.yml","sites/default/default.settings.php","sites/default/settings.php","sites/default/settings.local.php","app/etc/local.xml","/sftp-config.json","/web.config","includes/config.php","includes/configure.php","/config.inc.php","/localsettings.php","inc/config.php","typo3conf/localconf.php","config/app.php","config/custom.php","config/database.php","/configuration.php","/config.php","var/mail/www-data","etc/network/","etc/init/","inetpub/wwwroot/global.asa","system32/inetsrv/config/applicationhost.config","system32/inetsrv/config/administration.config","system32/inetsrv/config/redirection.config","system32/config/default","system32/config/sam","system32/config/system","system32/config/software","winnt/repair/sam._","/package.json","/package-lock.json","/gruntfile.js","/npm-debug.log","/ormconfig.json","/tsconfig.json","/webpack.config.js","/yarn.lock","proc/0","proc/1","proc/2","proc/3","proc/4","proc/5","proc/6","proc/7","proc/8","proc/9","proc/acpi","proc/asound","proc/bootconfig","proc/buddyinfo","proc/bus","proc/cgroups","proc/cmdline","proc/config.gz","proc/consoles","proc/cpuinfo","proc/crypto","proc/devices","proc/diskstats","proc/dma","proc/docker","proc/driver","proc/dynamic_debug","proc/execdomains","proc/fb","proc/filesystems","proc/fs","proc/interrupts","proc/iomem","proc/ioports","proc/ipmi","proc/irq","proc/kallsyms","proc/kcore","proc/keys","proc/keys","proc/key-users","proc/kmsg","proc/kpagecgroup","proc/kpagecount","proc/kpageflags","proc/latency_stats","proc/loadavg","proc/locks","proc/mdstat","proc/meminfo","proc/misc","proc/modules","proc/mounts","proc/mpt","proc/mtd","proc/mtrr","proc/net","proc/net/tcp","proc/net/udp","proc/pagetypeinfo","proc/partitions","proc/pressure","proc/sched_debug","proc/schedstat","proc/scsi","proc/self","proc/self/cmdline","proc/self/environ","proc/self/fd/0","proc/self/fd/1","proc/self/fd/10","proc/self/fd/11","proc/self/fd/12","proc/self/fd/13","proc/self/fd/14","proc/self/fd/15","proc/self/fd/2","proc/self/fd/3","proc/self/fd/4","proc/self/fd/5","proc/self/fd/6","proc/self/fd/7","proc/self/fd/8","proc/self/fd/9","proc/self/mounts","proc/self/stat","proc/self/status","proc/slabinfo","proc/softirqs","proc/stat","proc/swaps","proc/sys","proc/sysrq-trigger","proc/sysvipc","proc/thread-self","proc/timer_list","proc/timer_stats","proc/tty","proc/uptime","proc/version","proc/version_signature","proc/vmallocinfo","proc/vmstat","proc/zoneinfo","sys/block","sys/bus","sys/class","sys/dev","sys/devices","sys/firmware","sys/fs","sys/hypervisor","sys/kernel","sys/module","sys/power","windows\\\\win.ini","default\\\\ntuser.dat","/var/run/secrets/kubernetes.io/serviceaccount"],"options":{"enforce_word_boundary":true}},"operator":"phrase_match"}],"transformers":["lowercase","normalizePath"]},{"id":"crs-931-110","name":"RFI: Common RFI Vulnerable Parameter Name used w/ URL Payload","tags":{"type":"rfi","crs_id":"931110","category":"attack_attempt","cwe":"98","capec":"1000/152/175/253/193","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"}],"regex":"(?:\\\\binclude\\\\s*\\\\([^)]*|mosConfig_absolute_path|_CONF\\\\[path\\\\]|_SERVER\\\\[DOCUMENT_ROOT\\\\]|GALLERY_BASEDIR|path\\\\[docroot\\\\]|appserv_root|config\\\\[root_dir\\\\])=(?:file|ftps?|https?)://","options":{"min_length":15}},"operator":"match_regex"}],"transformers":[]},{"id":"crs-931-120","name":"RFI: URL Payload Used w/Trailing Question Mark Character (?)","tags":{"type":"rfi","crs_id":"931120","category":"attack_attempt","cwe":"98","capec":"1000/152/175/253/193","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"^(?i:file|ftps?)://.*?\\\\?+$","options":{"case_sensitive":true,"min_length":4}},"operator":"match_regex"}],"transformers":[]},{"id":"crs-932-160","name":"Remote Command Execution: Unix Shell Code Found","tags":{"type":"command_injection","crs_id":"932160","category":"attack_attempt","cwe":"77","capec":"1000/152/248/88","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"options":{"enforce_word_boundary":true},"list":["${cdpath}","${dirstack}","${home}","${hostname}","${ifs}","${oldpwd}","${ostype}","${path}","${pwd}","$cdpath","$dirstack","$home","$hostname","$ifs","$oldpwd","$ostype","$pwd","dev/fd/","dev/null","dev/stderr","dev/stdin","dev/stdout","dev/tcp/","dev/udp/","dev/zero","etc/master.passwd","etc/pwd.db","etc/shells","etc/spwd.db","proc/self/","bin/7z","bin/7za","bin/7zr","bin/ab","bin/agetty","bin/ansible-playbook","bin/apt","bin/apt-get","bin/ar","bin/aria2c","bin/arj","bin/arp","bin/as","bin/ascii-xfr","bin/ascii85","bin/ash","bin/aspell","bin/at","bin/atobm","bin/awk","bin/base32","bin/base64","bin/basenc","bin/bash","bin/bpftrace","bin/bridge","bin/bundler","bin/bunzip2","bin/busctl","bin/busybox","bin/byebug","bin/bzcat","bin/bzcmp","bin/bzdiff","bin/bzegrep","bin/bzexe","bin/bzfgrep","bin/bzgrep","bin/bzip2","bin/bzip2recover","bin/bzless","bin/bzmore","bin/bzz","bin/c89","bin/c99","bin/cancel","bin/capsh","bin/cat","bin/cc","bin/certbot","bin/check_by_ssh","bin/check_cups","bin/check_log","bin/check_memory","bin/check_raid","bin/check_ssl_cert","bin/check_statusfile","bin/chmod","bin/choom","bin/chown","bin/chroot","bin/clang","bin/clang++","bin/cmp","bin/cobc","bin/column","bin/comm","bin/composer","bin/core_perl/zipdetails","bin/cowsay","bin/cowthink","bin/cp","bin/cpan","bin/cpio","bin/cpulimit","bin/crash","bin/crontab","bin/csh","bin/csplit","bin/csvtool","bin/cupsfilter","bin/curl","bin/cut","bin/dash","bin/date","bin/dd","bin/dev/fd/","bin/dev/null","bin/dev/stderr","bin/dev/stdin","bin/dev/stdout","bin/dev/tcp/","bin/dev/udp/","bin/dev/zero","bin/dialog","bin/diff","bin/dig","bin/dmesg","bin/dmidecode","bin/dmsetup","bin/dnf","bin/docker","bin/dosbox","bin/dpkg","bin/du","bin/dvips","bin/easy_install","bin/eb","bin/echo","bin/ed","bin/efax","bin/emacs","bin/env","bin/eqn","bin/es","bin/esh","bin/etc/group","bin/etc/master.passwd","bin/etc/passwd","bin/etc/pwd.db","bin/etc/shadow","bin/etc/shells","bin/etc/spwd.db","bin/ex","bin/exiftool","bin/expand","bin/expect","bin/expr","bin/facter","bin/fetch","bin/file","bin/find","bin/finger","bin/fish","bin/flock","bin/fmt","bin/fold","bin/fping","bin/ftp","bin/gawk","bin/gcc","bin/gcore","bin/gdb","bin/gem","bin/genie","bin/genisoimage","bin/ghc","bin/ghci","bin/gimp","bin/ginsh","bin/git","bin/grc","bin/grep","bin/gtester","bin/gunzip","bin/gzexe","bin/gzip","bin/hd","bin/head","bin/hexdump","bin/highlight","bin/hping3","bin/iconv","bin/id","bin/iftop","bin/install","bin/ionice","bin/ip","bin/irb","bin/ispell","bin/jjs","bin/join","bin/journalctl","bin/jq","bin/jrunscript","bin/knife","bin/ksh","bin/ksshell","bin/latex","bin/ld","bin/ldconfig","bin/less","bin/lftp","bin/ln","bin/loginctl","bin/logsave","bin/look","bin/lp","bin/ls","bin/ltrace","bin/lua","bin/lualatex","bin/luatex","bin/lwp-download","bin/lwp-request","bin/lz","bin/lz4","bin/lz4c","bin/lz4cat","bin/lzcat","bin/lzcmp","bin/lzdiff","bin/lzegrep","bin/lzfgrep","bin/lzgrep","bin/lzless","bin/lzma","bin/lzmadec","bin/lzmainfo","bin/lzmore","bin/mail","bin/make","bin/man","bin/mawk","bin/mkfifo","bin/mknod","bin/more","bin/mosquitto","bin/mount","bin/msgattrib","bin/msgcat","bin/msgconv","bin/msgfilter","bin/msgmerge","bin/msguniq","bin/mtr","bin/mv","bin/mysql","bin/nano","bin/nasm","bin/nawk","bin/nc","bin/ncat","bin/neofetch","bin/nice","bin/nl","bin/nm","bin/nmap","bin/node","bin/nohup","bin/npm","bin/nroff","bin/nsenter","bin/octave","bin/od","bin/openssl","bin/openvpn","bin/openvt","bin/opkg","bin/paste","bin/pax","bin/pdb","bin/pdflatex","bin/pdftex","bin/pdksh","bin/perf","bin/perl","bin/pg","bin/php","bin/php-cgi","bin/php5","bin/php7","bin/pic","bin/pico","bin/pidstat","bin/pigz","bin/pip","bin/pkexec","bin/pkg","bin/pr","bin/printf","bin/proc/self/","bin/pry","bin/ps","bin/psed","bin/psftp","bin/psql","bin/ptx","bin/puppet","bin/pxz","bin/python","bin/python2","bin/python3","bin/rake","bin/rbash","bin/rc","bin/readelf","bin/red","bin/redcarpet","bin/restic","bin/rev","bin/rlogin","bin/rlwrap","bin/rpm","bin/rpmquery","bin/rsync","bin/ruby","bin/run-mailcap","bin/run-parts","bin/rview","bin/rvim","bin/sash","bin/sbin/capsh","bin/sbin/logsave","bin/sbin/service","bin/sbin/start-stop-daemon","bin/scp","bin/screen","bin/script","bin/sed","bin/service","bin/setarch","bin/sftp","bin/sg","bin/sh","bin/shuf","bin/sleep","bin/slsh","bin/smbclient","bin/snap","bin/socat","bin/soelim","bin/sort","bin/split","bin/sqlite3","bin/ss","bin/ssh","bin/ssh-keygen","bin/ssh-keyscan","bin/sshpass","bin/start-stop-daemon","bin/stdbuf","bin/strace","bin/strings","bin/su","bin/sysctl","bin/systemctl","bin/systemd-resolve","bin/tac","bin/tail","bin/tar","bin/task","bin/taskset","bin/tbl","bin/tclsh","bin/tcpdump","bin/tcsh","bin/tee","bin/telnet","bin/tex","bin/tftp","bin/tic","bin/time","bin/timedatectl","bin/timeout","bin/tmux","bin/top","bin/troff","bin/tshark","bin/ul","bin/uname","bin/uncompress","bin/unexpand","bin/uniq","bin/unlz4","bin/unlzma","bin/unpigz","bin/unrar","bin/unshare","bin/unxz","bin/unzip","bin/unzstd","bin/update-alternatives","bin/uudecode","bin/uuencode","bin/valgrind","bin/vi","bin/view","bin/vigr","bin/vim","bin/vimdiff","bin/vipw","bin/virsh","bin/volatility","bin/wall","bin/watch","bin/wc","bin/wget","bin/whiptail","bin/who","bin/whoami","bin/whois","bin/wireshark","bin/wish","bin/xargs","bin/xelatex","bin/xetex","bin/xmodmap","bin/xmore","bin/xpad","bin/xxd","bin/xz","bin/xzcat","bin/xzcmp","bin/xzdec","bin/xzdiff","bin/xzegrep","bin/xzfgrep","bin/xzgrep","bin/xzless","bin/xzmore","bin/yarn","bin/yelp","bin/yes","bin/yum","bin/zathura","bin/zip","bin/zipcloak","bin/zipcmp","bin/zipdetails","bin/zipgrep","bin/zipinfo","bin/zipmerge","bin/zipnote","bin/zipsplit","bin/ziptool","bin/zsh","bin/zsoelim","bin/zstd","bin/zstdcat","bin/zstdgrep","bin/zstdless","bin/zstdmt","bin/zypper"]},"operator":"phrase_match"}],"transformers":["lowercase","cmdLine"]},{"id":"crs-932-171","name":"Remote Command Execution: Shellshock (CVE-2014-6271)","tags":{"type":"command_injection","crs_id":"932171","category":"attack_attempt","cwe":"77","capec":"1000/152/248/88","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"server.request.headers.no_cookies"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"^\\\\(\\\\s*\\\\)\\\\s+{","options":{"case_sensitive":true,"min_length":4}},"operator":"match_regex"}],"transformers":[]},{"id":"crs-932-180","name":"Restricted File Upload Attempt","tags":{"type":"command_injection","crs_id":"932180","category":"attack_attempt","cwe":"706","capec":"1000/225/122/17/177","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["x-filename"]},{"address":"server.request.headers.no_cookies","key_path":["x_filename"]},{"address":"server.request.headers.no_cookies","key_path":["x-file-name"]}],"list":[".htaccess",".htdigest",".htpasswd","wp-config.php","config.yml","config_dev.yml","config_prod.yml","config_test.yml","parameters.yml","routing.yml","security.yml","services.yml","default.settings.php","settings.php","settings.local.php","local.xml",".env"],"options":{"enforce_word_boundary":true}},"operator":"phrase_match"}],"transformers":["lowercase"]},{"id":"crs-933-111","name":"PHP Injection Attack: PHP Script File Upload Found","tags":{"type":"unrestricted_file_upload","crs_id":"933111","category":"attack_attempt","cwe":"434","capec":"1000/225/122/17/650","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["x-filename"]},{"address":"server.request.headers.no_cookies","key_path":["x_filename"]},{"address":"server.request.headers.no_cookies","key_path":["x.filename"]},{"address":"server.request.headers.no_cookies","key_path":["x-file-name"]}],"regex":".*\\\\.(?:php\\\\d*|phtml)\\\\..*$","options":{"case_sensitive":true,"min_length":5}},"operator":"match_regex"}],"transformers":["lowercase"]},{"id":"crs-933-130","name":"PHP Injection Attack: Global Variables Found","tags":{"type":"php_code_injection","crs_id":"933130","category":"attack_attempt","cwe":"94","capec":"1000/225/122/17/650","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"options":{"enforce_word_boundary":true},"list":["$globals","$_cookie","$_env","$_files","$_get","$_post","$_request","$_server","$_session","$argc","$argv","$http_\\\\u200bresponse_\\\\u200bheader","$php_\\\\u200berrormsg","$http_cookie_vars","$http_env_vars","$http_get_vars","$http_post_files","$http_post_vars","$http_raw_post_data","$http_request_vars","$http_server_vars"]},"operator":"phrase_match"}],"transformers":["lowercase"]},{"id":"crs-933-131","name":"PHP Injection Attack: HTTP Headers Values Found","tags":{"type":"php_code_injection","crs_id":"933131","category":"attack_attempt","cwe":"94","capec":"1000/225/122/17/650","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"(?:HTTP_(?:ACCEPT(?:_(?:ENCODING|LANGUAGE|CHARSET))?|(?:X_FORWARDED_FO|REFERE)R|(?:USER_AGEN|HOS)T|CONNECTION|KEEP_ALIVE)|PATH_(?:TRANSLATED|INFO)|ORIG_PATH_INFO|QUERY_STRING|REQUEST_URI|AUTH_TYPE)","options":{"case_sensitive":true,"min_length":9}},"operator":"match_regex"}],"transformers":[]},{"id":"crs-933-140","name":"PHP Injection Attack: I/O Stream Found","tags":{"type":"php_code_injection","crs_id":"933140","category":"attack_attempt","cwe":"94","capec":"1000/225/122/17/650","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"php://(?:std(?:in|out|err)|(?:in|out)put|fd|memory|temp|filter)","options":{"min_length":8}},"operator":"match_regex"}],"transformers":[]},{"id":"crs-933-150","name":"PHP Injection Attack: High-Risk PHP Function Name Found","tags":{"type":"php_code_injection","crs_id":"933150","category":"attack_attempt","cwe":"94","capec":"1000/225/122/17/650","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"list":["__halt_compiler","apache_child_terminate","base64_decode","bzdecompress","call_user_func","call_user_func_array","call_user_method","call_user_method_array","convert_uudecode","file_get_contents","file_put_contents","fsockopen","get_class_methods","get_class_vars","get_defined_constants","get_defined_functions","get_defined_vars","gzdecode","gzinflate","gzuncompress","include_once","invokeargs","pcntl_exec","pcntl_fork","pfsockopen","posix_getcwd","posix_getpwuid","posix_getuid","posix_uname","reflectionfunction","require_once","shell_exec","str_rot13","sys_get_temp_dir","wp_remote_fopen","wp_remote_get","wp_remote_head","wp_remote_post","wp_remote_request","wp_safe_remote_get","wp_safe_remote_head","wp_safe_remote_post","wp_safe_remote_request","zlib_decode"],"options":{"enforce_word_boundary":true}},"operator":"phrase_match"}],"transformers":["lowercase"]},{"id":"crs-933-160","name":"PHP Injection Attack: High-Risk PHP Function Call Found","tags":{"type":"php_code_injection","crs_id":"933160","category":"attack_attempt","cwe":"94","capec":"1000/225/122/17/650","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"\\\\b(?:s(?:e(?:t(?:_(?:e(?:xception|rror)_handler|magic_quotes_runtime|include_path)|defaultstub)|ssion_s(?:et_save_handler|tart))|qlite_(?:(?:(?:unbuffered|single|array)_)?query|create_(?:aggregate|function)|p?open|exec)|tr(?:eam_(?:context_create|socket_client)|ipc?slashes|rev)|implexml_load_(?:string|file)|ocket_c(?:onnect|reate)|h(?:ow_sourc|a1_fil)e|pl_autoload_register|ystem)|p(?:r(?:eg_(?:replace(?:_callback(?:_array)?)?|match(?:_all)?|split)|oc_(?:(?:terminat|clos|nic)e|get_status|open)|int_r)|o(?:six_(?:get(?:(?:e[gu]|g)id|login|pwnam)|mk(?:fifo|nod)|ttyname|kill)|pen)|hp(?:_(?:strip_whitespac|unam)e|version|info)|g_(?:(?:execut|prepar)e|connect|query)|a(?:rse_(?:ini_file|str)|ssthru)|utenv)|r(?:unkit_(?:function_(?:re(?:defin|nam)e|copy|add)|method_(?:re(?:defin|nam)e|copy|add)|constant_(?:redefine|add))|e(?:(?:gister_(?:shutdown|tick)|name)_function|ad(?:(?:gz)?file|_exif_data|dir))|awurl(?:de|en)code)|i(?:mage(?:createfrom(?:(?:jpe|pn)g|x[bp]m|wbmp|gif)|(?:jpe|pn)g|g(?:d2?|if)|2?wbmp|xbm)|s_(?:(?:(?:execut|write?|read)ab|fi)le|dir)|ni_(?:get(?:_all)?|set)|terator_apply|ptcembed)|g(?:et(?:_(?:c(?:urrent_use|fg_va)r|meta_tags)|my(?:[gpu]id|inode)|(?:lastmo|cw)d|imagesize|env)|z(?:(?:(?:defla|wri)t|encod|fil)e|compress|open|read)|lob)|a(?:rray_(?:u(?:intersect(?:_u?assoc)?|diff(?:_u?assoc)?)|intersect_u(?:assoc|key)|diff_u(?:assoc|key)|filter|reduce|map)|ssert(?:_options)?|tob)|h(?:tml(?:specialchars(?:_decode)?|_entity_decode|entities)|(?:ash(?:_(?:update|hmac))?|ighlight)_file|e(?:ader_register_callback|x2bin))|f(?:i(?:le(?:(?:[acm]tim|inod)e|(?:_exist|perm)s|group)?|nfo_open)|tp_(?:nb_(?:ge|pu)|connec|ge|pu)t|(?:unction_exis|pu)ts|write|open)|o(?:b_(?:get_(?:c(?:ontents|lean)|flush)|end_(?:clean|flush)|clean|flush|start)|dbc_(?:result(?:_all)?|exec(?:ute)?|connect)|pendir)|m(?:b_(?:ereg(?:_(?:replace(?:_callback)?|match)|i(?:_replace)?)?|parse_str)|(?:ove_uploaded|d5)_file|ethod_exists|ysql_query|kdir)|e(?:x(?:if_(?:t(?:humbnail|agname)|imagetype|read_data)|ec)|scapeshell(?:arg|cmd)|rror_reporting|val)|c(?:url_(?:file_create|exec|init)|onvert_uuencode|reate_function|hr)|u(?:n(?:serialize|pack)|rl(?:de|en)code|[ak]?sort)|b(?:(?:son_(?:de|en)|ase64_en)code|zopen|toa)|(?:json_(?:de|en)cod|debug_backtrac|tmpfil)e|var_dump)(?:\\\\s|/\\\\*.*\\\\*/|//.*|#.*|\\\\\\"|\')*\\\\((?:(?:\\\\s|/\\\\*.*\\\\*/|//.*|#.*)*(?:\\\\$\\\\w+|[A-Z\\\\d]\\\\w*|\\\\w+\\\\(.*\\\\)|\\\\\\\\?\\"(?:[^\\"]|\\\\\\\\\\"|\\"\\"|\\"\\\\+\\")*\\\\\\\\?\\"|\\\\\\\\?\'(?:[^\']|\'\'|\'\\\\+\')*\\\\\\\\?\')(?:\\\\s|/\\\\*.*\\\\*/|//.*|#.*)*(?:(?:::|\\\\.|->)(?:\\\\s|/\\\\*.*\\\\*/|//.*|#.*)*\\\\w+(?:\\\\(.*\\\\))?)?,)*(?:(?:\\\\s|/\\\\*.*\\\\*/|//.*|#.*)*(?:\\\\$\\\\w+|[A-Z\\\\d]\\\\w*|\\\\w+\\\\(.*\\\\)|\\\\\\\\?\\"(?:[^\\"]|\\\\\\\\\\"|\\"\\"|\\"\\\\+\\")*\\\\\\\\?\\"|\\\\\\\\?\'(?:[^\']|\'\'|\'\\\\+\')*\\\\\\\\?\')(?:\\\\s|/\\\\*.*\\\\*/|//.*|#.*)*(?:(?:::|\\\\.|->)(?:\\\\s|/\\\\*.*\\\\*/|//.*|#.*)*\\\\w+(?:\\\\(.*\\\\))?)?)?\\\\)\\\\s*(?:[;\\\\.)}\\\\]|\\\\\\\\]|\\\\?>|%>|$)","options":{"case_sensitive":true,"min_length":5}},"operator":"match_regex"}],"transformers":[]},{"id":"crs-933-170","name":"PHP Injection Attack: Serialized Object Injection","tags":{"type":"php_code_injection","crs_id":"933170","category":"attack_attempt","cwe":"502","capec":"1000/152/586","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies"},{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"[oOcC]:\\\\d+:\\\\\\".+?\\\\\\":\\\\d+:{[\\\\W\\\\w]*}","options":{"case_sensitive":true,"min_length":12}},"operator":"match_regex"}],"transformers":[]},{"id":"crs-933-200","name":"PHP Injection Attack: Wrapper scheme detected","tags":{"type":"php_code_injection","crs_id":"933200","category":"attack_attempt","cwe":"502","capec":"1000/152/586","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"(?:(?:bzip|ssh)2|z(?:lib|ip)|(?:ph|r)ar|expect|glob|ogg)://","options":{"case_sensitive":true,"min_length":6}},"operator":"match_regex"}],"transformers":["removeNulls"]},{"id":"crs-934-100","name":"Node.js Injection Attack 1/2","tags":{"type":"js_code_injection","crs_id":"934100","category":"attack_attempt","cwe":"94","capec":"1000/152/242","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"\\\\b(?:(?:l(?:(?:utimes|chmod)(?:Sync)?|(?:stat|ink)Sync)|w(?:rite(?:(?:File|v)(?:Sync)?|Sync)|atchFile)|u(?:n(?:watchFile|linkSync)|times(?:Sync)?)|s(?:(?:ymlink|tat)Sync|pawn(?:File|Sync))|ex(?:ec(?:File(?:Sync)?|Sync)|istsSync)|a(?:ppendFile|ccess)(?:Sync)?|(?:Caveat|Inode)s|open(?:dir)?Sync|new\\\\s+Function|Availability|\\\\beval)\\\\s*\\\\(|m(?:ain(?:Module\\\\s*(?:\\\\W*\\\\s*(?:constructor|require)|\\\\[)|\\\\s*(?:\\\\W*\\\\s*(?:constructor|require)|\\\\[))|kd(?:temp(?:Sync)?|irSync)\\\\s*\\\\(|odule\\\\.exports\\\\s*=)|c(?:(?:(?:h(?:mod|own)|lose)Sync|reate(?:Write|Read)Stream|p(?:Sync)?)\\\\s*\\\\(|o(?:nstructor\\\\s*(?:\\\\W*\\\\s*_load|\\\\[)|pyFile(?:Sync)?\\\\s*\\\\())|f(?:(?:(?:s(?:(?:yncS)?|tatS)|datas(?:yncS)?)ync|ch(?:mod|own)(?:Sync)?)\\\\s*\\\\(|u(?:nction\\\\s*\\\\(\\\\s*\\\\)\\\\s*{|times(?:Sync)?\\\\s*\\\\())|r(?:e(?:(?:ad(?:(?:File|link|dir)?Sync|v(?:Sync)?)|nameSync)\\\\s*\\\\(|quire\\\\s*(?:\\\\W*\\\\s*main|\\\\[))|m(?:Sync)?\\\\s*\\\\()|process\\\\s*(?:\\\\W*\\\\s*(?:mainModule|binding)|\\\\[)|t(?:his\\\\.constructor|runcateSync\\\\s*\\\\()|_(?:\\\\$\\\\$ND_FUNC\\\\$\\\\$_|_js_function)|global\\\\s*(?:\\\\W*\\\\s*process|\\\\[)|String\\\\s*\\\\.\\\\s*fromCharCode|binding\\\\s*\\\\[)","options":{"case_sensitive":true,"min_length":3}},"operator":"match_regex"}],"transformers":[]},{"id":"crs-934-101","name":"Node.js Injection Attack 2/2","tags":{"type":"js_code_injection","crs_id":"934101","category":"attack_attempt","confidence":"1","cwe":"94","capec":"1000/152/242","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"\\\\b(?:w(?:atch|rite)|(?:spaw|ope)n|exists|close|fork|read)\\\\s*\\\\(","options":{"case_sensitive":true,"min_length":5}},"operator":"match_regex"}],"transformers":[]},{"id":"crs-941-110","name":"XSS Filter - Category 1: Script Tag Vector","tags":{"type":"xss","crs_id":"941110","category":"attack_attempt","cwe":"80","capec":"1000/152/242/63/591","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]},{"address":"server.request.headers.no_cookies","key_path":["referer"]},{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"<script[^>]*>[\\\\s\\\\S]*?","options":{"case_sensitive":false,"min_length":8}},"operator":"match_regex"}],"transformers":["removeNulls","urlDecodeUni"]},{"id":"crs-941-120","name":"XSS Filter - Category 2: Event Handler Vector","tags":{"type":"xss","crs_id":"941120","category":"attack_attempt","cwe":"83","capec":"1000/152/242/63/591/243","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]},{"address":"server.request.headers.no_cookies","key_path":["referer"]},{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"\\\\bon(?:d(?:r(?:ag(?:en(?:ter|d)|leave|start|over)?|op)|urationchange|blclick)|s(?:e(?:ek(?:ing|ed)|arch|lect)|u(?:spend|bmit)|talled|croll|how)|m(?:ouse(?:(?:lea|mo)ve|o(?:ver|ut)|enter|down|up)|essage)|p(?:a(?:ge(?:hide|show)|(?:st|us)e)|lay(?:ing)?|rogress|aste|ointer(?:cancel|down|enter|leave|move|out|over|rawupdate|up))|c(?:anplay(?:through)?|o(?:ntextmenu|py)|hange|lick|ut)|a(?:nimation(?:iteration|start|end)|(?:fterprin|bor)t|uxclick|fterscriptexecute)|t(?:o(?:uch(?:cancel|start|move|end)|ggle)|imeupdate)|f(?:ullscreen(?:change|error)|ocus(?:out|in)?|inish)|(?:(?:volume|hash)chang|o(?:ff|n)lin)e|b(?:efore(?:unload|print)|lur)|load(?:ed(?:meta)?data|start|end)?|r(?:es(?:ize|et)|atechange)|key(?:press|down|up)|w(?:aiting|heel)|in(?:valid|put)|e(?:nded|rror)|unload)[\\\\s\\\\x0B\\\\x09\\\\x0C\\\\x3B\\\\x2C\\\\x28\\\\x3B]*?=[^=]","options":{"min_length":8}},"operator":"match_regex"}],"transformers":["removeNulls","urlDecodeUni"]},{"id":"crs-941-140","name":"XSS Filter - Category 4: Javascript URI Vector","tags":{"type":"xss","crs_id":"941140","category":"attack_attempt","cwe":"84","capec":"1000/152/242/63/591/244","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]},{"address":"server.request.headers.no_cookies","key_path":["referer"]},{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"[a-z]+=(?:[^:=]+:.+;)*?[^:=]+:url\\\\(javascript","options":{"min_length":18}},"operator":"match_regex"}],"transformers":["removeNulls","urlDecodeUni"]},{"id":"crs-941-170","name":"NoScript XSS InjectionChecker: Attribute Injection","tags":{"type":"xss","crs_id":"941170","category":"attack_attempt","cwe":"83","capec":"1000/152/242/63/591/243","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]},{"address":"server.request.headers.no_cookies","key_path":["referer"]},{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"(?:\\\\W|^)(?:javascript:(?:[\\\\s\\\\S]+[=\\\\x5c\\\\(\\\\[\\\\.<]|[\\\\s\\\\S]*?(?:\\\\bname\\\\b|\\\\x5c[ux]\\\\d)))|@\\\\W*?i\\\\W*?m\\\\W*?p\\\\W*?o\\\\W*?r\\\\W*?t\\\\W*?(?:/\\\\*[\\\\s\\\\S]*?)?(?:[\\\\\\"\']|\\\\W*?u\\\\W*?r\\\\W*?l[\\\\s\\\\S]*?\\\\()|[^-]*?-\\\\W*?m\\\\W*?o\\\\W*?z\\\\W*?-\\\\W*?b\\\\W*?i\\\\W*?n\\\\W*?d\\\\W*?i\\\\W*?n\\\\W*?g[^:]*?:\\\\W*?u\\\\W*?r\\\\W*?l[\\\\s\\\\S]*?\\\\(","options":{"min_length":6}},"operator":"match_regex"}],"transformers":["removeNulls","urlDecodeUni"]},{"id":"crs-941-180","name":"Node-Validator Deny List Keywords","tags":{"type":"xss","crs_id":"941180","category":"attack_attempt","cwe":"79","capec":"1000/152/242/63/591","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"options":{"enforce_word_boundary":true},"list":["document.cookie","document.write",".parentnode",".innerhtml","window.location","-moz-binding"]},"operator":"phrase_match"}],"transformers":["removeNulls","lowercase"]},{"id":"crs-941-200","name":"IE XSS Filters - Attack Detected via vmlframe tag","tags":{"type":"xss","crs_id":"941200","category":"attack_attempt","cwe":"80","capec":"1000/152/242/63/591","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"(?i:<.*[:]?vmlframe.*?[\\\\s/+]*?src[\\\\s/+]*=)","options":{"case_sensitive":true,"min_length":13}},"operator":"match_regex"}],"transformers":["removeNulls"]},{"id":"crs-941-210","name":"IE XSS Filters - Obfuscated Attack Detected via javascript injection","tags":{"type":"xss","crs_id":"941210","category":"attack_attempt","cwe":"80","capec":"1000/152/242/63/591","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"(?i:(?:j|&#x?0*(?:74|4A|106|6A);?)(?:\\\\t|\\\\n|\\\\r|&(?:#x?0*(?:9|13|10|A|D);?|tab;|newline;))*(?:a|&#x?0*(?:65|41|97|61);?)(?:\\\\t|\\\\n|\\\\r|&(?:#x?0*(?:9|13|10|A|D);?|tab;|newline;))*(?:v|&#x?0*(?:86|56|118|76);?)(?:\\\\t|\\\\n|\\\\r|&(?:#x?0*(?:9|13|10|A|D);?|tab;|newline;))*(?:a|&#x?0*(?:65|41|97|61);?)(?:\\\\t|\\\\n|\\\\r|&(?:#x?0*(?:9|13|10|A|D);?|tab;|newline;))*(?:s|&#x?0*(?:83|53|115|73);?)(?:\\\\t|\\\\n|\\\\r|&(?:#x?0*(?:9|13|10|A|D);?|tab;|newline;))*(?:c|&#x?0*(?:67|43|99|63);?)(?:\\\\t|\\\\n|\\\\r|&(?:#x?0*(?:9|13|10|A|D);?|tab;|newline;))*(?:r|&#x?0*(?:82|52|114|72);?)(?:\\\\t|\\\\n|\\\\r|&(?:#x?0*(?:9|13|10|A|D);?|tab;|newline;))*(?:i|&#x?0*(?:73|49|105|69);?)(?:\\\\t|\\\\n|\\\\r|&(?:#x?0*(?:9|13|10|A|D);?|tab;|newline;))*(?:p|&#x?0*(?:80|50|112|70);?)(?:\\\\t|\\\\n|\\\\r|&(?:#x?0*(?:9|13|10|A|D);?|tab;|newline;))*(?:t|&#x?0*(?:84|54|116|74);?)(?:\\\\t|\\\\n|\\\\r|&(?:#x?0*(?:9|13|10|A|D);?|tab;|newline;))*(?::|&(?:#x?0*(?:58|3A);?|colon;)).)","options":{"case_sensitive":true,"min_length":12}},"operator":"match_regex"}],"transformers":["removeNulls"]},{"id":"crs-941-220","name":"IE XSS Filters - Obfuscated Attack Detected via vbscript injection","tags":{"type":"xss","crs_id":"941220","category":"attack_attempt","cwe":"80","capec":"1000/152/242/63/591","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"(?i:(?:v|&#x?0*(?:86|56|118|76);?)(?:\\\\t|&(?:#x?0*(?:9|13|10|A|D);?|tab;|newline;))*(?:b|&#x?0*(?:66|42|98|62);?)(?:\\\\t|&(?:#x?0*(?:9|13|10|A|D);?|tab;|newline;))*(?:s|&#x?0*(?:83|53|115|73);?)(?:\\\\t|&(?:#x?0*(?:9|13|10|A|D);?|tab;|newline;))*(?:c|&#x?0*(?:67|43|99|63);?)(?:\\\\t|&(?:#x?0*(?:9|13|10|A|D);?|tab;|newline;))*(?:r|&#x?0*(?:82|52|114|72);?)(?:\\\\t|&(?:#x?0*(?:9|13|10|A|D);?|tab;|newline;))*(?:i|&#x?0*(?:73|49|105|69);?)(?:\\\\t|&(?:#x?0*(?:9|13|10|A|D);?|tab;|newline;))*(?:p|&#x?0*(?:80|50|112|70);?)(?:\\\\t|&(?:#x?0*(?:9|13|10|A|D);?|tab;|newline;))*(?:t|&#x?0*(?:84|54|116|74);?)(?:\\\\t|&(?:#x?0*(?:9|13|10|A|D);?|tab;|newline;))*(?::|&(?:#x?0*(?:58|3A);?|colon;)).)","options":{"case_sensitive":true,"min_length":10}},"operator":"match_regex"}],"transformers":["removeNulls"]},{"id":"crs-941-230","name":"IE XSS Filters - Attack Detected via embed tag","tags":{"type":"xss","crs_id":"941230","category":"attack_attempt","cwe":"83","capec":"1000/152/242/63/591/243","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"<EMBED[\\\\s/+].*?(?:src|type).*?=","options":{"min_length":11}},"operator":"match_regex"}],"transformers":["removeNulls"]},{"id":"crs-941-240","name":"IE XSS Filters - Attack Detected via import tag","tags":{"type":"xss","crs_id":"941240","category":"attack_attempt","cwe":"83","capec":"1000/152/242/63/591/243","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"<[?]?import[\\\\s/+\\\\S]*?implementation[\\\\s/+]*?=","options":{"case_sensitive":true,"min_length":22}},"operator":"match_regex"}],"transformers":["lowercase","removeNulls"]},{"id":"crs-941-270","name":"IE XSS Filters - Attack Detected via link tag","tags":{"type":"xss","crs_id":"941270","category":"attack_attempt","cwe":"83","capec":"1000/152/242/63/591/243","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"<LINK[\\\\s/+].*?href[\\\\s/+]*=","options":{"min_length":11}},"operator":"match_regex"}],"transformers":["removeNulls"]},{"id":"crs-941-280","name":"IE XSS Filters - Attack Detected via base tag","tags":{"type":"xss","crs_id":"941280","category":"attack_attempt","cwe":"83","capec":"1000/152/242/63/591/243","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"<BASE[\\\\s/+].*?href[\\\\s/+]*=","options":{"min_length":11}},"operator":"match_regex"}],"transformers":["removeNulls"]},{"id":"crs-941-290","name":"IE XSS Filters - Attack Detected via applet tag","tags":{"type":"xss","crs_id":"941290","category":"attack_attempt","cwe":"83","capec":"1000/152/242/63/591/243","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"<APPLET[\\\\s/+>]","options":{"min_length":8}},"operator":"match_regex"}],"transformers":["removeNulls"]},{"id":"crs-941-300","name":"IE XSS Filters - Attack Detected via object tag","tags":{"type":"xss","crs_id":"941300","category":"attack_attempt","cwe":"83","capec":"1000/152/242/63/591/243","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"<OBJECT[\\\\s/+].*?(?:type|codetype|classid|code|data)[\\\\s/+]*=","options":{"min_length":13}},"operator":"match_regex"}],"transformers":["removeNulls"]},{"id":"crs-941-350","name":"UTF-7 Encoding IE XSS - Attack Detected","tags":{"type":"xss","crs_id":"941350","category":"attack_attempt","cwe":"87","capec":"1000/152/242/63/591/199","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"\\\\+ADw-.*(?:\\\\+AD4-|>)|<.*\\\\+AD4-","options":{"case_sensitive":true,"min_length":6}},"operator":"match_regex"}],"transformers":[]},{"id":"crs-941-360","name":"JSFuck / Hieroglyphy obfuscation detected","tags":{"type":"xss","crs_id":"941360","category":"attack_attempt","cwe":"87","capec":"1000/152/242/63/591/199","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"![!+ ]\\\\[\\\\]","options":{"case_sensitive":true,"min_length":4}},"operator":"match_regex"}],"transformers":[]},{"id":"crs-941-390","name":"Javascript method detected","tags":{"type":"xss","crs_id":"941390","category":"attack_attempt","confidence":"1","cwe":"79","capec":"1000/152/242/63/591","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"\\\\b(?i:eval|settimeout|setinterval|new\\\\s+Function|alert|prompt)[\\\\s+]*\\\\([^\\\\)]","options":{"case_sensitive":true,"min_length":5}},"operator":"match_regex"}],"transformers":[]},{"id":"crs-942-100","name":"SQL Injection Attack Detected via libinjection","tags":{"type":"sql_injection","crs_id":"942100","category":"attack_attempt","cwe":"89","capec":"1000/152/248/66","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}]},"operator":"is_sqli"}],"transformers":["removeNulls"]},{"id":"crs-942-160","name":"Detects blind sqli tests using sleep() or benchmark()","tags":{"type":"sql_injection","crs_id":"942160","category":"attack_attempt","cwe":"89","capec":"1000/152/248/66/7","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"(?i:sleep\\\\(\\\\s*?\\\\d*?\\\\s*?\\\\)|benchmark\\\\(.*?\\\\,.*?\\\\))","options":{"case_sensitive":true,"min_length":7}},"operator":"match_regex"}],"transformers":[]},{"id":"crs-942-240","name":"Detects MySQL charset switch and MSSQL DoS attempts","tags":{"type":"sql_injection","crs_id":"942240","category":"attack_attempt","cwe":"89","capec":"1000/152/248/66/7","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"(?:[\\\\\\"\'`](?:;*?\\\\s*?waitfor\\\\s+(?:delay|time)\\\\s+[\\\\\\"\'`]|;.*?:\\\\s*?goto)|alter\\\\s*?\\\\w+.*?cha(?:racte)?r\\\\s+set\\\\s+\\\\w+)","options":{"min_length":7}},"operator":"match_regex"}],"transformers":[]},{"id":"crs-942-250","name":"Detects MATCH AGAINST, MERGE and EXECUTE IMMEDIATE injections","tags":{"type":"sql_injection","crs_id":"942250","category":"attack_attempt","cwe":"89","capec":"1000/152/248/66","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"(?i:merge.*?using\\\\s*?\\\\(|execute\\\\s*?immediate\\\\s*?[\\\\\\"\'`]|match\\\\s*?[\\\\w(?:),+-]+\\\\s*?against\\\\s*?\\\\()","options":{"case_sensitive":true,"min_length":11}},"operator":"match_regex"}],"transformers":[]},{"id":"crs-942-270","name":"Basic SQL injection","tags":{"type":"sql_injection","crs_id":"942270","category":"attack_attempt","cwe":"89","capec":"1000/152/248/66","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"union.*?select.*?from","options":{"min_length":15}},"operator":"match_regex"}],"transformers":[]},{"id":"crs-942-280","name":"SQL Injection with delay functions","tags":{"type":"sql_injection","crs_id":"942280","category":"attack_attempt","cwe":"89","capec":"1000/152/248/66/7","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"(?:;\\\\s*?shutdown\\\\s*?(?:[#;{]|\\\\/\\\\*|--)|waitfor\\\\s*?delay\\\\s?[\\\\\\"\'`]+\\\\s?\\\\d|select\\\\s*?pg_sleep)","options":{"min_length":10}},"operator":"match_regex"}],"transformers":[]},{"id":"crs-942-290","name":"Finds basic MongoDB SQL injection attempts","tags":{"type":"nosql_injection","crs_id":"942290","category":"attack_attempt","cwe":"943","capec":"1000/152/248/676","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"(?i:(?:\\\\[?\\\\$(?:(?:s(?:lic|iz)|wher)e|e(?:lemMatch|xists|q)|n(?:o[rt]|in?|e)|l(?:ike|te?)|t(?:ext|ype)|a(?:ll|nd)|jsonSchema|between|regex|x?or|div|mod)\\\\]?)\\\\b)","options":{"case_sensitive":true,"min_length":3}},"operator":"match_regex"}],"transformers":["keys_only"]},{"id":"crs-942-360","name":"Detects concatenated basic SQL injection and SQLLFI attempts","tags":{"type":"sql_injection","crs_id":"942360","category":"attack_attempt","cwe":"89","capec":"1000/152/248/66/470","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"(?:^[\\\\W\\\\d]+\\\\s*?(?:alter\\\\s*(?:a(?:(?:pplication\\\\s*rol|ggregat)e|s(?:ymmetric\\\\s*ke|sembl)y|u(?:thorization|dit)|vailability\\\\s*group)|c(?:r(?:yptographic\\\\s*provider|edential)|o(?:l(?:latio|um)|nversio)n|ertificate|luster)|s(?:e(?:rv(?:ice|er)|curity|quence|ssion|arch)|y(?:mmetric\\\\s*key|nonym)|togroup|chema)|m(?:a(?:s(?:ter\\\\s*key|k)|terialized)|e(?:ssage\\\\s*type|thod)|odule)|l(?:o(?:g(?:file\\\\s*group|in)|ckdown)|a(?:ngua|r)ge|ibrary)|t(?:(?:abl(?:espac)?|yp)e|r(?:igger|usted)|hreshold|ext)|p(?:a(?:rtition|ckage)|ro(?:cedur|fil)e|ermission)|d(?:i(?:mension|skgroup)|atabase|efault|omain)|r(?:o(?:l(?:lback|e)|ute)|e(?:sourc|mot)e)|f(?:u(?:lltext|nction)|lashback|oreign)|e(?:xte(?:nsion|rnal)|(?:ndpoi|ve)nt)|in(?:dex(?:type)?|memory|stance)|b(?:roker\\\\s*priority|ufferpool)|x(?:ml\\\\s*schema|srobject)|w(?:ork(?:load)?|rapper)|hi(?:erarchy|stogram)|o(?:perator|utline)|(?:nicknam|queu)e|us(?:age|er)|group|java|view)|union\\\\s*(?:(?:distin|sele)ct|all))\\\\b|\\\\b(?:(?:(?:trunc|cre|upd)at|renam)e|(?:inser|selec)t|de(?:lete|sc)|alter|load)\\\\s+(?:group_concat|load_file|char)\\\\b\\\\s*\\\\(?|[\\\\s(]load_file\\\\s*?\\\\(|[\\\\\\"\'`]\\\\s+regexp\\\\W)","options":{"min_length":5}},"operator":"match_regex"}],"transformers":[]},{"id":"crs-942-500","name":"MySQL in-line comment detected","tags":{"type":"sql_injection","crs_id":"942500","category":"attack_attempt","cwe":"89","capec":"1000/152/248/66","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"(?i:/\\\\*[!+](?:[\\\\w\\\\s=_\\\\-(?:)]+)?\\\\*/)","options":{"case_sensitive":true,"min_length":5}},"operator":"match_regex"}],"transformers":[]},{"id":"crs-943-100","name":"Possible Session Fixation Attack: Setting Cookie Values in HTML","tags":{"type":"http_protocol_violation","crs_id":"943100","category":"attack_attempt","cwe":"384","capec":"1000/225/21/593/61","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"(?i:\\\\.cookie\\\\b.*?;\\\\W*?(?:expires|domain)\\\\W*?=|\\\\bhttp-equiv\\\\W+set-cookie\\\\b)","options":{"case_sensitive":true,"min_length":15}},"operator":"match_regex"}],"transformers":[]},{"id":"crs-944-100","name":"Remote Command Execution: Suspicious Java class detected","tags":{"type":"java_code_injection","crs_id":"944100","category":"attack_attempt","cwe":"94","capec":"1000/152/242","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"server.request.headers.no_cookies"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"java\\\\.lang\\\\.(?:runtime|processbuilder)","options":{"case_sensitive":true,"min_length":17}},"operator":"match_regex"}],"transformers":["lowercase"]},{"id":"crs-944-110","name":"Remote Command Execution: Java process spawn (CVE-2017-9805)","tags":{"type":"java_code_injection","category":"attack_attempt","cwe":"94","capec":"1000/152/242","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"server.request.headers.no_cookies"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"(?:unmarshaller|base64data|java\\\\.).*(?:runtime|processbuilder)","options":{"case_sensitive":false,"min_length":13}},"operator":"match_regex"}],"transformers":[]},{"id":"crs-944-130","name":"Suspicious Java class detected","tags":{"type":"java_code_injection","crs_id":"944130","category":"attack_attempt","cwe":"94","capec":"1000/152/242","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"server.request.headers.no_cookies"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"list":["com.opensymphony.xwork2","com.sun.org.apache","java.io.bufferedinputstream","java.io.bufferedreader","java.io.bytearrayinputstream","java.io.bytearrayoutputstream","java.io.chararrayreader","java.io.datainputstream","java.io.file","java.io.fileoutputstream","java.io.filepermission","java.io.filewriter","java.io.filterinputstream","java.io.filteroutputstream","java.io.filterreader","java.io.inputstream","java.io.inputstreamreader","java.io.linenumberreader","java.io.objectoutputstream","java.io.outputstream","java.io.pipedoutputstream","java.io.pipedreader","java.io.printstream","java.io.pushbackinputstream","java.io.reader","java.io.stringreader","java.lang.class","java.lang.integer","java.lang.number","java.lang.object","java.lang.process","java.lang.reflect","java.lang.runtime","java.lang.string","java.lang.stringbuilder","java.lang.system","javax.script.scriptenginemanager","org.apache.commons","org.apache.struts","org.apache.struts2","org.omg.corba","java.beans.xmldecode"],"options":{"enforce_word_boundary":true}},"operator":"phrase_match"}],"transformers":["lowercase"]},{"id":"crs-944-260","name":"Remote Command Execution: Malicious class-loading payload","tags":{"type":"java_code_injection","crs_id":"944260","category":"attack_attempt","cwe":"94","capec":"1000/152/242","confidence":"1"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"server.request.headers.no_cookies"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"(?:class\\\\.module\\\\.classLoader\\\\.resources\\\\.context\\\\.parent\\\\.pipeline|springframework\\\\.context\\\\.support\\\\.FileSystemXmlApplicationContext)","options":{"case_sensitive":true,"min_length":58}},"operator":"match_regex"}],"transformers":[]},{"id":"dog-000-001","name":"Look for Cassandra injections","tags":{"type":"nosql_injection","category":"attack_attempt","cwe":"943","capec":"1000/152/248/676","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"},{"address":"server.request.headers.no_cookies"}],"regex":"\\\\ballow\\\\s+filtering\\\\b"},"operator":"match_regex"}],"transformers":["removeComments"]},{"id":"dog-000-002","name":"OGNL - Look for formatting injection patterns","tags":{"type":"java_code_injection","category":"attack_attempt","cwe":"94","capec":"1000/152/242","module":"waf"},"conditions":[{"operator":"match_regex","parameters":{"inputs":[{"address":"server.request.uri.raw"},{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"},{"address":"server.request.headers.no_cookies"}],"regex":"[#%$]{(?:[^}]+[^\\\\w\\\\s}\\\\-_][^}]+|\\\\d+-\\\\d+)}","options":{"case_sensitive":true}}}],"transformers":[]},{"id":"dog-000-003","name":"OGNL - Detect OGNL exploitation primitives","tags":{"type":"java_code_injection","category":"attack_attempt","cwe":"94","capec":"1000/152/242","confidence":"1","module":"waf"},"conditions":[{"operator":"match_regex","parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"server.request.headers.no_cookies"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"[@#]ognl","options":{"case_sensitive":true}}}],"transformers":[]},{"id":"dog-000-004","name":"Spring4Shell - Attempts to exploit the Spring4shell vulnerability","tags":{"type":"exploit_detection","category":"attack_attempt","cwe":"94","capec":"1000/152/242","confidence":"1"},"conditions":[{"operator":"match_regex","parameters":{"inputs":[{"address":"server.request.body"}],"regex":"^class\\\\.module\\\\.classLoader\\\\.","options":{"case_sensitive":false}}}],"transformers":["keys_only"]},{"id":"dog-000-005","name":"Node.js: Prototype pollution through __proto__","tags":{"type":"js_code_injection","category":"attack_attempt","cwe":"1321","capec":"1000/152/242","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"}],"regex":"^__proto__$"},"operator":"match_regex"}],"transformers":["keys_only"]},{"id":"dog-000-006","name":"Node.js: Prototype pollution through constructor.prototype","tags":{"type":"js_code_injection","category":"attack_attempt","cwe":"1321","capec":"1000/152/242","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"}],"regex":"^constructor$"},"operator":"match_regex"},{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"}],"regex":"^prototype$"},"operator":"match_regex"}],"transformers":["keys_only"]},{"id":"dog-000-007","name":"Server side template injection: Velocity & Freemarker","tags":{"type":"java_code_injection","category":"attack_attempt","cwe":"1336","capec":"1000/152/242/19","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"server.request.headers.no_cookies"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"#(?:set|foreach|macro|parse|if)\\\\(.*\\\\)|<#assign.*>"},"operator":"match_regex"}],"transformers":[]},{"id":"dog-913-001","name":"BurpCollaborator OOB domain","tags":{"type":"attack_tool","category":"attack_attempt","tool_name":"BurpCollaborator","cwe":"200","capec":"1000/118/169","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"server.request.headers.no_cookies"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"\\\\b(?:burpcollaborator\\\\.net|oastify\\\\.com)\\\\b"},"operator":"match_regex"}],"transformers":[]},{"id":"dog-913-002","name":"Qualys OOB domain","tags":{"type":"commercial_scanner","category":"attack_attempt","tool_name":"Qualys","cwe":"200","capec":"1000/118/169","confidence":"0","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"server.request.headers.no_cookies"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"\\\\bqualysperiscope\\\\.com\\\\b|\\\\.oscomm\\\\."},"operator":"match_regex"}],"transformers":[]},{"id":"dog-913-003","name":"Probely OOB domain","tags":{"type":"commercial_scanner","category":"attack_attempt","tool_name":"Probely","cwe":"200","capec":"1000/118/169","confidence":"0","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"server.request.headers.no_cookies"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"\\\\bprbly\\\\.win\\\\b"},"operator":"match_regex"}],"transformers":[]},{"id":"dog-913-004","name":"Known malicious out-of-band interaction domain","tags":{"type":"security_scanner","category":"attack_attempt","cwe":"200","capec":"1000/118/169","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"server.request.headers.no_cookies"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"\\\\b(?:webhook\\\\.site|\\\\.canarytokens\\\\.com|vii\\\\.one|act1on3\\\\.ru|gdsburp\\\\.com|arcticwolf\\\\.net|oob\\\\.li|htbiw\\\\.com|h4\\\\.vc|mochan\\\\.cloud|imshopping\\\\.com|bootstrapnodejs\\\\.com|mooo-ng\\\\.com|securitytrails\\\\.com|canyouhackit\\\\.io|7bae\\\\.xyz)\\\\b"},"operator":"match_regex"}],"transformers":[]},{"id":"dog-913-005","name":"Known suspicious out-of-band interaction domain","tags":{"type":"security_scanner","category":"attack_attempt","cwe":"200","capec":"1000/118/169","confidence":"0","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"server.request.headers.no_cookies"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"\\\\b(?:\\\\.ngrok\\\\.io|requestbin\\\\.com|requestbin\\\\.net)\\\\b"},"operator":"match_regex"}],"transformers":[]},{"id":"dog-913-006","name":"Rapid7 OOB domain","tags":{"type":"commercial_scanner","category":"attack_attempt","tool_name":"Rapid7","cwe":"200","capec":"1000/118/169","confidence":"0","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"server.request.headers.no_cookies"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"\\\\bappspidered\\\\.rapid7\\\\."},"operator":"match_regex"}],"transformers":[]},{"id":"dog-913-007","name":"Interact.sh OOB domain","tags":{"type":"attack_tool","category":"attack_attempt","tool_name":"interact.sh","cwe":"200","capec":"1000/118/169","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"server.request.headers.no_cookies"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"\\\\b(?:interact\\\\.sh|oast\\\\.(?:pro|live|site|online|fun|me)|indusfacefinder\\\\.in|where\\\\.land|syhunt\\\\.net|tssrt\\\\.de|boardofcyber\\\\.io|assetnote-callback\\\\.com|praetorianlabs\\\\.dev|netspi\\\\.sh)\\\\b"},"operator":"match_regex"}],"transformers":[]},{"id":"dog-913-008","name":"Netsparker OOB domain","tags":{"type":"commercial_scanner","category":"attack_attempt","tool_name":"Netsparker","cwe":"200","capec":"1000/118/169","confidence":"0","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"server.request.headers.no_cookies"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"\\\\b(?:\\\\.|(?:\\\\\\\\|&#)(?:0*46|x0*2e);)?r87(?:\\\\.|(?:\\\\\\\\|&#)(?:0*46|x0*2e);)(?:me|com)\\\\b","options":{"case_sensitive":false,"min_length":7}},"operator":"match_regex"}],"transformers":[]},{"id":"dog-913-009","name":"WhiteHat Security OOB domain","tags":{"type":"commercial_scanner","category":"attack_attempt","tool_name":"WhiteHatSecurity","cwe":"200","capec":"1000/118/169","confidence":"0","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"server.request.headers.no_cookies"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"\\\\bwhsec(?:\\\\.|(?:\\\\\\\\|&#)(?:0*46|x0*2e);)us\\\\b","options":{"case_sensitive":false,"min_length":8}},"operator":"match_regex"}],"transformers":[]},{"id":"dog-913-010","name":"Nessus OOB domain","tags":{"type":"commercial_scanner","category":"attack_attempt","tool_name":"Nessus","cwe":"200","capec":"1000/118/169","confidence":"0","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"server.request.headers.no_cookies"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"\\\\b\\\\.nessus\\\\.org\\\\b","options":{"case_sensitive":false,"min_length":8}},"operator":"match_regex"}],"transformers":[]},{"id":"dog-913-011","name":"Watchtowr OOB domain","tags":{"type":"commercial_scanner","category":"attack_attempt","tool_name":"Watchtowr","cwe":"200","capec":"1000/118/169","confidence":"0","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"server.request.headers.no_cookies"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"\\\\bwatchtowr\\\\.com\\\\b","options":{"case_sensitive":false,"min_length":8}},"operator":"match_regex"}],"transformers":[]},{"id":"dog-913-012","name":"AppCheck NG OOB domain","tags":{"type":"commercial_scanner","category":"attack_attempt","tool_name":"AppCheckNG","cwe":"200","capec":"1000/118/169","confidence":"0","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"server.request.headers.no_cookies"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"\\\\bptst\\\\.io\\\\b","options":{"case_sensitive":false,"min_length":7}},"operator":"match_regex"}],"transformers":[]},{"id":"dog-920-001","name":"JWT authentication bypass","tags":{"type":"http_protocol_violation","category":"attack_attempt","cwe":"287","capec":"1000/225/115","confidence":"0","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.cookies"},{"address":"server.request.headers.no_cookies","key_path":["authorization"]}],"regex":"^(?:Bearer )?ey[A-Za-z0-9+_\\\\-/]*([QY][UW]x[Hn]Ij([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[\\\\x2b\\\\x2f-9A-Za-z]ICJ[Ou][Tb][02]5[Fl]|[QY][UW]x[Hn]I([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[048AEIMQUYcgkosw]gOiAi[Tb][km]9[Ou][RZ][Q-Za-f]|[QY][UW]x[Hn]Ij([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[048AEIMQUYcgkosw]gI[km]5[Pv][Tb][km][U-X]|[\\\\x2b\\\\x2f-9A-Za-z]{2}[159BFJNRVZdhlptx][Bh][Tb][EG]ci([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[048AEIMQUYcgkosw]gO([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[CSiy]Ai[Tb][km]9[Ou][RZ][Q-Za-f]|[QY][UW]x[Hn]I([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[048AEIMQUYcgkosw]gO([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*ICJ[Ou][Tb][02]5[Fl]|[\\\\x2b\\\\x2f-9A-Za-z][02EGUWkm]F[Ms][RZ]y([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[CSiy]A6([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*ICJ[Ou][Tb][02]5[Fl]|[QY][UW]x[Hn]I([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*ID([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*ICJ[Ou][Tb][02]5[Fl]|[\\\\x2b\\\\x2f-9A-Za-z]{2}[159BFJNRVZdhlptx][Bh][Tb][EG]ciID([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[\\\\x2b\\\\x2f-9A-Za-z]ICJ[Ou][Tb][02]5[Fl]|[QY][UW]x[Hn]I([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[\\\\x2b\\\\x2f-9A-Za-z]IDogI[km]5[Pv][Tb][km][U-X]|[QY][UW]x[Hn]I([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[CSiy]A6ICJ[Ou][Tb][02]5[Fl]|[\\\\x2b\\\\x2f-9A-Za-z][02EGUWkm]F[Ms][RZ]y([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*ID([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[CSiy]Ai[Tb][km]9[Ou][RZ][Q-Za-f]|[QY][UW]x[Hn]IiA6ICJ[Ou][Tb][02]5[Fl]|[\\\\x2b\\\\x2f-9A-Za-z]{2}[159BFJNRVZdhlptx][Bh][Tb][EG]ci([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[048AEIMQUYcgkosw]gO([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[048AEIMQUYcgkosw]gI[km]5[Pv][Tb][km][U-X]|[QY][UW]x[Hn]I([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*ID([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[048AEIMQUYcgkosw]gI[km]5[Pv][Tb][km][U-X]|[QY][UW]x[Hn]I([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[\\\\x2b\\\\x2f-9A-Za-z]IDoi[Tb][km]9[Ou][RZ][Q-Za-f]|[\\\\x2b\\\\x2f-9A-Za-z]{2}[159BFJNRVZdhlptx][Bh][Tb][EG]ci([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[CSiy]A6([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[CSiy]Ai[Tb][km]9[Ou][RZ][Q-Za-f]|[QY][UW]x[Hn]I([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[CSiy]A6([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[\\\\x2b\\\\x2f-9A-Za-z]ICJ[Ou][Tb][02]5[Fl]|[QY][UW]x[Hn]Ij([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*ICJ[Ou][Tb][02]5[Fl]|[\\\\x2b\\\\x2f-9A-Za-z][02EGUWkm]F[Ms][RZ]y([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[048AEIMQUYcgkosw]gOiAi[Tb][km]9[Ou][RZ][Q-Za-f]|[QY][UW]x[Hn]I([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[\\\\x2b\\\\x2f-9A-Za-z]ID([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[\\\\x2b\\\\x2f-9A-Za-z]ICJ[Ou][Tb][02]5[Fl]|[\\\\x2b\\\\x2f-9A-Za-z]{2}[159BFJNRVZdhlptx][Bh][Tb][EG]ci([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*ID([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[CSiy]Ai[Tb][km]9[Ou][RZ][Q-Za-f]|[\\\\x2b\\\\x2f-9A-Za-z]{2}[159BFJNRVZdhlptx][Bh][Tb][EG]ci([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*ID([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[\\\\x2b\\\\x2f-9A-Za-z]ICJ[Ou][Tb][02]5[Fl]|[\\\\x2b\\\\x2f-9A-Za-z]{2}[159BFJNRVZdhlptx][Bh][Tb][EG]ciOiAi[Tb][km]9[Ou][RZ][Q-Za-f]|[\\\\x2b\\\\x2f-9A-Za-z]{2}[159BFJNRVZdhlptx][Bh][Tb][EG]ci([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*IDogI[km]5[Pv][Tb][km][U-X]|[\\\\x2b\\\\x2f-9A-Za-z][02EGUWkm]F[Ms][RZ]y([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[\\\\x2b\\\\x2f-9A-Za-z]IDogI[km]5[Pv][Tb][km][U-X]|[\\\\x2b\\\\x2f-9A-Za-z][02EGUWkm]F[Ms][RZ]yIgO([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[CSiy]Ai[Tb][km]9[Ou][RZ][Q-Za-f]|[\\\\x2b\\\\x2f-9A-Za-z]{2}[159BFJNRVZdhlptx][Bh][Tb][EG]ci([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[CSiy]A6([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*ICJ[Ou][Tb][02]5[Fl]|[\\\\x2b\\\\x2f-9A-Za-z][02EGUWkm]F[Ms][RZ]y([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[CSiy]A6([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[048AEIMQUYcgkosw]gI[km]5[Pv][Tb][km][U-X]|[\\\\x2b\\\\x2f-9A-Za-z]{2}[159BFJNRVZdhlptx][Bh][Tb][EG]ciIDoi[Tb][km]9[Ou][RZ][Q-Za-f]|[QY][UW]x[Hn]I([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*IDogI[km]5[Pv][Tb][km][U-X]|[\\\\x2b\\\\x2f-9A-Za-z][02EGUWkm]F[Ms][RZ]yIgOiJ[Ou][Tb][02]5[Fl]|[QY][UW]x[Hn]I([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[048AEIMQUYcgkosw]gO([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[\\\\x2b\\\\x2f-9A-Za-z]ICJ[Ou][Tb][02]5[Fl]|[\\\\x2b\\\\x2f-9A-Za-z]{2}[159BFJNRVZdhlptx][Bh][Tb][EG]ciO([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[048AEIMQUYcgkosw]gI[km]5[Pv][Tb][km][U-X]|[QY][UW]x[Hn]I([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[\\\\x2b\\\\x2f-9A-Za-z]ID([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[048AEIMQUYcgkosw]gI[km]5[Pv][Tb][km][U-X]|[\\\\x2b\\\\x2f-9A-Za-z]{2}[159BFJNRVZdhlptx][Bh][Tb][EG]ci([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[\\\\x2b\\\\x2f-9A-Za-z]IDoi[Tb][km]9[Ou][RZ][Q-Za-f]|[\\\\x2b\\\\x2f-9A-Za-z]{2}[159BFJNRVZdhlptx][Bh][Tb][EG]ciID([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*ICJ[Ou][Tb][02]5[Fl]|[\\\\x2b\\\\x2f-9A-Za-z][02EGUWkm]F[Ms][RZ]y([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[048AEIMQUYcgkosw]gO([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[\\\\x2b\\\\x2f-9A-Za-z]ICJ[Ou][Tb][02]5[Fl]|[\\\\x2b\\\\x2f-9A-Za-z]{2}[159BFJNRVZdhlptx][Bh][Tb][EG]ci([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*ID([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[048AEIMQUYcgkosw]gI[km]5[Pv][Tb][km][U-X]|[\\\\x2b\\\\x2f-9A-Za-z]{2}[159BFJNRVZdhlptx][Bh][Tb][EG]ci([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[\\\\x2b\\\\x2f-9A-Za-z]IDogI[km]5[Pv][Tb][km][U-X]|[\\\\x2b\\\\x2f-9A-Za-z][02EGUWkm]F[Ms][RZ]yI6([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*ICJ[Ou][Tb][02]5[Fl]|[\\\\x2b\\\\x2f-9A-Za-z]{2}[159BFJNRVZdhlptx][Bh][Tb][EG]ci([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[\\\\x2b\\\\x2f-9A-Za-z]ID([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[048AEIMQUYcgkosw]gI[km]5[Pv][Tb][km][U-X]|[\\\\x2b\\\\x2f-9A-Za-z][02EGUWkm]F[Ms][RZ]yI6([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[\\\\x2b\\\\x2f-9A-Za-z]ICJ[Ou][Tb][02]5[Fl]|[\\\\x2b\\\\x2f-9A-Za-z]{2}[159BFJNRVZdhlptx][Bh][Tb][EG]ci([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[048AEIMQUYcgkosw]gO([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[\\\\x2b\\\\x2f-9A-Za-z]ICJ[Ou][Tb][02]5[Fl]|[\\\\x2b\\\\x2f-9A-Za-z][02EGUWkm]F[Ms][RZ]y([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[\\\\x2b\\\\x2f-9A-Za-z]ID([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[\\\\x2b\\\\x2f-9A-Za-z]ICJ[Ou][Tb][02]5[Fl]|[QY][UW]x[Hn]IiA6([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*ICJ[Ou][Tb][02]5[Fl]|[QY][UW]x[Hn]I([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[048AEIMQUYcgkosw]gO([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[048AEIMQUYcgkosw]gI[km]5[Pv][Tb][km][U-X]|[\\\\x2b\\\\x2f-9A-Za-z][02EGUWkm]F[Ms][RZ]y([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[\\\\x2b\\\\x2f-9A-Za-z]ID([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[CSiy]Ai[Tb][km]9[Ou][RZ][Q-Za-f]|[\\\\x2b\\\\x2f-9A-Za-z][02EGUWkm]F[Ms][RZ]y([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*IDogI[km]5[Pv][Tb][km][U-X]|[\\\\x2b\\\\x2f-9A-Za-z][02EGUWkm]F[Ms][RZ]yIgO([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*ICJ[Ou][Tb][02]5[Fl]|[QY][UW]x[Hn]Ij([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[CSiy]Ai[Tb][km]9[Ou][RZ][Q-Za-f]|[QY][UW]x[Hn]I([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[CSiy]A6([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[048AEIMQUYcgkosw]gI[km]5[Pv][Tb][km][U-X]|[\\\\x2b\\\\x2f-9A-Za-z][02EGUWkm]F[Ms][RZ]y([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[CSiy]A6ICJ[Ou][Tb][02]5[Fl]|[QY][UW]x[Hn]I([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[\\\\x2b\\\\x2f-9A-Za-z]ID([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[CSiy]Ai[Tb][km]9[Ou][RZ][Q-Za-f]|[\\\\x2b\\\\x2f-9A-Za-z]{2}[159BFJNRVZdhlptx][Bh][Tb][EG]ciOiJ[Ou][Tb][02]5[Fl]|[\\\\x2b\\\\x2f-9A-Za-z]{2}[159BFJNRVZdhlptx][Bh][Tb][EG]ci([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*IDoi[Tb][km]9[Ou][RZ][Q-Za-f]|[QY][UW]x[Hn]I([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[048AEIMQUYcgkosw]gOiJ[Ou][Tb][02]5[Fl]|[\\\\x2b\\\\x2f-9A-Za-z]{2}[159BFJNRVZdhlptx][Bh][Tb][EG]ciO([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*ICJ[Ou][Tb][02]5[Fl]|[\\\\x2b\\\\x2f-9A-Za-z][02EGUWkm]F[Ms][RZ]yIgOiAi[Tb][km]9[Ou][RZ][Q-Za-f]|[\\\\x2b\\\\x2f-9A-Za-z][02EGUWkm]F[Ms][RZ]y([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[\\\\x2b\\\\x2f-9A-Za-z]IDoi[Tb][km]9[Ou][RZ][Q-Za-f]|[\\\\x2b\\\\x2f-9A-Za-z]{2}[159BFJNRVZdhlptx][Bh][Tb][EG]ciID([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[048AEIMQUYcgkosw]gI[km]5[Pv][Tb][km][U-X]|[\\\\x2b\\\\x2f-9A-Za-z]{2}[159BFJNRVZdhlptx][Bh][Tb][EG]ci([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[CSiy]A6ICJ[Ou][Tb][02]5[Fl]|[QY][UW]x[Hn]IjogI[km]5[Pv][Tb][km][U-X]|[QY][UW]x[Hn]I([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[\\\\x2b\\\\x2f-9A-Za-z]ID([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*ICJ[Ou][Tb][02]5[Fl]|[QY][UW]x[Hn]I([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[CSiy]A6([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[CSiy]Ai[Tb][km]9[Ou][RZ][Q-Za-f]|[\\\\x2b\\\\x2f-9A-Za-z][02EGUWkm]F[Ms][RZ]y([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[048AEIMQUYcgkosw]gO([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[CSiy]Ai[Tb][km]9[Ou][RZ][Q-Za-f]|[\\\\x2b\\\\x2f-9A-Za-z][02EGUWkm]F[Ms][RZ]y([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*ID([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[\\\\x2b\\\\x2f-9A-Za-z]ICJ[Ou][Tb][02]5[Fl]|[\\\\x2b\\\\x2f-9A-Za-z]{2}[159BFJNRVZdhlptx][Bh][Tb][EG]ciO([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[CSiy]Ai[Tb][km]9[Ou][RZ][Q-Za-f]|[QY][UW]x[Hn]IiA6I[km]5[Pv][Tb][km][U-X]|[\\\\x2b\\\\x2f-9A-Za-z]{2}[159BFJNRVZdhlptx][Bh][Tb][EG]ci([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[\\\\x2b\\\\x2f-9A-Za-z]ID([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*ICJ[Ou][Tb][02]5[Fl]|[\\\\x2b\\\\x2f-9A-Za-z]{2}[159BFJNRVZdhlptx][Bh][Tb][EG]ciID([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[CSiy]Ai[Tb][km]9[Ou][RZ][Q-Za-f]|[QY][UW]x[Hn]I([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*ID([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[CSiy]Ai[Tb][km]9[Ou][RZ][Q-Za-f]|[\\\\x2b\\\\x2f-9A-Za-z][02EGUWkm]F[Ms][RZ]y([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[CSiy]A6I[km]5[Pv][Tb][km][U-X]|[\\\\x2b\\\\x2f-9A-Za-z][02EGUWkm]F[Ms][RZ]yI6I[km]5[Pv][Tb][km][U-X]|[\\\\x2b\\\\x2f-9A-Za-z][02EGUWkm]F[Ms][RZ]yI6ICJ[Ou][Tb][02]5[Fl]|[\\\\x2b\\\\x2f-9A-Za-z]{2}[159BFJNRVZdhlptx][Bh][Tb][EG]ciIDogI[km]5[Pv][Tb][km][U-X]|[\\\\x2b\\\\x2f-9A-Za-z][02EGUWkm]F[Ms][RZ]y([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[\\\\x2b\\\\x2f-9A-Za-z]ID([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*ICJ[Ou][Tb][02]5[Fl]|[\\\\x2b\\\\x2f-9A-Za-z][02EGUWkm]F[Ms][RZ]y([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[048AEIMQUYcgkosw]gO([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[048AEIMQUYcgkosw]gI[km]5[Pv][Tb][km][U-X]|[\\\\x2b\\\\x2f-9A-Za-z]{2}[159BFJNRVZdhlptx][Bh][Tb][EG]ci([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*ID([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*ICJ[Ou][Tb][02]5[Fl]|[\\\\x2b\\\\x2f-9A-Za-z][02EGUWkm]F[Ms][RZ]y([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[\\\\x2b\\\\x2f-9A-Za-z]ID([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[048AEIMQUYcgkosw]gI[km]5[Pv][Tb][km][U-X]|[QY][UW]x[Hn]IiA6([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[CSiy]Ai[Tb][km]9[Ou][RZ][Q-Za-f]|[QY][UW]x[Hn]I([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[048AEIMQUYcgkosw]gO([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[CSiy]Ai[Tb][km]9[Ou][RZ][Q-Za-f]|[\\\\x2b\\\\x2f-9A-Za-z]{2}[159BFJNRVZdhlptx][Bh][Tb][EG]ci([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[048AEIMQUYcgkosw]gO([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*ICJ[Ou][Tb][02]5[Fl]|[\\\\x2b\\\\x2f-9A-Za-z]{2}[159BFJNRVZdhlptx][Bh][Tb][EG]ci([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[CSiy]A6([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[\\\\x2b\\\\x2f-9A-Za-z]ICJ[Ou][Tb][02]5[Fl]|[QY][UW]x[Hn]IiA6([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[\\\\x2b\\\\x2f-9A-Za-z]ICJ[Ou][Tb][02]5[Fl]|[\\\\x2b\\\\x2f-9A-Za-z]{2}[159BFJNRVZdhlptx][Bh][Tb][EG]ci([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[\\\\x2b\\\\x2f-9A-Za-z]ID([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[\\\\x2b\\\\x2f-9A-Za-z]ICJ[Ou][Tb][02]5[Fl]|[\\\\x2b\\\\x2f-9A-Za-z][02EGUWkm]F[Ms][RZ]y([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*IDoi[Tb][km]9[Ou][RZ][Q-Za-f]|[\\\\x2b\\\\x2f-9A-Za-z]{2}[159BFJNRVZdhlptx][Bh][Tb][EG]ciO([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[\\\\x2b\\\\x2f-9A-Za-z]ICJ[Ou][Tb][02]5[Fl]|[QY][UW]x[Hn]I([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[CSiy]A6I[km]5[Pv][Tb][km][U-X]|[QY][UW]x[Hn]IiA6([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[048AEIMQUYcgkosw]gI[km]5[Pv][Tb][km][U-X]|[\\\\x2b\\\\x2f-9A-Za-z][02EGUWkm]F[Ms][RZ]y([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[CSiy]A6([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[\\\\x2b\\\\x2f-9A-Za-z]ICJ[Ou][Tb][02]5[Fl]|[\\\\x2b\\\\x2f-9A-Za-z]{2}[159BFJNRVZdhlptx][Bh][Tb][EG]ci([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[CSiy]A6([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[048AEIMQUYcgkosw]gI[km]5[Pv][Tb][km][U-X]|[\\\\x2b\\\\x2f-9A-Za-z][02EGUWkm]F[Ms][RZ]y([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[048AEIMQUYcgkosw]gO([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*ICJ[Ou][Tb][02]5[Fl]|[\\\\x2b\\\\x2f-9A-Za-z][02EGUWkm]F[Ms][RZ]yI6([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[048AEIMQUYcgkosw]gI[km]5[Pv][Tb][km][U-X]|[\\\\x2b\\\\x2f-9A-Za-z][02EGUWkm]F[Ms][RZ]yIgO([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[048AEIMQUYcgkosw]gI[km]5[Pv][Tb][km][U-X]|[\\\\x2b\\\\x2f-9A-Za-z]{2}[159BFJNRVZdhlptx][Bh][Tb][EG]ci([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[048AEIMQUYcgkosw]gOiJ[Ou][Tb][02]5[Fl]|[\\\\x2b\\\\x2f-9A-Za-z][02EGUWkm]F[Ms][RZ]y([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*ID([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*ICJ[Ou][Tb][02]5[Fl]|[\\\\x2b\\\\x2f-9A-Za-z][02EGUWkm]F[Ms][RZ]y([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[CSiy]A6([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[CSiy]Ai[Tb][km]9[Ou][RZ][Q-Za-f]|[QY][UW]x[Hn]I([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*ID([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[\\\\x2b\\\\x2f-9A-Za-z]ICJ[Ou][Tb][02]5[Fl]|[\\\\x2b\\\\x2f-9A-Za-z]{2}[159BFJNRVZdhlptx][Bh][Tb][EG]ci([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[\\\\x2b\\\\x2f-9A-Za-z]ID([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[CSiy]Ai[Tb][km]9[Ou][RZ][Q-Za-f]|[\\\\x2b\\\\x2f-9A-Za-z][02EGUWkm]F[Ms][RZ]y([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*ID([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[048AEIMQUYcgkosw]gI[km]5[Pv][Tb][km][U-X]|[\\\\x2b\\\\x2f-9A-Za-z][02EGUWkm]F[Ms][RZ]yIgO([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[\\\\x2b\\\\x2f-9A-Za-z]ICJ[Ou][Tb][02]5[Fl]|[QY][UW]x[Hn]I([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[CSiy]A6([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*ICJ[Ou][Tb][02]5[Fl]|[QY][UW]x[Hn]I([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*IDoi[Tb][km]9[Ou][RZ][Q-Za-f]|[\\\\x2b\\\\x2f-9A-Za-z]{2}[159BFJNRVZdhlptx][Bh][Tb][EG]ci([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[CSiy]A6I[km]5[Pv][Tb][km][U-X]|[\\\\x2b\\\\x2f-9A-Za-z][02EGUWkm]F[Ms][RZ]y([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[048AEIMQUYcgkosw]gOiJ[Ou][Tb][02]5[Fl]|[QY][UW]x[Hn]Ijoi[Tb][km]9[Ou][RZ][Q-Za-f]|[\\\\x2b\\\\x2f-9A-Za-z]{2}[159BFJNRVZdhlptx][Bh][Tb][EG]ci([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[048AEIMQUYcgkosw]gOiAi[Tb][km]9[Ou][RZ][Q-Za-f]|[\\\\x2b\\\\x2f-9A-Za-z][02EGUWkm]F[Ms][RZ]yI6([048ACEIMQSUYcgikoswy]|[\\\\x2b\\\\x2f-9A-Za-z]I)*[CSiy]Ai[Tb][km]9[Ou][RZ][Q-Za-f])[A-Za-z0-9+-/]*\\\\.[A-Za-z0-9+_\\\\-/]+\\\\.(?:[A-Za-z0-9+_\\\\-/]+)?$","options":{"case_sensitive":true}},"operator":"match_regex"}],"transformers":[]},{"id":"dog-931-001","name":"RFI: URL Payload to well known RFI target","tags":{"type":"rfi","category":"attack_attempt","cwe":"98","capec":"1000/152/175/253/193","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"^(?i:file|ftps?|https?).*/rfiinc\\\\.txt\\\\?+$","options":{"case_sensitive":true,"min_length":17}},"operator":"match_regex"}],"transformers":[]},{"id":"dog-932-100","name":"Shell spawn executing network command","tags":{"type":"command_injection","category":"attack_attempt","cwe":"77","capec":"1000/152/248/88","confidence":"0","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"server.request.headers.no_cookies"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"(?:(?:[\'\\"\\\\x60({|;&]|(?:^|[\'\\"\\\\x60({|;&])(?:cmd(?:\\\\.exe)?\\\\s+(?:/\\\\w(?::\\\\w+)?\\\\s+)*))(?:ping|curl|wget|telnet)|\\\\bnslookup)[\\\\s,]","options":{"case_sensitive":true,"min_length":5}},"operator":"match_regex"}],"transformers":[]},{"id":"dog-934-001","name":"XXE - XML file loads external entity","tags":{"type":"xxe","category":"attack_attempt","cwe":"91","capec":"1000/152/248/250","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.body"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"(?:<\\\\?xml[^>]*>.*)<!ENTITY[^>]+SYSTEM\\\\s+[^>]+>","options":{"case_sensitive":false,"min_length":24}},"operator":"match_regex"}],"transformers":[]},{"id":"dog-941-001","name":"XSS in source property","tags":{"type":"xss","category":"attack_attempt","cwe":"83","capec":"1000/152/242/63/591/243","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]},{"address":"server.request.headers.no_cookies","key_path":["referer"]},{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"<(?:iframe|esi:include)(?:(?:\\\\s|/)*\\\\w+=[\\"\'\\\\w]+)*(?:\\\\s|/)*src(?:doc)?=[\\"\']?(?:data:|javascript:|http:|dns:|//)[^\\\\s\'\\"]+[\'\\"]?","options":{"min_length":14}},"operator":"match_regex"}],"transformers":["removeNulls","urlDecodeUni"]},{"id":"dog-942-001","name":"Blind XSS callback domains","tags":{"type":"xss","category":"attack_attempt","cwe":"83","capec":"1000/152/242/63/591/243","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"server.request.headers.no_cookies"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"https?:\\\\/\\\\/(?:.*\\\\.)?(?:bxss\\\\.(?:in|me)|xss\\\\.ht|js\\\\.rip)","options":{"case_sensitive":false}},"operator":"match_regex"}],"transformers":[]},{"id":"nfd-000-001","name":"Detect common directory discovery scans","tags":{"type":"security_scanner","category":"attack_attempt","cwe":"200","capec":"1000/118/169","confidence":"1"},"conditions":[{"operator":"match_regex","parameters":{"inputs":[{"address":"server.response.status"}],"regex":"^404$","options":{"case_sensitive":true}}},{"operator":"phrase_match","parameters":{"options":{"enforce_word_boundary":true},"inputs":[{"address":"server.request.uri.raw"}],"list":["/wordpress/","/etc/","/login.php","/install.php","/administrator","/admin.php","/wp-config","/phpmyadmin","/fckeditor","/mysql","/manager/html",".htaccess","/config.php","/configuration","/cgi-bin/php","/search.php","/tinymce","/tiny_mce","/settings.php","../../..","/install/","/download.php","/webdav","/forum.php","/user.php","/style.php","/jmx-console","/modules.php","/include.php","/default.asp","/help.php","/database.yml","/database.yml.pgsql","/database.yml.sqlite3","/database.yml.sqlite","/database.yml.mysql",".%2e/","/view.php","/header.php","/search.asp","%5c%5c","/server/php/","/invoker/jmxinvokerservlet","/phpmyadmin/index.php","/data/admin/allowurl.txt","/verify.php","/misc/ajax.js","/.idea","/module.php","/backup.rar","/backup.tar","/backup.zip","/backup.7z","/backup.gz","/backup.tgz","/backup.tar.gz","waitfor%20delay","/calendar.php","/news.php","/dompdf.php","))))))))))))))))","/web.config","tree.php","/cgi-bin-sdb/printenv","/comments.php","/detail.asp","/license.txt","/admin.asp","/auth.php","/list.php","/content.php","/mod.php","/mini.php","/install.pgsql","/install.mysql","/install.sqlite","/install.sqlite3","/install.txt","/install.md","/doku.php","/main.asp","/myadmin","/force-download.php","/iisprotect/admin","/.gitignore","/print.php","/common.php","/mainfile.php","/functions.php","/scripts/setup.php","/faq.php","/op/op.login.php","/home.php","/includes/hnmain.inc.php3","/preview.php","/dump.rar","/dump.tar","/dump.zip","/dump.7z","/dump.gz","/dump.tgz","/dump.tar.gz","/thumbnail.php","/sendcard.php","/global.asax","/directory.php","/footer.php","/error.asp","/forum.asp","/save.php","/htmlsax3.php","/adm/krgourl.php","/includes/converter.inc.php","/nucleus/libs/pluginadmin.php","/base_qry_common.php","/fileadmin","/bitrix/admin/","/adm.php","/util/barcode.php","/action.php","/rss.asp","/downloads.php","/page.php","/snarf_ajax.php","/fck/editor","/sendmail.php","/detail.php","/iframe.php","/swfupload.swf","/jenkins/login","/phpmyadmin/main.php","/phpmyadmin/scripts/setup.php","/user/index.php","/checkout.php","/process.php","/ks_inc/ajax.js","/export.php","/register.php","/cart.php","/console.php","/friend.php","/readmsg.php","/install.asp","/dagent/downloadreport.asp","/system/index.php","/core/changelog.txt","/js/util.js","/interna.php","/gallery.php","/links.php","/data/admin/ver.txt","/language/zh-cn.xml","/productdetails.asp","/admin/template/article_more/config.htm","/components/com_moofaq/includes/file_includer.php","/licence.txt","/rss.xsl","/vtigerservice.php","/mysql/main.php","/passwiki.php","/scr/soustab.php","/global.php","/email.php","/user.asp","/msd","/products.php","/cultbooking.php","/cron.php","/static/js/admincp.js","/comment.php","/maintainers","/modules/plain/adminpart/addplain.php","/wp-content/plugins/ungallery/source_vuln.php","/upgrade.txt","/category.php","/index_logged.php","/members.asp","/script/html.js","/images/ad.js","/awstats/awstats.pl","/includes/esqueletos/skel_null.php","/modules/profile/user.php","/window_top.php","/openbrowser.php","/thread.php","tinfoil_xss","/includes/include.php","/urheber.php","/header.inc.php","/mysqldumper","/display.php","/website.php","/stats.php","/assets/plugins/mp3_id/mp3_id.php","/siteminderagent/forms/smpwservices.fcc","/eval-stdin.php"]}}],"transformers":["lowercase"]},{"id":"nfd-000-002","name":"Detect failed attempt to fetch readme files","tags":{"type":"security_scanner","category":"attack_attempt","cwe":"200","capec":"1000/118/169","confidence":"1","module":"waf"},"conditions":[{"operator":"match_regex","parameters":{"inputs":[{"address":"server.response.status"}],"regex":"^404$","options":{"case_sensitive":true}}},{"operator":"match_regex","parameters":{"inputs":[{"address":"server.request.uri.raw"}],"regex":"readme\\\\.[\\\\.a-z0-9]+$","options":{"case_sensitive":false}}}],"transformers":[]},{"id":"nfd-000-003","name":"Detect failed attempt to fetch Java EE resource files","tags":{"type":"security_scanner","category":"attack_attempt","cwe":"200","capec":"1000/118/169","confidence":"1","module":"waf"},"conditions":[{"operator":"match_regex","parameters":{"inputs":[{"address":"server.response.status"}],"regex":"^404$","options":{"case_sensitive":true}}},{"operator":"match_regex","parameters":{"inputs":[{"address":"server.request.uri.raw"}],"regex":"^(?:.*web\\\\-inf)(?:.*web\\\\.xml).*$","options":{"case_sensitive":false}}}],"transformers":[]},{"id":"nfd-000-004","name":"Detect failed attempt to fetch code files","tags":{"type":"security_scanner","category":"attack_attempt","cwe":"200","capec":"1000/118/169","confidence":"1","module":"waf"},"conditions":[{"operator":"match_regex","parameters":{"inputs":[{"address":"server.response.status"}],"regex":"^404$","options":{"case_sensitive":true}}},{"operator":"match_regex","parameters":{"inputs":[{"address":"server.request.uri.raw"}],"regex":"\\\\.(java|pyc?|rb|class)\\\\b","options":{"case_sensitive":false}}}],"transformers":[]},{"id":"nfd-000-005","name":"Detect failed attempt to fetch source code archives","tags":{"type":"security_scanner","category":"attack_attempt","cwe":"200","capec":"1000/118/169","confidence":"1","module":"waf"},"conditions":[{"operator":"match_regex","parameters":{"inputs":[{"address":"server.response.status"}],"regex":"^404$","options":{"case_sensitive":true}}},{"operator":"match_regex","parameters":{"inputs":[{"address":"server.request.uri.raw"}],"regex":"\\\\.(sql|log|ndb|gz|zip|tar\\\\.gz|tar|regVV|reg|conf|bz2|ini|db|war|bat|inc|btr|server|ds|conf|config|admin|master|sln|bak)\\\\b(?:[^.]|$)","options":{"case_sensitive":false}}}],"transformers":[]},{"id":"nfd-000-006","name":"Detect failed attempt to fetch sensitive files","tags":{"type":"security_scanner","category":"attack_attempt","cwe":"200","capec":"1000/118/169","confidence":"1","module":"waf"},"conditions":[{"operator":"match_regex","parameters":{"inputs":[{"address":"server.response.status"}],"regex":"^404$","options":{"case_sensitive":true}}},{"operator":"match_regex","parameters":{"inputs":[{"address":"server.request.uri.raw"}],"regex":"\\\\.(cgi|bat|dll|exe|key|cert|crt|pem|der|pkcs|pkcs|pkcs[0-9]*|nsf|jsa|war|java|class|vb|vba|so|git|svn|hg|cvs)([?#&/]|$)","options":{"case_sensitive":false}}}],"transformers":[]},{"id":"nfd-000-007","name":"Detect failed attempt to fetch archives","tags":{"type":"security_scanner","category":"attack_attempt","cwe":"200","capec":"1000/118/169","confidence":"1","module":"waf"},"conditions":[{"operator":"match_regex","parameters":{"inputs":[{"address":"server.response.status"}],"regex":"^404$","options":{"case_sensitive":true}}},{"operator":"match_regex","parameters":{"inputs":[{"address":"server.request.uri.raw"}],"regex":"/[\\\\d\\\\-_]*\\\\.(rar|tar|zip|7z|gz|tgz|tar.gz)","options":{"case_sensitive":false}}}],"transformers":[]},{"id":"nfd-000-008","name":"Detect failed attempt to trigger incorrect application behavior","tags":{"type":"security_scanner","category":"attack_attempt","cwe":"200","capec":"1000/118/169","confidence":"1","module":"waf"},"conditions":[{"operator":"match_regex","parameters":{"inputs":[{"address":"server.response.status"}],"regex":"^404$","options":{"case_sensitive":true}}},{"operator":"match_regex","parameters":{"inputs":[{"address":"server.request.uri.raw"}],"regex":"(/(administrator/components/com.*\\\\.php|response\\\\.write\\\\(.+\\\\))|select\\\\(.+\\\\)from|\\\\(.*sleep\\\\(.+\\\\)|(%[a-zA-Z0-9]{2}[a-zA-Z]{0,1})+\\\\))","options":{"case_sensitive":false}}}],"transformers":[]},{"id":"nfd-000-009","name":"Detect failed attempt to leak the structure of the application","tags":{"type":"security_scanner","category":"attack_attempt","cwe":"200","capec":"1000/118/169","confidence":"1","module":"waf"},"conditions":[{"operator":"match_regex","parameters":{"inputs":[{"address":"server.response.status"}],"regex":"^404$","options":{"case_sensitive":true}}},{"operator":"match_regex","parameters":{"inputs":[{"address":"server.request.uri.raw"}],"regex":"/(login\\\\.rol|LICENSE|[\\\\w-]+\\\\.(plx|pwd))$","options":{"case_sensitive":false}}}],"transformers":[]},{"id":"nfd-000-010","name":"Detect failed attempts to find API documentation","tags":{"type":"security_scanner","category":"attack_attempt","cwe":"200","capec":"1000/118/169","confidence":"0","module":"waf"},"conditions":[{"operator":"match_regex","parameters":{"inputs":[{"address":"server.response.status"}],"regex":"^404$","options":{"case_sensitive":true}}},{"operator":"match_regex","parameters":{"inputs":[{"address":"server.request.uri.raw"}],"regex":"(?:/swagger\\\\b|/api[-/]docs?\\\\b)","options":{"case_sensitive":false}}}],"transformers":[]},{"id":"rasp-930-100","name":"Local file inclusion exploit","tags":{"type":"lfi","category":"vulnerability_trigger","cwe":"22","capec":"1000/255/153/126","confidence":"0","module":"rasp"},"conditions":[{"parameters":{"resource":[{"address":"server.io.fs.file"}],"params":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}]},"operator":"lfi_detector@v2"}],"transformers":[],"on_match":["stack_trace"]},{"id":"rasp-932-100","name":"Shell command injection exploit","tags":{"type":"command_injection","category":"vulnerability_trigger","cwe":"77","capec":"1000/152/248/88","confidence":"0","module":"rasp"},"conditions":[{"parameters":{"resource":[{"address":"server.sys.shell.cmd"}],"params":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}]},"operator":"shi_detector"}],"transformers":[],"on_match":["stack_trace"]},{"id":"rasp-932-110","name":"OS command injection exploit","tags":{"type":"command_injection","category":"vulnerability_trigger","cwe":"77","capec":"1000/152/248/88","confidence":"0","module":"rasp"},"conditions":[{"parameters":{"resource":[{"address":"server.sys.exec.cmd"}],"params":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}]},"operator":"cmdi_detector"}],"transformers":[],"on_match":["stack_trace"]},{"id":"rasp-934-100","name":"Server-side request forgery exploit","tags":{"type":"ssrf","category":"vulnerability_trigger","cwe":"918","capec":"1000/225/115/664","confidence":"0","module":"rasp"},"conditions":[{"parameters":{"resource":[{"address":"server.io.net.url"}],"params":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}]},"operator":"ssrf_detector"}],"transformers":[],"on_match":["stack_trace"]},{"id":"rasp-942-100","name":"SQL injection exploit","tags":{"type":"sql_injection","category":"vulnerability_trigger","cwe":"89","capec":"1000/152/248/66","confidence":"0","module":"rasp"},"conditions":[{"parameters":{"resource":[{"address":"server.db.statement"}],"params":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"db_type":[{"address":"server.db.system"}]},"operator":"sqli_detector@v2"}],"transformers":[],"on_match":["stack_trace"]},{"id":"sqr-000-001","name":"SSRF: Try to access the credential manager of the main cloud services","tags":{"type":"ssrf","category":"attack_attempt","cwe":"918","capec":"1000/225/115/664","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"(?i)^\\\\W*((http|ftp)s?://)?\\\\W*((::f{4}:)?(169|(0x)?0*a9|0+251)\\\\.?(254|(0x)?0*fe|0+376)[0-9a-fx\\\\.:]+|metadata\\\\.google\\\\.internal|metadata\\\\.goog)\\\\W*/","options":{"min_length":4}},"operator":"match_regex"}],"transformers":["removeNulls"]},{"id":"sqr-000-002","name":"Server-side Javascript injection: Try to detect obvious JS injection","tags":{"type":"js_code_injection","category":"attack_attempt","cwe":"94","capec":"1000/152/242","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"require\\\\([\'\\"][\\\\w\\\\.]+[\'\\"]\\\\)|process\\\\.\\\\w+\\\\([\\\\w\\\\.]*\\\\)|\\\\.toString\\\\(\\\\)","options":{"min_length":4}},"operator":"match_regex"}],"transformers":["removeNulls"]},{"id":"sqr-000-008","name":"Windows: Detect attempts to exfiltrate .ini files","tags":{"type":"command_injection","category":"attack_attempt","cwe":"78","capec":"1000/152/248/88","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"server.request.headers.no_cookies"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"(?i)[&|]\\\\s*type\\\\s+%\\\\w+%\\\\\\\\+\\\\w+\\\\.ini\\\\s*[&|]"},"operator":"match_regex"}],"transformers":[]},{"id":"sqr-000-009","name":"Linux: Detect attempts to exfiltrate passwd files","tags":{"type":"command_injection","category":"attack_attempt","cwe":"78","capec":"1000/152/248/88","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"server.request.headers.no_cookies"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"(?i)[&|]\\\\s*cat\\\\s*\\\\/etc\\\\/[\\\\w\\\\.\\\\/]*passwd\\\\s*[&|]"},"operator":"match_regex"}],"transformers":["cmdLine"]},{"id":"sqr-000-010","name":"Windows: Detect attempts to timeout a shell","tags":{"type":"command_injection","category":"attack_attempt","cwe":"78","capec":"1000/152/248/88","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"server.request.headers.no_cookies"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"(?i)[&|]\\\\s*timeout\\\\s+/t\\\\s+\\\\d+\\\\s*[&|]"},"operator":"match_regex"}],"transformers":[]},{"id":"sqr-000-011","name":"SSRF: Try to access internal OMI service (CVE-2021-38647)","tags":{"type":"ssrf","category":"attack_attempt","cwe":"918","capec":"1000/225/115/664","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"http(s?):\\\\/\\\\/([A-Za-z0-9\\\\.\\\\-\\\\_]+|\\\\[[A-Fa-f0-9\\\\:]+\\\\]|):5986\\\\/wsman","options":{"min_length":4}},"operator":"match_regex"}],"transformers":[]},{"id":"sqr-000-012","name":"SSRF: Detect SSRF attempt on internal service","tags":{"type":"ssrf","category":"attack_attempt","cwe":"918","capec":"1000/225/115/664","confidence":"0","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"^(jar:)?(http|https):\\\\/\\\\/([0-9oq]{1,5}\\\\.[0-9]{1,3}\\\\.[0-9]{1,3}\\\\.[0-9]{1,3}|[0-9]{1,10})(:[0-9]{1,5})?(\\\\/[^:@]*)?$"},"operator":"match_regex"}],"transformers":["lowercase"]},{"id":"sqr-000-013","name":"SSRF: Detect SSRF attempts using IPv6 or octal/hexdecimal obfuscation","tags":{"type":"ssrf","category":"attack_attempt","cwe":"918","capec":"1000/225/115/664","confidence":"0","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"^(jar:)?(http|https):\\\\/\\\\/((\\\\[)?[:0-9a-f\\\\.x]{2,}(\\\\])?)(:[0-9]{1,5})?(\\\\/[^:@]*)?$"},"operator":"match_regex"}],"transformers":["lowercase"]},{"id":"sqr-000-014","name":"SSRF: Detect SSRF domain redirection bypass","tags":{"type":"ssrf","category":"attack_attempt","cwe":"918","capec":"1000/225/115/664","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"server.request.headers.no_cookies"},{"address":"grpc.server.request.message"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"(http|https):\\\\/\\\\/(?:.*\\\\.)?(?:burpcollaborator\\\\.net|localtest\\\\.me|mail\\\\.ebc\\\\.apple\\\\.com|bugbounty\\\\.dod\\\\.network|.*\\\\.[nx]ip\\\\.io|oastify\\\\.com|oast\\\\.(?:pro|live|site|online|fun|me)|sslip\\\\.io|requestbin\\\\.com|requestbin\\\\.net|hookbin\\\\.com|webhook\\\\.site|canarytokens\\\\.com|interact\\\\.sh|ngrok\\\\.io|bugbounty\\\\.click|prbly\\\\.win|qualysperiscope\\\\.com|vii\\\\.one|act1on3\\\\.ru)"},"operator":"match_regex"}],"transformers":[]},{"id":"sqr-000-015","name":"SSRF: Detect SSRF attempt using non HTTP protocol","tags":{"type":"ssrf","category":"attack_attempt","cwe":"918","capec":"1000/225/115/664","confidence":"0","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"server.request.headers.no_cookies"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"^(jar:)?((file|netdoc):\\\\/\\\\/[\\\\\\\\\\\\/]+|(dict|gopher|ldap|sftp|tftp):\\\\/\\\\/.*:[0-9]{1,5})"},"operator":"match_regex"}],"transformers":["lowercase"]},{"id":"sqr-000-017","name":"Log4shell: Attempt to exploit log4j CVE-2021-44228","tags":{"type":"exploit_detection","category":"attack_attempt","cwe":"94","capec":"1000/152/242","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.uri.raw"},{"address":"server.request.query"},{"address":"server.request.body"},{"address":"server.request.path_params"},{"address":"server.request.headers.no_cookies"},{"address":"graphql.server.all_resolvers"},{"address":"graphql.server.resolver"}],"regex":"\\\\${[^j]*j[^n]*n[^d]*d[^i]*i[^:]*:[^}]*}"},"operator":"match_regex"}],"transformers":["unicode_normalize"]},{"id":"ua0-600-0xx","name":"Joomla exploitation tool","tags":{"type":"attack_tool","category":"attack_attempt","cwe":"200","capec":"1000/118/169","tool_name":"Joomla exploitation tool","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]}],"regex":"JDatabaseDriverMysqli"},"operator":"match_regex"}],"transformers":[]},{"id":"ua0-600-10x","name":"Nessus","tags":{"type":"attack_tool","category":"attack_attempt","cwe":"200","capec":"1000/118/169","tool_name":"Nessus","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]}],"regex":"(?i)^Nessus(/|([ :]+SOAP))"},"operator":"match_regex"}],"transformers":[]},{"id":"ua0-600-12x","name":"Arachni","tags":{"type":"attack_tool","category":"attack_attempt","cwe":"200","capec":"1000/118/169","tool_name":"Arachni","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]}],"regex":"^Arachni\\\\/v"},"operator":"match_regex"}],"transformers":[]},{"id":"ua0-600-13x","name":"Jorgee","tags":{"type":"attack_tool","category":"attack_attempt","cwe":"200","capec":"1000/118/169","tool_name":"Jorgee","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]}],"regex":"(?i)\\\\bJorgee\\\\b"},"operator":"match_regex"}],"transformers":[]},{"id":"ua0-600-14x","name":"Probely","tags":{"type":"commercial_scanner","category":"attack_attempt","cwe":"200","capec":"1000/118/169","tool_name":"Probely","confidence":"0","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]}],"regex":"(?i)\\\\bProbely\\\\b"},"operator":"match_regex"}],"transformers":[]},{"id":"ua0-600-15x","name":"Metis","tags":{"type":"attack_tool","category":"attack_attempt","cwe":"200","capec":"1000/118/169","tool_name":"Metis","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]}],"regex":"(?i)\\\\bmetis\\\\b"},"operator":"match_regex"}],"transformers":[]},{"id":"ua0-600-16x","name":"SQL power injector","tags":{"type":"attack_tool","category":"attack_attempt","cwe":"200","capec":"1000/118/169","tool_name":"SQLPowerInjector","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]}],"regex":"sql power injector"},"operator":"match_regex"}],"transformers":[]},{"id":"ua0-600-18x","name":"N-Stealth","tags":{"type":"attack_tool","category":"attack_attempt","cwe":"200","capec":"1000/118/169","tool_name":"N-Stealth","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]}],"regex":"(?i)\\\\bn-stealth\\\\b"},"operator":"match_regex"}],"transformers":[]},{"id":"ua0-600-19x","name":"Brutus","tags":{"type":"attack_tool","category":"attack_attempt","cwe":"200","capec":"1000/118/169","tool_name":"Brutus","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]}],"regex":"(?i)\\\\bbrutus\\\\b"},"operator":"match_regex"}],"transformers":[]},{"id":"ua0-600-1xx","name":"Shellshock exploitation tool","tags":{"type":"security_scanner","category":"attack_attempt","cwe":"200","capec":"1000/118/169","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]}],"regex":"\\\\(\\\\) \\\\{ :; *\\\\}"},"operator":"match_regex"}],"transformers":[]},{"id":"ua0-600-20x","name":"Netsparker","tags":{"type":"commercial_scanner","category":"attack_attempt","cwe":"200","capec":"1000/118/169","tool_name":"Netsparker","confidence":"0","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]}],"regex":"\\\\bnetsparker\\\\b"},"operator":"match_regex"}],"transformers":[]},{"id":"ua0-600-22x","name":"JAASCois","tags":{"type":"attack_tool","category":"attack_attempt","cwe":"200","capec":"1000/118/169","tool_name":"JAASCois","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]}],"regex":"(?i)\\\\bjaascois\\\\b"},"operator":"match_regex"}],"transformers":[]},{"id":"ua0-600-26x","name":"Nsauditor","tags":{"type":"attack_tool","category":"attack_attempt","cwe":"200","capec":"1000/118/169","tool_name":"Nsauditor","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]}],"regex":"(?i)\\\\bnsauditor\\\\b"},"operator":"match_regex"}],"transformers":[]},{"id":"ua0-600-27x","name":"Paros","tags":{"type":"attack_tool","category":"attack_attempt","cwe":"200","capec":"1000/118/169","tool_name":"Paros","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]}],"regex":"(?i)Mozilla/.* Paros/"},"operator":"match_regex"}],"transformers":[]},{"id":"ua0-600-28x","name":"DirBuster","tags":{"type":"attack_tool","category":"attack_attempt","cwe":"200","capec":"1000/118/169","tool_name":"DirBuster","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]}],"regex":"(?i)\\\\bdirbuster\\\\b"},"operator":"match_regex"}],"transformers":[]},{"id":"ua0-600-29x","name":"Pangolin","tags":{"type":"attack_tool","category":"attack_attempt","cwe":"200","capec":"1000/118/169","tool_name":"Pangolin","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]}],"regex":"(?i)\\\\bpangolin\\\\b"},"operator":"match_regex"}],"transformers":[]},{"id":"ua0-600-2xx","name":"Qualys","tags":{"type":"commercial_scanner","category":"attack_attempt","cwe":"200","capec":"1000/118/169","tool_name":"Qualys","confidence":"0","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]}],"regex":"(?i)\\\\bqualys\\\\b"},"operator":"match_regex"}],"transformers":[]},{"id":"ua0-600-30x","name":"SQLNinja","tags":{"type":"attack_tool","category":"attack_attempt","cwe":"200","capec":"1000/118/169","tool_name":"SQLNinja","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]}],"regex":"(?i)\\\\bsqlninja\\\\b"},"operator":"match_regex"}],"transformers":[]},{"id":"ua0-600-31x","name":"Nikto","tags":{"type":"attack_tool","category":"attack_attempt","cwe":"200","capec":"1000/118/169","tool_name":"Nikto","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]}],"regex":"\\\\(Nikto/[\\\\d\\\\.]+\\\\)"},"operator":"match_regex"}],"transformers":[]},{"id":"ua0-600-33x","name":"BlackWidow","tags":{"type":"attack_tool","category":"attack_attempt","cwe":"200","capec":"1000/118/169","tool_name":"BlackWidow","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]}],"regex":"(?i)\\\\bblack\\\\s?widow\\\\b"},"operator":"match_regex"}],"transformers":[]},{"id":"ua0-600-34x","name":"Grendel-Scan","tags":{"type":"attack_tool","category":"attack_attempt","cwe":"200","capec":"1000/118/169","tool_name":"Grendel-Scan","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]}],"regex":"(?i)\\\\bgrendel-scan\\\\b"},"operator":"match_regex"}],"transformers":[]},{"id":"ua0-600-35x","name":"Havij","tags":{"type":"attack_tool","category":"attack_attempt","cwe":"200","capec":"1000/118/169","tool_name":"Havij","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]}],"regex":"(?i)\\\\bhavij\\\\b"},"operator":"match_regex"}],"transformers":[]},{"id":"ua0-600-36x","name":"w3af","tags":{"type":"attack_tool","category":"attack_attempt","cwe":"200","capec":"1000/118/169","tool_name":"w3af","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]}],"regex":"(?i)\\\\bw3af\\\\b"},"operator":"match_regex"}],"transformers":[]},{"id":"ua0-600-37x","name":"Nmap","tags":{"type":"attack_tool","category":"attack_attempt","cwe":"200","capec":"1000/118/169","tool_name":"Nmap","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]}],"regex":"nmap (nse|scripting engine)"},"operator":"match_regex"}],"transformers":[]},{"id":"ua0-600-39x","name":"Nessus Scripted","tags":{"type":"attack_tool","category":"attack_attempt","cwe":"200","capec":"1000/118/169","tool_name":"Nessus","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]}],"regex":"(?i)^\'?[a-z0-9_]+\\\\.nasl\'?$"},"operator":"match_regex"}],"transformers":[]},{"id":"ua0-600-3xx","name":"Evil Scanner","tags":{"type":"attack_tool","category":"attack_attempt","cwe":"200","capec":"1000/118/169","tool_name":"EvilScanner","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]}],"regex":"(?i)\\\\bevilScanner\\\\b"},"operator":"match_regex"}],"transformers":[]},{"id":"ua0-600-40x","name":"WebFuck","tags":{"type":"attack_tool","category":"attack_attempt","cwe":"200","capec":"1000/118/169","tool_name":"WebFuck","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]}],"regex":"(?i)\\\\bWebFuck\\\\b"},"operator":"match_regex"}],"transformers":[]},{"id":"ua0-600-42x","name":"OpenVAS","tags":{"type":"attack_tool","category":"attack_attempt","cwe":"200","capec":"1000/118/169","tool_name":"OpenVAS","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]}],"regex":"(?i)OpenVAS\\\\b"},"operator":"match_regex"}],"transformers":[]},{"id":"ua0-600-43x","name":"Spider-Pig","tags":{"type":"attack_tool","category":"attack_attempt","cwe":"200","capec":"1000/118/169","tool_name":"Spider-Pig","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]}],"regex":"Powered by Spider-Pig by tinfoilsecurity\\\\.com"},"operator":"match_regex"}],"transformers":[]},{"id":"ua0-600-44x","name":"Zgrab","tags":{"type":"attack_tool","category":"attack_attempt","cwe":"200","capec":"1000/118/169","tool_name":"Zgrab","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]}],"regex":"Mozilla/\\\\d+.\\\\d+ zgrab"},"operator":"match_regex"}],"transformers":[]},{"id":"ua0-600-45x","name":"Zmeu","tags":{"type":"attack_tool","category":"attack_attempt","cwe":"200","capec":"1000/118/169","tool_name":"Zmeu","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]}],"regex":"(?i)\\\\bZmEu\\\\b"},"operator":"match_regex"}],"transformers":[]},{"id":"ua0-600-47x","name":"GoogleSecurityScanner","tags":{"type":"commercial_scanner","category":"attack_attempt","cwe":"200","capec":"1000/118/169","tool_name":"GoogleSecurityScanner","confidence":"0","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]}],"regex":"(?i)\\\\bGoogleSecurityScanner\\\\b"},"operator":"match_regex"}],"transformers":[]},{"id":"ua0-600-48x","name":"Commix","tags":{"type":"attack_tool","category":"attack_attempt","cwe":"200","capec":"1000/118/169","tool_name":"Commix","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]}],"regex":"^commix\\\\/"},"operator":"match_regex"}],"transformers":[]},{"id":"ua0-600-49x","name":"Gobuster","tags":{"type":"attack_tool","category":"attack_attempt","cwe":"200","capec":"1000/118/169","tool_name":"Gobuster","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]}],"regex":"^gobuster\\\\/"},"operator":"match_regex"}],"transformers":[]},{"id":"ua0-600-4xx","name":"CGIchk","tags":{"type":"attack_tool","category":"attack_attempt","cwe":"200","capec":"1000/118/169","tool_name":"CGIchk","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]}],"regex":"(?i)\\\\bcgichk\\\\b"},"operator":"match_regex"}],"transformers":[]},{"id":"ua0-600-51x","name":"FFUF","tags":{"type":"attack_tool","category":"attack_attempt","cwe":"200","capec":"1000/118/169","tool_name":"FFUF","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]}],"regex":"(?i)^Fuzz Faster U Fool\\\\b"},"operator":"match_regex"}],"transformers":[]},{"id":"ua0-600-52x","name":"Nuclei","tags":{"type":"attack_tool","category":"attack_attempt","cwe":"200","capec":"1000/118/169","tool_name":"Nuclei","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]}],"regex":"(?i)^Nuclei\\\\b"},"operator":"match_regex"}],"transformers":[]},{"id":"ua0-600-53x","name":"Tsunami","tags":{"type":"attack_tool","category":"attack_attempt","cwe":"200","capec":"1000/118/169","tool_name":"Tsunami","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]}],"regex":"(?i)\\\\bTsunamiSecurityScanner\\\\b"},"operator":"match_regex"}],"transformers":[]},{"id":"ua0-600-54x","name":"Nimbostratus","tags":{"type":"attack_tool","category":"attack_attempt","cwe":"200","capec":"1000/118/169","tool_name":"Nimbostratus","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]}],"regex":"(?i)\\\\bnimbostratus-bot\\\\b"},"operator":"match_regex"}],"transformers":[]},{"id":"ua0-600-55x","name":"Datadog test scanner: user-agent","tags":{"type":"security_scanner","category":"attack_attempt","cwe":"200","capec":"1000/118/169","tool_name":"Datadog Canary Test","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]},{"address":"grpc.server.request.metadata","key_path":["dd-canary"]}],"regex":"^dd-test-scanner-log(?:$|/|\\\\s)"},"operator":"match_regex"}],"transformers":[]},{"id":"ua0-600-56x","name":"Datadog test scanner - blocking version: user-agent","tags":{"type":"attack_tool","category":"attack_attempt","cwe":"200","capec":"1000/118/169","tool_name":"Datadog Canary Test","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]},{"address":"grpc.server.request.metadata","key_path":["dd-canary"]}],"regex":"^dd-test-scanner-log-block(?:$|/|\\\\s)"},"operator":"match_regex"}],"transformers":[],"on_match":["block"]},{"id":"ua0-600-57x","name":"AlertLogic","tags":{"type":"commercial_scanner","category":"attack_attempt","cwe":"200","capec":"1000/118/169","tool_name":"AlertLogic","confidence":"0","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]}],"regex":"\\\\bAlertLogic-MDR-"},"operator":"match_regex"}],"transformers":[]},{"id":"ua0-600-58x","name":"wfuzz","tags":{"type":"attack_tool","category":"attack_attempt","cwe":"200","capec":"1000/118/169","tool_name":"wfuzz","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]}],"regex":"\\\\bwfuzz\\\\b"},"operator":"match_regex"}],"transformers":[]},{"id":"ua0-600-59x","name":"Detectify","tags":{"type":"commercial_scanner","category":"attack_attempt","cwe":"200","capec":"1000/118/169","tool_name":"Detectify","confidence":"0","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]}],"regex":"\\\\bdetectify\\\\b"},"operator":"match_regex"}],"transformers":[]},{"id":"ua0-600-5xx","name":"Blind SQL Injection Brute Forcer","tags":{"type":"attack_tool","category":"attack_attempt","cwe":"200","capec":"1000/118/169","tool_name":"BSQLBF","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]}],"regex":"(?i)\\\\bbsqlbf\\\\b"},"operator":"match_regex"}],"transformers":[]},{"id":"ua0-600-60x","name":"masscan","tags":{"type":"attack_tool","category":"attack_attempt","cwe":"200","capec":"1000/118/169","tool_name":"masscan","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]}],"regex":"^masscan/"},"operator":"match_regex"}],"transformers":[]},{"id":"ua0-600-61x","name":"WPScan","tags":{"type":"attack_tool","category":"attack_attempt","cwe":"200","capec":"1000/118/169","tool_name":"WPScan","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]}],"regex":"^wpscan\\\\b"},"operator":"match_regex"}],"transformers":[]},{"id":"ua0-600-62x","name":"Aon pentesting services","tags":{"type":"commercial_scanner","category":"attack_attempt","cwe":"200","capec":"1000/118/169","tool_name":"Aon","confidence":"0","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]}],"regex":"^Aon/"},"operator":"match_regex"}],"transformers":[]},{"id":"ua0-600-63x","name":"FeroxBuster","tags":{"type":"attack_tool","category":"attack_attempt","cwe":"200","capec":"1000/118/169","tool_name":"feroxbuster","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]}],"regex":"^feroxbuster/"},"operator":"match_regex"}],"transformers":[]},{"id":"ua0-600-6xx","name":"Stealthy scanner","tags":{"type":"security_scanner","category":"attack_attempt","cwe":"200","capec":"1000/118/169","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]}],"regex":"mozilla/4\\\\.0 \\\\(compatible(; msie (?:6\\\\.0; (?:win32|Windows NT 5\\\\.0)|4\\\\.0; Windows NT))?\\\\)","options":{"case_sensitive":false}},"operator":"match_regex"}],"transformers":[]},{"id":"ua0-600-7xx","name":"SQLmap","tags":{"type":"attack_tool","category":"attack_attempt","cwe":"200","capec":"1000/118/169","tool_name":"SQLmap","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]}],"regex":"^sqlmap/"},"operator":"match_regex"}],"transformers":[]},{"id":"ua0-600-9xx","name":"Skipfish","tags":{"type":"attack_tool","category":"attack_attempt","cwe":"200","capec":"1000/118/169","tool_name":"Skipfish","confidence":"1","module":"waf"},"conditions":[{"parameters":{"inputs":[{"address":"server.request.headers.no_cookies","key_path":["user-agent"]}],"regex":"(?i)mozilla/5\\\\.0 sf/"},"operator":"match_regex"}],"transformers":[]}],"processors":[{"id":"http-endpoint-fingerprint","generator":"http_endpoint_fingerprint","conditions":[{"operator":"exists","parameters":{"inputs":[{"address":"waf.context.event"},{"address":"server.business_logic.users.login.failure"},{"address":"server.business_logic.users.login.success"}]}}],"parameters":{"mappings":[{"method":[{"address":"server.request.method"}],"uri_raw":[{"address":"server.request.uri.raw"}],"body":[{"address":"server.request.body"}],"query":[{"address":"server.request.query"}],"output":"_dd.appsec.fp.http.endpoint"}]},"evaluate":false,"output":true},{"id":"extract-content","generator":"extract_schema","conditions":[{"operator":"equals","parameters":{"inputs":[{"address":"waf.context.processor","key_path":["extract-schema"]}],"type":"boolean","value":true}}],"parameters":{"mappings":[{"inputs":[{"address":"server.request.body"}],"output":"_dd.appsec.s.req.body"},{"inputs":[{"address":"server.request.cookies"}],"output":"_dd.appsec.s.req.cookies"},{"inputs":[{"address":"server.request.query"}],"output":"_dd.appsec.s.req.query"},{"inputs":[{"address":"server.request.path_params"}],"output":"_dd.appsec.s.req.params"},{"inputs":[{"address":"server.response.body"}],"output":"_dd.appsec.s.res.body"},{"inputs":[{"address":"graphql.server.all_resolvers"}],"output":"_dd.appsec.s.graphql.all_resolvers"},{"inputs":[{"address":"graphql.server.resolver"}],"output":"_dd.appsec.s.graphql.resolver"}],"scanners":[{"tags":{"category":"payment"}},{"tags":{"category":"pii"}}]},"evaluate":false,"output":true},{"id":"extract-headers","generator":"extract_schema","conditions":[{"operator":"equals","parameters":{"inputs":[{"address":"waf.context.processor","key_path":["extract-schema"]}],"type":"boolean","value":true}}],"parameters":{"mappings":[{"inputs":[{"address":"server.request.headers.no_cookies"}],"output":"_dd.appsec.s.req.headers"},{"inputs":[{"address":"server.response.headers.no_cookies"}],"output":"_dd.appsec.s.res.headers"}],"scanners":[{"tags":{"category":"credentials"}},{"tags":{"category":"pii"}}]},"evaluate":false,"output":true},{"id":"http-header-fingerprint","generator":"http_header_fingerprint","conditions":[{"operator":"exists","parameters":{"inputs":[{"address":"waf.context.event"},{"address":"server.business_logic.users.login.failure"},{"address":"server.business_logic.users.login.success"}]}}],"parameters":{"mappings":[{"headers":[{"address":"server.request.headers.no_cookies"}],"output":"_dd.appsec.fp.http.header"}]},"evaluate":false,"output":true},{"id":"http-network-fingerprint","generator":"http_network_fingerprint","conditions":[{"operator":"exists","parameters":{"inputs":[{"address":"waf.context.event"},{"address":"server.business_logic.users.login.failure"},{"address":"server.business_logic.users.login.success"}]}}],"parameters":{"mappings":[{"headers":[{"address":"server.request.headers.no_cookies"}],"output":"_dd.appsec.fp.http.network"}]},"evaluate":false,"output":true},{"id":"session-fingerprint","generator":"session_fingerprint","conditions":[{"operator":"exists","parameters":{"inputs":[{"address":"waf.context.event"},{"address":"server.business_logic.users.login.failure"},{"address":"server.business_logic.users.login.success"}]}}],"parameters":{"mappings":[{"cookies":[{"address":"server.request.cookies"}],"session_id":[{"address":"usr.session_id"}],"user_id":[{"address":"usr.id"}],"output":"_dd.appsec.fp.session"}]},"evaluate":false,"output":true}],"scanners":[{"id":"406f8606-52c4-4663-8db9-df70f9e8766c","name":"ZIP Code","key":{"operator":"match_regex","parameters":{"regex":"\\\\b(?:zip|postal)\\\\b","options":{"case_sensitive":false,"min_length":3}}},"value":{"operator":"match_regex","parameters":{"regex":"^[0-9]{5}(?:-[0-9]{4})?$","options":{"case_sensitive":true,"min_length":5}}},"tags":{"type":"zipcode","category":"address"}},{"id":"JU1sRk3mSzqSUJn6GrVn7g","name":"American Express Card Scanner (4+4+4+3 digits)","key":{"operator":"match_regex","parameters":{"regex":"\\\\b(?:card|cc|credit|debit|payment|amex|visa|mastercard|maestro|discover|jcb|diner|amex|visa|mastercard|maestro|discover|jcb|diner)\\\\b","options":{"case_sensitive":false,"min_length":3}}},"value":{"operator":"match_regex","parameters":{"regex":"\\\\b3[47]\\\\d{2}(?:(?:\\\\s\\\\d{4}\\\\s\\\\d{4}\\\\s\\\\d{3})|(?:\\\\,\\\\d{4}\\\\,\\\\d{4}\\\\,\\\\d{3})|(?:-\\\\d{4}-\\\\d{4}-\\\\d{3})|(?:\\\\.\\\\d{4}\\\\.\\\\d{4}\\\\.\\\\d{3}))\\\\b","options":{"case_sensitive":false,"min_length":16}}},"tags":{"type":"card","card_type":"amex","category":"payment"}},{"id":"edmH513UTQWcRiQ9UnzHlw-mod","name":"American Express Card Scanner (4+6|5+5|6 digits)","key":{"operator":"match_regex","parameters":{"regex":"\\\\b(?:card|cc|credit|debit|payment|amex|visa|mastercard|maestro|discover|jcb|diner)\\\\b","options":{"case_sensitive":false,"min_length":3}}},"value":{"operator":"match_regex","parameters":{"regex":"\\\\b3[47]\\\\d{2}(?:(?:\\\\s\\\\d{5,6}\\\\s\\\\d{5,6})|(?:\\\\.\\\\d{5,6}\\\\.\\\\d{5,6})|(?:-\\\\d{5,6}-\\\\d{5,6})|(?:,\\\\d{5,6},\\\\d{5,6}))\\\\b","options":{"case_sensitive":false,"min_length":17}}},"tags":{"type":"card","card_type":"amex","category":"payment"}},{"id":"e6K4h_7qTLaMiAbaNXoSZA","name":"American Express Card Scanner (8+7 digits)","key":{"operator":"match_regex","parameters":{"regex":"\\\\b(?:card|cc|credit|debit|payment|amex|visa|mastercard|maestro|discover|jcb|diner)\\\\b","options":{"case_sensitive":false,"min_length":3}}},"value":{"operator":"match_regex","parameters":{"regex":"\\\\b3[47]\\\\d{6}(?:(?:\\\\s\\\\d{7})|(?:\\\\,\\\\d{7})|(?:-\\\\d{7})|(?:\\\\.\\\\d{7}))\\\\b","options":{"case_sensitive":false,"min_length":16}}},"tags":{"type":"card","card_type":"amex","category":"payment"}},{"id":"K2rZflWzRhGM9HiTc6whyQ","name":"American Express Card Scanner (1x15 digits)","key":{"operator":"match_regex","parameters":{"regex":"\\\\b(?:card|cc|credit|debit|payment|amex|visa|mastercard|maestro|discover|jcb|diner)\\\\b","options":{"case_sensitive":false,"min_length":3}}},"value":{"operator":"match_regex","parameters":{"regex":"\\\\b3[47]\\\\d{13}\\\\b","options":{"case_sensitive":false,"min_length":15}}},"tags":{"type":"card","card_type":"amex","category":"payment"}},{"id":"9d7756e343cefa22a5c098e1092590f806eb5446","name":"Basic Authentication Scanner","key":{"operator":"match_regex","parameters":{"regex":"\\\\bauthorization\\\\b","options":{"case_sensitive":false,"min_length":13}}},"value":{"operator":"match_regex","parameters":{"regex":"^basic\\\\s+[A-Za-z0-9+/=]+","options":{"case_sensitive":false,"min_length":7}}},"tags":{"type":"basic_auth","category":"credentials"}},{"id":"mZy8XjZLReC9smpERXWnnw","name":"Bearer Authentication Scanner","key":{"operator":"match_regex","parameters":{"regex":"\\\\bauthorization\\\\b","options":{"case_sensitive":false,"min_length":13}}},"value":{"operator":"match_regex","parameters":{"regex":"^bearer\\\\s+[-a-z0-9._~+/]{4,}","options":{"case_sensitive":false,"min_length":11}}},"tags":{"type":"bearer_token","category":"credentials"}},{"id":"450239afc250a19799b6c03dc0e16fd6a4b2a1af","name":"Canadian Social Insurance Number Scanner","key":{"operator":"match_regex","parameters":{"regex":"\\\\b(?:social[\\\\s_]?(?:insurance(?:\\\\s+number)?)?|SIN|Canadian[\\\\s_]?(?:social[\\\\s_]?(?:insurance)?|insurance[\\\\s_]?number)?)\\\\b","options":{"case_sensitive":false,"min_length":3}}},"value":{"operator":"match_regex","parameters":{"regex":"\\\\b\\\\d{3}-\\\\d{3}-\\\\d{3}\\\\b","options":{"case_sensitive":false,"min_length":11}}},"tags":{"type":"canadian_sin","category":"pii"}},{"id":"87a879ff33693b46c8a614d8211f5a2c289beca0","name":"Digest Authentication Scanner","key":{"operator":"match_regex","parameters":{"regex":"\\\\bauthorization\\\\b","options":{"case_sensitive":false,"min_length":13}}},"value":{"operator":"match_regex","parameters":{"regex":"^digest\\\\s+","options":{"case_sensitive":false,"min_length":7}}},"tags":{"type":"digest_auth","category":"credentials"}},{"id":"qWumeP1GQUa_E4ffAnT-Yg","name":"American Express Card Scanner (1x14 digits)","key":{"operator":"match_regex","parameters":{"regex":"\\\\b(?:card|cc|credit|debit|payment|amex|visa|mastercard|maestro|discover|jcb|diner)\\\\b","options":{"case_sensitive":false,"min_length":3}}},"value":{"operator":"match_regex","parameters":{"regex":"(?:30[0-59]\\\\d|3[689]\\\\d{2})(?:\\\\d{10})","options":{"case_sensitive":false,"min_length":14}}},"tags":{"type":"card","card_type":"diners","category":"payment"}},{"id":"NlTWWM5LS6W0GSqBLuvtRw","name":"Diners Card Scanner (4+4+4+2 digits)","key":{"operator":"match_regex","parameters":{"regex":"\\\\b(?:card|cc|credit|debit|payment|amex|visa|mastercard|maestro|discover|jcb|diner)\\\\b","options":{"case_sensitive":false,"min_length":3}}},"value":{"operator":"match_regex","parameters":{"regex":"\\\\b(?:30[0-59]\\\\d|3[689]\\\\d{2})(?:(?:\\\\s\\\\d{4}\\\\s\\\\d{4}\\\\s\\\\d{2})|(?:\\\\,\\\\d{4}\\\\,\\\\d{4}\\\\,\\\\d{2})|(?:-\\\\d{4}-\\\\d{4}-\\\\d{2})|(?:\\\\.\\\\d{4}\\\\.\\\\d{4}\\\\.\\\\d{2}))\\\\b","options":{"case_sensitive":false,"min_length":17}}},"tags":{"type":"card","card_type":"diners","category":"payment"}},{"id":"Xr5VdbQSTXitYGGiTfxBpw","name":"Diners Card Scanner (4+6+4 digits)","key":{"operator":"match_regex","parameters":{"regex":"\\\\b(?:card|cc|credit|debit|payment|amex|visa|mastercard|maestro|discover|jcb|diner)\\\\b","options":{"case_sensitive":false,"min_length":3}}},"value":{"operator":"match_regex","parameters":{"regex":"\\\\b(?:30[0-59]\\\\d|3[689]\\\\d{2})(?:(?:\\\\s\\\\d{6}\\\\s\\\\d{4})|(?:\\\\.\\\\d{6}\\\\.\\\\d{4})|(?:-\\\\d{6}-\\\\d{4})|(?:,\\\\d{6},\\\\d{4}))\\\\b","options":{"case_sensitive":false,"min_length":16}}},"tags":{"type":"card","card_type":"diners","category":"payment"}},{"id":"gAbunN_WQNytxu54DjcbAA-mod","name":"Diners Card Scanner (8+6 digits)","key":{"operator":"match_regex","parameters":{"regex":"\\\\b(?:card|cc|credit|debit|payment|amex|visa|mastercard|maestro|discover|jcb|diner)\\\\b","options":{"case_sensitive":false,"min_length":3}}},"value":{"operator":"match_regex","parameters":{"regex":"\\\\b(?:30[0-59]\\\\d{5}|3[689]\\\\d{6})\\\\s?(?:(?:\\\\s\\\\d{6})|(?:\\\\,\\\\d{6})|(?:-\\\\d{6})|(?:\\\\.\\\\d{6}))\\\\b","options":{"case_sensitive":false,"min_length":14}}},"tags":{"type":"card","card_type":"diners","category":"payment"}},{"id":"9cs4qCfEQBeX17U7AepOvQ","name":"MasterCard Scanner (2x8 digits)","key":{"operator":"match_regex","parameters":{"regex":"\\\\b(?:card|cc|credit|debit|payment|amex|visa|mastercard|maestro|discover|jcb|diner)\\\\b","options":{"case_sensitive":false,"min_length":3}}},"value":{"operator":"match_regex","parameters":{"regex":"\\\\b(?:6221(?:2[6-9]|[3-9][0-9])\\\\d{2}(?:,\\\\d{8}|\\\\s\\\\d{8}|-\\\\d{8}|\\\\.\\\\d{8})|6229(?:[01][0-9]|2[0-5])\\\\d{2}(?:,\\\\d{8}|\\\\s\\\\d{8}|-\\\\d{8}|\\\\.\\\\d{8})|(?:6011|65\\\\d{2}|64[4-9]\\\\d|622[2-8])\\\\d{4}(?:,\\\\d{8}|\\\\s\\\\d{8}|-\\\\d{8}|\\\\.\\\\d{8}))\\\\b","options":{"case_sensitive":false,"min_length":16}}},"tags":{"type":"card","card_type":"discover","category":"payment"}},{"id":"YBIDWJIvQWW_TFOyU0CGJg","name":"Discover Card Scanner (4x4 digits)","key":{"operator":"match_regex","parameters":{"regex":"\\\\b(?:card|cc|credit|debit|payment|amex|visa|mastercard|maestro|discover|jcb|diner)\\\\b","options":{"case_sensitive":false,"min_length":3}}},"value":{"operator":"match_regex","parameters":{"regex":"\\\\b(?:(?:(?:6221(?:2[6-9]|[3-9][0-9])\\\\d{2}(?:,\\\\d{4}){2})|(?:6221\\\\s(?:2[6-9]|[3-9][0-9])\\\\d{2}(?:\\\\s\\\\d{4}){2})|(?:6221\\\\.(?:2[6-9]|[3-9][0-9])\\\\d{2}(?:\\\\.\\\\d{4}){2})|(?:6221-(?:2[6-9]|[3-9][0-9])\\\\d{2}(?:-\\\\d{4}){2}))|(?:(?:6229(?:[01][0-9]|2[0-5])\\\\d{2}(?:,\\\\d{4}){2})|(?:6229\\\\s(?:[01][0-9]|2[0-5])\\\\d{2}(?:\\\\s\\\\d{4}){2})|(?:6229\\\\.(?:[01][0-9]|2[0-5])\\\\d{2}(?:\\\\.\\\\d{4}){2})|(?:6229-(?:[01][0-9]|2[0-5])\\\\d{2}(?:-\\\\d{4}){2}))|(?:(?:6011|65\\\\d{2}|64[4-9]\\\\d|622[2-8])(?:(?:\\\\s\\\\d{4}){3}|(?:\\\\.\\\\d{4}){3}|(?:-\\\\d{4}){3}|(?:,\\\\d{4}){3})))\\\\b","options":{"case_sensitive":false,"min_length":16}}},"tags":{"type":"card","card_type":"discover","category":"payment"}},{"id":"12cpbjtVTMaMutFhh9sojQ","name":"Discover Card Scanner (1x16 digits)","key":{"operator":"match_regex","parameters":{"regex":"\\\\b(?:card|cc|credit|debit|payment|amex|visa|mastercard|maestro|discover|jcb|diner)\\\\b","options":{"case_sensitive":false,"min_length":3}}},"value":{"operator":"match_regex","parameters":{"regex":"\\\\b(?:6221(?:2[6-9]|[3-9][0-9])\\\\d{10}|6229(?:[01][0-9]|2[0-5])\\\\d{10}|(?:6011|65\\\\d{2}|64[4-9]\\\\d|622[2-8])\\\\d{12})\\\\b","options":{"case_sensitive":false,"min_length":16}}},"tags":{"type":"card","card_type":"discover","category":"payment"}},{"id":"PuXiVTCkTHOtj0Yad1ppsw","name":"Standard E-mail Address","key":{"operator":"match_regex","parameters":{"regex":"\\\\b(?:(?:e[-\\\\s]?)?mail|address|sender|\\\\bto\\\\b|from|recipient)\\\\b","options":{"case_sensitive":false,"min_length":2}}},"value":{"operator":"match_regex","parameters":{"regex":"\\\\b[\\\\w!#$%&\'*+/=?`{|}~^-]+(?:\\\\.[\\\\w!#$%&\'*+/=?`{|}~^-]+)*(%40|@)(?:[a-zA-Z0-9-]+\\\\.)+[a-zA-Z]{2,6}\\\\b","options":{"case_sensitive":false,"min_length":5}}},"tags":{"type":"email","category":"pii"}},{"id":"8VS2RKxzR8a_95L5fuwaXQ","name":"IBAN","key":{"operator":"match_regex","parameters":{"regex":"\\\\b(?:iban|account|sender|receiver)\\\\b","options":{"case_sensitive":false,"min_length":3}}},"value":{"operator":"match_regex","parameters":{"regex":"\\\\b(?:NO\\\\d{2}(?:[ \\\\-]?\\\\d{4}){2}[ \\\\-]?\\\\d{3}|BE\\\\d{2}(?:[ \\\\-]?\\\\d{4}){3}|(?:DK|FO|FI|GL|SD)\\\\d{2}(?:[ \\\\-]?\\\\d{4}){3}[ \\\\-]?\\\\d{2}|NL\\\\d{2}[ \\\\-]?[A-Z]{4}(?:[ \\\\-]?\\\\d{4}){2}[ \\\\-]?\\\\d{2}|MK\\\\d{2}[ \\\\-]?\\\\d{3}[A-Z0-9](?:[ \\\\-]?[A-Z0-9]{4}){2}[ \\\\-]?[A-Z0-9]\\\\d{2}|SI\\\\d{17}|(?:AT|BA|EE|LT|XK)\\\\d{18}|(?:LU|KZ|EE|LT)\\\\d{5}[A-Z0-9]{13}|LV\\\\d{2}[A-Z]{4}[A-Z0-9]{13}|(?:LI|CH)\\\\d{2}[ \\\\-]?\\\\d{4}[ \\\\-]?\\\\d[A-Z0-9]{3}(?:[ \\\\-]?[A-Z0-9]{4}){2}[ \\\\-]?[A-Z0-9]|HR\\\\d{2}(?:[ \\\\-]?\\\\d{4}){4}[ \\\\-]?\\\\d|GE\\\\d{2}[ \\\\-]?[A-Z0-9]{2}\\\\d{2}\\\\d{14}|VA\\\\d{20}|BG\\\\d{2}[A-Z]{4}\\\\d{6}[A-Z0-9]{8}|BH\\\\d{2}[A-Z]{4}[A-Z0-9]{14}|GB\\\\d{2}[A-Z]{4}(?:[ \\\\-]?\\\\d{4}){3}[ \\\\-]?\\\\d{2}|IE\\\\d{2}[ \\\\-]?[A-Z0-9]{4}(?:[ \\\\-]?\\\\d{4}){3}[ \\\\-]?\\\\d{2}|(?:CR|DE|ME|RS)\\\\d{2}(?:[ \\\\-]?\\\\d{4}){4}[ \\\\-]?\\\\d{2}|(?:AE|TL|IL)\\\\d{2}(?:[ \\\\-]?\\\\d{4}){4}[ \\\\-]?\\\\d{3}|GI\\\\d{2}[ \\\\-]?[A-Z]{4}(?:[ \\\\-]?[A-Z0-9]{4}){3}[ \\\\-]?[A-Z0-9]{3}|IQ\\\\d{2}[ \\\\-]?[A-Z]{4}(?:[ \\\\-]?\\\\d{4}){3}[ \\\\-]?\\\\d{3}|MD\\\\d{2}(?:[ \\\\-]?[A-Z0-9]{4}){5}|SA\\\\d{2}[ \\\\-]?\\\\d{2}[A-Z0-9]{2}(?:[ \\\\-]?[A-Z0-9]{4}){4}|RO\\\\d{2}[ \\\\-]?[A-Z]{4}(?:[ \\\\-]?[A-Z0-9]{4}){4}|(?:PK|VG)\\\\d{2}[ \\\\-]?[A-Z0-9]{4}(?:[ \\\\-]?\\\\d{4}){4}|AD\\\\d{2}(?:[ \\\\-]?\\\\d{4}){2}(?:[ \\\\-]?[A-Z0-9]{4}){3}|(?:CZ|SK|ES|SE|TN)\\\\d{2}(?:[ \\\\-]?\\\\d{4}){5}|(?:LY|PT|ST)\\\\d{2}(?:[ \\\\-]?\\\\d{4}){5}[ \\\\-]?\\\\d|TR\\\\d{2}[ \\\\-]?\\\\d{4}[ \\\\-]?\\\\d[A-Z0-9]{3}(?:[ \\\\-]?[A-Z0-9]{4}){3}[ \\\\-]?[A-Z0-9]{2}|IS\\\\d{2}(?:[ \\\\-]?\\\\d{4}){5}[ \\\\-]?\\\\d{2}|(?:IT|SM)\\\\d{2}[ \\\\-]?[A-Z]\\\\d{3}[ \\\\-]?\\\\d{4}[ \\\\-]?\\\\d{3}[A-Z0-9](?:[ \\\\-]?[A-Z0-9]{4}){2}[ \\\\-]?[A-Z0-9]{3}|GR\\\\d{2}[ \\\\-]?\\\\d{4}[ \\\\-]?\\\\d{3}[A-Z0-9](?:[ \\\\-]?[A-Z0-9]{4}){3}[A-Z0-9]{3}|(?:FR|MC)\\\\d{2}(?:[ \\\\-]?\\\\d{4}){2}[ \\\\-]?\\\\d{2}[A-Z0-9]{2}(?:[ \\\\-]?[A-Z0-9]{4}){2}[ \\\\-]?[A-Z0-9]\\\\d{2}|MR\\\\d{2}(?:[ \\\\-]?\\\\d{4}){5}[ \\\\-]?\\\\d{3}|(?:SV|DO)\\\\d{2}[ \\\\-]?[A-Z]{4}(?:[ \\\\-]?\\\\d{4}){5}|BY\\\\d{2}[ \\\\-]?[A-Z]{4}[ \\\\-]?\\\\d{4}(?:[ \\\\-]?[A-Z0-9]{4}){4}|GT\\\\d{2}(?:[ \\\\-]?[A-Z0-9]{4}){6}|AZ\\\\d{2}[ \\\\-]?[A-Z0-9]{4}(?:[ \\\\-]?\\\\d{5}){4}|LB\\\\d{2}[ \\\\-]?\\\\d{4}(?:[ \\\\-]?[A-Z0-9]{5}){4}|(?:AL|CY)\\\\d{2}(?:[ \\\\-]?\\\\d{4}){2}(?:[ \\\\-]?[A-Z0-9]{4}){4}|(?:HU|PL)\\\\d{2}(?:[ \\\\-]?\\\\d{4}){6}|QA\\\\d{2}[ \\\\-]?[A-Z]{4}(?:[ \\\\-]?[A-Z0-9]{4}){5}[ \\\\-]?[A-Z0-9]|PS\\\\d{2}[ \\\\-]?[A-Z0-9]{4}(?:[ \\\\-]?\\\\d{4}){5}[ \\\\-]?\\\\d|UA\\\\d{2}[ \\\\-]?\\\\d{4}[ \\\\-]?\\\\d{2}[A-Z0-9]{2}(?:[ \\\\-]?[A-Z0-9]{4}){4}[ \\\\-]?[A-Z0-9]|BR\\\\d{2}(?:[ \\\\-]?\\\\d{4}){5}[ \\\\-]?\\\\d{3}[A-Z0-9][ \\\\-]?[A-Z0-9]|EG\\\\d{2}(?:[ \\\\-]?\\\\d{4}){6}\\\\d|MU\\\\d{2}[ \\\\-]?[A-Z]{4}(?:[ \\\\-]?\\\\d{4}){4}\\\\d{3}[A-Z][ \\\\-]?[A-Z]{2}|(?:KW|JO)\\\\d{2}[ \\\\-]?[A-Z]{4}(?:[ \\\\-]?[A-Z0-9]{4}){5}[ \\\\-]?[A-Z0-9]{2}|MT\\\\d{2}[ \\\\-]?[A-Z]{4}[ \\\\-]?\\\\d{4}[ \\\\-]?\\\\d[A-Z0-9]{3}(?:[ \\\\-]?[A-Z0-9]{3}){4}[ \\\\-]?[A-Z0-9]{3}|SC\\\\d{2}[ \\\\-]?[A-Z]{4}(?:[ \\\\-]?\\\\d{4}){5}[ \\\\-]?[A-Z]{3}|LC\\\\d{2}[ \\\\-]?[A-Z]{4}(?:[ \\\\-]?[A-Z0-9]{4}){6})\\\\b","options":{"case_sensitive":false,"min_length":15}}},"tags":{"type":"iban","category":"payment"}},{"id":"h6WJcecQTwqvN9KeEtwDvg","name":"JCB Card Scanner (1x16 digits)","key":{"operator":"match_regex","parameters":{"regex":"\\\\b(?:card|cc|credit|debit|payment|amex|visa|mastercard|maestro|discover|jcb|diner)\\\\b","options":{"case_sensitive":false,"min_length":3}}},"value":{"operator":"match_regex","parameters":{"regex":"\\\\b35(?:2[89]|[3-9][0-9])(?:\\\\d{12})\\\\b","options":{"case_sensitive":false,"min_length":16}}},"tags":{"type":"card","card_type":"jcb","category":"payment"}},{"id":"gcEaMu_VSJ2-bGCEkgyC0w","name":"JCB Card Scanner (2x8 digits)","key":{"operator":"match_regex","parameters":{"regex":"\\\\b(?:card|cc|credit|debit|payment|amex|visa|mastercard|maestro|discover|jcb|diner)\\\\b","options":{"case_sensitive":false,"min_length":3}}},"value":{"operator":"match_regex","parameters":{"regex":"\\\\b35(?:2[89]|[3-9][0-9])\\\\d{4}(?:(?:,\\\\d{8})|(?:-\\\\d{8})|(?:\\\\s\\\\d{8})|(?:\\\\.\\\\d{8}))\\\\b","options":{"case_sensitive":false,"min_length":17}}},"tags":{"type":"card","card_type":"jcb","category":"payment"}},{"id":"imTliuhXT5GAeRNhqChXQQ","name":"JCB Card Scanner (4x4 digits)","key":{"operator":"match_regex","parameters":{"regex":"\\\\b(?:card|cc|credit|debit|payment|amex|visa|mastercard|maestro|discover|jcb|diner)\\\\b","options":{"case_sensitive":false,"min_length":3}}},"value":{"operator":"match_regex","parameters":{"regex":"\\\\b35(?:2[89]|[3-9][0-9])(?:(?:\\\\s\\\\d{4}){3}|(?:\\\\.\\\\d{4}){3}|(?:-\\\\d{4}){3}|(?:,\\\\d{4}){3})\\\\b","options":{"case_sensitive":false,"min_length":16}}},"tags":{"type":"card","card_type":"jcb","category":"payment"}},{"id":"9osY3xc9Q7ONAV0zw9Uz4A","name":"JSON Web Token","value":{"operator":"match_regex","parameters":{"regex":"\\\\bey[I-L][\\\\w=-]+\\\\.ey[I-L][\\\\w=-]+(\\\\.[\\\\w.+\\\\/=-]+)?\\\\b","options":{"case_sensitive":false,"min_length":20}}},"tags":{"type":"json_web_token","category":"credentials"}},{"id":"d1Q9D3YMRxuVKf6CZInJPw","name":"Maestro Card Scanner (1x16 digits)","key":{"operator":"match_regex","parameters":{"regex":"\\\\b(?:card|cc|credit|debit|payment|amex|visa|mastercard|maestro|discover|jcb|diner)\\\\b","options":{"case_sensitive":false,"min_length":3}}},"value":{"operator":"match_regex","parameters":{"regex":"\\\\b(?:5[06-9]\\\\d{2}|6\\\\d{3})(?:\\\\d{12})\\\\b","options":{"case_sensitive":false,"min_length":16}}},"tags":{"type":"card","card_type":"maestro","category":"payment"}},{"id":"M3YIQKKjRVmoeQuM3pjzrw","name":"Maestro Card Scanner (2x8 digits)","key":{"operator":"match_regex","parameters":{"regex":"\\\\b(?:card|cc|credit|debit|payment|amex|visa|mastercard|maestro|discover|jcb|diner)\\\\b","options":{"case_sensitive":false,"min_length":3}}},"value":{"operator":"match_regex","parameters":{"regex":"\\\\b(?:5[06-9]\\\\d{6}|6\\\\d{7})(?:\\\\s\\\\d{8}|\\\\.\\\\d{8}|-\\\\d{8}|,\\\\d{8})\\\\b","options":{"case_sensitive":false,"min_length":17}}},"tags":{"type":"card","card_type":"maestro","category":"payment"}},{"id":"hRxiQBlSSVKcjh5U7LZYLA","name":"Maestro Card Scanner (4x4 digits)","key":{"operator":"match_regex","parameters":{"regex":"\\\\b(?:card|cc|credit|debit|payment|amex|visa|mastercard|maestro|discover|jcb|diner)\\\\b","options":{"case_sensitive":false,"min_length":3}}},"value":{"operator":"match_regex","parameters":{"regex":"\\\\b(?:5[06-9]\\\\d{2}|6\\\\d{3})(?:(?:\\\\s\\\\d{4}){3}|(?:\\\\.\\\\d{4}){3}|(?:-\\\\d{4}){3}|(?:,\\\\d{4}){3})\\\\b","options":{"case_sensitive":false,"min_length":16}}},"tags":{"type":"card","card_type":"maestro","category":"payment"}},{"id":"NwhIYNS4STqZys37WlaIKA","name":"MasterCard Scanner (2x8 digits)","key":{"operator":"match_regex","parameters":{"regex":"\\\\b(?:card|cc|credit|debit|payment|amex|visa|mastercard|maestro|discover|jcb|diner)\\\\b","options":{"case_sensitive":false,"min_length":3}}},"value":{"operator":"match_regex","parameters":{"regex":"\\\\b(?:(?:5[1-5]\\\\d{2})|(?:222[1-9])|(?:22[3-9]\\\\d)|(?:2[3-6]\\\\d{2})|(?:27[0-1]\\\\d)|(?:2720))(?:(?:\\\\d{4}(?:(?:,\\\\d{8})|(?:-\\\\d{8})|(?:\\\\s\\\\d{8})|(?:\\\\.\\\\d{8}))))\\\\b","options":{"case_sensitive":false,"min_length":16}}},"tags":{"type":"card","card_type":"mastercard","category":"payment"}},{"id":"axxJkyjhRTOuhjwlsA35Vw","name":"MasterCard Scanner (4x4 digits)","key":{"operator":"match_regex","parameters":{"regex":"\\\\b(?:card|cc|credit|debit|payment|amex|visa|mastercard|maestro|discover|jcb|diner)\\\\b","options":{"case_sensitive":false,"min_length":3}}},"value":{"operator":"match_regex","parameters":{"regex":"\\\\b(?:(?:5[1-5]\\\\d{2})|(?:222[1-9])|(?:22[3-9]\\\\d)|(?:2[3-6]\\\\d{2})|(?:27[0-1]\\\\d)|(?:2720))(?:(?:\\\\s\\\\d{4}){3}|(?:\\\\.\\\\d{4}){3}|(?:-\\\\d{4}){3}|(?:,\\\\d{4}){3})\\\\b","options":{"case_sensitive":false,"min_length":16}}},"tags":{"type":"card","card_type":"mastercard","category":"payment"}},{"id":"76EhmoK3TPqJcpM-fK0pLw","name":"MasterCard Scanner (1x16 digits)","key":{"operator":"match_regex","parameters":{"regex":"\\\\b(?:card|cc|credit|debit|payment|amex|visa|mastercard|maestro|discover|jcb|diner)\\\\b","options":{"case_sensitive":false,"min_length":3}}},"value":{"operator":"match_regex","parameters":{"regex":"\\\\b(?:(?:5[1-5]\\\\d{2})|(?:222[1-9])|(?:22[3-9]\\\\d)|(?:2[3-6]\\\\d{2})|(?:27[0-1]\\\\d)|(?:2720))(?:\\\\d{12})\\\\b","options":{"case_sensitive":false,"min_length":16}}},"tags":{"type":"card","card_type":"mastercard","category":"payment"}},{"id":"18b608bd7a764bff5b2344c0","name":"Phone number","key":{"operator":"match_regex","parameters":{"regex":"\\\\bphone|number|mobile\\\\b","options":{"case_sensitive":false,"min_length":3}}},"value":{"operator":"match_regex","parameters":{"regex":"^(?:\\\\(\\\\+\\\\d{1,3}\\\\)|\\\\+\\\\d{1,3}|00\\\\d{1,3})?[-\\\\s\\\\.]?(?:\\\\(\\\\d{3}\\\\)[-\\\\s\\\\.]?)?(?:\\\\d[-\\\\s\\\\.]?){6,10}$","options":{"case_sensitive":false,"min_length":6}}},"tags":{"type":"phone","category":"pii"}},{"id":"de0899e0cbaaa812bb624cf04c912071012f616d-mod","name":"UK National Insurance Number Scanner","key":{"operator":"match_regex","parameters":{"regex":"^nin$|\\\\binsurance\\\\b","options":{"case_sensitive":false,"min_length":3}}},"value":{"operator":"match_regex","parameters":{"regex":"\\\\b[A-Z]{2}[\\\\s-]?\\\\d{6}[\\\\s-]?[A-Z]?\\\\b","options":{"case_sensitive":false,"min_length":8}}},"tags":{"type":"uk_nin","category":"pii"}},{"id":"d962f7ddb3f55041e39195a60ff79d4814a7c331","name":"US Passport Scanner","key":{"operator":"match_regex","parameters":{"regex":"\\\\bpassport\\\\b","options":{"case_sensitive":false,"min_length":8}}},"value":{"operator":"match_regex","parameters":{"regex":"\\\\b[0-9A-Z]{9}\\\\b|\\\\b[0-9]{6}[A-Z][0-9]{2}\\\\b","options":{"case_sensitive":false,"min_length":8}}},"tags":{"type":"passport_number","category":"pii"}},{"id":"7771fc3b-b205-4b93-bcef-28608c5c1b54","name":"United States Social Security Number Scanner","key":{"operator":"match_regex","parameters":{"regex":"\\\\b(?:SSN|(?:(?:social)?[\\\\s_]?(?:security)?[\\\\s_]?(?:number)?)?)\\\\b","options":{"case_sensitive":false,"min_length":3}}},"value":{"operator":"match_regex","parameters":{"regex":"\\\\b\\\\d{3}[-\\\\s\\\\.]{1}\\\\d{2}[-\\\\s\\\\.]{1}\\\\d{4}\\\\b","options":{"case_sensitive":false,"min_length":11}}},"tags":{"type":"us_ssn","category":"pii"}},{"id":"ac6d683cbac77f6e399a14990793dd8fd0fca333","name":"US Vehicle Identification Number Scanner","key":{"operator":"match_regex","parameters":{"regex":"\\\\b(?:vehicle[_\\\\s-]*identification[_\\\\s-]*number|vin)\\\\b","options":{"case_sensitive":false,"min_length":3}}},"value":{"operator":"match_regex","parameters":{"regex":"\\\\b[A-HJ-NPR-Z0-9]{17}\\\\b","options":{"case_sensitive":false,"min_length":17}}},"tags":{"type":"vin","category":"pii"}},{"id":"wJIgOygRQhKkR69b_9XbRQ","name":"Visa Card Scanner (2x8 digits)","key":{"operator":"match_regex","parameters":{"regex":"\\\\b(?:card|cc|credit|debit|payment|amex|visa|mastercard|maestro|discover|jcb|diner)\\\\b","options":{"case_sensitive":false,"min_length":3}}},"value":{"operator":"match_regex","parameters":{"regex":"\\\\b4\\\\d{3}(?:(?:\\\\d{4}(?:(?:,\\\\d{8})|(?:-\\\\d{8})|(?:\\\\s\\\\d{8})|(?:\\\\.\\\\d{8}))))\\\\b","options":{"case_sensitive":false,"min_length":16}}},"tags":{"type":"card","card_type":"visa","category":"payment"}},{"id":"0o71SJxXQNK7Q6gMbBesFQ","name":"Visa Card Scanner (4x4 digits)","key":{"operator":"match_regex","parameters":{"regex":"\\\\b(?:card|cc|credit|debit|payment|amex|visa|mastercard|maestro|discover|jcb|diner)\\\\b","options":{"case_sensitive":false,"min_length":3}}},"value":{"operator":"match_regex","parameters":{"regex":"\\\\b4\\\\d{3}(?:(?:,\\\\d{4}){3}|(?:\\\\s\\\\d{4}){3}|(?:\\\\.\\\\d{4}){3}|(?:-\\\\d{4}){3})\\\\b","options":{"case_sensitive":false,"min_length":16}}},"tags":{"type":"card","card_type":"visa","category":"payment"}},{"id":"QrHD6AfgQm6z-j0wStxTvA","name":"Visa Card Scanner (1x15 & 1x16 & 1x19 digits)","key":{"operator":"match_regex","parameters":{"regex":"\\\\b(?:card|cc|credit|debit|payment|amex|visa|mastercard|maestro|discover|jcb|diner)\\\\b","options":{"case_sensitive":false,"min_length":3}}},"value":{"operator":"match_regex","parameters":{"regex":"4[0-9]{12}(?:[0-9]{3})?","options":{"case_sensitive":false,"min_length":13}}},"tags":{"type":"card","card_type":"visa","category":"payment"}}]}')},88123:e=>{"use strict";e.exports=JSON.parse('{"sns":{"request":["$.Attributes.KmsMasterKeyId","$.Attributes.PlatformCredential","$.Attributes.PlatformPrincipal","$.Attributes.Token","$.AWSAccountId","$.Endpoint","$.OneTimePassword","$.phoneNumber","$.PhoneNumber","$.Token"],"response":["$.Attributes.KmsMasterKeyId","$.Attributes.Token","$.Endpoints.*.Token","$.PhoneNumber","$.PlatformApplication.*.PlatformCredential","$.PlatformApplication.*.PlatformPrincipal","$.Subscriptions.*.Endpoint","$.PhoneNumbers[*].PhoneNumber","$.phoneNumbers[*]"],"expand":["$.MessageAttributes.*.StringValue"]},"eventbridge":{"request":["$.AuthParameters.OAuthParameters.OAuthHttpParameters.HeaderParameters[*].Value","$.AuthParameters.OAuthParameters.OAuthHttpParameters.QueryStringParameters[*].Value","$.AuthParameters.OAuthParameters.OAuthHttpParameters.BodyParameters[*].Value","$.AuthParameters.InvocationHttpParameters.HeaderParameters[*].Value","$.AuthParameters.InvocationHttpParameters.QueryStringParameters[*].Value","$.AuthParameters.InvocationHttpParameters.BodyParameters[*].Value","$.Targets[*].RedshiftDataParameters.Sql","$.Targets[*].RedshiftDataParameters.Sqls","$.Targets[*].AppSyncParameters.GraphQLOperation","$.AuthParameters.BasicAuthParameters.Password","$.AuthParameters.OAuthParameters.ClientParameters.ClientSecret","$.AuthParameters.ApiKeyAuthParameters.ApiKeyValue"],"response":["$.AuthParameters.OAuthParameters.OAuthHttpParameters.HeaderParameters[*].Value","$.AuthParameters.OAuthParameters.OAuthHttpParameters.QueryStringParameters[*].Value","$.AuthParameters.OAuthParameters.OAuthHttpParameters.BodyParameters[*].Value","$.AuthParameters.InvocationHttpParameters.HeaderParameters[*].Value","$.AuthParameters.InvocationHttpParameters.QueryStringParameters[*].Value","$.AuthParameters.InvocationHttpParameters.BodyParameters[*].Value","$.Targets[*].RedshiftDataParameters.Sql","$.Targets[*].RedshiftDataParameters.Sqls","$.Targets[*].AppSyncParameters.GraphQLOperation"],"expand":[]},"s3":{"request":["$.SSEKMSKeyId","$.SSEKMSEncryptionContext","$.ServerSideEncryptionConfiguration.Rules[*].ApplyServerSideEncryptionByDefault.KMSMasterKeyID","$.InventoryConfiguration.Destination.S3BucketDestination.Encryption.SSEKMS.KeyId","$.SSECustomerKey","$.CopySourceSSECustomerKey","$.RestoreRequest.OutputLocation.S3.Encryption.KMSKeyId"],"response":["$.SSEKMSKeyId","$.SSEKMSEncryptionContext","$.ServerSideEncryptionConfiguration.Rules[*].ApplyServerSideEncryptionByDefault.KMSMasterKeyID","$.InventoryConfiguration.Destination.S3BucketDestination.Encryption.SSEKMS.KeyId","$.Credentials.SecretAccessKey","$.Credentials.SessionToken","$.InventoryConfigurationList[*].Destination.S3BucketDestination.Encryption.SSEKMS.KeyId"],"expand":[]},"sqs":{"request":[],"response":[],"expand":[]},"kinesis":{"request":[],"response":[],"expand":[]}}')}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var r=__webpack_module_cache__[e]={id:e,loaded:!1,exports:{}};return __webpack_modules__[e].call(r.exports,r,r.exports,__webpack_require__),r.loaded=!0,r.exports}__webpack_require__.c=__webpack_module_cache__,__webpack_require__.d=(e,t)=>{for(var r in t)__webpack_require__.o(t,r)&&!__webpack_require__.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.nmd=e=>(e.paths=[],e.children||(e.children=[]),e);var __webpack_exports__=__webpack_require__(__webpack_require__.s=35237);return __webpack_exports__})()));