{"version":3,"file":"rfdc/index.js","sources":["webpack:///./rfdc/index.js"],"sourcesContent":["'use strict'\nmodule.exports = rfdc\n\nfunction copyBuffer (cur) {\n  if (cur instanceof Buffer) {\n    return Buffer.from(cur)\n  }\n\n  return new cur.constructor(cur.buffer.slice(), cur.byteOffset, cur.length)\n}\n\nfunction rfdc (opts) {\n  opts = opts || {}\n  if (opts.circles) return rfdcCircles(opts)\n\n  const constructorHandlers = new Map()\n  constructorHandlers.set(Date, (o) => new Date(o))\n  constructorHandlers.set(Map, (o, fn) => new Map(cloneArray(Array.from(o), fn)))\n  constructorHandlers.set(Set, (o, fn) => new Set(cloneArray(Array.from(o), fn)))\n  if (opts.constructorHandlers) {\n    for (const handler of opts.constructorHandlers) {\n      constructorHandlers.set(handler[0], handler[1])\n    }\n  }\n\n  let handler = null\n\n  return opts.proto ? cloneProto : clone\n\n  function cloneArray (a, fn) {\n    const keys = Object.keys(a)\n    const a2 = new Array(keys.length)\n    for (let i = 0; i < keys.length; i++) {\n      const k = keys[i]\n      const cur = a[k]\n      if (typeof cur !== 'object' || cur === null) {\n        a2[k] = cur\n      } else if (cur.constructor !== Object && (handler = constructorHandlers.get(cur.constructor))) {\n        a2[k] = handler(cur, fn)\n      } else if (ArrayBuffer.isView(cur)) {\n        a2[k] = copyBuffer(cur)\n      } else {\n        a2[k] = fn(cur)\n      }\n    }\n    return a2\n  }\n\n  function clone (o) {\n    if (typeof o !== 'object' || o === null) return o\n    if (Array.isArray(o)) return cloneArray(o, clone)\n    if (o.constructor !== Object && (handler = constructorHandlers.get(o.constructor))) {\n      return handler(o, clone)\n    }\n    const o2 = {}\n    for (const k in o) {\n      if (Object.hasOwnProperty.call(o, k) === false) continue\n      const cur = o[k]\n      if (typeof cur !== 'object' || cur === null) {\n        o2[k] = cur\n      } else if (cur.constructor !== Object && (handler = constructorHandlers.get(cur.constructor))) {\n        o2[k] = handler(cur, clone)\n      } else if (ArrayBuffer.isView(cur)) {\n        o2[k] = copyBuffer(cur)\n      } else {\n        o2[k] = clone(cur)\n      }\n    }\n    return o2\n  }\n\n  function cloneProto (o) {\n    if (typeof o !== 'object' || o === null) return o\n    if (Array.isArray(o)) return cloneArray(o, cloneProto)\n    if (o.constructor !== Object && (handler = constructorHandlers.get(o.constructor))) {\n      return handler(o, cloneProto)\n    }\n    const o2 = {}\n    for (const k in o) {\n      const cur = o[k]\n      if (typeof cur !== 'object' || cur === null) {\n        o2[k] = cur\n      } else if (cur.constructor !== Object && (handler = constructorHandlers.get(cur.constructor))) {\n        o2[k] = handler(cur, cloneProto)\n      } else if (ArrayBuffer.isView(cur)) {\n        o2[k] = copyBuffer(cur)\n      } else {\n        o2[k] = cloneProto(cur)\n      }\n    }\n    return o2\n  }\n}\n\nfunction rfdcCircles (opts) {\n  const refs = []\n  const refsNew = []\n\n  const constructorHandlers = new Map()\n  constructorHandlers.set(Date, (o) => new Date(o))\n  constructorHandlers.set(Map, (o, fn) => new Map(cloneArray(Array.from(o), fn)))\n  constructorHandlers.set(Set, (o, fn) => new Set(cloneArray(Array.from(o), fn)))\n  if (opts.constructorHandlers) {\n    for (const handler of opts.constructorHandlers) {\n      constructorHandlers.set(handler[0], handler[1])\n    }\n  }\n\n  let handler = null\n  return opts.proto ? cloneProto : clone\n\n  function cloneArray (a, fn) {\n    const keys = Object.keys(a)\n    const a2 = new Array(keys.length)\n    for (let i = 0; i < keys.length; i++) {\n      const k = keys[i]\n      const cur = a[k]\n      if (typeof cur !== 'object' || cur === null) {\n        a2[k] = cur\n      } else if (cur.constructor !== Object && (handler = constructorHandlers.get(cur.constructor))) {\n        a2[k] = handler(cur, fn)\n      } else if (ArrayBuffer.isView(cur)) {\n        a2[k] = copyBuffer(cur)\n      } else {\n        const index = refs.indexOf(cur)\n        if (index !== -1) {\n          a2[k] = refsNew[index]\n        } else {\n          a2[k] = fn(cur)\n        }\n      }\n    }\n    return a2\n  }\n\n  function clone (o) {\n    if (typeof o !== 'object' || o === null) return o\n    if (Array.isArray(o)) return cloneArray(o, clone)\n    if (o.constructor !== Object && (handler = constructorHandlers.get(o.constructor))) {\n      return handler(o, clone)\n    }\n    const o2 = {}\n    refs.push(o)\n    refsNew.push(o2)\n    for (const k in o) {\n      if (Object.hasOwnProperty.call(o, k) === false) continue\n      const cur = o[k]\n      if (typeof cur !== 'object' || cur === null) {\n        o2[k] = cur\n      } else if (cur.constructor !== Object && (handler = constructorHandlers.get(cur.constructor))) {\n        o2[k] = handler(cur, clone)\n      } else if (ArrayBuffer.isView(cur)) {\n        o2[k] = copyBuffer(cur)\n      } else {\n        const i = refs.indexOf(cur)\n        if (i !== -1) {\n          o2[k] = refsNew[i]\n        } else {\n          o2[k] = clone(cur)\n        }\n      }\n    }\n    refs.pop()\n    refsNew.pop()\n    return o2\n  }\n\n  function cloneProto (o) {\n    if (typeof o !== 'object' || o === null) return o\n    if (Array.isArray(o)) return cloneArray(o, cloneProto)\n    if (o.constructor !== Object && (handler = constructorHandlers.get(o.constructor))) {\n      return handler(o, cloneProto)\n    }\n    const o2 = {}\n    refs.push(o)\n    refsNew.push(o2)\n    for (const k in o) {\n      const cur = o[k]\n      if (typeof cur !== 'object' || cur === null) {\n        o2[k] = cur\n      } else if (cur.constructor !== Object && (handler = constructorHandlers.get(cur.constructor))) {\n        o2[k] = handler(cur, cloneProto)\n      } else if (ArrayBuffer.isView(cur)) {\n        o2[k] = copyBuffer(cur)\n      } else {\n        const i = refs.indexOf(cur)\n        if (i !== -1) {\n          o2[k] = refsNew[i]\n        } else {\n          o2[k] = cloneProto(cur)\n        }\n      }\n    }\n    refs.pop()\n    refsNew.pop()\n    return o2\n  }\n}\n"],"names":["copyBuffer","Buffer","rfdcCircles","r","Map","Date","cloneArray","Array","Set","cloneProto","clone","Object","ArrayBuffer","rfdc","o","c"],"mappings":"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"}