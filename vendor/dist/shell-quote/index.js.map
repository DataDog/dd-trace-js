{"version":3,"file":"shell-quote/index.js","sources":["webpack:///./shell-quote/parse.js","webpack:///./shell-quote/quote.js","webpack:///./shell-quote/index.js"],"sourcesContent":["'use strict';\n\n// '<(' is process substitution operator and\n// can be parsed the same as control operator\nvar CONTROL = '(?:' + [\n\t'\\\\|\\\\|',\n\t'\\\\&\\\\&',\n\t';;',\n\t'\\\\|\\\\&',\n\t'\\\\<\\\\(',\n\t'\\\\<\\\\<\\\\<',\n\t'>>',\n\t'>\\\\&',\n\t'<\\\\&',\n\t'[&;()|<>]'\n].join('|') + ')';\nvar controlRE = new RegExp('^' + CONTROL + '$');\nvar META = '|&;()<> \\\\t';\nvar SINGLE_QUOTE = '\"((\\\\\\\\\"|[^\"])*?)\"';\nvar DOUBLE_QUOTE = '\\'((\\\\\\\\\\'|[^\\'])*?)\\'';\nvar hash = /^#$/;\n\nvar SQ = \"'\";\nvar DQ = '\"';\nvar DS = '$';\n\nvar TOKEN = '';\nvar mult = 0x100000000; // Math.pow(16, 8);\nfor (var i = 0; i < 4; i++) {\n\tTOKEN += (mult * Math.random()).toString(16);\n}\nvar startsWithToken = new RegExp('^' + TOKEN);\n\nfunction matchAll(s, r) {\n\tvar origIndex = r.lastIndex;\n\n\tvar matches = [];\n\tvar matchObj;\n\n\twhile ((matchObj = r.exec(s))) {\n\t\tmatches.push(matchObj);\n\t\tif (r.lastIndex === matchObj.index) {\n\t\t\tr.lastIndex += 1;\n\t\t}\n\t}\n\n\tr.lastIndex = origIndex;\n\n\treturn matches;\n}\n\nfunction getVar(env, pre, key) {\n\tvar r = typeof env === 'function' ? env(key) : env[key];\n\tif (typeof r === 'undefined' && key != '') {\n\t\tr = '';\n\t} else if (typeof r === 'undefined') {\n\t\tr = '$';\n\t}\n\n\tif (typeof r === 'object') {\n\t\treturn pre + TOKEN + JSON.stringify(r) + TOKEN;\n\t}\n\treturn pre + r;\n}\n\nfunction parseInternal(string, env, opts) {\n\tif (!opts) {\n\t\topts = {};\n\t}\n\tvar BS = opts.escape || '\\\\';\n\tvar BAREWORD = '(\\\\' + BS + '[\\'\"' + META + ']|[^\\\\s\\'\"' + META + '])+';\n\n\tvar chunker = new RegExp([\n\t\t'(' + CONTROL + ')', // control chars\n\t\t'(' + BAREWORD + '|' + SINGLE_QUOTE + '|' + DOUBLE_QUOTE + ')+'\n\t].join('|'), 'g');\n\n\tvar matches = matchAll(string, chunker);\n\n\tif (matches.length === 0) {\n\t\treturn [];\n\t}\n\tif (!env) {\n\t\tenv = {};\n\t}\n\n\tvar commented = false;\n\n\treturn matches.map(function (match) {\n\t\tvar s = match[0];\n\t\tif (!s || commented) {\n\t\t\treturn void undefined;\n\t\t}\n\t\tif (controlRE.test(s)) {\n\t\t\treturn { op: s };\n\t\t}\n\n\t\t// Hand-written scanner/parser for Bash quoting rules:\n\t\t//\n\t\t// 1. inside single quotes, all characters are printed literally.\n\t\t// 2. inside double quotes, all characters are printed literally\n\t\t//    except variables prefixed by '$' and backslashes followed by\n\t\t//    either a double quote or another backslash.\n\t\t// 3. outside of any quotes, backslashes are treated as escape\n\t\t//    characters and not printed (unless they are themselves escaped)\n\t\t// 4. quote context can switch mid-token if there is no whitespace\n\t\t//     between the two quote contexts (e.g. all'one'\"token\" parses as\n\t\t//     \"allonetoken\")\n\t\tvar quote = false;\n\t\tvar esc = false;\n\t\tvar out = '';\n\t\tvar isGlob = false;\n\t\tvar i;\n\n\t\tfunction parseEnvVar() {\n\t\t\ti += 1;\n\t\t\tvar varend;\n\t\t\tvar varname;\n\t\t\tvar char = s.charAt(i);\n\n\t\t\tif (char === '{') {\n\t\t\t\ti += 1;\n\t\t\t\tif (s.charAt(i) === '}') {\n\t\t\t\t\tthrow new Error('Bad substitution: ' + s.slice(i - 2, i + 1));\n\t\t\t\t}\n\t\t\t\tvarend = s.indexOf('}', i);\n\t\t\t\tif (varend < 0) {\n\t\t\t\t\tthrow new Error('Bad substitution: ' + s.slice(i));\n\t\t\t\t}\n\t\t\t\tvarname = s.slice(i, varend);\n\t\t\t\ti = varend;\n\t\t\t} else if ((/[*@#?$!_-]/).test(char)) {\n\t\t\t\tvarname = char;\n\t\t\t\ti += 1;\n\t\t\t} else {\n\t\t\t\tvar slicedFromI = s.slice(i);\n\t\t\t\tvarend = slicedFromI.match(/[^\\w\\d_]/);\n\t\t\t\tif (!varend) {\n\t\t\t\t\tvarname = slicedFromI;\n\t\t\t\t\ti = s.length;\n\t\t\t\t} else {\n\t\t\t\t\tvarname = slicedFromI.slice(0, varend.index);\n\t\t\t\t\ti += varend.index - 1;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn getVar(env, '', varname);\n\t\t}\n\n\t\tfor (i = 0; i < s.length; i++) {\n\t\t\tvar c = s.charAt(i);\n\t\t\tisGlob = isGlob || (!quote && (c === '*' || c === '?'));\n\t\t\tif (esc) {\n\t\t\t\tout += c;\n\t\t\t\tesc = false;\n\t\t\t} else if (quote) {\n\t\t\t\tif (c === quote) {\n\t\t\t\t\tquote = false;\n\t\t\t\t} else if (quote == SQ) {\n\t\t\t\t\tout += c;\n\t\t\t\t} else { // Double quote\n\t\t\t\t\tif (c === BS) {\n\t\t\t\t\t\ti += 1;\n\t\t\t\t\t\tc = s.charAt(i);\n\t\t\t\t\t\tif (c === DQ || c === BS || c === DS) {\n\t\t\t\t\t\t\tout += c;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tout += BS + c;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (c === DS) {\n\t\t\t\t\t\tout += parseEnvVar();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tout += c;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (c === DQ || c === SQ) {\n\t\t\t\tquote = c;\n\t\t\t} else if (controlRE.test(c)) {\n\t\t\t\treturn { op: s };\n\t\t\t} else if (hash.test(c)) {\n\t\t\t\tcommented = true;\n\t\t\t\tvar commentObj = { comment: string.slice(match.index + i + 1) };\n\t\t\t\tif (out.length) {\n\t\t\t\t\treturn [out, commentObj];\n\t\t\t\t}\n\t\t\t\treturn [commentObj];\n\t\t\t} else if (c === BS) {\n\t\t\t\tesc = true;\n\t\t\t} else if (c === DS) {\n\t\t\t\tout += parseEnvVar();\n\t\t\t} else {\n\t\t\t\tout += c;\n\t\t\t}\n\t\t}\n\n\t\tif (isGlob) {\n\t\t\treturn { op: 'glob', pattern: out };\n\t\t}\n\n\t\treturn out;\n\t}).reduce(function (prev, arg) { // finalize parsed arguments\n\t\t// TODO: replace this whole reduce with a concat\n\t\treturn typeof arg === 'undefined' ? prev : prev.concat(arg);\n\t}, []);\n}\n\nmodule.exports = function parse(s, env, opts) {\n\tvar mapped = parseInternal(s, env, opts);\n\tif (typeof env !== 'function') {\n\t\treturn mapped;\n\t}\n\treturn mapped.reduce(function (acc, s) {\n\t\tif (typeof s === 'object') {\n\t\t\treturn acc.concat(s);\n\t\t}\n\t\tvar xs = s.split(RegExp('(' + TOKEN + '.*?' + TOKEN + ')', 'g'));\n\t\tif (xs.length === 1) {\n\t\t\treturn acc.concat(xs[0]);\n\t\t}\n\t\treturn acc.concat(xs.filter(Boolean).map(function (x) {\n\t\t\tif (startsWithToken.test(x)) {\n\t\t\t\treturn JSON.parse(x.split(TOKEN)[1]);\n\t\t\t}\n\t\t\treturn x;\n\t\t}));\n\t}, []);\n};\n","'use strict';\n\nmodule.exports = function quote(xs) {\n\treturn xs.map(function (s) {\n\t\tif (s === '') {\n\t\t\treturn '\\'\\'';\n\t\t}\n\t\tif (s && typeof s === 'object') {\n\t\t\treturn s.op.replace(/(.)/g, '\\\\$1');\n\t\t}\n\t\tif ((/[\"\\s\\\\]/).test(s) && !(/'/).test(s)) {\n\t\t\treturn \"'\" + s.replace(/(['])/g, '\\\\$1') + \"'\";\n\t\t}\n\t\tif ((/[\"'\\s]/).test(s)) {\n\t\t\treturn '\"' + s.replace(/([\"\\\\$`!])/g, '\\\\$1') + '\"';\n\t\t}\n\t\treturn String(s).replace(/([A-Za-z]:)?([#!\"$&'()*,:;<=>?@[\\\\\\]^`{|}])/g, '$1\\\\$2');\n\t}).join(' ');\n};\n","'use strict';\n\nexports.quote = require('./quote');\nexports.parse = require('./parse');\n"],"names":["RegExp","i","Math","s","matchAll","getVar","e","JSON","parseInternal","c","parseEnvVar","Error","Boolean","String"],"mappings":"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"}