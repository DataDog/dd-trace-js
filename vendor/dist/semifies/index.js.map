{"version":3,"file":"semifies/index.js","sources":["webpack:///./semifies/index.js"],"sourcesContent":["module.exports = satisfies\n\nfunction satisfies (v, t) {\n  const [version] = parse(v, '')\n\n  for (const checks of compile(t)) {\n    if (checkAll(checks, version)) return true\n  }\n\n  return false\n}\n\nfunction checkAll (checks, v) {\n  for (const [ok, t] of checks) {\n    if (!test(v, t, ok)) return false\n  }\n  return true\n}\n\nfunction match (t) {\n  if (t === 'latest') t = '>=0'\n  return t.match(/^([^\\d+]*)(\\d.*)$/) || [null, '', '*.*.*']\n}\n\nfunction compile (t) {\n  const result = []\n\n  let checks = []\n\n  const tokens = t.trim().split(/\\s+/)\n\n  for (let i = 0; i < tokens.length; i++) {\n    const t = tokens[i]\n\n    if (t === '-') continue\n\n    if (t === '||') {\n      result.push(checks)\n      checks = []\n      continue\n    }\n\n    // untrim whitespace if this is a range spec\n    if (/^[<>=~v^]+$/.test(t) && i + 1 < tokens.length) {\n      tokens[i + 1] = t + tokens[i + 1]\n      continue\n    }\n\n    const res = match(t)\n\n    let cmp = res[1] || '='\n    if (cmp.endsWith('v')) cmp = cmp.slice(0, -1)\n\n    let [v, c] = parse(res[2], cmp)\n\n    if (i + 2 < tokens.length && tokens[i + 1] === '-') {\n      const m = match(tokens[i + 2])\n      tokens[i + 2] = '<=' + (m[2].indexOf('-') === -1 ? m[2] + '.*.*' : m[2])\n      c = '>='\n    }\n\n    if (c[0] === '~') {\n      const digs = res[2].split('-')[0].split('.').length\n      checks.push(['>=', v])\n      checks.push(['<', digs === 1 ? inc(v, 0) : digs === 2 ? inc(v, 1) : inc(v, 1)])\n    } else if (c[0] === '^') {\n      const digs = v[0] !== 0 ? 0 : v[1] !== 0 ? 1 : 2\n      checks.push(['>=', v])\n      checks.push(['<', digs === 0 ? inc(v, 0) : digs === 1 ? inc(v, 1) : inc(v, 2)])\n    } else {\n      checks.push([c.replace('~', '').replace('^', ''), v])\n    }\n  }\n\n  if (checks.length) result.push(checks)\n  return result\n}\n\nfunction inc (v, n) {\n  const cpy = v.slice(0)\n  if (v[n] === -1) return cpy\n  cpy[n++]++\n  for (; n < 3; n++) cpy[n] = 0\n  return cpy\n}\n\nfunction num (n) {\n  return n === 'x' || n === 'X' || n === '*' || n === 'latest' ? -1 : Number(n)\n}\n\nfunction numOrString (s) {\n  return /^\\d+$/.test(s) ? Number(s) : s\n}\n\nfunction ok (c, a, b) {\n  return b === -1 // -1 means x\n    ? c !== '<'\n    : (c === '=' ? a === b : c === '>' ? a > b : c === '>=' ? a >= b : c === '<' ? a < b : c === '<=' ? a <= b : false)\n}\n\nfunction parse (v, c) {\n  v = v.split('+')[0] // strip build\n  const [a, b] = v.split('-')\n  const nums = a.split('.').map(num).slice(0, 3)\n  const last = Math.max(nums.length - 1, 0)\n\n  if (c === '>') { // coerce to >=\n    c = '>='\n    nums.push(0, 0, 0)\n    nums[last]++\n  } else if (c === '') { // no comparision, just zero fill\n    nums.push(0, 0, 0)\n  } else { // anything else just wilcard\n    nums.push(-1, -1, -1)\n  }\n\n  if (!b) return [nums.slice(0, 3), c]\n  return [nums.slice(0, 3).concat(b.split('.').map(numOrString)), c]\n}\n\nfunction test (v, t, c) {\n  if (!ok('=', v[0], t[0])) return ok(c, v[0], t[0])\n  if (!ok('=', v[1], t[1])) return ok(c, v[1], t[1])\n  if (!ok('=', v[2], t[2])) return ok(c, v[2], t[2])\n\n  // no prerelease - final compare\n  if (v.length === 3 && t.length === 3) return ok(c, v[2], t[2])\n\n  // can never be less when comparing to a prerelease\n  if (c[0] === '<' && (t.length === 3 || v.length === 3)) return false\n\n  // can sometimes be higher\n  if (c[0] === '>') {\n    if (v.length === 3) return true\n    if (t.length === 3) return false\n  }\n\n  for (let i = 3; i < Math.max(v.length, t.length); i++) {\n    if (ok(c, v[i] || '', t[i] || '')) return true\n  }\n\n  return false\n}\n"],"names":["t","Number","Math","r"],"mappings":"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"}